# Accesses the current user from the session.\n# Future calls avoid the database because nil is not equal to false.\ndef current_user\n  if @current_user == false\n    Rails.logger.info "User already set to false, skipping login attempt."\n    return nil\n  end\n\n  @current_user ||= begin\n    user = login_from_session || login_from_basic_auth || login_from_cookie\n    if user\n      Rails.logger.info "User #{user.id} logged in with session ID #{session[:session_id]}"\n    else\n      Rails.logger.info "No user found in session."\n    end\n    user\n  end\nend