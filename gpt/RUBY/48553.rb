require 'nokogiri'\n\nhtml = <<-HTML\n<!-- Begin Topic Entry 4134 --> \n<tr> \n    <td align="center" class="row2"><image src='style_images/ip.boardpr/f_norm.gif' border='0'  alt='New Posts' /></td> \n    <td align="center" width="3%" class="row1">&nbsp;</td> \n    <td class="row2"> \n        <table class='ipbtable' cellspacing="0"> \n            <tr> \n                <td valign="middle"><alink href='http://www.xxx.com/index.php?showtopic=4134&amp;view=getnewpost'><image src='style_images/ip.boardpr/newpost.gif' border='0'  alt='Goto last unread' title='Goto last unread' hspace=2></a></td> \n                <td width="100%"> \n                <div style='float:right'></div> \n                <div> <alink href="http://www.xxx.com/index.php?showtopic=4134&amp;hl=">EXTRACT LINK 1</a>  </div> \n                </td> \n            </tr> \n        </table> \n        <span class="desc">EXTRACT DESCRIPTION</span> \n    </td> \n    <td class="row2" width="15%"><span class="forumdesc"><alink href="http://www.xxx.com/index.php?showforum=19" title="Living">EXTRACT LINK 2</a></span></td> \n    <td align="center" class="row1" width='10%'><alink href='http://www.xxx.com/index.php?showuser=1642'>Mr P</a></td> \n    <td align="center" class="row2"><alink href="javascript:who_posted(4134);">1</a></td> \n    <td align="center" class="row1">46</td> \n    <td class="row1"><span class="desc">Today, 12:04 AM<br /><alink href="http://www.xxx.com/index.php?showtopic=4134&amp;view=getlastpost">Last post by:</a> <b><alink href='http://www.xxx.com/index.php?showuser=1649'>underft</a></b></span></td> \n</tr> \n<!-- End Topic Entry 4134 -->\nHTML\n\ndoc = Nokogiri::HTML(html)\n\ndoc.xpath('//comment()').each do |comment|\n  if comment.text.include?('Begin Topic Entry')\n    table_row = comment.next_element\n\n    extract_link_1 = table_row.at_css('div > a').text\n    extract_description = table_row.at_css('span.desc').text\n    extract_link_2 = table_row.at_css('span.forumdesc > a').text\n\n    puts "EXTRACT LINK 1: #{extract_link_1}"\n    puts "EXTRACT DESCRIPTION: #{extract_description}"\n    puts "EXTRACT LINK 2: #{extract_link_2}"\n  end\nend