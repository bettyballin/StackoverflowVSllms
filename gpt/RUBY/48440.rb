class Category < ApplicationRecord\n  acts_as_nested_set\n\n  before_move :validate_move\n\n  private\n\n  def validate_move\n    if self.id == self.parent_id\n      errors.add(:base, "A node cannot be its own child.")\n      throw(:abort)\n    elsif self.descendants.include?(self.parent)\n      errors.add(:base, "A node cannot be moved beneath its own descendant.")\n      throw(:abort)\n    end\n  end\nend