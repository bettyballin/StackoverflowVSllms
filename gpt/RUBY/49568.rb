require 'net/imap'\n\nimap = Net::IMAP.new('mail.xks.com')\nimap.login('web1_xk3', 'pxx2006')\nimap.select('INBOX')\n\nimap.search(["SENTSINCE", (Time.now - 1 * 24 * 60 * 60).strftime("%d-%b-%Y")]).each do |msgid|\n  envelope = imap.fetch(msgid, "ENVELOPE")[0].attr["ENVELOPE"]\n  body_data = imap.fetch(msgid, "BODYSTRUCTURE")[0].attr["BODYSTRUCTURE"]\n\n  # Find the text part\n  if body_data.multipart?\n    parts = body_data.parts\n    text_part = parts.find { |part| part.media_type == "text" && part.subtype == "plain" }\n  else\n    text_part = body_data if body_data.media_type == "text" && body_data.subtype == "plain"\n  end\n\n  # Fetch the text part\n  if text_part\n    part_id = text_part.part_id\n    text_body = imap.fetch(msgid, "BODY[#{part_id}]")[0].attr["BODY[#{part_id}]"]\n    puts "Email Body: #{text_body}"\n  else\n    puts "No plain text body found for message ID #{msgid}"\n  end\nend\n\nimap.logout\nimap.disconnect