class CommentPolicy < ApplicationPolicy\n  def create?\n    user.present? && (user.moderator? || user.admin?)\n  end\n\n  def update?\n    user.present? && (record.user_id == user.id || user.moderator?)\n  end\n\n  def destroy?\n    user.present? && user.admin?\n  end\n\n  def moderate?\n    user.present? && user.moderator?\n  end\n\n  class Scope < Scope\n    def resolve\n      if user.admin?\n        scope.all\n      elsif user.moderator?\n        scope.where(status: ['normal', 'moderator'])\n      else\n        scope.where(status: 'normal')\n      end\n    end\n  end\nend