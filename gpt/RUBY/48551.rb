# app/models/vertex.rb\nclass Vertex < ApplicationRecord\n  has_many :edges_as_vertex1, class_name: 'Edge', foreign_key: 'vertex1_id'\n  has_many :edges_as_vertex2, class_name: 'Edge', foreign_key: 'vertex2_id'\n\n  has_many :adjacent_vertices_as_vertex1, through: :edges_as_vertex1, source: :vertex2\n  has_many :adjacent_vertices_as_vertex2, through: :edges_as_vertex2, source: :vertex1\n\n  def adjacent_vertices\n    adjacent_vertices_as_vertex1 + adjacent_vertices_as_vertex2\n  end\nend\n\n# app/models/edge.rb\nclass Edge < ApplicationRecord\n  belongs_to :vertex1, class_name: 'Vertex'\n  belongs_to :vertex2, class_name: 'Vertex'\n\n  validate :vertices_are_different\n\n  private\n\n  def vertices_are_different\n    errors.add(:base, 'Vertices must be different') if vertex1_id == vertex2_id\n  end\nend