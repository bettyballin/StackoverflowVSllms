require 'rubyXL'\n\n# Create a new workbook and worksheet\nworkbook = RubyXL::Workbook.new\nworksheet = workbook[0]\n\n# Set up the header row\nheaders = ['IP', 'Port 22', 'Port 80', 'Port 443']\nheaders.each_with_index do |header, index|\n  worksheet.add_cell(0, index, header)\nend\n\n# Add some example data\ndata = [\n  ['192.168.1.1', 'yes', 'no', 'yes'],\n  ['192.168.1.2', 'no', 'yes', 'no'],\n  ['192.168.1.3', 'yes', 'yes', 'yes']\n]\n\ndata.each_with_index do |row, row_index|\n  row.each_with_index do |cell, col_index|\n    worksheet.add_cell(row_index + 1, col_index, cell)\n  end\nend\n\n# Add dropdown for each port column\ndrop_down_data = ['yes', 'no']\n\n(1..data.length).each do |row|\n  (1..3).each do |col|\n    worksheet.add_data_validation(\n      row, col,\n      {\n        type: 'list',\n        formula1: "\"#{drop_down_data.join(',')}\"",\n        showDropDown: true\n      }\n    )\n  end\nend\n\n# Save the workbook\nworkbook.write('nmap_results.xlsx')