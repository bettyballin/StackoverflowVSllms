# Gemfile\ngem 'jwt'\n\n# app/controllers/application_controller.rb\nclass ApplicationController < ActionController::Base\n  before_action :authenticate_user\n\n  private\n\n  def authenticate_user\n    token = cookies.signed[:auth_token]\n    if token\n      begin\n        decoded_token = JWT.decode(token, 'your_secret_key', true, algorithm: 'HS256')\n        user_id = decoded_token[0]['sub']\n        @current_user = User.find(user_id)\n      rescue JWT::DecodeError\n        # Handle invalid token\n        redirect_to login_path, alert: "Invalid token"\n      end\n    else\n      redirect_to login_path, alert: "You need to login first"\n    end\n  end\nend