start_date = Date.parse('2023-01-01')\nend_date = Date.parse('2023-01-10')\n\n# Generate date range array\ndate_range = (start_date..end_date).to_a\n\n# Fetch average sales per day\nresults = ActiveRecord::Base.connection.execute(\n  <<-SQL\n    WITH RECURSIVE date_range AS (\n      SELECT '#{start_date}' AS date\n      UNION ALL\n      SELECT DATE_ADD(date, INTERVAL 1 DAY)\n      FROM date_range\n      WHERE date < '#{end_date}'\n    )\n    SELECT\n      COALESCE(AVG(ps.sales_price), 0) AS avg,\n      DATE_FORMAT(dr.date, '%m-%d-%Y') AS date\n    FROM\n      date_range dr\n    LEFT JOIN\n      products_sold ps ON DATE(ps.created_at) = dr.date AND ps.merchant_id = 1\n    GROUP BY\n      dr.date\n    ORDER BY\n      dr.date;\n  SQL\n)\n\n# Format results as needed\nformatted_results = results.map { |r| { avg: r['avg'], date: r['date'] } }