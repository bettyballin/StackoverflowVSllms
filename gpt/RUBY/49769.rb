class Report < ActiveRecord::Base\n  def foo\n    return @foo if instance_variable_defined?(:@foo)\n\n    Report.transaction do\n      @foo = read_attribute(:foo)\n      if @foo.nil?\n        @foo = (expensive_sql_query)\n        write_attribute(:foo, @foo)\n        save!\n      end\n    end\n    @foo\n  end\n\n  private\n\n  def expensive_sql_query\n    # Your expensive SQL query logic here\n  end\nend