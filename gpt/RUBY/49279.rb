require 'win32/registry'\n\ndef set_env_variable(name, value)\n  Win32::Registry::HKEY_LOCAL_MACHINE.open('SYSTEM\CurrentControlSet\Control\Session Manager\Environment', Win32::Registry::KEY_WRITE) do |reg|\n    reg[name] = Win32::Registry::REG_EXPAND_SZ, value\n  end\nend\n\n# Example usage:\nset_env_variable('JAVA_HOME', 'C:\path\to\java')\n\nputs "Environment variable JAVA_HOME set to C:\\path\\to\\java"