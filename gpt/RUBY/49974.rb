require 'socket'\n\n   class TcpServerWorker\n     include Sidekiq::Worker\n\n     def perform\n       server = TCPServer.new('localhost', 2000)\n       puts "TCP Server running on port 2000"\n\n       loop do\n         Thread.start(server.accept) do |client|\n           begin\n             while (line = client.gets)\n               puts line\n               # Process the received data here or send it to Rails app\n             end\n           rescue => e\n             puts "Error: #{e.message}"\n           ensure\n             client.close\n           end\n         end\n       end\n     end\n   end