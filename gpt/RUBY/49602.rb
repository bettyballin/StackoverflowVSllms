require 'selenium-webdriver'\n\nThen /^I should be (editing|viewing) the (\w+) with (\w+) "([^\"]*)"$/ do |action, model, field, value|\n  func = make_func(action, model)\n  m = find_model_by_field_and_value(model, field, value)\n  \n  wait = Selenium::WebDriver::Wait.new(timeout: 10)\n  wait.until { URI.parse(current_url).path == eval("#{func}(m)") }\nend\n\nWhen /^I click "([^\"]*)"$/ do |link_text|\n  wait = Selenium::WebDriver::Wait.new(timeout: 10)\n  wait.until { page.has_link?(link_text) }\n  click_link(link_text)\nend\n\nWhen /^I press "([^\"]*)"$/ do |button_text|\n  wait = Selenium::WebDriver::Wait.new(timeout: 10)\n  wait.until { page.has_button?(button_text) }\n  click_button(button_text)\nend