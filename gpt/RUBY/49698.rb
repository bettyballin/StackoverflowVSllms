require 'nokogiri'\n\nhtml = <<-HTML\n<html>\n<body>\n<h1>Foo</h1>\n<p>The quick brown fox.</p>\n<h1>Bar</h1>\n<p>Jumps over the lazy dog.</p>\n</body>\n</html>\nHTML\n\n# Parse the HTML\ndoc = Nokogiri::HTML(html)\n\n# Find and replace <h1> tags with <p class="title">\ndoc.css('h1').each do |h1|\n  new_node = Nokogiri::XML::Node.new('p', doc)\n  new_node['class'] = 'title'\n  new_node.content = h1.content\n  h1.replace(new_node)\nend\n\n# Print the modified HTML\nputs doc.to_html