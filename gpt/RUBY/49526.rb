# Gemfile\ngem 'redis'\n\n# config/initializers/redis.rb\n$redis = Redis.new(url: ENV["REDIS_URL"])\n\n# app/controllers/application_controller.rb\nbefore_action :update_user_activity\n\ndef update_user_activity\n  if user_signed_in?\n    $redis.set(current_user.id, Time.now.to_i)\n    $redis.expire(current_user.id, 600) # 10 minutes TTL\n  end\nend\n\n# To get online users\ndef online_users\n  user_ids = $redis.keys\n  User.where(id: user_ids)\nend