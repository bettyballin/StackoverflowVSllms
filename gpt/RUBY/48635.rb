# app/controllers/multi_step_forms_controller.rb\nclass MultiStepFormsController < ApplicationController\n  before_action :set_form\n\n  def new\n    render_step\n  end\n\n  def create\n    if @form.valid?\n      if params[:commit] == 'Next'\n        session[:multi_step_form] = @form.attributes\n        redirect_to next_step_path\n      elsif params[:commit] == 'Finish'\n        @form.save\n        session.delete(:multi_step_form)\n        redirect_to success_path\n      end\n    else\n      render_step\n    end\n  end\n\n  private\n\n  def set_form\n    @form = MultiStepForm.new(session[:multi_step_form].merge(step: current_step))\n  end\n\n  def current_step\n    params[:step] || 'personal_info'\n  end\n\n  def next_step_path\n    case current_step\n    when 'personal_info' then new_multi_step_form_path(step: 'contact_info')\n    when 'contact_info'  then new_multi_step_form_path(step: 'address_info')\n    else new_multi_step_form_path(step: 'personal_info')\n    end\n  end\n\n  def render_step\n    render current_step\n  end\nend