<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">\n\n  <!-- Define the output format -->\n  <xsl:output method="xml" indent="yes"/>\n\n  <!-- Template match for the root element -->\n  <xsl:template match="/archive">\n    <feed xmlns="http://www.w3.org/2005/Atom">\n      \n      <!-- Select all <day> elements into a variable -->\n      <xsl:variable name="allDays" select="//day"/>\n      \n      <!-- Calculate the total count of <day> elements -->\n      <xsl:variable name="totalDays" select="count($allDays)"/>\n      \n      <!-- Process only the last 30 <day> elements -->\n      <xsl:for-each select="$allDays[position() > $totalDays - 30]">\n        <entry>\n          <!-- Copy the content of each <day> element into the feed entry -->\n          <xsl:copy-of select="."/>\n        </entry>\n      </xsl:for-each>\n      \n    </feed>\n  </xsl:template>\n  \n</xsl:stylesheet>