<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">\n  <xsl:output method="xml" indent="yes"/>\n  \n  <xsl:key name="groupByContentType" match="Row" use="@ContentType"/>\n  <xsl:key name="groupBySite" match="Row" use="@Site"/>\n  \n  <xsl:template match="/">\n    <xsl:apply-templates select="/dsQueryResponse/Rows/Row[generate-id() = generate-id(key('groupByContentType', @ContentType)[1])]"/>\n  </xsl:template>\n  \n  <xsl:template match="Row">\n    <h2>\n      <xsl:value-of select="@ContentType"/>\n    </h2>\n    <xsl:apply-templates select="key('groupByContentType', @ContentType)[generate-id() = generate-id(key('groupBySite', @Site)[1])]"/>\n  </xsl:template>\n  \n  <xsl:template match="Row[key('groupBySite', @Site)]">\n    <h3>\n      <xsl:value-of select="@Site"/>\n    </h3>\n    <ul>\n      <xsl:apply-templates select="key('groupBySite', @Site)"/>\n    </ul>\n  </xsl:template>\n  \n  <xsl:template match="Row[key('groupBySite', @Site)]">\n    <li>\n      <xsl:value-of select="@Title"/>\n    </li>\n  </xsl:template>\n</xsl:stylesheet>