<Project Sdk="Microsoft.NET.Sdk">\n\n  <PropertyGroup>\n    <IntermediateOutputPath>$(BaseIntermediateOutputPath)</IntermediateOutputPath>\n  </PropertyGroup>\n\n  <UsingTask TaskName="ModifyCodeTask" AssemblyFile="path\to\your\CustomTask.dll" />\n\n  <Target Name="BeforeCompile" BeforeTargets="CoreCompile">\n    <ModifyCodeTask SourceFiles="@(Compile)" IntermediateOutputPath="$(IntermediateOutputPath)" />\n    <ItemGroup>\n      <Compile Remove="@(Compile)" />\n      <Compile Include="$(IntermediateOutputPath)\**\*.cs" />\n    </ItemGroup>\n  </Target>\n\n  <ItemGroup>\n    <Compile Include="**\*.cs" />\n  </ItemGroup>\n\n</Project>