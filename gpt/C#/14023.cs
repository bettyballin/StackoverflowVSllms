using System;\nusing PacketDotNet;\nusing SharpPcap;\nusing SharpPcap.LibPcap;\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        // List all available devices\n        foreach (var device in CaptureDeviceList.Instance)\n        {\n            Console.WriteLine($"{device.Name} - {device.Description}");\n        }\n\n        // Open the first device\n        var dev = CaptureDeviceList.Instance[0];\n        dev.OnPacketArrival += new PacketArrivalEventHandler(Device_OnPacketArrival);\n        dev.Open(DeviceMode.Promiscuous);\n\n        // Start capturing packets\n        dev.StartCapture();\n        Console.WriteLine("Press Enter to exit...");\n        Console.ReadLine();\n\n        // Stop capturing packets\n        dev.StopCapture();\n        dev.Close();\n    }\n\n    private static void Device_OnPacketArrival(object sender, CaptureEventArgs e)\n    {\n        var packet = Packet.ParsePacket(e.Packet.LinkLayerType, e.Packet.Data);\n        Console.WriteLine(packet.ToString());\n        \n        // Implement your packet manipulation logic here\n    }\n}