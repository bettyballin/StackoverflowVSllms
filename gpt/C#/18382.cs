using iTextSharp.text.pdf;\nusing iTextSharp.text;\n\n// Load the PDF document\nstring inputPdfPath = "input.pdf";\nstring outputPdfPath = "protected.pdf";\nstring userPassword = "userPassword";\nstring ownerPassword = "ownerPassword";\n\nusing (PdfReader reader = new PdfReader(inputPdfPath))\n{\n    using (FileStream fs = new FileStream(outputPdfPath, FileMode.Create, FileAccess.Write))\n    {\n        PdfEncryptor.Encrypt(reader, fs, PdfWriter.ENCRYPTION_AES_128, userPassword, ownerPassword, PdfWriter.ALLOW_PRINTING);\n    }\n}