using System;\nusing System.Data;\nusing System.Data.SqlClient;\nusing System.Windows.Forms;\n\nnamespace sqlAsyncTesting {\n    public partial class Form1 : Form {\n\n        public Form1() {\n            InitializeComponent();\n        }\n\n        private void button1_Click(object sender, EventArgs e) {\n            SqlConnection conn = new SqlConnection(@"Data Source=bigapple;Initial Catalog=master;Integrated Security=SSPI;Asynchronous Processing=true;");\n            conn.Open();\n            SqlCommand cmd = new SqlCommand(@"WAITFOR DELAY '00:03'; Select top 3 * from sysobjects;", conn);\n            IAsyncResult result = cmd.BeginExecuteReader(new AsyncCallback(HandleCallback), cmd);\n        }\n\n        private void HandleCallback(IAsyncResult result) {\n            using (SqlCommand _this = (SqlCommand)result.AsyncState)\n            using (SqlDataReader dr = _this.EndExecuteReader(result)) {\n                DataTable dt = new DataTable();\n                DataSet ds = new DataSet();\n\n                dt.Load(dr);\n                ds.Tables.Add(dt);\n                dr.Close();\n                Complete(ds);\n            }\n        }\n\n        private void Complete(DataSet ds) {\n            string output = string.Empty;\n            foreach (DataColumn c in ds.Tables[0].Columns) {\n                output += c.ColumnName + "\t";\n            }\n            output += "\r\n";\n            foreach (DataRow dr in ds.Tables[0].Rows) {\n                foreach (object i in dr.ItemArray) {\n                    output += i.ToString() + "\t";\n                }\n                output += "\r\n";\n            }\n            // Assuming you want to display the output somewhere, e.g., a TextBox\n            MessageBox.Show(output);\n        }\n    }\n}