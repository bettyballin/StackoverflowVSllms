using System.Windows;\nusing System.Windows.Controls;\nusing System.Windows.Media;\n\npublic class ResizableLabel : Label\n{\n    public string FullText { get; set; }\n\n    protected override void OnRender(DrawingContext drawingContext)\n    {\n        base.OnRender(drawingContext);\n\n        if (string.IsNullOrEmpty(FullText))\n            return;\n\n        double availableWidth = this.ActualWidth;\n        string displayedText = FullText;\n        FormattedText formattedText = GetFormattedText(displayedText);\n\n        while (formattedText.Width > availableWidth && displayedText.Length > 0)\n        {\n            displayedText = displayedText.Substring(0, displayedText.Length - 1);\n            formattedText = GetFormattedText(displayedText + "..");\n        }\n\n        this.Content = displayedText.Length < FullText.Length ? displayedText + ".." : displayedText;\n    }\n\n    private FormattedText GetFormattedText(string text)\n    {\n        return new FormattedText(\n            text,\n            System.Globalization.CultureInfo.CurrentCulture,\n            FlowDirection.LeftToRight,\n            new Typeface(this.FontFamily, this.FontStyle, this.FontWeight, this.FontStretch),\n            this.FontSize,\n            this.Foreground);\n    }\n}