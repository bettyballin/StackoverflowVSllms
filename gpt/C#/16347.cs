using System;\nusing System.DirectoryServices;\n\nclass Program\n{\n    static void Main()\n    {\n        string userDn = "LDAP://CN=YourUser,CN=Users,DC=yourdomain,DC=com";\n        using (DirectoryEntry userEntry = new DirectoryEntry(userDn))\n        {\n            // Get the IADsTSUserEx interface\n            object tsUserEx = userEntry.InvokeGet("TerminalServicesProfilePath");\n            if (tsUserEx != null)\n            {\n                // Accessing the Terminal Services properties\n                string profilePath = tsUserEx.GetType().InvokeMember("TerminalServicesProfilePath", System.Reflection.BindingFlags.GetProperty, null, tsUserEx, null) as string;\n                string homeDirectory = tsUserEx.GetType().InvokeMember("TerminalServicesHomeDirectory", System.Reflection.BindingFlags.GetProperty, null, tsUserEx, null) as string;\n                string homeDrive = tsUserEx.GetType().InvokeMember("TerminalServicesHomeDrive", System.Reflection.BindingFlags.GetProperty, null, tsUserEx, null) as string;\n\n                Console.WriteLine("Profile Path: " + profilePath);\n                Console.WriteLine("Home Directory: " + homeDirectory);\n                Console.WriteLine("Home Drive: " + homeDrive);\n            }\n            else\n            {\n                Console.WriteLine("Terminal Services properties not found.");\n            }\n        }\n    }\n}