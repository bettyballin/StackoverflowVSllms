using System;\nusing Microsoft.SqlServer.Dts.Runtime;\nusing Microsoft.SqlServer.Dts.Runtime.Enumerators.File;\n\nclass Program\n{\n    static void Main()\n    {\n        Application app = new Application();\n        Package package = new Package();\n\n        // Adding a ForEachLoop container\n        Executable exec = package.Executables.Add("STOCK:ForEachLoop");\n        ForEachLoop forEachLoop = (ForEachLoop)exec;\n        forEachLoop.Name = "a for each loop";\n\n        // Setting up the ForEachEnumerator\n        ForEachFileEnumerator fileEnumerator = new ForEachFileEnumerator();\n        fileEnumerator.Directory = "C:\\Files"; // Set the directory path\n        fileEnumerator.FileSpec = "*.txt"; // Set the file spec\n        fileEnumerator.Recurse = false; // Set recursion\n\n        // Assign the enumerator to the ForEachLoop\n        forEachLoop.ForEachEnumerator = fileEnumerator;\n\n        // Set CollectionEnumerator to false\n        forEachLoop.CollectionEnumerator = false;\n\n        // Save the package to disk\n        app.SaveToXml("C:\\YourPackage.dtsx", package, null);\n\n        Console.WriteLine("Package created successfully.");\n    }\n}