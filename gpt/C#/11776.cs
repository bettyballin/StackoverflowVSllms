using System;\n    using System.Configuration;\n    using System.Data.Common;\n    \n    public class DatabaseHelper\n    {\n        private readonly string _providerName;\n        private readonly string _connectionString;\n\n        public DatabaseHelper(string connectionStringName)\n        {\n            var settings = ConfigurationManager.ConnectionStrings[connectionStringName];\n            if (settings == null)\n                throw new ArgumentException("Invalid connection string name");\n\n            _providerName = settings.ProviderName;\n            _connectionString = settings.ConnectionString;\n        }\n\n        public DbConnection GetConnection()\n        {\n            DbProviderFactory factory = DbProviderFactories.GetFactory(_providerName);\n            DbConnection connection = factory.CreateConnection();\n            connection.ConnectionString = _connectionString;\n            return connection;\n        }\n    }