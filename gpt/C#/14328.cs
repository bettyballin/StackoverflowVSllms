using System;\nusing System.Runtime.InteropServices;\nusing System.Threading;\nusing System.Threading.Tasks;\nusing mshtml;\n\n[ComVisible(true)]\npublic class MyBHO\n{\n    private SynchronizationContext _syncContext;\n\n    public void OnDocumentComplete(object pDisp, ref object URL)\n    {\n        // Capture the current synchronization context\n        _syncContext = SynchronizationContext.Current;\n\n        // Start asynchronous server communication\n        Task.Run(() => PerformServerCommunication());\n    }\n\n    private async Task PerformServerCommunication()\n    {\n        // Simulate asynchronous server communication\n        await Task.Delay(3000); // Replace with actual async server communication\n\n        // Assume serverResponse contains the data from the server\n        string serverResponse = "<div>New Content</div>";\n\n        // Post back to the main thread to manipulate the DOM\n        _syncContext.Post(_ => UpdateDOM(serverResponse), null);\n    }\n\n    private void UpdateDOM(string newContent)\n    {\n        try\n        {\n            // Access the IE DOM and make changes\n            var document = (IHTMLDocument2) _currentBrowser.Document;\n            var body = document.body as IHTMLElement;\n            if (body != null)\n            {\n                body.innerHTML += newContent;\n            }\n        }\n        catch (Exception ex)\n        {\n            // Handle any exceptions\n            Console.WriteLine($"Error updating DOM: {ex.Message}");\n        }\n    }\n\n    private IWebBrowser2 _currentBrowser;\n    // Ensure _currentBrowser is set appropriately in your BHO initialization\n}