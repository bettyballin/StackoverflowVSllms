public static void ExtendListWithNull<T>(List<T> list, int newSize) where T : class\n{\n    if (newSize < list.Count)\n    {\n        throw new ArgumentException("newSize must be greater than or equal to the current list size.");\n    }\n\n    list.Capacity = Math.Max(list.Capacity, newSize); // Ensure capacity is sufficient\n\n    for (int i = list.Count; i < newSize; i++)\n    {\n        list.Add(null);\n    }\n}