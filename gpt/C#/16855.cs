using Ganss.XSS;\n\n   public string SanitizeHtml(string userInput)\n   {\n       var sanitizer = new HtmlSanitizer();\n\n       // Optionally configure the sanitizer\n       sanitizer.AllowedAttributes.Add("class");\n       sanitizer.AllowedAttributes.Add("style");\n       sanitizer.RemovingAttribute += (s, e) =>\n       {\n           // Disallow styles that contain expressions\n           if (e.Attribute.Name == "style" && e.Attribute.Value.Contains("expression"))\n           {\n               e.Cancel = true;\n           }\n       };\n\n       // Sanitize the input\n       string sanitizedHtml = sanitizer.Sanitize(userInput);\n\n       return sanitizedHtml;\n   }