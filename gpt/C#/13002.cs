using Microsoft.Win32;\nusing System;\nusing System.Windows.Forms;\n\nclass Program\n{\n    static void Main()\n    {\n        string regPath = @"Software\Microsoft\Internet Explorer\Main";\n        string regValueName = "Print_Background";\n\n        try\n        {\n            using (RegistryKey regKey = Registry.CurrentUser.OpenSubKey(regPath, true))\n            {\n                if (regKey == null)\n                {\n                    MessageBox.Show("Registry path not found.");\n                    return;\n                }\n\n                // Get the current setting so that we can revert it after print job\n                object defaultValue = regKey.GetValue(regValueName);\n                regKey.SetValue(regValueName, "yes");\n\n                // Do the printing\n                // (Your printing code here)\n\n                // Revert the registry key to the original value\n                if (defaultValue != null)\n                {\n                    regKey.SetValue(regValueName, defaultValue);\n                }\n                else\n                {\n                    regKey.DeleteValue(regValueName);\n                }\n            }\n        }\n        catch (Exception ex)\n        {\n            MessageBox.Show($"An error occurred: {ex.Message}");\n        }\n    }\n}