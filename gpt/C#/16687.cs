using System;\nusing Microsoft.AspNetCore.Mvc;\nusing Microsoft.IdentityModel.Tokens;\nusing System.IdentityModel.Tokens.Jwt;\nusing System.Security.Claims;\nusing System.Text;\n\npublic class AuthController : Controller\n{\n    private readonly string sharedSecretKey = "your_shared_secret_key";\n\n    public IActionResult Welcome()\n    {\n        string token = Request.Cookies["auth_token"];\n        if (string.IsNullOrEmpty(token))\n        {\n            return Unauthorized();\n        }\n\n        var tokenHandler = new JwtSecurityTokenHandler();\n        var key = Encoding.ASCII.GetBytes(sharedSecretKey);\n        try\n        {\n            tokenHandler.ValidateToken(token, new TokenValidationParameters\n            {\n                ValidateIssuerSigningKey = true,\n                IssuerSigningKey = new SymmetricSecurityKey(key),\n                ValidateIssuer = false,\n                ValidateAudience = false\n            }, out SecurityToken validatedToken);\n\n            var jwtToken = (JwtSecurityToken)validatedToken;\n            var userId = jwtToken.Claims.First(x => x.Type == "user_id").Value;\n\n            // Create authenticated session or context\n            // ...\n            \n            return Ok($"Welcome User {userId}");\n        }\n        catch\n        {\n            return Unauthorized();\n        }\n    }\n}