using System;\n    using System.Timers;\n\n    public class EmailScheduler\n    {\n        private static Timer timer;\n        private static EmailRepository emailRepository = new EmailRepository();\n        private static EmailService emailService = new EmailService();\n\n        public static void Main()\n        {\n            timer = new Timer(60000); // Check every minute\n            timer.Elapsed += CheckAndSendEmails;\n            timer.AutoReset = true;\n            timer.Enabled = true;\n\n            Console.WriteLine("Email Scheduler started. Press [Enter] to exit.");\n            Console.ReadLine();\n        }\n\n        private static void CheckAndSendEmails(Object source, ElapsedEventArgs e)\n        {\n            var pendingEmails = emailRepository.GetPendingEmails();\n            while (pendingEmails.Read())\n            {\n                int emailId = (int)pendingEmails["Id"];\n                string recipientEmail = pendingEmails["RecipientEmail"].ToString();\n                string subject = pendingEmails["Subject"].ToString();\n                string body = pendingEmails["Body"].ToString();\n\n                emailService.SendEmail(recipientEmail, subject, body);\n                emailRepository.MarkEmailAsSent(emailId);\n            }\n        }\n    }