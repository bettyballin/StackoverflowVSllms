using System.ServiceModel;\n\n   public partial class Service1 : ServiceBase\n   {\n       private ServiceHost _serviceHost;\n\n       protected override void OnStart(string[] args)\n       {\n           _deviceManager = new DeviceManager();\n           _deviceManager.Start();\n\n           _serviceHost = new ServiceHost(typeof(DeviceService));\n           _serviceHost.Open();\n       }\n\n       protected override void OnStop()\n       {\n           if (_serviceHost != null)\n           {\n               _serviceHost.Close();\n               _serviceHost = null;\n           }\n\n           _deviceManager.Stop();\n           _deviceManager = null;\n       }\n   }