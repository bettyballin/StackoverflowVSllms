using Microsoft.VisualStudio.Modeling;\nusing Microsoft.VisualStudio.Modeling.Shell;\n\npublic void CreateNewDiagram(Store store)\n{\n    using (Transaction transaction = store.TransactionManager.BeginTransaction("Create New Diagram"))\n    {\n        // Create a new FEGeneratorDiagram\n        FEGeneratorDiagram newDiagram = new FEGeneratorDiagram(store);\n\n        // Associate the new diagram with the desired element\n        newDiagram.Associate(ThisElem);\n\n        // Create a new document to host the diagram\n        ModelingDocData docData = new ModelingDocData(store);\n\n        // Add the new diagram to the document\n        docData.RootElement = newDiagram;\n\n        // Save or do further processing with the document and diagram here\n        // Example: Save the document\n        docData.Save("path_to_save_new_diagram_file");\n\n        transaction.Commit();\n    }\n}