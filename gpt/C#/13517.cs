using System;\nusing System.Configuration;\nusing System.Data.Common;\n\npublic DbConnection GetConnection(string connectionName)\n{\n    // Get the connection string information\n    ConnectionStringSettings cs = ConfigurationManager.ConnectionStrings[connectionName];\n    if (cs == null)\n        throw new ConfigurationErrorsException($"Invalid connection name \"{connectionName}\"");\n\n    // Create a connection based on the provider\n    DbProviderFactory factory = DbProviderFactories.GetFactory(cs.ProviderName);\n\n    DbConnection conn = factory.CreateConnection();\n    if (conn == null)\n        throw new InvalidOperationException($"Unable to create a connection for provider \"{cs.ProviderName}\"");\n\n    conn.ConnectionString = cs.ConnectionString;\n\n    return conn;\n}