// Assuming the Referral class is defined as\npublic class Referral\n{\n    public string URL { get; set; }\n    public List<string> Keywords { get; set; }\n    public int Occurrences { get; set; }\n\n    public Referral(string url, string keyword, int occurrences)\n    {\n        URL = url;\n        Keywords = new List<string> { keyword };\n        Occurrences = occurrences;\n    }\n}\n\n// Your existing list of referrals\nList<Referral> Referrals = new List<Referral>();\n\n// New list to collect referrals to be added\nList<Referral> newReferrals = new List<Referral>();\n\n//IF THIS IS THE FIRST ONE, ADD IT!\nvar refSize = Referrals.Count();\nif (refSize == 0)\n{\n    var NewReferral = new Referral(referringURL.Trim(), referringWords.Trim(), 3);\n    Referrals.Add(NewReferral);\n}\nelse\n{\n    for (int i = 0; i < refSize; i++)\n    {\n        // RESET BOOLS\n        bool URLPresent = false;\n        bool KeywordPresent = false;\n\n        // IF THE URL IS ALREADY PRESENT\n        if (Referrals[i].URL == referringURL)\n        {\n            URLPresent = true;\n\n            // CHECK IF THE KEYWORD IS ALREADY PRESENT\n            for (int ii = 0; ii < Referrals[i].Keywords.Count; ii++)\n            {\n                if (Referrals[i].Keywords[ii] == referringWords)\n                {\n                    // ADD TO OCCURRENCES\n                    Referrals[i].Occurrences++;\n                    KeywordPresent = true;\n                    break;\n                }\n            }\n\n            // ADD KEYWORD TO LIST\n            if (!KeywordPresent)\n            {\n                Referrals[i].Keywords.Add(referringWords);\n                KeywordPresent = true;\n            }\n        }\n\n        // IF THE KEYWORD ISN'T THERE && THE URL ISNT THERE, ADD A NEW REFERRAL OBJECT\n        if (!URLPresent && !KeywordPresent)\n        {\n            var NewReferral = new Referral(referringURL.Trim(), referringWords.Trim(), 3);\n            newReferrals.Add(NewReferral);  // Collect new referrals separately\n        }\n    }\n}\n\n// Add collected new referrals to the main list\nReferrals.AddRange(newReferrals);