private const int MaxRetryCount = 3;\n    private const int RetryDelayMilliseconds = 1000;\n\n    private TResult ExecuteWithRetry<TResult>(Func<TResult> func)\n    {\n        int retryCount = 0;\n        while (true)\n        {\n            try\n            {\n                return func();\n            }\n            catch (COMException comEx) when (comEx.HResult == unchecked((int)0x80010100))\n            {\n                if (++retryCount >= MaxRetryCount)\n                    throw;\n                \n                System.Threading.Thread.Sleep(RetryDelayMilliseconds); // Wait before retry\n            }\n        }\n    }