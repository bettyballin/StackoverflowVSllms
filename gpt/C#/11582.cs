using Microsoft.VisualStudio.TestTools.UnitTesting;\nusing System.Security.Principal;\nusing System.Threading;\n\n[TestClass]\npublic class UnitTest1\n{\n    [TestInitialize]\n    public void TestInitialize()\n    {\n        // Create a generic identity with the name "TestUser"\n        var identity = new GenericIdentity("TestUser");\n\n        // Create a principal with the required role\n        var principal = new GenericPrincipal(identity, new[] { @"BUILTIN\Users" });\n\n        // Set the principal to the current thread\n        Thread.CurrentPrincipal = principal;\n    }\n\n    [TestMethod]\n    public void TestMethod1()\n    {\n        var c = new MyClass();\n        Assert.IsNotNull(c);\n    }\n}\n\n[PrincipalPermission(SecurityAction.Demand, Role = @"BUILTIN\Users")]\npublic class MyClass\n{\n    public MyClass()\n    {\n        Console.WriteLine("This works.");\n    }\n}