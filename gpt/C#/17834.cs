using System.ServiceProcess;\n\n   public partial class Service1 : ServiceBase\n   {\n       private DeviceManager _deviceManager;\n\n       public Service1()\n       {\n           InitializeComponent();\n       }\n\n       protected override void OnStart(string[] args)\n       {\n           // Initialize and start the device manager\n           _deviceManager = new DeviceManager();\n           _deviceManager.Start();\n       }\n\n       protected override void OnStop()\n       {\n           // Stop the device manager\n           _deviceManager.Stop();\n           _deviceManager = null;\n       }\n   }