using System.Configuration;\n\nnamespace YourNamespace\n{\n    public class RecipientsSection : ConfigurationSection\n    {\n        [ConfigurationProperty("recipients")]\n        public RecipientCollection Recipients\n        {\n            get { return (RecipientCollection)this["recipients"]; }\n            set { this["recipients"] = value; }\n        }\n    }\n\n    [ConfigurationCollection(typeof(RecipientElement), AddItemName = "add")]\n    public class RecipientCollection : ConfigurationElementCollection\n    {\n        protected override ConfigurationElement CreateNewElement()\n        {\n            return new RecipientElement();\n        }\n\n        protected override object GetElementKey(ConfigurationElement element)\n        {\n            return ((RecipientElement)element).Key;\n        }\n\n        public new RecipientElement this[string key]\n        {\n            get { return (RecipientElement)BaseGet(key); }\n        }\n    }\n\n    public class RecipientElement : ConfigurationElement\n    {\n        [ConfigurationProperty("key", IsRequired = true, IsKey = true)]\n        public string Key\n        {\n            get { return (string)this["key"]; }\n            set { this["key"] = value; }\n        }\n\n        [ConfigurationProperty("value", IsRequired = true)]\n        public string Value\n        {\n            get { return (string)this["value"]; }\n            set { this["value"] = value; }\n        }\n    }\n}