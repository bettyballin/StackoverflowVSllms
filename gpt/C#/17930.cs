<%@ Application Language="C#" %>\n\n<script runat="server">\n    void Session_Start(object sender, EventArgs e)\n    {\n        // Store session information\n        Application.Lock();\n        var sessions = Application["ActiveSessions"] as List<SessionInfo>;\n        if (sessions == null)\n        {\n            sessions = new List<SessionInfo>();\n        }\n        sessions.Add(new SessionInfo\n        {\n            SessionID = Session.SessionID,\n            IPAddress = Request.UserHostAddress,\n            UserAgent = Request.UserAgent,\n            StartTime = DateTime.Now\n        });\n        Application["ActiveSessions"] = sessions;\n        Application.UnLock();\n    }\n\n    void Session_End(object sender, EventArgs e)\n    {\n        // Remove session information\n        Application.Lock();\n        var sessions = Application["ActiveSessions"] as List<SessionInfo>;\n        if (sessions != null)\n        {\n            var sessionToRemove = sessions.FirstOrDefault(s => s.SessionID == Session.SessionID);\n            if (sessionToRemove != null)\n            {\n                sessions.Remove(sessionToRemove);\n            }\n            Application["ActiveSessions"] = sessions;\n        }\n        Application.UnLock();\n    }\n</script>