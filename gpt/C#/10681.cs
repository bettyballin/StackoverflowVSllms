using System;\nusing System.Data;\nusing System.Data.SqlClient;\nusing System.Configuration;\n\npublic class DataProcessor\n{\n    public void ProcessData()\n    {\n        string connectionString = ConfigurationManager.ConnectionStrings["connstr"].ConnectionString;\n\n        using (SqlConnection connection = new SqlConnection(connectionString))\n        {\n            connection.Open();\n\n            // Example of processing data in batches\n            foreach (var company in GetCompanies(connection))\n            {\n                foreach (var course in GetCourses(connection, company))\n                {\n                    ProcessCourseData(connection, company, course);\n                }\n            }\n        }\n    }\n\n    private IEnumerable<string> GetCompanies(SqlConnection connection)\n    {\n        // Logic to fetch companies\n    }\n\n    private IEnumerable<string> GetCourses(SqlConnection connection, string company)\n    {\n        // Logic to fetch courses for a company\n    }\n\n    private void ProcessCourseData(SqlConnection connection, string company, string course)\n    {\n        using (SqlCommand command = new SqlCommand("Course_NewReportGet_Get_Sav", connection))\n        {\n            command.CommandType = CommandType.StoredProcedure;\n            command.CommandTimeout = 5000; // Set command timeout\n\n            // Add parameters\n            command.Parameters.Add(new SqlParameter("@Company", company));\n            command.Parameters.Add(new SqlParameter("@Course", course));\n\n            using (SqlDataAdapter adapter = new SqlDataAdapter(command))\n            {\n                DataSet getData = new DataSet();\n                adapter.Fill(getData);\n\n                foreach (DataRow dr in getData.Tables[0].Rows)\n                {\n                    // Process each data row\n                }\n            }\n        }\n    }\n}