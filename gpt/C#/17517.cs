using System;\nusing System.Xml;\n\nvoid UpdateNode(XmlDocument xml, string nodeMustExist, string nodeToBeUpdated, string newVal)\n{\n    // Find the nodeToBeUpdated\n    XmlNode nodeToUpdate = xml.SelectSingleNode($"//{nodeToBeUpdated}");\n\n    if (nodeToUpdate != null)\n    {\n        // Update the value of the node if it exists\n        nodeToUpdate.InnerText = newVal;\n    }\n    else\n    {\n        // Find the nodeMustExist\n        XmlNode mustExistNode = xml.SelectSingleNode($"//{nodeMustExist}");\n\n        if (mustExistNode != null)\n        {\n            // Create the new nodeToBeUpdated\n            XmlElement newNode = xml.CreateElement(nodeToBeUpdated);\n            newNode.InnerText = newVal;\n\n            // Insert the new node after the nodeMustExist\n            mustExistNode.ParentNode.InsertAfter(newNode, mustExistNode);\n        }\n        else\n        {\n            throw new Exception("The required nodeMustExist was not found in the XML document.");\n        }\n    }\n}\n\n// Example usage\nvoid Main()\n{\n    XmlDocument xmlDoc = new XmlDocument();\n    xmlDoc.LoadXml(@"<root>\n                        <folder1>\n                        </folder1>\n                        <folderN>\n                            <nodeMustExist>...</nodeMustExist>\n                        </folderN>\n                     </root>");\n\n    UpdateNode(xmlDoc, "nodeMustExist", "nodeToBeUpdated", "new value");\n\n    Console.WriteLine(xmlDoc.OuterXml);\n}