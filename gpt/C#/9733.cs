using System;\nusing System.Data;\nusing System.Data.SqlClient;\nusing System.Timers;\n\npublic class DataSetHandler\n{\n    private DataSet dataSet;\n    private Timer saveTimer;\n    private string connectionString = "YourConnectionStringHere";\n\n    public DataSetHandler()\n    {\n        dataSet = new DataSet();\n        saveTimer = new Timer(300000); // Save every 5 minutes\n        saveTimer.Elapsed += SaveDataSet;\n        saveTimer.Start();\n    }\n\n    public void AddDataRow(DataRow row)\n    {\n        dataSet.Tables[0].Rows.Add(row);\n    }\n\n    private void SaveDataSet(object sender, ElapsedEventArgs e)\n    {\n        using (SqlConnection connection = new SqlConnection(connectionString))\n        {\n            connection.Open();\n            using (SqlTransaction transaction = connection.BeginTransaction())\n            {\n                try\n                {\n                    SqlDataAdapter adapter = new SqlDataAdapter("SELECT * FROM YourTable", connection);\n                    SqlCommandBuilder builder = new SqlCommandBuilder(adapter);\n\n                    adapter.SelectCommand.Transaction = transaction;\n                    adapter.Update(dataSet.Tables[0]);\n\n                    transaction.Commit();\n                }\n                catch (Exception ex)\n                {\n                    transaction.Rollback();\n                    // Handle exception (e.g., log it)\n                }\n            }\n        }\n    }\n\n    public void Dispose()\n    {\n        saveTimer.Stop();\n        saveTimer.Dispose();\n        SaveDataSet(null, null); // Save remaining data\n    }\n}