using System;\nusing System.IO;\nusing System.Runtime.InteropServices;\nusing System.Security;\nusing System.Security.Permissions;\n\npublic class Example\n{\n    public void MethodA()\n    {\n        try\n        {\n            // Your IO code that reads from a stream\n            stream.Read(...);\n        }\n        catch (IOException ioexc1)\n        {\n            if (!OkToCallUnmanaged())\n            {\n                throw ioexc1;\n            }\n\n            uint hr = GetHRForExceptionSafe(ioexc1);\n            if (hr == ...)\n            {\n                do_one_thing();\n            }\n            else\n            {\n                do_another();\n            }\n        }\n    }\n\n    private bool OkToCallUnmanaged()\n    {\n        try\n        {\n            SecurityPermission sp = new SecurityPermission(SecurityPermissionFlag.UnmanagedCode);\n            sp.Demand();\n            return true;\n        }\n        catch (SecurityException)\n        {\n            return false;\n        }\n    }\n\n    private uint GetHRForExceptionSafe(IOException ioexc1)\n    {\n        return (uint)Marshal.GetHRForException(ioexc1);\n    }\n\n    private void do_one_thing()\n    {\n        // Your implementation here\n    }\n\n    private void do_another()\n    {\n        // Your implementation here\n    }\n}