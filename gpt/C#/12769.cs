using System;\nusing System.IO;\nusing System.Xml;\nusing Microsoft.WindowsMobile.PocketOutlook;\nusing Microsoft.WindowsMobile.PocketOutlook.MessageInterception;\nusing OpenNETCF.Desktop.Communication;\n\nclass SMSArchiver\n{\n    static void Main(string[] args)\n    {\n        RAPI rapi = new RAPI();\n        \n        try\n        {\n            rapi.Connect();\n\n            // Access SMS messages using the PocketOutlook API\n            SmsMessageCollection messages = new SmsMessageCollection();\n            SmsInterceptionRule rule = new SmsInterceptionRule();\n            SmsInterceptor interceptor = new SmsInterceptor(rule);\n            messages = interceptor.GetMessages();\n\n            // Create an XML document\n            XmlDocument xmlDoc = new XmlDocument();\n            XmlElement root = xmlDoc.CreateElement("Messages");\n            xmlDoc.AppendChild(root);\n\n            foreach (SmsMessage message in messages)\n            {\n                XmlElement msgNode = xmlDoc.CreateElement("Message");\n                msgNode.SetAttribute("Sender", message.From.Address);\n                msgNode.SetAttribute("Subject", message.Subject);\n                msgNode.SetAttribute("Body", message.Body);\n                msgNode.SetAttribute("ReceivedTime", message.Received.ToString());\n\n                root.AppendChild(msgNode);\n            }\n\n            // Save the XML document to a file\n            string filePath = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments), "SMSMessages.xml");\n            xmlDoc.Save(filePath);\n\n            Console.WriteLine("Messages have been archived to " + filePath);\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine("Error: " + ex.Message);\n        }\n        finally\n        {\n            rapi.Disconnect();\n        }\n    }\n}