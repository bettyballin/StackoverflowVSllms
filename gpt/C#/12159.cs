using Mono.Cecil;\nusing System;\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        if (args.Length != 2)\n        {\n            Console.WriteLine("Usage: Set32BitFlag <assembly-path> <true|false>");\n            return;\n        }\n\n        string assemblyPath = args[0];\n        bool set32Bit = bool.Parse(args[1]);\n\n        Modify32BitFlag(assemblyPath, set32Bit);\n    }\n\n    static void Modify32BitFlag(string assemblyPath, bool set32Bit)\n    {\n        // Load the assembly\n        var assembly = AssemblyDefinition.ReadAssembly(assemblyPath);\n\n        // Get the PE headers\n        var peHeaders = assembly.MainModule.PEKind;\n\n        // Set or clear the 32BIT flag\n        if (set32Bit)\n        {\n            assembly.MainModule.Characteristics |= ModuleCharacteristics.Bit32Required;\n        }\n        else\n        {\n            assembly.MainModule.Characteristics &= ~ModuleCharacteristics.Bit32Required;\n        }\n\n        // Save the modified assembly\n        assembly.Write(assemblyPath);\n\n        Console.WriteLine($"32BIT flag has been {(set32Bit ? "set" : "cleared")} for {assemblyPath}");\n    }\n}