using System;\nusing System.ServiceModel;\nusing System.ServiceModel.Channels;\nusing System.ServiceModel.Description;\nusing System.ServiceModel.Dispatcher;\nusing System.IO;\n\npublic class MessageSizeInspector : IClientMessageInspector, IDispatchMessageInspector\n{\n    public void AfterReceiveReply(ref Message reply, object correlationState)\n    {\n        LogMessageSize(reply);\n    }\n\n    public object BeforeSendRequest(ref Message request, IClientChannel channel)\n    {\n        LogMessageSize(request);\n        return null;\n    }\n\n    public void AfterReceiveRequest(ref Message request, IClientChannel channel, InstanceContext instanceContext)\n    {\n        LogMessageSize(request);\n    }\n\n    public void BeforeSendReply(ref Message reply, object correlationState)\n    {\n        LogMessageSize(reply);\n    }\n\n    private void LogMessageSize(Message message)\n    {\n        using (MemoryStream stream = new MemoryStream())\n        using (XmlWriter writer = XmlWriter.Create(stream))\n        {\n            message.WriteMessage(writer);\n            writer.Flush();\n            long messageSize = stream.Length;\n            Console.WriteLine($"Message size: {messageSize} bytes");\n        }\n    }\n}\n\npublic class MessageSizeBehavior : IEndpointBehavior\n{\n    public void AddBindingParameters(ServiceEndpoint endpoint, BindingParameterCollection bindingParameters) { }\n\n    public void ApplyClientBehavior(ServiceEndpoint endpoint, ClientRuntime clientRuntime)\n    {\n        clientRuntime.MessageInspectors.Add(new MessageSizeInspector());\n    }\n\n    public void ApplyDispatchBehavior(ServiceEndpoint endpoint, EndpointDispatcher endpointDispatcher)\n    {\n        endpointDispatcher.DispatchRuntime.MessageInspectors.Add(new MessageSizeInspector());\n    }\n\n    public void Validate(ServiceEndpoint endpoint) { }\n}\n\nclass Program\n{\n    static void Main()\n    {\n        // Example for applying behavior to a WCF service host\n        Uri baseAddress = new Uri("http://localhost:8080/YourService");\n        using (ServiceHost host = new ServiceHost(typeof(YourService), baseAddress))\n        {\n            foreach (ServiceEndpoint endpoint in host.Description.Endpoints)\n            {\n                endpoint.EndpointBehaviors.Add(new MessageSizeBehavior());\n            }\n            host.Open();\n            Console.WriteLine("Service is running...");\n            Console.ReadLine();\n            host.Close();\n        }\n\n        // Example for applying behavior to a WCF client\n        ChannelFactory<IYourService> factory = new ChannelFactory<IYourService>(new BasicHttpBinding(), new EndpointAddress("http://localhost:8080/YourService"));\n        factory.Endpoint.EndpointBehaviors.Add(new MessageSizeBehavior());\n        IYourService client = factory.CreateChannel();\n        // Use client to call service methods\n    }\n}