private void CertificateSetup(ServiceHost host)\n{\n    if (ServiceCertificate != null)\n        host.Credentials.ServiceCertificate.Certificate = ServiceCertificate;\n\n    X509ClientCertificateAuthentication authentication = host.Credentials.ClientCertificate.Authentication;\n\n    authentication.CertificateValidationMode = X509CertificateValidationMode.Custom;\n    authentication.CustomCertificateValidator = new CustomCertificateValidator(new[] { ClientCertificate });\n\n    // Add custom service authorization manager\n    host.Authorization.ServiceAuthorizationManager = new CustomServiceAuthorizationManager();\n}