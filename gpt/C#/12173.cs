using System;\nusing System.Net;\nusing System.Net.Sockets;\nusing Microsoft.WindowsMobile.PocketOutlook;\n\nnamespace SmsServiceApp\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            StartServer();\n        }\n\n        static void StartServer()\n        {\n            TcpListener listener = new TcpListener(IPAddress.Any, 12345);\n            listener.Start();\n            Console.WriteLine("Server started. Waiting for connection...");\n\n            while (true)\n            {\n                TcpClient client = listener.AcceptTcpClient();\n                Console.WriteLine("Client connected.");\n                NetworkStream stream = client.GetStream();\n\n                // Retrieve SMS messages\n                SmsMessageCollection messages = RetrieveSmsMessages();\n                string response = SerializeMessages(messages);\n\n                // Send SMS data to client\n                byte[] data = System.Text.Encoding.UTF8.GetBytes(response);\n                stream.Write(data, 0, data.Length);\n\n                client.Close();\n            }\n        }\n\n        static SmsMessageCollection RetrieveSmsMessages()\n        {\n            SmsMessageCollection messages = new SmsMessageCollection();\n            ItemCollection items = new SmsAccount().SmsFolder.Items;\n            \n            foreach (Item item in items)\n            {\n                if (item is SmsMessage)\n                {\n                    messages.Add((SmsMessage)item);\n                }\n            }\n\n            return messages;\n        }\n\n        static string SerializeMessages(SmsMessageCollection messages)\n        {\n            // Convert messages to JSON or another suitable format\n            // For simplicity, just returning a count here\n            return $"Total messages: {messages.Count}";\n        }\n    }\n}