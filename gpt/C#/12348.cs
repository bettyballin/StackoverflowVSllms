using System;\nusing System.IO;\nusing System.Web;\nusing System.Web.SessionState;\n\npublic class ImageHandler : IHttpHandler, IRequiresSessionState\n{\n    public void ProcessRequest(HttpContext context)\n    {\n        // Generating a unique filename using session ID and a GUID\n        string sessionId = context.Session.SessionID;\n        string uniqueFileName = $"{sessionId}_{Guid.NewGuid()}.png";\n        string filePath = Path.Combine(context.Server.MapPath("~/TempImages"), uniqueFileName);\n\n        // Save the image to the file system (example, you should replace this with actual image generation code)\n        SaveImage(filePath);\n\n        // Store the file path in the session for later cleanup\n        var sessionFiles = context.Session["SessionFiles"] as List<string>;\n        if (sessionFiles == null)\n        {\n            sessionFiles = new List<string>();\n            context.Session["SessionFiles"] = sessionFiles;\n        }\n        sessionFiles.Add(filePath);\n\n        // Return the URL of the image or perform further processing\n        context.Response.ContentType = "text/plain";\n        context.Response.Write($"Image saved at {filePath}");\n    }\n\n    private void SaveImage(string filePath)\n    {\n        // Example image save logic\n        using (var bitmap = new Bitmap(100, 100))\n        {\n            using (var g = Graphics.FromImage(bitmap))\n            {\n                g.Clear(Color.White);\n                g.DrawString("Hello, World!", new Font("Arial", 12), Brushes.Black, new PointF(10, 40));\n            }\n            bitmap.Save(filePath);\n        }\n    }\n\n    public bool IsReusable => false;\n}\n\npublic class Global : HttpApplication\n{\n    protected void Session_End(object sender, EventArgs e)\n    {\n        var sessionFiles = Session["SessionFiles"] as List<string>;\n        if (sessionFiles != null)\n        {\n            foreach (var filePath in sessionFiles)\n            {\n                if (File.Exists(filePath))\n                {\n                    File.Delete(filePath);\n                }\n            }\n        }\n    }\n}