using System;\nusing Microsoft.SqlServer.Management.Smo;\nusing Microsoft.SqlServer.Management.Common;\nusing System.Data.SqlClient;\nusing System.Security.Principal;\n\nclass Program\n{\n    static void Main()\n    {\n        string instanceName = "YourInstanceName"; // Replace with your instance name\n        string connectionString = $"Server={instanceName};Integrated Security=True;";\n\n        using (SqlConnection connection = new SqlConnection(connectionString))\n        {\n            ServerConnection serverConnection = new ServerConnection(connection);\n            Server server = new Server(serverConnection);\n\n            string defaultDataPath = server.Settings.DefaultFile;\n            string defaultLogPath = server.Settings.DefaultLog;\n            Console.WriteLine($"Default Data Path: {defaultDataPath}");\n            Console.WriteLine($"Default Log Path: {defaultLogPath}");\n\n            // Get the SQL Server service account\n            string query = "SELECT servicename, service_account FROM sys.dm_server_services WHERE servicename LIKE 'SQL Server (%'";\n            SqlCommand command = new SqlCommand(query, connection);\n\n            connection.Open();\n            SqlDataReader reader = command.ExecuteReader();\n            while (reader.Read())\n            {\n                string serviceName = reader["servicename"].ToString();\n                string serviceAccount = reader["service_account"].ToString();\n                Console.WriteLine($"Service Name: {serviceName}, Service Account: {serviceAccount}");\n                \n                // Grant read access to the extracted backup file (example path)\n                string backupFilePath = @"C:\path\to\your\backupfile.bak";\n                GrantReadAccessToFile(serviceAccount, backupFilePath);\n            }\n            connection.Close();\n        }\n    }\n\n    static void GrantReadAccessToFile(string accountName, string filePath)\n    {\n        FileSecurity fileSecurity = File.GetAccessControl(filePath);\n        fileSecurity.AddAccessRule(new FileSystemAccessRule(accountName, FileSystemRights.Read, AccessControlType.Allow));\n        File.SetAccessControl(filePath, fileSecurity);\n    }\n}