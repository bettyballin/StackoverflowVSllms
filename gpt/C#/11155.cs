using System;\nusing System.Text.RegularExpressions;\n\npublic static class XmlEncoder\n{\n    private static readonly Lazy<Regex> badAmpersand = new Lazy<Regex>(() => new Regex("&(?![a-zA-Z]{2,6};|#[0-9]{2,4};)"));\n\n    public static string EncodeForXml(string data)\n    {\n        data = badAmpersand.Value.Replace(data, "&amp;");\n\n        // More processing\n\n        return data;\n    }\n}