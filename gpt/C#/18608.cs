using System;\nusing System.IO;\nusing MailKit.Net.Pop3;\nusing MimeKit;\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        // Define your email server settings\n        string host = "pop.your-email-provider.com";\n        int port = 995; // Typically, POP3 over SSL/TLS uses port 995\n        bool useSsl = true;\n        string username = "your-email@example.com";\n        string password = "your-email-password";\n\n        using (var client = new Pop3Client())\n        {\n            try\n            {\n                // Connect to the POP3 server\n                client.Connect(host, port, useSsl);\n\n                // Authenticate with the server\n                client.Authenticate(username, password);\n\n                // Get the number of messages in the inbox\n                int messageCount = client.Count;\n\n                for (int i = 0; i < messageCount; i++)\n                {\n                    // Get the email message\n                    MimeMessage message = client.GetMessage(i);\n\n                    // Process the email content - assuming it's XML\n                    string emailContent = message.TextBody;\n\n                    if (!string.IsNullOrEmpty(emailContent))\n                    {\n                        // Save email content to a file, or process it as needed\n                        File.WriteAllText($"email_{i}.xml", emailContent);\n                        Console.WriteLine($"Email {i} processed and saved.");\n                    }\n                }\n\n                // Optionally, delete messages after processing\n                // for (int i = 0; i < messageCount; i++)\n                // {\n                //     client.DeleteMessage(i);\n                // }\n\n                // Disconnect from the server\n                client.Disconnect(true);\n            }\n            catch (Exception ex)\n            {\n                Console.WriteLine($"An error occurred: {ex.Message}");\n            }\n        }\n    }\n}