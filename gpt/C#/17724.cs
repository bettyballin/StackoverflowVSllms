using System;\nusing System.Runtime.InteropServices;\n\npublic class Program\n{\n    [DllImport("kernel32.dll")]\n    static extern IntPtr GetConsoleWindow();\n\n    public static void Main()\n    {\n        if (IsConsoleApplication())\n        {\n            Console.WriteLine("Running in a console application.");\n        }\n        else\n        {\n            // Code to log to Windows Event Log\n            LogToEventLog("Running in a Windows application.");\n        }\n    }\n\n    public static bool IsConsoleApplication()\n    {\n        return GetConsoleWindow() != IntPtr.Zero;\n    }\n\n    public static void LogToEventLog(string message)\n    {\n        // Implementation to log to Windows Event Log\n        // For example:\n        // using System.Diagnostics;\n        // EventLog.WriteEntry("ApplicationName", message, EventLogEntryType.Information);\n    }\n}