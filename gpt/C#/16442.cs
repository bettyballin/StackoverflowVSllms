using System;\nusing System.Diagnostics;\nusing System.Runtime.InteropServices;\nusing System.Threading;\nusing FlaUI.Core;\nusing FlaUI.UIA3;\n\nclass Program\n{\n    [DllImport("user32.dll")]\n    private static extern bool SetForegroundWindow(IntPtr hWnd);\n\n    static void Main()\n    {\n        using (var automation = new UIA3Automation())\n        {\n            var app = FlaUI.Core.Application.Launch("PathToYourWpfApp.exe");\n            var mainWindow = app.GetMainWindow(automation);\n\n            // Bring the main window to the foreground\n            SetForegroundWindow(mainWindow.Properties.NativeWindowHandle);\n\n            // Add a short delay to ensure the window is in the foreground\n            Thread.Sleep(1000);\n\n            // Perform your UI automation tasks here\n            var elementToRightClick = mainWindow.FindFirstDescendant(cf => cf.ByAutomationId("YourElementAutomationId"));\n            elementToRightClick?.RightClick();\n\n            var menuItem = mainWindow.FindFirstDescendant(cf => cf.ByName("MenuItemName"));\n            menuItem?.Click();\n\n            app.Close();\n        }\n    }\n}