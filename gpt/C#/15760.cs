using System;\nusing System.Net;\nusing System.Net.Mail;\n\npublic class EmailSender\n{\n    private readonly SmtpClient _smtpClient;\n\n    public EmailSender(string host, int port, string username, string password)\n    {\n        _smtpClient = new SmtpClient(host, port)\n        {\n            Credentials = new NetworkCredential(username, password),\n            EnableSsl = true\n        };\n    }\n\n    public void SendEmails(IEnumerable<MailMessage> mailMessages)\n    {\n        try\n        {\n            _smtpClient.SendCompleted += (s, e) => {\n                // Handle send completed event if needed\n            };\n\n            foreach (var mailMessage in mailMessages)\n            {\n                _smtpClient.Send(mailMessage);\n            }\n        }\n        catch (Exception ex)\n        {\n            // Handle exceptions\n            Console.WriteLine($"Error sending email: {ex.Message}");\n        }\n        finally\n        {\n            _smtpClient.Dispose(); // Close connection\n        }\n    }\n}\n\n// Usage\nvar emailSender = new EmailSender("smtp.example.com", 587, "yourUsername", "yourPassword");\n\nvar emails = new List<MailMessage>\n{\n    new MailMessage("from@example.com", "to1@example.com", "Subject 1", "Body 1"),\n    new MailMessage("from@example.com", "to2@example.com", "Subject 2", "Body 2"),\n    // Add more emails\n};\n\nemailSender.SendEmails(emails);