using System;\nusing System.Runtime.InteropServices.Automation;\n\npublic string GetWindowsUsername()\n{\n    if (AutomationFactory.IsAvailable)\n    {\n        dynamic shell = AutomationFactory.CreateObject("WScript.Shell");\n        string userName = shell.ExpandEnvironmentStrings("%USERNAME%");\n        return userName;\n    }\n    else\n    {\n        throw new InvalidOperationException("Automation not available.");\n    }\n}