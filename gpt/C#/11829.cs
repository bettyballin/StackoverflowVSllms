using System;\nusing System.Data;\nusing System.ServiceModel;\n\npublic class DataServiceClient : IDataService, IClientCallback\n{\n    private IDataService _proxy;\n    private DataSet _localCache = new DataSet();\n\n    public DataServiceClient()\n    {\n        InstanceContext context = new InstanceContext(this);\n        NetNamedPipeBinding binding = new NetNamedPipeBinding(NetNamedPipeSecurityMode.Transport);\n        binding.Security.Transport.ProtectionLevel = System.Net.Security.ProtectionLevel.EncryptAndSign;\n\n        DuplexChannelFactory<IDataService> factory = new DuplexChannelFactory<IDataService>(context, binding, new EndpointAddress("net.pipe://localhost/DataService"));\n        _proxy = factory.CreateChannel();\n    }\n\n    public DataSet GetData()\n    {\n        _localCache = _proxy.GetData();\n        return _localCache;\n    }\n\n    public void RefreshData()\n    {\n        _proxy.RefreshData();\n    }\n\n    public void OnDataChanged()\n    {\n        Console.WriteLine("Data has changed. Refreshing local cache...");\n        GetData();\n    }\n}