using System;\nusing System.DirectoryServices.Protocols;\nusing System.Net;\n\nclass Program\n{\n    static void Main()\n    {\n        string ldapServer = "ldap.example.com";\n        string ldapUser = "cn=admin,dc=example,dc=com";\n        string ldapPassword = "password";\n        string searchBase = "dc=example,dc=com";\n        string searchFilter = "(objectClass=person)";\n\n        try\n        {\n            LdapDirectoryIdentifier identifier = new LdapDirectoryIdentifier(ldapServer);\n            NetworkCredential credentials = new NetworkCredential(ldapUser, ldapPassword);\n            LdapConnection connection = new LdapConnection(identifier, credentials);\n\n            connection.AuthType = AuthType.Basic;\n            connection.Bind();\n\n            SearchRequest searchRequest = new SearchRequest(searchBase, searchFilter, SearchScope.Subtree);\n            SearchResponse searchResponse = (SearchResponse)connection.SendRequest(searchRequest);\n\n            foreach (SearchResultEntry entry in searchResponse.Entries)\n            {\n                Console.WriteLine($"DN: {entry.DistinguishedName}");\n                foreach (var attribute in entry.Attributes.Values)\n                {\n                    foreach (var value in attribute)\n                    {\n                        Console.WriteLine($"{attribute.Name}: {value}");\n                    }\n                }\n            }\n        }\n        catch (LdapException ex)\n        {\n            Console.WriteLine($"LDAP Error: {ex.Message}");\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine($"Error: {ex.Message}");\n        }\n    }\n}