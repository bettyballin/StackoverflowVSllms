using System;\nusing System.Windows.Forms;\n\npublic class RichTextBoxDataGridView : DataGridView\n{\n    public RichTextBoxDataGridView()\n    {\n        this.CellPainting += new DataGridViewCellPaintingEventHandler(OnCellPainting);\n    }\n\n    protected override void OnEditingControlShowing(DataGridViewEditingControlShowingEventArgs e)\n    {\n        base.OnEditingControlShowing(e);\n        RichTextBox richTextBox = e.Control as RichTextBox;\n        if (richTextBox != null)\n        {\n            richTextBox.Multiline = true;\n        }\n    }\n\n    private void OnCellPainting(object sender, DataGridViewCellPaintingEventArgs e)\n    {\n        if (e.RowIndex >= 0 && e.ColumnIndex >= 0)\n        {\n            e.PaintBackground(e.CellBounds, true);\n\n            RichTextBox richTextBox = this[e.ColumnIndex, e.RowIndex].Value as RichTextBox;\n            if (richTextBox != null)\n            {\n                richTextBox.Bounds = e.CellBounds;\n                richTextBox.BorderStyle = BorderStyle.None;\n                richTextBox.ScrollBars = RichTextBoxScrollBars.None;\n\n                using (Bitmap bmp = new Bitmap(richTextBox.Width, richTextBox.Height))\n                {\n                    richTextBox.DrawToBitmap(bmp, new Rectangle(0, 0, bmp.Width, bmp.Height));\n                    e.Graphics.DrawImage(bmp, e.CellBounds.Location);\n                }\n            }\n\n            e.Handled = true;\n        }\n    }\n\n    public override object Clone()\n    {\n        var clone = (RichTextBoxDataGridView)base.Clone();\n        clone.CellPainting -= OnCellPainting;\n        clone.CellPainting += OnCellPainting;\n        return clone;\n    }\n\n    protected override void Dispose(bool disposing)\n    {\n        if (disposing)\n        {\n            this.CellPainting -= OnCellPainting;\n        }\n        base.Dispose(disposing);\n    }\n}\n\npublic class MainForm : Form\n{\n    public MainForm()\n    {\n        RichTextBoxDataGridView dgv = new RichTextBoxDataGridView();\n        dgv.Dock = DockStyle.Fill;\n        dgv.Columns.Add(new DataGridViewTextBoxColumn() { HeaderText = "Column1" });\n        dgv.Rows.Add(3);\n\n        RichTextBox richTextBox1 = new RichTextBox();\n        richTextBox1.Text = "RichText Cell 1";\n        richTextBox1.SelectionColor = System.Drawing.Color.Red;\n        dgv[0, 0].Value = richTextBox1;\n\n        RichTextBox richTextBox2 = new RichTextBox();\n        richTextBox2.Text = "RichText Cell 2";\n        richTextBox2.SelectionColor = System.Drawing.Color.Green;\n        dgv[0, 1].Value = richTextBox2;\n\n        RichTextBox richTextBox3 = new RichTextBox();\n        richTextBox3.Text = "RichText Cell 3";\n        richTextBox3.SelectionColor = System.Drawing.Color.Blue;\n        dgv[0, 2].Value = richTextBox3;\n\n        this.Controls.Add(dgv);\n    }\n\n    [STAThread]\n    static void Main()\n    {\n        Application.EnableVisualStyles();\n        Application.Run(new MainForm());\n    }\n}