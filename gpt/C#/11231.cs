if (!currentUser.hasAccessTo(resourceId)) {\n       throw new UnauthorizedAccessException();\n   }