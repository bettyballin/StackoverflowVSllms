private void Copy(string srcFile, string dstFile, int offset, int length)\n{\n    const int bufferSize = 81920; // 80 KB buffer size\n\n    using (FileStream srcStream = new FileStream(srcFile, FileMode.Open, FileAccess.Read, FileShare.Read, bufferSize, FileOptions.SequentialScan))\n    using (FileStream dstStream = new FileStream(dstFile, FileMode.Create, FileAccess.Write, FileShare.None, bufferSize, FileOptions.SequentialScan))\n    {\n        srcStream.Seek(offset, SeekOrigin.Begin);\n        byte[] buffer = new byte[bufferSize];\n        int remainingBytes = length;\n\n        while (remainingBytes > 0)\n        {\n            int bytesToRead = Math.Min(bufferSize, remainingBytes);\n            int bytesRead = srcStream.Read(buffer, 0, bytesToRead);\n            if (bytesRead == 0)\n            {\n                break; // End of source file reached unexpectedly\n            }\n            dstStream.Write(buffer, 0, bytesRead);\n            remainingBytes -= bytesRead;\n        }\n    }\n}