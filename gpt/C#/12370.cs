public static ServiceControllerStatus FindService(string domain, string username, string password)\n{\n    ServiceControllerStatus status = ServiceControllerStatus.Stopped;\n\n    try\n    {\n        using (var impersonation = new Impersonation(domain, username, password))\n        {\n            string machineName = ConfigurationManager.AppSettings["ServiceMachineName"];\n            ServiceController[] services = ServiceController.GetServices(machineName);\n            string serviceName = ConfigurationManager.AppSettings["ServiceName"].ToLower();\n\n            foreach (ServiceController service in services)\n            {\n                if (service.ServiceName.ToLower() == serviceName)\n                {\n                    status = service.Status;\n                    break;\n                }\n            }\n        }\n    }\n    catch (Exception ex)\n    {\n        status = ServiceControllerStatus.Stopped;\n        SaveError(ex, "Utilities - FindService()");\n    }\n\n    return status;\n}