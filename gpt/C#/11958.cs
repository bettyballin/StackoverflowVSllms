using System;\nusing System.DirectoryServices.AccountManagement;\nusing System.Linq;\n\nclass Program\n{\n    static void Main()\n    {\n        // Define the domain context\n        using (PrincipalContext context = new PrincipalContext(ContextType.Domain, "YOUR_DOMAIN"))\n        {\n            // Define a user principal object to search for users\n            UserPrincipal userPrincipal = new UserPrincipal(context);\n\n            // Define a principal searcher for querying\n            PrincipalSearcher searcher = new PrincipalSearcher(userPrincipal);\n\n            // Execute the query and cast the results to UserPrincipal\n            var users = searcher.FindAll().Cast<UserPrincipal>();\n\n            // Example: Select distinct departments\n            var departments = users\n                .Where(u => !string.IsNullOrEmpty(u.VoiceTelephoneNumber)) // Example filter, adjust as needed\n                .Select(u => u.VoiceTelephoneNumber)\n                .Distinct();\n\n            // Output the results\n            foreach (var department in departments)\n            {\n                Console.WriteLine(department);\n            }\n        }\n    }\n}