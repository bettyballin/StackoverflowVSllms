public class MyWindowsService : ServiceBase\n{\n    public ServiceHost serviceHost = null;\n\n    public MyWindowsService()\n    {\n        ServiceName = "MyWindowsService";\n    }\n\n    protected override void OnStart(string[] args)\n    {\n        if (serviceHost != null)\n        {\n            serviceHost.Close();\n        }\n\n        serviceHost = new ServiceHost(typeof(MyService));\n        serviceHost.Open();\n    }\n\n    protected override void OnStop()\n    {\n        if (serviceHost != null)\n        {\n            serviceHost.Close();\n            serviceHost = null;\n        }\n    }\n\n    public static void Main()\n    {\n        ServiceBase.Run(new MyWindowsService());\n    }\n}