using System.ServiceModel;\nusing System.ServiceModel.Dispatcher;\nusing System.ServiceModel.Channels;\n\npublic class HttpErrorInspector : IClientMessageInspector\n{\n    public void AfterReceiveReply(ref Message reply, object correlationState)\n    {\n        HttpResponseMessageProperty httpResponse = reply.Properties[HttpResponseMessageProperty.Name] as HttpResponseMessageProperty;\n        if (httpResponse != null && httpResponse.StatusCode != System.Net.HttpStatusCode.OK)\n        {\n            throw new WebException($"HTTP Error: {httpResponse.StatusCode} - {httpResponse.StatusDescription}");\n        }\n    }\n\n    public object BeforeSendRequest(ref Message request, IClientChannel channel)\n    {\n        return null;\n    }\n}