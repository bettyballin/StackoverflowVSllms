using System;\nusing System.IO;\nusing System.Web;\n\npublic class MockHttpRequest : SimpleWorkerRequest\n{\n    private string _Host;\n\n    public MockHttpRequest(\n        string appVirtualDir, string appPhysicalDir, string page, string query, TextWriter output, string host) :\n        base(appVirtualDir, appPhysicalDir, page, query, output)\n    {\n        if (string.IsNullOrEmpty(host))\n        {\n            throw new ArgumentException("Host must be provided.");\n        }\n\n        _Host = host;\n    }\n\n    public override string GetProtocol()\n    {\n        return "HTTPS/1.1";\n    }\n\n    public override string GetHttpVerbName()\n    {\n        return "GET";\n    }\n\n    public override string GetLocalAddress()\n    {\n        return _Host;\n    }\n\n    public override int GetLocalPort()\n    {\n        return 443;\n    }\n}\n\npublic static class UnitTestingHelper\n{\n    public static HttpContext CreateMockHttpContext(string host, string page)\n    {\n        string appVirtualDir = "/";\n        string appPhysicalDir = @"C:\Documents and Settings\user\My Documents\Workspace\Project\";\n        string query = string.Empty;\n        TextWriter output = null;\n\n        MockHttpRequest request\n            = new MockHttpRequest(appVirtualDir, appPhysicalDir, page, query, output, host);\n\n        HttpContext context = new HttpContext(request);\n\n        return context;\n    }\n}