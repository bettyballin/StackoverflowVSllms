private void saveBtn_Click(object sender, EventArgs e)\n{\n    try\n    {\n        // save everything and close\n        string attachment = attachTxtBox.Text;\n\n        // Get the absolute path of the config file\n        string configFileName = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, "email.config");\n\n        var configMap = new ExeConfigurationFileMap { ExeConfigFilename = configFileName };\n        // Open the configuration file using the absolute path\n        Configuration externalConfig = ConfigurationManager.OpenMappedExeConfiguration(configMap, ConfigurationUserLevel.None);\n\n        externalConfig.AppSettings.Settings["ServerAddress"].Value = serverAddr;\n        externalConfig.AppSettings.Settings["Port"].Value = port;\n        externalConfig.AppSettings.Settings["SSL"].Value = ssl.ToString();\n        externalConfig.AppSettings.Settings["Sender"].Value = senderAddr;\n        externalConfig.AppSettings.Settings["SenderPassword"].Value = password;\n        externalConfig.AppSettings.Settings["Subject"].Value = subject;\n        externalConfig.AppSettings.Settings["AttachmentPath"].Value = attachment;\n        externalConfig.AppSettings.Settings["Body"].Value = messageBody;\n\n        // Save values in config\n        externalConfig.Save(ConfigurationSaveMode.Full);\n        Application.Exit();\n    }\n    catch (System.Exception ex)\n    {\n        MessageBox.Show("Error: " + ex.Message);\n        Application.Exit();\n    }\n}