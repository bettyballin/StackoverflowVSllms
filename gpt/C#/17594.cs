{\n    int numApprovals = 0;\n    string sql = "SELECT COUNT(Type) AS OpenforApproval " +\n       "FROM dbo.LeaveRequest " +\n       "WHERE Type IN (2, 3, 4, 5, 6, 8, 13, 14, 16, 22) " +\n       "GROUP BY MgtApproval " +\n       "HAVING MgtApproval IS NULL";\n\n    using (SqlConnection cn = new SqlConnection(ConnectionString()))\n    {\n        cn.Open();\n        using (SqlCommand cmd = new SqlCommand(sql, cn))\n        {\n            cmd.CommandType = CommandType.Text;\n            object result = cmd.ExecuteScalar();\n            if (result != null && result != DBNull.Value)\n            {\n                numApprovals = Convert.ToInt32(result);\n            }\n        }\n    }\n\n    return numApprovals;\n}