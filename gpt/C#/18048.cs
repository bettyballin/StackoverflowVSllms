using (SqlConnection sourceConn = new SqlConnection("SourceConnectionString"))\nusing (SqlConnection destConn = new SqlConnection("DestinationConnectionString"))\n{\n    sourceConn.Open();\n    destConn.Open();\n\n    SqlCommand selectCmd = new SqlCommand("SELECT * FROM ChildTable WHERE ParentID IN (SELECT OldPK FROM #PKMapping)", sourceConn);\n    SqlDataReader reader = selectCmd.ExecuteReader();\n\n    while (reader.Read())\n    {\n        // Get new ParentID from mapping table\n        SqlCommand mapCmd = new SqlCommand("SELECT NewPK FROM #PKMapping WHERE OldPK = @OldPK", destConn);\n        mapCmd.Parameters.AddWithValue("@OldPK", reader["ParentID"]);\n        int newParentID = (int)mapCmd.ExecuteScalar();\n\n        // Insert into Destination Child Table\n        SqlCommand insertCmd = new SqlCommand("INSERT INTO ChildTable (ParentID, Column1) VALUES (@ParentID, @Column1)", destConn);\n        insertCmd.Parameters.AddWithValue("@ParentID", newParentID);\n        insertCmd.Parameters.AddWithValue("@Column1", reader["Column1"]);\n        insertCmd.ExecuteNonQuery();\n    }\n}