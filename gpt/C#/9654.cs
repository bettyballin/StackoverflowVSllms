using System;\nusing System.Windows;\nusing System.Text; // For StringBuilder\n\nclass Program {\n    [STAThread]\n    static void Main(string[] args) {\n        Console.WriteLine("Copy a small amount of text from a browser, then press enter.");\n        Console.ReadLine();\n\n        var text = Clipboard.GetText();\n        Console.WriteLine();\n        Console.WriteLine("--->The clipboard as Text:");\n        Console.WriteLine(text);\n\n        Console.WriteLine();\n        Console.WriteLine("--->Rewriting clipboard with the same CF_HTML data.");\n\n        var html = Clipboard.GetText(TextDataFormat.Html);\n        \n        // Ensure the HTML format follows the clipboard HTML format specification\n        var htmlFragment = GetHtmlClipboardFragment(html);\n        \n        Clipboard.Clear();\n        Clipboard.SetText(htmlFragment, TextDataFormat.Html);\n\n        var text2 = Clipboard.GetText();\n        Console.WriteLine();\n        Console.WriteLine("--->The clipboard as Text:");\n        Console.WriteLine(text2);\n\n        var isSameText = (text == text2);\n        Console.WriteLine();\n        Console.WriteLine(isSameText ? "Success" : "Failure");\n\n        Console.WriteLine();\n        Console.WriteLine("Press enter to exit.");\n        Console.ReadLine();\n    }\n\n    private static string GetHtmlClipboardFragment(string html) {\n        var sb = new StringBuilder();\n        sb.AppendLine("Version:0.9");\n        sb.AppendLine("StartHTML:00000097");\n        sb.AppendLine("EndHTML:" + (97 + html.Length).ToString("D8"));\n        sb.AppendLine("StartFragment:00000133");\n        sb.AppendLine("EndFragment:" + (133 + html.Length).ToString("D8"));\n        sb.AppendLine("<html><body><!--StartFragment-->")\n          .Append(html)\n          .Append("<!--EndFragment--></body></html>");\n        \n        return sb.ToString();\n    }\n}