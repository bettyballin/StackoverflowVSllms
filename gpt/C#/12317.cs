using System;\n   using System.IO.Pipes;\n   using System.Text;\n\n   public class MyService\n   {\n       public void SendMessageToGui(string message)\n       {\n           using (var pipeClient = new NamedPipeClientStream(".", "MyPipe", PipeDirection.Out))\n           {\n               pipeClient.Connect();\n               byte[] bytes = Encoding.UTF8.GetBytes(message);\n               pipeClient.Write(bytes, 0, bytes.Length);\n           }\n       }\n   }