using Microsoft.Office.Core;\n\n   public void AddMenuItem()\n   {\n       CommandBar commandBar = ((CommandBars)application.CommandBars)["Menu Bar"];\n       CommandBarPopup menu = (CommandBarPopup)commandBar.Controls.Add(MsoControlType.msoControlPopup, missing, missing, missing, true);\n       menu.Caption = "My Custom Menu";\n\n       CommandBarButton button = (CommandBarButton)menu.Controls.Add(MsoControlType.msoControlButton, missing, missing, missing, true);\n       button.Caption = "My Button";\n       button.Click += new _CommandBarButtonEvents_ClickEventHandler(Button_Click);\n   }\n\n   private void Button_Click(CommandBarButton Ctrl, ref bool CancelDefault)\n   {\n       // Handle button click\n   }