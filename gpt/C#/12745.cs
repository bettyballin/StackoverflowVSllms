using System;\nusing System.Collections;\nusing System.Windows.Forms;\nusing System.IO;\n\npublic class ListViewSorter : IComparer\n{\n    private int columnIndex;\n    private bool ascending;\n\n    public ListViewSorter(int columnIndex, bool ascending)\n    {\n        this.columnIndex = columnIndex;\n        this.ascending = ascending;\n    }\n\n    public int Compare(object x, object y)\n    {\n        ListViewItem item1 = (ListViewItem)x;\n        ListViewItem item2 = (ListViewItem)y;\n\n        long size1 = long.Parse(item1.SubItems[columnIndex].Text);\n        long size2 = long.Parse(item2.SubItems[columnIndex].Text);\n\n        int result = size1.CompareTo(size2);\n        return ascending ? result : -result;\n    }\n}\n\n// Your method to get the dynamic file size\npublic static string GetDynamicFileSize(string fileName)\n{\n    FileInfo fi = new FileInfo(fileName);\n    long sizeInBytes = fi.Length;\n    if (sizeInBytes >= 1073741824)\n    {\n        double sizeInGB = sizeInBytes / Math.Pow(1024, 3);\n        return Math.Round(sizeInGB, 2) + " GB";\n    }\n\n    if (sizeInBytes >= 1048576)\n    {\n        double sizeInMB = sizeInBytes / Math.Pow(1024, 2);\n        return Math.Round(sizeInMB, 2) + " MB";\n    }\n\n    if (sizeInBytes >= 1024)\n    {\n        double sizeInKB = sizeInBytes / Math.Pow(1024, 1);\n        return Math.Round(sizeInKB, 2) + " KB";\n    }\n\n    return sizeInBytes + " bytes";\n}\n\n// Your method to add items to the ListView\npublic void AddFileToListView(ListView listView, string fileName)\n{\n    FileInfo fi = new FileInfo(fileName);\n    string sizeText = GetDynamicFileSize(fileName);\n\n    ListViewItem item = new ListViewItem(new string[]\n    {\n        fi.Name,\n        fi.Extension,\n        sizeText,\n        fi.DirectoryName,\n        fi.Length.ToString()  // Hidden column for sorting\n    });\n\n    // Add item to ListView\n    listView.Items.Add(item);\n}\n\n// Example of setting the sorter on column click\nprivate void listView1_ColumnClick(object sender, ColumnClickEventArgs e)\n{\n    bool ascending = true; // Toggle sort direction as needed\n    listView1.ListViewItemSorter = new ListViewSorter(e.Column, ascending);\n    listView1.Sort();\n}