using System;\nusing System.Drawing;\nusing System.Drawing.Imaging;\nusing System.IO;\nusing System.Text;\nusing System.Windows.Forms;\n\npublic class RichTextBoxWithImage\n{\n    public static void InsertImage(RichTextBox richTextBox, Image image)\n    {\n        if (image == null) throw new ArgumentNullException(nameof(image));\n\n        // Convert the image to a byte array\n        using (MemoryStream ms = new MemoryStream())\n        {\n            image.Save(ms, ImageFormat.Png);\n            byte[] imageBytes = ms.ToArray();\n\n            // Create a hex string from the byte array\n            StringBuilder hex = new StringBuilder(imageBytes.Length * 2);\n            foreach (byte b in imageBytes)\n            {\n                hex.AppendFormat("{0:X2}", b);\n            }\n\n            // Prepare the RTF image string\n            string rtfImage = @"{\pict\pngblip\picw" + (image.Width * 15) + @"\pich" + (image.Height * 15) + @"\picwgoal" + (image.Width * 15) + @"\pichgoal" + (image.Height * 15) + @"\ " + hex.ToString() + "}";\n            \n            // Insert the image RTF string into the RichTextBox\n            richTextBox.SelectedRtf = rtfImage;\n        }\n    }\n}\n\n// Example usage\npublic class TestForm : Form\n{\n    public TestForm()\n    {\n        RichTextBox richTextBox = new RichTextBox { Dock = DockStyle.Fill };\n        this.Controls.Add(richTextBox);\n        \n        // Load an image from a file or resource\n        Image image = Image.FromFile("example.png");\n        \n        // Insert the image into the RichTextBox\n        RichTextBoxWithImage.InsertImage(richTextBox, image);\n    }\n    \n    [STAThread]\n    public static void Main()\n    {\n        Application.EnableVisualStyles();\n        Application.SetCompatibleTextRenderingDefault(false);\n        Application.Run(new TestForm());\n    }\n}