public class Tracker\n   {\n       private HttpSessionState _session;\n\n       public Tracker(HttpSessionState session)\n       {\n           _session = session;\n       }\n\n       public void Log()\n       {\n           // Use _session here instead of HttpContext.Current.Session\n           var userActivity = _session["UserActivity"];\n           // Log activity to the database\n       }\n   }