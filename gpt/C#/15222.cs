using System.Drawing;\nusing MapInfo.Styles;\nusing MapInfo.Mapping.Export;\nusing MapInfo.Mapping;\n\npublic static Bitmap GetStyleBitmap(Style style)\n{\n    var bm = new Bitmap(16, 16, System.Drawing.Imaging.PixelFormat.Format32bppArgb);\n    var rect = new System.Drawing.Rectangle(0, 0, 16, 16);\n    var ss = new StyleSample();\n    ss.Bounds = rect;\n\n    // Apply styles accordingly\n    if (style is CompositeStyle compositeStyle)\n    {\n        ss.ApplyAreaStyle(compositeStyle.AreaStyle);\n        ss.ApplyLineStyle(compositeStyle.LineStyle);\n    }\n    else if (style is AreaStyle areaStyle)\n    {\n        ss.ApplyAreaStyle(areaStyle);\n    }\n    else if (style is SimpleLineStyle lineStyle)\n    {\n        ss.ApplyLineStyle(lineStyle);\n    }\n\n    // Using MapExport\n    var me = new MapExport(ss.Map);\n    var image = me.Export();\n    return new Bitmap(image);\n\n    // Alternative method using StyleSample.DrawToBitmap\n    // ss.DrawToBitmap(bm, rect);\n    // return bm;\n}