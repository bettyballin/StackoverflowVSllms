using System;\nusing System.Runtime.InteropServices;\nusing System.Security.Principal;\n\npublic class WindowsAuthentication\n{\n    [DllImport("advapi32.dll", SetLastError = true, CharSet = CharSet.Auto)]\n    private static extern bool LogonUser(string lpszUsername, string lpszDomain, string lpszPassword,\n                                         int dwLogonType, int dwLogonProvider, out IntPtr phToken);\n\n    public bool ValidateCredentials(string domain, string username, string password)\n    {\n        IntPtr tokenHandle = IntPtr.Zero;\n        const int LOGON32_LOGON_INTERACTIVE = 2;\n        const int LOGON32_PROVIDER_DEFAULT = 0;\n\n        bool returnValue = LogonUser(username, domain, password, LOGON32_LOGON_INTERACTIVE, LOGON32_PROVIDER_DEFAULT, out tokenHandle);\n        if (returnValue)\n        {\n            CloseHandle(tokenHandle);\n        }\n\n        return returnValue;\n    }\n\n    [DllImport("kernel32.dll", CharSet = CharSet.Auto)]\n    private extern static bool CloseHandle(IntPtr handle);\n}