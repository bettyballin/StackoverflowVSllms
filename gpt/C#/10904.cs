using System;\nusing System.ComponentModel;\nusing System.IO;\nusing System.Windows;\nusing System.Windows.Controls;\n\npublic class StringRedir : StringWriter, INotifyPropertyChanged\n{\n    private string text;\n    private readonly TextBlock local;\n\n    public string Text\n    {\n        get { return text; }\n        set\n        {\n            text = value;\n            OnPropertyChanged("Text");\n        }\n    }\n\n    public event PropertyChangedEventHandler PropertyChanged;\n\n    protected void OnPropertyChanged(string name)\n    {\n        Application.Current.Dispatcher.Invoke(() => \n        {\n            PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(name));\n        });\n    }\n\n    public StringRedir(ref TextBlock t)\n    {\n        local = t;\n        Text = "";\n    }\n\n    public override void WriteLine(string x)\n    {\n        Application.Current.Dispatcher.Invoke(() =>\n        {\n            Text += x + Environment.NewLine;\n        });\n    }\n}