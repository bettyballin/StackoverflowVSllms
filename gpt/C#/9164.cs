public void ProcessMessage(Message message)\n{\n    using (var session = sessionFactory.OpenSession())\n    {\n        using (var transaction = session.BeginTransaction())\n        {\n            try\n            {\n                // Perform your DB operations here\n                // e.g., session.SaveOrUpdate(entity);\n\n                transaction.Commit();\n            }\n            catch (Exception ex)\n            {\n                transaction.Rollback();\n                // Handle the exception\n                throw;\n            }\n        }\n    }\n}