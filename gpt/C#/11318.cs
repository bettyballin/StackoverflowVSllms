WindowsImpersonationContext impersonationContext = null;\n   try\n   {\n       WindowsIdentity identity = new WindowsIdentity("AppPoolAccountName");\n       impersonationContext = identity.Impersonate();\n       File.Create(@"\\servername\sharename\folder\file.txt");\n   }\n   catch (UnauthorizedAccessException ex)\n   {\n       // Handle exception\n   }\n   finally\n   {\n       if (impersonationContext != null)\n       {\n           impersonationContext.Undo();\n       }\n   }