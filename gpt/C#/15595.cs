using System;\nusing System.IO;\nusing System.Text;\nusing System.Windows.Forms;\n\npublic void ExportListViewToCSV(ListView listView, string filePath)\n{\n    StringBuilder csvContent = new StringBuilder();\n\n    // Add the header row\n    for (int i = 0; i < listView.Columns.Count; i++)\n    {\n        csvContent.Append(listView.Columns[i].Text);\n        if (i < listView.Columns.Count - 1)\n            csvContent.Append(",");\n    }\n    csvContent.AppendLine();\n\n    // Add the data rows\n    foreach (ListViewItem item in listView.Items)\n    {\n        for (int i = 0; i < item.SubItems.Count; i++)\n        {\n            csvContent.Append(item.SubItems[i].Text);\n            if (i < item.SubItems.Count - 1)\n                csvContent.Append(",");\n        }\n        csvContent.AppendLine();\n    }\n\n    // Write to file\n    File.WriteAllText(filePath, csvContent.ToString());\n}