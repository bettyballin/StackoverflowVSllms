using System;\nusing System.Collections;\nusing System.ComponentModel;\nusing System.Configuration.Install;\nusing System.ServiceProcess;\n\n[RunInstaller(true)]\npublic partial class ProjectInstaller : Installer\n{\n    private bool installOptionalService = false; // Condition flag\n\n    public ProjectInstaller()\n    {\n        InitializeComponent();\n    }\n\n    public override void Install(IDictionary stateSaver)\n    {\n        base.Install(stateSaver);\n\n        // Check your condition here\n        if (installOptionalService)\n        {\n            // Install the optional service\n            ServiceInstaller optionalServiceInstaller = new ServiceInstaller\n            {\n                ServiceName = "OptionalService",\n                StartType = ServiceStartMode.Manual\n            };\n            this.Installers.Add(optionalServiceInstaller);\n        }\n    }\n\n    public override void Uninstall(IDictionary savedState)\n    {\n        base.Uninstall(savedState);\n\n        // Check your condition here\n        if (installOptionalService)\n        {\n            // Uninstall the optional service\n            try\n            {\n                using (ServiceController sc = new ServiceController("OptionalService"))\n                {\n                    if (sc.Status != ServiceControllerStatus.Stopped)\n                    {\n                        sc.Stop();\n                        sc.WaitForStatus(ServiceControllerStatus.Stopped);\n                    }\n                }\n                ServiceInstaller optionalServiceInstaller = new ServiceInstaller\n                {\n                    ServiceName = "OptionalService"\n                };\n                this.Installers.Add(optionalServiceInstaller);\n                optionalServiceInstaller.Uninstall(null);\n            }\n            catch (Exception ex)\n            {\n                // Handle the exception if service is not installed or any other issue\n                Console.WriteLine($"Error uninstalling optional service: {ex.Message}");\n            }\n        }\n    }\n}