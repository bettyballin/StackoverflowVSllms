using System;\nusing System.Windows.Automation;\nusing System.Threading;\n\nclass Program\n{\n    static void Main()\n    {\n        // Start a new thread to show a message box\n        Thread thread = new Thread(ShowMessageBox);\n        thread.Start();\n\n        // Wait for the message box to appear\n        Thread.Sleep(2000); // Adjust the sleep time as necessary\n\n        // Find the message box window\n        AutomationElement messageBox = AutomationElement.RootElement.FindFirst(TreeScope.Children,\n            new PropertyCondition(AutomationElement.NameProperty, "Test"));\n\n        if (messageBox != null)\n        {\n            // Find the OK button within the message box\n            AutomationElement okButton = messageBox.FindFirst(TreeScope.Descendants,\n                new PropertyCondition(AutomationElement.AutomationIdProperty, "2"));\n            \n            // Invoke the button click\n            if (okButton != null && okButton.GetCurrentPattern(InvokePattern.Pattern) is InvokePattern invokePattern)\n            {\n                invokePattern.Invoke();\n            }\n        }\n    }\n\n    static void ShowMessageBox()\n    {\n        MessageBox.Show("This is a test message box.", "Test", MessageBoxButtons.OKCancel);\n    }\n}