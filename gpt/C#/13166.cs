using System;\nusing System.Diagnostics;\nusing System.IO;\nusing System.Runtime.InteropServices;\nusing System.Configuration;\n\nclass Program\n{\n    [STAThread]\n    public static void Main(string[] args)\n    {\n        string configFileName = ConfigurationManager.AppSettings.Get("TestPathsConfigFile");\n\n        TextReader configFile = new StreamReader(configFileName);\n        QTPLauncher launcher = new QTPLauncher();\n        string testName = null;\n\n        QuickTest.Application qtpApp = null;\n        try\n        {\n            Debug.WriteLine("Creating QuickTest.Application object...");\n            qtpApp = launcher.LaunchQuickTestPro();\n            Debug.WriteLine("Successfully created QuickTest.Application object...");\n\n            while ((testName = configFile.ReadLine()) != null)\n            {\n                if (!string.IsNullOrEmpty(testName) && !(testName.TrimStart()).StartsWith(COMMENT_START))\n                {\n                    Debug.WriteLine(testName);\n                    launcher.ExecuteQTPTest(testName, ref qtpApp);\n                }\n            }\n\n            configFile.Close();\n            configFile = null;\n            launcher.ExitQTP(ref qtpApp);\n        }\n        catch (System.Runtime.InteropServices.COMException ce)\n        {\n            Console.Error.WriteLine(ce.StackTrace);\n        }\n        finally\n        {\n            if (qtpApp != null)\n            {\n                Marshal.ReleaseComObject(qtpApp);\n                qtpApp = null;\n            }\n            if (configFile != null)\n            {\n                configFile.Close();\n            }\n        }\n    }\n}\n\npublic class QTPLauncher\n{\n    virtual public QuickTest.Application LaunchQuickTestPro()\n    {\n        QuickTest.Application qtpApp = new QuickTest.Application();\n        qtpApp.Launch();\n        qtpApp.Visible = false;\n        return qtpApp;\n    }\n\n    virtual public void ExecuteQTPTest(string testName, ref QuickTest.Application qtpApp)\n    {\n        // Execute the QTP test using the qtpApp instance\n    }\n\n    virtual public void ExitQTP(ref QuickTest.Application qtpApp)\n    {\n        if (qtpApp != null)\n        {\n            qtpApp.Quit();\n            Marshal.ReleaseComObject(qtpApp);\n            qtpApp = null;\n        }\n    }\n}