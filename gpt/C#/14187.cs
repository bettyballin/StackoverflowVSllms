using System;\nusing System.Collections;\nusing System.DirectoryServices;\nusing System.Text.RegularExpressions;\n\nclass Program\n{\n    static void Main()\n    {\n        DirectoryEntry user = new DirectoryEntry("LDAP://cn=myuser,ou=users,dc=example,dc=com");\n        PropertyValueCollection memberOf = user.Properties["memberOf"];\n        \n        foreach (string path in memberOf)\n        {\n            string cn = ExtractCommonName(path);\n            Console.WriteLine(cn);\n        }\n    }\n\n    static string ExtractCommonName(string distinguishedName)\n    {\n        // Regular expression to match the CN part of the distinguished name\n        Regex regex = new Regex(@"CN=([^,]+)", RegexOptions.IgnoreCase);\n        Match match = regex.Match(distinguishedName);\n\n        if (match.Success)\n        {\n            return match.Groups[1].Value;\n        }\n\n        return string.Empty;\n    }\n}