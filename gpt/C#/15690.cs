using Google.Apis.Auth.OAuth2;\n    using Google.Apis.Gmail.v1;\n    using Google.Apis.Gmail.v1.Data;\n    using Google.Apis.Services;\n    using Google.Apis.Util.Store;\n    using MimeKit;\n    using System;\n    using System.IO;\n    using System.Threading;\n    using System.Windows.Forms;\n\n    public partial class EmailForm : Form\n    {\n        static string[] Scopes = { GmailService.Scope.GmailSend };\n        static string ApplicationName = "YourAppName";\n\n        public EmailForm()\n        {\n            InitializeComponent();\n        }\n\n        private void sendEmailButton_Click(object sender, EventArgs e)\n        {\n            UserCredential credential;\n\n            using (var stream = new FileStream("client_secret.json", FileMode.Open, FileAccess.Read))\n            {\n                credential = GoogleWebAuthorizationBroker.AuthorizeAsync(\n                    GoogleClientSecrets.Load(stream).Secrets,\n                    Scopes,\n                    "user",\n                    CancellationToken.None,\n                    new FileDataStore(this.GetType().ToString())\n                ).Result;\n            }\n\n            // Create Gmail API service.\n            var service = new GmailService(new BaseClientService.Initializer()\n            {\n                HttpClientInitializer = credential,\n                ApplicationName = ApplicationName,\n            });\n\n            // Create and send the email.\n            var emailMessage = new MimeMessage();\n            emailMessage.From.Add(new MailboxAddress("Your Name", "your-email@gmail.com"));\n            emailMessage.To.Add(new MailboxAddress("Recipient Name", "recipient-email@example.com"));\n            emailMessage.Subject = "Test Email";\n            emailMessage.Body = new TextPart("plain") { Text = "This is a test email." };\n\n            var message = new Message\n            {\n                Raw = Base64UrlEncode(emailMessage.ToString())\n            };\n\n            service.Users.Messages.Send(message, "me").Execute();\n            MessageBox.Show("Email sent successfully!");\n        }\n\n        private static string Base64UrlEncode(string input)\n        {\n            var inputBytes = System.Text.Encoding.UTF8.GetBytes(input);\n            return Convert.ToBase64String(inputBytes)\n                .Replace('+', '-')\n                .Replace('/', '_')\n                .Replace("=", "");\n        }\n    }