using (SqlConnection conn = new SqlConnection(connectionString))\n{\n    conn.Open();\n    using (SqlTransaction transaction = conn.BeginTransaction())\n    {\n        try\n        {\n            // Ensure all commands use the same transaction and connection\n            SqlCommand command1 = conn.CreateCommand();\n            command1.Transaction = transaction;\n            command1.CommandText = "UPDATE TableA SET ColumnA = @value WHERE Condition";\n            command1.Parameters.AddWithValue("@value", value1);\n            command1.ExecuteNonQuery();\n\n            SqlCommand command2 = conn.CreateCommand();\n            command2.Transaction = transaction;\n            command2.CommandText = "UPDATE TableB SET ColumnB = @value WHERE Condition";\n            command2.Parameters.AddWithValue("@value", value2);\n            command2.ExecuteNonQuery();\n\n            // Commit the transaction\n            transaction.Commit();\n        }\n        catch (SqlException ex)\n        {\n            if (ex.Number == 1205) // Deadlock victim error code\n            {\n                // Handle deadlock (e.g., retry logic)\n            }\n            else\n            {\n                // Handle other SQL exceptions\n            }\n            transaction.Rollback();\n        }\n        catch (Exception ex)\n        {\n            // Handle non-SQL exceptions\n            transaction.Rollback();\n        }\n    }\n}