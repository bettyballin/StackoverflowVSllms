protected void Application_BeginRequest(Object sender, EventArgs e)\n{\n    if (HttpContext.Current.Session["SessionID"] != null)\n    {\n        string sessionId = HttpContext.Current.Session["SessionID"].ToString();\n        if (!IsSessionValid(sessionId))\n        {\n            // Invalidate the session\n            HttpContext.Current.Session.Clear();\n            HttpContext.Current.Response.Redirect("Login.aspx");\n        }\n    }\n}\n\nprivate bool IsSessionValid(string sessionId)\n{\n    using (SqlConnection conn = new SqlConnection(connectionString))\n    {\n        string query = "SELECT COUNT(1) FROM UserSessions WHERE SessionID = @SessionID AND IsActive = 1";\n        SqlCommand cmd = new SqlCommand(query, conn);\n        cmd.Parameters.AddWithValue("@SessionID", sessionId);\n        conn.Open();\n        return (int)cmd.ExecuteScalar() > 0;\n    }\n}