using System;\nusing System.Linq;\nusing Microsoft.SharePoint;\n\npublic class PrioritySortEventReceiver : SPItemEventReceiver\n{\n    public override void ItemAdded(SPItemEventProperties properties)\n    {\n        base.ItemAdded(properties);\n        SortList(properties.List);\n    }\n\n    public override void ItemUpdated(SPItemEventProperties properties)\n    {\n        base.ItemUpdated(properties);\n        SortList(properties.List);\n    }\n\n    private void SortList(SPList list)\n    {\n        SPListItemCollection items = list.Items;\n        var sortedItems = items.Cast<SPListItem>()\n                               .OrderBy(item => item["Priority"])\n                               .ToList();\n\n        for (int i = 0; i < sortedItems.Count; i++)\n        {\n            SPListItem item = sortedItems[i];\n            item["Priority"] = i + 1; // Update Priority field to reflect the new order\n            item.SystemUpdate(); // Use SystemUpdate to avoid triggering events again\n        }\n    }\n}