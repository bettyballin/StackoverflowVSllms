using System;\nusing System.Management;\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        // Create a query to detect insertion of USB drives\n        WqlEventQuery query = new WqlEventQuery("SELECT * FROM Win32_VolumeChangeEvent WHERE EventType = 2");\n\n        // Create an event watcher and start listening\n        ManagementEventWatcher watcher = new ManagementEventWatcher(query);\n        watcher.EventArrived += new EventArrivedEventHandler(USBInserted);\n        watcher.Start();\n\n        Console.WriteLine("Listening for USB drive insertions. Press Enter to exit.");\n        Console.ReadLine();\n\n        // Stop the watcher when done\n        watcher.Stop();\n    }\n\n    private static void USBInserted(object sender, EventArrivedEventArgs e)\n    {\n        Console.WriteLine("A USB drive was inserted.");\n    }\n}