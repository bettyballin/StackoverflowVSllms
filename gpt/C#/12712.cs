using System.Web.Security;\nusing System.Web.Configuration;\n\npublic bool ValidatePassword(string newPassword)\n{\n    var membershipSection = (MembershipSection)WebConfigurationManager.GetSection("system.web/membership");\n    var minRequiredPasswordLength = membershipSection.MinRequiredPasswordLength;\n    var minRequiredNonAlphanumericCharacters = membershipSection.MinRequiredNonAlphanumericCharacters;\n    var passwordStrengthRegularExpression = membershipSection.PasswordStrengthRegularExpression;\n\n    if (newPassword.Length < minRequiredPasswordLength)\n    {\n        return false;\n    }\n\n    int nonAlphanumericCount = newPassword.Count(c => !char.IsLetterOrDigit(c));\n    if (nonAlphanumericCount < minRequiredNonAlphanumericCharacters)\n    {\n        return false;\n    }\n\n    if (!string.IsNullOrEmpty(passwordStrengthRegularExpression))\n    {\n        var regex = new System.Text.RegularExpressions.Regex(passwordStrengthRegularExpression);\n        if (!regex.IsMatch(newPassword))\n        {\n            return false;\n        }\n    }\n\n    return true;\n}\n\npublic bool ChangePassword(string username, string newPassword)\n{\n    if (!ValidatePassword(newPassword))\n    {\n        return false;\n    }\n\n    MembershipUser member = Membership.GetUser(username);\n    if (member != null)\n    {\n        string tempPassword = member.ResetPassword();\n        return member.ChangePassword(tempPassword, newPassword);\n    }\n\n    return false;\n}