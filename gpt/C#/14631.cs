using System.Data.SqlClient;\n\npublic static class DataAccess\n{\n    public static DataSet FillDataSet(DataSet dataSet, string storedProcedureName, Dictionary<string, string> parameters)\n    {\n        using (SqlConnection connection = new SqlConnection("YourConnectionString"))\n        {\n            using (SqlCommand command = new SqlCommand(storedProcedureName, connection))\n            {\n                command.CommandType = System.Data.CommandType.StoredProcedure;\n\n                // Add parameters to the command\n                foreach (var parameter in parameters)\n                {\n                    command.Parameters.AddWithValue(parameter.Key, parameter.Value);\n                }\n\n                using (SqlDataAdapter adapter = new SqlDataAdapter(command))\n                {\n                    // Apply mappings from the factory\n                    DataSetMappingFactory.ApplyMappings(dataSet);\n\n                    // Fill the dataset\n                    adapter.Fill(dataSet);\n                }\n            }\n        }\n        return dataSet;\n    }\n}