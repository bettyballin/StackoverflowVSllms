using System;\nusing System.Runtime.InteropServices;\nusing System.Windows.Forms;\n\npublic class PreventShutdown : Form\n{\n    [DllImport("user32.dll", SetLastError = true)]\n    public static extern bool RegisterPowerSettingNotification(IntPtr hRecipient, ref Guid PowerSettingGuid, int Flags);\n\n    private static readonly Guid GUID_CONSOLE_DISPLAY_STATE = new Guid("6FE69556-704A-47A0-8F24-C28D936FDA47");\n\n    public PreventShutdown()\n    {\n        RegisterPowerSettingNotification(this.Handle, ref GUID_CONSOLE_DISPLAY_STATE, 0);\n    }\n\n    protected override void WndProc(ref Message m)\n    {\n        const int WM_POWERBROADCAST = 0x0218;\n        const int PBT_APMQUERYSTANDBY = 0x0001;\n\n        if (m.Msg == WM_POWERBROADCAST && m.WParam.ToInt32() == PBT_APMQUERYSTANDBY)\n        {\n            m.Result = (IntPtr)0; // Deny standby request\n            return;\n        }\n        base.WndProc(ref m);\n    }\n\n    [STAThread]\n    public static void Main()\n    {\n        Application.Run(new PreventShutdown());\n    }\n}