using System;\nusing System.Runtime.InteropServices;\nusing System.Windows;\nusing System.Windows.Interop;\n\npublic partial class MainStudioWindowControl : RibbonWindow\n{\n    public MainStudioWindowControl()\n    {\n        App.MainWindowOwner = this;\n        this.Loaded += new RoutedEventHandler(MainStudioWindowControl_Loaded);\n    }\n\n    void MainStudioWindowControl_Loaded(object sender, RoutedEventArgs e)\n    {\n        Window mainWindow = Application.Current.MainWindow;\n        mainWindow.WindowStartupLocation = WindowStartupLocation.Manual;\n        if (Studio.Properties.Settings.Default.Width > 0)\n        {\n            mainWindow.Left = Studio.Properties.Settings.Default.Left;\n            mainWindow.Top = Studio.Properties.Settings.Default.Top;\n            mainWindow.Width = Studio.Properties.Settings.Default.Width;\n            mainWindow.Height = Studio.Properties.Settings.Default.Height;\n        }\n        Debug.WriteLine(string.Format("Loading: Top = {0}", mainWindow.Top));\n    }\n\n    protected override void OnClosing(System.ComponentModel.CancelEventArgs e)\n    {\n        base.OnClosing(e);\n        Window mainWindow = Application.Current.MainWindow;\n        RECT rect;\n        IntPtr hwnd = new WindowInteropHelper(mainWindow).Handle;\n        GetWindowRect(hwnd, out rect);\n\n        Studio.Properties.Settings.Default.Left = rect.Left;\n        Studio.Properties.Settings.Default.Top = rect.Top;\n        Studio.Properties.Settings.Default.Width = rect.Right - rect.Left;\n        Studio.Properties.Settings.Default.Height = rect.Bottom - rect.Top;\n        Studio.Properties.Settings.Default.Save();\n        Debug.WriteLine(string.Format("Saving: Settings.Top = {0}", Studio.Properties.Settings.Default.Top));\n    }\n\n    [DllImport("user32.dll")]\n    [return: MarshalAs(UnmanagedType.Bool)]\n    static extern bool GetWindowRect(IntPtr hWnd, out RECT lpRect);\n\n    [StructLayout(LayoutKind.Sequential)]\n    public struct RECT\n    {\n        public int Left;\n        public int Top;\n        public int Right;\n        public int Bottom;\n    }\n}