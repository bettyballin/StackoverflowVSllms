private SqlCommand CloneSqlCommand(SqlCommand command, SqlConnection connection)\n{\n    SqlCommand clonedCommand = new SqlCommand(command.CommandText, connection)\n    {\n        CommandType = command.CommandType,\n        CommandTimeout = command.CommandTimeout\n    };\n\n    foreach (SqlParameter parameter in command.Parameters)\n    {\n        SqlParameter clonedParameter = (SqlParameter)((ICloneable)parameter).Clone();\n        clonedCommand.Parameters.Add(clonedParameter);\n    }\n\n    return clonedCommand;\n}