using (var conn = new SqlClient.SqlConnection("your_connection_string"))\n{\n    conn.Open(); // Open the connection\n\n    // Creation involves many table joins in reality\n    String creationScript = "SELECT * INTO #MyTemp FROM FooTable";\n    SqlCommand createTempTbl = new SqlCommand(creationScript, conn);\n    createTempTbl.ExecuteNonQuery();\n\n    // Now execute your queries using the same connection\n    String query1 = "SELECT * FROM #MyTemp WHERE id=@id";\n    using (SqlCommand query1Comm = new SqlCommand(query1, conn))\n    {\n        query1Comm.Parameters.AddWithValue("@id", yourIdValue);\n        using (SqlDataReader reader1 = query1Comm.ExecuteReader())\n        {\n            // Process query1 results\n        }\n    }\n\n    String query2 = "SELECT * FROM #MyTemp WHERE name=@name";\n    using (SqlCommand query2Comm = new SqlCommand(query2, conn))\n    {\n        query2Comm.Parameters.AddWithValue("@name", yourNameValue);\n        using (SqlDataReader reader2 = query2Comm.ExecuteReader())\n        {\n            // Process query2 results\n        }\n    }\n\n    // Continue with other queries similarly if needed\n\n    conn.Close(); // Close the connection, which will automatically drop the temporary table\n}