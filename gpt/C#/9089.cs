amespace foo\n{\n    public class ServerControlTest : CompositeControl, IScriptControl\n    {\n        ScriptManager sm;\n\n        protected override void OnPreRender(EventArgs e)\n        {\n            if (!this.DesignMode)\n            {\n                sm = ScriptManager.GetCurrent(Page);\n                if (sm == null)\n                    throw new HttpException("A ScriptManager control must exist on the current page.");\n                \n                sm.RegisterScriptControl(this);\n                sm.EnablePageMethods = true;\n            }\n            base.OnPreRender(e);\n        }\n\n        protected override void OnLoad(EventArgs e)\n        {\n            Literal lit = new Literal();\n            lit.Text = "<span id=\"Literal1\">test</span><input id=\"Button1\" type=\"button\" value=\"button\" onclick=\"UpdateTime();\" />";\n            this.Controls.Add(lit);\n        }\n\n        protected override void Render(HtmlTextWriter writer)\n        {\n            if (!this.DesignMode)\n                sm.RegisterScriptDescriptors(this);\n\n            base.Render(writer);\n        }\n\n        [System.Web.Services.WebMethod]\n        public static string GetCurrentDate()\n        {\n            return DateTime.Now.ToString();\n        }\n\n        public IEnumerable<ScriptDescriptor> GetScriptDescriptors()\n        {\n            return null;\n        }\n\n        public IEnumerable<ScriptReference> GetScriptReferences()\n        {\n            ScriptReference reference = new ScriptReference();\n            reference.Path = ResolveClientUrl("~/tests/JScript.js");\n            return new ScriptReference[] { reference };\n        }\n    }\n}