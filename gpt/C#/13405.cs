public static Guid DecodeBase64Guid(string base64)\n{\n    // Replace URL-friendly characters back to Base64 characters\n    base64 = base64.Replace("_", "/").Replace("-", "+");\n    switch (base64.Length % 4)\n    {\n        case 2: base64 += "=="; break;\n        case 3: base64 += "="; break;\n    }\n    byte[] bytes = Convert.FromBase64String(base64);\n    return new Guid(bytes);\n}