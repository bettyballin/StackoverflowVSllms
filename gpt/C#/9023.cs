using System;\nusing System.Reflection;\nusing System.Data.SqlClient;\n\npublic class ReflectionHelper\n{\n    public static SqlCommand[] GetSqlCommandsFromTableAdapter(object tableAdapter)\n    {\n        Type type = tableAdapter.GetType();\n        PropertyInfo commandCollectionProperty = type.GetProperty("CommandCollection", BindingFlags.NonPublic | BindingFlags.Instance);\n        if (commandCollectionProperty != null)\n        {\n            SqlCommand[] commandCollection = (SqlCommand[])commandCollectionProperty.GetValue(tableAdapter, null);\n            return commandCollection;\n        }\n\n        return null;\n    }\n}