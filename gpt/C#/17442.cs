using System;\n   using System.Runtime.InteropServices;\n\n   class Program\n   {\n       [DllImport("opt7bja.dll", CharSet = CharSet.Ansi, CallingConvention = CallingConvention.StdCall)]\n       public static extern int SubmitJobStringList(IntPtr joblist, int jobCount, ref int jobno);\n\n       static void Main(string[] args)\n       {\n           string[] jobList = { "Job1", "Job2", "Job3" };\n           int jobno = 0;\n\n           IntPtr[] pJobList = new IntPtr[jobList.Length];\n           for (int i = 0; i < jobList.Length; i++)\n           {\n               pJobList[i] = Marshal.StringToHGlobalAnsi(jobList[i]);\n           }\n\n           GCHandle handle = GCHandle.Alloc(pJobList, GCHandleType.Pinned);\n           try\n           {\n               IntPtr joblistPtr = handle.AddrOfPinnedObject();\n               int result = SubmitJobStringList(joblistPtr, jobList.Length, ref jobno);\n               Console.WriteLine($"Result: {result}, JobNo: {jobno}");\n           }\n           finally\n           {\n               handle.Free();\n               for (int i = 0; i < jobList.Length; i++)\n               {\n                   Marshal.FreeHGlobal(pJobList[i]);\n               }\n           }\n       }\n   }