using System;\nusing System.IO;\nusing System.IO.Pipes;\nusing System.Text;\nusing System.Threading.Tasks;\n\npublic class NamedPipeClient\n{\n    private NamedPipeClientStream pipeClient;\n\n    public NamedPipeClient(string pipeName)\n    {\n        pipeClient = new NamedPipeClientStream(".", pipeName, PipeDirection.InOut, PipeOptions.Asynchronous);\n    }\n\n    public async Task SendMessage(string message)\n    {\n        await pipeClient.ConnectAsync();\n\n        using (var writer = new StreamWriter(pipeClient, Encoding.UTF8))\n        {\n            writer.AutoFlush = true;\n            await writer.WriteLineAsync(message);\n        }\n    }\n}