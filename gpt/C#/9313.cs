using System;\nusing System.Management;\n\npublic class FolderManagement\n{\n    public static void CreateHomeFolder(string folderPath, string username)\n    {\n        try\n        {\n            System.IO.Directory.CreateDirectory(folderPath);\n\n            string shareName = username + "$"; // Hidden share\n            string shareDescription = "Home folder for " + username;\n\n            ManagementClass managementClass = new ManagementClass("Win32_Share");\n            ManagementBaseObject inParams = managementClass.GetMethodParameters("Create");\n\n            inParams["Description"] = shareDescription;\n            inParams["Name"] = shareName;\n            inParams["Path"] = folderPath;\n            inParams["Type"] = 0x0; // Disk Drive\n\n            ManagementBaseObject outParams = managementClass.InvokeMethod("Create", inParams, null);\n\n            if ((uint)(outParams.Properties["ReturnValue"].Value) != 0)\n                throw new Exception("Unable to share directory.");\n            \n            Console.WriteLine("Home folder created and shared successfully.");\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine("Error: " + ex.Message);\n        }\n    }\n\n    public static void Main()\n    {\n        string folderPath = @"C:\Users\newuser";\n        string username = "newuser";\n\n        CreateHomeFolder(folderPath, username);\n    }\n}