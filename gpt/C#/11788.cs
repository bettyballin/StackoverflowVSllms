public class ProductRepository : IProductRepository\n{\n    private readonly string _connectionString;\n\n    public ProductRepository(IConfiguration configuration)\n    {\n        _connectionString = configuration.GetConnectionString("DefaultConnection");\n    }\n\n    public IEnumerable<Product> GetAll()\n    {\n        using (var connection = new SqlConnection(_connectionString))\n        {\n            return connection.Query<Product>("SELECT * FROM Products");\n        }\n    }\n\n    public Product GetById(int id)\n    {\n        using (var connection = new SqlConnection(_connectionString))\n        {\n            return connection.QuerySingleOrDefault<Product>("SELECT * FROM Products WHERE Id = @Id", new { Id = id });\n        }\n    }\n\n    public void Add(Product product)\n    {\n        using (var connection = new SqlConnection(_connectionString))\n        {\n            connection.Execute("INSERT INTO Products (Name, Price) VALUES (@Name, @Price)", product);\n        }\n    }\n\n    public void Update(Product product)\n    {\n        using (var connection = new SqlConnection(_connectionString))\n        {\n            connection.Execute("UPDATE Products SET Name = @Name, Price = @Price WHERE Id = @Id", product);\n        }\n    }\n\n    public void Delete(int id)\n    {\n        using (var connection = new SqlConnection(_connectionString))\n        {\n            connection.Execute("DELETE FROM Products WHERE Id = @Id", new { Id = id });\n        }\n    }\n}