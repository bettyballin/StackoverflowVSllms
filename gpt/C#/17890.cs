using Microsoft.Win32;\n   using System.Security;\n\n   try\n   {\n       using (RegistryKey key = Registry.LocalMachine.OpenSubKey("SOFTWARE", true))\n       {\n           if (key != null)\n           {\n               // Your code to write to the registry\n           }\n           else\n           {\n               // Handle the case where the key does not exist\n           }\n       }\n   }\n   catch (SecurityException ex)\n   {\n       // Handle the security exception\n   }\n   catch (UnauthorizedAccessException ex)\n   {\n       // Handle the unauthorized access exception\n   }