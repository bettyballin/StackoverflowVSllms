using System;\nusing System.DirectoryServices;\n\nclass IISManager\n{\n    public static void CreateWebsite(string siteName, string sitePath, string ipAddress, string hostHeader, int port)\n    {\n        string metabasePath = "IIS://localhost/W3SVC";\n\n        try\n        {\n            DirectoryEntry w3svc = new DirectoryEntry(metabasePath);\n            DirectoryEntry newSite = w3svc.Children.Add(GetNextSiteID(w3svc).ToString(), "IIsWebServer");\n\n            newSite.Properties["ServerComment"].Value = siteName;\n            newSite.Properties["ServerBindings"].Value = $"{ipAddress}:{port}:{hostHeader}";\n            newSite.CommitChanges();\n\n            DirectoryEntry rootVDir = newSite.Children.Add("Root", "IIsWebVirtualDir");\n            rootVDir.Properties["Path"].Value = sitePath;\n            rootVDir.Properties["AccessRead"].Value = true;\n            rootVDir.Properties["AccessScript"].Value = true;\n            rootVDir.CommitChanges();\n\n            Console.WriteLine("Website created successfully.");\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine($"An error occurred: {ex.Message}");\n        }\n    }\n\n    private static int GetNextSiteID(DirectoryEntry w3svc)\n    {\n        int maxID = 0;\n        foreach (DirectoryEntry child in w3svc.Children)\n        {\n            if (child.SchemaClassName == "IIsWebServer")\n            {\n                int id = int.Parse(child.Name);\n                if (id > maxID)\n                {\n                    maxID = id;\n                }\n            }\n        }\n        return maxID + 1;\n    }\n}