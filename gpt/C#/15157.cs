using System;\nusing System.Linq;\nusing System.Data.Linq;\n\npublic class BuilderInclusionsForm\n{\n    private Product product;\n    private DataContext db2;\n\n    public BuilderInclusionsForm(Product p) : this()\n    {\n        Type productType = p.GetType();\n        var getTableMethod = typeof(DataContext).GetMethod("GetTable").MakeGenericMethod(productType);\n\n        var table = getTableMethod.Invoke(db2, null);\n        var query = ((IQueryable)table).Provider.CreateQuery(\n            Expression.Call(\n                typeof(Queryable),\n                "SingleOrDefault",\n                new Type[] { productType },\n                Expression.Call(\n                    typeof(Queryable),\n                    "Where",\n                    new Type[] { productType },\n                    Expression.Constant(table),\n                    Expression.Lambda(\n                        Expression.Equal(\n                            Expression.Property(Expression.Parameter(productType, "a"), "ProductID"),\n                            Expression.Constant(p.ProductID)\n                        ),\n                        Expression.Parameter(productType, "a")\n                    )\n                )\n            )\n        );\n\n        product = (Product)query;\n    }\n}