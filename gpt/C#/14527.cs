public static XElement ToXml(this object input)\n{\n    if (input == null) return null;\n\n    Type type = input.GetType();\n    var root = new XElement(type.Name.Trim('_'));\n\n    foreach (var prop in type.GetProperties().Where(p => p.PropertyType.IsValueType || p.PropertyType == typeof(string)))\n    {\n        var value = prop.GetValue(input);\n        if (value != null)\n        {\n            root.Add(new XAttribute(prop.Name, value));\n        }\n    }\n\n    return root;\n}