using System;\nusing System.Data.Entity.Infrastructure;\nusing System.Data.SqlClient;\nusing System.Linq;\nusing System.Web.Mvc;\n\npublic class DinnersController : Controller\n{\n    private readonly DinnerRepository _repository = new DinnerRepository();\n\n    [HttpPost]\n    public ActionResult Create(Dinner dinner)\n    {\n        if (ModelState.IsValid)\n        {\n            try\n            {\n                _repository.Add(dinner);\n                _repository.Save();\n                return RedirectToAction("Index");\n            }\n            catch (DbUpdateException ex)\n            {\n                var sqlException = ex.InnerException?.InnerException as SqlException;\n                if (sqlException != null)\n                {\n                    // Handle specific SQL Server errors\n                    switch (sqlException.Number)\n                    {\n                        case 2627: // Unique constraint error\n                        case 547:  // Constraint check violation\n                        case 2601: // Duplicated key row error\n                            ModelState.AddModelError("", "Database error occurred: " + sqlException.Message);\n                            break;\n                        default:\n                            ModelState.AddModelError("", "An error occurred while saving data: " + sqlException.Message);\n                            break;\n                    }\n                }\n                else\n                {\n                    ModelState.AddModelError("", "An error occurred while saving data.");\n                }\n            }\n        }\n        \n        // If we got this far, something failed; redisplay form\n        return View(dinner);\n    }\n}