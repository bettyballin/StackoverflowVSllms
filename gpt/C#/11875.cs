using System;\nusing System.Diagnostics;\nusing System.IO;\nusing System.Text.RegularExpressions;\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        string filePath = @"C:\path\to\your\file.txt";\n        GetProcessesLockingFile(filePath);\n    }\n\n    static void GetProcessesLockingFile(string filePath)\n    {\n        string handlePath = @"C:\path\to\handle.exe"; // Update with the actual path to the Handle utility\n\n        ProcessStartInfo psi = new ProcessStartInfo\n        {\n            FileName = handlePath,\n            Arguments = "\"" + filePath + "\"",\n            RedirectStandardOutput = true,\n            UseShellExecute = false,\n            CreateNoWindow = true\n        };\n\n        using (Process process = new Process { StartInfo = psi })\n        {\n            process.Start();\n            using (StreamReader reader = process.StandardOutput)\n            {\n                string result = reader.ReadToEnd();\n                ParseHandleOutput(result);\n            }\n        }\n    }\n\n    static void ParseHandleOutput(string output)\n    {\n        // Example output line: "explorer.exe pid: 1234   type: File       C:\path\to\your\file.txt"\n        string pattern = @"(?<processName>\S+)\s+pid:\s+(?<pid>\d+)";\n        Regex regex = new Regex(pattern);\n\n        foreach (Match match in regex.Matches(output))\n        {\n            string processName = match.Groups["processName"].Value;\n            int pid = int.Parse(match.Groups["pid"].Value);\n\n            Console.WriteLine($"Process Name: {processName}, PID: {pid}");\n        }\n    }\n}