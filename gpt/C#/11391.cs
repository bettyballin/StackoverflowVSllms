public class ImageHandler : IHttpHandler\n{\n    public void ProcessRequest(HttpContext context)\n    {\n        string imageUrl = context.Request.QueryString["url"];\n        if (IsUserAuthenticated(context))\n        {\n            context.Response.ContentType = "image/jpeg";\n            context.Response.WriteFile(imageUrl);\n        }\n        else\n        {\n            context.Response.StatusCode = 403; // Forbidden\n        }\n    }\n\n    private bool IsUserAuthenticated(HttpContext context)\n    {\n        // Implement your authentication logic here\n        return context.User.Identity.IsAuthenticated;\n    }\n\n    public bool IsReusable\n    {\n        get { return false; }\n    }\n}