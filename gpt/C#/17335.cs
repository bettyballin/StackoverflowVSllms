using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Windows.Forms;\n\npublic class CheckBoxCsvConverter\n{\n    public IList<CheckBox> SelectedCheckBoxes { get; set; }\n\n    private string GetAsCsv(Func<CheckBox, string> getValue)\n    {\n        return string.Join(",", SelectedCheckBoxes.Select(getValue).ToArray());\n    }\n\n    public string GetSelectedTextAsCsv()\n    {\n        return GetAsCsv(cb => cb.Text);\n    }\n\n    public string GetTagAsCsv()\n    {\n        return GetAsCsv(cb => cb.Tag == null ? string.Empty : cb.Tag.ToString());\n    }\n\n    private string DropLastComma(string input)\n    {\n        if (string.IsNullOrEmpty(input))\n        {\n            return input;\n        }\n\n        return input.EndsWith(",") ? input.Substring(0, input.Length - 1) : input;\n    }\n}