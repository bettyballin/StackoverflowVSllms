using System.ComponentModel;\nusing System.Configuration.Install;\nusing System.Runtime.InteropServices;\n\n[RunInstaller(true)]\npublic class MyAddinInstaller : Installer\n{\n    public override void Install(IDictionary stateSaver)\n    {\n        base.Install(stateSaver);\n        RegisterAssembly();\n    }\n\n    public override void Uninstall(IDictionary savedState)\n    {\n        base.Uninstall(savedState);\n        UnregisterAssembly();\n    }\n\n    private void RegisterAssembly()\n    {\n        string assemblyPath = Context.Parameters["assemblypath"];\n        RegistrationServices regAsm = new RegistrationServices();\n        regAsm.RegisterAssembly(Assembly.LoadFrom(assemblyPath), AssemblyRegistrationFlags.SetCodeBase);\n    }\n\n    private void UnregisterAssembly()\n    {\n        string assemblyPath = Context.Parameters["assemblypath"];\n        RegistrationServices regAsm = new RegistrationServices();\n        regAsm.UnregisterAssembly(Assembly.LoadFrom(assemblyPath));\n    }\n}