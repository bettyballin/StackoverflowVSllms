using System;\nusing System.Collections.Generic;\nusing System.IO;\nusing System.Text;\n\npublic class SmartAsciiWriter\n{\n    private readonly BinaryWriter m_writer;\n    private readonly Dictionary<string, byte[]> _cache;\n\n    public SmartAsciiWriter(Stream outputStream)\n    {\n        m_writer = new BinaryWriter(outputStream, Encoding.ASCII);\n        _cache = new Dictionary<string, byte[]>(StringComparer.Ordinal);\n    }\n\n    public void Write(string text)\n    {\n        if (!_cache.TryGetValue(text, out var byteArray))\n        {\n            byteArray = Encoding.ASCII.GetBytes(text);\n            _cache[text] = byteArray;\n        }\n        m_writer.Write(byteArray);\n    }\n}