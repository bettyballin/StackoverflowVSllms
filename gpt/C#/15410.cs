public class LocalhostMiddleware\n{\n    private readonly RequestDelegate _next;\n\n    public LocalhostMiddleware(RequestDelegate next)\n    {\n        _next = next;\n    }\n\n    public async Task InvokeAsync(HttpContext context)\n    {\n        var remoteIpAddress = context.Connection.RemoteIpAddress;\n        \n        // Check if the request is from the local machine\n        if (IPAddress.IsLoopback(remoteIpAddress))\n        {\n            await _next(context);\n        }\n        else\n        {\n            context.Response.StatusCode = StatusCodes.Status403Forbidden;\n            await context.Response.WriteAsync("Access denied. This service can only be accessed locally.");\n        }\n    }\n}\n\n// Register the middleware in the Startup class\npublic class Startup\n{\n    public void Configure(IApplicationBuilder app, IHostingEnvironment env)\n    {\n        app.UseMiddleware<LocalhostMiddleware>();\n\n        // Other middleware registrations\n        app.UseMvc();\n    }\n}