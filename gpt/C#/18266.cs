Accessibility.IAccessible test(\n    int hWnd,\n    string accessName )\n{\n    Guid guidCOM = new Guid( 0x618736E0, 0x3C3D, 0x11CF, 0x81, 0xC, 0x0, 0xAA, 0x0, 0x38, 0x9B, 0x71 );\n    Accessibility.IAccessible a = null;\n\n    AccessibleObjectFromWindow(\n        new IntPtr( hWnd ),\n        -4,\n        ref guidCOM,\n        ref a );\n        \n    if (a == null) \n        return null;\n    \n    try\n    {\n        object[] children = new object[a.accChildCount];\n        int z;\n        AccessibleChildren(a, 0, children.Length, children, out z);\n        foreach (object child in children)\n        {\n            if (child is Accessibility.IAccessible a2)\n            {\n                try\n                {\n                    if (a2.get_accName(0) == accessName)\n                        return a2;\n                }\n                catch\n                {\n                    // Handle exception\n                }\n                finally\n                {\n                    // Release the child COM object\n                    Marshal.ReleaseComObject(a2);\n                }\n            }\n        }\n    }\n    finally\n    {\n        // Release the main COM object\n        Marshal.ReleaseComObject(a);\n    }\n\n    return null;\n}