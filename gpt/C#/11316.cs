using System;\nusing System.ServiceProcess;\nusing System.Data.SqlClient;\nusing System.Threading;\n\nclass Program\n{\n    static void Main()\n    {\n        string serviceName = "MSSQLSERVER"; // Change to your SQL Server instance name if necessary\n        string connectionString = "Server=localhost;Database=master;Integrated Security=True;";\n\n        ServiceController service = new ServiceController(serviceName);\n\n        try\n        {\n            // Wait for the service to be running\n            service.WaitForStatus(ServiceControllerStatus.Running, TimeSpan.FromMinutes(2));\n\n            // Retry logic to perform a test query\n            bool isReady = false;\n            int maxRetries = 5;\n            int retryCount = 0;\n            while (!isReady && retryCount < maxRetries)\n            {\n                try\n                {\n                    using (SqlConnection connection = new SqlConnection(connectionString))\n                    {\n                        connection.Open();\n                        SqlCommand command = new SqlCommand("SELECT 1", connection);\n                        command.ExecuteScalar();\n                        isReady = true; // If query succeeds, SQL Server is ready\n                    }\n                }\n                catch (SqlException)\n                {\n                    retryCount++;\n                    Thread.Sleep(2000); // Wait for 2 seconds before retrying\n                }\n            }\n\n            if (!isReady)\n            {\n                Console.WriteLine("SQL Server is not ready after several attempts.");\n            }\n            else\n            {\n                Console.WriteLine("SQL Server is ready for use.");\n            }\n        }\n        catch (TimeoutException)\n        {\n            Console.WriteLine("SQL Server service did not start in the expected time.");\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine($"An error occurred: {ex.Message}");\n        }\n    }\n}