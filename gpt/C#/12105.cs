using System.Windows.Controls;\nusing System.Windows.Media;\n\nprivate void CheckVerticalScrollBarVisibility()\n{\n    // Find the ScrollViewer within the ListBox\n    var scrollViewer = FindScrollViewer(listOfItems);\n\n    if (scrollViewer != null)\n    {\n        // Check if the vertical scrollbar is visible\n        var isVerticalScrollBarVisible = scrollViewer.ComputedVerticalScrollBarVisibility == System.Windows.Visibility.Visible;\n\n        // Output the result\n        if (isVerticalScrollBarVisible)\n        {\n            Console.WriteLine("Vertical scrollbar is visible.");\n        }\n        else\n        {\n            Console.WriteLine("Vertical scrollbar is not visible.");\n        }\n    }\n    else\n    {\n        Console.WriteLine("ScrollViewer not found.");\n    }\n}\n\n// Helper method to find the ScrollViewer within a ListBox\nprivate ScrollViewer FindScrollViewer(DependencyObject dObject)\n{\n    if (dObject is ScrollViewer)\n    {\n        return dObject as ScrollViewer;\n    }\n\n    for (int i = 0; i < VisualTreeHelper.GetChildrenCount(dObject); i++)\n    {\n        var child = VisualTreeHelper.GetChild(dObject, i);\n        var result = FindScrollViewer(child);\n        if (result != null)\n        {\n            return result;\n        }\n    }\n\n    return null;\n}