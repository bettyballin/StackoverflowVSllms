using System;\nusing System.Collections;\n\nnamespace COMInteropWrapper\n{\n    [ComVisible(true)]\n    [Guid("YOUR-GUID-HERE")]\n    public class EnumeratorWrapper : IEnumerator\n    {\n        private IEnumerator _innerEnumerator;\n\n        public EnumeratorWrapper(IEnumerable enumerable)\n        {\n            _innerEnumerator = enumerable.GetEnumerator();\n        }\n\n        public object Current => _innerEnumerator.Current;\n\n        public bool MoveNext() => _innerEnumerator.MoveNext();\n\n        public void Reset() => _innerEnumerator.Reset();\n    }\n\n    [ComVisible(true)]\n    [Guid("YOUR-GUID-HERE")]\n    public interface IManagedEnumerable\n    {\n        EnumeratorWrapper GetCustomEnumerator();\n    }\n\n    [ComVisible(true)]\n    [Guid("YOUR-GUID-HERE")]\n    public class ManagedEnumerable : IManagedEnumerable\n    {\n        private IEnumerable _innerEnumerable;\n\n        public ManagedEnumerable(IEnumerable enumerable)\n        {\n            _innerEnumerable = enumerable;\n        }\n\n        public EnumeratorWrapper GetCustomEnumerator()\n        {\n            return new EnumeratorWrapper(_innerEnumerable);\n        }\n    }\n}