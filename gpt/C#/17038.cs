using System.IO;\nusing System.IO.Compression;\nusing System.Text;\n\nprivate void writeReportsToZip(IReport[] reports, string zipFileName)\n{\n    using (MemoryStream zipStream = new MemoryStream())\n    {\n        using (ZipArchive zip = new ZipArchive(zipStream, ZipArchiveMode.Create, true))\n        {\n            foreach (var report in reports)\n            {\n                string reportString = report.makeReport();\n                string reportName = report.GetName(); // Assuming IReport has a method to get the name\n                ASCIIEncoding encoding = new ASCIIEncoding();\n                byte[] encodedReport = encoding.GetBytes(reportString);\n\n                var zipEntry = zip.CreateEntry(reportName + ".txt");\n                using (var entryStream = zipEntry.Open())\n                {\n                    entryStream.Write(encodedReport, 0, encodedReport.Length);\n                }\n            }\n        }\n\n        Response.ContentType = "application/zip";\n        Response.AddHeader("Content-Disposition", "attachment;filename=" + zipFileName + ".zip");\n        zipStream.Seek(0, SeekOrigin.Begin);\n        zipStream.CopyTo(Response.OutputStream);\n        Response.End();\n    }\n}