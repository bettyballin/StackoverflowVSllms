using System;\nusing System.Data.SqlClient;\nusing System.Messaging;\nusing System.Transactions;\n\npublic class TransactionScopeExample\n{\n    public void Execute()\n    {\n        string connectionString = "your_connection_string";\n        string queuePath = @".\private$\your_queue";\n\n        using (TransactionScope scope = new TransactionScope())\n        {\n            // Execute SQL command\n            using (SqlConnection connection = new SqlConnection(connectionString))\n            {\n                connection.Open();\n                string sql = "INSERT INTO YourTable (Column1, Column2) VALUES (@Value1, @Value2)";\n                using (SqlCommand command = new SqlCommand(sql, connection))\n                {\n                    command.Parameters.AddWithValue("@Value1", "Value1");\n                    command.Parameters.AddWithValue("@Value2", "Value2");\n                    command.ExecuteNonQuery();\n                }\n            }\n\n            // Send MSMQ message\n            using (MessageQueue queue = new MessageQueue(queuePath))\n            {\n                if (!MessageQueue.Exists(queuePath))\n                {\n                    MessageQueue.Create(queuePath);\n                }\n\n                using (Message message = new Message())\n                {\n                    message.Body = "Your message content";\n                    queue.Send(message, MessageQueueTransactionType.Automatic);\n                }\n            }\n\n            // Complete the transaction\n            scope.Complete();\n        }\n    }\n}