using Alphaleonis.Win32.Vss;\nusing System;\nusing System.IO;\n\npublic class FileCopyExample\n{\n    public static void CopyLockedFile(string sourceFilePath, string destinationFilePath)\n    {\n        using (IVssBackupComponents backup = VssUtils.LoadImplementation().CreateVssBackupComponents())\n        {\n            backup.InitializeForBackup(null);\n            backup.GatherWriterMetadata();\n            backup.StartSnapshotSet();\n            \n            string volume = Path.GetPathRoot(sourceFilePath);\n            Guid snapshotId = backup.AddToSnapshotSet(volume);\n            backup.DoSnapshotSet();\n\n            string shadowCopyPath = VssUtils.GetSnapshotDeviceObject(snapshotId) + sourceFilePath.Substring(2);\n            File.Copy(shadowCopyPath, destinationFilePath);\n\n            backup.DeleteSnapshotSet(snapshotId, false);\n        }\n    }\n}