using System.Drawing;\nusing System.Windows.Forms;\n\npublic void AutoResizeColumns(DataGridView myDataGridView)\n{\n    foreach (DataGridViewColumn column in myDataGridView.Columns)\n    {\n        int maxWidth = 0;\n        foreach (DataGridViewRow row in myDataGridView.Rows)\n        {\n            if (row.IsNewRow) continue;\n            string cellValue = row.Cells[column.Index].Value?.ToString() ?? string.Empty;\n            Size textSize = TextRenderer.MeasureText(cellValue, myDataGridView.Font);\n            if (textSize.Width > maxWidth)\n            {\n                maxWidth = textSize.Width;\n            }\n        }\n\n        string headerText = column.HeaderText;\n        Size headerSize = TextRenderer.MeasureText(headerText, myDataGridView.Font);\n        if (headerSize.Width > maxWidth)\n        {\n            maxWidth = headerSize.Width;\n        }\n\n        column.Width = maxWidth + 10; // Add some padding\n    }\n}