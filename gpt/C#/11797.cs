public class OrderMap : ClassMap<Order> {\n    public OrderMap() {\n        Table("ORDERS");\n\n        Id(x => x.Id, "ORDER_ID").GeneratedBy.Identity();\n\n        // Use a formula to fetch the Terminal ID based on custom SQL\n        Map(x => x.TerminalId)\n            .Formula("(select t.TERMINAL_ID from cust_prod cp " +\n                     "inner join customer_terminal ct on (cp.CUSTOMER_TERMINAL_ID = ct.CUSTOMER_TERMINAL_ID) " +\n                     "inner join terminal t on (ct.TERMINAL_ID = t.TERMINAL_ID) " +\n                     "where cp.CUST_PROD_ID = CUST_PROD_ID)");\n\n        References(x => x.Terminal, "TerminalId").Not.Insert().Not.Update();\n    }\n}