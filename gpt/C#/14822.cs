using System;\nusing System.DirectoryServices;\n\nprivate static void SetAppPoolCredentials(string serverName, string appPoolName, string username, string password)\n{\n    string metabasePath = string.Format("IIS://{0}/W3SVC/AppPools/{1}", serverName, appPoolName);\n    try\n    {\n        DirectoryEntry appPool = new DirectoryEntry(metabasePath);\n        appPool.Properties["AppPoolIdentityType"].Value = 3; // Set to SpecificUser\n        appPool.Properties["WAMUserName"].Value = username;\n        appPool.Properties["WAMUserPass"].Value = password;\n        appPool.CommitChanges();\n        Console.WriteLine("Credentials updated successfully.");\n    }\n    catch (Exception ex)\n    {\n        Console.WriteLine("Failed to set credentials with the following exception: \n{0}", ex.Message);\n    }\n}