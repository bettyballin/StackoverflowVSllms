using System;\nusing System.Security.Cryptography.X509Certificates;\nusing System.Security.Cryptography;\nusing System.Security.AccessControl;\n\npublic class CertificatePermission\n{\n    public static void Main()\n    {\n        X509Store store = new X509Store(StoreName.My, StoreLocation.LocalMachine);\n        store.Open(OpenFlags.ReadWrite);\n\n        X509Certificate2 cert = new X509Certificate2("test.pfx", "password");\n        store.Add(cert);\n        store.Close();\n\n        // Get the private key\n        if (cert.HasPrivateKey)\n        {\n            CngKey key = cert.GetRSAPrivateKey() as RSACng?.Key;\n            if (key != null)\n            {\n                CngKeySecurity keySecurity = key.GetAccessControl();\n                \n                // Add a rule that grants the NetworkService account read access\n                keySecurity.AddAccessRule(new CngKeyAccessRule("NETWORK SERVICE", \n                    CngKeyRights.GenericRead, \n                    AccessControlType.Allow));\n\n                key.SetAccessControl(keySecurity);\n            }\n        }\n    }\n}