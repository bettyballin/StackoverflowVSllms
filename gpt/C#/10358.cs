using System;\nusing Microsoft.SharePoint.Client;\nusing Microsoft.SharePoint.Client.WorkflowServices;\n\npublic class WorkflowManager\n{\n    public static void StopWorkflow(string siteUrl, string listTitle, int itemId, string workflowSubscriptionName)\n    {\n        ClientContext context = new ClientContext(siteUrl);\n        \n        // Authenticate to SharePoint (adjust accordingly)\n        context.Credentials = new SharePointOnlineCredentials("username", "password");\n\n        // Get the list item\n        List list = context.Web.Lists.GetByTitle(listTitle);\n        ListItem item = list.GetItemById(itemId);\n        context.Load(item);\n        context.ExecuteQuery();\n\n        // Get the workflow services manager\n        WorkflowServicesManager workflowServicesManager = new WorkflowServicesManager(context, context.Web);\n        WorkflowInstanceService instanceService = workflowServicesManager.GetWorkflowInstanceService();\n\n        // Get all workflow instances running on the item\n        var instances = instanceService.EnumerateInstancesForListItem(list.Id, item.Id);\n        context.Load(instances);\n        context.ExecuteQuery();\n\n        // Find the workflow instance by name and cancel it\n        foreach (var instance in instances)\n        {\n            if (instance.WorkflowSubscriptionName == workflowSubscriptionName)\n            {\n                instanceService.CancelWorkflow(instance);\n                context.ExecuteQuery();\n                Console.WriteLine($"Workflow '{workflowSubscriptionName}' has been canceled.");\n                break;\n            }\n        }\n    }\n}