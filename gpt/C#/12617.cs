using System;\nusing System.Configuration;\nusing System.Web.Configuration;\nusing System.Web;\n\npublic class ModuleChecker\n{\n    public static bool IsModulePresent(string moduleName)\n    {\n        bool isModulePresent = false;\n\n        // Check the legacy <httpModules> section\n        HttpModulesSection httpModulesSection = (HttpModulesSection)ConfigurationManager.GetSection("system.web/httpModules");\n        if (httpModulesSection != null)\n        {\n            foreach (HttpModuleAction module in httpModulesSection.Modules)\n            {\n                if (module.Type == moduleName)\n                {\n                    isModulePresent = true;\n                    break;\n                }\n            }\n        }\n\n        // Check the newer <system.webServer> section\n        if (!isModulePresent)\n        {\n            Configuration config = WebConfigurationManager.OpenWebConfiguration(HttpContext.Current.Request.ApplicationPath);\n            ModulesSection modulesSection = (ModulesSection)config.GetSection("system.webServer/modules");\n            if (modulesSection != null)\n            {\n                foreach (Module module in modulesSection.Modules)\n                {\n                    if (module.Type == moduleName)\n                    {\n                        isModulePresent = true;\n                        break;\n                    }\n                }\n            }\n        }\n\n        return isModulePresent;\n    }\n}