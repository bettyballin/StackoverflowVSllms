using System;\nusing System.Data.SqlClient;\nusing System.Data.Odbc;\nusing System.Configuration;\n\nclass DataTransfer\n{\n    static void Main()\n    {\n        string sqlConnectionString = ConfigurationManager.ConnectionStrings["SQLServer"].ToString();\n        string oldConnectionString = ConfigurationManager.ConnectionStrings["OldServer"].ToString();\n\n        using (SqlConnection sqlConn = new SqlConnection(sqlConnectionString))\n        {\n            sqlConn.Open();\n            \n            // Delete current data\n            string deleteSQL = "DELETE FROM Data"; // Correct DELETE SQL syntax\n            using (SqlCommand sqlComm = new SqlCommand(deleteSQL, sqlConn))\n            {\n                sqlComm.ExecuteNonQuery();\n            }\n\n            // Fetch data from old server\n            using (OdbcConnection oldConn = new OdbcConnection(oldConnectionString))\n            {\n                oldConn.Open();\n                string selectStatement = "SELECT * FROM BILL.TRANSACTIONS WHERE TRANSACTION='NEW'";\n                using (OdbcCommand oldComm = new OdbcCommand(selectStatement, oldConn))\n                {\n                    using (OdbcDataReader oldDataReader = oldComm.ExecuteReader())\n                    {\n                        using (SqlTransaction transaction = sqlConn.BeginTransaction())\n                        {\n                            while (oldDataReader.Read())\n                            {\n                                string insertSQL = "INSERT INTO Data (Column1, Column2, ...) VALUES (@Value1, @Value2, ...)";\n                                using (SqlCommand insertComm = new SqlCommand(insertSQL, sqlConn, transaction))\n                                {\n                                    insertComm.Parameters.AddWithValue("@Value1", oldDataReader["Column1"]);\n                                    insertComm.Parameters.AddWithValue("@Value2", oldDataReader["Column2"]);\n                                    // Add other parameters as needed\n\n                                    insertComm.ExecuteNonQuery();\n                                }\n                            }\n                            transaction.Commit();\n                        }\n                    }\n                }\n            }\n        }\n    }\n}