using System;\nusing System.Runtime.InteropServices;\n\nclass Program\n{\n    [DllImport("wininet.dll", SetLastError = true, CharSet = CharSet.Auto)]\n    public static extern bool InternetSetOption(IntPtr hInternet, int dwOption, IntPtr lpBuffer, int dwBufferLength);\n\n    private const int INTERNET_OPTION_PROXY = 38;\n    private const int INTERNET_OPEN_TYPE_PROXY = 3;\n    private const int INTERNET_OPTION_SETTINGS_CHANGED = 39;\n    private const int INTERNET_OPTION_REFRESH = 37;\n\n    [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]\n    public struct INTERNET_PROXY_INFO\n    {\n        public int dwAccessType;\n        public IntPtr lpszProxy;\n        public IntPtr lpszProxyBypass;\n    }\n\n    public static void SetProxy(string proxy)\n    {\n        INTERNET_PROXY_INFO proxyInfo = new INTERNET_PROXY_INFO();\n        proxyInfo.dwAccessType = INTERNET_OPEN_TYPE_PROXY;\n        proxyInfo.lpszProxy = Marshal.StringToHGlobalAuto(proxy);\n        proxyInfo.lpszProxyBypass = Marshal.StringToHGlobalAuto("local");\n\n        IntPtr proxyInfoPtr = Marshal.AllocHGlobal(Marshal.SizeOf(proxyInfo));\n        Marshal.StructureToPtr(proxyInfo, proxyInfoPtr, true);\n\n        bool set = InternetSetOption(IntPtr.Zero, INTERNET_OPTION_PROXY, proxyInfoPtr, Marshal.SizeOf(proxyInfo));\n        bool settingsChanged = InternetSetOption(IntPtr.Zero, INTERNET_OPTION_SETTINGS_CHANGED, IntPtr.Zero, 0);\n        bool refresh = InternetSetOption(IntPtr.Zero, INTERNET_OPTION_REFRESH, IntPtr.Zero, 0);\n\n        Marshal.FreeHGlobal(proxyInfo.lpszProxy);\n        Marshal.FreeHGlobal(proxyInfo.lpszProxyBypass);\n        Marshal.FreeHGlobal(proxyInfoPtr);\n\n        if (!set || !settingsChanged || !refresh)\n        {\n            throw new ApplicationException("Failed to set proxy");\n        }\n    }\n\n    static void Main(string[] args)\n    {\n        try\n        {\n            SetProxy("http://yourproxyaddress:port");\n            Console.WriteLine("Proxy settings have been updated successfully.");\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine("Error updating proxy settings: " + ex.Message);\n        }\n    }\n}