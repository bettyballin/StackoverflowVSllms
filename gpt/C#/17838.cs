public static class SequentialGuid\n{\n    public static Guid NewSequentialGuid()\n    {\n        byte[] guidArray = Guid.NewGuid().ToByteArray();\n\n        DateTime baseDate = new DateTime(1900, 1, 1);\n        DateTime now = DateTime.Now;\n\n        // Get the days and milliseconds which will be used to build the byte string\n        TimeSpan days = new TimeSpan(now.Ticks - baseDate.Ticks);\n        TimeSpan msecs = now.TimeOfDay;\n\n        // Convert to a byte array\n        byte[] daysArray = BitConverter.GetBytes(days.Days);\n        byte[] msecsArray = BitConverter.GetBytes((long)(msecs.TotalMilliseconds / 3.333333));\n\n        // Reverse the bytes to match SQL Server ordering\n        Array.Reverse(daysArray);\n        Array.Reverse(msecsArray);\n\n        // Copy the bytes into the guid\n        Array.Copy(daysArray, daysArray.Length - 2, guidArray, guidArray.Length - 6, 2);\n        Array.Copy(msecsArray, msecsArray.Length - 4, guidArray, guidArray.Length - 4, 4);\n\n        return new Guid(guidArray);\n    }\n}