using Microsoft.AspNet.SignalR;\nusing System.Collections.Generic;\nusing System.Linq;\n\npublic class UserActivityHub : Hub\n{\n    private static readonly Dictionary<string, string> ActiveUsers = new Dictionary<string, string>();\n\n    public override System.Threading.Tasks.Task OnConnected()\n    {\n        string userName = Context.User.Identity.Name;\n        if (!ActiveUsers.ContainsKey(Context.ConnectionId))\n        {\n            ActiveUsers.Add(Context.ConnectionId, userName);\n        }\n        Clients.All.updateUserList(ActiveUsers.Values.ToList());\n        return base.OnConnected();\n    }\n\n    public override System.Threading.Tasks.Task OnDisconnected(bool stopCalled)\n    {\n        if (ActiveUsers.ContainsKey(Context.ConnectionId))\n        {\n            ActiveUsers.Remove(Context.ConnectionId);\n        }\n        Clients.All.updateUserList(ActiveUsers.Values.ToList());\n        return base.OnDisconnected(stopCalled);\n    }\n}