using System;\nusing System.Collections.Generic;\nusing System.IO;\nusing System.Runtime.Serialization;\nusing System.Runtime.Serialization.Formatters.Binary;\nusing System.Windows.Documents;\n\n[Serializable]\npublic class Question\n{\n    private byte[] richText1;\n    private byte[] richText2;\n\n    public void SetRichText1(TextRange textRange)\n    {\n        richText1 = SerializeTextRange(textRange);\n    }\n\n    public void SetRichText2(TextRange textRange)\n    {\n        richText2 = SerializeTextRange(textRange);\n    }\n\n    public TextRange GetRichText1()\n    {\n        return DeserializeTextRange(richText1);\n    }\n\n    public TextRange GetRichText2()\n    {\n        return DeserializeTextRange(richText2);\n    }\n\n    private byte[] SerializeTextRange(TextRange textRange)\n    {\n        using (MemoryStream stream = new MemoryStream())\n        {\n            textRange.Save(stream, DataFormats.XamlPackage);\n            return stream.ToArray();\n        }\n    }\n\n    private TextRange DeserializeTextRange(byte[] data)\n    {\n        using (MemoryStream stream = new MemoryStream(data))\n        {\n            TextRange textRange = new TextRange(new FlowDocument().ContentStart, new FlowDocument().ContentEnd);\n            textRange.Load(stream, DataFormats.XamlPackage);\n            return textRange;\n        }\n    }\n}\n\npublic class QuestionManager\n{\n    public void SaveQuestions(List<Question> questions, string filePath)\n    {\n        IFormatter formatter = new BinaryFormatter();\n        using (Stream stream = new FileStream(filePath, FileMode.Create, FileAccess.Write, FileShare.None))\n        {\n            formatter.Serialize(stream, questions);\n        }\n    }\n\n    public List<Question> LoadQuestions(string filePath)\n    {\n        IFormatter formatter = new BinaryFormatter();\n        using (Stream stream = new FileStream(filePath, FileMode.Open, FileAccess.Read, FileShare.Read))\n        {\n            return (List<Question>)formatter.Deserialize(stream);\n        }\n    }\n}