// Generate a unique token in the session\nprotected void Page_Load(object sender, EventArgs e)\n{\n    if (!IsPostBack)\n    {\n        string token = Guid.NewGuid().ToString();\n        Session["RequestToken"] = token;\n        hiddenFieldToken.Value = token;\n    }\n}\n\n// Validate the token on form submission\nprotected void SubmitButton_Click(object sender, EventArgs e)\n{\n    string sessionToken = Session["RequestToken"] as string;\n    string requestToken = hiddenFieldToken.Value;\n\n    if (sessionToken != null && sessionToken == requestToken)\n    {\n        // Token is valid, process the request\n        Session["RequestToken"] = null; // Invalidate the token after use\n    }\n    else\n    {\n        // Token is invalid, reject the request\n        throw new InvalidOperationException("Duplicate request detected.");\n    }\n}