using System;\nusing System.IO;\nusing System.Security.AccessControl;\n\npublic class FileSecurityReset\n{\n    public static void ResetFileSecurity(string directoryPath)\n    {\n        DirectoryInfo dirInfo = new DirectoryInfo(directoryPath);\n        FileSystemSecurity security = dirInfo.GetAccessControl();\n\n        // Reset ACLs for all files in the directory\n        foreach (FileInfo file in dirInfo.GetFiles("*", SearchOption.AllDirectories))\n        {\n            file.SetAccessControl(security);\n        }\n\n        // Optionally, explicitly set desired ACLs for Users group\n        FileSystemAccessRule accessRule = new FileSystemAccessRule("Users", FileSystemRights.ReadAndExecute, AccessControlType.Allow);\n        security.AddAccessRule(accessRule);\n\n        foreach (FileInfo file in dirInfo.GetFiles("*", SearchOption.AllDirectories))\n        {\n            file.SetAccessControl(security);\n        }\n    }\n\n    public static void Main()\n    {\n        string installDirectory = @"C:\Program Files\Product";\n        ResetFileSecurity(installDirectory);\n    }\n}