using System;\nusing System.Data;\nusing System.Data.OleDb;\nusing System.IO;\n\npublic class ExcelDataExtractor\n{\n    public DataTable GetExcelData(Stream fileStream)\n    {\n        // Create a temporary file path\n        string tempFilePath = Path.GetTempFileName();\n        \n        try\n        {\n            // Write the file stream to the temporary file\n            using (var file = new FileStream(tempFilePath, FileMode.Create, FileAccess.Write))\n            {\n                fileStream.CopyTo(file);\n            }\n            \n            // Construct the connection string for the Excel file\n            string connectionString = $"Provider=Microsoft.ACE.OLEDB.12.0;Data Source={tempFilePath};Extended Properties=\"Excel 12.0;HDR=YES;\"";\n\n            // Create and open the OleDbConnection\n            using (var connection = new OleDbConnection(connectionString))\n            {\n                connection.Open();\n                \n                // Define a query to select data from the first sheet\n                string query = "SELECT * FROM [Sheet1$]";\n                \n                // Create a DataTable to store the results\n                DataTable dataTable = new DataTable();\n                \n                // Fill the DataTable with data from the Excel file\n                using (OleDbDataAdapter adapter = new OleDbDataAdapter(query, connection))\n                {\n                    adapter.Fill(dataTable);\n                }\n                \n                return dataTable;\n            }\n        }\n        finally\n        {\n            // Clean up the temporary file\n            if (File.Exists(tempFilePath))\n            {\n                File.Delete(tempFilePath);\n            }\n        }\n    }\n}