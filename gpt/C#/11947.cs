using Microsoft.Win32;\n\nprivate string GetExpressPath()\n{\n    // Open the 64-bit registry view\n    RegistryKey sqlServerKey = RegistryKey.OpenBaseKey(RegistryHive.LocalMachine, RegistryView.Registry64)\n                                        .OpenSubKey(@"SOFTWARE\Microsoft\Microsoft SQL Server\Instance Names\SQL");\n    if (sqlServerKey == null)\n    {\n        throw new InvalidOperationException("SQL Server registry key not found.");\n    }\n\n    string sqlExpressKeyName = (string)sqlServerKey.GetValue("SQLEXPRESS");\n    if (string.IsNullOrEmpty(sqlExpressKeyName))\n    {\n        throw new InvalidOperationException("SQL Express instance name not found.");\n    }\n\n    RegistryKey sqlInstanceSetupKey = sqlServerKey.OpenSubKey(sqlExpressKeyName + @"\Setup");\n    if (sqlInstanceSetupKey == null)\n    {\n        throw new InvalidOperationException("SQL Express setup key not found.");\n    }\n\n    return sqlInstanceSetupKey.GetValue("SQLDataRoot").ToString();\n}