using System;\nusing System.DirectoryServices;\nusing System.Security.Principal;\n\npublic class ActiveDirectoryHelper\n{\n    public static string GetUserRid(string path, string username, string password)\n    {\n        DirectoryEntry entry = new DirectoryEntry(path, username, password);\n        byte[] sidBytes = (byte[])entry.Properties["objectSid"].Value;\n        SecurityIdentifier sid = new SecurityIdentifier(sidBytes, 0);\n        string sidValue = sid.ToString();\n        \n        // Extract RID (the last part of the SID)\n        string[] sidParts = sidValue.Split('-');\n        string rid = sidParts[sidParts.Length - 1];\n\n        return rid;\n    }\n}