using System;\nusing System.Windows;\nusing System.Windows.Controls;\nusing System.Windows.Documents;\nusing System.Windows.Media;\nusing System.Windows.Navigation;\n\nnamespace SilverlightHtmlTextBlock\n{\n    public partial class MainPage : UserControl\n    {\n        public MainPage()\n        {\n            InitializeComponent();\n            string htmlText = "This is <b>bold</b> and <i>italic</i> text with a <a href='http://example.com'>link</a>.";\n\n            RichTextBox rtb = new RichTextBox();\n            rtb.Blocks.Add(ParseHtml(htmlText));\n            LayoutRoot.Children.Add(rtb);\n        }\n\n        private Paragraph ParseHtml(string html)\n        {\n            Paragraph paragraph = new Paragraph();\n            int pos = 0;\n\n            while (pos < html.Length)\n            {\n                int startTag = html.IndexOf('<', pos);\n                if (startTag < 0)\n                {\n                    paragraph.Inlines.Add(new Run { Text = html.Substring(pos) });\n                    break;\n                }\n\n                if (startTag > pos)\n                {\n                    paragraph.Inlines.Add(new Run { Text = html.Substring(pos, startTag - pos) });\n                }\n\n                int endTag = html.IndexOf('>', startTag);\n                if (endTag < 0) break;\n\n                string tag = html.Substring(startTag, endTag - startTag + 1).ToLower();\n                string content = string.Empty;\n\n                if (tag.StartsWith("<b>") && html.IndexOf("</b>", endTag) > 0)\n                {\n                    int endBoldTag = html.IndexOf("</b>", endTag);\n                    content = html.Substring(endTag + 1, endBoldTag - endTag - 1);\n                    paragraph.Inlines.Add(new Bold(new Run { Text = content }));\n                    pos = endBoldTag + 4;\n                }\n                else if (tag.StartsWith("<i>") && html.IndexOf("</i>", endTag) > 0)\n                {\n                    int endItalicTag = html.IndexOf("</i>", endTag);\n                    content = html.Substring(endTag + 1, endItalicTag - endTag - 1);\n                    paragraph.Inlines.Add(new Italic(new Run { Text = content }));\n                    pos = endItalicTag + 4;\n                }\n                else if (tag.StartsWith("<a") && html.IndexOf("</a>", endTag) > 0)\n                {\n                    int hrefStart = tag.IndexOf("href='") + 6;\n                    int hrefEnd = tag.IndexOf("'", hrefStart);\n                    string url = tag.Substring(hrefStart, hrefEnd - hrefStart);\n\n                    int endAnchorTag = html.IndexOf("</a>", endTag);\n                    content = html.Substring(endTag + 1, endAnchorTag - endTag - 1);\n\n                    Hyperlink link = new Hyperlink\n                    {\n                        NavigateUri = new Uri(url),\n                        Foreground = new SolidColorBrush(Colors.Blue)\n                    };\n                    link.Inlines.Add(new Run { Text = content });\n                    link.Click += (sender, args) => HtmlHelper.OpenBrowser(url);\n\n                    paragraph.Inlines.Add(link);\n                    pos = endAnchorTag + 4;\n                }\n                else\n                {\n                    pos = endTag + 1;\n                }\n            }\n\n            return paragraph;\n        }\n    }\n\n    public static class HtmlHelper\n    {\n        public static void OpenBrowser(string url)\n        {\n            System.Windows.Browser.HtmlPage.Window.Navigate(new Uri(url), "_blank");\n        }\n    }\n}