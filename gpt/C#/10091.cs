using System;\nusing System.Net.Sockets;\nusing System.Text;\nusing System.Threading;\n\nclass Program\n{\n    private static TcpClient client;\n    private static NetworkStream stream;\n\n    static void Main(string[] args)\n    {\n        try\n        {\n            client = new TcpClient("GC-100-12-IP-Address", 4998); // Replace with the actual IP and port\n            stream = client.GetStream();\n            Console.WriteLine("Connected to GC-100-12");\n\n            while (true)\n            {\n                // Example of sending a command\n                string command = "IR Command here"; // Get command from your queue\n                SendCommand(command);\n\n                // Simulate some delay\n                Thread.Sleep(1000);\n            }\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine($"Exception: {ex.Message}");\n        }\n        finally\n        {\n            stream?.Close();\n            client?.Close();\n        }\n    }\n\n    static void SendCommand(string command)\n    {\n        try\n        {\n            if (client.Connected)\n            {\n                byte[] data = Encoding.ASCII.GetBytes(command + "\r\n");\n                stream.Write(data, 0, data.Length);\n\n                // Read response if necessary\n                byte[] responseData = new byte[256];\n                int bytes = stream.Read(responseData, 0, responseData.Length);\n                string response = Encoding.ASCII.GetString(responseData, 0, bytes);\n                Console.WriteLine($"Received: {response}");\n            }\n            else\n            {\n                Console.WriteLine("Connection lost. Attempting to reconnect...");\n                Reconnect();\n            }\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine($"Exception during SendCommand: {ex.Message}");\n            Reconnect();\n        }\n    }\n\n    static void Reconnect()\n    {\n        try\n        {\n            stream?.Close();\n            client?.Close();\n            client = new TcpClient("GC-100-12-IP-Address", 4998); // Replace with the actual IP and port\n            stream = client.GetStream();\n            Console.WriteLine("Reconnected to GC-100-12");\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine($"Reconnection failed: {ex.Message}");\n            // Optionally, implement a retry mechanism with delay\n        }\n    }\n}