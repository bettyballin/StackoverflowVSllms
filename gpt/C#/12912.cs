using System;\nusing System.Runtime.InteropServices;\nusing Microsoft.Win32;\n\nnamespace HelloNS\n{\n    public interface IHello\n    {\n        string Message();\n    }\n\n    [ClassInterface(ClassInterfaceType.AutoDual)]\n    [ComVisible(true)]\n    [ProgId("HelloNS.Hello")]\n    [Guid("YOUR-GUID-HERE")]\n    public class Hello : IHello\n    {\n        public string Message()\n        {\n            return "hello";\n        }\n\n        [ComRegisterFunction]\n        public static void RegisterClass(string key)\n        {\n            // Add custom registration logic here\n            using (RegistryKey k = Registry.ClassesRoot.OpenSubKey(key, true))\n            {\n                k.CreateSubKey("Control");\n                using (RegistryKey inprocServer32 = k.OpenSubKey("InprocServer32", true))\n                {\n                    inprocServer32.SetValue("", System.Environment.SystemDirectory + @"\mscoree.dll", RegistryValueKind.String);\n                }\n            }\n        }\n\n        [ComUnregisterFunction]\n        public static void UnregisterClass(string key)\n        {\n            // Add custom unregistration logic here\n            using (RegistryKey k = Registry.ClassesRoot.OpenSubKey(key, true))\n            {\n                k.DeleteSubKey("Control", false);\n            }\n        }\n    }\n}