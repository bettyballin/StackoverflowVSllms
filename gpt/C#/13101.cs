using System;\nusing Microsoft.Win32;\n\nclass Program\n{\n    static void Main()\n    {\n        // Define proxy server and port\n        string proxyServer = "http://yourproxyserver:port";\n        bool enableProxy = true;\n\n        // Set the registry key\n        RegistryKey registry = Registry.CurrentUser.OpenSubKey("Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings", true);\n\n        if (enableProxy)\n        {\n            registry.SetValue("ProxyEnable", 1);\n            registry.SetValue("ProxyServer", proxyServer);\n        }\n        else\n        {\n            registry.SetValue("ProxyEnable", 0);\n            registry.DeleteValue("ProxyServer", false);\n        }\n        \n        // Notify the system that the settings have been changed\n        InternetSetOption(IntPtr.Zero, INTERNET_OPTION_SETTINGS_CHANGED, IntPtr.Zero, 0);\n        InternetSetOption(IntPtr.Zero, INTERNET_OPTION_REFRESH, IntPtr.Zero, 0);\n\n        Console.WriteLine("Proxy settings updated successfully.");\n    }\n\n    // P/Invoke declarations\n    [System.Runtime.InteropServices.DllImport("wininet.dll", SetLastError = true)]\n    public static extern bool InternetSetOption(IntPtr hInternet, int dwOption, IntPtr lpBuffer, int dwBufferLength);\n\n    private const int INTERNET_OPTION_SETTINGS_CHANGED = 39;\n    private const int INTERNET_OPTION_REFRESH = 37;\n}