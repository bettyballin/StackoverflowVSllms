public static DataTable GetHistory(DateTime from, DateTime to, bool paramedics, bool police, bool firefighters)\n{\n    string query = "SELECT call_time, location, emergency_type FROM call WHERE call_time BETWEEN @from AND @to";\n    List<string> conditions = new List<string>();\n\n    if (paramedics)\n    {\n        conditions.Add("emergency_type = 'paramedics'");\n    }\n    if (police)\n    {\n        conditions.Add("emergency_type = 'police'");\n    }\n    if (firefighters)\n    {\n        conditions.Add("emergency_type = 'firefighters'");\n    }\n\n    if (conditions.Count > 0)\n    {\n        query += " AND (" + string.Join(" OR ", conditions) + ")";\n    }\n\n    using (SqlConnection conn = new SqlConnection("your_connection_string"))\n    {\n        using (SqlCommand cmd = new SqlCommand(query, conn))\n        {\n            cmd.Parameters.AddWithValue("@from", from);\n            cmd.Parameters.AddWithValue("@to", to);\n\n            using (SqlDataAdapter adapter = new SqlDataAdapter(cmd))\n            {\n                DataTable result = new DataTable();\n                adapter.Fill(result);\n                return result;\n            }\n        }\n    }\n}