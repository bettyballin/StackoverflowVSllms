using System;\nusing System.Data;\nusing System.Data.SqlClient;\n\npublic class QueueProcessor\n{\n    public void ProcessQueue()\n    {\n        using (SqlConnection connection = new SqlConnection("YourConnectionString"))\n        {\n            connection.Open();\n            while (true)\n            {\n                using (SqlCommand command = new SqlCommand("RECEIVE TOP(1) * FROM MyQueue", connection))\n                {\n                    SqlDataReader reader = command.ExecuteReader();\n\n                    if (reader.Read())\n                    {\n                        var messageBody = reader["message_body"].ToString();\n                        // Process message\n                        PerformComplexBusinessLogic(messageBody);\n                    }\n                }\n            }\n        }\n    }\n\n    private void PerformComplexBusinessLogic(string messageBody)\n    {\n        // Your complex business logic here\n    }\n}