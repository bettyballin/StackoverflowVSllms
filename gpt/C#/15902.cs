using System;\nusing System.Net;\nusing System.Net.Mail;\n\npublic void SendEmail(string[] emails, string[] files)\n{\n    try\n    {\n        MailMessage Enveloppe = new MailMessage();\n\n        // Add recipient emails\n        foreach (string email in emails)\n        {\n            Enveloppe.To.Add(email);\n        }\n\n        // Setup message parameters\n        Enveloppe.Subject = "Documentation";\n        Enveloppe.Body = "Infinitelycoolbodyhere";\n        Enveloppe.From = new MailAddress("mrzombie@stuff", "Myname");\n\n        // Add attachments\n        foreach (string filename in files)\n        {\n            Enveloppe.Attachments.Add(new Attachment(new System.Net.WebClient().OpenRead(filename), filename.Substring(filename.LastIndexOf('/') + 1)));\n        }\n\n        // Create the SMTP client\n        SmtpClient Mailman = new SmtpClient("mysmtphost")\n        {\n            EnableSsl = true,\n            Port = 465, // Ensure this port matches SMTP server requirements\n            DeliveryMethod = SmtpDeliveryMethod.Network,\n            Credentials = new NetworkCredential("usernamehere", "passwordhere"),\n            Timeout = 20000 // Set a timeout (in milliseconds) to avoid indefinite waiting\n        };\n\n        // Send the email\n        Mailman.Send(Enveloppe);\n    }\n    catch (Exception ex)\n    {\n        // Log or handle the exception\n        Console.WriteLine("An error occurred: " + ex.Message);\n        // You can also log ex.StackTrace for more detailed information\n    }\n}