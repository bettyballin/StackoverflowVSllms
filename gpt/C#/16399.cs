using System;\nusing System.Collections.Generic;\nusing System.Linq;\n\npublic class DataItem\n{\n    public int theID { get; set; }\n    public int theGroup { get; set; }\n    public string theValue { get; set; }\n}\n\npublic class PivotResult\n{\n    public int ID { get; set; }\n    public string CHOICE { get; set; }\n    public string COUNT { get; set; }\n    public string SORT { get; set; }\n}\n\npublic class Program\n{\n    public static void Main()\n    {\n        List<DataItem> data = new List<DataItem>\n        {\n            new DataItem { theID = 1, theGroup = 2, theValue = "Red" },\n            new DataItem { theID = 2, theGroup = 2, theValue = "Blue" },\n            new DataItem { theID = 3, theGroup = 2, theValue = "Green" },\n            new DataItem { theID = 1, theGroup = 3, theValue = "10" },\n            new DataItem { theID = 2, theGroup = 3, theValue = "24" },\n            new DataItem { theID = 3, theGroup = 3, theValue = "30" },\n            new DataItem { theID = 1, theGroup = 4, theValue = "1" },\n            new DataItem { theID = 2, theGroup = 4, theValue = "2" },\n            new DataItem { theID = 3, theGroup = 4, theValue = "3" }\n        };\n\n        var pivotResult = data\n            .GroupBy(d => d.theID)\n            .Select(g => new PivotResult\n            {\n                ID = g.Key,\n                CHOICE = g.FirstOrDefault(x => x.theGroup == 2)?.theValue,\n                COUNT = g.FirstOrDefault(x => x.theGroup == 3)?.theValue,\n                SORT = g.FirstOrDefault(x => x.theGroup == 4)?.theValue\n            })\n            .ToList();\n\n        foreach (var item in pivotResult)\n        {\n            Console.WriteLine($"ID: {item.ID}, CHOICE: {item.CHOICE}, COUNT: {item.COUNT}, SORT: {item.SORT}");\n        }\n    }\n}