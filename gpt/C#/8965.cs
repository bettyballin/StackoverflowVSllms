using System;\nusing System.Linq;\n\nvar query = from a in List.All()\n            join b in List.All() on new { a.Value, a.Category, a.Description, a.Item } \n                                equals new { b.Value, b.Category, b.Description, b.Item } into temp\n            from b in temp.DefaultIfEmpty()\n            where a.Category == "General" &&\n                  a.Description == "Cover" &&\n                  a.EffectiveDate <= new DateTime(2009, 4, 1) &&\n                  (b == null || b.EffectiveDate >= new DateTime(2009, 4, 1)) &&\n                  a.Item == "Type"\n            group b by new \n            { \n                a.Category, \n                a.Description, \n                a.Item, \n                a.Value, \n                a.Loading, \n                a.MaxDiscount, \n                a.SortOrder, \n                a.EffectiveDate, \n                a.ID \n            } into g\n            let FromDate = g.Min(b => b.EffectiveDate)\n            where FromDate == null || FromDate >= new DateTime(2009, 4, 1)\n            orderby g.Key.SortOrder\n            select new \n            {\n                g.Key.Category,\n                g.Key.Description,\n                g.Key.Item,\n                g.Key.Value,\n                g.Key.Loading,\n                g.Key.MaxDiscount,\n                FromDate,\n                EndDate = g.Key.EffectiveDate,\n                g.Key.SortOrder,\n                g.Key.ID\n            };\n\nvar resultList = query.ToList();