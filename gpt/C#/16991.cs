using System;\nusing WIA;\n\nnamespace CameraCapture\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            // Create a new instance of the WIA device manager\n            DeviceManager deviceManager = new DeviceManager();\n\n            // Loop through the available devices to find a camera\n            DeviceInfo availableDevice = null;\n            foreach (DeviceInfo deviceInfo in deviceManager.DeviceInfos)\n            {\n                if (deviceInfo.Type == WiaDeviceType.CameraDeviceType)\n                {\n                    availableDevice = deviceInfo;\n                    break;\n                }\n            }\n\n            if (availableDevice != null)\n            {\n                // Connect to the camera\n                Device camera = availableDevice.Connect();\n\n                // Take a picture\n                Item item = camera.Items[1];\n                ImageFile image = (ImageFile)item.Transfer(FormatID.wiaFormatJPEG);\n\n                // Save the image to a file\n                string imagePath = @"C:\Temp\captured.jpg";\n                image.SaveFile(imagePath);\n\n                Console.WriteLine("Image captured and saved to " + imagePath);\n            }\n            else\n            {\n                Console.WriteLine("No camera found.");\n            }\n        }\n    }\n}