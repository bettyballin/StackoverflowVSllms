using System;\nusing System.DirectoryServices;\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        try\n        {\n            string serverName = Environment.MachineName;\n            DirectoryEntry dir = new DirectoryEntry($"IIS://{serverName}/W3SVC/1/ROOT");\n            dir.AuthenticationType = AuthenticationTypes.Secure;\n            PrintChildren(dir, 0);\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine("An error occurred: " + ex.Message);\n        }\n    }\n\n    private static void PrintChildren(DirectoryEntry entry, int level)\n    {\n        try\n        {\n            foreach (DirectoryEntry child in entry.Children)\n            {\n                Console.WriteLine("");\n                Console.WriteLine("|");\n                for (int i = 0; i < level; i++)\n                {\n                    Console.Write("----");\n                }\n                Console.Write(child.Name);\n\n                if (child.Children != null)\n                {\n                    PrintChildren(child, level + 1);\n                }\n            }\n        }\n        catch (UnauthorizedAccessException uae)\n        {\n            Console.WriteLine("Access denied: " + uae.Message);\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine("An error occurred while accessing entries: " + ex.Message);\n        }\n    }\n}