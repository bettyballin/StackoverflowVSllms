using EnvDTE;\nusing EnvDTE80;\nusing System;\nusing System.Runtime.InteropServices;\nusing System.Windows.Forms;\n\nnamespace AutoReloadAddIn\n{\n    public class Connect : IDTExtensibility2, IDTCommandTarget\n    {\n        private DTE2 _applicationObject;\n        private AddIn _addInInstance;\n        \n        public void OnConnection(object application, ext_ConnectMode connectMode, object addInInst, ref Array custom)\n        {\n            _applicationObject = (DTE2)application;\n            _addInInstance = (AddIn)addInInst;\n\n            _applicationObject.Events.WindowEvents.WindowActivated += WindowEvents_WindowActivated;\n        }\n\n        private void WindowEvents_WindowActivated(Window GotFocus, Window LostFocus)\n        {\n            foreach (Window window in _applicationObject.Windows)\n            {\n                if (window.Caption.Contains("has been modified outside the source editor"))\n                {\n                    SendKeys.Send("{ENTER}");\n                }\n            }\n        }\n\n        public void OnDisconnection(ext_DisconnectMode disconnectMode, ref Array custom) { }\n        public void OnAddInsUpdate(ref Array custom) { }\n        public void OnStartupComplete(ref Array custom) { }\n        public void OnBeginShutdown(ref Array custom) { }\n        public void QueryStatus(string CmdName, vsCommandStatusTextWanted NeededText, ref vsCommandStatus StatusOption, ref object CommandText) { }\n        public void Exec(string CmdName, vsCommandExecOption ExecuteOption, ref object VariantIn, ref object VariantOut, ref bool Handled) { }\n    }\n}