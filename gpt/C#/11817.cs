using System;\nusing System.ComponentModel;\nusing System.IO;\nusing System.Net.Mail;\n\npublic class EmailSender\n{\n    private static MailMessage mailMsg;\n    private static string myAttachment = "path/to/your/attachment.file"; // Adjust the path accordingly\n\n    public static void SendEmailAsync()\n    {\n        SmtpClient smtp = new SmtpClient("your.mailserver.com"); // Replace with your mail server\n\n        mailMsg = new MailMessage("from@example.com", "to@example.com", "Subject", "Body");\n        Attachment attachment = new Attachment(myAttachment);\n        mailMsg.Attachments.Add(attachment);\n\n        smtp.SendCompleted += new SendCompletedEventHandler(MailSentCallback);\n        smtp.SendAsync(mailMsg, null);\n    }\n\n    private static void MailSentCallback(object sender, AsyncCompletedEventArgs e)\n    {\n        if (e.Error != null)\n        {\n            Console.WriteLine("Error sending email: " + e.Error.ToString());\n        }\n        else\n        {\n            Console.WriteLine("Email sent successfully.");\n            try\n            {\n                File.Delete(myAttachment);\n                Console.WriteLine("Attachment deleted successfully.");\n            }\n            catch (Exception ex)\n            {\n                Console.WriteLine("Error deleting attachment: " + ex.Message);\n            }\n        }\n\n        // Dispose the MailMessage object\n        mailMsg.Dispose();\n    }\n}