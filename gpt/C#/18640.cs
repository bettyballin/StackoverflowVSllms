using System;\nusing System.IO;\nusing System.Security.Cryptography.Pkcs;\nusing System.Security.Cryptography.X509Certificates;\n\npublic class FileSigner\n{\n    public static void SignFile(string certificatePath, string certificatePassword, string fileToSign)\n    {\n        // Load the certificate\n        X509Certificate2 certificate = new X509Certificate2(certificatePath, certificatePassword);\n\n        // Create a CmsSigner object\n        CmsSigner signer = new CmsSigner(SubjectIdentifierType.IssuerAndSerialNumber, certificate);\n\n        // Load the file to be signed\n        byte[] fileData = File.ReadAllBytes(fileToSign);\n\n        // Create a ContentInfo object from the file data\n        ContentInfo contentInfo = new ContentInfo(fileData);\n\n        // Create a SignedCms object\n        SignedCms signedCms = new SignedCms(contentInfo, true);\n\n        // Compute the signature\n        signedCms.ComputeSignature(signer);\n\n        // Encode the signed CMS/PKCS #7 message\n        byte[] signedFile = signedCms.Encode();\n\n        // Write the signed data to a new file\n        string signedFileName = fileToSign + ".signed";\n        File.WriteAllBytes(signedFileName, signedFile);\n\n        Console.WriteLine("Signed file: " + signedFileName);\n    }\n}