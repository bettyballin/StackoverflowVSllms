public void ProcessRequest (HttpContext context)\n{\n    context.Response.ContentType = "text/csv; charset=UTF-8";\n    context.Response.Charset = "UTF-8";\n    context.Response.ContentEncoding = System.Text.Encoding.UTF8;\n    context.Response.AddHeader("Content-disposition", "attachment;filename=lista_obecnosci.csv");\n\n    // Write the BOM for UTF-8\n    context.Response.BinaryWrite(new byte[] { 0xEF, 0xBB, 0xBF });\n\n    // Write the CSV content\n    context.Response.Write("ąęćżźńółĄŚŻŹĆŃŁÓĘ");\n}