using (SqlConnection sourceConn = new SqlConnection("SourceConnectionString"))\nusing (SqlConnection destConn = new SqlConnection("DestinationConnectionString"))\n{\n    sourceConn.Open();\n    destConn.Open();\n\n    SqlCommand selectCmd = new SqlCommand("SELECT * FROM ParentTable WHERE Condition", sourceConn);\n    SqlDataReader reader = selectCmd.ExecuteReader();\n\n    while (reader.Read())\n    {\n        // Insert into Destination Parent Table\n        SqlCommand insertCmd = new SqlCommand("INSERT INTO ParentTable (Column1, Column2) OUTPUT INSERTED.PK VALUES (@Column1, @Column2)", destConn);\n        insertCmd.Parameters.AddWithValue("@Column1", reader["Column1"]);\n        insertCmd.Parameters.AddWithValue("@Column2", reader["Column2"]);\n\n        int newPK = (int)insertCmd.ExecuteScalar();\n\n        // Insert into Temporary Mapping Table\n        SqlCommand mapCmd = new SqlCommand("INSERT INTO #PKMapping (OldPK, NewPK) VALUES (@OldPK, @NewPK)", destConn);\n        mapCmd.Parameters.AddWithValue("@OldPK", reader["PK"]);\n        mapCmd.Parameters.AddWithValue("@NewPK", newPK);\n        mapCmd.ExecuteNonQuery();\n    }\n}