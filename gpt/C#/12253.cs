void Application_Error(object sender, EventArgs e)\n{\n    // Get reference to the source of the exception chain\n    Exception ex = Server.GetLastError().GetBaseException();\n\n    // Log the details of the exception and page state to the Windows Event Log\n    GUI.MailClass objMail = new GUI.MailClass();\n    string strError = "MESSAGE: " + ex.Message + "<br><br><br>" + \n                      "SOURCE: " + ex.Source + "<br>FORM: " + \n                      Request.Form.ToString() + "<br>QUERYSTRING: " + \n                      Request.QueryString.ToString() + "<br>TARGETSITE: " + \n                      ex.TargetSite + "<br>STACKTRACE: " + ex.StackTrace;\n    \n    // Check if HttpContext and Session are available\n    if (HttpContext.Current != null && HttpContext.Current.Session != null)\n    {\n        if (HttpContext.Current.Session["trCustomerEmail"] != null)\n        {\n            strError = "Customer Email : " + \n                       HttpContext.Current.Session["trCustomerEmail"].ToString() + \n                       "<br />" + strError;\n        }\n    }\n\n    // Call a method to send the error details as an Email\n    objMail.sendMail("test@gmail.com", "myid@gmail.com", "Error in " + \n                     Request.Form.ToString(), strError, 2);\n}