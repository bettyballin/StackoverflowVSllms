using System.IO;\nusing System.Web;\nusing iTextSharp.text;\nusing iTextSharp.text.html.simpleparser;\nusing iTextSharp.text.pdf;\n\npublic void GeneratePDF(string htmlContent, string outputPath)\n{\n    using (var ms = new MemoryStream())\n    {\n        using (var doc = new Document())\n        {\n            PdfWriter writer = PdfWriter.GetInstance(doc, ms);\n            doc.Open();\n            using (var sr = new StringReader(htmlContent))\n            {\n                HTMLWorker htmlparser = new HTMLWorker(doc);\n                htmlparser.Parse(sr);\n            }\n            doc.Close();\n        }\n\n        File.WriteAllBytes(outputPath, ms.ToArray());\n    }\n}\n\npublic string RenderHtmlToString(string url)\n{\n    StringWriter stringWriter = new StringWriter();\n    HttpContext.Current.Server.Execute(url, stringWriter);\n    return stringWriter.ToString();\n}\n\n// Usage example\nstring url = "/path/to/your/invoice.aspx";\nstring htmlContent = RenderHtmlToString(url);\nstring outputPath = HttpContext.Current.Server.MapPath("~/invoices/invoice.pdf");\n\nGeneratePDF(htmlContent, outputPath);