#if SP2003\nusing Microsoft.SharePoint.Portal; // SharePoint 2003-specific namespace\n#else\nusing Microsoft.SharePoint.Administration; // SharePoint 2007-specific namespace\n#endif\n\npublic interface ISharePointService\n{\n    void TraverseObjectModel();\n}\n\n#if SP2003\npublic class SharePoint2003Service : ISharePointService\n{\n    public void TraverseObjectModel()\n    {\n        // Implementation for SharePoint 2003\n    }\n}\n#else\npublic class SharePoint2007Service : ISharePointService\n{\n    public void TraverseObjectModel()\n    {\n        // Implementation for SharePoint 2007\n    }\n}\n#endif\n\npublic class SharePointServiceFactory\n{\n    public static ISharePointService CreateService()\n    {\n#if SP2003\n        return new SharePoint2003Service();\n#else\n        return new SharePoint2007Service();\n#endif\n    }\n}