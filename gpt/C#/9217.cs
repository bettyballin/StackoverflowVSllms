using System;\nusing System.Management;\n\nclass Program\n{\n    static void Main()\n    {\n        try\n        {\n            // Connect to the WMI namespace\n            ManagementScope scope = new ManagementScope(@"\\.\root\wmi");\n            scope.Connect();\n\n            // Query the UPS service\n            ObjectQuery query = new ObjectQuery("SELECT * FROM Win32_Battery");\n            ManagementObjectSearcher searcher = new ManagementObjectSearcher(scope, query);\n\n            foreach (ManagementObject queryObj in searcher.Get())\n            {\n                // Output some properties\n                Console.WriteLine("Description: {0}", queryObj["Description"]);\n                Console.WriteLine("BatteryStatus: {0}", queryObj["BatteryStatus"]);\n                \n                // Here you can add logic to send shutdown commands to the UPS\n                // Note: Specific commands will depend on your UPS model and vendor\n            }\n        }\n        catch (ManagementException e)\n        {\n            Console.WriteLine("An error occurred while querying for WMI data: " + e.Message);\n        }\n    }\n}