using System.DirectoryServices.AccountManagement;\n\n// ...\n\nList<string> rowGroups = GetFileGroups((int)row.Cells["document_security_type"].Value);\nbool found = false;\nstring currentUser = System.Security.Principal.WindowsIdentity.GetCurrent().Name;\n\nusing (PrincipalContext contextA = new PrincipalContext(ContextType.Domain, "domainA"))\nusing (PrincipalContext contextB = new PrincipalContext(ContextType.Domain, "domainB"))\n{\n    UserPrincipal user = UserPrincipal.FindByIdentity(contextA, IdentityType.SamAccountName, currentUser) ??\n                         UserPrincipal.FindByIdentity(contextB, IdentityType.SamAccountName, currentUser);\n\n    if (user != null)\n    {\n        foreach (string group in rowGroups)\n        {\n            if (user.IsMemberOf(contextA, IdentityType.SamAccountName, group) ||\n                user.IsMemberOf(contextB, IdentityType.SamAccountName, group))\n            {\n                found = true;\n                break;\n            }\n        }\n    }\n}