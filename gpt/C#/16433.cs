public async Task<IActionResult> Download(string fileName)\n{\n    var userId = User.FindFirst(ClaimTypes.NameIdentifier).Value;\n    var fileRecord = await _context.FileRecords\n        .Where(f => f.FileName == fileName && (f.UserId == userId || User.IsInRole("Administrator")))\n        .FirstOrDefaultAsync();\n\n    if (fileRecord == null)\n    {\n        return NotFound();\n    }\n\n    var filePath = fileRecord.FilePath;\n    var fileBytes = await System.IO.File.ReadAllBytesAsync(filePath);\n    return File(fileBytes, "application/octet-stream", fileRecord.FileName);\n}