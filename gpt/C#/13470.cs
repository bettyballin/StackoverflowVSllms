using System;\nusing System.DirectoryServices;\n\npublic class ActiveDirectoryHelper\n{\n    public static bool IsUserActive(string username, string domain)\n    {\n        try\n        {\n            using (DirectoryEntry entry = new DirectoryEntry($"LDAP://{domain}"))\n            using (DirectorySearcher searcher = new DirectorySearcher(entry))\n            {\n                searcher.Filter = $"(&(objectClass=user)(sAMAccountName={username}))";\n                searcher.PropertiesToLoad.Add("userAccountControl");\n\n                SearchResult result = searcher.FindOne();\n\n                if (result != null)\n                {\n                    int userAccountControl = Convert.ToInt32(result.Properties["userAccountControl"][0]);\n                    return !Convert.ToBoolean(userAccountControl & 0x0002);\n                }\n                else\n                {\n                    return false; // User not found\n                }\n            }\n        }\n        catch (Exception ex)\n        {\n            // Handle exception\n            Console.WriteLine(ex.Message);\n            return false;\n        }\n    }\n}