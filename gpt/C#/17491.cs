using PowerPoint = Microsoft.Office.Interop.PowerPoint;\nusing Excel = Microsoft.Office.Interop.Excel;\n\ntry\n{\n    PowerPoint.Application ppApp = new PowerPoint.Application();\n    PowerPoint.Presentation ppPres = ppApp.Presentations.Open(fileTxtBox.Text,\n                                      Microsoft.Office.Core.MsoTriState.msoFalse,\n                                      Microsoft.Office.Core.MsoTriState.msoFalse,\n                                      Microsoft.Office.Core.MsoTriState.msoTrue);\n\n    List<Company> companies = new List<Company>();\n    int slidesCount = ppPres.Slides.Count;\n\n    for (int slideIndex = 1; slideIndex <= slidesCount; slideIndex++)\n    {\n        PowerPoint.Slide slide = ppPres.Slides[slideIndex];\n        int rows = 1;\n\n        for (int shapeIndex = 1; shapeIndex <= slide.Shapes.Count; shapeIndex++)\n        {\n            PowerPoint.Shape shape = slide.Shapes[shapeIndex];\n            if (shape.HasTable == Microsoft.Office.Core.MsoTriState.msoTrue)\n            {\n                PowerPoint.Cell cell = shape.Table.Cell(1, 1);\n\n                if (cell.Shape.TextFrame.TextRange.Text.Trim().ToLower().Contains("realized"))\n                {\n                    rows = shape.Table.Rows.Count;\n                    break;\n                }\n\n                ReleaseComObject(cell);\n            }\n            ReleaseComObject(shape);\n        }\n\n        Company comp = new Company(rows);\n        InitializeCompany(ref comp, slide);\n        companies.Add(comp);\n\n        ReleaseComObject(slide);\n    }\n\n    SaveInExcel(companies);\n\n    ppPres.Close();\n    ReleaseComObject(ppPres);\n\n    ppApp.Quit();\n    ReleaseComObject(ppApp);\n}\ncatch (Exception ex)\n{\n    MessageBox.Show(ex.Message);\n}\nfinally\n{\n    GC.Collect();\n    GC.WaitForPendingFinalizers();\n}\n\nvoid ReleaseComObject(object obj)\n{\n    if (obj != null && System.Runtime.InteropServices.Marshal.IsComObject(obj))\n    {\n        System.Runtime.InteropServices.Marshal.ReleaseComObject(obj);\n        obj = null;\n    }\n}