using System;\nusing System.Data;\nusing System.Data.SqlClient;\n\npublic class StoredProcedureExecutor\n{\n    private readonly string _connectionString;\n\n    public StoredProcedureExecutor(string connectionString)\n    {\n        _connectionString = connectionString;\n    }\n\n    public DataTable ExecuteStoredProcedure(string storedProcedureName, params SqlParameter[] parameters)\n    {\n        using (SqlConnection connection = new SqlConnection(_connectionString))\n        {\n            using (SqlCommand command = new SqlCommand(storedProcedureName, connection))\n            {\n                command.CommandType = CommandType.StoredProcedure;\n\n                if (parameters != null)\n                {\n                    command.Parameters.AddRange(parameters);\n                }\n\n                DataTable dataTable = new DataTable();\n                SqlDataAdapter dataAdapter = new SqlDataAdapter(command);\n\n                connection.Open();\n                dataAdapter.Fill(dataTable);\n\n                return dataTable;\n            }\n        }\n    }\n}