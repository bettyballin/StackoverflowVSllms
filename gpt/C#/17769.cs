using System;\nusing System.Diagnostics;\nusing System.Linq;\nusing System.Web;\nusing System.Windows.Forms;\n\npublic static class ApplicationTypeDetector\n{\n    public static string GetApplicationType()\n    {\n        if (IsConsoleApp())\n        {\n            return "Console Application";\n        }\n        else if (IsWinFormsApp())\n        {\n            return "WinForms Application";\n        }\n        else if (IsAspNetApp())\n        {\n            return "ASP.NET Application";\n        }\n        else if (IsWindowsService())\n        {\n            return "Windows Service";\n        }\n        else\n        {\n            return "Unknown Application Type";\n        }\n    }\n\n    private static bool IsConsoleApp()\n    {\n        return Environment.UserInteractive\n               && Console.OpenStandardInput(1) != Stream.Null;\n    }\n\n    private static bool IsWinFormsApp()\n    {\n        return Application.MessageLoop;\n    }\n\n    private static bool IsAspNetApp()\n    {\n        return HttpContext.Current != null;\n    }\n\n    private static bool IsWindowsService()\n    {\n        return !Environment.UserInteractive\n               && Process.GetCurrentProcess().MainModule.FileName.EndsWith(".exe", StringComparison.OrdinalIgnoreCase);\n    }\n}