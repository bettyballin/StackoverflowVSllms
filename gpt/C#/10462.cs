using System;\nusing System.Data;\nusing System.IO;\nusing Microsoft.VisualBasic.FileIO;\n\npublic class CSVParser\n{\n    public DataSet ParseCSV(string filePath)\n    {\n        DataSet dataSet = new DataSet();\n        DataTable dataTable = new DataTable("CSVData");\n\n        using (TextFieldParser parser = new TextFieldParser(filePath))\n        {\n            parser.TextFieldType = FieldType.Delimited;\n            parser.SetDelimiters(",");\n\n            bool columnsAdded = false;\n\n            while (!parser.EndOfData)\n            {\n                string[] fields = parser.ReadFields();\n\n                if (!columnsAdded)\n                {\n                    foreach (string column in fields)\n                    {\n                        dataTable.Columns.Add(column);\n                    }\n                    columnsAdded = true;\n                }\n                else\n                {\n                    DataRow row = dataTable.NewRow();\n                    for (int i = 0; i < fields.Length; i++)\n                    {\n                        row[i] = fields[i];\n                    }\n                    dataTable.Rows.Add(row);\n                }\n            }\n        }\n\n        dataSet.Tables.Add(dataTable);\n        return dataSet;\n    }\n}