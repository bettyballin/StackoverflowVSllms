public void Save() {\n    // Create a new XML file if there's no root element\n    if (xDocument.DocumentElement == null) {\n        xDocument = new XmlDocument();\n        xDocument.LoadXml("<?xml version=\"1.0\" encoding=\"utf-8\" ?>\n" +\n            "<" + XmlRootElement + ">\n</" + XmlRootElement + ">");\n    }\n\n    // OMITTED CODE WAS HERE (NOT IMPORTANT FOR THE PROBLEM)\n\n    const int maxRetries = 3;\n    const int delay = 1000; // delay in milliseconds\n\n    for (int attempt = 0; attempt < maxRetries; attempt++) {\n        try {\n            // Create a new XML writer for the XML file\n            using (XmlWriter xWriter = XmlWriter.Create(XmlFilePath, new XmlWriterSettings() {\n                Indent = true,\n                IndentChars = "\t"\n            })) {\n                // Sort the XML file using the XSL stylesheet and save it\n                xslTransform.Transform(xDocument, xWriter);\n\n                // Clear the buffer and close the XML writer stream\n                xWriter.Flush();\n            }\n            break; // Exit the loop if the save was successful\n        } catch (IOException ex) {\n            if (attempt == maxRetries - 1) {\n                // Log the exception or rethrow it if max retries reached\n                throw new Exception("Failed to save the XML file after multiple attempts.", ex);\n            }\n            // Wait before retrying\n            System.Threading.Thread.Sleep(delay);\n        }\n    }\n}