using Outlook = Microsoft.Office.Interop.Outlook;\n\npublic void SendEmailWithEmbeddedImages(string to, string subject, string htmlBody, Dictionary<string, string> images)\n{\n    Outlook.Application olkApp = new Outlook.Application();\n    Outlook.MailItem objMail = (Outlook.MailItem)olkApp.CreateItem(Outlook.OlItemType.olMailItem);\n\n    objMail.To = to;\n    objMail.Subject = subject;\n\n    // Replace image src with cid\n    foreach (var image in images)\n    {\n        string cid = Guid.NewGuid().ToString();\n        htmlBody = htmlBody.Replace(image.Key, $"cid:{cid}");\n\n        // Attach the image\n        Outlook.Attachment attachment = objMail.Attachments.Add(image.Value, Outlook.OlAttachmentType.olByValue, null, null);\n        attachment.PropertyAccessor.SetProperty("http://schemas.microsoft.com/mapi/proptag/0x3712001F", cid);\n    }\n\n    objMail.HTMLBody = htmlBody;\n    objMail.Send();\n}