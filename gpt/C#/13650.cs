using System.IO;\nusing iTextSharp.text;\nusing iTextSharp.text.pdf;\nusing iTextSharp.text.pdf.parser;\n\npublic void ConvertPdfToBlackAndWhite(string inputPath, string outputPath)\n{\n    using (var reader = new PdfReader(inputPath))\n    {\n        using (var fs = new FileStream(outputPath, FileMode.Create, FileAccess.Write))\n        {\n            using (var stamper = new PdfStamper(reader, fs))\n            {\n                int total = reader.NumberOfPages;\n                for (int i = 1; i <= total; i++)\n                {\n                    PdfContentByte cb = stamper.GetUnderContent(i);\n                    PdfDictionary pageDict = reader.GetPageN(i);\n                    PdfArray contentArray = pageDict.GetAsArray(PdfName.CONTENTS);\n                    if (contentArray != null)\n                    {\n                        foreach (PdfObject item in contentArray.ArrayList)\n                        {\n                            PRStream stream = (PRStream)PdfReader.GetPdfObject(item);\n                            byte[] data = PdfReader.GetStreamBytes(stream);\n                            string content = Encoding.UTF8.GetString(data);\n                            content = content.Replace("rg", "0 g");\n                            content = content.Replace("RG", "0 G");\n                            stream.SetData(Encoding.UTF8.GetBytes(content));\n                        }\n                    }\n                }\n            }\n        }\n    }\n}