using System;\nusing System.Net;\nusing System.Net.Http;\nusing System.Web.Http;\n\npublic class EmailController : ApiController\n{\n    [HttpGet]\n    [Route("api/emails")]\n    public HttpResponseMessage GetEmails()\n    {\n        // Use an IMAP library like MailKit to fetch emails\n        using (var client = new MailKit.Net.Imap.ImapClient())\n        {\n            client.Connect("imap.gmail.com", 993, true);\n            client.Authenticate("your-email@gmail.com", "your-app-password");\n\n            var inbox = client.Inbox;\n            inbox.Open(MailKit.FolderAccess.ReadOnly);\n\n            var emails = inbox.Fetch(0, -1, MailKit.MessageSummaryItems.Full | MailKit.MessageSummaryItems.UniqueId);\n\n            client.Disconnect(true);\n\n            return Request.CreateResponse(HttpStatusCode.OK, emails);\n        }\n    }\n}