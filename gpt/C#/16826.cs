[AttributeUsage(AttributeTargets.Method, AllowMultiple = false)]\npublic class RestrictedAttribute : ActionFilterAttribute\n{\n    private readonly string _requiredRole;\n\n    public RestrictedAttribute(string requiredRole)\n    {\n        _requiredRole = requiredRole;\n    }\n\n    public override void OnActionExecuting(ActionExecutingContext filterContext)\n    {\n        var user = filterContext.HttpContext.User;\n\n        if (!user.Identity.IsAuthenticated || !user.IsInRole(_requiredRole))\n        {\n            filterContext.Result = new HttpUnauthorizedResult();\n        }\n\n        base.OnActionExecuting(filterContext);\n    }\n\n    public override string ToString()\n    {\n        return "Access needs to be granted";\n    }\n}