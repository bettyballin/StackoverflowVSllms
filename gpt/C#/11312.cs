using System;\nusing System.DirectoryServices;\n\nclass Program\n{\n    static void Main()\n    {\n        DirectoryEntry rootEntry = new DirectoryEntry("LDAP://YourLDAPPath");\n        DirectorySearcher ouSearcher = new DirectorySearcher(rootEntry);\n        ouSearcher.Filter = "(objectClass=organizationalUnit)";\n        ouSearcher.SearchScope = SearchScope.Subtree;\n\n        foreach (SearchResult subOU in ouSearcher.FindAll())\n        {\n            ResultPropertyValueCollection subColl = subOU.Properties["distinguishedName"];\n            string subPath = subColl[0].ToString();\n            DirectoryEntry subEntry = new DirectoryEntry("LDAP://" + subPath);\n\n            DirectorySearcher userSearcher = new DirectorySearcher(subEntry);\n            userSearcher.SearchScope = SearchScope.OneLevel;\n            userSearcher.Filter = "(objectClass=user)";\n\n            foreach (SearchResult user in userSearcher.FindAll())\n            {\n                ResultPropertyValueCollection userColl = user.Properties["distinguishedName"];\n                string userPath = userColl[0].ToString();\n                DirectoryEntry userEntry = new DirectoryEntry("LDAP://" + userPath);\n\n                PropertyCollection associateProperties = userEntry.Properties;\n                PropertyCollection ouProperties = subEntry.Properties;\n\n                string streetAddress = string.Empty;\n\n                if (associateProperties.Contains("streetAddress") && associateProperties["streetAddress"].Value != null)\n                {\n                    streetAddress = associateProperties["streetAddress"].Value.ToString();\n                }\n                else if (ouProperties.Contains("streetAddress") && ouProperties["streetAddress"].Value != null)\n                {\n                    streetAddress = ouProperties["streetAddress"].Value.ToString();\n                }\n\n                Console.WriteLine($"User: {userPath}, Street Address: {streetAddress}");\n            }\n        }\n    }\n}