using System;\nusing System.Data.SqlClient;\n\npublic class BizTalkHostHelper\n{\n    public static string GetCurrentHostName()\n    {\n        string hostName = string.Empty;\n        string connectionString = "Server=YourServerName;Database=BizTalkMgmtDb;Integrated Security=True;";\n        \n        using (SqlConnection connection = new SqlConnection(connectionString))\n        {\n            connection.Open();\n            \n            string query = @"\n                SELECT HN.Name \n                FROM adm_HostInstance HI\n                JOIN adm_Host HN ON HI.HostID = HN.HostID\n                WHERE HI.ProcessID = @ProcessID";\n                \n            using (SqlCommand command = new SqlCommand(query, connection))\n            {\n                int processId = System.Diagnostics.Process.GetCurrentProcess().Id;\n                command.Parameters.AddWithValue("@ProcessID", processId);\n\n                SqlDataReader reader = command.ExecuteReader();\n                if (reader.Read())\n                {\n                    hostName = reader["Name"].ToString();\n                }\n            }\n        }\n\n        return hostName;\n    }\n}