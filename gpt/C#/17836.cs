FileInfo file = new FileInfo(Path.Combine(_module.FileDir, _file.FilePath));\nResponse.ClearContent();\nResponse.ClearHeaders();\nResponse.ContentType = _file.ContentType;\nResponse.AppendHeader("Content-Disposition", "attachment; filename=" + Regex.Replace(_file.FilePath, "\\s", "-"));\nResponse.AppendHeader("Content-Length", file.Length.ToString());\ntry\n{\n    Response.TransmitFile(file.FullName);\n    Response.Flush();\n    Response.End(); // Ensure the response is properly ended\n}\ncatch\n{\n    Response.ClearContent();\n    Response.StatusCode = 500;\n    Response.StatusDescription = "Internal Server Error";\n    Response.Write("An error occurred while processing your request.");\n}