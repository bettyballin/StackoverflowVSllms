using System;\nusing System.Collections;\nusing System.DirectoryServices;\n\npublic class Program\n{\n    public static void Main()\n    {\n        string domainController = "LDAP://MyDomainControllerName"; // Replace with your actual domain controller name\n        string domainDN = "DC=yourdomain,DC=com"; // Replace with your actual domain DN\n\n        try\n        {\n            DirectoryEntry entry = new DirectoryEntry($"{domainController}/{domainDN}");\n            DirectorySearcher searcher = new DirectorySearcher(entry)\n            {\n                Filter = "(objectClass=group)"\n            };\n\n            searcher.PropertiesToLoad.Add("cn");\n\n            SearchResultCollection results = searcher.FindAll();\n\n            foreach (SearchResult result in results)\n            {\n                Console.WriteLine($"Group: {result.Properties["cn"][0]}");\n\n                DirectoryEntry groupEntry = result.GetDirectoryEntry();\n                object members = groupEntry.Invoke("Members");\n\n                foreach (object member in (IEnumerable)members)\n                {\n                    DirectoryEntry memberEntry = new DirectoryEntry(member);\n                    Console.WriteLine($"Member: {memberEntry.Properties["cn"].Value}");\n                }\n            }\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine($"An error occurred: {ex.Message}");\n        }\n    }\n}