using Microsoft.Diagnostics.Runtime;\n   \n   public void AnalyzeProcess(int processId)\n   {\n       using (DataTarget dataTarget = DataTarget.AttachToProcess(processId, 5000, AttachFlag.Passive))\n       {\n           ClrRuntime runtime = dataTarget.ClrVersions[0].CreateRuntime();\n           foreach (ClrThread thread in runtime.Threads)\n           {\n               Console.WriteLine($"Thread {thread.ManagedThreadId} - {thread.StackTrace}");\n           }\n       }\n   }