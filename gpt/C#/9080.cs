using System;\nusing System.Management;\n\nclass Program\n{\n    static void Main()\n    {\n        try\n        {\n            string query = "SELECT * FROM Win32_Service WHERE Name='wuauserv'";\n            using (ManagementObjectSearcher searcher = new ManagementObjectSearcher(query))\n            {\n                foreach (ManagementObject service in searcher.Get())\n                {\n                    var startMode = service["StartMode"];\n                    var state = service["State"];\n                    Console.WriteLine("Windows Update Service Start Mode: " + startMode);\n                    Console.WriteLine("Windows Update Service State: " + state);\n\n                    if (startMode != null && state != null)\n                    {\n                        bool isEnabled = startMode.ToString().Equals("Auto", StringComparison.OrdinalIgnoreCase) &&\n                                         state.ToString().Equals("Running", StringComparison.OrdinalIgnoreCase);\n\n                        if (isEnabled)\n                        {\n                            Console.WriteLine("Windows Update is enabled and running.");\n                        }\n                        else\n                        {\n                            Console.WriteLine("Windows Update is not enabled or not running.");\n                        }\n                    }\n                }\n            }\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine("An error occurred: " + ex.Message);\n        }\n    }\n}