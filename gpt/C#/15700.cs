using System;\nusing System.IO;\nusing System.Security.Cryptography.X509Certificates;\n\nclass Program\n{\n    static void Main()\n    {\n        string customStoreName = "MyCustomStore";\n        X509Store store = new X509Store(customStoreName, StoreLocation.LocalMachine);\n\n        try\n        {\n            store.Open(OpenFlags.ReadOnly);\n\n            foreach (X509Certificate2 cert in store.Certificates)\n            {\n                // Export the certificate to a byte array\n                byte[] certData = cert.Export(X509ContentType.Pfx, "export_password");\n\n                // Save the certificate to a file\n                string certFileName = Path.Combine(@"c:\certs", $"{cert.Thumbprint}.pfx");\n                File.WriteAllBytes(certFileName, certData);\n\n                Console.WriteLine($"Certificate exported to {certFileName}");\n            }\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine($"An error occurred: {ex.Message}");\n        }\n        finally\n        {\n            store.Close();\n        }\n    }\n}