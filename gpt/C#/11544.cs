public static class WcfClientHelper\n{\n    public static void Use<T>(Func<T> createClient, Action<T> useClient) where T : ICommunicationObject, IDisposable\n    {\n        T client = createClient();\n        bool success = false;\n\n        try\n        {\n            useClient(client);\n            client.Close();\n            success = true;\n        }\n        catch (CommunicationException)\n        {\n            client.Abort();\n            throw;\n        }\n        catch (TimeoutException)\n        {\n            client.Abort();\n            throw;\n        }\n        catch (Exception)\n        {\n            client.Abort();\n            throw;\n        }\n        finally\n        {\n            if (!success)\n            {\n                client.Abort();\n            }\n\n            client.Dispose();\n        }\n    }\n}