using System;\nusing System.IO;\nusing System.Security.Cryptography;\nusing System.Text;\n\npublic class AesEncryption\n{\n    public string Encrypt(byte[] plainTextBytes, byte[] keyBytes, string initialVector)\n    {\n        byte[] initialVectorBytes = Encoding.ASCII.GetBytes(initialVector);\n        using (RijndaelManaged symmetricKey = new RijndaelManaged())\n        {\n            symmetricKey.Mode = CipherMode.CBC; // Change to CBC mode\n            symmetricKey.Padding = PaddingMode.PKCS7;\n            ICryptoTransform encryptor = symmetricKey.CreateEncryptor(keyBytes, initialVectorBytes);\n            using (MemoryStream memStream = new MemoryStream())\n            {\n                using (CryptoStream cryptoStream = new CryptoStream(memStream, encryptor, CryptoStreamMode.Write))\n                {\n                    cryptoStream.Write(plainTextBytes, 0, plainTextBytes.Length);\n                    cryptoStream.FlushFinalBlock();\n                    byte[] cipherTextBytes = memStream.ToArray();\n                    return ByteToHexConversion(cipherTextBytes);\n                }\n            }\n        }\n    }\n\n    private string ByteToHexConversion(byte[] byteArray)\n    {\n        StringBuilder hex = new StringBuilder(byteArray.Length * 2);\n        foreach (byte b in byteArray)\n        {\n            hex.AppendFormat("{0:x2}", b);\n        }\n        return hex.ToString();\n    }\n}