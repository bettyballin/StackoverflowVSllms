using Microsoft.Graph;\n    using Microsoft.Identity.Client;\n    using System;\n    using System.Net.Http;\n    using System.Net.Http.Headers;\n    using System.Threading.Tasks;\n\n    public class OutlookService\n    {\n        private static string clientId = "YOUR_CLIENT_ID";\n        private static string tenantId = "YOUR_TENANT_ID";\n        private static string clientSecret = "YOUR_CLIENT_SECRET";\n        private static string[] scopes = new[] { "https://graph.microsoft.com/.default" };\n\n        private static IConfidentialClientApplication confidentialClientApplication = ConfidentialClientApplicationBuilder\n            .Create(clientId)\n            .WithTenantId(tenantId)\n            .WithClientSecret(clientSecret)\n            .Build();\n\n        private static GraphServiceClient graphClient = new GraphServiceClient(new DelegateAuthenticationProvider(async (requestMessage) =>\n        {\n            var authResult = await confidentialClientApplication\n                .AcquireTokenForClient(scopes)\n                .ExecuteAsync();\n\n            requestMessage.Headers.Authorization = new AuthenticationHeaderValue("Bearer", authResult.AccessToken);\n        }));\n\n        public async Task<User> GetUserProfileAsync()\n        {\n            return await graphClient.Me.Request().GetAsync();\n        }\n\n        public async Task<IMailFolderMessagesCollectionPage> GetUserEmailsAsync()\n        {\n            return await graphClient.Me.MailFolders.Inbox.Messages.Request().GetAsync();\n        }\n    }\n\n    // Usage\n    public class Program \n    {\n        public static async Task Main(string[] args)\n        {\n            var outlookService = new OutlookService();\n            var userProfile = await outlookService.GetUserProfileAsync();\n            var userEmails = await outlookService.GetUserEmailsAsync();\n\n            Console.WriteLine($"User: {userProfile.DisplayName}");\n            foreach (var email in userEmails)\n            {\n                Console.WriteLine($"Email: {email.Subject}");\n            }\n        }\n    }