public class TCP {\n    private BackgroundWorker bw;\n    private TcpClient client;\n    private string srv = "127.0.0.1";  // Assuming server IP address is localhost\n    private Exception lastException;\n\n    public TCP(BackgroundWorker b) {\n        bw = b;\n        ConnectToServer();\n    }\n\n    private void ConnectToServer() {\n        try {\n            client = new TcpClient();\n            IPEndPoint server = new IPEndPoint(IPAddress.Parse(srv), 1337);\n            client.Connect(server); // Connect to the server\n            bw.ReportProgress(0);   // Update the GUI with the connection status\n\n            Thread t = new Thread(new ParameterizedThreadStart(HandleComms));\n            t.IsBackground = true;\n            t.Start(client);\n        } catch (Exception ex) {\n            lastException = ex;\n        }\n    }\n\n    public void HandleComms(object c) {\n        TcpClient client = (TcpClient)c;\n        NetworkStream stream = client.GetStream();\n        byte[] msg = new byte[4096];\n        int bytesRead = 0;\n\n        try {\n            bytesRead = stream.Read(msg, 0, 4096);\n            if (bytesRead > 0) {\n                StreamWriter writer = new StreamWriter("C:\\Users\\Chris\\Desktop\\ClientLog.txt", true);  // Append to the file\n                ASCIIEncoding encoder = new ASCIIEncoding();\n                string rx = encoder.GetString(msg, 0, bytesRead);\n                writer.WriteLine(rx);\n                writer.Close();\n            }\n        } catch (Exception ex) {\n            lastException = ex;\n        } finally {\n            client.Close();  // Close the connection after receiving the message\n        }\n    }\n}