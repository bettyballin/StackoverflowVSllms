using System;\nusing System.Management;\nusing Microsoft.Win32;\n\npublic class RemoteRegistry\n{\n    public static object GetRegistryValue(string remoteName, string hive, string keyPath, string valueName)\n    {\n        object value = null;\n        ManagementScope scope = new ManagementScope($@"\\{remoteName}\root\cimv2");\n        scope.Connect();\n\n        string query = $"SELECT * FROM Win32_Registry";\n        ObjectQuery objectQuery = new ObjectQuery(query);\n        ManagementObjectSearcher searcher = new ManagementObjectSearcher(scope, objectQuery);\n\n        foreach (ManagementObject registry in searcher.Get())\n        {\n            string path = $@"\\{remoteName}\root\default:StdRegProv";\n            ManagementClass registryClass = new ManagementClass(path);\n            registryClass.Scope = scope;\n\n            ManagementBaseObject inParams = registryClass.GetMethodParameters("GetStringValue");\n            inParams["hDefKey"] = ConvertHiveToInt(hive);\n            inParams["sSubKeyName"] = keyPath;\n            inParams["sValueName"] = valueName;\n\n            ManagementBaseObject outParams = registryClass.InvokeMethod("GetStringValue", inParams, null);\n            value = outParams["sValue"];\n        }\n\n        return value;\n    }\n\n    private static uint ConvertHiveToInt(string hive)\n    {\n        switch (hive.ToUpper())\n        {\n            case "HKEY_CLASSES_ROOT":\n                return 0x80000000;\n            case "HKEY_CURRENT_USER":\n                return 0x80000001;\n            case "HKEY_LOCAL_MACHINE":\n                return 0x80000002;\n            case "HKEY_USERS":\n                return 0x80000003;\n            case "HKEY_CURRENT_CONFIG":\n                return 0x80000005;\n            default:\n                throw new ArgumentException("Unknown hive.");\n        }\n    }\n}\n\nclass Program\n{\n    static void Main()\n    {\n        string remoteName = "RemoteMachineName";\n        string hive = "HKEY_LOCAL_MACHINE";\n        string keyPath = "SOFTWARE\\Example";\n        string valueName = "ExampleValue";\n\n        object value = RemoteRegistry.GetRegistryValue(remoteName, hive, keyPath, valueName);\n        Console.WriteLine($"Registry Value: {value}");\n    }\n}