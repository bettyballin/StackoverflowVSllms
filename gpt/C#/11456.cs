using System;\nusing System.Data;\nusing Oracle.ManagedDataAccess.Client;\n\npublic class OracleDataAccess\n{\n    private string connStr = "your_connection_string_here";\n\n    public DataSet GetEmails(string searchParam)\n    {\n        DataSet ds = new DataSet();\n\n        using (OracleConnection conn = new OracleConnection(this.connStr))\n        {\n            using (OracleCommand com = new OracleCommand("MYPKG.GETALLEMAILS", conn))\n            {\n                com.CommandType = CommandType.StoredProcedure;\n                com.Parameters.Add("searchParam", OracleDbType.Varchar2).Value = searchParam;\n                com.Parameters.Add("outCursor", OracleDbType.RefCursor, ParameterDirection.Output);\n\n                using (OracleDataAdapter adapter = new OracleDataAdapter(com))\n                {\n                    conn.Open();\n                    adapter.Fill(ds);\n                }\n            }\n        }\n\n        return ds;\n    }\n}