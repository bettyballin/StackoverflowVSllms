using System;\nusing System.Diagnostics;\n\npublic class IISResetWatcher\n{\n    public static void Main()\n    {\n        EventLog eventLog = new EventLog("System");\n        eventLog.EntryWritten += new EntryWrittenEventHandler(OnEntryWritten);\n        eventLog.EnableRaisingEvents = true;\n        \n        Console.WriteLine("Monitoring IIS Reset events. Press Enter to exit...");\n        Console.ReadLine();\n    }\n\n    private static void OnEntryWritten(object source, EntryWrittenEventArgs e)\n    {\n        if (e.Entry.Source == "IIS-IISReset" && e.Entry.InstanceId == 1074) // Example Event ID for IIS Reset\n        {\n            Console.WriteLine("IIS Reset detected at: " + e.Entry.TimeGenerated);\n            // Add logic to restart Windows Services here\n            RestartWindowsServices();\n        }\n    }\n\n    private static void RestartWindowsServices()\n    {\n        // Logic to restart your Windows Services\n        Console.WriteLine("Restarting Windows Services...");\n    }\n}