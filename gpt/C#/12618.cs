using PacketDotNet;\n   using SharpPcap;\n\n   class Program\n   {\n       static void Main(string[] args)\n       {\n           var devices = CaptureDeviceList.Instance;\n           var device = devices[0];\n           device.OnPacketArrival += new PacketArrivalEventHandler(OnPacketArrival);\n           device.Open(DeviceMode.Promiscuous, 1000);\n           device.StartCapture();\n       }\n\n       private static void OnPacketArrival(object sender, CaptureEventArgs e)\n       {\n           var packet = Packet.ParsePacket(e.Packet.LinkLayerType, e.Packet.Data);\n           Console.WriteLine(packet.ToString());\n       }\n   }