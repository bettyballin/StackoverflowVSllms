using System.Security.Cryptography;\n    using System.Text;\n\n    public static class EncryptionHelper\n    {\n        public static string EncryptString(string plainText, byte[] key, byte[] iv)\n        {\n            using (Aes aesAlg = Aes.Create())\n            {\n                aesAlg.Key = key;\n                aesAlg.IV = iv;\n                ICryptoTransform encryptor = aesAlg.CreateEncryptor(aesAlg.Key, aesAlg.IV);\n                using (MemoryStream msEncrypt = new MemoryStream())\n                {\n                    using (CryptoStream csEncrypt = new CryptoStream(msEncrypt, encryptor, CryptoStreamMode.Write))\n                    {\n                        using (StreamWriter swEncrypt = new StreamWriter(csEncrypt))\n                        {\n                            swEncrypt.Write(plainText);\n                        }\n                        return Convert.ToBase64String(msEncrypt.ToArray());\n                    }\n                }\n            }\n        }\n    }