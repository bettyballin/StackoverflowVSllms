using System;\nusing System.Collections.Generic;\nusing System.DirectoryServices;\n\nclass Program\n{\n    static void Main()\n    {\n        List<string> departments = GetDepartments();\n        \n        foreach (var department in departments)\n        {\n            Console.WriteLine(department);\n        }\n    }\n\n    static List<string> GetDepartments()\n    {\n        List<string> departmentList = new List<string>();\n        string ldapPath = "LDAP://YourLdapPath"; // e.g., LDAP://DC=yourdomain,DC=com\n        DirectoryEntry entry = new DirectoryEntry(ldapPath);\n        DirectorySearcher searcher = new DirectorySearcher(entry)\n        {\n            Filter = "(objectClass=user)"\n        };\n        searcher.PropertiesToLoad.Add("department");\n\n        try\n        {\n            SearchResultCollection results = searcher.FindAll();\n\n            foreach (SearchResult result in results)\n            {\n                if (result.Properties["department"].Count > 0)\n                {\n                    string department = result.Properties["department"][0].ToString();\n                    if (!departmentList.Contains(department))\n                    {\n                        departmentList.Add(department);\n                    }\n                }\n            }\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine("Error: " + ex.Message);\n        }\n\n        return departmentList;\n    }\n}