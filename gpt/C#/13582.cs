public class ClientDbService\n    {\n        private readonly ClientDbContext _clientDbContext;\n\n        public ClientDbService(ClientDbContext clientDbContext)\n        {\n            _clientDbContext = clientDbContext;\n        }\n\n        public void CheckAccess(User user, string action)\n        {\n            var role = _clientDbContext.ClientRoles.SingleOrDefault(r => r.RoleId == user.RoleId);\n            if (role == null || !role.CustomPermissions.Any(p => p.Action == action))\n                throw new UnauthorizedAccessException("Access denied");\n        }\n    }