void updateMediaForSubscribers(long userId, long mediaId, Media_Base.Catagory cat, DateTime currentDate)\n{\n    // Insert new subscriptions\n    command.CommandText =\n        "INSERT INTO user_media_subscription (recipientId, mediaId, catagory) " +\n        "SELECT watcher, @mediaId, @category " +\n        "FROM user_watch WHERE watched=@watched;";\n    command.Parameters.Add("@mediaId", DbType.Int64).Value = mediaId;\n    command.Parameters.Add("@category", DbType.Int64).Value = cat;\n    command.Parameters.Add("@watched", DbType.Int64).Value = userId;\n    command.ExecuteNonQuery();\n\n    // Update media count for users\n    command.CommandText =\n        "UPDATE user_data " +\n        "SET mediaMsgCount = mediaMsgCount + 1 " +\n        "FROM user_data ud " +\n        "INNER JOIN user_watch w ON w.watcher = ud.userId " +\n        "WHERE w.watched = @watched;";\n    \n    // Clear previous parameters to avoid conflicts\n    command.Parameters.Clear();\n    command.Parameters.Add("@watched", DbType.Int64).Value = userId;\n    command.ExecuteNonQuery();\n}