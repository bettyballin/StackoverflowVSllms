using System;\nusing Microsoft.TeamFoundation.Client;\nusing Microsoft.TeamFoundation.VersionControl.Client;\nusing EnvDTE;\nusing EnvDTE80;\n\npublic Workspace GetCurrentWorkspace(DTE2 dte)\n{\n    // Get the current solution/project path\n    string solutionPath = dte.Solution.FullName;\n\n    // Connect to the TFS server\n    TfsTeamProjectCollection tpc = new TfsTeamProjectCollection(new Uri("http://your-tfs-server:8080/tfs/YourCollection"));\n    tpc.EnsureAuthenticated();\n\n    // Get the VersionControlServer\n    VersionControlServer versionControl = tpc.GetService<VersionControlServer>();\n\n    // Get all workspaces\n    Workspace[] workspaces = versionControl.QueryWorkspaces(null, versionControl.AuthorizedUser, Environment.MachineName);\n\n    // Find the workspace that contains the current solution/project\n    foreach (Workspace workspace in workspaces)\n    {\n        if (workspace.IsLocalPathMapped(solutionPath))\n        {\n            return workspace;\n        }\n    }\n\n    return null; // No workspace found for the current solution/project\n}\n\n// Example usage in a Visual Studio add-in or extension\npublic void ExampleUsage()\n{\n    DTE2 dte = (DTE2)ServiceProvider.GetService(typeof(DTE));\n    Workspace currentWorkspace = GetCurrentWorkspace(dte);\n\n    if (currentWorkspace != null)\n    {\n        Console.WriteLine("Current Workspace: " + currentWorkspace.Name);\n    }\n    else\n    {\n        Console.WriteLine("No workspace found for the current solution/project.");\n    }\n}