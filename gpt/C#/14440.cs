using System;\nusing System.DirectoryServices;\n\nclass IISManager\n{\n    public static void DeleteTree(string metabasePath)\n    {\n        // metabasePath is of the form "IIS://<servername>/<path>"\n        // for example "IIS://localhost/W3SVC/1/Root/MyVDir" \n        // or "IIS://localhost/W3SVC/AppPools/MyAppPool"\n        Console.WriteLine("Deleting {0}:", metabasePath);\n\n        try\n        {\n            using (DirectoryEntry tree = new DirectoryEntry(metabasePath))\n            {\n                tree.DeleteTree();\n                Console.WriteLine("Done.");\n            }\n        }\n        catch (DirectoryNotFoundException)\n        {\n            Console.WriteLine("Not found.");\n        }\n        catch (COMException ex)\n        {\n            Console.WriteLine("COM Exception: {0}", ex.Message);\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine("General Exception: {0}", ex.Message);\n        }\n    }\n\n    static void Main(string[] args)\n    {\n        // Example usage:\n        DeleteTree("IIS://localhost/W3SVC/1/Root/MyVDir");\n        DeleteTree("IIS://localhost/W3SVC/AppPools/MyAppPool");\n    }\n}