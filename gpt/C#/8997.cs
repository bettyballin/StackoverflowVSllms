using System;\nusing System.Windows.Forms;\nusing Microsoft.Office.Interop.Outlook;\n\npublic partial class ThisAddIn\n{\n    private void ThisAddIn_Startup(object sender, System.EventArgs e)\n    {\n        Application.ItemSend += new ApplicationEvents_11_ItemSendEventHandler(Application_ItemSend);\n    }\n\n    void Application_ItemSend(object Item, ref bool Cancel)\n    {\n        // Example: Handle item send event\n        MailItem mailItem = Item as MailItem;\n        if (mailItem != null)\n        {\n            MessageBox.Show("Sending email to " + mailItem.To);\n        }\n    }\n\n    private void ThisAddIn_Shutdown(object sender, System.EventArgs e)\n    {\n        // Note: Outlook no longer raises this event. If you have code that \n        //    must run when Outlook shuts down, see https://go.microsoft.com/fwlink/?LinkId=506785\n    }\n\n    #region VSTO generated code\n\n    private void InternalStartup()\n    {\n        this.Startup += new System.EventHandler(ThisAddIn_Startup);\n        this.Shutdown += new System.EventHandler(ThisAddIn_Shutdown);\n    }\n\n    #endregion\n}