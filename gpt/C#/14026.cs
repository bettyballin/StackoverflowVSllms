public class ScriptGeneratorClient\n{\n    private IScriptGenerator m_internalGenerator;\n\n    public ScriptGeneratorClient(string progID)\n    {\n        Type comType = Type.GetTypeFromProgID(progID);\n        if (comType == null)\n        {\n            throw new ArgumentException("The ProgID does not match a registered COM object", nameof(progID));\n        }\n\n        object comObj;\n        try\n        {\n            comObj = Activator.CreateInstance(comType);\n        }\n        catch (Exception ex)\n        {\n            throw new InvalidOperationException("Cannot create the script generator COM object.", ex);\n        }\n\n        m_internalGenerator = comObj as IScriptGenerator;\n        if (m_internalGenerator == null)\n        {\n            throw new InvalidCastException($"The script generator with the ProgID {progID} doesn't support the required interface - IScriptGenerator");\n        }\n    }\n}