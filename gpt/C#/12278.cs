public void ReadFromStream(IRAPIStream stream)\n{\n    const int bufferSize = 4096;\n    byte[] buffer = new byte[bufferSize];\n    uint bytesRead = 0;\n\n    do\n    {\n        int hr = stream.Read(buffer, (uint)buffer.Length, out bytesRead);\n        if (hr != 0)\n        {\n            Marshal.ThrowExceptionForHR(hr);\n        }\n\n        if (bytesRead > 0)\n        {\n            // Process the data read from the stream\n            Console.WriteLine("Read {0} bytes", bytesRead);\n        }\n    } while (bytesRead > 0);\n}