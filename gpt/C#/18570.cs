using System;\nusing MailKit.Net.Imap;\nusing MailKit;\nusing MailKit.Search;\nusing MimeKit;\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        // Gmail IMAP server details\n        string imapServer = "imap.gmail.com";\n        int imapPort = 993;\n        string email = "your-email@gmail.com";\n        string appPassword = "your-app-password"; // Use an App Password if 2FA is enabled\n\n        using (var client = new ImapClient())\n        {\n            try\n            {\n                // Connect to the IMAP server\n                client.Connect(imapServer, imapPort, true);\n\n                // Authenticate\n                client.Authenticate(email, appPassword);\n\n                // Select the inbox folder\n                var inbox = client.Inbox;\n                inbox.Open(FolderAccess.ReadOnly);\n\n                // Search for all unread messages\n                var uids = inbox.Search(SearchQuery.NotSeen);\n\n                Console.WriteLine($"Total Unread Messages: {uids.Count}");\n\n                // Fetch each unread message\n                foreach (var uid in uids)\n                {\n                    var message = inbox.GetMessage(uid);\n                    Console.WriteLine($"Subject: {message.Subject}");\n                    Console.WriteLine($"From: {message.From}");\n                    Console.WriteLine($"Date: {message.Date}");\n                    Console.WriteLine($"Body: {message.TextBody}");\n                    Console.WriteLine("---------------------------");\n                }\n\n                // Disconnect from the IMAP server\n                client.Disconnect(true);\n            }\n            catch (Exception ex)\n            {\n                Console.WriteLine($"An error occurred: {ex.Message}");\n            }\n        }\n    }\n}