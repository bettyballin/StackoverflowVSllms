// Save the uploaded file to a temporary directory on the server\nstring tempFilePath = Server.MapPath("~/TempFiles/") + Path.GetFileName(fileUpload.PostedFile.FileName);\nfileUpload.SaveAs(tempFilePath);\n\n// Update the connection string with the physical path\nstring OleDbConnection = ConfigurationManager.AppSettings["OleDbConnection"]\n                         .Replace("FilePath", tempFilePath)\n                         .Trim();\n\nExcel.Application xlApp = new Excel.Application();\nExcel.Workbooks xlWorkBooks = xlApp.Workbooks;\nExcel.Workbook wb = xlWorkBooks.Open(tempFilePath, Type.Missing, false, Type.Missing, "", "", true, Excel.XlPlatform.xlWindows, "\t", true, false, Type.Missing, true);\n\nstring strSheetName = ((Excel.Worksheet)wb.Sheets[1]).Name.ToString();\nxlWorkBooks.Close();\nxlApp.Quit();\n\nOleDbCommand oledbCommand = new OleDbCommand();\nOleDbDataAdapter oledbAdapter = new OleDbDataAdapter();\n\nDataSet dsExcellData = new DataSet();\nOleDbConnection oledbConnection = new OleDbConnection(OleDbConnection);\noledbConnection.Open();\n\noledbCommand.Connection = oledbConnection;\noledbCommand.CommandText = "Select * from [" + strSheetName + "$]";\n\noledbAdapter.SelectCommand = oledbCommand;\noledbAdapter.Fill(dsExcellData);\n\n// Clean up\noledbConnection.Close();\nFile.Delete(tempFilePath);\n\nreturn dsExcellData;