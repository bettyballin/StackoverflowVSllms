using System;\nusing MailKit.Net.Imap;\nusing MailKit.Search;\nusing MailKit;\nusing MimeKit;\n\npublic class EmailService\n{\n    private readonly string _host = "imap.example.com";\n    private readonly int _port = 993;\n    private readonly string _username = "your-email@example.com";\n    private readonly string _password = "your-password";\n\n    public void CheckInbox()\n    {\n        using (var client = new ImapClient())\n        {\n            // Connect to the IMAP server\n            client.Connect(_host, _port, true);\n\n            // Authenticate\n            client.Authenticate(_username, _password);\n\n            // Select the inbox folder\n            client.Inbox.Open(FolderAccess.ReadOnly);\n\n            // Search for all unseen messages\n            var query = SearchQuery.NotSeen;\n            var uids = client.Inbox.Search(query);\n\n            foreach (var uid in uids)\n            {\n                var message = client.Inbox.GetMessage(uid);\n                Console.WriteLine($"Subject: {message.Subject}");\n                Console.WriteLine($"From: {string.Join(", ", message.From)}");\n                Console.WriteLine($"Date: {message.Date}");\n                Console.WriteLine($"Body: {message.TextBody}");\n\n                // Insert message details into your database here\n            }\n\n            // Disconnect from the IMAP server\n            client.Disconnect(true);\n        }\n    }\n}