using System;\n   using TIBCO.EMS;\n\n   class Program\n   {\n       static void Main(string[] args)\n       {\n           // Connection parameters\n           string serverUrl = "tcp://localhost:7222";\n           string userName = "admin";\n           string password = "admin";\n\n           // Connection factory\n           ConnectionFactory factory = new ConnectionFactory(serverUrl);\n\n           try\n           {\n               // Create connection\n               using (Connection connection = factory.CreateConnection(userName, password))\n               {\n                   // Create session\n                   using (Session session = connection.CreateSession(false, Session.AUTO_ACKNOWLEDGE))\n                   {\n                       // Create destination (queue)\n                       Destination destination = session.CreateQueue("sample.queue");\n\n                       // Create producer\n                       MessageProducer producer = session.CreateProducer(destination);\n\n                       // Create and send message\n                       TextMessage message = session.CreateTextMessage("Hello TIBCO EMS!");\n                       producer.Send(message);\n                       Console.WriteLine("Message sent successfully.");\n\n                       // Create consumer\n                       MessageConsumer consumer = session.CreateConsumer(destination);\n\n                       // Start connection to receive messages\n                       connection.Start();\n\n                       // Receive message\n                       Message receivedMessage = consumer.Receive();\n                       if (receivedMessage is TextMessage receivedTextMessage)\n                       {\n                           Console.WriteLine("Received message: " + receivedTextMessage.Text);\n                       }\n                   }\n               }\n           }\n           catch (EMSException e)\n           {\n               Console.WriteLine("Exception: " + e.Message);\n           }\n       }\n   }