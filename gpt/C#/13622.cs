public void EmbedProcess(string appPath, Panel panel)\n{\n    Process proc = Process.Start(appPath);\n    proc.WaitForInputIdle();\n\n    IntPtr appHandle = proc.MainWindowHandle;\n    SetParent(appHandle, panel.Handle);\n\n    // Remove border and titlebar\n    uint style = GetWindowLong(appHandle, GWL_STYLE);\n    SetWindowLong(appHandle, GWL_STYLE, (style & ~0x00C00000) | WS_VISIBLE);\n\n    MoveWindow(appHandle, 0, 0, panel.Width, panel.Height, true);\n}