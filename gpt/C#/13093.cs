public class ExchangeService\n{\n    public void PerformAdminTask()\n    {\n        // Retrieve credentials securely (e.g., from Azure Key Vault)\n        string domain = "<admin_domain>";\n        string username = "<admin_username>";\n        string password = "<admin_password>";\n\n        ImpersonationHelper.RunImpersonated(domain, username, password, () =>\n        {\n            // Your code that requires impersonation\n            // E.g., access Exchange as an admin\n        });\n    }\n}