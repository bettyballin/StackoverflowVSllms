using System;\nusing System.Data;\nusing System.Windows.Forms;\nusing ClosedXML.Excel;\n\nnamespace WinFormsApp\n{\n    public partial class Form1 : Form\n    {\n        public Form1()\n        {\n            InitializeComponent();\n        }\n\n        private void ExportDataSetToExcel(DataSet dataSet, string filePath)\n        {\n            using (var workbook = new XLWorkbook())\n            {\n                foreach (DataTable table in dataSet.Tables)\n                {\n                    var worksheet = workbook.Worksheets.Add(table.TableName);\n                    worksheet.Cell(1, 1).InsertTable(table);\n                }\n                workbook.SaveAs(filePath);\n            }\n        }\n\n        private void ButtonExport_Click(object sender, EventArgs e)\n        {\n            // Assuming you have a DataSet named dataSet\n            DataSet dataSet = GetDataSet();\n            \n            SaveFileDialog saveFileDialog = new SaveFileDialog\n            {\n                Filter = "Excel Workbook|*.xlsx",\n                Title = "Save an Excel File"\n            };\n            \n            if (saveFileDialog.ShowDialog() == DialogResult.OK)\n            {\n                ExportDataSetToExcel(dataSet, saveFileDialog.FileName);\n                MessageBox.Show("Export successful!");\n            }\n        }\n\n        private DataSet GetDataSet()\n        {\n            // Your logic to populate the DataSet\n            DataSet dataSet = new DataSet();\n            // Add data to your DataSet\n            return dataSet;\n        }\n    }\n}