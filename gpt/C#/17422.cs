using System;\nusing System.Runtime.InteropServices;\nusing Excel = Microsoft.Office.Interop.Excel;\n\nnamespace VSTOExample\n{\n    public class ExcelWindowFocusChecker\n    {\n        [DllImport("user32.dll")]\n        private static extern IntPtr GetForegroundWindow();\n\n        public bool IsExcelWindowActive(Excel.Application excelApp)\n        {\n            IntPtr excelHwnd = new IntPtr(excelApp.Hwnd);\n            IntPtr foregroundWindow = GetForegroundWindow();\n            \n            return excelHwnd == foregroundWindow;\n        }\n    }\n}