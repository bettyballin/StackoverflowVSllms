using System.Data.SqlClient;\nusing System.ComponentModel;\nusing System.Windows.Forms;\n\npublic partial class MainForm : Form\n{\n    private BackgroundWorker backgroundWorker;\n\n    public MainForm()\n    {\n        InitializeComponent();\n        SetupBackgroundWorker();\n    }\n\n    private void SetupBackgroundWorker()\n    {\n        backgroundWorker = new BackgroundWorker();\n        backgroundWorker.DoWork += new DoWorkEventHandler(BackgroundWorker_DoWork);\n        backgroundWorker.RunWorkerCompleted += new RunWorkerCompletedEventHandler(BackgroundWorker_RunWorkerCompleted);\n    }\n\n    private void TreeView_AfterSelect(object sender, TreeViewEventArgs e)\n    {\n        if (e.Node.Tag is Website)\n        {\n            // Load website summary\n            if (!backgroundWorker.IsBusy)\n            {\n                backgroundWorker.RunWorkerAsync(e.Node.Tag);\n            }\n        }\n        else if (e.Node.Tag is Page)\n        {\n            // Load page statistics\n            LoadPageStatistics((Page)e.Node.Tag);\n        }\n    }\n\n    private void BackgroundWorker_DoWork(object sender, DoWorkEventArgs e)\n    {\n        Website website = (Website)e.Argument;\n        // Fetch statistics for the website using a separate connection\n        using (SqlConnection connection = new SqlConnection("your_connection_string"))\n        {\n            connection.Open();\n            using (SqlCommand command = new SqlCommand("SELECT * FROM Statistics WHERE WebsiteID = @WebsiteID", connection))\n            {\n                command.Parameters.AddWithValue("@WebsiteID", website.ID);\n                using (SqlDataReader reader = command.ExecuteReader())\n                {\n                    // Process the data\n                }\n            }\n        }\n    }\n\n    private void BackgroundWorker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)\n    {\n        if (e.Error != null)\n        {\n            MessageBox.Show("Error: " + e.Error.Message);\n        }\n        else\n        {\n            // Update UI with the fetched statistics\n        }\n    }\n\n    private void LoadPageStatistics(Page page)\n    {\n        using (SqlConnection connection = new SqlConnection("your_connection_string"))\n        {\n            connection.Open();\n            using (SqlCommand command = new SqlCommand("SELECT * FROM PageStatistics WHERE PageID = @PageID", connection))\n            {\n                command.Parameters.AddWithValue("@PageID", page.ID);\n                using (SqlDataReader reader = command.ExecuteReader())\n                {\n                    // Process the data\n                }\n            }\n        }\n    }\n}