private static readonly object _lock = new Object();\nprivate static readonly string FormatString = "{0}{1}{2}{3}";\nprivate static readonly string NumberFormat = "000000";\n\npublic static object GetNextNumber(string prefix)\n{\n    lock (_lock)\n    {\n        int yr = DateTime.Now.Year;\n        int month = DateTime.Now.Month;\n\n        using (var transaction = new TransactionScope())\n        {\n            SequenceGeneratorCollection col = new SequenceGeneratorCollection()\n                .Where(SequenceGenerator.Columns.Year, Comparison.Equals, yr)\n                .Where(SequenceGenerator.Columns.Month, Comparison.Equals, month)\n                .Load();\n\n            SequenceGenerator t;\n            if (col == null || col.Count == 0)\n            {\n                t = new SequenceGenerator();\n                t.Year = yr;\n                t.Month = month;\n                t.NextNumber = 1;\n                t.Save();\n            }\n            else\n            {\n                t = col[0];\n                t.NextNumber += 1;\n                t.Save();\n            }\n\n            transaction.Complete();\n\n            return string.Format(FormatString, prefix, yr, month, t.NextNumber.ToString(NumberFormat));\n        }\n    }\n}