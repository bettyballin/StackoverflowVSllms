public IHttpHandler GetHttpHandler(RequestContext requestContext) {\n\n    if (AllowedRoles != null) {\n        bool allowed = false;\n\n        for (int i = 0; i < AllowedRoles.Length; i++) {\n            if (requestContext.HttpContext.User.IsInRole(AllowedRoles[i])) {\n                allowed = true;\n                break;\n            }\n        }\n\n        if (!allowed) {\n            string returnUrl = requestContext.HttpContext.Request.Url.PathAndQuery;\n            string loginUrl = "/Login.aspx?returnUrl=" + HttpUtility.UrlEncode(returnUrl);\n            requestContext.HttpContext.Response.Redirect(loginUrl, true);\n            return null; // Return null to indicate that no handler should process the request further\n        }\n    }\n    \n    // Your existing code to get the appropriate handler\n    // Example:\n    return new PageHandler(); // Replace with your actual handler\n}