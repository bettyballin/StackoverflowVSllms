//using Excel = Microsoft.Office.Interop.Excel;\n//using System.Runtime.InteropServices;\npublic static void AddTest()\n{\n    string filename = @"C:\addtest.xls";\n    object m = Type.Missing;\n    Excel.Application excelapp = null;\n    Excel.Workbooks wbs = null;\n    Excel.Workbook wb = null;\n    Excel.Sheets sheets = null;\n    Excel.Worksheet wsnew = null;\n\n    try\n    {\n        excelapp = new Excel.Application();\n        if (excelapp == null) throw new Exception("Can't start Excel");\n        \n        wbs = excelapp.Workbooks;\n        wb = wbs.Open(filename, m, m, m, m, m, m, Excel.XlPlatform.xlWindows, m, m, m, m, m, m, m);\n        sheets = wb.Worksheets;\n\n        wsnew = sheets.Add(m, m, m, m) as Excel.Worksheet; \n        wb.Save();\n        wb.Close(m, m, m);\n    }\n    finally\n    {\n        if (wsnew != null) Marshal.ReleaseComObject(wsnew);\n        if (sheets != null) Marshal.ReleaseComObject(sheets);\n        if (wb != null) Marshal.ReleaseComObject(wb);\n        if (wbs != null) Marshal.ReleaseComObject(wbs);\n\n        if (excelapp != null)\n        {\n            excelapp.Quit();\n            Marshal.ReleaseComObject(excelapp);\n        }\n\n        GC.Collect();\n        GC.WaitForPendingFinalizers();\n        GC.Collect();\n        GC.WaitForPendingFinalizers();\n    }\n}