using System;\nusing System.Diagnostics;\nusing System.Runtime.InteropServices;\nusing SHDocVw;\n\nclass Program\n{\n    [DllImport("user32.dll", SetLastError = true)]\n    [return: MarshalAs(UnmanagedType.Bool)]\n    static extern bool EnumWindows(EnumWindowsProc lpEnumFunc, IntPtr lParam);\n\n    [DllImport("user32.dll", SetLastError = true)]\n    static extern int GetWindowText(IntPtr hWnd, System.Text.StringBuilder lpString, int nMaxCount);\n\n    [DllImport("user32.dll", SetLastError = true)]\n    static extern bool IsWindowVisible(IntPtr hWnd);\n\n    delegate bool EnumWindowsProc(IntPtr hWnd, IntPtr lParam);\n\n    static void Main()\n    {\n        foreach (SHDocVw.InternetExplorer ie in new ShellWindows())\n        {\n            try\n            {\n                if (ie.LocationURL.Contains("sharepoint.thecompany.net"))\n                {\n                    Console.WriteLine("User is currently viewing: " + ie.LocationURL);\n                }\n            }\n            catch (Exception ex)\n            {\n                Console.WriteLine("Error: " + ex.Message);\n            }\n        }\n    }\n}