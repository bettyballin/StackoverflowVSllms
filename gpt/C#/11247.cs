using System;\nusing System.IO;\nusing System.Security.AccessControl;\nusing System.Security.Principal;\n\npublic class DirectoryHelper\n{\n    public static void CreateSecureDirectory(string path)\n    {\n        // Create the directory\n        DirectoryInfo directoryInfo = Directory.CreateDirectory(path);\n        \n        // Get the current user\n        string currentUser = WindowsIdentity.GetCurrent().Name;\n        \n        // Set the directory access control\n        DirectorySecurity directorySecurity = directoryInfo.GetAccessControl();\n        \n        // Remove existing rules\n        directorySecurity.SetAccessRuleProtection(true, false);\n\n        // Add rule to allow current user full control\n        directorySecurity.AddAccessRule(new FileSystemAccessRule(\n            currentUser,\n            FileSystemRights.FullControl,\n            InheritanceFlags.ContainerInherit | InheritanceFlags.ObjectInherit,\n            PropagationFlags.None,\n            AccessControlType.Allow));\n\n        // Apply new access settings\n        directoryInfo.SetAccessControl(directorySecurity);\n    }\n}