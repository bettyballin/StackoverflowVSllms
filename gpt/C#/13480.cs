using System;\nusing System.Linq;\n\npublic class ForumViewModel\n{\n    public int ForumId { get; set; }\n    public string Title { get; set; }\n    public int TopicCount { get; set; }\n    public int PostCount { get; set; }\n    public Guid? LastPostUserId { get; set; }\n    public DateTime? LastPostTime { get; set; }\n}\n\npublic class YourDbContext : DbContext\n{\n    public DbSet<Forum> Forums { get; set; }\n    public DbSet<ForumThread> ForumThreads { get; set; }\n    public DbSet<ForumPost> ForumPosts { get; set; }\n}\n\npublic List<ForumViewModel> GetForumData()\n{\n    using (var context = new YourDbContext())\n    {\n        var query = from forum in context.Forums\n                    join thread in context.ForumThreads on forum.ForumId equals thread.ForumId into forumThreads\n                    from subThread in forumThreads.DefaultIfEmpty()\n                    join post in context.ForumPosts on subThread.ThreadId equals post.ThreadId into threadPosts\n                    from subPost in threadPosts.DefaultIfEmpty()\n                    group new { forum, subThread, subPost } by new { forum.ForumId, forum.Title } into g\n                    select new ForumViewModel\n                    {\n                        ForumId = g.Key.ForumId,\n                        Title = g.Key.Title,\n                        TopicCount = g.Select(x => x.subThread).Where(x => x != null).Distinct().Count(),\n                        PostCount = g.Select(x => x.subPost).Where(x => x != null).Count(),\n                        LastPostUserId = g.Select(x => x.subPost).Where(x => x != null).OrderByDescending(x => x.CreateDate).Select(x => x.UserId).FirstOrDefault(),\n                        LastPostTime = g.Select(x => x.subPost).Where(x => x != null).OrderByDescending(x => x.CreateDate).Select(x => x.CreateDate).FirstOrDefault()\n                    };\n\n        return query.ToList();\n    }\n}