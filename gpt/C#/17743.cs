using System;\nusing System.Data;\nusing System.Data.SqlClient;\n\npublic class Program\n{\n    public static void Main()\n    {\n        string connectionString = "your-connection-string";\n        string selectCommandText = "SELECT * FROM YourTable";\n\n        using (SqlConnection connection = new SqlConnection(connectionString))\n        {\n            SqlDataAdapter dataAdapter = new SqlDataAdapter(selectCommandText, connection);\n            SqlCommandBuilder commandBuilder = new SqlCommandBuilder(dataAdapter);\n\n            // Modify the InsertCommand to include an output parameter for @@IDENTITY\n            dataAdapter.InsertCommand = commandBuilder.GetInsertCommand();\n            dataAdapter.InsertCommand.CommandText += "; SET @NewID = SCOPE_IDENTITY();";\n            dataAdapter.InsertCommand.Parameters.Add(new SqlParameter("@NewID", SqlDbType.Int, 0, ParameterDirection.Output, false, 0, 0, "ID", DataRowVersion.Default, null));\n\n            dataAdapter.RowUpdated += new SqlRowUpdatedEventHandler(OnRowUpdated);\n\n            DataTable dataTable = new DataTable();\n            dataAdapter.Fill(dataTable);\n\n            // Add a new row to the DataTable\n            DataRow newRow = dataTable.NewRow();\n            newRow["ColumnName1"] = "Value1";\n            newRow["ColumnName2"] = "Value2";\n            dataTable.Rows.Add(newRow);\n\n            // Update the database\n            dataAdapter.Update(dataTable);\n        }\n    }\n\n    private static void OnRowUpdated(object sender, SqlRowUpdatedEventArgs e)\n    {\n        if (e.StatementType == StatementType.Insert)\n        {\n            // Retrieve the @@IDENTITY value\n            int newID = (int)e.Command.Parameters["@NewID"].Value;\n            Console.WriteLine("New ID: " + newID);\n        }\n    }\n}