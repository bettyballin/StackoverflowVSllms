using System;\nusing System.Data;\nusing System.Data.SqlClient;\nusing FarPoint.Win.Spread;\n\npublic void LoadDataIntoSpread(FpSpread spread, string connectionString, string query)\n{\n    using (SqlConnection connection = new SqlConnection(connectionString))\n    {\n        SqlCommand command = new SqlCommand(query, connection);\n        connection.Open();\n        using (SqlDataReader reader = command.ExecuteReader())\n        {\n            DataTable dataTable = new DataTable();\n            dataTable.Load(reader);\n\n            spread.Sheets[0].DataSource = dataTable;\n        }\n    }\n}