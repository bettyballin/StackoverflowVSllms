Rfc2898DeriveBytes pdb = new Rfc2898DeriveBytes(GetPassPhrase(), salt, 1000);\nRijndaelManaged rijndael = new RijndaelManaged();\nrijndael.BlockSize = 128;\nrijndael.KeySize = 256;\nrijndael.Mode = CipherMode.CBC;\nrijndael.Padding = PaddingMode.PKCS7;  // Ensure PaddingMode is set to PKCS7\n\nrijndael.Key = pdb.GetBytes(rijndael.KeySize / 8);\nrijndael.IV = GetIV(iv);\n\nICryptoTransform encryptor = rijndael.CreateEncryptor();\nusing (MemoryStream msEncrypt = new MemoryStream())\nusing (CryptoStream csEncrypt = new CryptoStream(msEncrypt, encryptor, CryptoStreamMode.Write))\n{\n    byte[] toBeEncrypted = UnicodeEncoding.Unicode.GetBytes(value);\n    csEncrypt.Write(toBeEncrypted, 0, toBeEncrypted.Length);\n    csEncrypt.FlushFinalBlock();\n    byte[] encryptedBytes = msEncrypt.ToArray();\n}