private void TargetIP_KeyDown(object sender, KeyEventArgs e)\n{\n    // Initialize the flag to false.\n    nonNumberEntered = false;\n\n    // Determine whether the keystroke is a number from the top of the keyboard.\n    if ((e.KeyCode < Keys.D0 || e.KeyCode > Keys.D9) &&\n        (e.KeyCode < Keys.NumPad0 || e.KeyCode > Keys.NumPad9) &&\n        e.KeyCode != Keys.Back && \n        e.KeyCode != Keys.OemPeriod)\n    {\n        nonNumberEntered = true;\n        errorProvider1.SetError(TargetIP, "Only numbers and periods are allowed.");\n    }\n\n    // If shift key was pressed, it's not a number.\n    if (Control.ModifierKeys == Keys.Shift)\n    {\n        nonNumberEntered = true;\n    }\n}\n\nprivate void TargetIP_KeyPress(object sender, KeyPressEventArgs e)\n{\n    // Check for the flag being set in the KeyDown event.\n    if (nonNumberEntered)\n    {\n        // Stop the character from being entered into the control since it is non-numerical.\n        e.Handled = true;\n    }\n    else\n    {\n        errorProvider1.Clear();\n    }\n}