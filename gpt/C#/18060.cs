var result = (from a in accounts\n              join d in details on a.Code equals d.Code\n              join e in acEntries on d.EID equals e.EID\n              where e.EDate > new DateTime(2000, 1, 1)\n              group new { a, d, e } by d.Code into grouped\n              select new\n              {\n                  Code = grouped.Key,\n                  TotalAmount = grouped.Sum(x => x.a.Amount)\n              }).ToList();