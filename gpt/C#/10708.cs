using System;\nusing System.Management;\n\npublic class Program\n{\n    public static string GetLoggedInUserName(string machineName)\n    {\n        try\n        {\n            // Connect to the remote machine\n            ConnectionOptions options = new ConnectionOptions();\n            options.Impersonation = ImpersonationLevel.Impersonate;\n\n            ManagementScope scope = new ManagementScope("\\\\" + machineName + "\\root\\cimv2", options);\n            scope.Connect();\n\n            // Query the Win32_ComputerSystem for the logged-in user\n            ObjectQuery query = new ObjectQuery("SELECT UserName FROM Win32_ComputerSystem");\n            ManagementObjectSearcher searcher = new ManagementObjectSearcher(scope, query);\n\n            foreach (ManagementObject queryObj in searcher.Get())\n            {\n                return queryObj["UserName"].ToString();\n            }\n        }\n        catch (Exception e)\n        {\n            Console.WriteLine("An error occurred: " + e.Message);\n        }\n\n        return null;\n    }\n\n    public static void Main()\n    {\n        string machineName = "RemoteMachineName";\n        string userName = GetLoggedInUserName(machineName);\n\n        if (userName != null)\n        {\n            Console.WriteLine("Logged in user: " + userName);\n        }\n        else\n        {\n            Console.WriteLine("Unable to retrieve logged-in user.");\n        }\n    }\n}