public class SalesLog\n{\n    public DateTime OrderTime { get; set; }\n    public Dictionary<string, decimal> LocationCharges { get; set; }\n}\n\npublic List<SalesLog> GetStatsDay(string columns)\n{\n    using (var context = new YourDataContext())\n    {\n        string sql = @"\n            DECLARE @SQL_PVT1 NVARCHAR(512), @SQL_PVT2 NVARCHAR(512), @SQL_FULL NVARCHAR(4000);\n            SET @SQL_PVT1 =  'SELECT OrderTime, ' + LEFT(@columns, LEN(@columns) - 1) + '\n            FROM (SELECT ES.Location, CONVERT(varchar(10), ES.OrderTime, 120), ES.Charge\n                  FROM dbo.log_sales ES\n                 ) AS D (Location, OrderTime, Charge)\n                 PIVOT (SUM(D.Charge) FOR D.Location IN ('; \n            SET @SQL_PVT2 = ') ) AS PVT\n            ORDER BY OrderTime DESC';\n            SET @SQL_FULL = @SQL_PVT1 + LEFT(@columns, LEN(@columns) - 1) + @SQL_PVT2;\n            EXEC sp_executesql @SQL_FULL, N'@columns NVARCHAR(64)', @columns = @columns";\n        \n        var result = context.ExecuteQuery<SalesLog>(sql, new SqlParameter("@columns", columns)).ToList();\n        \n        return result;\n    }\n}