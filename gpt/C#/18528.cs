public class AuthenticationHandler : ICallHandler\n   {\n       public IMethodReturn Invoke(IMethodInvocation input, GetNextHandlerDelegate getNext)\n       {\n           if (!Thread.CurrentPrincipal.Identity.IsAuthenticated)\n           {\n               return input.CreateExceptionMethodReturn(new UnauthorizedAccessException("User is not authenticated"));\n           }\n\n           return getNext()(input, getNext);\n       }\n\n       public int Order { get; set; }\n   }