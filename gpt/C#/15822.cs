using System;\nusing System.IO;\nusing System.Threading;\n\npublic class FileAccessHelper\n{\n    public static bool WaitForFile(string filePath, int timeoutMilliseconds)\n    {\n        DateTime endTime = DateTime.Now.AddMilliseconds(timeoutMilliseconds);\n        \n        while (DateTime.Now < endTime)\n        {\n            try\n            {\n                // Attempt to open the file in read mode\n                using (FileStream fs = File.Open(filePath, FileMode.Open, FileAccess.Read, FileShare.None))\n                {\n                    // If we can open and close the file, it is not locked\n                    return true;\n                }\n            }\n            catch (IOException)\n            {\n                // If the file is still locked, wait a bit and try again\n                Thread.Sleep(100); // Wait for 100 milliseconds before retrying\n            }\n        }\n        \n        // Timeout expired and file is still locked\n        return false;\n    }\n}