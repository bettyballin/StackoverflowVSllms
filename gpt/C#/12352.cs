public class CustomMessageInspector : IClientMessageInspector\n{\n    public void AfterReceiveReply(ref Message reply, object correlationState)\n    {\n        // Buffer the message.\n        var buffer = reply.CreateBufferedCopy(Int32.MaxValue);\n        var copy = buffer.CreateMessage();\n\n        // Read the message as a string to inspect it.\n        var reader = copy.GetReaderAtBodyContents();\n        var responseXml = reader.ReadOuterXml();\n\n        // Create a new message from the buffer to replace the original message.\n        reply = buffer.CreateMessage();\n\n        // Check which type of response it is and set a custom header.\n        if (responseXml.Contains("<ActualResponse>"))\n        {\n            reply.Headers.Add(MessageHeader.CreateHeader("ResponseType", string.Empty, "ActualResponse"));\n        }\n        else if (responseXml.Contains("<ErrorResponse>"))\n        {\n            reply.Headers.Add(MessageHeader.CreateHeader("ResponseType", string.Empty, "ErrorResponse"));\n        }\n    }\n\n    public object BeforeSendRequest(ref Message request, IClientChannel channel)\n    {\n        return null;\n    }\n}