using System.Net;\nusing System.Web;\nusing System.Web.Mvc;\n\npublic class CustomAuthorizeAttribute : AuthorizeAttribute\n{\n    protected override void HandleUnauthorizedRequest(AuthorizationContext filterContext)\n    {\n        if (filterContext.HttpContext.Request.IsAjaxRequest())\n        {\n            filterContext.Result = new JsonResult\n            {\n                JsonRequestBehavior = JsonRequestBehavior.AllowGet,\n                Data = new { Error = "Unauthorized", LogOnUrl = "/Account/LogOn" }\n            };\n\n            filterContext.HttpContext.Response.StatusCode = (int)HttpStatusCode.Unauthorized;\n            filterContext.HttpContext.Response.SuppressFormsAuthenticationRedirect = true; // Prevent redirection\n        }\n        else\n        {\n            base.HandleUnauthorizedRequest(filterContext);\n        }\n    }\n}