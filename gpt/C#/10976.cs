public partial class ImageHandler : IHttpHandler\n{\n    public void ProcessRequest(HttpContext context)\n    {\n        int userId = int.Parse(context.Request.QueryString["userId"]);\n\n        string connectionString = "your_connection_string_here";\n        byte[] imageBytes;\n\n        using (SqlConnection conn = new SqlConnection(connectionString))\n        {\n            using (SqlCommand cmd = new SqlCommand("usp_GetProfilePicture", conn))\n            {\n                cmd.CommandType = CommandType.StoredProcedure;\n                cmd.Parameters.AddWithValue("@UserId", userId);\n\n                conn.Open();\n                imageBytes = (byte[])cmd.ExecuteScalar();\n                conn.Close();\n            }\n        }\n\n        if (imageBytes != null)\n        {\n            context.Response.ContentType = "image/jpeg"; // Set the correct content type\n            context.Response.BinaryWrite(imageBytes);\n        }\n    }\n\n    public bool IsReusable\n    {\n        get { return false; }\n    }\n}