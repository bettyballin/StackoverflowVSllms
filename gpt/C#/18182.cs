using System;\nusing System.Management;\n\nclass Program\n{\n    static void Main()\n    {\n        string serviceName = "YourServiceName";\n        string startupType = "Automatic"; // Options: "Automatic", "Manual", "Disabled"\n\n        try\n        {\n            ManagementPath path = new ManagementPath($"Win32_Service.Name='{serviceName}'");\n            using (ManagementObject service = new ManagementObject(path))\n            {\n                ManagementBaseObject inputArgs = service.GetMethodParameters("ChangeStartMode");\n                inputArgs["StartMode"] = startupType;\n                ManagementBaseObject outputArgs = service.InvokeMethod("ChangeStartMode", inputArgs, null);\n\n                uint returnValue = (uint)outputArgs["ReturnValue"];\n                if (returnValue == 0)\n                {\n                    Console.WriteLine("Service startup type changed successfully.");\n                }\n                else\n                {\n                    Console.WriteLine($"Failed to change service startup type. Error code: {returnValue}");\n                }\n            }\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine($"Exception: {ex.Message}");\n        }\n    }\n}