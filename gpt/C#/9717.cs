using System;\nusing ESRI.ArcGIS.Carto;\n\npublic class LayerVisibilityEventHandler : IDisposable\n{\n    private ILayerEvents_Event _layerEvents;\n    private ILayer _layer;\n    private bool _disposed = false;\n\n    public LayerVisibilityEventHandler(ILayer layer)\n    {\n        _layer = layer;\n        _layerEvents = (ILayerEvents_Event)_layer;\n        _layerEvents.VisibilityChanged += OnVisibilityChanged;\n    }\n\n    private void OnVisibilityChanged(bool isVisible)\n    {\n        // Your logic here\n    }\n\n    public void Dispose()\n    {\n        if (!_disposed)\n        {\n            if (_layerEvents != null)\n            {\n                _layerEvents.VisibilityChanged -= OnVisibilityChanged;\n            }\n            _disposed = true;\n        }\n    }\n}