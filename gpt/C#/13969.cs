using System;\nusing System.IO;\nusing System.Reflection;\nusing System.Runtime.InteropServices;\n\nnamespace YourNamespace\n{\n    public static class DllLoader\n    {\n        // Import necessary functions from kernel32.dll\n        [DllImport("kernel32", SetLastError = true, CharSet = CharSet.Auto)]\n        private static extern IntPtr LoadLibrary(string lpFileName);\n\n        [DllImport("kernel32", SetLastError = true)]\n        private static extern IntPtr GetProcAddress(IntPtr hModule, string procName);\n\n        [DllImport("kernel32.dll", SetLastError = true)]\n        [return: MarshalAs(UnmanagedType.Bool)]\n        private static extern bool FreeLibrary(IntPtr hModule);\n\n        public static void LoadEmbeddedDll(string resourceName, string outputPath)\n        {\n            var assembly = Assembly.GetExecutingAssembly();\n            using (Stream stream = assembly.GetManifestResourceStream(resourceName))\n            {\n                if (stream == null)\n                    throw new DllNotFoundException($"{resourceName} not found in embedded resources.");\n\n                byte[] buffer = new byte[stream.Length];\n                stream.Read(buffer, 0, buffer.Length);\n\n                string tempFile = Path.Combine(outputPath, "Skype4COM.dll");\n                File.WriteAllBytes(tempFile, buffer);\n\n                IntPtr hModule = LoadLibrary(tempFile);\n                if (hModule == IntPtr.Zero)\n                {\n                    throw new Exception($"Failed to load {tempFile}");\n                }\n            }\n        }\n    }\n}