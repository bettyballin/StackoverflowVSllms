using System;\nusing System.Text;\nusing System.Windows.Forms;\nusing RawInput_dll;\n\nnamespace POS_System\n{\n    public partial class MainForm : Form\n    {\n        private readonly RawInput _rawInput;\n\n        public MainForm()\n        {\n            InitializeComponent();\n\n            _rawInput = new RawInput(Handle, true);\n            _rawInput.KeyPressed += OnKeyPressed;\n        }\n\n        private void OnKeyPressed(object sender, RawInputEventArg e)\n        {\n            StringBuilder inputBuffer = new StringBuilder();\n            foreach (var key in e.KeyPressEvent.KeyPressState)\n            {\n                inputBuffer.Append(key.ToString());\n            }\n\n            string input = inputBuffer.ToString();\n\n            // Detect card swipe sentinel characters, for example, '%' and '?'\n            if (input.Contains("%") && input.Contains("?"))\n            {\n                string cardData = ExtractCardData(input);\n                ProcessCardData(cardData);\n            }\n        }\n\n        private string ExtractCardData(string input)\n        {\n            int startIdx = input.IndexOf('%');\n            int endIdx = input.IndexOf('?');\n            if (startIdx >= 0 && endIdx > startIdx)\n            {\n                return input.Substring(startIdx, endIdx - startIdx + 1);\n            }\n            return string.Empty;\n        }\n\n        private void ProcessCardData(string cardData)\n        {\n            // Process the card data as needed\n            Console.WriteLine($"Card Data: {cardData}");\n        }\n\n        protected override void WndProc(ref Message m)\n        {\n            _rawInput.ProcessRawInput(m);\n            base.WndProc(ref m);\n        }\n    }\n}