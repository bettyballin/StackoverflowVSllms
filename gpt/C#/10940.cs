using System;\nusing System.Drawing;\nusing System.IO;\nusing System.Net;\nusing System.Text;\n\npublic class JpegStreamer\n{\n    private HttpListener listener;\n\n    public HttpListenerResponse StartListening(string where)\n    {\n        listener = new HttpListener();\n        listener.Prefixes.Add(where);\n        listener.Start();\n        Console.WriteLine("Listening on " + where);\n        HttpListenerContext context = listener.GetContext();\n        HttpListenerRequest request = context.Request;\n        return context.Response;\n    }\n\n    public void StartStream()\n    {\n        HttpListenerResponse response = StartListening("http://localhost:8080/");\n        response.ContentType = "multipart/x-mixed-replace; boundary=--testboundary";\n\n        using (Stream outputStream = response.OutputStream)\n        {\n            while (true)\n            {\n                Bitmap b = GenerateBitmap();\n                byte[] buffer = BitmapToArray(b);\n\n                string header = "\r\n--testboundary\r\nContent-Type: image/jpeg\r\nContent-Length: " + buffer.Length + "\r\n\r\n";\n                byte[] headerBytes = Encoding.ASCII.GetBytes(header);\n\n                outputStream.Write(headerBytes, 0, headerBytes.Length);\n                outputStream.Write(buffer, 0, buffer.Length);\n                outputStream.Flush();\n\n                // Add a delay to simulate a frame rate\n                System.Threading.Thread.Sleep(100); // Adjust as needed\n            }\n        }\n    }\n\n    private Bitmap GenerateBitmap()\n    {\n        // Implement this method to generate or capture your Bitmap\n        // For example:\n        Bitmap bitmap = new Bitmap(640, 480);\n        using (Graphics g = Graphics.FromImage(bitmap))\n        {\n            g.Clear(Color.Black);\n            g.DrawString(DateTime.Now.ToString(), new Font("Arial", 24), Brushes.White, new PointF(10, 10));\n        }\n        return bitmap;\n    }\n\n    private byte[] BitmapToArray(Bitmap bitmap)\n    {\n        using (MemoryStream ms = new MemoryStream())\n        {\n            bitmap.Save(ms, System.Drawing.Imaging.ImageFormat.Jpeg);\n            return ms.ToArray();\n        }\n    }\n\n    public void StopListening()\n    {\n        listener.Stop();\n        listener.Close();\n    }\n}