using System;\nusing System.Web;\n\npublic class AuthModule : IHttpModule\n{\n    public void Init(HttpApplication context)\n    {\n        context.BeginRequest += new EventHandler(OnBeginRequest);\n    }\n\n    private void OnBeginRequest(object sender, EventArgs e)\n    {\n        HttpApplication application = (HttpApplication)sender;\n        HttpContext context = application.Context;\n\n        string path = context.Request.Path.ToLower();\n        \n        // Check if the request is for site1 and handle authentication\n        if (path.StartsWith("/site1"))\n        {\n            if (context.Application["username"] == null)\n            {\n                context.Response.Redirect("/site1/login.aspx");\n            }\n        }\n        // Optionally, add more conditions for other sites\n    }\n\n    public void Dispose() { }\n}