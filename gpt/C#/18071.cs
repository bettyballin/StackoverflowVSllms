using System;\nusing System.ServiceModel;\n\npublic class CustomServiceAuthorizationManager : ServiceAuthorizationManager\n{\n    protected override bool CheckAccessCore(OperationContext operationContext)\n    {\n        var windowsIdentity = WindowsIdentity.GetCurrent(); // or use another way to get WindowsIdentity\n\n        var policy = new CustomAuthorizationPolicy(windowsIdentity);\n        operationContext.ServiceSecurityContext.AuthorizationContext.Policies.Add(policy);\n\n        return base.CheckAccessCore(operationContext);\n    }\n}