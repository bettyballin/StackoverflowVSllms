private void Window_SizeChanged(object sender, SizeChangedEventArgs e)\n{\n    double totalWidth = MainGrid.ActualWidth;\n    double col0Width = MainGrid.ColumnDefinitions[0].ActualWidth;\n    double col2Width = MainGrid.ColumnDefinitions[2].ActualWidth;\n\n    if (col0Width + col2Width > totalWidth - 2) // 2 is the GridSplitter width\n    {\n        double excess = (col0Width + col2Width) - (totalWidth - 2);\n        MainGrid.ColumnDefinitions[0].Width = new GridLength(col0Width - excess / 2, GridUnitType.Pixel);\n        MainGrid.ColumnDefinitions[2].Width = new GridLength(col2Width - excess / 2, GridUnitType.Pixel);\n    }\n}