private void CheckIfApp(DirectoryEntry de)\n{\n    if(de.SchemaClassName.Equals("IIsWebDirectory") || de.SchemaClassName.Equals("IIsWebVirtualDir"))\n    {\n        if (de.Properties["AppIsolated"].Value != null)\n        {\n            int appIsolation = (int)de.Properties["AppIsolated"].Value;\n            \n            if (appIsolation != 0)\n            {\n                // This is an application\n                // You can further check the AppFriendlyName if needed\n                if (de.Properties["AppFriendlyName"].Value != null)\n                {\n                    string friendlyName = de.Properties["AppFriendlyName"].Value.ToString();\n                    \n                    if (!friendlyName.Equals("Default Application"))\n                    {\n                        // Perform actions for the application\n                    }\n                }\n            }\n        }\n    }\n}