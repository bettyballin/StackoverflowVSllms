using Microsoft.SharePoint.Client;\nusing System;\n\npublic class SharePointWebhook\n{\n    private static string siteUrl = "https://yourtenant.sharepoint.com/sites/yoursite";\n    private static string listName = "YourList";\n    private static string webhookUrl = "https://yourfunctionapp.azurewebsites.net/api/yourFunction";\n\n    public static void RegisterWebhook()\n    {\n        using (ClientContext clientContext = new ClientContext(siteUrl))\n        {\n            // Authenticate and get the list\n            List list = clientContext.Web.Lists.GetByTitle(listName);\n\n            // Create the webhook\n            var webhook = new SubscriptionCreationInformation\n            {\n                NotificationUrl = webhookUrl,\n                ExpirationDateTime = DateTime.UtcNow.AddMonths(3),\n                ClientState = "secretClientState"\n            };\n\n            var subscription = list.AddSubscription(webhook);\n            clientContext.ExecuteQuery();\n\n            Console.WriteLine("Webhook registered with ID: " + subscription.Id);\n        }\n    }\n}