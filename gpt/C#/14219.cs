using System;\nusing System.Data;\nusing System.Data.OleDb;\n\nnamespace LCR_ShepherdStaffupdater_1._0\n{\n    public class DatabaseHandling\n    {\n        static DataTable datatableB = new DataTable();\n        static DataTable datatableA = new DataTable();\n        public static DataSet datasetA = new DataSet();\n        public static DataSet datasetB = new DataSet();\n        static OleDbDataAdapter adapterA = new OleDbDataAdapter();\n        static OleDbDataAdapter adapterB = new OleDbDataAdapter();\n        static string connectionstringA = "Provider=Microsoft.Jet.OLEDB.4.0;" + "Data Source=" + Settings.getfilelocationA();\n        static string connectionstringB = "Provider=Microsoft.Jet.OLEDB.4.0;" + "Data Source=" + Settings.getfilelocationB();\n        static OleDbConnection dataconnectionB = new OleDbConnection(connectionstringB);\n        static OleDbConnection dataconnectionA = new OleDbConnection(connectionstringA);\n        static DataTable tableListA;\n        static DataTable tableListB;\n\n        static public void addTableA(string table, bool addtoDataSet)\n        {\n            dataconnectionA.Open();\n            datatableA = new DataTable(table);\n\n            try\n            {\n                OleDbCommand commandselectA = new OleDbCommand("SELECT * FROM [" + table + "]", dataconnectionA);\n                adapterA.SelectCommand = commandselectA;\n                adapterA.Fill(datatableA);\n\n                // Check if the table has a primary key\n                if (datatableA.PrimaryKey.Length == 0)\n                {\n                    // Add a primary key column if it doesn't exist\n                    DataColumn[] keyColumns = new DataColumn[1];\n                    DataColumn keyColumn = datatableA.Columns.Add("ID", typeof(int));\n                    keyColumn.AutoIncrement = true;\n                    keyColumn.AutoIncrementSeed = 1;\n                    keyColumn.AutoIncrementStep = 1;\n                    keyColumns[0] = keyColumn;\n                    datatableA.PrimaryKey = keyColumns;\n                }\n\n                if (addtoDataSet)\n                {\n                    datasetA.Tables.Add(datatableA);\n                }\n            }\n            catch (Exception ex)\n            {\n                Logging.updateLog("Error: Tried to get " + table + " from DataSetA. Table doesn't exist! Exception: " + ex.Message, true, false, false);\n            }\n            finally\n            {\n                dataconnectionA.Close();\n            }\n        }\n    }\n}