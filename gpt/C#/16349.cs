using System.IO;\nusing iTextSharp.text;\nusing iTextSharp.text.pdf;\n\npublic void ProtectPdf(string inputFile, string outputFile, string userPassword, string ownerPassword)\n{\n    using (Stream input = new FileStream(inputFile, FileMode.Open, FileAccess.Read, FileShare.Read))\n    using (Stream output = new FileStream(outputFile, FileMode.Create, FileAccess.Write, FileShare.None))\n    {\n        PdfReader reader = new PdfReader(input);\n        PdfEncryptor.Encrypt(reader, output, true, userPassword, ownerPassword, PdfWriter.ALLOW_PRINTING);\n    }\n}