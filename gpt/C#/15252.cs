public void ConfigureServices(IServiceCollection services)\n{\n    services.AddControllersWithViews();\n\n    services.AddScoped<HttpServerUtilityBase>(provider =>\n    {\n        var httpContextAccessor = provider.GetService<IHttpContextAccessor>();\n        return new HttpServerUtilityWrapper(httpContextAccessor.HttpContext.Server);\n    });\n\n    services.AddScoped<IMyService, MyService>();\n}