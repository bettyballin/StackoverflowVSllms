protected void Application_PostAcquireRequestState(object sender, EventArgs e)\n{\n    // Check if the Session is available\n    if (Context.Handler is IRequiresSessionState || Context.Handler is IReadOnlySessionState)\n    {\n        if (HttpContext.Current.Session != null)\n        {\n            // Your code to set the custom security principal\n            var customPrincipal = new CustomPrincipal(HttpContext.Current.User.Identity);\n            HttpContext.Current.User = Thread.CurrentPrincipal = customPrincipal;\n        }\n    }\n}