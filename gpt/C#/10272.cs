using System;\nusing System.Security.Cryptography.X509Certificates;\n\nclass Program\n{\n    static void Main()\n    {\n        X509Store store = new X509Store(StoreName.Root, StoreLocation.LocalMachine);\n        store.Open(OpenFlags.ReadOnly);\n        X509Certificate2Collection col = store.Certificates.Find(X509FindType.FindBySerialNumber, "xxx", false);\n\n        if (col.Count > 0)\n        {\n            X509Certificate2 cert = col[0];\n            bool isRevoked = false;\n\n            X509Chain chain = new X509Chain();\n            chain.ChainPolicy.RevocationMode = X509RevocationMode.Online;\n            chain.Build(cert);\n\n            foreach (X509ChainElement element in chain.ChainElements)\n            {\n                if (element.ChainElementStatus.Length > 0)\n                {\n                    foreach (X509ChainStatus status in element.ChainElementStatus)\n                    {\n                        if (status.Status == X509ChainStatusFlags.Revoked)\n                        {\n                            isRevoked = true;\n                            break;\n                        }\n                    }\n                }\n            }\n\n            if (isRevoked)\n            {\n                Console.WriteLine("The certificate is revoked.");\n            }\n            else if (chain.Build(cert))\n            {\n                Console.WriteLine("The certificate is valid.");\n            }\n            else\n            {\n                Console.WriteLine("The certificate is invalid.");\n            }\n        }\n        else\n        {\n            Console.WriteLine("The certificate was not found.");\n        }\n\n        store.Close();\n    }\n}