using System;\nusing System.Runtime.InteropServices;\nusing System.Runtime.InteropServices.ComTypes;\n\npublic class ComObjectCreator\n{\n    [DllImport("ole32.dll")]\n    private static extern int CoCreateInstanceEx(\n        ref Guid clsid,\n        IntPtr punkOuter,\n        uint dwClsCtx,\n        ref COSERVERINFO pServerInfo,\n        uint dwCount,\n        [In, Out] MULTI_QI[] pResults);\n\n    [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]\n    private struct COSERVERINFO\n    {\n        public uint dwReserved1;\n        public string pwszName;\n        public IntPtr pAuthInfo;\n        public uint dwReserved2;\n    }\n\n    [StructLayout(LayoutKind.Sequential)]\n    private struct MULTI_QI\n    {\n        public IntPtr pIID;\n        public IntPtr pItf;\n        public int hr;\n    }\n\n    public static object CreateRemoteComObject(Guid clsid, string serverName, Guid interfaceId)\n    {\n        COSERVERINFO serverInfo = new COSERVERINFO\n        {\n            pwszName = serverName,\n            dwReserved1 = 0,\n            pAuthInfo = IntPtr.Zero,\n            dwReserved2 = 0\n        };\n\n        MULTI_QI[] qis = new MULTI_QI[1];\n        qis[0].pIID = Marshal.AllocCoTaskMem(Marshal.SizeOf(interfaceId));\n        Marshal.StructureToPtr(interfaceId, qis[0].pIID, false);\n        qis[0].pItf = IntPtr.Zero;\n        qis[0].hr = 0;\n\n        int hResult = CoCreateInstanceEx(\n            ref clsid,\n            IntPtr.Zero,\n            (uint)CLSCTX.CLSCTX_REMOTE_SERVER,\n            ref serverInfo,\n            (uint)qis.Length,\n            qis);\n\n        if (hResult != 0)\n        {\n            Marshal.ThrowExceptionForHR(hResult);\n        }\n\n        object comObject = Marshal.GetObjectForIUnknown(qis[0].pItf);\n\n        Marshal.Release(qis[0].pItf);\n        Marshal.FreeCoTaskMem(qis[0].pIID);\n\n        return comObject;\n    }\n\n    [Flags]\n    private enum CLSCTX : uint\n    {\n        CLSCTX_INPROC_SERVER = 0x1,\n        CLSCTX_INPROC_HANDLER = 0x2,\n        CLSCTX_LOCAL_SERVER = 0x4,\n        CLSCTX_REMOTE_SERVER = 0x10,\n        CLSCTX_SERVER = CLSCTX_INPROC_SERVER | CLSCTX_LOCAL_SERVER | CLSCTX_REMOTE_SERVER,\n        CLSCTX_ALL = CLSCTX_INPROC_SERVER | CLSCTX_INPROC_HANDLER | CLSCTX_LOCAL_SERVER | CLSCTX_REMOTE_SERVER\n    }\n}