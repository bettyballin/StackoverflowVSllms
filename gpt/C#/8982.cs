using System;\nusing System.Windows.Forms;\n\npublic class FileFolderDialog\n{\n    [STAThread]\n    public static void Main()\n    {\n        Application.EnableVisualStyles();\n        Application.SetCompatibleTextRenderingDefault(false);\n        Application.Run(new MainForm());\n    }\n}\n\npublic class MainForm : Form\n{\n    private Button selectButton;\n\n    public MainForm()\n    {\n        selectButton = new Button() { Text = "Select File or Folder", Dock = DockStyle.Fill };\n        selectButton.Click += SelectButton_Click;\n        Controls.Add(selectButton);\n    }\n\n    private void SelectButton_Click(object sender, EventArgs e)\n    {\n        using (OpenFileDialog ofd = new OpenFileDialog())\n        {\n            ofd.ValidateNames = false;\n            ofd.CheckFileExists = false;\n            ofd.CheckPathExists = true;\n            ofd.FileName = "Folder Selection";\n\n            if (ofd.ShowDialog() == DialogResult.OK)\n            {\n                string path = ofd.FileName;\n\n                if (System.IO.Directory.Exists(path))\n                {\n                    MessageBox.Show("Folder selected: " + path);\n                }\n                else if (System.IO.File.Exists(path))\n                {\n                    MessageBox.Show("File selected: " + path);\n                }\n                else\n                {\n                    MessageBox.Show("Invalid selection");\n                }\n            }\n        }\n    }\n}