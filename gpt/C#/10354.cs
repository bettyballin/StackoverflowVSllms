using System;\nusing System.Collections.Generic;\nusing Excel = Microsoft.Office.Interop.Excel;\n\npublic class ExcelExporter\n{\n    public static void ExportToExcel(List<List<object>> data)\n    {\n        if (data == null || data.Count == 0)\n            throw new ArgumentException("The data list is empty or null");\n\n        Excel.Application excelApp = new Excel.Application();\n        Excel.Workbooks workbooks = excelApp.Workbooks;\n        Excel._Workbook workbook = workbooks.Add(Excel.XlWBATemplate.xlWBATWorksheet);\n        Excel._Worksheet worksheet = (Excel._Worksheet)workbook.ActiveSheet;\n\n        int rows = data.Count;\n        int cols = 0;\n\n        // Determine the maximum number of columns\n        foreach (var row in data)\n        {\n            if (row.Count > cols)\n                cols = row.Count;\n        }\n\n        // Create a 2D array to hold the data\n        object[,] dataArray = new object[rows, cols];\n\n        // Fill the 2D array with data from the list of lists\n        for (int i = 0; i < rows; i++)\n        {\n            for (int j = 0; j < data[i].Count; j++)\n            {\n                dataArray[i, j] = data[i][j];\n            }\n        }\n\n        // Define the range\n        Excel.Range startCell = worksheet.Cells[1, 1];\n        Excel.Range endCell = worksheet.Cells[rows, cols];\n        Excel.Range writeRange = worksheet.get_Range(startCell, endCell);\n\n        // Write the 2D array to the Excel worksheet\n        writeRange.Value2 = dataArray;\n\n        // Make Excel visible to the user\n        excelApp.Visible = true;\n        excelApp.UserControl = true;\n\n        // Release COM objects\n        System.Runtime.InteropServices.Marshal.ReleaseComObject(writeRange);\n        System.Runtime.InteropServices.Marshal.ReleaseComObject(worksheet);\n        System.Runtime.InteropServices.Marshal.ReleaseComObject(workbook);\n        System.Runtime.InteropServices.Marshal.ReleaseComObject(workbooks);\n        System.Runtime.InteropServices.Marshal.ReleaseComObject(excelApp);\n    }\n}