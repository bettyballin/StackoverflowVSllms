using System;\nusing System.IO;\nusing System.Globalization;\nusing Microsoft.Office.Interop.Excel;\n\npublic class ExcelService\n{\n    public void Start()\n    {\n        System.Threading.Thread.CurrentThread.CurrentCulture = new CultureInfo("en-US");\n\n        string filename = @"c:\temp\test.xls";\n\n        // Ensure directory exists\n        Directory.CreateDirectory(Path.GetDirectoryName(filename));\n\n        // Launch Excel and create/save a new workbook\n        Application excel = new Application();\n        try\n        {\n            if (File.Exists(filename)) File.Delete(filename);\n\n            Workbook workbook = excel.Workbooks.Add(Missing.Value);\n            workbook.SaveAs(filename);\n            workbook.Close(false, Missing.Value, Missing.Value);\n        }\n        finally\n        {\n            excel.Quit();\n            System.Runtime.InteropServices.Marshal.ReleaseComObject(excel);\n            excel = null;\n        }\n\n        // Launch new instance of Excel and open saved file\n        excel = new Application();\n        try\n        {\n            Workbook book = excel.Workbooks.Open(filename,\n                Missing.Value, // UpdateLinks\n                true,          // ReadOnly\n                Missing.Value, // Format\n                Missing.Value, // Password\n                Missing.Value, // WriteResPassword\n                true,          // IgnoreReadOnlyRecommended\n                Missing.Value, // Origin\n                Missing.Value, // Delimiter\n                false,         // Editable\n                false,         // Notify\n                Missing.Value, // Converter\n                false,         // AddToMru\n                Missing.Value, // Local\n                Missing.Value  // CorruptLoad\n            );\n            book.Close(false, Missing.Value, Missing.Value);\n            System.Runtime.InteropServices.Marshal.ReleaseComObject(book);\n        }\n        finally\n        {\n            excel.Quit();\n            System.Runtime.InteropServices.Marshal.ReleaseComObject(excel);\n            excel = null;\n        }\n\n        GC.Collect();\n        GC.WaitForPendingFinalizers();\n    }\n}