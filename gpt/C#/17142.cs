public static string EscapeLdapSearchFilter(string searchFilter)\n{\n    if (searchFilter == null)\n    {\n        throw new ArgumentNullException(nameof(searchFilter));\n    }\n\n    StringBuilder escaped = new StringBuilder();\n\n    foreach (char c in searchFilter)\n    {\n        switch (c)\n        {\n            case '\\':\n                escaped.Append(@"\5c");\n                break;\n            case '*':\n                escaped.Append(@"\2a");\n                break;\n            case '(':\n                escaped.Append(@"\28");\n                break;\n            case ')':\n                escaped.Append(@"\29");\n                break;\n            case '\0':\n                escaped.Append(@"\00");\n                break;\n            default:\n                escaped.Append(c);\n                break;\n        }\n    }\n\n    return escaped.ToString();\n}