public class Import\n{\n    private string _filePath;\n\n    public Import(string filePath)\n    {\n        _filePath = filePath;\n    }\n\n    public static void ImportPendingFile(string filePath)\n    {\n        Import i = new Import(filePath);\n        Thread newThread = new Thread(new ThreadStart(i.ImportFile));\n        newThread.Start();\n    }\n\n    public void ImportFile()\n    {\n        try\n        {\n            // 1. Query DB to identify pending file\n            // Assuming _filePath is the path to the file to be imported\n            if (!File.Exists(_filePath))\n            {\n                throw new FileNotFoundException("File not found", _filePath);\n            }\n\n            // 2. Open up and parse pending file\n            using (FileStream stream = new FileStream(_filePath, FileMode.Open, FileAccess.Read, FileShare.Read))\n            {\n                // use stream to open file\n                // 3. Import all data from file into DB\n            }\n\n            // 4. Update DB to reflect that import completed successfully\n        }\n        catch (Exception ex)\n        {\n            // Handle exceptions (log them, notify user, etc.)\n            // LogException(ex);\n        }\n    }\n}\n\n// In your codebehind\nprotected void butUpload(object sender, EventArgs e)\n{\n    // Save file, prepare for import\n    string filePath = SaveFile(); // Implement this method to save the file and return the file path\n    Import.ImportPendingFile(filePath);\n    Response.Redirect("NewLocation");\n}