var query = from p in dt_poruchy\n            join a in mt_auta on p.id_auta equals a.id into ap\n            from subA in ap.DefaultIfEmpty()\n            where p.servis >= 3\n            group p by p.id_auta into g\n            select new\n            {\n                SumCena = g.Sum(x => x.cena),\n                IdAuta = g.Key,\n                MaxServis = g.Max(x => x.servis)\n            };