using System;\n\nclass Program\n{\n    static void Main()\n    {\n        string inputPath = @"%programfiles%\directory\tool.exe";\n        string expandedPath = Environment.ExpandEnvironmentVariables(inputPath);\n        \n        try\n        {\n            System.Diagnostics.Process.Start(expandedPath);\n        }\n        catch (System.ComponentModel.Win32Exception ex)\n        {\n            Console.WriteLine($"Error: {ex.Message}");\n        }\n    }\n}