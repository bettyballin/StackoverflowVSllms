using System.Data;\nusing Oracle.ManagedDataAccess.Client;\nusing System.Windows.Forms;\n\npublic void FillDataGrid(DataGridView dataGridView)\n{\n    string connectionString = "User Id=<username>;Password=<password>;Data Source=<datasource>";\n    string query = @"\n        WITH ProductAlias AS (\n            SELECT \n                ID_PRODUCT, \n                PRODUCT_NAME, \n                SUBSTR(PRODUCT_NAME, 1, 30) AS SHORT_NAME\n            FROM \n                PRODUCT\n        ),\n        PivotData AS (\n            SELECT \n                c.COMPANY_NAME,\n                pa.SHORT_NAME,\n                ps.SALE_COUNT\n            FROM \n                COMPANY c\n            JOIN \n                PRODUCT_SALE ps ON c.ID_COMPANY = ps.ID_COMPANY\n            JOIN \n                ProductAlias pa ON ps.ID_PRODUCT = pa.ID_PRODUCT\n        )\n        SELECT * FROM PivotData\n        PIVOT (\n            SUM(SALE_COUNT)\n            FOR SHORT_NAME IN ('ShortName1' AS ShortName1, 'ShortName2' AS ShortName2, 'ShortName3' AS ShortName3)\n        )";\n\n    using (OracleConnection conn = new OracleConnection(connectionString))\n    {\n        OracleDataAdapter adapter = new OracleDataAdapter(query, conn);\n        DataTable dataTable = new DataTable();\n        adapter.Fill(dataTable);\n        dataGridView.DataSource = dataTable;\n    }\n}