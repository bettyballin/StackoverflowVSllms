CREATE FUNCTION dbo.ProperCase(@inputString VARCHAR(8000))\nRETURNS VARCHAR(8000)\nAS\nBEGIN\n    DECLARE @outputString VARCHAR(8000)\n    DECLARE @index INT\n    DECLARE @char CHAR(1)\n    DECLARE @prevChar CHAR(1)\n\n    SET @outputString = LOWER(@inputString) -- Convert the whole string to lower case first\n    SET @index = 1\n\n    WHILE @index <= LEN(@outputString)\n    BEGIN\n        SET @char = SUBSTRING(@outputString, @index, 1)\n        SET @prevChar = CASE WHEN @index = 1 THEN ' ' ELSE SUBSTRING(@outputString, @index - 1, 1) END\n\n        -- Convert to upper case if the character is the first character or follows a space\n        IF @prevChar = ' ' AND @char BETWEEN 'a' AND 'z'\n        BEGIN\n            SET @outputString = STUFF(@outputString, @index, 1, UPPER(@char))\n        END\n\n        SET @index = @index + 1\n    END\n\n    RETURN @outputString\nEND\nGO