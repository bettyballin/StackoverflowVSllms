INSERT INTO @search_temp_table\nSELECT * FROM (\n    SELECT \n        d.DataId, \n        (SELECT [Name] FROM Category WHERE CategoryId = d.CategoryId) AS 'Category', \n        d.Description, \n        d.CompanyName, \n        d.City, \n        d.CategoryId,\n        d.CreatedOn, \n        d.Rank, \n        d.voteCount, \n        d.commentCount, \n        d.viewCount\n    FROM Data d \n    INNER JOIN Keyword k ON d.DataId = k.DataId\n    WHERE \n        FREETEXT(k.Keyword, @SearchQ) \n        AND d.IsSearch = 1 \n        AND d.IsApproved = 1\n        AND (\n            @CategoryId NOT IN (1, 2, 3) OR d.CategoryId = @CategoryId\n        )\n) AS Search_Data