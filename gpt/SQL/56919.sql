CREATE TRIGGER trg_CheckDateOverlap\nON myData\nAFTER INSERT, UPDATE\nAS\nBEGIN\n    SET NOCOUNT ON;\n\n    IF EXISTS (\n        SELECT 1\n        FROM inserted i\n        JOIN myData d\n        ON i.fk_item_id = d.fk_item_id\n        AND i.id <> d.id\n        AND (\n            (i.valid_from BETWEEN d.valid_from AND d.invalid_from)\n            OR (i.invalid_from BETWEEN d.valid_from AND d.invalid_from)\n            OR (d.valid_from BETWEEN i.valid_from AND i.invalid_from)\n            OR (d.invalid_from BETWEEN i.valid_from AND i.invalid_from)\n        )\n    )\n    BEGIN\n        -- Raise an error and rollback the transaction\n        RAISERROR('Date ranges overlap for fk_item_id %d', 16, 1, (SELECT fk_item_id FROM inserted));\n        ROLLBACK TRANSACTION;\n    END\nEND;