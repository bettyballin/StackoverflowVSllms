CREATE TEMPORARY TABLE filtered_players AS\nSELECT p.id\nFROM ejl_players p \nLEFT JOIN ejl_registration r ON r.player_id = p.id \nLEFT JOIN ejl_teams t ON r.team_id = t.id \nLEFT JOIN ejl_clubs c ON t.club_id = c.id\nWHERE r.season = 2008\nGROUP BY p.id\nHAVING COUNT(DISTINCT c.id) > 1;\n\nSELECT p1.surname, p1.name, p1.id, r1.start_date, r1.end_date, c1.short_name\nFROM ejl_players p1\nLEFT JOIN ejl_registration r1 ON r1.player_id = p1.id\nLEFT JOIN ejl_teams t1 ON r1.team_id = t1.id\nLEFT JOIN ejl_clubs c1 ON t1.club_id = c1.id\nWHERE r1.season = 2008\nAND p1.id IN (SELECT id FROM filtered_players);\n\nDROP TEMPORARY TABLE filtered_players;