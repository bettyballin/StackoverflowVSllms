WITH CTE AS (\n    SELECT \n        UniqueName,\n        ROW_NUMBER() OVER (PARTITION BY UniqueName ORDER BY (SELECT NULL)) AS RowNum\n    FROM Persons\n)\nUPDATE Persons\nSET UniqueName = CASE \n                   WHEN CTE.RowNum = 1 THEN CTE.UniqueName\n                   ELSE CTE.UniqueName + CAST(CTE.RowNum - 1 AS VARCHAR)\n                 END\nFROM CTE\nWHERE Persons.UniqueName = CTE.UniqueName;