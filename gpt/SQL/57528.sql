USE [master]\nGO\n\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nALTER PROCEDURE [dbo].[spGrantExec] \n    @User sysname,\n    @DB sysname,\n    @Target varchar(50)\nAS \nBEGIN\n    SET NOCOUNT ON;\n\n    DECLARE @SQL nvarchar(MAX);\n    DECLARE @CMD1 nvarchar(MAX);\n\n    SET @SQL = N'\n    USE ' + QUOTENAME(@DB) + N';\n\n    DECLARE @OwnerName sysname;\n    DECLARE @ObjectName sysname;\n    DECLARE @CMD1 nvarchar(MAX);\n\n    DECLARE CURSOR_SProcs CURSOR FOR\n    SELECT ROUTINE_SCHEMA, ROUTINE_NAME\n    FROM ' + QUOTENAME(@DB) + N'.INFORMATION_SCHEMA.ROUTINES \n    WHERE ROUTINE_NAME LIKE @Target + ''%''\n    AND ROUTINE_TYPE = ''PROCEDURE'';\n\n    OPEN CURSOR_SProcs;\n\n    FETCH NEXT FROM CURSOR_SProcs INTO @OwnerName, @ObjectName;\n\n    WHILE @@FETCH_STATUS = 0\n    BEGIN\n        SET @CMD1 = N''GRANT EXEC ON '' + QUOTENAME(@OwnerName) + ''.'' + QUOTENAME(@ObjectName) + N'' TO '' + QUOTENAME(@User);\n        PRINT @CMD1;  -- For debugging purposes, you can remove this in production\n        EXEC sp_executesql @CMD1;\n\n        FETCH NEXT FROM CURSOR_SProcs INTO @OwnerName, @ObjectName;\n    END;\n\n    CLOSE CURSOR_SProcs;\n    DEALLOCATE CURSOR_SProcs;\n    ';\n\n    EXEC sp_executesql @SQL, N'@Target varchar(50)', @Target;\n\n    SET NOCOUNT OFF;\nEND