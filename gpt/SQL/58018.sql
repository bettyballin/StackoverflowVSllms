WITH FirstPageView AS (\n    SELECT\n        pv1.SessionID,\n        pv1.Path,\n        ROW_NUMBER() OVER (PARTITION BY pv1.SessionID ORDER BY pv1.Created) AS RowNum\n    FROM\n        pageviews pv1\n        INNER JOIN Sessions s1 ON pv1.SessionID = s1.SessionID\n        INNER JOIN Visitors v1 ON s1.VisitorID = v1.VisitorID\n    WHERE\n        pv1.Domain = ISNULL(@Domain, pv1.Domain) AND\n        v1.Campaign = @Campaign\n)\nSELECT\n    fp.Path AS EntryPage,\n    COUNT(fp.Path) AS [Count]\nFROM\n    FirstPageView fp\nWHERE\n    fp.RowNum = 1\nGROUP BY\n    fp.Path;