DECLARE @ExtID INT = 101, @dtDate DATETIME = '2008-06-15'\n\n;WITH Exclusions AS (\n    SELECT \n        Id,\n        ExtId,\n        StartExclusionDate,\n        EndExclusionDate,\n        ApplyDate,\n        ROW_NUMBER() OVER (PARTITION BY ExtId ORDER BY ApplyDate DESC) AS rn\n    FROM \n        YourTableName\n    WHERE \n        ExtId = @ExtID\n        AND ApplyDate <= @dtDate\n)\nSELECT \n    Id,\n    ExtId,\n    StartExclusionDate,\n    EndExclusionDate,\n    ApplyDate\nFROM \n    Exclusions\nWHERE \n    rn = 1\n    AND @dtDate BETWEEN StartExclusionDate AND EndExclusionDate