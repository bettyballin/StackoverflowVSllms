-- Step 1: Identify the user accounts that need to be merged based on first_name and last_name\nSELECT user_id, username, last_name, first_name\nFROM user_rtab\nWHERE last_name = 'Doe' AND first_name = 'John';\n\n-- Assume the above query returns two user accounts with user_id 1 and 2\n\n-- Step 2: Choose the main account to keep (let's assume user_id = 1 is the main account)\n-- and migrate all lesson statuses from the other account (user_id = 2) to the main account (user_id = 1)\n\n-- Update lessonstatus_rtab to change user_id from 2 to 1\nUPDATE lessonstatus_rtab\nSET user_id = 1\nWHERE user_id = 2;\n\n-- Step 3: Delete the redundant user account (user_id = 2)\nDELETE FROM user_rtab\nWHERE user_id = 2;\n\n-- Optional: Remove duplicate lesson statuses if a user has taken the same lesson multiple times under different accounts\nDELETE ls1 FROM lessonstatus_rtab ls1\nINNER JOIN lessonstatus_rtab ls2 \n    ON ls1.lesson_id = ls2.lesson_id \n    AND ls1.user_id = ls2.user_id\n    AND ls1.accessdate > ls2.accessdate\n    AND ls1.user_id = 1;