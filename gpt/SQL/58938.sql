WITH RECURSIVE encode_char AS (\n  SELECT \n    '', \n    ''::text AS encoded_text,\n    'h√©llo there'::text AS original_text\n  UNION ALL\n  SELECT \n    substring(original_text, 1, 1),\n    encoded_text ||\n      CASE \n        WHEN substring(original_text, 1, 1) ~ '[A-Za-z0-9]' THEN substring(original_text, 1, 1)\n        ELSE '%' || lpad(to_hex(ascii(substring(original_text, 1, 1))), 2, '0')\n      END,\n    substring(original_text, 2)\n  FROM encode_char\n  WHERE original_text <> ''\n)\nSELECT encoded_text \nFROM encode_char \nWHERE original_text = '';