SELECT \n    TenantID,\n    SUM(CASE WHEN Amount > 0 THEN Amount ELSE 0 END) AS Paid,\n    SUM(CASE WHEN Amount < 0 AND TransactionDate > DATEADD(day, -30, GETDATE()) THEN Amount ELSE 0 END) AS ChargedCurrent,\n    SUM(CASE WHEN Amount < 0 AND TransactionDate > DATEADD(day, -60, GETDATE()) AND TransactionDate <= DATEADD(day, -30, GETDATE()) THEN Amount ELSE 0 END) AS ChargedOver30,\n    SUM(CASE WHEN Amount < 0 AND TransactionDate > DATEADD(day, -90, GETDATE()) AND TransactionDate <= DATEADD(day, -60, GETDATE()) THEN Amount ELSE 0 END) AS ChargedOver60,\n    SUM(CASE WHEN Amount < 0 AND TransactionDate <= DATEADD(day, -90, GETDATE()) THEN Amount ELSE 0 END) AS ChargedOver90\nFROM tblTransaction\nGROUP BY TenantID