WITH RankedTimestamps AS (\n    SELECT \n        ID, \n        timestamp, \n        ROW_NUMBER() OVER (ORDER BY timestamp) AS row_num\n    FROM \n        your_table\n    WHERE \n        timestamp IS NOT NULL\n    GROUP BY \n        timestamp\n),\nTimeDifferences AS (\n    SELECT \n        t1.timestamp AS current_timestamp, \n        t2.timestamp AS next_timestamp, \n        TIMESTAMPDIFF(SECOND, t1.timestamp, t2.timestamp) AS time_diff\n    FROM \n        RankedTimestamps t1\n    JOIN \n        RankedTimestamps t2 \n    ON \n        t1.row_num = t2.row_num - 1\n)\nSELECT \n    AVG(time_diff) AS average_time_diff\nFROM \n    TimeDifferences;