SELECT \n    IssueID, \n    Mid(References, StartPos, Len) AS DocID\nFROM \n    TempIssue,\n    (\n        SELECT \n            Number AS StartPos,\n            Number + CHARINDEX('DocID', Substring(References, Number + 1, LEN(References))) - 1 AS EndPos\n        FROM \n            TempIssue, \n            master..spt_values\n        WHERE \n            Type = 'P' \n            AND Number BETWEEN 1 AND LEN(References)\n            AND Substring(References, Number, 5) = 'DocID'\n    ) AS SplitPos\nWHERE \n    LEN(References) >= StartPos