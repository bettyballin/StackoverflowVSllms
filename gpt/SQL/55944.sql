-- Create the table\nCREATE TABLE MyTable (\n    ID INT PRIMARY KEY,\n    PARENT_ID INT,\n    CONSTRAINT FK_ParentChild FOREIGN KEY (PARENT_ID) REFERENCES MyTable(ID)\n);\n\n-- Insert some sample data\nINSERT INTO MyTable (ID, PARENT_ID) VALUES (1, NULL);\nINSERT INTO MyTable (ID, PARENT_ID) VALUES (2, 1);\nINSERT INTO MyTable (ID, PARENT_ID) VALUES (3, 1);\nINSERT INTO MyTable (ID, PARENT_ID) VALUES (4, 2);\n\n-- Recursive CTE to delete a hierarchy\nWITH RecursiveDelete AS (\n    SELECT ID\n    FROM MyTable\n    WHERE ID = @RootID -- Specify the root ID to delete\n\n    UNION ALL\n\n    SELECT t.ID\n    FROM MyTable t\n    INNER JOIN RecursiveDelete r ON t.PARENT_ID = r.ID\n)\nDELETE FROM MyTable\nWHERE ID IN (SELECT ID FROM RecursiveDelete);