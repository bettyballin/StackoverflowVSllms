WITH RECURSIVE PersonHierarchy AS (\n    SELECT\n        id,\n        name,\n        age,\n        parent,\n        name AS full_name,\n        age AS full_age\n    FROM\n        Persons\n    WHERE\n        parent IS NULL\n    UNION ALL\n    SELECT\n        p.id,\n        p.name,\n        p.age,\n        p.parent,\n        ph.full_name || ' - ' || p.name AS full_name,\n        ph.full_age || ' - ' || p.age AS full_age\n    FROM\n        Persons p\n    INNER JOIN\n        PersonHierarchy ph ON p.parent = ph.id\n)\nSELECT\n    full_name,\n    full_age\nFROM\n    PersonHierarchy\nORDER BY\n    age;