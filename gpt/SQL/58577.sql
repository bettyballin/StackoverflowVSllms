SELECT \n    c.CustomerName,\n    MAX(CASE WHEN p.ProductRowNum = 1 THEN p.ProductName END) AS Product1Name,\n    MAX(CASE WHEN p.ProductRowNum = 2 THEN p.ProductName END) AS Product2Name\nFROM \n    Customer c\nLEFT JOIN (\n    SELECT \n        ProductID,\n        CustomerID,\n        ProductName,\n        ROW_NUMBER() OVER (PARTITION BY CustomerID ORDER BY ProductID) AS ProductRowNum\n    FROM \n        Products\n) p ON c.CustomerID = p.CustomerID\nGROUP BY \n    c.CustomerName;