WITH Intervals AS (\n    SELECT\n        ID,\n        startDate,\n        endDate,\n        LAG(endDate) OVER (PARTITION BY ID ORDER BY startDate) AS prev_endDate\n    FROM\n        YourTable\n),\nGroupedIntervals AS (\n    SELECT\n        ID,\n        startDate,\n        endDate,\n        SUM(CASE\n                WHEN startDate = prev_endDate + 1 THEN 0\n                ELSE 1\n            END) OVER (PARTITION BY ID ORDER BY startDate) AS group_id\n    FROM\n        Intervals\n)\nSELECT\n    ID,\n    MIN(startDate) AS startDate,\n    MAX(endDate) AS endDate\nFROM\n    GroupedIntervals\nGROUP BY\n    ID,\n    group_id\nORDER BY\n    ID,\n    startDate;