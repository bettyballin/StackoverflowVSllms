-- Assuming @NewObjectID is the new object identity you want to link to\nDECLARE @NewObjectID INT = 123;\n\n-- Temp table to hold the new identities of inserted records\nDECLARE @InsertedData TABLE (NewDataID INT, OldDataID INT);\n\n-- Insert into Data_Table and capture the new identities\nINSERT INTO Data_Table (DataColumn1, DataColumn2, ...)\nOUTPUT INSERTED.DataID, src.DataID INTO @InsertedData (NewDataID, OldDataID)\nSELECT DataColumn1, DataColumn2, ...\nFROM Data_Table src\nINNER JOIN Link_Table lt ON src.DataID = lt.DataID\nWHERE lt.ObjectID = @OldObjectID;\n\n-- Insert into Link_Table using the captured identities\nINSERT INTO Link_Table (ObjectID, DataID)\nSELECT @NewObjectID, NewDataID\nFROM @InsertedData;