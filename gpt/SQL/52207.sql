DECLARE @Origin VARCHAR(10) = 'ALL';\nDECLARE @STARTDATE DATETIME;\nDECLARE @ENDDATE DATETIME;\nDECLARE @CONTRACT VARCHAR(50);\n\nSELECT\n    CASE \n        WHEN @Origin = 'ALL' THEN (\n            SELECT COUNT(*) \n            FROM TBL_PARTORDER \n            INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID \n            INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF \n            WHERE (TBL_PARTORDER.RAISED IS NOT NULL) \n              AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME, @STARTDATE, 103) AND DATEADD(hh, 23, CONVERT(DATETIME, @ENDDATE, 103))) \n              AND (TBL_PROPERTY.CONTRACT = @CONTRACT) \n              AND DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) <= 60\n        )\n    END AS OneHour,\n    CASE \n        WHEN @Origin = 'ALL' THEN (\n            SELECT COUNT(*) \n            FROM TBL_PARTORDER \n            INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID \n            INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF \n            WHERE (TBL_PARTORDER.RAISED IS NOT NULL) \n              AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME, @STARTDATE, 103) AND DATEADD(hh, 23, CONVERT(DATETIME, @ENDDATE, 103))) \n              AND (TBL_PROPERTY.CONTRACT = @CONTRACT) \n              AND DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 61 AND 120\n        )\n    END AS TwoHour,\n    CASE \n        WHEN @Origin = 'ALL' THEN (\n            SELECT COUNT(*) \n            FROM TBL_PARTORDER \n            INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID \n            INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF \n            WHERE (TBL_PARTORDER.RAISED IS NOT NULL) \n              AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME, @STARTDATE, 103) AND DATEADD(hh, 23, CONVERT(DATETIME, @ENDDATE, 103))) \n              AND (TBL_PROPERTY.CONTRACT = @CONTRACT) \n              AND DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 121 AND 180\n        )\n    END AS ThreeHour