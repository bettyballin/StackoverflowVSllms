WITH ConsecutiveEstimates AS (\n    SELECT \n        BillId,\n        Estimated,\n        InvoiceDate,\n        ROW_NUMBER() OVER (ORDER BY InvoiceDate DESC) AS RowNum\n    FROM \n        Bills\n    WHERE \n        Estimated = 1\n)\nSELECT \n    CE1.BillId AS BillId1,\n    CE1.InvoiceDate AS InvoiceDate1,\n    CE2.BillId AS BillId2,\n    CE2.InvoiceDate AS InvoiceDate2\nFROM \n    ConsecutiveEstimates CE1\nJOIN \n    ConsecutiveEstimates CE2\nON \n    CE1.RowNum = CE2.RowNum - 1;