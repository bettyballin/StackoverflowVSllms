WITH RankedActions AS (\n    SELECT \n        id,\n        User,\n        Action,\n        insertDate,\n        ROW_NUMBER() OVER (PARTITION BY Action ORDER BY insertDate DESC) AS rn\n    FROM \n        UserActions\n    WHERE \n        User = 'john'\n)\nSELECT \n    id,\n    User,\n    Action,\n    insertDate\nFROM \n    RankedActions\nWHERE \n    rn = 1\nORDER BY \n    insertDate DESC;