SELECT \n    splits.day AS splits_day, \n    splits.ratio AS splits_ratio, \n    splits.ticker AS splits_ticker, \n    dividends.day AS dividends_day, \n    dividends.amount AS dividends_amount, \n    dividends.ticker AS dividends_ticker\nFROM \n    splits\nLEFT JOIN \n    dividends ON splits.day = dividends.day AND splits.ticker = dividends.ticker\nUNION\nSELECT \n    splits.day AS splits_day, \n    splits.ratio AS splits_ratio, \n    splits.ticker AS splits_ticker, \n    dividends.day AS dividends_day, \n    dividends.amount AS dividends_amount, \n    dividends.ticker AS dividends_ticker\nFROM \n    splits\nRIGHT JOIN \n    dividends ON splits.day = dividends.day AND splits.ticker = dividends.ticker\nORDER BY \n    COALESCE(splits.day, dividends.day), \n    COALESCE(splits.ticker, dividends.ticker);