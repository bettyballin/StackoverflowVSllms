DECLARE @sql NVARCHAR(MAX);\nDECLARE @p INT = 1; -- example parameter\nDECLARE @p3 NVARCHAR(100) = 'example'; -- example parameter\nDECLARE @p_SortExpression NVARCHAR(50) = 'ComposeMail.DateTime'; -- example parameter\n\nSET @sql = N'\nSELECT \n  ComposeMail.ID,\n  ComposeMail.DateTime, \n  ComposeMail.Subject, \n  ComposeMail.CreatedBy, \n  ComposeMail.ReceiverStatus,\n  Users.Name,\n  ROW_NUMBER() OVER(ORDER BY ' + @p_SortExpression + ') AS Indexing\nFROM \n  ComposeMail \nINNER JOIN\n  Users\nON\n  ComposeMail.CreatedBy = Users.ID\nWHERE \n  (ToReceipientID = @p)\n  AND (\n    ReceiverStatus = 3 \n    OR ReceiverStatus = 4\n  )\n  AND (\n    (Subject LIKE @filter) \n    OR (Body LIKE @filter) \n    OR (Name LIKE @filter)\n  )';\n\n-- Execute the query with parameters\nEXEC sp_executesql @sql, N'@p INT, @filter NVARCHAR(100)', @p, @filter = '%' + @p3 + '%';