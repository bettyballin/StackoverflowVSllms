WITH RankedDays AS (\n    SELECT \n        DISTINCT CAST(datetime_column AS DATE) AS date_only,\n        ROW_NUMBER() OVER (ORDER BY CAST(datetime_column AS DATE) DESC) AS row_num\n    FROM \n        your_table_name\n)\nSELECT \n    t.*\nFROM \n    your_table_name t\nJOIN \n    RankedDays rd\nON \n    CAST(t.datetime_column AS DATE) = rd.date_only\nWHERE \n    rd.row_num <= 5\nORDER BY \n    t.datetime_column DESC;