CREATE PROCEDURE OuterProcedure\nAS\nBEGIN\n    -- Create a temporary table to store the results of the inner stored procedure\n    CREATE TABLE #sp_who_results (\n        SPID INT,\n        Status VARCHAR(50),\n        Login VARCHAR(50),\n        HostName VARCHAR(50),\n        BlkBy VARCHAR(50),\n        DBName VARCHAR(50),\n        Command VARCHAR(50),\n        CPUTime INT,\n        DiskIO INT,\n        LastBatch VARCHAR(50),\n        ProgramName VARCHAR(50),\n        SPID2 INT,\n        REQUESTID INT\n    );\n\n    -- Insert the results of the inner stored procedure into the temporary table\n    INSERT INTO #sp_who_results\n    EXEC sp_who;\n\n    -- Declare a cursor to loop through the results\n    DECLARE @SPID INT;\n    DECLARE @Login VARCHAR(50);\n\n    DECLARE cur CURSOR FOR\n    SELECT SPID, Login\n    FROM #sp_who_results\n    WHERE Login LIKE '%gatesb';\n\n    OPEN cur;\n    FETCH NEXT FROM cur INTO @SPID, @Login;\n\n    WHILE @@FETCH_STATUS = 0\n    BEGIN\n        -- Perform actions with the current row's data\n        PRINT 'Killing process: ' + CAST(@SPID AS VARCHAR) + ' Login: ' + @Login;\n\n        -- Optionally, kill the process\n        -- KILL @SPID;\n\n        FETCH NEXT FROM cur INTO @SPID, @Login;\n    END;\n\n    CLOSE cur;\n    DEALLOCATE cur;\n\n    -- Clean up temporary table\n    DROP TABLE #sp_who_results;\nEND;