SELECT *\nFROM log\nWHERE log_id IN\n(\n    SELECT MIN(log_id) \n    FROM log \n    WHERE\n    (\n        SELECT COUNT(DISTINCT log_name)\n        FROM log log2 \n        WHERE log2.fb_id = log.fb_id\n    ) = 1 \n    OR log.log_name <> \n    (\n        SELECT log_name \n        FROM log log_3\n        WHERE log_3.log_id = \n        (\n            SELECT MIN(log_id)\n            FROM log log4\n            WHERE log4.fb_id = log.fb_id\n        )\n    )\n    GROUP BY fb_id\n)