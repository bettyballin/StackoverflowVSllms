CREATE PROCEDURE SwapRecordsExcludingColumns\n    @TableName NVARCHAR(128),\n    @RecordID1 INT,\n    @RecordID2 INT,\n    @ColumnsToExclude NVARCHAR(MAX)\nAS\nBEGIN\n    DECLARE @SQL NVARCHAR(MAX)\n    DECLARE @Columns NVARCHAR(MAX)\n\n    -- Get the list of columns to include in the swap\n    SELECT @Columns = COALESCE(@Columns + ', ', '') + COLUMN_NAME\n    FROM INFORMATION_SCHEMA.COLUMNS\n    WHERE TABLE_NAME = @TableName\n    AND COLUMN_NAME NOT IN (SELECT value FROM STRING_SPLIT(@ColumnsToExclude, ','))\n\n    -- Build the dynamic SQL query to swap records\n    SET @SQL = '\n    DECLARE @TempTable TABLE (' + @Columns + ' NVARCHAR(MAX))\n\n    INSERT INTO @TempTable (' + @Columns + ')\n    SELECT ' + @Columns + ' FROM ' + @TableName + ' WHERE ID = ' + CAST(@RecordID1 AS NVARCHAR) + '\n\n    UPDATE t1\n    SET ' + @Columns + ' = t2.' + @Columns + '\n    FROM ' + @TableName + ' t1\n    JOIN ' + @TableName + ' t2 ON t1.ID = ' + CAST(@RecordID1 AS NVARCHAR) + ' AND t2.ID = ' + CAST(@RecordID2 AS NVARCHAR) + '\n\n    UPDATE t2\n    SET ' + @Columns + ' = tt.' + @Columns + '\n    FROM ' + @TableName + ' t2\n    JOIN @TempTable tt ON t2.ID = ' + CAST(@RecordID2 AS NVARCHAR)\n\n    EXEC sp_executesql @SQL\nEND