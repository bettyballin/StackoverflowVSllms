DECLARE @IndexName NVARCHAR(128)\nDECLARE @TableName NVARCHAR(128)\nDECLARE @ColumnName NVARCHAR(128)\nDECLARE @SQL NVARCHAR(MAX)\n\n-- CTE to find the indexes on columns with the specified collation\nWITH indexCTE AS\n(\n    SELECT Table_Name, Column_Name, Collation_Name\n    FROM information_schema.columns\n    WHERE Collation_Name IS NOT NULL AND Collation_Name = 'Modern_Spanish_CI_AS'\n), \nindexCTE2 AS\n(\n    SELECT i.Name AS [IndexName], OBJECT_NAME(i.object_ID) AS [TableName], c.Name AS [ColumnName]\n    FROM sys.indexes i\n    INNER JOIN sys.index_columns ic ON i.index_id = ic.index_id AND i.object_id = ic.object_id\n    INNER JOIN sys.columns c ON ic.column_id = c.column_id AND ic.object_id = c.OBJECT_ID\n    WHERE EXISTS (SELECT 1 FROM indexCTE t1 WHERE t1.Table_Name = OBJECT_NAME(i.object_ID) AND t1.Column_Name = c.Name)\n) \nSELECT DISTINCT\n    QUOTENAME(i.[TableName]) AS TableName,\n    QUOTENAME(i.[IndexName]) AS IndexName,\n    STUFF((SELECT ',' + QUOTENAME(c.[ColumnName])\n           FROM indexCTE2 c\n           WHERE c.[IndexName] = i.[IndexName] AND c.[TableName] = i.[TableName]\n           FOR XML PATH('')), 1, 1, '') AS ColumnList,\n    i.[IndexName] AS DropIndex,\n    'CREATE INDEX ' + QUOTENAME(i.[IndexName]) + ' ON ' + QUOTENAME(i.[TableName]) + '(' + \n    STUFF((SELECT ',' + QUOTENAME(c.[ColumnName])\n           FROM indexCTE2 c\n           WHERE c.[IndexName] = i.[IndexName] AND c.[TableName] = i.[TableName]\n           FOR XML PATH('')), 1, 1, '') + ')' AS CreateIndex\nINTO #IndexScripts\nFROM indexCTE2 i\n\n-- Script to generate the drop and create scripts\nSELECT\n    'DROP INDEX ' + IndexName + ' ON ' + TableName + ';' AS DropIndexScript,\n    CreateIndex + ';' AS CreateIndexScript\nFROM #IndexScripts\n\nDROP TABLE #IndexScripts