SELECT\n    p.name AS ProductName,\n    MAX(CASE WHEN row_num = 1 THEN c.name END) AS Category_1,\n    MAX(CASE WHEN row_num = 2 THEN c.name END) AS Category_2,\n    MAX(CASE WHEN row_num = 3 THEN c.name END) AS Category_3\nFROM\n    product p\nLEFT JOIN (\n    SELECT\n        ptc.prod_id,\n        c.name,\n        ROW_NUMBER() OVER (PARTITION BY ptc.prod_id ORDER BY c.name) AS row_num\n    FROM\n        product_to_category ptc\n    JOIN\n        category c ON ptc.cat_id = c.id\n) c ON p.id = c.prod_id\nGROUP BY\n    p.id, p.name\nORDER BY\n    p.name;