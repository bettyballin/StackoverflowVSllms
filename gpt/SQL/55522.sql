CREATE TABLE [dbo].[Log](\n    [LogId] [int] IDENTITY(1,1) NOT NULL,\n    [UserId] [int] NULL,\n    [Description] [varchar](1024) NOT NULL,\n    [Timestamp] [datetime] NOT NULL DEFAULT GETDATE(),\n    CONSTRAINT [PK_Log] PRIMARY KEY CLUSTERED ([LogId] ASC)\n);\n\nGO\n\nCREATE TABLE [dbo].[LogReference](\n    [LogId] [int] NOT NULL,\n    [TableName] [varchar](32) NOT NULL,\n    [RowId] [int] NOT NULL,\n    CONSTRAINT [PK_LogReference] PRIMARY KEY CLUSTERED ([LogId] ASC, [TableName] ASC, [RowId] ASC),\n    CONSTRAINT [FK_LogReference_Log] FOREIGN KEY([LogId]) REFERENCES [dbo].[Log]([LogId])\n);\n\nGO\n\nCREATE FUNCTION [dbo].[GetLog] \n(\n    @TableName varchar(32),\n    @RowId int\n)\nRETURNS TABLE\nAS\nRETURN\n(\n    SELECT [Log].LogId, [Log].UserId, [Log].Description, [Log].Timestamp\n    FROM [Log]\n    INNER JOIN [LogReference] ON [Log].LogId = [LogReference].LogId\n    WHERE [LogReference].TableName = @TableName AND [LogReference].RowId = @RowId\n);\n\nGO