ALTER FUNCTION [dbo].[udf_create_acs] (@MasterCustomerId VARCHAR(26))\nRETURNS VARCHAR(30)\nAS\nBEGIN\n    -- This implements the "MOD 10" check digit calculation\n    -- for the US Postal Service ACS function, from "Publication 8A"\n    -- found at "http://www.usps.com/cpim/ftp/pubs/pub8a.pdf"\n    \n    DECLARE @result VARCHAR(30)\n    DECLARE @current_char INT\n    DECLARE @char_positions_odd VARCHAR(10) = '0123456789'\n    DECLARE @char_positions_even VARCHAR(10) = '0246813579'\n    DECLARE @total_value INT = 0\n    DECLARE @check_digit VARCHAR(1)\n    DECLARE @char_value INT\n    DECLARE @position INT = 1\n    \n    -- Stepping through the string one character at a time\n    WHILE @position <= LEN(@MasterCustomerId)\n    BEGIN\n        -- Get the numeric value of the current character\n        SET @char_value = CONVERT(INT, SUBSTRING(@MasterCustomerId, @position, 1))\n        \n        -- Calculate the weighted value based on position\n        IF @position % 2 = 0\n        BEGIN\n            -- Even position (2nd, 4th, etc.) - use the even weights\n            SET @total_value = @total_value + CONVERT(INT, SUBSTRING(@char_positions_even, @char_value + 1, 1))\n        END\n        ELSE\n        BEGIN\n            -- Odd position (1st, 3rd, etc.) - use the odd weights\n            SET @total_value = @total_value + CONVERT(INT, SUBSTRING(@char_positions_odd, @char_value + 1, 1))\n        END\n        \n        SET @position = @position + 1\n    END\n    \n    -- Find the check digit (character) using the formula in the USPS document\n    SET @check_digit = CONVERT(VARCHAR, (10 - (@total_value % 10)) % 10)\n    \n    -- Format the result string\n    SET @result = '#' + @MasterCustomerId + '   ' + @check_digit + '#'\n    \n    RETURN @result\nEND