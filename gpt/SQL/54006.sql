-- Sample tables\nCREATE TABLE Table1 (\n    user_id VARCHAR(10),\n    name VARCHAR(50)\n);\n\nCREATE TABLE Table2 (\n    id INT,\n    code VARCHAR(10),\n    date DATE,\n    incident_code INT,\n    user_id VARCHAR(10)\n);\n\n-- Sample data\nINSERT INTO Table1 (user_id, name) VALUES\n('x111', 'Smith, James'),\n('x112', 'Smith, Jane');\n\nINSERT INTO Table2 (id, code, date, incident_code, user_id) VALUES\n(1, '102008', '2008-10-20', 1, 'x111'),\n(2, '113008', '2008-11-30', 3, 'x111'),\n(3, '102008', '2008-10-20', 2, 'x112'),\n(4, '113008', '2008-11-30', 5, 'x112');\n\n-- Query to transpose rows into columns\nSELECT \n    t1.user_id,\n    t1.name AS user_name,\n    [OCT 2008] AS 'INCIDENT IN OCT 2008',\n    [NOV 2008] AS 'INCIDENT IN NOV 2008'\nFROM\n    (SELECT \n        user_id, \n        name, \n        FORMAT(date, 'MMM yyyy') AS MonthYear, \n        incident_code\n     FROM \n        Table2 t2\n     JOIN \n        Table1 t1 ON t2.user_id = t1.user_id) src\nPIVOT\n(\n    MAX(incident_code)\n    FOR MonthYear IN ([OCT 2008], [NOV 2008])\n) pvt;