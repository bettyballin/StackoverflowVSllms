-- Create composite index on (username, actiondate)\nCREATE INDEX idx_username_actiondate ON actions (username, actiondate);\n\n-- Optimized query using CTE and ROW_NUMBER()\nWITH RankedActions AS (\n    SELECT \n        uuid, \n        username, \n        actiondate, \n        status,\n        ROW_NUMBER() OVER (PARTITION BY username ORDER BY actiondate DESC) as rn\n    FROM actions\n    WHERE actiondate < 20061231\n)\nSELECT actiondate, status\nFROM RankedActions\nWHERE rn = 1;