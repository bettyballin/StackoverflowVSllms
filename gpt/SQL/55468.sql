DECLARE @StartDate DATE = CONVERT(DATE, DATEADD(MONTH, -3, GETDATE())); -- Start from 3 months ago\nDECLARE @EndDate DATE = CONVERT(DATE, GETDATE()); -- Up to today\nDECLARE @SpecificTime TIME = '12:00:00'; -- Specific time of the day\n\n;WITH DateRange AS (\n    SELECT @StartDate AS DateValue\n    UNION ALL\n    SELECT DATEADD(DAY, 1, DateValue)\n    FROM DateRange\n    WHERE DateValue < @EndDate\n)\nSELECT DateTime, ACMKWHYTD_1\nFROM WideHistory\nWHERE CAST(DateTime AS DATE) IN (SELECT DateValue FROM DateRange)\n  AND CAST(DateTime AS TIME) = @SpecificTime\nOPTION (MAXRECURSION 0);