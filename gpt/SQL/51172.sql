SELECT \n    SUM(VisitingCount) AS VisitingCount,\n    CASE \n        WHEN CONVERT(VARCHAR(5), Date, 108) BETWEEN '15:00' AND '15:29' THEN '15:00-15:30'\n        WHEN CONVERT(VARCHAR(5), Date, 108) BETWEEN '15:30' AND '15:59' THEN '15:30-16:00'\n        ELSE 'Other'\n    END AS [Time]\nFROM Table1\nGROUP BY \n    CASE \n        WHEN CONVERT(VARCHAR(5), Date, 108) BETWEEN '15:00' AND '15:29' THEN '15:00-15:30'\n        WHEN CONVERT(VARCHAR(5), Date, 108) BETWEEN '15:30' AND '15:59' THEN '15:30-16:00'\n        ELSE 'Other'\n    END\nORDER BY [Time]