SELECT \n    COUNT(*) AS TotalAccounts,\n    SUM(CASE WHEN t1.Balance = t2.Balance THEN 1 ELSE 0 END) AS Matches,\n    SUM(CASE WHEN t1.Balance <> t2.Balance THEN 1 ELSE 0 END) AS Mismatches,\n    (SUM(CASE WHEN t1.Balance = t2.Balance THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) AS PercentageMatch,\n    (SUM(CASE WHEN t1.Balance <> t2.Balance THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) AS PercentageMismatch\nFROM \n    temp1 t1\nJOIN \n    temp2 t2 ON t1.AccountNo = t2.AccountNo;