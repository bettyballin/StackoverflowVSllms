-- Declare and create a temporary table\nCREATE TABLE #cities\n(\n    city VARCHAR(200)\n);\n\n-- Insert distinct cities into the temporary table\nINSERT INTO #cities (city)\nSELECT DISTINCT city \nFROM tOH \nWHERE clientId = @clientId;\n\n-- Main query using the temporary table\nSELECT * \nFROM your_large_table\nWHERE city IN (SELECT city FROM #cities)\nAND state = (SELECT TOP 1 state FROM tOH WHERE clientId = @clientId);\n\n-- Drop the temporary table after use\nDROP TABLE #cities;