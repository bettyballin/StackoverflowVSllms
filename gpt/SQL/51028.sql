SELECT \n    UserTable.ID AS UserID, \n    UserTable.Name, \n    Team1.TeamID AS Team1, \n    Team2.TeamID AS Team2, \n    Team3.TeamID AS Team3, \n    Team4.TeamID AS Team4, \n    Team5.TeamID AS Team5, \n    Team6.TeamID AS Team6, \n    Team7.TeamID AS Team7\nFROM \n    UserTable\nLEFT JOIN \n    (SELECT UserID, TeamID, \n            ROW_NUMBER() OVER (PARTITION BY UserID ORDER BY TeamID) AS RowNum \n     FROM TeamTable) AS Team1 \n     ON UserTable.ID = Team1.UserID AND Team1.RowNum = 1\nLEFT JOIN \n    (SELECT UserID, TeamID, \n            ROW_NUMBER() OVER (PARTITION BY UserID ORDER BY TeamID) AS RowNum \n     FROM TeamTable) AS Team2 \n     ON UserTable.ID = Team2.UserID AND Team2.RowNum = 2\nLEFT JOIN \n    (SELECT UserID, TeamID, \n            ROW_NUMBER() OVER (PARTITION BY UserID ORDER BY TeamID) AS RowNum \n     FROM TeamTable) AS Team3 \n     ON UserTable.ID = Team3.UserID AND Team3.RowNum = 3\nLEFT JOIN \n    (SELECT UserID, TeamID, \n            ROW_NUMBER() OVER (PARTITION BY UserID ORDER BY TeamID) AS RowNum \n     FROM TeamTable) AS Team4 \n     ON UserTable.ID = Team4.UserID AND Team4.RowNum = 4\nLEFT JOIN \n    (SELECT UserID, TeamID, \n            ROW_NUMBER() OVER (PARTITION BY UserID ORDER BY TeamID) AS RowNum \n     FROM TeamTable) AS Team5 \n     ON UserTable.ID = Team5.UserID AND Team5.RowNum = 5\nLEFT JOIN \n    (SELECT UserID, TeamID, \n            ROW_NUMBER() OVER (PARTITION BY UserID ORDER BY TeamID) AS RowNum \n     FROM TeamTable) AS Team6 \n     ON UserTable.ID = Team6.UserID AND Team6.RowNum = 6\nLEFT JOIN \n    (SELECT UserID, TeamID, \n            ROW_NUMBER() OVER (PARTITION BY UserID ORDER BY TeamID) AS RowNum \n     FROM TeamTable) AS Team7 \n     ON UserTable.ID = Team7.UserID AND Team7.RowNum = 7