CREATE PROC dbo.ShowHierarchy\n(\n    @Root int\n)\nAS\nBEGIN\n    SET NOCOUNT ON\n    DECLARE @EmpID int, @EmpName varchar(30)\n\n    SET @EmpName = (SELECT EmpName FROM dbo.Emp WHERE EmpID = @Root)\n    PRINT REPLICATE('-', @@NESTLEVEL * 4) + @EmpName\n\n    SET @EmpID = (SELECT MIN(EmpID) FROM dbo.Emp WHERE MgrID = @Root)\n\n    WHILE @EmpID IS NOT NULL\n    BEGIN\n        EXEC dbo.ShowHierarchy @EmpID\n        SET @EmpID = (SELECT MIN(EmpID) FROM dbo.Emp WHERE MgrID = @Root AND EmpID > @EmpID)\n    END\nEND\nGO