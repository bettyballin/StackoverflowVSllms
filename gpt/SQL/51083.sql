CREATE TRIGGER trg_ShipmentHistory\nON Shipment\nAFTER UPDATE\nAS\nBEGIN\n    DECLARE \n        @BillNo int,\n        @column_name nvarchar(500),\n        @OldValue nvarchar(500),\n        @NewValue nvarchar(500),\n        @SQL nvarchar(1000),\n        @Comment nvarchar(5000)\n\n    SELECT @BillNo = BillNo FROM INSERTED\n\n    DECLARE HistoryMonitorLoop CURSOR FOR\n        SELECT column_name \n        FROM information_schema.columns\n        WHERE table_name = 'Shipment'\n\n    OPEN HistoryMonitorLoop\n    FETCH NEXT FROM HistoryMonitorLoop INTO @column_name\n\n    WHILE @@FETCH_STATUS = 0\n    BEGIN\n        SET @SQL = N'SELECT @OldValue = ' + QUOTENAME(@column_name) + N' FROM DELETED'\n        EXEC sp_executesql @SQL, N'@OldValue nvarchar(500) OUTPUT', @OldValue OUTPUT\n\n        SET @SQL = N'SELECT @NewValue = ' + QUOTENAME(@column_name) + N' FROM INSERTED'\n        EXEC sp_executesql @SQL, N'@NewValue nvarchar(500) OUTPUT', @NewValue OUTPUT\n\n        IF (@OldValue != @NewValue)\n        BEGIN\n            SET @Comment = @column_name + ' changed from ' + @OldValue + ' to ' + @NewValue\n            EXEC ShipmentNote_Insert @BillNo = @BillNo, @CoordinatorID = 1, @Comment = @Comment\n        END\n\n        FETCH NEXT FROM HistoryMonitorLoop INTO @column_name\n    END\n\n    CLOSE HistoryMonitorLoop\n    DEALLOCATE HistoryMonitorLoop\nEND