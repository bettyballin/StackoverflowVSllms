CREATE PROCEDURE usp_SearchPaged\n    @SearchCriteria NVARCHAR(255),\n    @PageNumber INT,\n    @PageSize INT,\n    @ReturnCount BIT\nAS\nBEGIN\n    SET NOCOUNT ON;\n\n    -- Use a CTE to centralize the search logic\n    WITH SearchResults AS (\n        SELECT \n            -- Select the necessary columns for your search\n            Column1,\n            Column2,\n            -- Rank the results for pagination\n            ROW_NUMBER() OVER (ORDER BY Column1) AS RowNum\n        FROM \n            YourTable\n        WHERE\n            -- Apply search criteria\n            YourColumn LIKE '%' + @SearchCriteria + '%'\n    )\n    \n    -- Return count or paged results based on the parameter\n    IF @ReturnCount = 1\n    BEGIN\n        SELECT COUNT(*) AS TotalCount\n        FROM SearchResults\n    END\n    ELSE\n    BEGIN\n        SELECT \n            Column1,\n            Column2\n        FROM \n            SearchResults\n        WHERE \n            RowNum BETWEEN (@PageNumber - 1) * @PageSize + 1 AND @PageNumber * @PageSize\n        ORDER BY \n            RowNum\n    END\nEND