-- Step 1: Pre-calculate binned coordinates and probabilities\nWITH binned_data AS (\n    SELECT\n        FLOOR(x / 50) * 50 AS binned_x,\n        FLOOR(y / 50) * 50 AS binned_y,\n        probability\n    FROM coordinates\n)\n-- Step 2: Aggregate the binned data\nSELECT\n    binned_x AS x,\n    binned_y AS y,\n    SUM(probability) AS total_probability\nFROM binned_data\nGROUP BY binned_x, binned_y;