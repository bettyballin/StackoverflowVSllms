DECLARE @job_id UNIQUEIDENTIFIER;\nDECLARE @job_name NVARCHAR(128);\nDECLARE @step_id INT;\nDECLARE @command NVARCHAR(MAX);\nDECLARE @old_text NVARCHAR(100) = 'old_email@example.com';\nDECLARE @new_text NVARCHAR(100) = '';\n\n-- Cursor to loop through all jobs\nDECLARE job_cursor CURSOR FOR\nSELECT job_id, name\nFROM msdb.dbo.sysjobs;\n\nOPEN job_cursor;\n\nFETCH NEXT FROM job_cursor INTO @job_id, @job_name;\n\nWHILE @@FETCH_STATUS = 0\nBEGIN\n    -- Cursor to loop through all steps of the current job\n    DECLARE step_cursor CURSOR FOR\n    SELECT step_id, command\n    FROM msdb.dbo.sysjobsteps\n    WHERE job_id = @job_id;\n\n    OPEN step_cursor;\n\n    FETCH NEXT FROM step_cursor INTO @step_id, @command;\n\n    WHILE @@FETCH_STATUS = 0\n    BEGIN\n        -- Replace the old email with the new email in the command text\n        SET @command = REPLACE(@command, @old_text, @new_text);\n\n        -- Update the job step with the new command text\n        EXEC msdb.dbo.sp_update_jobstep\n            @job_id = @job_id,\n            @step_id = @step_id,\n            @command = @command;\n\n        FETCH NEXT FROM step_cursor INTO @step_id, @command;\n    END\n\n    CLOSE step_cursor;\n    DEALLOCATE step_cursor;\n\n    FETCH NEXT FROM job_cursor INTO @job_id, @job_name;\nEND\n\nCLOSE job_cursor;\nDEALLOCATE job_cursor;