CREATE TRIGGER trg_CheckNodeIntegrity\n    ON Nodes\n    BEFORE INSERT, UPDATE\n    AS\n    BEGIN\n        -- Check for LinkNode type\n        IF EXISTS (\n            SELECT 1\n            FROM inserted\n            WHERE NodeType = 'LinkNode'\n            AND (HtmlContent IS NOT NULL OR CodeContent IS NOT NULL)\n        )\n        BEGIN\n            RAISERROR ('LinkNode cannot have HtmlContent or CodeContent', 16, 1);\n            ROLLBACK TRANSACTION;\n            RETURN;\n        END\n\n        -- Check for HtmlPageNode type\n        IF EXISTS (\n            SELECT 1\n            FROM inserted\n            WHERE NodeType = 'HtmlPageNode'\n            AND (HtmlContent IS NULL OR CodeContent IS NOT NULL)\n        )\n        BEGIN\n            RAISERROR ('HtmlPageNode must have HtmlContent and no CodeContent', 16, 1);\n            ROLLBACK TRANSACTION;\n            RETURN;\n        END\n\n        -- Check for CodePageNode type\n        IF EXISTS (\n            SELECT 1\n            FROM inserted\n            WHERE NodeType = 'CodePageNode'\n            AND (HtmlContent IS NOT NULL OR CodeContent IS NULL)\n        )\n        BEGIN\n            RAISERROR ('CodePageNode must have CodeContent and no HtmlContent', 16, 1);\n            ROLLBACK TRANSACTION;\n            RETURN;\n        END\n    END;