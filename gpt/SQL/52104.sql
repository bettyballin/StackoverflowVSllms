CREATE OR REPLACE FUNCTION MD5_ENCODE(CLEARTEXT IN VARCHAR2) RETURN VARCHAR2 IS\n    CHK VARCHAR2(16);\n    HEX VARCHAR2(32);\n    I   INTEGER;\n    C   INTEGER;\n    H   INTEGER;\nBEGIN\n    IF CLEARTEXT IS NULL THEN\n        RETURN '';\n    ELSE\n        CHK := DBMS_OBFUSCATION_TOOLKIT.MD5(INPUT_STRING => CLEARTEXT);\n        FOR I IN 1 .. 16 LOOP\n            C := ASCII(SUBSTR(CHK, I, 1));\n            H := TRUNC(C / 16);\n            IF H >= 10 THEN\n                HEX := HEX || CHR(H + 55);\n            ELSE\n                HEX := HEX || CHR(H + 48);\n            END IF;\n            H := MOD(C, 16);\n            IF H >= 10 THEN\n                HEX := HEX || CHR(H + 55);\n            ELSE\n                HEX := HEX || CHR(H + 48);\n            END IF;\n        END LOOP;\n        RETURN HEX;\n    END IF;\nEND;\n/