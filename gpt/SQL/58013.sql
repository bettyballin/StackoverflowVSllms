-- Example of partitioning the historical table (simplified)\nCREATE PARTITION FUNCTION pfDateRange (datetime)\nAS RANGE RIGHT FOR VALUES ('2020-01-01', '2021-01-01', '2022-01-01');\n\nCREATE PARTITION SCHEME psDateRange\nAS PARTITION pfDateRange\nTO ([PRIMARY], [PRIMARY], [PRIMARY], [PRIMARY]);\n\nCREATE TABLE [dbo].[WeatherMeasurementHistory](\n  MeasurementID [int] Identity(1,1) NOT NULL,\n  TownID [int] NOT NULL,\n  Temp [int] NOT NULL,\n  Date [datetime] NOT NULL\n) ON psDateRange(Date);