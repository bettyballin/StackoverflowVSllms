SELECT m.material_id,\n       (SELECT file_location \n          FROM (SELECT file_location\n                  FROM mat mat_inner\n                 WHERE mat_inner.content_id = m.content_id\n              ORDER BY resolution DESC) special_mats_for_this_content            \n         WHERE rownum = 1) special_mat_file_location                                     \n  FROM mat m\n WHERE m.material_id IN (SELECT material_id \n                           FROM mat mat_sub\n                     INNER JOIN con con_sub ON con_sub.content_id = mat_sub.content_id\n                     INNER JOIN con_groups con_groups_sub ON con_groups_sub.content_id = con_sub.content_id\n                          WHERE con_groups_sub.content_group_id = 10);