WITH NumberedEntries AS (\n    SELECT \n        LogEntry,\n        ROW_NUMBER() OVER (ORDER BY ID) - \n        ROW_NUMBER() OVER (PARTITION BY LogEntry ORDER BY ID) AS GroupID\n    FROM LogEntries\n),\nGroupedEntries AS (\n    SELECT \n        LogEntry,\n        GroupID,\n        COUNT(*) AS EntryCount\n    FROM NumberedEntries\n    GROUP BY LogEntry, GroupID\n)\nSELECT \n    LogEntry,\n    EntryCount\nFROM GroupedEntries\nORDER BY MIN(GroupID)