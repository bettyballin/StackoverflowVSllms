-- Create sales table\nCREATE TABLE Sales(\n    Branch varchar(30) NOT NULL,\n    DateOfSale smalldatetime NOT NULL,\n    SalesAmount money NOT NULL\n);\n\n-- Insert sample data\nINSERT INTO Sales (Branch, DateOfSale, SalesAmount) VALUES ('London','20090714',100);\nINSERT INTO Sales (Branch, DateOfSale, SalesAmount) VALUES ('London','20090715',200);\nINSERT INTO Sales (Branch, DateOfSale, SalesAmount) VALUES ('London','20090716',300);\nINSERT INTO Sales (Branch, DateOfSale, SalesAmount) VALUES ('London','20090717',400);\nINSERT INTO Sales (Branch, DateOfSale, SalesAmount) VALUES ('London','20090718',500);\nINSERT INTO Sales (Branch, DateOfSale, SalesAmount) VALUES ('London','20090719',600);\nINSERT INTO Sales (Branch, DateOfSale, SalesAmount) VALUES ('London','20090720',700);\nINSERT INTO Sales (Branch, DateOfSale, SalesAmount) VALUES ('London','20090706',1000);\nINSERT INTO Sales (Branch, DateOfSale, SalesAmount) VALUES ('London','20090707',1100);\nINSERT INTO Sales (Branch, DateOfSale, SalesAmount) VALUES ('London','20090708',1200);\nINSERT INTO Sales (Branch, DateOfSale, SalesAmount) VALUES ('London','20090709',1300);\nINSERT INTO Sales (Branch, DateOfSale, SalesAmount) VALUES ('London','20090710',1400);\nINSERT INTO Sales (Branch, DateOfSale, SalesAmount) VALUES ('London','20090711',1500);\nINSERT INTO Sales (Branch, DateOfSale, SalesAmount) VALUES ('London','20090712',1600);\nINSERT INTO Sales (Branch, DateOfSale, SalesAmount) VALUES ('London','20090713',1700);\n\n-- Query to get LFL sales\nSELECT\n    current.Branch,\n    current.DateOfSale,\n    current.SalesAmount AS CurrentSales,\n    previous.SalesAmount AS SalesLastYear,\n    (current.SalesAmount - previous.SalesAmount) AS SalesDifference\nFROM\n    Sales current\nJOIN\n    Sales previous\nON\n    current.Branch = previous.Branch\n    AND DATEADD(YEAR, -1, current.DateOfSale) = previous.DateOfSale\nWHERE\n    current.DateOfSale BETWEEN '20090706' AND '20090720'\nORDER BY\n    current.DateOfSale;