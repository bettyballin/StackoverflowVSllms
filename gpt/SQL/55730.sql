-- Use CTE to assign row numbers to ensure deterministic update\nWITH CTE AS (\n    SELECT \n        b.*,\n        p.description,\n        ROW_NUMBER() OVER (PARTITION BY b.id ORDER BY p.description) as rn\n    FROM \n        bundles_denormalized b\n    LEFT JOIN \n        products p\n    ON \n        b.id = p.bundle_id\n)\nUPDATE CTE\nSET category = description\nWHERE rn = 1; -- or any other logic to choose the desired row