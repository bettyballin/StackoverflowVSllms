DECLARE @inputString NVARCHAR(100) = 'foo=abc;bar=def;baz=ghi';\n\n-- Find the starting position of 'bar='\nDECLARE @barStart INT = CHARINDEX('bar=', @inputString);\n\n-- Find the starting position of the value after 'bar='\nDECLARE @valueStart INT = @barStart + LEN('bar=');\n\n-- Find the ending position of the value, which is the next semicolon or the end of the string\nDECLARE @nextSemicolon INT = CHARINDEX(';', @inputString, @valueStart);\nIF @nextSemicolon = 0\n    SET @nextSemicolon = LEN(@inputString) + 1;\n\n-- Extract the value of 'bar'\nDECLARE @barValue NVARCHAR(100) = SUBSTRING(@inputString, @valueStart, @nextSemicolon - @valueStart);\n\nSELECT @barValue AS BarValue;