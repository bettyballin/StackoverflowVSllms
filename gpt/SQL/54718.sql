CREATE PROCEDURE ResolveHostname\n   @hostname NVARCHAR(255)\n   AS\n   BEGIN\n       DECLARE @cmd NVARCHAR(4000);\n       DECLARE @result TABLE (output NVARCHAR(4000));\n       \n       SET @cmd = 'nslookup ' + @hostname;\n       \n       INSERT INTO @result\n       EXEC xp_cmdshell @cmd;\n       \n       SELECT TOP 1 SUBSTRING(output, CHARINDEX('Address: ', output) + 9, 4000) AS ipAddress\n       FROM @result\n       WHERE output LIKE '%Address: %';\n   END;\n   GO