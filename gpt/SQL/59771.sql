select\n    location,\n    count(case when type = 'X' then 1 end) as count_type_x,\n    sum(case when type = 'X' then duration end) as sum_duration_x,\n    count(case when type = 'Y' then 1 end) as count_type_y,\n    sum(case when type = 'Y' then duration end) as sum_duration_y\nfrom \n    my.table\nwhere \n    location = @location\n    and date(some_tstamp) = @date\ngroup by \n    location;