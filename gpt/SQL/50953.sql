MERGE INTO KeyMap km\nUSING (\n  SELECT\n    trunc(s.ID / 100) AS batchID,\n    MAX(CASE WHEN MOD(s.ID, 100) = 1 THEN s.Key ELSE NULL END) AS key1,\n    MAX(CASE WHEN MOD(s.ID, 100) = 2 THEN s.Key ELSE NULL END) AS key2,\n    MAX(CASE WHEN MOD(s.ID, 100) = 3 THEN s.Key ELSE NULL END) AS key3,\n    -- Add more cases for other keys as needed\n    MAX(CASE WHEN MOD(s.ID, 100) = 99 THEN s.Key ELSE NULL END) AS key99\n  FROM\n    Source s\n  GROUP BY\n    trunc(s.ID / 100)\n) src\nON (km.trunc_ID = src.batchID)\nWHEN MATCHED THEN\n  UPDATE SET\n    km.key1 = COALESCE(src.key1, km.key1),\n    km.key2 = COALESCE(src.key2, km.key2),\n    km.key3 = COALESCE(src.key3, km.key3),\n    -- Update more keys as needed\n    km.key99 = COALESCE(src.key99, km.key99);