WITH RecentOrderType1 AS (\n    SELECT \n        userId, orderId AS orderId1, orderType AS orderType1, createDate AS createDate1,\n        ROW_NUMBER() OVER (PARTITION BY userId ORDER BY createDate DESC) AS rn\n    FROM \n        orderData\n    WHERE \n        orderType = '1'\n), RecentOrderType2 AS (\n    SELECT \n        userId, orderId AS orderId2, orderType AS orderType2, createDate AS createDate2,\n        ROW_NUMBER() OVER (PARTITION BY userId ORDER BY createDate DESC) AS rn\n    FROM \n        orderData\n    WHERE \n        orderType = '2'\n)\nSELECT\n    u.userId, u.name, \n    ro1.orderId1, ro1.orderType1, ro1.createDate1,\n    ro2.orderId2, ro2.orderType2, ro2.createDate2\nFROM \n    userData u\nLEFT JOIN \n    RecentOrderType1 ro1 ON u.userId = ro1.userId AND ro1.rn = 1\nLEFT JOIN \n    RecentOrderType2 ro2 ON u.userId = ro2.userId AND ro2.rn = 1;