-- Sum of capacities for each generation of iPods\nSELECT\n    pa2.Value AS Generation,\n    SUM(CAST(pa1.Value AS INT)) AS TotalCapacity\nFROM\n    Product p\n    JOIN ProductAttribute pa1 ON p.ProductID = pa1.ProductID\n    JOIN Attribute a1 ON pa1.AttributeID = a1.AttributeID\n    JOIN ProductAttribute pa2 ON p.ProductID = pa2.ProductID\n    JOIN Attribute a2 ON pa2.AttributeID = a2.AttributeID\nWHERE\n    p.GroupID = 1 -- Ipods\n    AND a1.AttributeName = 'capacity'\n    AND a2.AttributeName = 'generation'\nGROUP BY\n    pa2.Value;