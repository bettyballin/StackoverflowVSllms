BEGIN TRANSACTION;\n\n-- Update Numbering and capture the new AutoKey values\nDECLARE @AutoKeyTable TABLE (AutoKey INT);\n\nUPDATE Numbering\nSET AutoKey = AutoKey + 1\nOUTPUT inserted.AutoKey INTO @AutoKeyTable\nWHERE ObjectCode = 4;\n\n-- Insert into Temp2 using the updated AutoKey values\nINSERT INTO Temp2 (id, fkTemp1, data)\nSELECT ak.AutoKey, t1.id, t1.data\nFROM Temp1 t1\nLEFT JOIN Temp2 t2 ON t2.fkTemp1 = t1.id\nCROSS JOIN @AutoKeyTable ak\nWHERE t2.id IS NULL;\n\nCOMMIT TRANSACTION;