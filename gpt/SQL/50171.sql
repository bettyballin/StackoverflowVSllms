WITH RECURSIVE sequence AS (\n    SELECT WebStoreID, MIN(webordernumber) AS n\n    FROM orders\n    WHERE ordertype = 'WEB'\n    GROUP BY WebStoreID\n    UNION ALL\n    SELECT s.WebStoreID, s.n + 1\n    FROM sequence s\n    JOIN (\n        SELECT WebStoreID, MAX(webordernumber) AS max_webordernumber\n        FROM orders\n        WHERE ordertype = 'WEB'\n        GROUP BY WebStoreID\n    ) m\n    ON s.WebStoreID = m.WebStoreID AND s.n < m.max_webordernumber\n)\nSELECT s.WebStoreID, s.n AS missing_order_number\nFROM sequence s\nLEFT JOIN orders o\nON s.WebStoreID = o.WebStoreID AND s.n = o.webordernumber\nWHERE o.webordernumber IS NULL\nORDER BY s.WebStoreID, s.n;