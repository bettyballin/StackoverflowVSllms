DECLARE @SourcePrincipal NVARCHAR(128) = 'sourceUserOrRole';\nDECLARE @TargetPrincipal NVARCHAR(128) = 'targetUserOrRole';\nDECLARE @SQL NVARCHAR(MAX) = '';\n\n-- Generate GRANT statements based on existing permissions\nSELECT @SQL = @SQL + 'GRANT ' + dp.permission_name + ' ON ' + \n                CASE \n                    WHEN o.type IS NOT NULL THEN QUOTENAME(s.name) + '.' + QUOTENAME(o.name)\n                    ELSE 'SCHEMA::' + QUOTENAME(s.name)\n                END + \n                ' TO ' + QUOTENAME(@TargetPrincipal) + ';' + CHAR(13) + CHAR(10)\nFROM sys.database_permissions dp\nLEFT JOIN sys.objects o ON dp.major_id = o.object_id\nLEFT JOIN sys.schemas s ON ISNULL(o.schema_id, dp.major_id) = s.schema_id\nWHERE dp.grantee_principal_id = USER_ID(@SourcePrincipal);\n\n-- Print the generated SQL for review\nPRINT @SQL;\n\n-- Execute the generated SQL to apply the permissions\n-- EXEC sp_executesql @SQL;