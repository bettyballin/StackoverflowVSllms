DECLARE\n    TYPE table_array IS TABLE OF VARCHAR2(100);\n    tables table_array := table_array('TABLE1', 'TABLE2', 'TABLE3'); -- Add your table names here\n    v_file UTL_FILE.FILE_TYPE;\n    v_line VARCHAR2(32767);\n    v_query VARCHAR2(32767);\n    v_col_list VARCHAR2(32767);\n    v_table VARCHAR2(100);\nBEGIN\n    -- Loop through each table\n    FOR i IN tables.FIRST .. tables.LAST LOOP\n        v_table := tables(i);\n\n        -- Generate column list for the current table\n        SELECT LISTAGG(column_name, '", "') WITHIN GROUP (ORDER BY column_id)\n        INTO v_col_list\n        FROM all_tab_columns\n        WHERE table_name = v_table;\n\n        -- Open the file for writing\n        v_file := UTL_FILE.FOPEN('DATA_DIR', v_table || '.csv', 'w');\n\n        -- Write column headers to the file\n        v_line := '"' || REPLACE(v_col_list, ',', '","') || '"';\n        UTL_FILE.PUT_LINE(v_file, v_line);\n\n        -- Construct the dynamic query to fetch all rows\n        v_query := 'SELECT ' || v_col_list || ' FROM ' || v_table;\n\n        EXECUTE IMMEDIATE v_query BULK COLLECT INTO v_data;\n\n        -- Loop through each row and write to the file\n        FOR j IN v_data.FIRST .. v_data.LAST LOOP\n            v_line := '"' || REPLACE(v_data(j), ',', '"|"') || '"';\n            UTL_FILE.PUT_LINE(v_file, v_line);\n        END LOOP;\n\n        -- Close the file\n        UTL_FILE.FCLOSE(v_file);\n    END LOOP;\nEND;\n/