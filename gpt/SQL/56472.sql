ALTER PROCEDURE [RetailAdmin].[TitleSearch] (\n        @isbn VARCHAR(50), \n        @author VARCHAR(50), \n        @title VARCHAR(50)\n    )\n    AS\n    BEGIN\n        DECLARE @L_isbn VARCHAR(50)\n        DECLARE @l_author VARCHAR(50)\n        DECLARE @l_title VARCHAR(50)\n        DECLARE @sql NVARCHAR(4000)\n\n        SET @L_isbn = RTRIM(LTRIM(@isbn))\n        SET @l_author = RTRIM(LTRIM(@author))\n        SET @l_title = RTRIM(LTRIM(@title))\n\n        CREATE TABLE #mytemp(\n            [storeid] INT NOT NULL,\n            [Author] [VARCHAR](100) NULL,\n            [Title] [VARCHAR](400) NULL,\n            [ISBN] [VARCHAR](50) NULL,\n            [Imprint] [VARCHAR](255) NULL,\n            [Edition] [VARCHAR](255) NULL,\n            [Copyright] [VARCHAR](100) NULL,\n            [stockonhand] [INT] NULL\n        )\n\n        SET @sql = 'SELECT a.storeid, Author, Title, thirteendigitisbn ISBN, \n                    Imprint, Edition, Copyright, b.stockonhand \n                    FROM ods.items a \n                    JOIN ods.inventory b ON a.itemkey = b.itemkey \n                    WHERE b.stockonhand <> 0'\n\n        IF LEN(@l_author) > 0\n            SET @sql = @sql + ' AND author LIKE ''%' + @L_author + '%'''\n\n        IF LEN(@l_title) > 0\n            SET @sql = @sql + ' AND title LIKE ''%' + @l_title + '%'''\n\n        IF LEN(@L_isbn) > 0\n            SET @sql = @sql + ' AND thirteendigitisbn LIKE ''%' + @L_isbn + '%'''\n\n        PRINT @sql\n\n        IF LEN(@l_author) <> 0 OR LEN(@l_title) <> 0 OR LEN(@L_isbn) <> 0\n        BEGIN\n            INSERT INTO #mytemp\n            EXECUTE sp_executesql @sql\n        END\n\n        SELECT * FROM #mytemp\n        DROP TABLE #mytemp\n    END