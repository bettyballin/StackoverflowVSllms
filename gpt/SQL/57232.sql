-- Start a transaction\nSTART TRANSACTION;\n\n-- Select and lock the rows\nSELECT url FROM urls\nWHERE task_assigned IS NULL\nORDER BY id\nLIMIT 100\nFOR UPDATE;\n\n-- Update the selected rows\nUPDATE urls\nSET task_assigned = NOW()\nWHERE task_assigned IS NULL\nAND url IN (SELECT url FROM (SELECT url FROM urls WHERE task_assigned IS NULL ORDER BY id LIMIT 100) AS temp);\n\n-- Commit the transaction\nCOMMIT;