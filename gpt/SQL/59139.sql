WITH RECURSIVE CategoryHierarchy AS (\n    SELECT category_id, category_name, parent_id\n    FROM categories\n    WHERE category_id = ?\n\n    UNION ALL\n\n    SELECT c.category_id, c.category_name, c.parent_id\n    FROM categories c\n    INNER JOIN CategoryHierarchy ch ON ch.category_id = c.parent_id\n)\nSELECT i.item_id, i.item_name\nFROM items i\nINNER JOIN item_category ic ON i.item_id = ic.item_id\nINNER JOIN CategoryHierarchy ch ON ic.category_id = ch.category_id;