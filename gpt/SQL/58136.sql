WITH RECURSIVE category_hierarchy AS (\n    -- Anchor member: start with the given category\n    SELECT category_id\n    FROM categories\n    WHERE category_id = ?\n\n    UNION ALL\n\n    -- Recursive member: get all sub-categories\n    SELECT c.category_id\n    FROM categories c\n    JOIN category_hierarchy ch ON c.parent_id = ch.category_id\n)\nSELECT DISTINCT o.organization_id, o.organization_name\nFROM organizations o\nJOIN organizations_categories oc ON o.organization_id = oc.organization_id\nJOIN category_hierarchy ch ON oc.category_id = ch.category_id;