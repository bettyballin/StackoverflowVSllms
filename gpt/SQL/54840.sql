WITH RECURSIVE CategoryTree AS (\n    -- Base case: select the category with the given name\n    SELECT id, name, parent_id\n    FROM categories\n    WHERE name = 'Toys'\n    \n    UNION ALL\n    \n    -- Recursive case: select all subcategories of the current category\n    SELECT c.id, c.name, c.parent_id\n    FROM categories c\n    INNER JOIN CategoryTree ct ON c.parent_id = ct.id\n)\nSELECT p.*\nFROM products p\nINNER JOIN CategoryTree ct ON p.category_id = ct.id\nORDER BY p.hits DESC\nLIMIT 10;