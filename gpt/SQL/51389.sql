CREATE PROCEDURE ImportGsmProfile\n   AS\n   BEGIN\n       DECLARE @maxSenderCode INT;\n\n       -- Get the current maximum sendercode value from the main table\n       SELECT @maxSenderCode = MAX(CAST(sendercode AS INT))\n       FROM [dbo].[mw_gsmprofile];\n\n       -- If no records exist, start from 1\n       IF @maxSenderCode IS NULL\n           SET @maxSenderCode = 0;\n\n       -- Insert data from staging table to main table with incremented sendercode\n       INSERT INTO [dbo].[mw_gsmprofile] (\n           [cedeviceid], [vanwarehouse], [username], [devicesimnumber], [UserGroup], [ServiceMgr], [sendercode]\n       )\n       SELECT \n           [cedeviceid], \n           [vanwarehouse], \n           [username], \n           [devicesimnumber], \n           [UserGroup], \n           [ServiceMgr], \n           RIGHT('00000' + CAST((@maxSenderCode + ROW_NUMBER() OVER (ORDER BY (SELECT NULL))) AS VARCHAR), 5)\n       FROM \n           [dbo].[staging_mw_gsmprofile];\n\n       -- Clear staging table\n       TRUNCATE TABLE [dbo].[staging_mw_gsmprofile];\n   END;