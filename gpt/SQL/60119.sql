WITH CustomerTransactions AS (\n  SELECT \n    customerName, \n    customerId,\n    (\n      SELECT COUNT(*) \n      FROM Purchases \n      WHERE Purchases.customerId = customerData.customerId\n    ) AS numberTransactions\n  FROM customerData\n)\nSELECT \n  customerName, \n  customerId,\n  numberTransactions\nFROM CustomerTransactions\nORDER BY numberTransactions;