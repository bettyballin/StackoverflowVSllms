CREATE FUNCTION dbo.StripHTML(@HTML NVARCHAR(MAX))\nRETURNS NVARCHAR(MAX)\nAS\nBEGIN\n    DECLARE @Start INT\n    DECLARE @End INT\n    DECLARE @Length INT\n\n    SET @Start = CHARINDEX('<', @HTML)\n    SET @End = CHARINDEX('>', @HTML, CHARINDEX('<', @HTML))\n    SET @Length = LEN(@HTML)\n\n    WHILE @Start > 0 AND @End > 0 AND @Start < @End\n    BEGIN\n        SET @HTML = STUFF(@HTML, @Start, @End - @Start + 1, '')\n        SET @Start = CHARINDEX('<', @HTML)\n        SET @End = CHARINDEX('>', @HTML, CHARINDEX('<', @HTML))\n    END\n\n    -- Replace HTML entities with their corresponding characters\n    SET @HTML = REPLACE(@HTML, '&lt;', '<')\n    SET @HTML = REPLACE(@HTML, '&gt;', '>')\n    SET @HTML = REPLACE(@HTML, '&nbsp;', ' ')\n    SET @HTML = REPLACE(@HTML, '&amp;', '&')\n    SET @HTML = REPLACE(@HTML, '&quot;', '"')\n    SET @HTML = REPLACE(@HTML, '&apos;', '''')\n\n    RETURN LTRIM(RTRIM(@HTML))\nEND\nGO