WITH Bigrams AS (\n    SELECT \n        w1.DocID,\n        w1.WordID AS Word1ID,\n        w2.WordID AS Word2ID\n    FROM \n        YourTable w1\n    INNER JOIN \n        YourTable w2\n    ON \n        w1.DocID = w2.DocID \n        AND w1.Location = w2.Location - 1\n)\nSELECT \n    Word1ID, \n    Word2ID, \n    COUNT(*) AS BigramCount\nFROM \n    Bigrams\nGROUP BY \n    Word1ID, \n    Word2ID\nORDER BY \n    BigramCount DESC;