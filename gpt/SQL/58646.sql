-- Step 1: Create a new table to hold the merged records temporarily\nCREATE TABLE merged_records AS\nSELECT MIN(id) as id, name, SUM(count) as count\nFROM your_table\nGROUP BY name;\n\n-- Step 2: Update the foreign key references in other tables\n-- Assuming you have a foreign key in other_table1, other_table2 etc.\nUPDATE other_table1 ot1\nJOIN your_table yt ON ot1.foreign_key_column = yt.id\nJOIN merged_records mr ON yt.name = mr.name\nSET ot1.foreign_key_column = mr.id;\n\n-- Repeat the above update for other tables, e.g.,\nUPDATE other_table2 ot2\nJOIN your_table yt ON ot2.foreign_key_column = yt.id\nJOIN merged_records mr ON yt.name = mr.name\nSET ot2.foreign_key_column = mr.id;\n\n-- Step 3: Remove the duplicates from the original table\nDELETE yt\nFROM your_table yt\nLEFT JOIN merged_records mr ON yt.id = mr.id\nWHERE mr.id IS NULL;\n\n-- Step 4: Insert the merged records back into the original table\nINSERT INTO your_table (id, name, count)\nSELECT id, name, count\nFROM merged_records;\n\n-- Step 5: Drop the temporary merged_records table\nDROP TABLE merged_records;