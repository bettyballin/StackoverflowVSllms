-- Declare variables\nDECLARE @OldTableName NVARCHAR(255) = 'tblFoo';\nDECLARE @NewTableName NVARCHAR(255) = 'tblFooBar';\nDECLARE @sql NVARCHAR(MAX);\n\n-- Rename the table\nSET @sql = 'EXEC sp_rename ''' + @OldTableName + ''', ''' + @NewTableName + ''';';\nEXEC sp_executesql @sql;\n\n-- Rename the primary key constraint\nSET @sql = '\nDECLARE @PKName NVARCHAR(255);\nSELECT @PKName = name \nFROM sys.key_constraints \nWHERE parent_object_id = OBJECT_ID(''' + @NewTableName + ''') AND type = ''PK'';\nEXEC sp_rename @PKName, ''PK_' + @NewTableName + ''';\n';\nEXEC sp_executesql @sql;\n\n-- Rename foreign key constraints\nDECLARE fk_cursor CURSOR FOR\nSELECT fk.name AS ForeignKeyName, t.name AS TableName\nFROM sys.foreign_keys AS fk\nINNER JOIN sys.tables AS t\nON fk.parent_object_id = t.object_id\nWHERE fk.referenced_object_id = OBJECT_ID(@NewTableName);\n\nDECLARE @ForeignKeyName NVARCHAR(255);\nDECLARE @TableName NVARCHAR(255);\n\nOPEN fk_cursor;\nFETCH NEXT FROM fk_cursor INTO @ForeignKeyName, @TableName;\n\nWHILE @@FETCH_STATUS = 0\nBEGIN\n    SET @sql = 'EXEC sp_rename ''' + @ForeignKeyName + ''', ''FK_' + @TableName + '_' + @NewTableName + ''';';\n    EXEC sp_executesql @sql;\n\n    FETCH NEXT FROM fk_cursor INTO @ForeignKeyName, @TableName;\nEND\n\nCLOSE fk_cursor;\nDEALLOCATE fk_cursor;