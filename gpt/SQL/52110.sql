select top 1\n    ml.*\nfrom MessageLookup ml\nwhere ml.[Key] = @Key\nand ml.CampaignTypeID = @CampaignTypeID\nand\n(\n    ml.ServiceProviderID = @ServiceProviderID or\n    ml.ServiceProviderID is null\n)\nand\n(\n    ml.DistributorID = @DistributorID or\n    ml.DistributorID is null\n)\nand\n(\n    ml.CampaignID = @CampaignID or\n    ml.CampaignID is null\n)\norder by\n    case\n        when ml.CampaignID is not null then 1 else 0\n    end desc,\n    case\n        when ml.DistributorID is not null then 1 else 0\n    end desc,\n    case\n        when ml.ServiceProviderID is not null then 1 else 0\n    end desc