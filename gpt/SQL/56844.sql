SELECT\n    m.id,\n    a.type_id,\n    a.assign_id\nFROM\n    master m\nJOIN\n    assignment a ON m.id = a.id\nJOIN\n    type t ON a.type_id = t.type_id\nWHERE\n    (m.id, t.create_date) IN (\n        SELECT\n            a.id,\n            MAX(t.create_date)\n        FROM\n            assignment a\n        JOIN\n            type t ON a.type_id = t.type_id\n        GROUP BY\n            a.id\n    )\nORDER BY\n    m.id;