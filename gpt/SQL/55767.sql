SET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO    \nALTER FUNCTION [dbo].[IP4toBIGINT](\n    @ip4 varchar(15)\n) \nRETURNS bigint\nWITH SCHEMABINDING\nAS\nBEGIN\n    DECLARE @oct0 bigint, @oct1 bigint, @oct2 bigint, @oct3 bigint;\n    DECLARE @Result bigint;\n\n    IF @ip4 IS NOT NULL AND @ip4 LIKE '[0-9]%.[0-9]%.[0-9]%.[0-9]%'\n    BEGIN\n        SET @oct3 = CAST(PARSENAME(@ip4, 4) as tinyint);\n        SET @oct2 = CAST(PARSENAME(@ip4, 3) as tinyint);\n        SET @oct1 = CAST(PARSENAME(@ip4, 2) as tinyint);\n        SET @oct0 = CAST(PARSENAME(@ip4, 1) as tinyint);\n\n        SET @Result = @oct3 * 16777216 + @oct2 * 65536 + @oct1 * 256 + @oct0;\n    END\n    ELSE\n    BEGIN\n        SET @Result = NULL; -- or any default value you prefer\n    END\n\n    RETURN @Result;\nEND