USE [EBDB]\nGO\n/****** Object:  StoredProcedure [dbo].[delete_treatment_category]    Script Date: 01/02/2009 15:18:12 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nALTER PROCEDURE [dbo].[delete_treatment_category]\n(\n    @id INT,\n    @RetVal INT OUTPUT\n)\nAS\nBEGIN\n    SET NOCOUNT ON;\n\n    IF EXISTS\n    (\n        SELECT id\n        FROM dbo.treatment_item\n        WHERE category_id = @id\n    )\n    BEGIN\n        SET @RetVal = 1;\n    END\n    ELSE\n    BEGIN\n        BEGIN TRY\n            DELETE FROM dbo.treatment_category\n            WHERE id = @id;\n\n            SET @RetVal = 0;  -- Success\n        END TRY\n        BEGIN CATCH\n            SET @RetVal = 2;  -- Error\n        END CATCH;\n    END\nEND