-- Assuming @SourcePerson and @DestPerson are your input parameters\n\n-- Step 1: Delete potential duplicates\nWITH DuplicateRecords AS (\n    SELECT ListID\n    FROM MailingListSubscription\n    WHERE PersonID = @SourcePerson\n    AND ListID IN (\n        SELECT ListID\n        FROM MailingListSubscription\n        WHERE PersonID = @DestPerson\n    )\n)\nDELETE FROM MailingListSubscription\nWHERE PersonID = @SourcePerson\nAND ListID IN (SELECT ListID FROM DuplicateRecords);\n\n-- Step 2: Update remaining records\nUPDATE MailingListSubscription\nSET PersonID = @DestPerson\nWHERE PersonID = @SourcePerson;