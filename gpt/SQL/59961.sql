WITH CTE AS (\n    SELECT \n        timestamp, \n        value, \n        LAG(value) OVER (ORDER BY timestamp) AS LastValue\n    FROM \n        your_table_name\n)\nSELECT \n    timestamp, \n    value, \n    LastValue, \n    CASE \n        WHEN LastValue IS NULL THEN 0\n        ELSE value - LastValue \n    END AS Delta\nFROM \n    CTE\nWHERE \n    value > LastValue OR LastValue IS NULL