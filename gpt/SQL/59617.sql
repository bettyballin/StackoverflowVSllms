SELECT COUNT(*)\nFROM (\n    SELECT [colnames]\n    FROM [tables with joins]\n    WHERE [constraints]\n    GROUP BY [cols]\n) t;