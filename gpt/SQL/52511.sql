-- Sample data setup for Fish and FishProperty tables\nCREATE TABLE Fish (\n    ID INT,\n    Name VARCHAR(50)\n);\n\nCREATE TABLE FishProperty (\n    ID INT,\n    FishID INT,\n    Property VARCHAR(50),\n    Value INT\n);\n\nINSERT INTO Fish (ID, Name) VALUES (1, 'Jack'), (2, 'Trout'), (3, 'Bass'), (4, 'Cat');\nINSERT INTO FishProperty (ID, FishID, Property, Value) VALUES \n(1, 1, 'Length', 10),\n(2, 1, 'Girth', 6),\n(3, 1, 'Weight', 4),\n(4, 2, 'Length', 6),\n(5, 2, 'Weight', 2),\n(6, 3, 'Girth', 12);\n\n-- Crosstab query using PIVOT\nSELECT\n    f.ID,\n    f.Name,\n    p.Length,\n    p.Girth,\n    p.Weight\nFROM\n    Fish f\nLEFT JOIN (\n    SELECT\n        FishID,\n        MAX(CASE WHEN Property = 'Length' THEN Value END) AS Length,\n        MAX(CASE WHEN Property = 'Girth' THEN Value END) AS Girth,\n        MAX(CASE WHEN Property = 'Weight' THEN Value END) AS Weight\n    FROM\n        FishProperty\n    GROUP BY\n        FishID\n) p ON f.ID = p.FishID;