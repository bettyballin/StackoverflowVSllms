DECLARE @TotalCount INT;\n\nWITH SelectedItems AS\n(\n    SELECT Id, Row1, Row2, ROW_NUMBER() OVER (ORDER BY Row1) AS Position\n    FROM Items\n    WHERE Row2 = @Row2\n)\nSELECT \n    Id, \n    Row1, \n    Row2\nINTO #TempResults\nFROM SelectedItems\nWHERE Position BETWEEN @From AND @To;\n\nSELECT @TotalCount = COUNT(*)\nFROM SelectedItems;\n\n-- Now you can return the results and the total count\nSELECT Id, Row1, Row2\nFROM #TempResults;\n\n-- Set the OUTPUT parameter\nSET @OutputTotalCount = @TotalCount;\n\n-- Clean up temporary table\nDROP TABLE #TempResults;