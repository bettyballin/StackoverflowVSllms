WITH PivotData AS (\n  SELECT \n    c.COMPANY_NAME,\n    pa.SHORT_NAME,\n    ps.SALE_COUNT\n  FROM \n    COMPANY c\n  JOIN \n    PRODUCT_SALE ps ON c.ID_COMPANY = ps.ID_COMPANY\n  JOIN \n    ProductAlias pa ON ps.ID_PRODUCT = pa.ID_PRODUCT\n)\nSELECT * FROM PivotData\nPIVOT (\n  SUM(SALE_COUNT)\n  FOR SHORT_NAME IN ('ShortName1' AS ShortName1, 'ShortName2' AS ShortName2, 'ShortName3' AS ShortName3)\n);