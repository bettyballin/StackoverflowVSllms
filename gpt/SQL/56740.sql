SELECT \n  team_id,\n  SUM(home_games) AS home_games,\n  SUM(away_games) AS away_games\nFROM (\n  SELECT home_team_id AS team_id, COUNT(*) AS home_games, 0 AS away_games\n  FROM `game`\n  GROUP BY home_team_id\n  UNION ALL\n  SELECT away_team_id AS team_id, 0 AS home_games, COUNT(*) AS away_games\n  FROM `game`\n  GROUP BY away_team_id\n) AS combined\nGROUP BY team_id\nORDER BY team_id;