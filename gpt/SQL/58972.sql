WITH LatestProjectThingLink AS (\n    SELECT \n        ptl.ProjectID,\n        ptl.ThingID,\n        ptl.CreatedDate,\n        ROW_NUMBER() OVER (PARTITION BY ptl.ThingID ORDER BY ptl.CreatedDate DESC) AS rn\n    FROM \n        ProjectThingLink ptl\n)\nSELECT \n    p.ProjectID,\n    p.ProjectName,\n    t.ThingID,\n    t.ThingName\nFROM \n    LatestProjectThingLink lptl\nJOIN \n    Project p ON lptl.ProjectID = p.ProjectID\nJOIN \n    Thing t ON lptl.ThingID = t.ThingID\nWHERE \n    lptl.rn = 1\nORDER BY \n    p.ProjectID, t.ThingID;