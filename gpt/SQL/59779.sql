CREATE OR REPLACE FUNCTION validate_path() RETURNS TRIGGER AS $$\nDECLARE\n    parent_id INT;\nBEGIN\n    IF NEW.path IS NULL OR NEW.path = '' THEN\n        RAISE EXCEPTION 'Path cannot be NULL or empty';\n    END IF;\n\n    parent_id := (SELECT id FROM tree WHERE path = substring(NEW.path FROM 1 FOR length(NEW.path) - POSITION('/' IN REVERSE(NEW.path))));\n\n    IF parent_id IS NULL AND NEW.path <> NEW.id::TEXT THEN\n        RAISE EXCEPTION 'Invalid path: Parent does not exist';\n    END IF;\n\n    RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;