CREATE TRIGGER trg_check_ip\nON ALL SERVER\nFOR LOGON\nAS\nBEGIN\n    DECLARE @ip_address NVARCHAR(45);\n    DECLARE @login_name NVARCHAR(128);\n\n    -- Fetch the IP address and login name of the current connection\n    SET @ip_address = (SELECT client_net_address\n                       FROM sys.dm_exec_connections\n                       WHERE session_id = @@SPID);\n\n    SET @login_name = ORIGINAL_LOGIN();\n\n    -- Check if the login is the one to be restricted and if the IP is allowed\n    IF (@login_name = 'YourSQLLogin')\n    BEGIN\n        IF NOT EXISTS (SELECT 1 FROM AllowedIPs WHERE LoginName = @login_name AND IPAddress = @ip_address)\n        BEGIN\n            -- If IP is not allowed, rollback the connection to prevent login\n            ROLLBACK;\n        END\n    END\nEND;