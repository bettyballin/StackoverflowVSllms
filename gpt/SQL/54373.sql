WITH RankedSubmissions AS (\n    SELECT \n        p.person_name,\n        i.item_type,\n        COUNT(i.item_id) AS item_count,\n        RANK() OVER (PARTITION BY i.item_type ORDER BY COUNT(i.item_id) DESC) AS rank\n    FROM \n        items i\n    JOIN \n        person p ON i.person_id = p.person_id\n    WHERE \n        i.item_date BETWEEN '2023-01-01' AND '2023-12-31' -- Adjust the date range as needed\n    GROUP BY \n        p.person_name, i.item_type\n)\nSELECT \n    person_name,\n    item_type,\n    item_count\nFROM \n    RankedSubmissions\nWHERE \n    rank <= 2\nORDER BY \n    item_type, rank;