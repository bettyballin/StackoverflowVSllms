-- Retrieves data on jobs that completed/completed with errors during a given time span.\nDECLARE @Hour NVARCHAR(2)\nDECLARE @TimeFrame NVARCHAR(2)\nDECLARE @TimeSpan INTEGER\n\n-- Defaults\nSET @TimeSpan = 24\nSET @TimeFrame = 'AM'\nSET @Hour = '08'\n\nDECLARE @dateStart DATETIME\nDECLARE @dateEnd DATETIME\nDECLARE @currentDateTime DATETIME\nDECLARE @endDateTime DATETIME\n\n-- Get current date and time\nSET @currentDateTime = GETDATE()\n\n-- Calculate the end date and time based on the specified hour and timeframe\nSET @endDateTime = CAST(CONVERT(VARCHAR(10), @currentDateTime, 120) + ' ' + @Hour + ':00:00 ' + @TimeFrame AS DATETIME)\n\n-- Adjust endDateTime if current time is before the specified hour\nIF @currentDateTime < @endDateTime\nBEGIN\n    SET @endDateTime = DATEADD(DAY, -1, @endDateTime)\nEND\n\n-- Calculate the start date and time based on the TimeSpan\nSET @dateStart = DATEADD(HOUR, -@TimeSpan, @endDateTime)\nSET @dateEnd = @endDateTime\n\n-- Print for debugging\nPRINT 'Start Date: ' + CONVERT(VARCHAR, @dateStart)\nPRINT 'End Date: ' + CONVERT(VARCHAR, @dateEnd)\n\n-- Your query to retrieve the data\n-- SELECT * FROM Jobs WHERE CompletionTime BETWEEN @dateStart AND @dateEnd