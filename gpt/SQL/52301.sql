WITH GroupedData AS (\n    SELECT \n        [GROUP],\n        STUFF((\n            SELECT ', ' + VALUE\n            FROM YourTable AS T2\n            WHERE T2.[GROUP] = T1.[GROUP] AND T2.ID IN (3, 4)\n            FOR XML PATH(''), TYPE).value('.', 'NVARCHAR(MAX)'), 1, 2, '') + \n        ' (' + \n        STUFF((\n            SELECT '' + VALUE\n            FROM YourTable AS T3\n            WHERE T3.[GROUP] = T1.[GROUP] AND T3.ID = 5\n            FOR XML PATH(''), TYPE).value('.', 'NVARCHAR(MAX)'), 1, 0, '') + ')' AS NEWVALUE\n    FROM YourTable AS T1\n    GROUP BY [GROUP]\n)\nSELECT \n    NEWVALUE,\n    [GROUP]\nFROM GroupedData;