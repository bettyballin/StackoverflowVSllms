SELECT DISTINCT pat.PublicationID\nFROM dbo.PubAdvTransData AS pat\nINNER JOIN dbo.PubAdvertiser AS pa ON pat.AdvTransID = pa.AdvTransID\nWHERE pa.AdvertiserID = 31331\nAND pat.LastAdDate > '2009-07-01'\n\nUNION\n\nSELECT DISTINCT AreaBuy.AreaBuyID AS PublicationID\nFROM AreaBuy\nINNER JOIN PublicationAreaBuy ON AreaBuy.AreaBuyID = PublicationAreaBuy.AreaBuyID\nINNER JOIN dbo.PubAdvertiser AS PubAdvertiser_1 ON PubAdvertiser_1.PublicationID = PublicationAreaBuy.PublicationID\nWHERE PubAdvertiser_1.AdvertiserID = 31331\nAND PublicationAreaBuy.PublicationID IN (\n    SELECT pat.PublicationID\n    FROM dbo.PubAdvTransData AS pat\n    WHERE pat.LastAdDate > '2009-07-01'\n)\n\nORDER BY PublicationID;