SELECT \n    b.boardname,\n    COUNT(DISTINCT t.topicid) AS topics,\n    COUNT(m.messageid) AS messages,\n    lauthor,\n    ldate,\n    ltopicname\nFROM \n    boards b\nINNER JOIN\n    topics t ON t.boardid = b.boardid\nINNER JOIN \n    (SELECT \n        m1.topicid,\n        m1.author AS lauthor,\n        m1.date AS ldate,\n        t1.topicname AS ltopicname\n     FROM \n        messages m1\n     INNER JOIN \n        (SELECT \n            topicid,\n            MAX(date) AS maxdate\n         FROM \n            messages\n         GROUP BY \n            topicid) m2 \n     ON m1.topicid = m2.topicid AND m1.date = m2.maxdate\n     INNER JOIN \n        topics t1 ON m1.topicid = t1.topicid) lm \nON t.topicid = lm.topicid\nLEFT JOIN \n    messages m ON t.topicid = m.topicid\nGROUP BY \n    b.boardid, b.boardname, lm.lauthor, lm.ldate, lm.ltopicname\nORDER BY \n    b.boardname;