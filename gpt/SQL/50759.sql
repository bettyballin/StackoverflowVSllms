-- Update existing rows in TableA with matching ids from #TableB\nUPDATE TableA\nSET TableA.column1 = #TableB.column1,\n    TableA.column2 = #TableB.column2,\n    -- Add all other columns you need to update\nFROM TableA\nINNER JOIN #TableB ON TableA.id = #TableB.id;\n\n-- Insert new rows from #TableB that do not exist in TableA\nINSERT INTO TableA (columns)\nSELECT columns\nFROM #TableB\nWHERE NOT EXISTS (SELECT 1 FROM TableA WHERE TableA.id = #TableB.id);