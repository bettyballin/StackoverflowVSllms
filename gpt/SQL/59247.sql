-- Create a view to pivot the contact attributes\nCREATE VIEW contact_profile_view AS\nSELECT \n    cp.id AS profile_id,\n    MAX(CASE WHEN ca.type = 'email' THEN ca.value ELSE NULL END) AS email,\n    MAX(CASE WHEN ca.type = 'name' THEN ca.value ELSE NULL END) AS name,\n    MAX(CASE WHEN ca.type = 'website' THEN ca.value ELSE NULL END) AS website,\n    GROUP_CONCAT(CASE WHEN ca.type = 'phone' THEN ca.value ELSE NULL END) AS phone,\n    GROUP_CONCAT(CASE WHEN ca.type = 'fax' THEN ca.value ELSE NULL END) AS fax\nFROM \n    contact_profiles cp\nLEFT JOIN \n    contact_attributes ca ON cp.id = ca.profile\nGROUP BY \n    cp.id;