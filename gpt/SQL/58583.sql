SET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n-- =============================================\n-- Author:      Anthony Main\n-- Create date: 18/11/08\n-- Description: Produce Table of Dates for Month\n-- =============================================\nCREATE FUNCTION CalendarTable\n(   \n    @StartDate DATETIME,\n    @EndDate DATETIME\n)\nRETURNS @Calendar TABLE \n(\n    DateValue DATETIME,\n    [day of year] INT,\n    [day] NVARCHAR(30),\n    [day of week] INT,\n    [day of month] INT,\n    [week] INT,\n    [month] INT,\n    [month] NVARCHAR(30),\n    [quarter] INT,\n    [year] INT,\n    [HOUR] INT,\n    [MIN] INT,\n    [SEC] INT,\n    [MILLISECOND] INT\n)\nAS\nBEGIN\n    WITH MyCalendar AS\n    (\n        SELECT CAST(@StartDate AS DATETIME) AS DateValue\n        UNION ALL\n        SELECT DateValue + 1\n        FROM MyCalendar   \n        WHERE DateValue + 1 <= @EndDate\n    )\n    INSERT INTO @Calendar\n    SELECT  DateValue,\n            DATEPART(dy, DateValue) AS [day of year],\n            DATENAME(dw, DateValue) AS [day],\n            DATEPART(dw, DateValue-1) AS [day of week],\n            DATEPART(dd, DateValue) AS [day of month],\n            DATEPART(ww, DateValue) AS [week],\n            DATEPART(mm, DateValue) AS [month],\n            DATENAME(mm, DateValue) AS [month],\n            DATEPART(qq, DateValue) AS [quarter],\n            DATEPART(yy, DateValue) AS [year],\n            DATEPART(HH, DateValue) AS [HOUR],\n            DATEPART(MI, DateValue) AS [MIN],\n            DATEPART(SS, DateValue) AS [SEC],\n            DATEPART(MS, DateValue) AS [MILLISECOND]\n    FROM MyCalendar\n    OPTION (MAXRECURSION 100);\n\n    RETURN;\nEND\nGO