DECLARE @cols AS NVARCHAR(MAX),\n        @query AS NVARCHAR(MAX);\n\n-- Step 1: Get the distinct concatenated TYPE and SUBTYPE values\nSELECT @cols = STUFF((SELECT DISTINCT ',' + QUOTENAME(TYPE + '_' + SUBTYPE)\n                      FROM your_table\n                      FOR XML PATH(''), TYPE\n                     ).value('.', 'NVARCHAR(MAX)'), 1, 1, '');\n\n-- Step 2: Build the dynamic SQL query\nSET @query = 'SELECT ID, MONTH, ' + @cols + '\n             FROM \n             (\n                SELECT ID, \n                       TYPE + ''_'' + SUBTYPE AS TypeSubtype, \n                       COUNT, \n                       MONTH\n                FROM your_table\n             ) x\n             PIVOT \n             (\n                SUM(COUNT)\n                FOR TypeSubtype IN (' + @cols + ')\n             ) p \n             ORDER BY ID, MONTH';\n\n-- Step 3: Execute the dynamic SQL query\nEXEC sp_executesql @query;