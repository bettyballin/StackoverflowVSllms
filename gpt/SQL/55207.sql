CREATE FUNCTION dbo.Split\n(\n    @String VARCHAR(8000),\n    @Delimiter CHAR(1)\n)\nRETURNS @Result TABLE (Item VARCHAR(8000))\nAS\nBEGIN\n    DECLARE @Index INT\n    DECLARE @Slice VARCHAR(8000)\n\n    SELECT @Index = 1\n\n    IF LEN(@String) < 1 OR @String IS NULL RETURN\n\n    WHILE @Index != 0\n    BEGIN\n        SET @Index = CHARINDEX(@Delimiter, @String)\n        IF @Index != 0\n            SET @Slice = LEFT(@String, @Index - 1)\n        ELSE\n            SET @Slice = @String\n\n        IF LEN(@Slice) > 0\n            INSERT INTO @Result(Item) VALUES(@Slice)\n\n        SET @String = RIGHT(@String, LEN(@String) - @Index)\n\n        IF LEN(@String) = 0 BREAK\n    END\n\n    RETURN\nEND