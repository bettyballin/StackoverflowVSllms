CREATE VIEW riders AS \nSELECT \n    ridelog.uid AS rid, \n    SUM(ridelog.distance) AS total_distance,\n    SUM(CASE \n            WHEN YEAR(ridelog.ride_date) = YEAR(CURDATE()) THEN ridelog.distance \n            ELSE 0 \n        END) AS ytd_distance\nFROM \n    ridelog \nGROUP BY \n    ridelog.uid;