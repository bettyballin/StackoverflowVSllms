SELECT \n    common_votes,\n    same_direction_votes,\n    (same_direction_votes * 100.0 / common_votes) AS similarity_percentage\nFROM (\n    SELECT \n        COUNT(*) AS common_votes,\n        SUM(CASE WHEN v1.direction = v2.direction THEN 1 ELSE 0 END) AS same_direction_votes\n    FROM \n        votes v1\n    JOIN \n        votes v2 ON v1.itemID = v2.itemID\n    WHERE \n        v1.userID = 'A' AND v2.userID = 'B'\n) AS subquery;