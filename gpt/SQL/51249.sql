WITH DataWithGroups AS (\n    SELECT\n        ID,\n        Month,\n        Year,\n        Value,\n        SUM(CASE WHEN Value = LAG(Value) OVER (PARTITION BY ID ORDER BY Year, Month) THEN 0 ELSE 1 END) \n            OVER (PARTITION BY ID ORDER BY Year, Month) AS GroupNum\n    FROM\n        YourTable\n)\nSELECT\n    ID,\n    MIN(Month) AS StartMonth,\n    MAX(Month) AS EndMonth,\n    MIN(Year) AS StartYear,\n    MAX(Year) AS EndYear,\n    Value\nFROM\n    DataWithGroups\nGROUP BY\n    ID,\n    GroupNum,\n    Value\nORDER BY\n    ID,\n    StartYear,\n    StartMonth;