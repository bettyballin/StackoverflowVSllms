CREATE PROCEDURE CompareTables\n    @table1 NVARCHAR(128),\n    @table2 NVARCHAR(128),\n    @columns NVARCHAR(MAX)\nAS\nBEGIN\n    DECLARE @sql NVARCHAR(MAX);\n\n    -- Construct the SQL for symmetric difference\n    SET @sql = '\n        SELECT * FROM (\n            SELECT ' + @columns + ' FROM ' + @table1 + '\n            EXCEPT\n            SELECT ' + @columns + ' FROM ' + @table2 + '\n            UNION\n            SELECT ' + @columns + ' FROM ' + @table2 + '\n            EXCEPT\n            SELECT ' + @columns + ' FROM ' + @table1 + '\n        ) AS SymmetricDifference\n    ';\n\n    -- Execute the constructed SQL\n    EXEC sp_executesql @sql;\nEND\nGO