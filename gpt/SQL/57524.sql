DECLARE @BatchSize INT = 1000\nDECLARE @RowsAffected INT\n\n-- Update in batches\nWHILE (1=1)\nBEGIN\n    BEGIN TRANSACTION\n\n    UPDATE TOP (@BatchSize) Table1\n    SET UserNo = @userToKeep\n    WHERE UserNo = @userToDiscard\n\n    SET @RowsAffected = @@ROWCOUNT\n\n    IF @RowsAffected = 0\n    BEGIN\n        COMMIT TRANSACTION\n        BREAK\n    END\n\n    COMMIT TRANSACTION\nEND\n\n-- Delete in batches\nWHILE (1=1)\nBEGIN\n    BEGIN TRANSACTION\n\n    DELETE TOP (@BatchSize) FROM Table1\n    WHERE UserNo = @userToDiscard\n\n    SET @RowsAffected = @@ROWCOUNT\n\n    IF @RowsAffected = 0\n    BEGIN\n        COMMIT TRANSACTION\n        BREAK\n    END\n\n    COMMIT TRANSACTION\nEND\n\n-- You will need to repeat the above batch process for each table involved