CREATE OR REPLACE FUNCTION match_rules(a INT, b TEXT, c INT)\nRETURNS TABLE (id INT, rule JSONB) AS $$\nBEGIN\n    RETURN QUERY\n    SELECT id, rule\n    FROM RULES\n    WHERE (rule->>'A' IS NULL OR rule->>'A' = a::text)\n      AND (rule->>'B' IS NULL OR rule->>'B' = b)\n      AND (rule->>'C' IS NULL OR rule->>'C' = c::text);\nEND;\n$$ LANGUAGE plpgsql;\n\n-- Call the function\nSELECT * FROM match_rules(50, 'xyz', 456);