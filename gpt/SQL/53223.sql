-- Create a table variable to hold your data\nDECLARE @TableVariable TABLE (\n    [group] INT,\n    isok BIT,\n    x INT,\n    y INT\n);\n\n-- Insert sample data into the table variable\nINSERT INTO @TableVariable ([group], isok, x, y)\nVALUES\n(20, 0, 1, 1),\n(20, 1, 2, 1),\n(20, 1, 3, 1),\n(20, 0, 1, 2),\n(20, 0, 2, 1),\n(21, 1, 1, 1),\n(21, 0, 2, 1),\n(21, 1, 3, 1),\n(21, 0, 1, 2),\n(21, 1, 2, 2);\n\n-- Create a temporary table to store the concatenation result\nCREATE TABLE #Result (\n    [group] INT,\n    mask VARCHAR(MAX)\n);\n\n-- Use a cursor to process each group\nDECLARE @Group INT;\nDECLARE @Mask VARCHAR(MAX);\n\nDECLARE GroupCursor CURSOR FOR\nSELECT DISTINCT [group]\nFROM @TableVariable;\n\nOPEN GroupCursor;\n\nFETCH NEXT FROM GroupCursor INTO @Group;\n\nWHILE @@FETCH_STATUS = 0\nBEGIN\n    SET @Mask = '';\n\n    -- Concatenate the isok values for the current group\n    SELECT @Mask = @Mask + CAST(isok AS CHAR(1))\n    FROM @TableVariable\n    WHERE [group] = @Group\n    ORDER BY x, y;\n\n    -- Insert the result into the temporary table\n    INSERT INTO #Result ([group], mask)\n    VALUES (@Group, @Mask);\n\n    FETCH NEXT FROM GroupCursor INTO @Group;\nEND;\n\nCLOSE GroupCursor;\nDEALLOCATE GroupCursor;\n\n-- Select the result\nSELECT * FROM #Result;\n\n-- Drop the temporary table\nDROP TABLE #Result;