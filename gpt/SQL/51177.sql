SELECT TOP 10\n       qs.sql_handle,\n       qs.execution_count,\n       qs.total_worker_time AS CPU,\n       qs.total_physical_reads AS Reads,\n       qs.total_logical_writes AS Writes,\n       qs.total_elapsed_time AS Duration,\n       SUBSTRING(qt.text, qs.statement_start_offset / 2, \n       (CASE WHEN qs.statement_end_offset = -1 \n           THEN LEN(CONVERT(NVARCHAR(MAX), qt.text)) * 2 \n           ELSE qs.statement_end_offset END - qs.statement_start_offset) / 2) AS QueryText\n   FROM \n       sys.dm_exec_query_stats AS qs\n   CROSS APPLY \n       sys.dm_exec_sql_text(qs.sql_handle) AS qt\n   ORDER BY \n       qs.total_elapsed_time DESC;