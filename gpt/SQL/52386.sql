SELECT \n    r.RequesterID,\n    MAX(sr.ModifiedDate) AS ModifiedDate,\n    p.FirstName + ' ' + p.LastName AS RequesterName,\n    MAX(CASE WHEN sa.Attribute = 'Urgent' THEN sa.AttributeValue ELSE NULL END) AS Urgent,\n    MAX(CASE WHEN sa.Attribute = 'Closed' THEN sa.AttributeValue ELSE NULL END) AS Closed\nFROM\n    Requester AS r \n    INNER JOIN SubRequester AS sr \n        ON r.RequesterID = sr.RequesterID\n    INNER JOIN SubRequesterAttribute AS sa\n        ON sr.SubRequesterID = sa.SubRequesterID\n    INNER JOIN Personnel AS p\n        ON r.UserID = p.ContractorID OR r.UserID = p.EmployeeID\nWHERE \n    sa.Attribute IN ('Urgent', 'Closed')\nGROUP BY \n    r.RequesterID, p.FirstName, p.LastName