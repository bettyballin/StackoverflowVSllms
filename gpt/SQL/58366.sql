-- Assume Table A and Table B are already created as specified\n\n-- Insert records into Table A and capture the identity values alongside the original data\n-- into a temporary table\nDECLARE @OutputTable TABLE (\n    id INT,\n    Fname NVARCHAR(50),\n    Lname NVARCHAR(50)\n);\n\nINSERT INTO A (Fname, Lname)\nOUTPUT inserted.id, inserted.Fname, inserted.Lname INTO @OutputTable\nSELECT Fname, Lname\nFROM B;\n\n-- Update Table B with the new identity values from Table A\nUPDATE B\nSET NewId = OT.id\nFROM B\nJOIN @OutputTable OT\nON B.Fname = OT.Fname AND B.Lname = OT.Lname;