-- Step 1: Create a CTE to find the minimum DocID for each Code\nWITH cte AS (\n    SELECT \n        DocID, \n        Code, \n        MIN(DocID) OVER (PARTITION BY Code) AS MinDocID\n    FROM \n        your_table_name\n)\n\n-- Step 2: Update the table based on the CTE\nUPDATE your_table_name AS t\nJOIN cte AS c\nON t.DocID = c.DocID\nSET \n    t.IsDup = CASE \n                WHEN t.DocID = c.MinDocID THEN 0 \n                ELSE 1 \n              END,\n    t.DupOf = CASE \n                WHEN t.DocID = c.MinDocID THEN 0 \n                ELSE c.MinDocID \n              END;