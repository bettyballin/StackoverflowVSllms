-- Step 1: Backup the database\nBACKUP DATABASE MyDatabase TO DISK = 'C:\Backup\MyDatabase.bak';\n\n-- Step 2: Pre-check for duplicate data\nSELECT ColumnA, COUNT(*)\nFROM MyTable\nGROUP BY ColumnA\nHAVING COUNT(*) > 1;\n\n-- Step 3: Handle duplicates (archive or log them)\n-- Example: Move duplicates to an archive table\nINSERT INTO MyTable_Archive (ColumnA, ColumnB, ColumnC)\nSELECT ColumnA, ColumnB, ColumnC\nFROM MyTable t\nWHERE EXISTS (\n    SELECT 1 FROM MyTable\n    WHERE ColumnA = t.ColumnA\n    GROUP BY ColumnA\n    HAVING COUNT(*) > 1\n);\n\n-- Step 4: Remove duplicates from the original table\nDELETE FROM MyTable\nWHERE ColumnA IN (\n    SELECT ColumnA\n    FROM MyTable\n    GROUP BY ColumnA\n    HAVING COUNT(*) > 1\n);\n\n-- Step 5: Add the unique index\nCREATE UNIQUE INDEX idx_unique_ColumnA ON MyTable (ColumnA);\n\n-- Step 6: Log the operations\nINSERT INTO UpdateLog (Operation, Timestamp)\nVALUES ('Added unique index to MyTable', GETDATE());