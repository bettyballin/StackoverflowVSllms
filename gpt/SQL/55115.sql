WITH transaction_counts AS (\n    SELECT \n        DATE(created) AS transaction_date,\n        COUNT(*) AS daily_transaction_count\n    FROM transactions\n    GROUP BY DATE(created)\n),\nrange_groups AS (\n    SELECT\n        transaction_date,\n        daily_transaction_count,\n        CASE\n            WHEN daily_transaction_count BETWEEN 0 AND 2 THEN '0-2'\n            WHEN daily_transaction_count BETWEEN 3 AND 4 THEN '3-4'\n            WHEN daily_transaction_count BETWEEN 5 AND 6 THEN '5-6'\n            ELSE '7+'\n        END AS transaction_range\n    FROM transaction_counts\n),\naverage_amounts AS (\n    SELECT\n        rg.transaction_range,\n        AVG(t.amount) AS average_amount\n    FROM range_groups rg\n    JOIN transactions t ON DATE(t.created) = rg.transaction_date\n    GROUP BY rg.transaction_range\n)\nSELECT\n    transaction_range,\n    average_amount\nFROM average_amounts\nORDER BY transaction_range;