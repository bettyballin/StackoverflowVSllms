DECLARE @sql NVARCHAR(MAX) = N'';\n\nSELECT @sql += 'SELECT ''' + s.name + '.' + t.name + ''' AS TableName, COUNT(*) AS [RowCount] FROM ' + QUOTENAME(s.name) + '.' + QUOTENAME(t.name) + ' UNION ALL '\nFROM sys.schemas s\nJOIN sys.tables t ON s.schema_id = t.schema_id;\n\n-- Remove the trailing 'UNION ALL '\nSET @sql = LEFT(@sql, LEN(@sql) - 10);\n\n-- Execute the dynamic SQL\nEXEC sp_executesql @sql;