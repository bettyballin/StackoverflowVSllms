WITH JobHistory AS (\n    SELECT\n        EMP_ID,\n        JOB_ID,\n        STATUS,\n        EFF_DATE,\n        LEAD(EFF_DATE) OVER (PARTITION BY EMP_ID, JOB_ID ORDER BY EFF_DATE) AS NEXT_DATE\n    FROM\n        your_table\n),\nJobRanges AS (\n    SELECT\n        EMP_ID,\n        JOB_ID,\n        EFF_DATE AS START_DATE,\n        CASE \n            WHEN STATUS = 'T' THEN EFF_DATE\n            ELSE NEXT_DATE\n        END AS END_DATE\n    FROM\n        JobHistory\n    WHERE\n        STATUS = 'A'\n)\nSELECT\n    EMP_ID,\n    JOB_ID,\n    START_DATE,\n    END_DATE\nFROM\n    JobRanges\nORDER BY\n    EMP_ID,\n    START_DATE;