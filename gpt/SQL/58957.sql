WITH RankedLogs AS (\n    SELECT\n        identifier,\n        Name,\n        Status,\n        ROW_NUMBER() OVER (PARTITION BY Name ORDER BY \n            CASE Status\n                WHEN 'Closed' THEN 1\n                WHEN 'Hold' THEN 2\n                WHEN 'Waiting' THEN 3\n                WHEN 'Open' THEN 4\n                ELSE 5\n            END\n        ) AS Rank\n    FROM\n        logging_table\n)\nSELECT\n    identifier,\n    Name,\n    Status\nFROM\n    RankedLogs\nWHERE\n    Rank = 1;