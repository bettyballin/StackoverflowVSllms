-- Step 1: Create a temporary table to store the counts\nCREATE TEMPORARY TABLE temp_counts AS\nSELECT \n    s.matchCode1, \n    s.matchCode2, \n    s.matchCode3, \n    COUNT(s.employee_id) AS employee_count\nFROM \n    sourceTable s\nGROUP BY \n    s.matchCode1, \n    s.matchCode2, \n    s.matchCode3;\n\n-- Step 2: Update the destTable using a join with the temporary table\nUPDATE destTable d\nJOIN temp_counts t\nON d.matchCode1 = t.matchCode1 AND\n   d.matchCode2 = t.matchCode2 AND\n   d.matchCode3 = t.matchCode3\nSET d.test_count = t.employee_count;\n\n-- Step 3: Drop the temporary table if necessary (not required for temporary tables in session)\nDROP TEMPORARY TABLE IF EXISTS temp_counts;