SELECT \n    rocks.name, \n    rocks.latitude, \n    rocks.longitude, \n    rocks.indoor, \n    rocks.address, \n    rocks.phone, \n    rocks.email, \n    rocks.website, \n    rocks.closed,\n    types_list.types\nFROM \n    rocks \nINNER JOIN \n    (SELECT \n         id, \n         GROUP_CONCAT(type ORDER BY type SEPARATOR ', ') AS types \n     FROM \n         rock_types \n     WHERE \n         type="DWS" OR type="Top rope" \n     GROUP BY \n         id) AS types_list \nON \n    rocks.id = types_list.id\nWHERE \n    (latitude > -180 AND latitude < 180) AND \n    (longitude > -180 AND longitude < 180);