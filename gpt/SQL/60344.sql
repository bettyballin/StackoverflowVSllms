CREATE PROCEDURE ValidateAndCastDate\n    @date_string VARCHAR(20),\n    @the_date DATETIME OUTPUT\nAS\nBEGIN\n    -- Check if the date string matches the expected format 'DD-MON-YYYY'\n    IF PATINDEX('%[0-3][0-9]-%[A-Za-z][A-Za-z][A-Za-z]-%[1-2][0-9][0-9][0-9]%', @date_string) = 1\n    BEGIN\n        -- Try to cast the date string to DATETIME\n        BEGIN\n            SET @the_date = CAST(@date_string AS DATETIME)\n        END\n        -- If casting fails, catch the error and set @the_date to the current system date\n        ELSE\n        BEGIN\n            SET @the_date = GETDATE()\n        END\n    END\n    ELSE\n    BEGIN\n        -- If the pattern does not match, set @the_date to the current system date\n        SET @the_date = GETDATE()\n    END\nEND\nGO