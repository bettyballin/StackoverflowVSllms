SELECT AccountId,\n       AccountBalanceDate,\n       SUM(openingBalanceAmounts.TokenAmount) AS OpeningBalance,\n       SUM(closingBalanceAmounts.TokenAmount) AS ClosingBalance\nFROM Account A\nLEFT JOIN BALANCE OpeningBal\n  ON A.OpeningBalanceId = OpeningBal.BalanceId\nLEFT JOIN BALANCE ClosingBal\n  ON A.ClosingBalanceId = ClosingBal.BalanceId\nLEFT JOIN BalanceToken openingBalanceAmounts\n  ON openingBalanceAmounts.BalanceId = OpeningBal.BalanceId\nLEFT JOIN BalanceToken closingBalanceAmounts\n  ON closingBalanceAmounts.BalanceId = ClosingBal.BalanceId\nGROUP BY AccountId, AccountBalanceDate;