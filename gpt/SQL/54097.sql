WITH EmployeeMoney AS (\n    SELECT E.EmployeeID, E.EmployeeName, SUM(M.Amount) AS TotalAmount\n    FROM Employees E\n    LEFT JOIN MoneyTransactions M ON E.EmployeeID = M.EmployeeID\n    GROUP BY E.EmployeeID, E.EmployeeName\n),\nEmployeeBudget AS (\n    SELECT E.EmployeeID, SUM(B.Amount) AS BudgetAmount\n    FROM Employees E\n    LEFT JOIN BudgetTransactions B ON E.EmployeeID = B.EmployeeID\n    GROUP BY E.EmployeeID\n),\nEmployeeTime AS (\n    SELECT E.EmployeeID, \n           SUM(T.Hours) AS TotalHours, \n           SUM(CASE WHEN T.Type = 'Waste' THEN T.Hours ELSE 0 END) AS WastedHours\n    FROM Employees E\n    LEFT JOIN TimeTransactions T ON E.EmployeeID = T.EmployeeID\n    GROUP BY E.EmployeeID\n),\nEmployeeTimeBudget AS (\n    SELECT E.EmployeeID, SUM(TB.Hours) AS BudgetHours\n    FROM Employees E\n    LEFT JOIN TimeBudgetTransactions TB ON E.EmployeeID = TB.EmployeeID\n    GROUP BY E.EmployeeID\n)\n\nSELECT EM.EmployeeName, \n       EM.TotalAmount, \n       EB.BudgetAmount, \n       ET.TotalHours, \n       ETB.BudgetHours, \n       ET.WastedHours\nFROM EmployeeMoney EM\nLEFT JOIN EmployeeBudget EB ON EM.EmployeeID = EB.EmployeeID\nLEFT JOIN EmployeeTime ET ON EM.EmployeeID = ET.EmployeeID\nLEFT JOIN EmployeeTimeBudget ETB ON EM.EmployeeID = ETB.EmployeeID