DECLARE @nProduct INT\nDECLARE @iPricingType INT\nDECLARE @nMCC INT\n\nSET @nProduct = 4\nSET @iPricingType = 2\nSET @nMCC = 230\n\n-- Build SQL for factor matrix\n\nSELECT DISTINCT\n    base.uiBase_Price_ID,\n    base.nNoteRate, \n    base.sDeliveryOpt, \n    ISNULL(base.nPrice, 0) AS nPrice, \n    ISNULL(base.nPrice, 0) + ISNULL(fact.nFactor, 0) AS nAdjPrice, \n    base.iProduct_ID,\n    fact.iPosition AS fiPosition, \n    base.iPosition, \n    CONVERT(VARCHAR(20), base.dtDate_Updated, 101) + ' ' + CONVERT(VARCHAR(20), base.dtDate_Updated, 108) AS dtDate_Updated, \n    fact.nFactor, \n    fact.nTreasFactor, \n    product.sProduct_txt,  \n    pfi.sPFI_Name,  \n    mccprod.nServicing_Fee,  \n    fact.nNoteRate AS fNoteRate,  \n    mcc.nLRA_Charge AS nLRA  \nFROM \n    tbl_Base_Prices base\n    LEFT OUTER JOIN tbl_Factors fact ON base.iProduct_ID = fact.iProduct_ID \n        AND base.iPosition = fact.iPosition \n        AND base.nNoteRate = fact.nNoteRate\n    INNER JOIN tbl_Product product ON base.iProduct_ID = product.iProduct_ID\n    INNER JOIN tbl_PFI pfi ON mcc.iPFI_ID = pfi.iPFI_ID\n    INNER JOIN tbl_MCC mcc ON fact.iMCC_ID = mcc.iMCC_ID\n    INNER JOIN tbl_MCC_Product mccprod ON mccprod.iMCC_ID = mcc.iMCC_ID \n        AND mccprod.iProduct_ID = base.iProduct_ID\nWHERE\n    base.iProduct_ID = @nProduct\n    AND base.iPricing_Type = @iPricingType\n    AND fact.iMCC_ID = @nMCC\n    AND fact.iProduct_ID = @nProduct\n    AND fact.iPricing_Type = @iPricingType\nORDER BY\n    base.nNoteRate, base.iPositio