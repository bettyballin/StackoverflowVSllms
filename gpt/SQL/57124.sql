DECLARE\n    l_file_handle UTL_FILE.FILE_TYPE;\n    l_file_name   VARCHAR2(100);\n    l_directory   CONSTANT VARCHAR2(100) := 'YOUR_DIRECTORY';\n    l_row_limit   CONSTANT PLS_INTEGER := 100000; -- Change as per requirement\n    l_row_count   INTEGER := 0;\n    l_file_count  INTEGER := 1;\n    CURSOR c_data IS\n        SELECT * FROM your_table;\n\n    PROCEDURE write_to_file(p_record VARCHAR2) IS\n    BEGIN\n        IF l_row_count = 0 OR l_row_count >= l_row_limit THEN\n            IF l_row_count >= l_row_limit THEN\n                UTL_FILE.FCLOSE(l_file_handle);\n                l_file_count := l_file_count + 1;\n            END IF;\n            l_file_name := 'out' || l_file_count || '.csv';\n            l_file_handle := UTL_FILE.FOPEN(l_directory, l_file_name, 'W');\n            l_row_count := 0;\n        END IF;\n        UTL_FILE.PUT_LINE(l_file_handle, p_record);\n        l_row_count := l_row_count + 1;\n    END;\n\nBEGIN\n    FOR r IN c_data LOOP\n        -- Here you can format r columns as necessary\n        write_to_file(r.col1 || ',' || r.col2 || ',' || r.col3); -- Example formatting\n    END LOOP;\n\n    IF l_row_count > 0 THEN\n        UTL_FILE.FCLOSE(l_file_handle);\n    END IF;\n\nEXCEPTION\n    WHEN OTHERS THEN\n        IF UTL_FILE.IS_OPEN(l_file_handle) THEN\n            UTL_FILE.FCLOSE(l_file_handle);\n        END IF;\n        RAISE;\nEND;\n/