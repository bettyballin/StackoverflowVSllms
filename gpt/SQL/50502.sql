WITH\n  x AS (\n    SELECT 1 id FROM dual \n    UNION SELECT 2 FROM dual \n    UNION SELECT 3 FROM dual\n  ),\n  y AS (\n    SELECT 1 id, 1 nr, 'B' code FROM dual\n    UNION SELECT 1, 2, 'A' FROM dual\n    UNION SELECT 2, 2, 'A' FROM dual\n  ),\n  y_ranked AS (\n    SELECT \n      id, \n      nr, \n      code, \n      ROW_NUMBER() OVER (PARTITION BY id ORDER BY nr) AS rn\n    FROM \n      y\n  )\nSELECT \n  x.id, \n  y_ranked.nr, \n  y_ranked.code\nFROM \n  x\n  LEFT OUTER JOIN y_ranked ON (y_ranked.id = x.id AND y_ranked.rn = 1)\n;