-- Step 1: Create temporary tables for subqueries\nSELECT\n   ...\nINTO #TempT1\nFROM\n   (SELECT\n      ...\n   FROM\n      ...\n   WHERE\n      date_column BETWEEN '2023-07-01' AND '2023-07-31') AS Subquery1;\n\nSELECT\n   ...\nINTO #TempT2\nFROM\n   (SELECT\n      ...\n   FROM\n      ...\n   WHERE\n      date_column BETWEEN '2023-07-01' AND '2023-07-31') AS Subquery2;\n\n-- Step 2: Join and aggregate\nSELECT\n   ...\nFROM\n   #TempT1 T1\nJOIN\n   #TempT2 T2 ON T1.key = T2.key\nGROUP BY\n   ...;\n\n-- Step 3: Clean up temporary tables\nDROP TABLE #TempT1;\nDROP TABLE #TempT2;