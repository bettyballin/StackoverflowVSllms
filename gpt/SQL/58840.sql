-- Create a temporary table to store IDs\nCREATE GLOBAL TEMPORARY TABLE temp_ids (id NUMBER) ON COMMIT DELETE ROWS;\n\nBEGIN\n  -- Insert rows from A to B and store the IDs in the temporary table\n  INSERT INTO B (SELECT * FROM A RETURNING id INTO temp_ids);\n  \n  -- Delete rows from A that were copied to B using the IDs from the temporary table\n  DELETE FROM A WHERE id IN (SELECT id FROM temp_ids);\n  \n  COMMIT;\nEND;