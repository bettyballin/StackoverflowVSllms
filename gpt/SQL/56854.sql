WITH LatestWorkItems AS (\n    SELECT\n        [System.Id],\n        [System.RevisedDate],\n        [System.Title],\n        [System.State],\n        [System.Reason],\n        [System.CreatedDate],\n        [System.WorkItemType],\n        [System.TeamProject],\n        [Microsoft.VSTS.Scheduling.RemainingWork],\n        [Microsoft.VSTS.Scheduling.CompletedWork],\n        [Microsoft.VSTS.CMMI.Estimate],\n        ROW_NUMBER() OVER (PARTITION BY [System.Id] ORDER BY [System.RevisedDate] DESC) AS RowNum\n    FROM\n        WorkItems\n    WHERE\n        [System.WorkItemType] = 'Change Request' AND\n        [System.CreatedDate] >= '2008-09-30' AND\n        [System.TeamProject] NOT LIKE '%Deleted%' AND\n        [System.TeamProject] NOT LIKE '%Sandbox%'\n)\n\nSELECT\n    [System.Id],\n    [System.RevisedDate],\n    [System.Title],\n    [System.State],\n    [System.Reason],\n    [System.CreatedDate],\n    [System.WorkItemType],\n    [System.TeamProject],\n    [Microsoft.VSTS.Scheduling.RemainingWork],\n    [Microsoft.VSTS.Scheduling.CompletedWork],\n    [Microsoft.VSTS.CMMI.Estimate]\nFROM\n    LatestWorkItems\nWHERE\n    RowNum = 1;