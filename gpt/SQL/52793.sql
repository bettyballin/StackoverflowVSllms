INSERT INTO MainTable_Option (MainTableID, OptionID)\nSELECT \n    d.ID, \n    CASE \n        WHEN d.OptionVal1 = 'y' THEN o1.OptionID\n        WHEN d.OptionVal2 = 'y' THEN o2.OptionID\n        WHEN d.OptionVal3 = 'y' THEN o3.OptionID\n        ELSE NULL\n    END\nFROM \n    DodgyOldTable d\n    LEFT JOIN Option o1 ON o1.OptionDesc = 'OptionVal1'\n    LEFT JOIN Option o2 ON o2.OptionDesc = 'OptionVal2'\n    LEFT JOIN Option o3 ON o3.OptionDesc = 'OptionVal3'\nWHERE \n    d.OptionVal1 = 'y' OR d.OptionVal2 = 'y' OR d.OptionVal3 = 'y';