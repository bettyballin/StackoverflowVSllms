SELECT JSON_OBJECT(\n    'SalesOrder', JSON_ARRAYAGG(\n        JSON_OBJECT(\n            'Id', so.id,\n            'Code', so.Code,\n            'Customer', JSON_OBJECT(\n                'Code', cu.Code,\n                'Name', cu.Name\n            ),\n            'SalesItems', (\n                SELECT JSON_ARRAYAGG(\n                    JSON_OBJECT('Item', si.Item_Num, 'PartCode', pa.Code)\n                )\n                FROM tblSalesItem si\n                LEFT JOIN tblPart pa ON pa.Id = si.Part_Id\n                WHERE si.SalesOrder_ID = so.Id\n            )\n        )\n    )\n) AS result\nFROM tblSalesOrder so\nJOIN tblCustomer cu ON so.customer_id = cu.ID;