WITH LatestRevisions AS (\n    SELECT \n        r.pageId,\n        MAX(r.id) AS latestId,\n        MAX(CASE WHEN r.status = 'active' THEN r.id ELSE NULL END) AS latestActiveId\n    FROM \n        page_revision AS r\n    GROUP BY \n        r.pageId\n)\nSELECT \n    p.id, \n    COALESCE(ar.status, lr.status) AS status, \n    COALESCE(ar.title, lr.title) AS title\nFROM \n    page AS p\n    INNER JOIN LatestRevisions AS lr ON lr.pageId = p.id\n    LEFT JOIN page_revision AS ar ON ar.id = lr.latestActiveId\n    INNER JOIN page_revision AS lr ON lr.id = lr.latestId