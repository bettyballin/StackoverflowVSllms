CREATE PROCEDURE [dbo].[sp_Test1]\n(\n    @p_CreatedBy UNIQUEIDENTIFIER\n)\nAS\nBEGIN\n    DECLARE @sql NVARCHAR(4000)\n    SET @sql = '\n    SELECT \n        DateTime,\n        Subject,\n        CreatedBy\n    FROM\n    (\n        SELECT \n            DateTime, Subject, CreatedBy, \n            ROW_NUMBER() OVER(ORDER BY DateTime) AS Indexing\n        FROM\n            ComposeMail\n        WHERE \n            CreatedBy = @p_CreatedBy\n    ) AS NewDataTable'\n\n    EXEC sp_executesql @sql, N'@p_CreatedBy UNIQUEIDENTIFIER', @p_CreatedBy\nEND