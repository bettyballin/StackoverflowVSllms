WITH CountryRevisions AS (\n    SELECT CreatedAt AS RevisionId\n    FROM Countries \n    WHERE localId = @Country\n    UNION\n    SELECT RemovedAt AS RevisionId\n    FROM Countries \n    WHERE localId = @Country\n),\nProvinceRevisions AS (\n    SELECT p.CreatedAt AS RevisionId\n    FROM Provinces AS p\n    INNER JOIN Countries AS c ON p.CountryId = c.LocalId\n    WHERE c.LocalId = @Country\n    UNION\n    SELECT p.RemovedAt AS RevisionId\n    FROM Provinces AS p\n    INNER JOIN Countries AS c ON p.CountryId = c.LocalId\n    WHERE c.LocalId = @Country\n)\nSELECT RevisionId\nFROM CountryRevisions\nUNION\nSELECT RevisionId\nFROM ProvinceRevisions\nORDER BY RevisionId;