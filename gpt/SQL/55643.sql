SELECT \n    COUNT(Event.EventID) AS EventCount, \n    T.Customer, \n    T.Year, \n    T.Month\nFROM \n    [Event]\nJOIN \n    #T T ON Event.CustomerID = T.CustomerID \n        AND YEAR(Event.DateOpened) = T.Year \n        AND MONTH(Event.DateOpened) = T.Month\nWHERE \n    Event.DateOpened BETWEEN '2008-12-01' AND '2008-12-31'\nGROUP BY \n    T.Customer, \n    T.Year, \n    T.Month\nORDER BY \n    T.Year, \n    T.Month;