DECLARE @table TABLE(data VARCHAR(20))\n\n-- Insert sample data\nINSERT INTO @table VALUES ('not duplicate row')\nINSERT INTO @table VALUES ('duplicate row')    \nINSERT INTO @table VALUES ('duplicate row')    \nINSERT INTO @table VALUES ('second duplicate row')    \nINSERT INTO @table VALUES ('second duplicate row')\n\n-- Identify duplicates\nSELECT data    \nINTO #duplicates    \nFROM @table    \nGROUP BY data    \nHAVING COUNT(*) > 1    \n\n-- Delete all rows that are duplicated   \nDELETE FROM @table    \nFROM @table o \nINNER JOIN #duplicates d\nON d.data = o.data         \n\n-- Insert one row for every duplicate set    \nINSERT INTO @table(data)    \nSELECT data    \nFROM #duplicates