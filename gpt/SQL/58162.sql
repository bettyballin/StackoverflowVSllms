WITH ProvidedInstances AS (\n    SELECT 10 AS PI UNION ALL\n    SELECT 11 UNION ALL\n    SELECT 13 -- Replace these values with the instances you are querying\n),\nInstanceCounts AS (\n    SELECT PO, COUNT(*) AS InstanceCount\n    FROM ProductOffering\n    WHERE PI IN (SELECT PI FROM ProvidedInstances)\n    GROUP BY PO\n),\nTotalInstanceCounts AS (\n    SELECT PO, COUNT(*) AS TotalInstances\n    FROM ProductOffering\n    GROUP BY PO\n)\nSELECT IC.PO\nFROM InstanceCounts IC\nJOIN TotalInstanceCounts TIC ON IC.PO = TIC.PO\nWHERE IC.InstanceCount = (SELECT COUNT(*) FROM ProvidedInstances)\n  AND IC.InstanceCount = TIC.TotalInstances;