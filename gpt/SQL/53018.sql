WITH OrderedT AS (\n    SELECT \n        ColA, \n        ColB, \n        ColC, \n        ROW_NUMBER() OVER (PARTITION BY ColA ORDER BY TopColumn DESC) AS rn\n    FROM T\n)\nSELECT \n    T.ColA, \n    T.ColB, \n    T.ColC, \n    OrderedT.ColB AS OrderedColB, \n    OrderedT.ColC AS OrderedColC\nFROM \n    T\nLEFT JOIN \n    OrderedT \n    ON T.ColA = OrderedT.ColA AND OrderedT.rn = 1;