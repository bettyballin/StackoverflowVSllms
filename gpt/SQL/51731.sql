DECLARE @cols AS NVARCHAR(MAX),\n        @query AS NVARCHAR(MAX)\n\n-- Step 1: Get the distinct assignment names\nSELECT @cols = STUFF((SELECT distinct ',' + QUOTENAME(AssignmentName)\n                      FROM your_table_name\n                      FOR XML PATH(''), TYPE\n                      ).value('.', 'NVARCHAR(MAX)') \n                     ,1,1,'')\n\n-- Step 2: Construct the dynamic pivot query\nSET @query = 'SELECT StudentName, ' + @cols + '\n              FROM \n              (\n                  SELECT StudentName, AssignmentName, Grade\n                  FROM your_table_name\n              ) x\n              PIVOT \n              (\n                  MAX(Grade)\n                  FOR AssignmentName IN (' + @cols + ')\n              ) p \n              ORDER BY StudentName'\n\n-- Step 3: Execute the dynamic pivot query\nEXEC sp_executesql @query