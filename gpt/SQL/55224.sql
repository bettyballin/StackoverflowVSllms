-- Create a date range table (assuming you want to check for the month of June 2009)\nWITH DateRange AS (\n    SELECT CAST('2009-06-01' AS DATETIME) AS DateValue\n    UNION ALL\n    SELECT DATEADD(day, 1, DateValue)\n    FROM DateRange\n    WHERE DATEADD(day, 1, DateValue) <= '2009-06-30'\n)\n\n-- Generate the free/busy report\nSELECT \n    o.object_name,\n    MAX(CASE WHEN dr.DateValue = '2009-06-01' THEN status ELSE 'free' END) AS '6/1/09',\n    MAX(CASE WHEN dr.DateValue = '2009-06-02' THEN status ELSE 'free' END) AS '6/2/09',\n    MAX(CASE WHEN dr.DateValue = '2009-06-03' THEN status ELSE 'free' END) AS '6/3/09',\n    MAX(CASE WHEN dr.DateValue = '2009-06-04' THEN status ELSE 'free' END) AS '6/4/09',\n    -- Add more dates as needed\n    MAX(CASE WHEN dr.DateValue = '2009-06-30' THEN status ELSE 'free' END) AS '6/30/09'\nFROM \n    (SELECT \n         r.reservation_object, \n         dr.DateValue, \n         CASE \n             WHEN dr.DateValue >= r.arrival AND dr.DateValue < r.departure THEN 'busy' \n             ELSE 'free' \n         END AS status\n     FROM \n         Reservations r\n     CROSS JOIN \n         DateRange dr\n     WHERE \n         dr.DateValue >= '2009-06-01' AND dr.DateValue <= '2009-06-30') AS BusyStatus\nJOIN \n    Objects o ON BusyStatus.reservation_object = o.id\nGROUP BY \n    o.object_name\nORDER BY \n    o.object_name\nOPTION (MAXRECURSION 0);