WITH GroupedData AS (\n    SELECT \n        Name,\n        LAG(Name) OVER (ORDER BY ID) AS PrevName,\n        LEAD(Name) OVER (ORDER BY ID) AS NextName\n    FROM YourTable\n),\nMarkedData AS (\n    SELECT \n        Name,\n        CASE \n            WHEN Name = PrevName THEN 0\n            WHEN Name = NextName THEN 1\n            ELSE 2\n        END AS GroupMarker\n    FROM GroupedData\n),\nFinalData AS (\n    SELECT \n        Name,\n        SUM(CASE WHEN GroupMarker = 1 THEN 1 ELSE 0 END) \n        OVER (ORDER BY ID ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS RunCount,\n        GroupMarker\n    FROM MarkedData\n)\nSELECT \n    CASE \n        WHEN GroupMarker = 1 THEN NULL\n        WHEN GroupMarker = 2 AND RunCount > 1 THEN CONCAT(Name, ' (', RunCount, ')')\n        ELSE Name\n    END AS DisplayName\nFROM FinalData\nWHERE GroupMarker <> 0\nORDER BY ID;