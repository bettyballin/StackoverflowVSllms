WITH RECURSIVE CategoryPaths AS (\n    SELECT \n        category_id,\n        name,\n        parent,\n        category_id AS lvl1,\n        NULL AS lvl2,\n        NULL AS lvl3,\n        NULL AS lvl4\n    FROM categories\n    WHERE parent IS NULL\n    UNION ALL\n    SELECT \n        c.category_id,\n        c.name,\n        c.parent,\n        cp.lvl1,\n        CASE WHEN cp.lvl2 IS NULL THEN c.category_id ELSE cp.lvl2 END,\n        CASE WHEN cp.lvl2 IS NOT NULL AND cp.lvl3 IS NULL THEN c.category_id ELSE cp.lvl3 END,\n        CASE WHEN cp.lvl3 IS NOT NULL THEN c.category_id ELSE cp.lvl4 END\n    FROM categories c\n    JOIN CategoryPaths cp ON c.parent = cp.category_id\n)\nSELECT \n    category_id,\n    lvl1,\n    lvl2,\n    lvl3,\n    lvl4\nFROM CategoryPaths\nORDER BY category_id;