WITH CountryList AS (\n    SELECT \n        u.ID,\n        u.Name AS User,\n        STRING_AGG(c.Country, ', ') AS CountriesByName\n    FROM \n        Users u\n    CROSS APPLY (\n        SELECT \n            value AS CountryID\n        FROM \n            STRING_SPLIT(u.Countries, ',')\n    ) AS s\n    INNER JOIN \n        Countries c ON s.CountryID = c.ID\n    GROUP BY \n        u.ID, u.Name\n)\nSELECT * FROM CountryList;