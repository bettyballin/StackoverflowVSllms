DECLARE @recipients VARCHAR(MAX);\nSET @recipients = 'person1@yahoo.com;person2@hotmail.com;person1@yahoo.com;...';\n\n-- Use the SplitString function to get distinct recipients\nSELECT DISTINCT Value AS Recipient\nFROM dbo.SplitString(@recipients, ';');\n\n-- Example loop to send email (pseudo-code)\nDECLARE @recipient NVARCHAR(MAX);\nDECLARE recipient_cursor CURSOR FOR\nSELECT DISTINCT Value\nFROM dbo.SplitString(@recipients, ';');\n\nOPEN recipient_cursor;\nFETCH NEXT FROM recipient_cursor INTO @recipient;\n\nWHILE @@FETCH_STATUS = 0\nBEGIN\n    -- Code to send email to @recipient\n    PRINT 'Send email to ' + @recipient;\n    FETCH NEXT FROM recipient_cursor INTO @recipient;\nEND;\n\nCLOSE recipient_cursor;\nDEALLOCATE recipient_cursor;