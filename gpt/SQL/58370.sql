WITH RECURSIVE DateCalculation AS (\n    -- Anchor member: start with the order date and initial lead time\n    SELECT \n        o.ProductID,\n        o.OrderDate AS CurrentDate,\n        1 AS WorkDayCount\n    FROM \n        Order o\n    WHERE \n        o.ProductID = 9\n    \n    UNION ALL\n    \n    -- Recursive member: iterate over dates incrementally\n    SELECT \n        dc.ProductID,\n        dc.CurrentDate + INTERVAL 1 DAY AS CurrentDate,\n        dc.WorkDayCount + CASE \n            WHEN (dc.CurrentDate + INTERVAL 1 DAY) NOT IN (SELECT OffDay FROM OffDays) AND \n                 DAYOFWEEK(dc.CurrentDate + INTERVAL 1 DAY) NOT IN (1, 7) THEN 1 \n            ELSE 0 \n            END AS WorkDayCount\n    FROM \n        DateCalculation dc\n    WHERE \n        dc.WorkDayCount < (SELECT LeadTime FROM LeadTime WHERE ProductID = 9)\n)\n\n-- Select the final date which is the effective manufacturing completion date\nSELECT \n    CurrentDate AS EffectiveDate \nFROM \n    DateCalculation \nWHERE \n    WorkDayCount = (SELECT LeadTime FROM LeadTime WHERE ProductID = 9);