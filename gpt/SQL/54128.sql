WITH CTE AS (\n    SELECT \n        id,\n        [Date],\n        Letter,\n        LEAD(Letter) OVER (PARTITION BY [Date] ORDER BY id) AS NextLetter\n    FROM \n        YourTable\n)\nSELECT \n    C1.id,\n    C1.[Date],\n    C1.Letter,\n    COALESCE(CASE \n        WHEN C1.Letter = 'Z' AND C1.NextLetter != 'A' THEN 'A'\n        WHEN CHAR(ASCII(C1.Letter) + 1) != C1.NextLetter THEN CHAR(ASCII(C1.Letter) + 1)\n    END, 'No Missing Letter') AS MissingLetter\nFROM \n    CTE C1\nLEFT JOIN \n    CTE C2\n    ON C1.[Date] = C2.[Date]\n    AND C1.id = C2.id - 1\nWHERE \n    C1.NextLetter IS NOT NULL\n    AND (\n        (C1.Letter = 'Z' AND C1.NextLetter != 'A') OR\n        (C1.Letter != 'Z' AND CHAR(ASCII(C1.Letter) + 1) != C1.NextLetter)\n    )\nORDER BY \n    C1.[Date], C1.id;