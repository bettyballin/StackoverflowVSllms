CREATE FUNCTION dbo.IsPatrolOverlapping (\n       @GuardID INT,\n       @Starts DATETIME,\n       @Ends DATETIME,\n       @PatrolID INT\n   )\n   RETURNS BIT\n   AS\n   BEGIN\n       DECLARE @Result BIT;\n\n       SELECT @Result = CASE\n           WHEN EXISTS (\n               SELECT 1\n               FROM Patrols\n               WHERE GuardID = @GuardID\n                 AND PatrolID <> @PatrolID\n                 AND (\n                     (@Starts < Ends AND @Ends > Starts)\n                 )\n           )\n           THEN 1\n           ELSE 0\n       END;\n\n       RETURN @Result;\n   END;