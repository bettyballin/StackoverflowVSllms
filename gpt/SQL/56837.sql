SELECT \n    character_counts.count,\n    strips.name AS strip,\n    characters.name AS character\nFROM \n    strips\nJOIN\n    appearances ON strips.id = appearances.strip_id\nJOIN\n    characters ON characters.id = appearances.character_id\nJOIN \n    (SELECT \n        characters.id AS character_id,\n        COUNT(*) AS count\n     FROM \n        appearances\n     JOIN \n        characters ON characters.id = appearances.character_id\n     WHERE \n        appearances.date IN (...)\n     GROUP BY \n        characters.id) AS character_counts \nON \n    characters.id = character_counts.character_id\nWHERE \n    appearances.date IN (...);