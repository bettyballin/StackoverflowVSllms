CREATE VIEW client_aggregate AS\nSELECT\n    c.id AS client_id,\n    c.profile_id,\n    p.firstname,\n    p.address,\n    p.zipcode,\n    e.email AS primary_email,\n    ph.phone_number AS primary_phone\nFROM\n    client c\nJOIN\n    profile p ON c.profile_id = p.id\nLEFT JOIN\n    email e ON c.id = e.client_id AND e.primary = TRUE\nLEFT JOIN\n    phone ph ON c.id = ph.client_id AND ph.primary = TRUE;