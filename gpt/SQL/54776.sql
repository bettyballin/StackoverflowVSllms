CREATE VIEW ExtractedDates AS\nSELECT\n    YourColumnName,\n    CASE \n        WHEN CHARINDEX('DSP', YourColumnName) > 0 THEN\n            SUBSTRING(\n                YourColumnName,\n                CHARINDEX('DSP', YourColumnName) + 4,\n                5\n            )\n        WHEN CHARINDEX('DISCH', YourColumnName) > 0 THEN\n            SUBSTRING(\n                YourColumnName,\n                CHARINDEX('DISCH', YourColumnName) + 6,\n                5\n            )\n        ELSE NULL\n    END AS ExtractedDate\nFROM YourTableName