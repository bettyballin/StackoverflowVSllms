SELECT fd.cust_id,\n       fd.server_name,\n       fd.instance_name,\n       last_day_with_data AS coll_date,\n       fd.column_name\nFROM (\n    SELECT cust_id,\n           server_name,\n           instance_name,\n           MAX(TRUNC(coll_date)) AS last_day_with_data\n    FROM super_table\n    WHERE cust_id = :CUST_ID\n      AND coll_date > ADD_MONTHS(TRUNC(SYSDATE, 'MM'), -12)\n      AND coll_date <= SYSDATE\n    GROUP BY cust_id,\n             server_name,\n             instance_name,\n             TRUNC(coll_date, 'MM')\n) last_days\nJOIN super_table fd\nON last_days.cust_id = fd.cust_id\nAND last_days.server_name = fd.server_name\nAND last_days.instance_name = fd.instance_name\nAND last_days.last_day_with_data = TRUNC(fd.coll_date)\nORDER BY fd.server_name,\n         fd.instance_name,\n         last_day_with_data;