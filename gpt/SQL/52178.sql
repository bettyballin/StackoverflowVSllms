WITH FiscalDates AS (\n    SELECT '1/28/2009' AS FiscalDate UNION ALL\n    SELECT '2/27/2009' UNION ALL\n    SELECT '3/29/2009'\n),\nData AS (\n    SELECT 'AAA' AS ID, '1/27/2009' AS Date, 0 AS Hour, 10 AS Weight UNION ALL\n    SELECT 'AAA', '1/30/2009', 0, 20 UNION ALL\n    SELECT 'AAA', '2/14/2009', 0, 10 UNION ALL\n    SELECT 'AAA', '2/18/2009', 0, 20 UNION ALL\n    SELECT 'AAA', '2/27/2009', 0, 20 UNION ALL\n    SELECT 'AAA', '2/28/2009', 0, 20 UNION ALL\n    SELECT 'AAA', '1/14/2009', 10, 0 UNION ALL\n    SELECT 'AAA', '2/14/2009', 20, 0 UNION ALL\n    SELECT 'AAA', '2/16/2009', 10, 0 UNION ALL\n    SELECT 'AAA', '2/25/2009', 10, 0 UNION ALL\n    SELECT 'AAA', '2/26/2009', 10, 0 UNION ALL\n    SELECT 'AAA', '3/3/2009', 20, 0\n)\nSELECT \n    D.ID, \n    F.FiscalDate AS Date, \n    SUM(D.Hour) AS Hour, \n    SUM(D.Weight) AS Weight\nFROM \n    Data D\nJOIN \n    FiscalDates F\nON \n    D.Date <= F.FiscalDate\nGROUP BY \n    D.ID, \n    F.FiscalDate\nORDER BY \n    D.ID, \n    F.FiscalDate;