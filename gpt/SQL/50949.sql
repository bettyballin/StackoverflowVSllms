WITH RECURSIVE PageHierarchy AS (\n    SELECT\n        id,\n        parent_id,\n        level,\n        name,\n        CAST(name AS CHAR(1000)) AS display_name\n    FROM\n        pages\n    WHERE\n        parent_id = 0\n    UNION ALL\n    SELECT\n        p.id,\n        p.parent_id,\n        p.level,\n        p.name,\n        CONCAT(ph.display_name, '\n', REPEAT('~~', p.level - 1), p.name) AS display_name\n    FROM\n        pages p\n    INNER JOIN\n        PageHierarchy ph ON p.parent_id = ph.id\n)\nSELECT display_name\nFROM PageHierarchy\nORDER BY id;