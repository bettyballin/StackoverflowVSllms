SELECT\n    DATEADD(month, DATEDIFF(month, 0, a.OpenedDate), 0) AS 'Opened Date',\n    c.AddressState AS 'State',\n    SUM(p.Amount) AS 'Total'\nFROM\n    Account a\nINNER JOIN\n    Customer c ON a.CustomerID = c.CustomerID\nINNER JOIN\n    Payment p ON a.AccountID = p.AccountID\nWHERE\n    a.OpenedDate IS NOT NULL -- Add any additional conditions here\nGROUP BY\n    DATEADD(month, DATEDIFF(month, 0, a.OpenedDate), 0),\n    c.AddressState\nORDER BY\n    'Opened Date', 'State';