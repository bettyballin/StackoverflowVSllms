-- Example function that returns the actual app_id or NULL\nCREATE FUNCTION dbo.fnGetAppId(@user_id INT)\nRETURNS INT\nAS\nBEGIN\n    DECLARE @app_id INT;\n\n    -- Logic to determine the actual app_id\n    -- For demonstration, let's assume it returns 1234 or NULL\n    IF @user_id % 2 = 0\n        SET @app_id = 1234;\n    ELSE\n        SET @app_id = NULL;\n\n    RETURN @app_id;\nEND\nGO\n\n-- Modified query to use the function\nSELECT *\nFROM user_info\nLEFT OUTER JOIN addresses\nON addresses.user_id = user_info.user_id\nAND (\n    -- Check if app_id matches the value returned by the function\n    addresses.app_id = dbo.fnGetAppId(user_info.user_id)\n    OR\n    -- Handle the case where the function returns NULL\n    (dbo.fnGetAppId(user_info.user_id) IS NULL AND addresses.app_id IS NULL)\n)