CREATE PROCEDURE dbo.PivotMonths\n    @StartDate DATE,\n    @EndDate DATE\nAS\nBEGIN\n    DECLARE @SQL NVARCHAR(MAX)\n\n    SET @SQL = '\n        SELECT\n            YEAR(DateField) AS [Year],\n            SUM(CASE WHEN MONTH(DateField) = 1 THEN ValueField ELSE 0 END) AS [Jan],\n            SUM(CASE WHEN MONTH(DateField) = 2 THEN ValueField ELSE 0 END) AS [Feb],\n            SUM(CASE WHEN MONTH(DateField) = 3 THEN ValueField ELSE 0 END) AS [Mar],\n            SUM(CASE WHEN MONTH(DateField) = 4 THEN ValueField ELSE 0 END) AS [Apr],\n            SUM(CASE WHEN MONTH(DateField) = 5 THEN ValueField ELSE 0 END) AS [May],\n            SUM(CASE WHEN MONTH(DateField) = 6 THEN ValueField ELSE 0 END) AS [Jun],\n            SUM(CASE WHEN MONTH(DateField) = 7 THEN ValueField ELSE 0 END) AS [Jul],\n            SUM(CASE WHEN MONTH(DateField) = 8 THEN ValueField ELSE 0 END) AS [Aug],\n            SUM(CASE WHEN MONTH(DateField) = 9 THEN ValueField ELSE 0 END) AS [Sep],\n            SUM(CASE WHEN MONTH(DateField) = 10 THEN ValueField ELSE 0 END) AS [Oct],\n            SUM(CASE WHEN MONTH(DateField) = 11 THEN ValueField ELSE 0 END) AS [Nov],\n            SUM(CASE WHEN MONTH(DateField) = 12 THEN ValueField ELSE 0 END) AS [Dec],\n            SUM(ValueField) AS [Total]\n        FROM\n            YourTable\n        WHERE\n            DateField BETWEEN @StartDate AND @EndDate\n        GROUP BY\n            YEAR(DateField)\n        ORDER BY\n            [Year]'\n\n    EXEC sp_executesql @SQL, N'@StartDate DATE, @EndDate DATE', @StartDate, @EndDate\nEND