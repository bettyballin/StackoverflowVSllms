SELECT DISTINCT t.location,\n                l.city,\n                f.year,\n                f.customer,\n                SUM(CASE WHEN t.code = 'C' THEN NVL(t.sale_quantity, 0) ELSE 0 END) AS sale_quantity\nFROM loc t\nLEFT JOIN location l ON t.location = l.code\nLEFT JOIN father_table f ON f.number = t.number\nWHERE f.code = '0001'\n  AND f.c_code = '01'\n  AND t.co_code IN ('G', 'V', 'A', 'D')\n  AND f.year = '2008'\n  AND t.code IN ('C', 'S')\nGROUP BY t.location, l.city, f.year, f.customer\nORDER BY l.city, f.year;