-- Create a temp table\nCREATE TABLE session.temp_table AS (\n    SELECT * FROM your_monster_query\n) DEFINITION ONLY WITH NO DATA;\n\n-- Insert into the temp table\nINSERT INTO session.temp_table\nSELECT * FROM your_monster_query;\n\n-- Select from the temp table and delete from the old table\nDELETE FROM old_table\nWHERE EXISTS (\n    SELECT 1 FROM session.temp_table\n    WHERE old_table.id = session.temp_table.id\n);\n\n-- Select from the temp table and insert into a different table\nINSERT INTO different_table (columns)\nSELECT columns FROM session.temp_table;\n\n-- Drop temp table if needed\nDROP TABLE session.temp_table;