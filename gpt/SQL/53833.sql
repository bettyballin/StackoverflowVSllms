ALTER PROCEDURE [dbo].[slot_sp_EngineerTimeslots_Group]\n @PROPREF VARCHAR(50), \n @PRIORITYCODE VARCHAR(3),\n @JOBLENGTH INT = 0,\n @TIMESLOT VARCHAR(3) \nAS\nBEGIN\n    SET NOCOUNT ON;\n\n    DECLARE @TOTALDAYS INT;\n    DECLARE @TOTALDAYSTARGET INT;\n    DECLARE @COUNTER INT;\n    DECLARE @STARTTIME DATETIME;\n    DECLARE @MIDDAYTIME DATETIME;\n    DECLARE @ENDTIME DATETIME;\n    DECLARE @STARTDATE DATETIME;\n    DECLARE @iSTARTDATE DATETIME;\n    DECLARE @CONTRACT VARCHAR(10);\n\n    SET @iSTARTDATE = GETDATE();\n    SET @STARTDATE = CONVERT(DATETIME, CONVERT(VARCHAR(10), @iSTARTDATE, 120) + ' 00:00:00', 120);\n\n    SELECT @CONTRACT = CONTRACT \n    FROM [tbl_property] \n    WHERE [PROPREF] = @PROPREF;\n\n    -- Get the contract Start/MidDay/End times\n    SELECT \n        @STARTTIME = CONVERT(DATETIME, CONVERT(VARCHAR(10), @STARTDATE, 120) + ' ' + CONVERT(VARCHAR(5), ContractStartTime, 108)),\n        @MIDDAYTIME = CONVERT(DATETIME, CONVERT(VARCHAR(10), @STARTDATE, 120) + ' ' + CONVERT(VARCHAR(5), ContractMiddayTime, 108)), \n        @ENDTIME = CONVERT(DATETIME, CONVERT(VARCHAR(10), @STARTDATE, 120) + ' ' + CONVERT(VARCHAR(5), ContractEndTime, 108))\n    FROM [tbl_contract]\n    WHERE [tbl_contract].[CONTRACT] = @CONTRACT;\n\n    -- Get Priority Times\n    SELECT \n        @TOTALDAYS =\n            CASE \n                WHEN ROUND(NEARCOMPLETEDURATION/24, 0) < NEARCOMPLETEDURATION/24 THEN ROUND(NEARCOMPLETEDURATION/24, 0) + 1\n                ELSE ROUND(NEARCOMPLETEDURATION/24, 0) \n            END,\n        @TOTALDAYSTARGET =\n            CASE \n                WHEN ROUND(COMPLETEDURATION/24, 0) < COMPLETEDURATION/24 THEN ROUND(COMPLETEDURATION/24, 0) + 1\n                ELSE ROUND(COMPLETEDURATION/24, 0) \n            END \n    FROM [ltbl_order_priority]\n    WHERE [ltbl_order_priority].[CONTRACT] = @CONTRACT\n    AND [ltbl_order_priority].[PRIORITYCODE] = @PRIORITYCODE;\n\n    -- Initialize counter\n    SET @COUNTER = 0;\n\n    -- Create Temp Table\n    CREATE TABLE #TempEngineer\n    (\n        TempEngineer VARCHAR(30), \n        BookedDate DATETIME, \n        BookedFromTime DATETIME, \n        BookedToTime DATETIME, \n        TotalDays INT, \n        JobMins INT, \n        MinPMTime DATETIME, \n        BTime DATETIME\n    );\n\n    -- Ensure while loop or further logic is included here\n    -- Example of what might be next:\n    -- WHILE (@COUNTER < @TOTALDAYS)\n    -- BEGIN\n    --     -- Your logic here\n    --     SET @COUNTER = @COUNTER + 1;\n    -- END\n\nEND;