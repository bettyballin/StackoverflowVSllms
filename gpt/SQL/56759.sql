SELECT \n    t1.type,\n    t1.[no of times type occurs] AS [no of times type occurs],\n    t2.[no of times code occurs] AS [no of times code1 occurs],\n    (t2.[no of times code occurs] / t1.[no of times type occurs]) * 100 AS [% of times code1 occurs out of no of times type occurs],\n    (t2.[no of times code occurs] / (SELECT SUM([no of times code occurs]) FROM CodeTable)) * 100 AS [% of times code1 occurs out of no of times code occurs]\nFROM\n    (SELECT type, COUNT(type) AS [no of times type occurs]\n     FROM YourTable\n     GROUP BY type) AS t1\nINNER JOIN\n    (SELECT code, COUNT(code) AS [no of times code occurs]\n     FROM YourTable\n     WHERE code = 1\n     GROUP BY code) AS t2\nON t1.type = t2.code;