CREATE OR REPLACE FUNCTION concat_distinct(acc TEXT, instr TEXT)\nRETURNS TEXT AS $$\nDECLARE\n    result TEXT;\n    elements TEXT[];\n    element TEXT;\nBEGIN\n    -- Split the accumulated string into an array of elements\n    elements := string_to_array(acc, ';');\n    \n    -- Check if the new element already exists in the array\n    FOREACH element IN ARRAY elements LOOP\n        IF element = instr THEN\n            RETURN acc; -- If it exists, return the accumulated string unchanged\n        END IF;\n    END LOOP;\n    \n    -- If the element does not exist, concatenate it\n    IF acc IS NULL OR acc = '' THEN\n        result := instr;\n    ELSE\n        result := acc || ';' || instr;\n    END IF;\n    \n    RETURN result;\nEND;\n$$ LANGUAGE plpgsql;