-- Create a temporary table to store the sum of appearances per category\nCREATE TEMPORARY TABLE temp_category_sum AS\nSELECT category, SUM(appearances) AS total_appearances\nFROM your_table\nGROUP BY category;\n\n-- Update the ratio in the original table using the temporary table\nUPDATE your_table T\nJOIN temp_category_sum S ON T.category = S.category\nSET T.ratio = T.appearances / S.total_appearances;\n\n-- Drop the temporary table as it is no longer needed\nDROP TEMPORARY TABLE temp_category_sum;