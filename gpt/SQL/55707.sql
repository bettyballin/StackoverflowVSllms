-- Step 1: Add a new column\nALTER TABLE YourTable ADD NewColumn NVARCHAR(MAX);\n\n-- Step 2: Update the new column in batches\nDECLARE @BatchSize INT = 10000;\nDECLARE @RowCount INT;\nDECLARE @MaxID INT;\nDECLARE @MinID INT;\n\n-- Initialize the variable to keep track of the range\nSELECT @MinID = MIN(PrimaryKeyColumn), @MaxID = MAX(PrimaryKeyColumn)\nFROM YourTable;\n\nSET @RowCount = 1;\n\nWHILE (@RowCount > 0)\nBEGIN\n    -- Update the new column in batches\n    UPDATE TOP (@BatchSize) YourTable\n    SET NewColumn = CAST(OldColumn AS NVARCHAR(MAX))\n    WHERE PrimaryKeyColumn BETWEEN @MinID AND @MaxID AND NewColumn IS NULL;\n\n    -- Get the number of rows affected\n    SET @RowCount = @@ROWCOUNT;\n\n    -- Move to the next batch by adjusting the range\n    SET @MinID = (SELECT MIN(PrimaryKeyColumn) FROM YourTable WHERE NewColumn IS NULL);\nEND\n\n-- Step 3: Drop the old column and rename the new column\nALTER TABLE YourTable DROP COLUMN OldColumn;\nEXEC sp_rename 'YourTable.NewColumn', 'OldColumn', 'COLUMN';