SELECT t.id\nFROM topics t\nJOIN topic_tags tt ON t.id = tt.topicFk\nJOIN tags g ON tt.tagFk = g.id\nWHERE g.name IN ('a', 'b', 'c')\nGROUP BY t.id\nHAVING COUNT(DISTINCT g.name) = 3\nAND t.id NOT IN (\n    SELECT t_bad.id\n    FROM topics t_bad\n    JOIN topic_tags tt_bad ON t_bad.id = tt_bad.topicFk\n    JOIN tags b ON tt_bad.tagFk = b.id\n    WHERE b.name IN ('d', 'e', 'f')\n);