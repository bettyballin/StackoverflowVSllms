WITH CTE AS\n(\n    SELECT \n        DocNum, \n        CAST(DocEntry AS VARCHAR(MAX)) AS DocEntry\n    FROM \n        Temp5\n)\nSELECT \n    DocNum,\n    STUFF(\n        (SELECT ', ' + CAST(DocEntry AS VARCHAR(MAX))\n         FROM CTE AS InnerTable\n         WHERE InnerTable.DocNum = OuterTable.DocNum\n         FOR XML PATH('')), \n        1, 2, '') AS DocEntries\nFROM \n    CTE AS OuterTable\nGROUP BY \n    DocNum;