ALTER TRIGGER [dbo].[UpdateUniqueSubjectAfterInsertUpdate]\nON [dbo].[Contents]\nAFTER INSERT, UPDATE\nAS\nBEGIN\n    SET NOCOUNT ON;\n\n    -- Temporary table to hold the unique subjects\n    DECLARE @UpdatedContents TABLE (ContentId INT, UniqueSubject NVARCHAR(200));\n\n    -- Insert into the temporary table with initial unique subjects\n    INSERT INTO @UpdatedContents (ContentId, UniqueSubject)\n    SELECT ContentId, [dbo].[ToUriCleanText]([Subject])\n    FROM INSERTED;\n\n    -- Update the UniqueSubject column for each row in the temp table\n    UPDATE UC\n    SET UniqueSubject = UC.UniqueSubject + \n        COALESCE(CAST((SELECT COUNT(*) FROM [dbo].[Contents] \n                       WHERE UniqueSubject = UC.UniqueSubject AND ContentId <> UC.ContentId) AS NVARCHAR(10)), '')\n    FROM @UpdatedContents UC;\n\n    -- Apply the updates to the main table\n    UPDATE C\n    SET UniqueSubject = UC.UniqueSubject\n    FROM [dbo].[Contents] C\n    JOIN @UpdatedContents UC ON C.ContentId = UC.ContentId;\nEND