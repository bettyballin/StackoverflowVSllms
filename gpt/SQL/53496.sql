WITH RankedData AS (\n    SELECT\n        "GROUP",\n        ID,\n        VALUE,\n        ROW_NUMBER() OVER (PARTITION BY "GROUP" ORDER BY ID) AS rn\n    FROM\n        your_table\n),\nHierarchicalData AS (\n    SELECT\n        ID,\n        CASE\n            WHEN rn = 1 THEN 0\n            ELSE LAG(ID) OVER (PARTITION BY "GROUP" ORDER BY ID)\n        END AS Parent,\n        VALUE\n    FROM\n        RankedData\n)\nSELECT\n    ID,\n    Parent,\n    VALUE\nFROM\n    HierarchicalData\nORDER BY\n    ID;