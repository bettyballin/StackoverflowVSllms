WITH LatestPrices AS (\n    SELECT \n        ID,\n        ThingID,\n        PriceDateTime,\n        Price,\n        ROW_NUMBER() OVER (PARTITION BY ThingID ORDER BY PriceDateTime DESC) AS RowNum\n    FROM \n        Thing\n    WHERE \n        ThingID IN (1, 2, 3, 4, 5, 6)\n        AND PriceDateTime >= CAST(CONVERT(VARCHAR(10), GETDATE(), 120) AS DATETIME)\n)\nSELECT \n    ID,\n    ThingID,\n    PriceDateTime,\n    Price\nFROM \n    LatestPrices\nWHERE \n    RowNum = 1