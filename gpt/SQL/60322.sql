CREATE FUNCTION dbo.SplitString\n(\n    @input VARCHAR(4096),\n    @delimiter CHAR(1)\n)\nRETURNS @result TABLE (value VARCHAR(100))\nAS\nBEGIN\n    DECLARE @start INT, @end INT\n    SET @start = 1\n\n    WHILE @start <= LEN(@input)\n    BEGIN\n        SET @end = CHARINDEX(@delimiter, @input, @start)\n        IF @end = 0 \n            SET @end = LEN(@input) + 1\n\n        INSERT INTO @result (value)\n        VALUES (SUBSTRING(@input, @start, @end - @start))\n\n        SET @start = @end + 1\n    END\n\n    RETURN\nEND