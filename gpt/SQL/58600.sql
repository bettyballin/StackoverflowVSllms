WITH RandomizedDocuments AS (\n    SELECT \n        d.intid,\n        d.geoLng,\n        d.geoLat,\n        ROW_NUMBER() OVER (PARTITION BY d.geoLng, d.geoLat ORDER BY NEWID()) AS rn\n    FROM \n        Documents d\n)\nSELECT \n    intid, \n    geoLng, \n    geoLat\nFROM \n    RandomizedDocuments\nWHERE \n    rn = 1\nORDER BY \n    NEWID()\nOFFSET 0 ROWS FETCH NEXT @maxcount ROWS ONLY;