WITH EventLogs AS (\n    SELECT \n        Log_ID, \n        FB_ID, \n        [Date], \n        Log_Name, \n        Log_Type,\n        ROW_NUMBER() OVER (PARTITION BY FB_ID ORDER BY [Date], Log_ID) AS RowNum\n    FROM Logs\n), ChangedLogs AS (\n    SELECT \n        el1.Log_ID, \n        el1.FB_ID, \n        el1.[Date], \n        el1.Log_Name, \n        el1.Log_Type,\n        COALESCE(LAG(el1.Log_Name) OVER (PARTITION BY el1.FB_ID ORDER BY el1.[Date], el1.Log_ID), el1.Log_Name) AS Prev_Log_Name\n    FROM EventLogs el1\n)\nSELECT \n    Log_ID, \n    FB_ID, \n    [Date], \n    Log_Name, \n    Log_Type\nFROM ChangedLogs\nWHERE Prev_Log_Name <> Log_Name OR RowNum = 1\nAND RowNum = 1;