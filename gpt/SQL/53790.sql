DECLARE @TableName NVARCHAR(128) = 'YourTargetTableName';\nDECLARE @UpdateDate DATETIME = 'YourTargetUpdateDate';\n\n-- Step 1: Get the distinct field names to create dynamic columns for the pivot\nDECLARE @Columns NVARCHAR(MAX);\nSELECT @Columns = COALESCE(@Columns + ', ', '') + QUOTENAME(FieldName)\nFROM (SELECT DISTINCT FieldName FROM [ERAUser].[Audit] WHERE TableName = @TableName AND UpdateDate = @UpdateDate) AS FieldNames;\n\n-- Step 2: Construct the dynamic SQL for pivoting\nDECLARE @SQL NVARCHAR(MAX);\nSET @SQL = '\nSELECT ' + @Columns + ', PrimaryKeyValue, UserName, UpdateDate\nFROM\n(\n    SELECT FieldName, NewValue, PrimaryKeyValue, UserName, UpdateDate\n    FROM [ERAUser].[Audit]\n    WHERE TableName = @TableName AND UpdateDate = @UpdateDate\n) AS SourceTable\nPIVOT\n(\n    MAX(NewValue)\n    FOR FieldName IN (' + @Columns + ')\n) AS PivotTable;';\n\n-- Step 3: Execute the dynamic SQL\nEXEC sp_executesql @SQL, N'@TableName NVARCHAR(128), @UpdateDate DATETIME', @TableName = @TableName, @UpdateDate = @UpdateDate;