SELECT \n    v.Model,\n    v.Make,\n    MIN(v.SalePrice) AS MinSalePrice,\n    y.MinYear AS YearRegistered\nFROM \n    VehicleSales v\nJOIN \n    (SELECT \n         Model, \n         Make, \n         MIN(datepart(year, Registration)) AS MinYear\n     FROM \n         VehicleSales \n     GROUP BY \n         Model, \n         Make) y \nON \n    v.Model = y.Model AND \n    v.Make = y.Make AND \n    datepart(year, v.Registration) = y.MinYear\nGROUP BY \n    v.Model, \n    v.Make, \n    y.MinYear;