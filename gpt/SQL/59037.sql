WITH decoded_months AS (\n  SELECT A.identifier,\n         A.name,\n         TO_NUMBER(DECODE(A.month_no,\n                          1, 200803,\n                          2, 200804,\n                          3, 200805,\n                          4, 200806,\n                          5, 200807,\n                          6, 200808,\n                          7, 200809,\n                          8, 200810,\n                          9, 200811,\n                          10, 200812,\n                          11, 200701,\n                          12, 200702,\n                          NULL)) AS MONTH_NO,\n         TO_NUMBER(TO_CHAR(B.last_update_date, 'YYYYMM')) AS UPD_DATE\n    FROM table_a A,\n         table_b B\n   WHERE A.identifier = B.identifier\n)\nSELECT identifier,\n       name,\n       MONTH_NO,\n       UPD_DATE\n  FROM decoded_months\n WHERE MONTH_NO > UPD_DATE;