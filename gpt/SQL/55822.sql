-- Define the start date and end date for the period\nDECLARE @StartDate DATE = '2009-01-01';\nDECLARE @EndDate DATE = '2009-01-28';\n\n-- Generate a list of weekly dates within the period\nWITH DateRange AS (\n    SELECT @StartDate AS WeekStart\n    UNION ALL\n    SELECT DATEADD(WEEK, 1, WeekStart)\n    FROM DateRange\n    WHERE DATEADD(WEEK, 1, WeekStart) <= @EndDate\n)\n\n-- Count available billboards for each week\nSELECT \n    SUM(AvailableBoards) AS TotalAvailableBoards\nFROM (\n    SELECT \n        WeekStart,\n        (SELECT COUNT(IdBillboard)\n         FROM tBillboards\n         WHERE (StartDate IS NULL OR StartDate <= WeekStart)\n           AND (FinishDate IS NULL OR FinishDate >= WeekStart)) AS AvailableBoards\n    FROM DateRange\n) WeeklyCounts;\n\nOPTION (MAXRECURSION 0); -- Allow the CTE to recurse more than the default 100 iterations