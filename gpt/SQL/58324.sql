SELECT AVG(TIMESTAMPDIFF(SECOND, login.TIMESTAMP, logout.TIMESTAMP)) AS average_duration\nFROM LOGIN_LOG login\nJOIN LOGIN_LOG logout\nON login.PLAYER = logout.PLAYER\nAND login.ACTION = 'login'\nAND logout.ACTION = 'logout'\nAND logout.TIMESTAMP > login.TIMESTAMP\nWHERE NOT EXISTS (\n    SELECT 1\n    FROM LOGIN_LOG next_login\n    WHERE next_login.PLAYER = login.PLAYER\n    AND next_login.ACTION = 'login'\n    AND next_login.TIMESTAMP > login.TIMESTAMP\n    AND next_login.TIMESTAMP < logout.TIMESTAMP\n);