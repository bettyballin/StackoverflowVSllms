WITH CTE AS (\n    SELECT\n        EventTime,\n        EventValue,\n        ROW_NUMBER() OVER (ORDER BY EventTime) AS rn\n    FROM\n        EventTable\n),\nFilteredEvents AS (\n    SELECT\n        EventTime,\n        EventValue,\n        rn\n    FROM\n        CTE\n    WHERE\n        EventValue != (\n            SELECT EventValue\n            FROM CTE AS sub\n            WHERE sub.rn = CTE.rn - 1\n        )\n    UNION ALL\n    SELECT\n        EventTime,\n        EventValue,\n        rn\n    FROM\n        CTE\n    WHERE\n        rn = 1\n)\nSELECT\n    EventTime,\n    EventValue\nFROM\n    FilteredEvents\nORDER BY\n    EventTime;