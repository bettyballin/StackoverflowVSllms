SELECT\n    IPAddress.Status as status,\n    IPAddress.Address as ip,\n    IPAddress.PCName as pc_name,\n    MAX(CASE WHEN Numbers.Phone = 'CPU/' + IPAddress.PCName THEN 1 ELSE 0 END) as cpu_contact,\n    MAX(CASE WHEN Numbers.Phone = 'PC/' + IPAddress.PCName THEN 1 ELSE 0 END) as pc_contact,\n    MAX(CASE WHEN Numbers.Phone = 'LOGIN/' + IPAddress.PCName THEN 1 ELSE 0 END) as login_contact\nFROM IPAddress\nJOIN Numbers\n  ON 'CPU/' + IPAddress.PCName = Numbers.Phone\n  OR 'PC/' + IPAddress.PCName = Numbers.Phone\n  OR 'LOGIN/' + IPAddress.PCName = Numbers.Phone\nWHERE $where  --Generated In code\nGROUP BY IPAddress.Status, IPAddress.Address, IPAddress.PCName