WITH PivotData AS (\n  SELECT \n    c.COMPANY_NAME,\n    p.PRODUCT_NAME,\n    ps.SALE_COUNT\n  FROM \n    COMPANY c\n  JOIN \n    PRODUCT_SALE ps ON c.ID_COMPANY = ps.ID_COMPANY\n  JOIN \n    PRODUCT p ON ps.ID_PRODUCT = p.ID_PRODUCT\n)\nSELECT * FROM PivotData\nPIVOT (\n  SUM(SALE_COUNT)\n  FOR PRODUCT_NAME IN ('Product1' AS Product1, 'Product2' AS Product2, 'Product3' AS Product3)\n);