CREATE TABLE InvoiceNumbers (\n    InvoiceID INT IDENTITY(1,1) PRIMARY KEY,\n    InvoiceNumber VARCHAR(12) UNIQUE NOT NULL,\n    CreatedAt DATETIME DEFAULT GETDATE()\n)\n\nGO\n\nCREATE PROCEDURE GenerateUniqueInvoiceNumber\nAS\nBEGIN\n    DECLARE @InvoiceNumber VARCHAR(12)\n    DECLARE @Exists INT\n\n    -- Loop until a unique invoice number is generated\n    WHILE @Exists IS NULL OR @Exists > 0\n    BEGIN\n        -- Generate a random alphanumeric string of 12 characters\n        SET @InvoiceNumber = (\n            SELECT SUBSTRING(CONVERT(VARCHAR(40), NEWID()), 1, 12)\n        )\n\n        -- Check if the generated number is unique\n        SELECT @Exists = COUNT(*)\n        FROM InvoiceNumbers\n        WHERE InvoiceNumber = @InvoiceNumber\n    END\n\n    -- Insert the unique invoice number into the table\n    INSERT INTO InvoiceNumbers (InvoiceNumber)\n    VALUES (@InvoiceNumber)\n\n    -- Return the generated invoice number\n    SELECT @InvoiceNumber AS GeneratedInvoiceNumber\nEND\nGO