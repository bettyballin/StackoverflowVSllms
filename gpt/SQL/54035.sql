INSERT INTO Activities (actdate, actduration, ticketnumber)\nOUTPUT INSERTED.activityid, INSERTED.ticketnumber, INSERTED.actdate, INSERTED.actduration\nINTO #AggregatedResults\nSELECT \n    GETDATE() AS actdate, -- Assuming the current date/time for the new activity\n    SUM(DATEDIFF(MINUTE, startdate + starttime, enddate + endtime)) AS actduration, \n    ticketid AS ticketnumber\nFROM \n    ActivitySegments\nWHERE \n    segmentid IN (SELECT segmentid FROM @TempSegmentIds) -- Assuming you have populated temp table with segment IDs\nGROUP BY \n    ticketid;