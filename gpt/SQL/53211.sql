-- SQL Server 2000/2005\n\n-- Enable password policy check\nEXEC sp_configure 'show advanced options', 1;\nRECONFIGURE;\nEXEC sp_configure 'xp_cmdshell', 1;\nRECONFIGURE;\n\n-- Check for weak passwords\nEXEC xp_cmdshell 'net accounts /minpwlen:8';\nEXEC xp_cmdshell 'net accounts /minpwage:5';\n\n-- Check for weak SQL Login passwords\nSELECT name, password \nFROM master.dbo.sysxlogins\nWHERE LEN(password) < 8\nOR password IS NULL;\n\n-- Disable password policy check\nEXEC sp_configure 'xp_cmdshell', 0;\nRECONFIGURE;\nEXEC sp_configure 'show advanced options', 0;\nRECONFIGURE;