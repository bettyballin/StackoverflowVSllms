CREATE PROCEDURE GetNextIdentifier\nAS\nBEGIN\n    DECLARE @currentIdentifier CHAR(5)\n    DECLARE @nextIdentifier CHAR(5)\n\n    -- Get the current highest identifier\n    SELECT TOP 1 @currentIdentifier = identifier\n    FROM YourTable\n    ORDER BY CASE \n        WHEN identifier LIKE 'Z%' THEN 2\n        ELSE 1\n    END DESC, identifier DESC\n\n    -- Function to get the next identifier\n    SET @nextIdentifier = (\n        SELECT CASE\n            WHEN @currentIdentifier = 'ZZZZZ' THEN 'AAAAA'\n            ELSE\n                REVERSE(LEFT(REVERSE(@currentIdentifier), 1)) +\n                (\n                    SELECT\n                        CASE\n                            WHEN RIGHT(@currentIdentifier, 4) = 'ZZZZ' THEN 'A'\n                            ELSE\n                                CHAR(ASCII(RIGHT(@currentIdentifier, 1)) + 1)\n                        END\n                ) +\n                RIGHT(@currentIdentifier, 3)\n        END\n    )\n\n    -- Return the next identifier\n    SELECT @nextIdentifier AS NextIdentifier\nEND