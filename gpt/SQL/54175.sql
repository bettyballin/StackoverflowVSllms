-- Using table variables for logging\nDECLARE @LogTable TABLE (\n    LogID INT IDENTITY(1,1),\n    LogMessage NVARCHAR(1000)\n)\n\nBEGIN TRANSACTION\n\n    -- Logging using table variable\n    INSERT INTO @LogTable (LogMessage) VALUES ('Log message after myBusinessSPa')\n    EXEC @err = myBusinessSPa\n    IF (@err <> 0) BEGIN ROLLBACK TRANSACTION RETURN -1 END\n\n    INSERT INTO @LogTable (LogMessage) VALUES ('Log message after myBusinessSPb')\n    EXEC @err = myBusinessSPb\n    IF (@err <> 0) BEGIN ROLLBACK TRANSACTION RETURN -1 END\n\n    INSERT INTO @LogTable (LogMessage) VALUES ('Log message after myBusinessSPc')\n    EXEC @err = myBusinessSPc\n    IF (@err <> 0) BEGIN ROLLBACK TRANSACTION RETURN -1 END\n\nCOMMIT TRANSACTION\n\n-- Insert log entries into actual log table outside of transaction\nINSERT INTO myLogTable (LogMessage)\nSELECT LogMessage FROM @LogTable\n\nRETURN 0