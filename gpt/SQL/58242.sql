SELECT \n    p.PRPT_Id,\n    p.PRPT_Name,\n    COUNT(pi.PIMG_Id) AS ImageCount,\n    ISNULL(\n        (SELECT TOP 1 pi1.PIMG_ImageName \n         FROM PropertyImages pi1 \n         WHERE pi1.PRPT_Id = p.PRPT_Id \n           AND pi1.PIMG_Status = 1 \n         ORDER BY pi1.PIMG_Id), \n        '') AS FirstImageName\nFROM \n    Property p\nLEFT JOIN \n    PropertyImages pi ON p.PRPT_Id = pi.PRPT_Id AND pi.PIMG_Status = 1\nWHERE \n    p.PRPT_Status = 1\nGROUP BY \n    p.PRPT_Id, p.PRPT_Name;