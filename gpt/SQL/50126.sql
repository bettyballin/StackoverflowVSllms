CREATE TRIGGER trg_CheckDateOverlap\nON YourTable\nAFTER INSERT, UPDATE\nAS\nBEGIN\n    SET NOCOUNT ON;\n\n    -- Check for overlapping periods for the inserted/updated rows\n    IF EXISTS (\n        SELECT 1\n        FROM inserted i\n        JOIN YourTable t\n            ON t.UserId = i.UserId\n            AND t.Id <> i.Id\n            AND (\n                (i.DateFrom >= t.DateFrom AND i.DateFrom <= t.DateTo) OR\n                (i.DateTo >= t.DateFrom AND i.DateTo <= t.DateTo) OR\n                (i.DateFrom <= t.DateFrom AND i.DateTo >= t.DateTo)\n            )\n    )\n    BEGIN\n        -- If there is an overlap, raise an error\n        RAISERROR ('Overlapping periods detected for the same user.', 16, 1);\n        ROLLBACK TRANSACTION;\n    END\nEND;\nGO