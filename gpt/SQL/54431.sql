SELECT \n    p.sensor_id,\n    p.start_date,\n    (SELECT v.value \n     FROM values_table v \n     WHERE v.sensor_id = p.sensor_id \n       AND v.acquired >= p.start_date \n     ORDER BY v.acquired \n     FETCH FIRST ROW ONLY) AS v1,\n    p.end_date,\n    (SELECT v.value \n     FROM values_table v \n     WHERE v.sensor_id = p.sensor_id \n       AND v.acquired >= p.end_date \n     ORDER BY v.acquired \n     FETCH FIRST ROW ONLY) AS v2,\n    p.description\nFROM \n    periods_table p\nWHERE \n    p.sensor_id = :sensor_id\n    AND p.start_date < :range_end\n    AND p.end_date > :range_start;