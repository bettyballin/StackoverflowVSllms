-- Create a derived table with all dates in the past week\nWITH DateRange AS (\n    SELECT \n        CAST(GETDATE() - (9.0/24) - number AS DATE) AS open_day\n    FROM \n        master..spt_values\n    WHERE \n        type = 'P' AND number BETWEEN 0 AND 6\n)\nSELECT \n    dr.open_day,\n    COUNT(inc1.incident_id) AS Calls,\n    MAX(inc1.open_time) AS max_open_time\nFROM \n    DateRange dr\nLEFT JOIN \n    (SELECT\n        incident_id,\n        open_time - (9.0/24) AS open_time,\n        CAST(open_time - (9.0/24) AS DATE) AS open_day\n     FROM \n        incidentsm1 \n     WHERE \n        DATEDIFF(DAY, open_time - (9.0/24), GETDATE()) < 7\n    ) inc1\nON \n    dr.open_day = inc1.open_day\nGROUP BY \n    dr.open_day\nORDER BY \n    dr.open_day;