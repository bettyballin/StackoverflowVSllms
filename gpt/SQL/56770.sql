SELECT \n    S1.Id,\n    S1.Name,\n    S1.Parent,\n    S2.Id AS Child,\n    S2.Mark,\n    M.Ranking\nFROM \n    Students S1\nJOIN \n    Students S2 ON S1.Id = S2.Parent\nJOIN \n    Marks M ON S1.Name = M.Name\nWHERE \n    S2.Mark >= 20\nAND \n    S2.Mark = (\n        SELECT MAX(S3.Mark) \n        FROM Students S3 \n        WHERE S3.Parent = S1.Id AND S3.Mark >= 20\n    )\nORDER BY \n    S1.Id;