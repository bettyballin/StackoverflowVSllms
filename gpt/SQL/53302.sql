CREATE OR REPLACE FUNCTION safe_insert() RETURNS void AS $$\nDECLARE\n    rec RECORD;\nBEGIN\n    FOR rec IN SELECT * FROM staging_table LOOP\n        BEGIN\n            INSERT INTO your_table (st_fips, sfips, county_fip, cfips, pl_fips, id, elevation, population)\n            VALUES \n            (NULLIF(rec.st_fips, '')::integer, \n             NULLIF(rec.sfips, '')::integer, \n             NULLIF(rec.county_fip, '')::integer, \n             NULLIF(rec.cfips, '')::integer, \n             NULLIF(rec.pl_fips, '')::integer, \n             NULLIF(rec.id, '')::integer, \n             COALESCE(NULLIF(rec.elevation, ''), 0)::integer, \n             COALESCE(NULLIF(rec.population, ''), 0)::integer);\n        EXCEPTION WHEN OTHERS THEN\n            -- Log error or take some action\n            RAISE NOTICE 'Insert failed for record: %', rec;\n        END;\n    END LOOP;\nEND;\n$$ LANGUAGE plpgsql;