DECLARE @BatchSize INT = 1000;\nDECLARE @MinMatchId VARCHAR(50);\nDECLARE @MaxMatchId VARCHAR(50);\n\n-- Get the range of MatchIds to be processed\nSELECT @MinMatchId = MIN(MatchId), @MaxMatchId = MAX(MatchId)\nFROM MatchResult\nWHERE SOME_CONDITION;\n\nWHILE (@MinMatchId IS NOT NULL)\nBEGIN\n    -- Process a batch of rows\n    WITH CTE_MatchResult AS (\n        SELECT TOP (@BatchSize) MatchId \n        FROM MatchResult \n        WHERE SOME_CONDITION AND MatchId >= @MinMatchId\n        ORDER BY MatchId ASC\n    )\n    -- Deleting from MatchEvent\n    DELETE ME\n    FROM MatchEvent ME\n    INNER JOIN CTE_MatchResult MR ON ME.MatchId = MR.MatchId;\n\n    -- Deleting from MatchResult\n    DELETE MR\n    FROM MatchResult MR\n    INNER JOIN CTE_MatchResult CMR ON MR.MatchId = CMR.MatchId;\n\n    -- Get the next MatchId to continue processing\n    SELECT @MinMatchId = MIN(MatchId)\n    FROM MatchResult\n    WHERE SOME_CONDITION AND MatchId > @MinMatchId;\nEND