SELECT *\nFROM (\n    SELECT\n        c.CustomerID,\n        cat.CategoryName,\n        SUM(od.Quantity) AS TotalQuantity\n    FROM\n        Orders o\n        JOIN OrderDetails od ON o.OrderID = od.OrderID\n        JOIN Products p ON od.ProductID = p.ProductID\n        JOIN Categories cat ON p.CategoryID = cat.CategoryID\n        JOIN Customers c ON o.CustomerID = c.CustomerID\n    GROUP BY\n        c.CustomerID,\n        cat.CategoryName\n) \nPIVOT (\n    SUM(TotalQuantity)\n    FOR CategoryName IN ('Beverages' AS Beverages, 'Condiments' AS Condiments, 'Confections' AS Confections)\n) ORDER BY CustomerID;