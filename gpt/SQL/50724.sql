-- Create a temporary table to store the results of the stored procedure\nCREATE TABLE #TempTenantBalance (\n    TenantID INT,\n    TenantBalance DECIMAL(18, 2)\n);\n\n-- Insert the results of the stored procedure into the temporary table\nINSERT INTO #TempTenantBalance (TenantID, TenantBalance)\nEXEC YourStoredProcedureName;\n\n-- Now, join the temporary table with your main query\nSELECT t.TenantName, t.CarPlateNumber, t.CarColor, t.Sex, t.SSNO, t.Phone, t.Memo,\n       u.UnitNumber,\n       p.PropertyName,\n       tb.TenantBalance\nFROM tblTenant t\n    LEFT JOIN tblRentalUnit u ON t.UnitID = u.ID\n    LEFT JOIN tblProperty p ON u.PropertyID = p.ID\n    LEFT JOIN #TempTenantBalance tb ON t.ID = tb.TenantID\nORDER BY p.PropertyName, t.CarPlateNumber;\n\n-- Drop the temporary table after use\nDROP TABLE #TempTenantBalance;