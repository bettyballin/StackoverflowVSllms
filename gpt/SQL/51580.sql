-- Step 1: Create the ANI_Lookup table\nCREATE TABLE ANI_Lookup (\n    StoreID INT,\n    PhoneNumber VARCHAR(15) PRIMARY KEY\n);\n\n-- Step 2: Insert phone numbers based on priority\n\n-- Main/single store StorePhone\nINSERT INTO ANI_Lookup (StoreID, PhoneNumber)\nSELECT DISTINCT StoreID, StorePhone\nFROM Store_Info\nWHERE StorePhone IS NOT NULL\nAND NOT EXISTS (\n    SELECT 1 FROM ANI_Lookup\n    WHERE PhoneNumber = Store_Info.StorePhone\n);\n\n-- Main/single store AltPhone\nINSERT INTO ANI_Lookup (StoreID, PhoneNumber)\nSELECT DISTINCT StoreID, AltPhone\nFROM Store_Info\nWHERE AltPhone IS NOT NULL\nAND NOT EXISTS (\n    SELECT 1 FROM ANI_Lookup\n    WHERE PhoneNumber = Store_Info.AltPhone\n);\n\n-- Branch store StorePhone\n-- Assuming branch stores are identified by ParentID != 0\nINSERT INTO ANI_Lookup (StoreID, PhoneNumber)\nSELECT DISTINCT StoreID, StorePhone\nFROM Store_Info\nWHERE ParentID != 0\nAND StorePhone IS NOT NULL\nAND NOT EXISTS (\n    SELECT 1 FROM ANI_Lookup\n    WHERE PhoneNumber = Store_Info.StorePhone\n);\n\n-- Branch store AltPhone\nINSERT INTO ANI_Lookup (StoreID, PhoneNumber)\nSELECT DISTINCT StoreID, AltPhone\nFROM Store_Info\nWHERE ParentID != 0\nAND AltPhone IS NOT NULL\nAND NOT EXISTS (\n    SELECT 1 FROM ANI_Lookup\n    WHERE PhoneNumber = Store_Info.AltPhone\n);\n\n-- Main/single store contact Phone\nINSERT INTO ANI_Lookup (StoreID, PhoneNumber)\nSELECT DISTINCT Store_Contacts.StoreID, Store_Contacts.Phone\nFROM Store_Contacts\nJOIN Store_Info ON Store_Contacts.StoreID = Store_Info.StoreID\nWHERE Store_Contacts.Phone IS NOT NULL\nAND Store_Info.ParentID = 0\nAND NOT EXISTS (\n    SELECT 1 FROM ANI_Lookup\n    WHERE PhoneNumber = Store_Contacts.Phone\n);\n\n-- Branch store contact Phone\nINSERT INTO ANI_Lookup (StoreID, PhoneNumber)\nSELECT DISTINCT Store_Contacts.StoreID, Store_Contacts.Phone\nFROM Store_Contacts\nJOIN Store_Info ON Store_Contacts.StoreID = Store_Info.StoreID\nWHERE Store_Contacts.Phone IS NOT NULL\nAND Store_Info.ParentID != 0\nAND NOT EXISTS (\n    SELECT 1 FROM ANI_Lookup\n    WHERE PhoneNumber = Store_Contacts.Phone\n);\n\n-- Check the resulting data\nSELECT * FROM ANI_Lookup;