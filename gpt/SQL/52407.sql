CREATE VIEW DealsWithLatestComment AS\nSELECT d.DealID, d.Dealname, d.DealDetails, dc.dcID, dc.CommentTime, dc.CommentPerson, dc.Comment\nFROM Deals d\nLEFT JOIN (\n    SELECT dc1.*\n    FROM DealComments dc1\n    INNER JOIN (\n        SELECT DealID, MAX(CommentTime) AS LatestCommentTime\n        FROM DealComments\n        GROUP BY DealID\n    ) dc2 ON dc1.DealID = dc2.DealID AND dc1.CommentTime = dc2.LatestCommentTime\n) dc ON d.DealID = dc.DealID;