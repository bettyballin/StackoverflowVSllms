SELECT\n  to_char(shifted_date, 'IYYY') AS year,\n  to_char(shifted_date, 'IW') AS week,\n  SUM(tonnes) AS total_tonnes\nFROM (\n  SELECT\n    wid_date,\n    tonnes,\n    -- Shift the date by 7 hours back to align with your production week\n    wid_date - INTERVAL '7 hours' AS shifted_date\n  FROM production\n  WHERE to_char(wid_date, 'IYYY') = '2009'\n) AS subquery\nGROUP BY\n  to_char(shifted_date, 'IYYY'),\n  to_char(shifted_date, 'IW')\nORDER BY year, week;