WITH HierarchyCTE AS (\n    SELECT\n        Id,\n        ParentId,\n        Name,\n        Depth,\n        CAST(Id AS VARCHAR(MAX)) AS Path\n    FROM YourTable\n    WHERE ParentId IS NULL\n\n    UNION ALL\n\n    SELECT\n        t.Id,\n        t.ParentId,\n        t.Name,\n        t.Depth,\n        CAST(cte.Path + '>' + CAST(t.Id AS VARCHAR(MAX)) AS VARCHAR(MAX))\n    FROM YourTable t\n    INNER JOIN HierarchyCTE cte ON t.ParentId = cte.Id\n)\nSELECT\n    Id,\n    ParentId,\n    Name,\n    Depth\nFROM HierarchyCTE\nORDER BY Path;