CREATE FUNCTION dbo.SplitStringToInt\n(\n    @String NVARCHAR(MAX),\n    @Delimiter CHAR(1)\n)\nRETURNS @Result TABLE (Value INT)\nAS\nBEGIN\n    DECLARE @Index INT\n    DECLARE @Slice NVARCHAR(MAX)\n\n    SELECT @Index = 1\n    WHILE @Index > 0\n    BEGIN\n        SELECT @Index = CHARINDEX(@Delimiter, @String)\n        IF @Index > 0\n            SELECT @Slice = SUBSTRING(@String, 1, @Index - 1)\n        ELSE\n            SELECT @Slice = @String\n\n        INSERT INTO @Result(Value) VALUES(CAST(@Slice AS INT))\n\n        SELECT @String = SUBSTRING(@String, @Index + 1, LEN(@String) - @Index)\n        IF LEN(@String) = 0 BREAK\n    END\n    RETURN\nEND