SELECT l.*, \n       CASE l.reference_table_name\n           WHEN 'users' THEN u.name\n           WHEN 'services' THEN s.name\n           -- Add more cases as needed\n       END as reference_name\nFROM log l\nLEFT JOIN users u ON l.reference_table_name = 'users' AND l.reference_id = u.id\nLEFT JOIN services s ON l.reference_table_name = 'services' AND l.reference_id = s.id;\n-- Add more joins as needed