WITH foo_extended AS (\n    SELECT x, y, LAG(x, 1, 0) OVER (ORDER BY x) AS prev_x\n    FROM foo\n)\nSELECT y \nFROM foo_extended\nWHERE 21 > prev_x AND 21 <= x;