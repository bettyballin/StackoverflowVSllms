WITH DateRange AS (\n    SELECT CAST('2023-01-01' AS DATE) AS Date\n    UNION ALL\n    SELECT DATEADD(DAY, 1, Date)\n    FROM DateRange\n    WHERE DATEADD(DAY, 1, Date) <= '2023-12-31'\n)\nSELECT \n    d.Date,\n    COUNT(ul.userid) AS numlogins,\n    COUNT(DISTINCT ul.userid) AS numusers\nFROM \n    DateRange d\nLEFT JOIN \n    usagelog ul ON CONVERT(DATE, ul.entryts) = d.Date\nGROUP BY \n    d.Date\nORDER BY \n    d.Date\nOPTION (MAXRECURSION 0);