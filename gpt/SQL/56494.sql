CREATE TRIGGER trg_AfterInsertUpdate\n    ON dbo.Profiles\n    AFTER INSERT, UPDATE\n    AS\n    BEGIN\n        DECLARE @oldBlob VARBINARY(MAX);\n        DECLARE @newBlob VARBINARY(MAX);\n\n        -- Retrieve old BLOB for updates\n        IF EXISTS (SELECT * FROM inserted)\n        BEGIN\n            SELECT @newBlob = [Data]\n            FROM inserted;\n\n            SELECT @oldBlob = [Data]\n            FROM deleted;\n        END\n\n        -- Call the CLR stored procedure\n        EXEC ProcessBlob @oldBlob, @newBlob;\n    END