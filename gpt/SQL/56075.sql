SELECT duration, COUNT(*)\nINTO OUTFILE '/path/to/output/file'\nFROM (\n    SELECT TIMESTAMPDIFF(hour, startTime, endTime) AS duration FROM oct WHERE type='gen'\n    UNION ALL\n    SELECT TIMESTAMPDIFF(hour, startTime, endTime) AS duration FROM dec WHERE type='gen'\n    UNION ALL\n    SELECT TIMESTAMPDIFF(hour, startTime, endTime) AS duration FROM feb WHERE type='gen'\n    UNION ALL\n    SELECT TIMESTAMPDIFF(hour, startTime, endTime) AS duration FROM apr WHERE type='gen'\n) AS combined\nGROUP BY duration;