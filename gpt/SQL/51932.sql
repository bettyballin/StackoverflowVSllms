-- Ensure that these fields are indexed: \n-- TabDrawer.DrawerRef, QryAllTransactons.tpcdrawer, DrawerName, DrawerPostCode, DrawerSortCode, DrawerAccountNo, TPCChequeNumber\n-- TabTPC.TPCMember, TabCTP.CTPMember, TabCustomers.CustomerID\n\n-- Main Query\nSELECT \n    TabDrawer.DrawerName, \n    TabDrawer.DrawerSortCode, \n    TabDrawer.DrawerAccountNo, \n    TabDrawer.DrawerPostCode, \n    QryAllTransactons.TPCChequeNumber, \n    TabDrawer.DrawerRef\nFROM \n    TabDrawer \nLEFT JOIN \n    QryAllTransactons ON TabDrawer.DrawerRef = QryAllTransactons.tpcdrawer\nWHERE \n    (Forms!FrmSearchCompany!SearchName IS NULL OR [DrawerName] LIKE Forms!FrmSearchCompany!SearchName & "*") \n    AND (Forms!FrmSearchCompany!SearchPostcode IS NULL OR [DrawerPostCode] LIKE Forms!FrmSearchCompany!SearchPostcode & "*") \n    AND (Forms!FrmSearchCompany!SearchSortCode IS NULL OR [DrawerSortCode] LIKE Forms!FrmSearchCompany!SearchSortCode & "*") \n    AND (Forms!FrmSearchCompany!SearchAccount IS NULL OR [DrawerAccountNo] LIKE Forms!FrmSearchCompany!SearchAccount & "*") \n    AND (Forms!FrmSearchCompany!SearchCheque IS NULL OR [TPCChequeNumber] LIKE Forms!FrmSearchCompany!SearchCheque & "*");\n\n-- UNION Query\nSELECT \n    "TPC" AS Type, \n    TabTPC.TPCRef, \n    TabTPC.TPCBranch, \n    TabTPC.TPCDate, \n    TabTPC.TPCChequeNumber, \n    TabTPC.TPCChequeValue, \n    TabTPC.TPCFee, \n    TabTPC.TPCAction,\n    TabTPC.TPCMember, \n    TabTPC.TPCDrawer,\n    TabTPC.TPCUser,\n    TabTPC.TPCDiscount,\n    TabCustomers.*\nFROM \n    TabTPC \nINNER JOIN \n    TabCustomers ON TabTPC.TPCMember = TabCustomers.CustomerID\n\nUNION ALL\n\nSELECT \n    "CTP" AS Type, \n    TabCTP.CTPRef, \n    TabCTP.CTPBranch, \n    TabCTP.CTPDate, \n    TabCTP.CTPChequeNumb, \n    TabCTP.CTPAmount, \n    TabCTP.CTPFee, \n    TabCTP.CTPAction,\n    TabCTP.CTPMember,\n    0 AS CTPXXX,\n    TabCTP.CTPUser,\n    TabCTP.CTPDiscount, \n    TabCustomers.*\nFROM \n    TabCTP  \nINNER JOIN \n    TabCustomers ON TabCTP.CTPMember = TabCustomers.CustomerID;