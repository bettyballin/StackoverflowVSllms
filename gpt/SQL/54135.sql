-- Create the stored procedure in the master database\n   USE master;\n   GO\n   IF OBJECT_ID('sp_hexadecimal') IS NOT NULL\n       DROP PROCEDURE sp_hexadecimal;\n   GO\n   CREATE PROCEDURE sp_hexadecimal\n   (\n       @binvalue varbinary(256),\n       @hexvalue varchar(256) OUTPUT\n   )\n   AS\n   BEGIN\n       DECLARE @charvalue varchar(256);\n       DECLARE @i int;\n       DECLARE @length int;\n       DECLARE @hexstr char(16);\n       SELECT @charvalue = '0x';\n       SELECT @i = 1;\n       SELECT @length = DATALENGTH(@binvalue);\n       WHILE (@i <= @length)\n       BEGIN\n           SELECT @charvalue = @charvalue + SUBSTRING(@hexstr, (CONVERT(int, SUBSTRING(sys.fn_varbintohexsubstring(@binvalue, @i, 1), 1, 1)) + 1), 1)\n           SELECT @i = @i + 1;\n       END\n       SELECT @hexvalue = @charvalue;\n   END;\n   GO\n   IF OBJECT_ID('sp_help_revlogin') IS NOT NULL\n       DROP PROCEDURE sp_help_revlogin;\n   GO\n   CREATE PROCEDURE sp_help_revlogin\n   AS\n   BEGIN\n       DECLARE @name nvarchar(128);\n       DECLARE @type char(1);\n       DECLARE @hasaccess int;\n       DECLARE @denylogin int;\n       DECLARE @is_disabled int;\n       DECLARE @pwdhash varbinary(256);\n       DECLARE @dbname sysname;\n       DECLARE @sid varbinary(85);\n       DECLARE @bin_sid varbinary(85);\n       DECLARE @sidstr varchar(256);\n       DECLARE @defdb nvarchar(128);\n       DECLARE @deflang nvarchar(128);\n       DECLARE @hasaccessbit int;\n       DECLARE @denyloginbit int;\n       DECLARE @is_disabledbit int;\n       DECLARE @srvrole nvarchar(128);\n       DECLARE @rolerow bit;\n       DECLARE @is_policy_checked bit;\n       DECLARE @is_expiration_checked bit;\n       DECLARE @is_expiration_enabled bit;\n       DECLARE @is_policy_checkedbit int;\n       DECLARE @is_expiration_checkedbit int;\n       DECLARE @is_expiration_enabledbit int;\n       DECLARE @is_policy_checkedint int;\n       DECLARE @is_expiration_checkedint int;\n       DECLARE @is_expiration_enabledint int;\n       DECLARE @bin_pwdhash varbinary(256);\n       DECLARE @hex_pwdhash varchar(256);\n       DECLARE @hex_sid varchar(256);\n\n       -- Server roles\n       DECLARE @srvrolebit int;\n       DECLARE @srvrolename sysname;\n       DECLARE @srvroleid int;\n       DECLARE @roles cursor;\n\n       -- For each login\n       DECLARE login_cursor CURSOR FOR\n           SELECT\n               name, type, sid, is_disabled, is_policy_checked, is_expiration_checked\n           FROM\n               sys.sql_logins\n           WHERE\n               name NOT LIKE '##%##' -- Skip system logins\n           ORDER BY\n               name;\n\n       OPEN login_cursor;\n       FETCH NEXT FROM login_cursor INTO @name, @type, @sid, @is_disabled, @is_policy_checked, @is_expiration_checked;\n\n       WHILE @@FETCH_STATUS = 0\n       BEGIN\n           PRINT 'CREATE LOGIN [' + @name + ']'\n               + ' WITH PASSWORD = ' + @hex_pwdhash + ' HASHED'\n               + ', SID = ' + @hex_sid\n               + ', DEFAULT_DATABASE = [' + @defdb + ']'\n               + ', DEFAULT_LANGUAGE = [' + @deflang + ']'\n               + ', CHECK_POLICY = ' + CASE @is_policy_checked WHEN 1 THEN 'ON' ELSE 'OFF' END\n               + ', CHECK_EXPIRATION = ' + CASE @is_expiration_checked WHEN 1 THEN 'ON' ELSE 'OFF' END\n               + ', NO CREDENTIAL';\n           \n           FETCH NEXT FROM login_cursor INTO @name, @type, @sid, @is_disabled, @is_policy_checked, @is_expiration_checked;\n       END;\n\n       CLOSE login_cursor;\n       DEALLOCATE login_cursor;\n   END;\n   GO