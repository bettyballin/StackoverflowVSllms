WITH TaskHierarchy (TaskID, [Subject], ParentID, HierarchyLevel, HierarchyPath) AS\n(\n   -- Base case\n   SELECT\n      TaskID,\n      [Subject],\n      ParentID,\n      1 as HierarchyLevel,\n      CONVERT(VARCHAR(MAX), '/') AS HierarchyPath\n   FROM Task\n   WHERE TaskID = @ChildID  -- Start from the given Child ID\n\n   UNION ALL\n\n   -- Recursive step\n   SELECT\n      t.TaskID,\n      t.Subject,\n      t.ParentID,\n      th.HierarchyLevel + 1 AS HierarchyLevel,\n      CONVERT(varchar(MAX), th.HierarchyPath + CONVERT(VARCHAR(32), t.TaskID) + '/') AS HierarchyPath\n   FROM Task t\n      INNER JOIN TaskHierarchy th ON\n         th.ParentID = t.TaskID\n)\n\nSELECT *\nFROM TaskHierarchy\nORDER BY HierarchyLevel DESC, [Subject]