-- Step 1: Declare variables for dynamic SQL\nDECLARE @PivotSQL NVARCHAR(MAX);\nDECLARE @TempTableSQL NVARCHAR(MAX);\n\n-- Step 2: Generate the dynamic SQL for the pivot table\nSET @PivotSQL = '\n    SELECT *\n    FROM (\n        SELECT ColumnName, Value\n        FROM YourSourceTable\n    ) AS SourceTable\n    PIVOT (\n        MAX(Value)\n        FOR ColumnName IN ([Column1], [Column2], [Column3]) -- Adjust columns as needed\n    ) AS PivotTable;\n';\n\n-- Step 3: Create a temporary table based on the structure of the pivot table\nSET @TempTableSQL = '\n    SELECT TOP 0 *\n    INTO #TempPivotTable\n    FROM (\n        ' + @PivotSQL + '\n    ) AS PivotResult;\n';\n\n-- Step 4: Execute the dynamic SQL to create the temporary table\nEXEC sp_executesql @TempTableSQL;\n\n-- Step 5: Insert the results of the dynamic pivot table into the temporary table\nSET @PivotSQL = '\n    INSERT INTO #TempPivotTable\n    ' + @PivotSQL;\n\nEXEC sp_executesql @PivotSQL;\n\n-- Step 6: Verify the contents of the temporary table\nSELECT * FROM #TempPivotTable;\n\n-- Step 7: Drop the temporary table when done (optional)\n-- DROP TABLE #TempPivotTable;