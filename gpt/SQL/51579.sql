-- Find duplicates based on lat-lng combination\nSELECT lat, lng, COUNT(*)\nFROM Locations\nGROUP BY lat, lng\nHAVING COUNT(*) > 1;\n\n-- Delete duplicates, keeping the one with non-empty URL or the oldest one\nDELETE FROM Locations\nWHERE id NOT IN (\n    SELECT id FROM (\n        SELECT MIN(id) as id\n        FROM Locations\n        GROUP BY lat, lng\n        HAVING COUNT(*) > 1\n    ) as subquery\n)\nAND id IN (\n    SELECT id FROM (\n        SELECT id\n        FROM Locations a\n        WHERE url != ''\n        UNION\n        SELECT MIN(id) as id\n        FROM Locations b\n        WHERE url = ''\n        GROUP BY lat, lng\n    ) as subquery2\n);