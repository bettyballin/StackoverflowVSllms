WITH RankedVersions AS (\n    SELECT \n        ItemId,\n        ItemVersionId,\n        Year,\n        Value,\n        ROW_NUMBER() OVER (PARTITION BY ItemId, Year ORDER BY ItemVersionId DESC) AS rn\n    FROM \n        [table]\n)\nSELECT \n    ItemId,\n    ItemVersionId,\n    Year,\n    Value\nFROM \n    RankedVersions\nWHERE \n    rn = 1\nAND \n    ItemId = 1\nORDER BY \n    ItemId, Year;