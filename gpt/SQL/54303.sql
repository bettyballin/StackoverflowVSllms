SELECT wp.*\nFROM Workplan wp\nJOIN (\n    SELECT UserId, MAX(WorkplanDate) AS MaxDate\n    FROM Workplan\n    GROUP BY UserId\n) grouped_wp\nON wp.UserId = grouped_wp.UserId AND wp.WorkplanDate = grouped_wp.MaxDate