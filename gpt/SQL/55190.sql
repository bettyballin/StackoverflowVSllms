DROP TABLE IF EXISTS building;\nDROP TABLE IF EXISTS men;\nDROP TABLE IF EXISTS women;\n\nCREATE TABLE building(name VARCHAR(255));\nCREATE TABLE men(building VARCHAR(255), name VARCHAR(255));\nCREATE TABLE women(building VARCHAR(255), name VARCHAR(255));\n\nINSERT INTO building VALUES('building1');\nINSERT INTO building VALUES('building2');\nINSERT INTO building VALUES('building3');\nINSERT INTO men VALUES('building1', 'andy');\nINSERT INTO men VALUES('building1', 'barry');\nINSERT INTO men VALUES('building2', 'calvin');\nINSERT INTO men VALUES(null, 'dwain');\nINSERT INTO women VALUES('building1', 'alice');\nINSERT INTO women VALUES('building1', 'betty');\nINSERT INTO women VALUES(null, 'casandra');\n\nSELECT \n    b.name AS building_name,\n    COUNT(DISTINCT m.name) AS men_count,\n    GROUP_CONCAT(DISTINCT m.name) AS men,\n    COUNT(DISTINCT w.name) AS women_count,\n    GROUP_CONCAT(DISTINCT w.name) AS women,\n    COUNT(DISTINCT m.name) + COUNT(DISTINCT w.name) AS total_count\nFROM \n    building b\nLEFT JOIN \n    men m ON b.name = m.building\nLEFT JOIN \n    women w ON b.name = w.building\nGROUP BY \n    b.name;