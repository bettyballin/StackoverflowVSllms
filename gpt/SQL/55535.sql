SELECT\n    'Item' AS type,\n    i.ItemID,\n    i.ItemNumber AS prodid,\n    i.ItemName AS 'desc',\n    i.SellUnitMeasure AS unit,\n    i.SellUnitQuantity AS quantity,\n    i.VATExclusiveStandardCost AS pricein,\n    i.BaseSellingPrice AS priceout,\n    v1.VATPercentageRate AS vatRateIn,\n    1 AS vatTypeIn,\n    v1.VATCode AS VATCodeIn,\n    v1.VATCodeDescription AS VATCodeDescriptionIn,\n    v2.VATPercentageRate AS vatRateOut,\n    2 AS vatTypeOut,\n    v2.VATCode AS VATCodeOut,\n    v2.VATCodeDescription AS VATCodeDescriptionOut,\n    i.IsInactive AS inactive,\n    s.CardRecordID AS VendID,\n    i.SupplierItemNumber AS VendCode,\n    i.VATExclusiveStandardCost AS VendInPrice,\n    i.ItemDescription AS ProductNote,\n    i.CustomField1,\n    i.CustomField2,\n    i.CustomField3,\n    cl1.CustomListText AS CustomField4,\n    cl1.CustomListName AS CustomField4Name,\n    cl2.CustomListText AS CustomField5,\n    cl2.CustomListName AS CustomField5Name,\n    cl3.CustomListText AS CustomField6,\n    cl3.CustomListName AS CustomField6Name,\n    '' AS QuantityOnHand,\n    '' AS LocationName,\n    i.PriceIsInclusive,\n    i.ItemIsStocked,\n    ISNULL(l1.LocationName, ISNULL(l2.LocationName, 'Default Warehouse')) AS DefaultLocation,\n    i.PositiveAverageCost as cost,\n    CASE \n        WHEN EXISTS (SELECT 1 FROM BuildComponents bc WHERE bc.ComponentID = i.ItemID) THEN 'Y'\n        ELSE 'N'\n    END AS IsInBuildComponents\nFROM Items i\nLEFT JOIN ItemLocations il ON il.ItemID = i.ItemID AND il.ItemID IS NULL\nLEFT JOIN VATCodes v2 ON v2.VATCodeID = i.SellVATCodeID\nLEFT JOIN VATCodes v1 ON v1.VATCodeID = i.BuyVATCodeID\nLEFT JOIN Suppliers s ON s.SupplierID = i.PrimarySupplierID\nLEFT JOIN CustomLists cl1 ON cl1.CustomListID = i.CustomList1ID\nLEFT JOIN CustomLists cl2 ON cl2.CustomListID = i.CustomList2ID\nLEFT JOIN CustomLists cl3 ON cl3.CustomListID = i.CustomList3ID\nLEFT JOIN Locations l1 ON l1.LocationID = i.DefaultSellLocationID\nLEFT JOIN Locations l2 ON l2.LocationID = 1