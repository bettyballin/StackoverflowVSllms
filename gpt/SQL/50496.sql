DECLARE @sql NVARCHAR(MAX);\nDECLARE @sortOrder NVARCHAR(4) = 'DESC'; -- Example sort order\nDECLARE @OrderBy NVARCHAR(50) = 'surname'; -- Example column to order by\n\nSET @sql = N'SELECT * FROM #t_results ORDER BY ' +\n           CASE \n               WHEN @OrderBy = 'surname' THEN 'surname'\n               WHEN @OrderBy = 'forename' THEN 'forename'\n               WHEN @OrderBy = 'fullName' THEN 'fullName'\n               WHEN @OrderBy = 'userId' THEN 'userId'\n               WHEN @OrderBy = 'MobileNumber' THEN 'MSISDN'\n               WHEN @OrderBy = 'DeviceStatus' THEN 'DeviceStatus'\n               WHEN @OrderBy = 'LastPosition' THEN 'LastPosition'\n               WHEN @OrderBy = 'LastAlert' THEN 'LastAlert'\n               WHEN @OrderBy = 'LastCommunication' THEN 'LastCommunication'\n               WHEN @OrderBy = 'LastPreAlert' THEN 'LastPreAlert'\n               ELSE 'surname' -- Default column if none matched\n           END + ' ' + @sortOrder;\n\nEXEC sp_executesql @sql;