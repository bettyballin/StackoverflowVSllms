USE [msdb]\nGO\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nDECLARE @ProductVersion INT;\nSET @ProductVersion = CAST(SERVERPROPERTY('ProductMajorVersion') AS INT);\n\nIF @ProductVersion = 8\nBEGIN\n    -- SQL Server 2000 specific code\n    SELECT @@SERVERNAME, \n           jobs.name, \n           schedules.freq_type, \n           schedules.freq_interval, \n           schedules.freq_subday_type, \n           schedules.freq_subday_interval, \n           schedules.freq_relative_interval, \n           schedules.freq_recurrence_factor, \n           schedules.active_start_date, \n           schedules.active_end_date, \n           schedules.active_start_time, \n           schedules.active_end_time\n    FROM msdb..sysjobs jobs\n    JOIN msdb..sysjobschedules schedules ON jobs.job_id = schedules.job_id;\nEND\nELSE IF @ProductVersion = 9\nBEGIN\n    -- SQL Server 2005 specific code\n    SELECT @@SERVERNAME, \n           sysjobs.name, \n           dbo.udf_schedule_description(dbo.sysschedules.freq_type, \n                                        dbo.sysschedules.freq_interval, \n                                        dbo.sysschedules.freq_subday_type, \n                                        dbo.sysschedules.freq_subday_interval, \n                                        dbo.sysschedules.freq_relative_interval, \n                                        dbo.sysschedules.freq_recurrence_factor, \n                                        dbo.sysschedules.active_start_date, \n                                        dbo.sysschedules.active_end_date, \n                                        dbo.sysschedules.active_start_time, \n                                        dbo.sysschedules.active_end_time) AS [Schedule Description]\n    FROM msdb.dbo.sysjobs\n    JOIN msdb.dbo.sysschedules ON sysjobs.job_id = sysschedules.job_id;\nEND