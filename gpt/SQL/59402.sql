SELECT\n    fullname,\n    SUBSTRING_INDEX(fullname, ' ', 1) AS first_name,\n    CASE\n        WHEN LENGTH(SUBSTRING_INDEX(fullname, ' ', 2)) - LENGTH(SUBSTRING_INDEX(fullname, ' ', 1)) > 1\n        THEN SUBSTRING_INDEX(SUBSTRING_INDEX(fullname, ' ', 2), ' ', -1)\n        ELSE NULL\n    END AS middle_name,\n    SUBSTRING_INDEX(fullname, ' ', -1) AS last_name\nFROM\n    your_table;