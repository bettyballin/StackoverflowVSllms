DELIMITER $$\n\nDROP FUNCTION IF EXISTS `levenshtein`$$\n\nCREATE FUNCTION `levenshtein`(s1 VARCHAR(255), s2 VARCHAR(255)) RETURNS INT\nBEGIN\n    DECLARE s1_len, s2_len, i, j, c, c_temp, cost INT;\n    DECLARE s1_char CHAR;\n    DECLARE cv0, cv1 VARBINARY(256);\n\n    SET s1_len = CHAR_LENGTH(s1);\n    SET s2_len = CHAR_LENGTH(s2);\n    IF s1_len = 0 THEN\n        RETURN s2_len;\n    END IF;\n    IF s2_len = 0 THEN\n        RETURN s1_len;\n    END IF;\n\n    SET cv1 = 0x00;\n\n    SET j = 1;\n    WHILE j <= s2_len DO\n        SET cv1 = CONCAT(cv1, UNHEX(HEX(j)));\n        SET j = j + 1;\n    END WHILE;\n\n    SET i = 1;\n    WHILE i <= s1_len DO\n        SET s1_char = SUBSTRING(s1, i, 1);\n        SET c = i;\n        SET cv0 = UNHEX(HEX(i));\n        SET j = 1;\n        WHILE j <= s2_len DO\n            SET c = c + 1;\n            SET cost = IF(s1_char = SUBSTRING(s2, j, 1), 0, 1);\n            SET c_temp = CONV(HEX(SUBSTRING(cv1, j, 1)), 16, 10) + cost;\n            IF c > c_temp THEN SET c = c_temp; END IF;\n            SET c_temp = CONV(HEX(SUBSTRING(cv1, j+1, 1)), 16, 10) + 1;\n            IF c > c_temp THEN SET c = c_temp; END IF;\n            SET cv0 = CONCAT(cv0, UNHEX(HEX(c)));\n            SET j = j + 1;\n        END WHILE;\n        SET cv1 = cv0;\n        SET i = i + 1;\n    END WHILE;\n\n    RETURN c;\nEND$$\n\nDELIMITER ;