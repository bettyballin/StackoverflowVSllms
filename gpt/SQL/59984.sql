CREATE PROCEDURE ProcessOrder\n    @OrderId INT,\n    @PaymentAmount DECIMAL(10,2)\nAS\nBEGIN\n    BEGIN TRANSACTION;\n\n    BEGIN TRY\n        -- Deduct inventory\n        UPDATE Inventory\n        SET Quantity = Quantity - 1\n        WHERE ProductId = (SELECT ProductId FROM Orders WHERE OrderId = @OrderId);\n\n        -- Process payment\n        INSERT INTO Payments (OrderId, Amount)\n        VALUES (@OrderId, @PaymentAmount);\n\n        -- Create order record\n        UPDATE Orders\n        SET Status = 'Processed'\n        WHERE OrderId = @OrderId;\n\n        -- Commit transaction if all operations succeed\n        COMMIT TRANSACTION;\n    END TRY\n    BEGIN CATCH\n        -- Rollback transaction if any operation fails\n        ROLLBACK TRANSACTION;\n\n        -- Optionally, handle the error\n        DECLARE @ErrorMessage NVARCHAR(4000);\n        SET @ErrorMessage = ERROR_MESSAGE();\n        RAISERROR(@ErrorMessage, 16, 1);\n    END CATCH\nEND