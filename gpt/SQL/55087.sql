SELECT \n    `country`,\n    SUM(CASE WHEN MONTH(`when`) = 1 THEN 1 ELSE 0 END) AS `Jan`,\n    SUM(CASE WHEN MONTH(`when`) = 2 THEN 1 ELSE 0 END) AS `Feb`,\n    SUM(CASE WHEN MONTH(`when`) = 3 THEN 1 ELSE 0 END) AS `Mar`,\n    SUM(CASE WHEN MONTH(`when`) = 4 THEN 1 ELSE 0 END) AS `Apr`,\n    SUM(CASE WHEN MONTH(`when`) = 5 THEN 1 ELSE 0 END) AS `May`,\n    SUM(CASE WHEN MONTH(`when`) = 6 THEN 1 ELSE 0 END) AS `Jun`,\n    SUM(CASE WHEN MONTH(`when`) = 7 THEN 1 ELSE 0 END) AS `Jul`,\n    SUM(CASE WHEN MONTH(`when`) = 8 THEN 1 ELSE 0 END) AS `Aug`,\n    SUM(CASE WHEN MONTH(`when`) = 9 THEN 1 ELSE 0 END) AS `Sep`,\n    SUM(CASE WHEN MONTH(`when`) = 10 THEN 1 ELSE 0 END) AS `Oct`,\n    SUM(CASE WHEN MONTH(`when`) = 11 THEN 1 ELSE 0 END) AS `Nov`,\n    SUM(CASE WHEN MONTH(`when`) = 12 THEN 1 ELSE 0 END) AS `Dec`\nFROM \n    `metrics`\nWHERE \n    `projID` = 'projID'\n    AND `country` != 'XX'\n    AND `when` BETWEEN '$dateFrom' AND '$dateTo'\nGROUP BY \n    `country`;