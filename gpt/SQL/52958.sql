SELECT Items.Name, tblBooks.AuthorLastName, tblBooks.AuthorFirstName, Recommended.SKU\nFROM Items\nINNER JOIN (\n    SELECT TOP 10 Recommended.ProductCode, Recommended.SKU\n    FROM Recommended\n    INNER JOIN Stock ON Recommended.ProductCode = Stock.ProductCode\n    WHERE Stock.StatusCode = 1 AND Recommended.Type = 'TOPICAL'\n    ORDER BY CHECKSUM(NEWID())\n) AS TopRecommended ON Items.ProductCode = TopRecommended.ProductCode