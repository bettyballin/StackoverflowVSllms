SELECT \n    ip.ingredient_id, \n    ip.price, \n    ip.created_at\nFROM \n    ingredient_prices ip\nJOIN \n    (SELECT \n        ingredient_id, \n        MAX(created_at) AS max_created_at\n     FROM \n        ingredient_prices\n     GROUP BY \n        ingredient_id) latest_prices \nON \n    ip.ingredient_id = latest_prices.ingredient_id \n    AND ip.created_at = latest_prices.max_created_at;