SELECT\n    t.id AS thing_id,\n    COALESCE(MAX(CASE WHEN a.type = 'thing' THEN a.access END), \n             MAX(CASE WHEN a.type = 'group' THEN a.access END)) AS access\nFROM \n    things t\nLEFT JOIN \n    access a\nON \n    (a.user_id = 1 AND (\n        (a.type = 'thing' AND a.object_id = t.id) OR \n        (a.type = 'group' AND a.object_id = t.group_id)\n    ))\nGROUP BY \n    t.id\nORDER BY \n    t.id;