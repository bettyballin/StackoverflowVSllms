SET NOCOUNT ON;\n\nDECLARE @BatchSize INT = 10000;\n\nWHILE (1 = 1)\nBEGIN\n    WITH CTE AS (\n        SELECT TOP (@BatchSize)\n            RecordID,\n            ROW_NUMBER() OVER (PARTITION BY BusinessName, latitude, longitude, Phone ORDER BY webaddress DESC, caption1 DESC, caption2 DESC) AS RowNum\n        FROM \n            tl_acxiomimport.dbo.tblacxiomlistings\n    )\n    DELETE FROM CTE\n    WHERE RowNum > 1;\n\n    IF @@ROWCOUNT = 0\n        BREAK;\nEND;\n\nSET NOCOUNT OFF;