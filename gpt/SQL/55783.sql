CREATE PROCEDURE InsertCampaignWithRandomOrganisations\n    @Name NVARCHAR(100),\n    @Date DATETIME\nAS\nBEGIN\n    SET NOCOUNT ON;\n\n    -- Declare variables to hold random organization keys\n    DECLARE @Org1 INT, @Org2 INT, @Org3 INT, @Org4 INT, @Org5 INT;\n\n    -- Select 5 random records from Tbl_Organisations\n    WITH RandomOrganisations AS (\n        SELECT TOP 5 [Key]\n        FROM Tbl_Organisations\n        ORDER BY NEWID()\n    )\n    SELECT\n        @Org1 = MIN(CASE WHEN RowNum = 1 THEN [Key] END),\n        @Org2 = MIN(CASE WHEN RowNum = 2 THEN [Key] END),\n        @Org3 = MIN(CASE WHEN RowNum = 3 THEN [Key] END),\n        @Org4 = MIN(CASE WHEN RowNum = 4 THEN [Key] END),\n        @Org5 = MIN(CASE WHEN RowNum = 5 THEN [Key] END)\n    FROM (\n        SELECT [Key], ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) AS RowNum\n        FROM RandomOrganisations\n    ) AS NumberedOrganisations;\n\n    -- Insert the new campaign record into Tbl_Campaigns\n    INSERT INTO Tbl_Campaigns ([name], [date], [organisation_1], [organisation_2], [organisation_3], [organisation_4], [organisation_5])\n    VALUES (@Name, @Date, @Org1, @Org2, @Org3, @Org4, @Org5);\nEND