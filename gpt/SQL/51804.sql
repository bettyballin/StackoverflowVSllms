WITH UnpivotedData AS (\n    SELECT\n        Timestamp,\n        SUBSTRING(ColumnName, 2, 4) AS ItemIndex,\n        SUBSTRING(ColumnName, 1, 1) AS Aspect,\n        Value\n    FROM (\n        SELECT\n            Timestamp,\n            A0001, A0002, A0003, A0004,\n            B0001, B0002, B0003, B0004\n        FROM YourTableName\n    ) AS SourceTable\n    UNPIVOT (\n        Value FOR ColumnName IN (\n            A0001, A0002, A0003, A0004,\n            B0001, B0002, B0003, B0004\n        )\n    ) AS Unpvt\n),\nSummedData AS (\n    SELECT\n        ItemIndex,\n        Aspect,\n        SUM(Value) AS TotalValue\n    FROM UnpivotedData\n    GROUP BY ItemIndex, Aspect\n)\nSELECT\n    ItemIndex,\n    MAX(CASE WHEN Aspect = 'A' THEN TotalValue ELSE 0 END) AS AValue,\n    MAX(CASE WHEN Aspect = 'B' THEN TotalValue ELSE 0 END) AS BValue\nFROM SummedData\nGROUP BY ItemIndex\nORDER BY ItemIndex;