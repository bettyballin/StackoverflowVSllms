-- Assuming your table is named 'work_table' and has a column 'status' to indicate if the row is being processed or not\n-- Also assuming there is an 'id' column as the primary key\n\n-- Step 1: Start a transaction\nSTART TRANSACTION;\n\n-- Step 2: Select a chunk of 100 items that are not being processed\nSELECT id\nFROM work_table\nWHERE status = 'pending'\nLIMIT 100\nFOR UPDATE SKIP LOCKED;\n\n-- Step 3: Update the status of the selected items to 'processing'\nUPDATE work_table\nSET status = 'processing'\nWHERE id IN (\n    SELECT id\n    FROM (\n        SELECT id\n        FROM work_table\n        WHERE status = 'pending'\n        LIMIT 100\n        FOR UPDATE SKIP LOCKED\n    ) AS ids\n);\n\n-- Step 4: Commit the transaction\nCOMMIT;