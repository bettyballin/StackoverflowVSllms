CREATE PROCEDURE GetLeadReportData\nAS\nBEGIN\n    -- Create temporary tables\n    CREATE TABLE #Temp1 (\n        Year INT,\n        MonthNumber INT,\n        MonthName VARCHAR(20),\n        Value DECIMAL(10, 2)\n    );\n    \n    CREATE TABLE #Temp2 (\n        Year INT,\n        MonthNumber INT,\n        MonthName VARCHAR(20),\n        Value DECIMAL(10, 2),\n        RunningTotal DECIMAL(10, 2)\n    );\n\n    -- Insert data into #Temp1\n    INSERT INTO #Temp1 (Year, MonthNumber, MonthName, Value)\n    SELECT \n        YEAR(StartDate) AS Year,\n        MONTH(StartDate) AS MonthNumber,\n        DATENAME(MONTH, StartDate) AS MonthName,\n        Value / NumberOfMonths AS Value\n    FROM Table1\n    CROSS APPLY (\n        SELECT TOP(NumberOfMonths) \n            DATEADD(MONTH, ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) - 1, StartDate) AS StartDate\n        FROM master..spt_values\n    ) AS MonthIncrements;\n\n    -- Calculate running totals and insert into #Temp2\n    DECLARE @RunningTotal DECIMAL(10, 2) = 0;\n\n    INSERT INTO #Temp2 (Year, MonthNumber, MonthName, Value, RunningTotal)\n    SELECT \n        Year,\n        MonthNumber,\n        MonthName,\n        Value,\n        @RunningTotal := @RunningTotal + Value\n    FROM #Temp1\n    ORDER BY Year, MonthNumber;\n\n    -- Return results\n    SELECT * FROM #Temp2;\n\n    -- Clean up\n    DROP TABLE #Temp1;\n    DROP TABLE #Temp2;\nEND;