WITH PhotoWindow AS (\n    SELECT\n        id,\n        ROW_NUMBER() OVER (ORDER BY id) AS rn\n    FROM\n        photos\n),\nTargetPhoto AS (\n    SELECT\n        rn\n    FROM\n        PhotoWindow\n    WHERE\n        id = :currentphoto\n),\nWindowPhotos AS (\n    SELECT\n        p.id\n    FROM\n        PhotoWindow p,\n        TargetPhoto t\n    WHERE\n        ABS(p.rn - t.rn) < 5\n    ORDER BY\n        p.rn\n    LIMIT 9\n)\nSELECT\n    id\nFROM\n    WindowPhotos\nORDER BY\n    id;