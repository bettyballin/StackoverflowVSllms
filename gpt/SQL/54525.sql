WITH Ranked AS (\n    SELECT \n        col1, \n        ROW_NUMBER() OVER (ORDER BY col1) AS rn\n    FROM tbl1\n),\nPartitioned AS (\n    SELECT \n        col1,\n        rn,\n        (rn - 1) % 3 AS col_group,\n        (rn - 1) / 3 + 1 AS row_number\n    FROM Ranked\n)\nSELECT \n    MAX(CASE WHEN col_group = 0 THEN col1 END) AS col1, \n    MAX(CASE WHEN col_group = 1 THEN col1 END) AS col2, \n    MAX(CASE WHEN col_group = 2 THEN col1 END) AS col3 \nFROM Partitioned\nGROUP BY row_number\nORDER BY row_number;