SELECT \n    MAX(CASE WHEN Name = 'N1' THEN Name END) AS Name1,\n    MAX(CASE WHEN Name = 'N2' THEN Name END) AS Name2,\n    MAX(CASE WHEN Name = 'N3' THEN Name END) AS Name3,\n    MAX(CASE WHEN Name = 'N4' THEN Name END) AS Name4\nFROM (\n    SELECT Name, Id, ROW_NUMBER() OVER (PARTITION BY Name ORDER BY Id) AS RowNum\n    FROM YourTable\n) AS SourceTable\nGROUP BY RowNum\nORDER BY RowNum;