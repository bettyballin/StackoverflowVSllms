WITH RankedTableB AS (\n    SELECT\n        TableA.ID AS TableA_ID,\n        TableA.Name AS TableA_Name,\n        TableB.Name AS TableB_Name,\n        TableB.DateStamp,\n        ROW_NUMBER() OVER (PARTITION BY TableA.ID ORDER BY TableB.DateStamp DESC) AS rn\n    FROM TableA\n    INNER JOIN TableB ON TableA.ID = TableB.TableA_ID\n)\nSELECT\n    TableA_ID AS ID,\n    TableA_Name AS Name,\n    TableB_Name,\n    DateStamp\nFROM RankedTableB\nWHERE rn = 1;