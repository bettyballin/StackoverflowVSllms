WITH cte AS (\n    SELECT *, \n           LEAD(grp1, 1) OVER () AS next_grp1,\n           LEAD(grp2, 1) OVER () AS next_grp2,\n           ...\n           LEAD(grpn, 1) OVER () AS next_grpn\n    FROM your_table\n)\nSELECT *\nFROM cte\nWHERE (grp1 = 0 OR grp1 <> 0 AND next_grp1 = 0)\n  AND (grp2 = 0 OR grp2 <> 0 AND next_grp2 = 0)\n  ...\n  AND (grpn = 0 OR grpn <> 0 AND next_grpn = 0)