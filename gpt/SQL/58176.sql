WITH RankedIssues AS (\n    SELECT \n        custid, \n        prodid, \n        issue, \n        qty, \n        datesold,\n        ROW_NUMBER() OVER (PARTITION BY prodid ORDER BY datesold DESC) AS rn\n    FROM \n        SalesTable\n    WHERE \n        custid = 1\n)\nSELECT \n    custid, \n    prodid, \n    issue, \n    qty, \n    datesold\nFROM \n    RankedIssues\nWHERE \n    rn = 1;