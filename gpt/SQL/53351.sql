CREATE VIEW UserProperties AS\nSELECT \n    u.Name, \n    u.Age,\n    MAX(CASE WHEN pc.PropertyCodeName = 'CarMake' THEN pcv.PropertValue END) AS CarMake,\n    MAX(CASE WHEN pc.PropertyCodeName = 'PhoneType' THEN pcv.PropertValue END) AS PhoneType\nFROM \n    User u\nJOIN \n    UserPropertyValues upv ON u.UserID = upv.UserID\nJOIN \n    PropertyCodeValues pcv ON upv.PropertyCodeValueID = pcv.PropertyCodeValueID\nJOIN \n    PropertyCodes pc ON pcv.PropertyCodeID = pc.PropertyCodeID\nGROUP BY \n    u.Name, u.Age;