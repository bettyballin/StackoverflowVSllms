DELIMITER $$\n\nCREATE PROCEDURE get_limited_sum()\nBEGIN\n    DECLARE total_sum INT DEFAULT 0;\n    DECLARE done INT DEFAULT 0;\n    DECLARE cur CURSOR FOR SELECT userid, size FROM your_table ORDER BY userid;\n    DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = 1;\n\n    DROP TEMPORARY TABLE IF EXISTS temp_table;\n    CREATE TEMPORARY TABLE temp_table (userid INT, size INT);\n\n    OPEN cur;\n    read_loop: LOOP\n        DECLARE u_id INT;\n        DECLARE u_size INT;\n        \n        FETCH cur INTO u_id, u_size;\n        IF done THEN\n            LEAVE read_loop;\n        END IF;\n        \n        IF total_sum + u_size <= 150 THEN\n            SET total_sum = total_sum + u_size;\n            INSERT INTO temp_table VALUES (u_id, u_size);\n        END IF;\n    END LOOP;\n\n    CLOSE cur;\n\n    SELECT * FROM temp_table;\nEND $$\n\nDELIMITER ;