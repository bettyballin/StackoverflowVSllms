-- Compare data in Table A\nSELECT * FROM (\n    SELECT 'DEV' AS ENV, name FROM DEV.dbo.TableA\n    UNION ALL\n    SELECT 'TEST' AS ENV, name FROM TEST.dbo.TableA\n) AS CombinedA\nGROUP BY name\nHAVING COUNT(DISTINCT ENV) = 1;\n\n-- Compare data in Table B\nSELECT * FROM (\n    SELECT 'DEV' AS ENV, a.name, b.item FROM DEV.dbo.TableB b\n    JOIN DEV.dbo.TableA a ON b.fk_id = a.id\n    UNION ALL\n    SELECT 'TEST' AS ENV, a.name, b.item FROM TEST.dbo.TableB b\n    JOIN TEST.dbo.TableA a ON b.fk_id = a.id\n) AS CombinedB\nGROUP BY name, item\nHAVING COUNT(DISTINCT ENV) = 1;