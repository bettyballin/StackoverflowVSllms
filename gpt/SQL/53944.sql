-- Create temporary table to hold the time slots\nCREATE TABLE #Temp (VisitingCount int, [Time] int);\n\nDECLARE @DateNow DATETIME, @i int, @Time int;\nSET @DateNow = '00:00';\nSET @i = 0;\n\n-- Populate the temporary table with all time slots for the day\nWHILE (@i < 48)\nBEGIN\n    SET @Time = (@i); -- Time slot represented in 30-minute intervals\n    INSERT INTO #Temp (VisitingCount, [Time]) VALUES (0, @Time);\n    SET @i = @i + 1;\nEND\n\n-- Select the sum of VisitingCount for each time slot\nSELECT SUM(VisitingCount) AS VisitingCount, [Time]\nFROM #Temp\nGROUP BY [Time]\n\nUNION ALL\n\n-- Select actual visiting counts from the log within the specified range\nSELECT COUNT(page) AS VisitingCount, \n       (DATEPART(hour, Date) * 60 + DATEPART(minute, Date)) / 30 AS [Time]\nFROM scr_SecuristLog\nWHERE Date BETWEEN '2009-05-04 10:30' AND '2009-05-04 12:30'\nGROUP BY (DATEPART(hour, Date) * 60 + DATEPART(minute, Date)) / 30\n\nORDER BY [Time];\n\n-- Drop the temporary table\nDROP TABLE #Temp;