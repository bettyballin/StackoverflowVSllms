SELECT  \n    COUNT(TBL_PROPERTY.PROPREF) AS TotalOrders,\n    COUNT(CASE WHEN TBL_REPAIR_ORDER.STATUS <> 'Completed' THEN TBL_PROPERTY.PROPREF END) AS IncompleteOrders\nFROM    \n    TBL_PROPERTY \n    INNER JOIN TBL_REPAIR_ORDER ON TBL_PROPERTY.PROPREF = TBL_REPAIR_ORDER.PROPREF \n    INNER JOIN TBL_REPAIR_VISIT ON TBL_REPAIR_ORDER.ORDERID = TBL_REPAIR_VISIT.ORDERID \n    INNER JOIN TBL_CONTRACT ON TBL_REPAIR_ORDER.CONTRACT = TBL_CONTRACT.CONTRACT\nWHERE   \n    TBL_CONTRACT.CONTRACT IN ('STE') AND\n    TBL_REPAIR_ORDER.RAISEDDATE BETWEEN '2008-12-01' AND DATEADD(hh, 23, '2009-01-01')