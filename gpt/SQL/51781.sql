SELECT \n    p.ProductID,\n    p.ProductName,\n    MAX(CASE WHEN pm.MetaKey = 'Color' THEN pm.MetaValue END) AS Color,\n    MAX(CASE WHEN pm.MetaKey = 'Size' THEN pm.MetaValue END) AS Size,\n    MAX(CASE WHEN pm.MetaKey = 'Weight' THEN pm.MetaValue END) AS Weight\nFROM \n    Products p\nJOIN \n    ProductMeta pm ON p.ProductID = pm.ProductID\nGROUP BY \n    p.ProductID, p.ProductName