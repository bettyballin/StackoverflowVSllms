CREATE VIEW RecentRecordSum7Days AS\nSELECT \n    t.ID,  \n    SUM(t.SomeValue) AS ValueSum,\n    dr.StartDate\nFROM \n    SomeTable t\nCROSS JOIN\n    dbo.GetRecentDates(7) dr\nWHERE \n    t.RecordDate >= dr.StartDate\nGROUP BY \n    t.ID, \n    dr.StartDate\n\nCREATE VIEW RecentRecordSum14Days AS\nSELECT \n    t.ID,  \n    SUM(t.SomeValue) AS ValueSum,\n    dr.StartDate\nFROM \n    SomeTable t\nCROSS JOIN\n    dbo.GetRecentDates(14) dr\nWHERE \n    t.RecordDate >= dr.StartDate\nGROUP BY \n    t.ID, \n    dr.StartDate