DECLARE @strSQL NVARCHAR(MAX)\n\n-- Construct the inner query for the linked server\nSET @strSQL = 'SELECT FileName, path, size, vpath \n               FROM "GRIP-SERVER"."Web2"..SCOPE() \n               WHERE CONTAINS(*, ''"reiseportal*"'' )'\n\n-- Construct the final query with the inner query embedded\nSET @strSQL = 'SELECT DISTINCT DOC.ID_Kandidat, IDXS.* \n               FROM OPENQUERY([GRIP-SERVER], ''' + @strSQL + ''') AS IDXS \n               INNER JOIN tblK_Dokumente AS DOC \n               ON DOC.Link = IDXS.[FileName] \n               ORDER BY ID_Kandidat'\n\n-- Execute the final query\nEXEC sp_executesql @statement = @strSQL