DECLARE @date1 smalldatetime, @date2 smalldatetime, @page nvarchar(100), @sum int;\n\nSET @date1 = '2009-06-06';\nSET @date2 = '2009-06-13';\nSET @page = 'Tüm Sayfalar';\n\nSELECT @sum = SUM(t.[VISITINGCOUNT])\nFROM (\n    SELECT COUNT(page) AS [VISITINGCOUNT], \n           CAST(DATENAME(year, DATE) + '-' + DATENAME(month, DATE) + '-' + DATENAME(day, DATE) AS smalldatetime) AS [DATE]\n    FROM scr_StatisticaLog\n    WHERE Date BETWEEN @date1 AND @date2\n      AND (Page = @page OR @page = 'Tüm Sayfalar')\n      AND ProcessType = 'PageView'\n    GROUP BY CAST(DATENAME(year, DATE) + '-' + DATENAME(month, DATE) + '-' + DATENAME(day, DATE) AS smalldatetime)\n) AS t;\n\nSELECT 100 * (t.[VISITINGCOUNT] / @sum), t.[DATE]\nFROM (\n    SELECT COUNT(page) AS [VISITINGCOUNT], \n           CAST(DATENAME(year, DATE) + '-' + DATENAME(month, DATE) + '-' + DATENAME(day, DATE) AS smalldatetime) AS [DATE]\n    FROM scr_StatisticaLog\n    WHERE Date BETWEEN @date1 AND @date2\n      AND (Page = @page OR @page = 'Tüm Sayfalar')\n      AND ProcessType = 'PageView'\n    GROUP BY CAST(DATENAME(year, DATE) + '-' + DATENAME(month, DATE) + '-' + DATENAME(day, DATE) AS smalldatetime)\n) AS t;