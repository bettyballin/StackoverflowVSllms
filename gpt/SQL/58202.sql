CREATE PROCEDURE YourStoredProcedure\nAS\nBEGIN\n    BEGIN TRY\n        -- Your main code here\n\n        -- If everything is successful\n        COMMIT TRANSACTION;\n    END TRY\n    BEGIN CATCH\n        -- Handle the error\n        DECLARE \n            @ErrorMessage NVARCHAR(4000),\n            @ErrorSeverity INT,\n            @ErrorState INT,\n            @ErrorLine INT,\n            @ErrorProcedure NVARCHAR(128),\n            @ErrorNumber INT;\n\n        -- Capture error details\n        SELECT \n            @ErrorMessage = ERROR_MESSAGE(),\n            @ErrorSeverity = ERROR_SEVERITY(),\n            @ErrorState = ERROR_STATE(),\n            @ErrorLine = ERROR_LINE(),\n            @ErrorProcedure = ERROR_PROCEDURE(),\n            @ErrorNumber = ERROR_NUMBER();\n\n        -- Rollback the transaction\n        ROLLBACK TRANSACTION;\n\n        -- Print error details for debugging\n        PRINT '-----START: ERROR DETAILS-----';\n        PRINT @ErrorNumber;\n        PRINT @ErrorSeverity;\n        PRINT @ErrorState;\n        PRINT @ErrorProcedure;\n        PRINT @ErrorLine;\n        PRINT @ErrorMessage;\n        PRINT '-----END: ERROR DETAILS-----';\n\n        -- Insert error information into the myErrors table\n        INSERT INTO dbo.myErrors\n            ([ErrorMessage], [ErrorSeverity], [DateCreated])\n        VALUES\n            (@ErrorMessage, @ErrorSeverity, GETUTCDATE());\n\n        -- Raise the error again\n        RAISERROR (@ErrorMessage, @ErrorSeverity, 1);\n    END CATCH\nEND;