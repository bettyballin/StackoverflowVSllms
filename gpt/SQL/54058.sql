SELECT \n    (SELECT TOP 1 c.SignalRec \n     FROM config c \n     JOIN bases b ON c.RecBy = b.NameNum\n     WHERE c.ID = m.ID AND b.Name = m.RecBy \n     ORDER BY -- your ordering logic here\n    ) AS cfgSignalRec,\n    (SELECT TOP 1 c.SignalOut \n     FROM config c \n     JOIN bases b ON c.RecBy = b.NameNum\n     WHERE c.ID = m.ID AND b.Name = m.RecBy \n     ORDER BY -- your ordering logic here\n    ) AS cfgSignalOut\nFROM messages m\n-- Add additional joins or conditions here if necessary