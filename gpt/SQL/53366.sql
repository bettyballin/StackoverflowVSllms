SELECT\n    s.username,\n    s.forename,\n    a.assignmentID,\n    t.taskID,\n    IFNULL(g.grade, 'u') AS grade\nFROM\n    students s\n    CROSS JOIN assignment_tasks at\n    JOIN tasks t ON at.taskID = t.taskID\n    JOIN assignment a ON at.assignmentID = a.assignmentID\n    LEFT JOIN (\n        SELECT\n            g.username,\n            g.taskID,\n            g.grade\n        FROM\n            grades g\n            JOIN (\n                SELECT \n                    username, \n                    taskID, \n                    MAX(date) AS max_date \n                FROM \n                    grades \n                GROUP BY \n                    username, \n                    taskID\n            ) mg ON g.username = mg.username AND g.taskID = mg.taskID AND g.date = mg.max_date\n    ) g ON s.username = g.username AND t.taskID = g.taskID\nWHERE\n    a.assignmentID = <your_assignment_id>\nORDER BY\n    s.username, t.taskID;