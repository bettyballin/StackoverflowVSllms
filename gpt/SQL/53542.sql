WITH CumulativePoints AS (\n    SELECT\n        account,\n        transaction_date,\n        Points,\n        SUM(Points) OVER (PARTITION BY account ORDER BY transaction_date) AS RunningTotal\n    FROM\n        your_table\n)\nSELECT\n    account,\n    transaction_date,\n    RunningTotal\nFROM\n    CumulativePoints\nWHERE\n    RunningTotal >= 100\n    AND RunningTotal - Points < 100\nORDER BY\n    account,\n    transaction_date;