SELECT users.id, \n       COALESCE(photo_counts.n_photo, 0) AS n_photo, \n       COALESCE(classification_counts.n_classifications, 0) AS n_classifications, \n       (COALESCE(photo_counts.n_photo, 0) + COALESCE(classification_counts.n_classifications, 0)) AS n_sum \nFROM users \nLEFT JOIN (\n    SELECT user_id, COUNT(id) AS n_photo \n    FROM photos \n    GROUP BY user_id\n) AS photo_counts ON photo_counts.user_id = users.id \nLEFT JOIN (\n    SELECT user_id, COUNT(id) AS n_classifications \n    FROM classifications \n    GROUP BY user_id\n) AS classification_counts ON classification_counts.user_id = users.id \nORDER BY n_sum DESC;