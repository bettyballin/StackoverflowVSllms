ALTER PROCEDURE [dbo].[sp_Report_InventoryAging] \n    @TitleFlag int = 0,          -- 0-All veh, 1-Clear Title, 2-Without Clear Title\n    @CompName varchar(100) = 'ALL COMPANIES',\n    @CompBranchId varchar(50) = 'ALL',  -- All Offices\n    @StateId varchar(50) = 'All States'  -- All states\nAS\nBEGIN\n    DECLARE @sql NVARCHAR(MAX)\n    DECLARE @params NVARCHAR(MAX)\n\n    SET @sql = N'SELECT ... FROM YourTable WHERE TitleFlag = @TitleFlag'\n    SET @params = N'@TitleFlag int, @CompName varchar(100), @CompBranchId varchar(50), @StateId varchar(50)'\n\n    IF @CompName <> 'ALL COMPANIES'\n    BEGIN\n        SET @sql = @sql + N' AND UPPER(Company) = UPPER(@CompName)'\n    END\n\n    IF @CompBranchId <> 'ALL'\n    BEGIN\n        SET @sql = @sql + N' AND OfficeID = @CompBranchId'\n    END\n\n    IF @StateId <> 'All States'\n    BEGIN\n        SET @sql = @sql + N' AND StateID = @StateId'\n    END\n\n    EXEC sp_executesql @sql, @params, @TitleFlag = @TitleFlag, @CompName = @CompName, @CompBranchId = @CompBranchId, @StateId = @StateId\nEND