BEGIN\n   DBMS_SCHEDULER.create_job (\n      job_name        => 'SYNC_TABLES_JOB',\n      job_type        => 'PLSQL_BLOCK',\n      job_action      => 'BEGIN \n                             MERGE INTO table_b B\n                             USING table_a A\n                             ON (A.primary_key = B.primary_key)\n                             WHEN MATCHED THEN \n                               UPDATE SET B.column1 = A.column1, B.column2 = A.column2\n                             WHEN NOT MATCHED THEN \n                               INSERT (primary_key, column1, column2) \n                               VALUES (A.primary_key, A.column1, A.column2);\n                             \n                             MERGE INTO table_a A\n                             USING table_b B\n                             ON (B.primary_key = A.primary_key)\n                             WHEN MATCHED THEN \n                               UPDATE SET A.column1 = B.column1, A.column2 = B.column2\n                             WHEN NOT MATCHED THEN \n                               INSERT (primary_key, column1, column2) \n                               VALUES (B.primary_key, B.column1, B.column2);\n                          END;',\n      start_date      => SYSTIMESTAMP,\n      repeat_interval => 'FREQ=MINUTELY; INTERVAL=10',  -- Run every 10 minutes\n      enabled         => TRUE\n   );\nEND;\n/\n\n-- To drop the job\nBEGIN\n   DBMS_SCHEDULER.drop_job('SYNC_TABLES_JOB');\nEND;\n/