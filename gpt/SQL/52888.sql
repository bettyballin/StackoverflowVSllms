CREATE PROCEDURE GetHierarchy\nAS\nBEGIN\n    WITH Hierarchy AS (\n        SELECT PageID, ParentId, Title, 0 AS Level\n        FROM Pages\n        WHERE ParentId IS NULL\n        UNION ALL\n        SELECT p.PageID, p.ParentId, p.Title, h.Level + 1\n        FROM Pages p\n        INNER JOIN Hierarchy h ON p.ParentId = h.PageID\n    )\n    SELECT * FROM Hierarchy ORDER BY Level, ParentId, PageID;\nEND