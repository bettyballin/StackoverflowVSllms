CREATE PROCEDURE GetPersonCarPreferences\n    @PersonId INT\nAS\nBEGIN\n    DECLARE @SQL NVARCHAR(MAX) = 'SELECT P.name';\n    \n    -- Add the columns conditionally\n    IF EXISTS (SELECT 1 FROM people WHERE id = @PersonId AND wantsSportscar = 1)\n    BEGIN\n        SET @SQL = @SQL + ', (SELECT count(*) FROM cars C WHERE C.type = ''sports'') AS sportscars';\n    END\n    \n    IF EXISTS (SELECT 1 FROM people WHERE id = @PersonId AND wantsFamilycar = 1)\n    BEGIN\n        SET @SQL = @SQL + ', (SELECT count(*) FROM cars C WHERE C.type = ''family'') AS familycars';\n    END\n    \n    IF EXISTS (SELECT 1 FROM people WHERE id = @PersonId AND wantsBusinesscar = 1)\n    BEGIN\n        SET @SQL = @SQL + ', (SELECT count(*) FROM cars C WHERE C.type = ''business'') AS businesscars';\n    END\n    \n    -- Complete the SQL statement\n    SET @SQL = @SQL + ' FROM people P WHERE P.id = @PersonId';\n\n    -- Execute the dynamic SQL\n    EXEC sp_executesql @SQL, N'@PersonId INT', @PersonId;\nEND