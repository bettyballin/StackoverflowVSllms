SELECT pd.PID, pd.Offset, pd.Detail\nFROM Pattern p\nJOIN PatternDetail pd ON p.ID = pd.PID\nWHERE pd.Offset = MOD(TRUNC(SYSDATE) - p.BaseDate, p.DayCount);