CREATE OR REPLACE FUNCTION log_delete() RETURNS TRIGGER AS $$\nDECLARE\n    app_user TEXT;\nBEGIN\n    -- Retrieve the custom variable\n    SELECT current_setting('application_user', true) INTO app_user;\n    \n    -- Insert a log entry\n    INSERT INTO audit_log (deleted_by, deleted_at, old_data)\n    VALUES (app_user, now(), row_to_json(OLD));\n    \n    RETURN OLD;\nEND;\n$$ LANGUAGE plpgsql;