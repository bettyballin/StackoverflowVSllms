CREATE FUNCTION [dbo].[fnSplit2]\n(\n    @OLDSTRING AS VARCHAR(100),\n    @DELIMETER AS VARCHAR(1)\n)\nRETURNS @MYTABLE TABLE(COUNTER INT, STRINGVAL VARCHAR(100))\nAS\nBEGIN\n    WITH SplitCTE AS\n    (\n        SELECT \n            1 AS COUNTER,\n            LEFT(@OLDSTRING, CHARINDEX(@DELIMETER, @OLDSTRING) - 1) AS STRINGVAL,\n            RIGHT(@OLDSTRING, LEN(@OLDSTRING) - CHARINDEX(@DELIMETER, @OLDSTRING)) AS REMAININGSTRING\n        WHERE CHARINDEX(@DELIMETER, @OLDSTRING) > 0\n        UNION ALL\n        SELECT \n            COUNTER + 1,\n            LEFT(REMAININGSTRING, CHARINDEX(@DELIMETER, REMAININGSTRING) - 1),\n            RIGHT(REMAININGSTRING, LEN(REMAININGSTRING) - CHARINDEX(@DELIMETER, REMAININGSTRING))\n        FROM SplitCTE\n        WHERE CHARINDEX(@DELIMETER, REMAININGSTRING) > 0\n    )\n    INSERT INTO @MYTABLE (COUNTER, STRINGVAL)\n    SELECT COUNTER, STRINGVAL FROM SplitCTE\n    UNION ALL\n    SELECT \n        (SELECT COUNT(*) + 1 FROM SplitCTE),\n        REMAININGSTRING\n    WHERE LEN(REMAININGSTRING) > 0;\n\n    RETURN;\nEND