WITH AbsentDays AS (\n    SELECT \n        EmployeeNumber, \n        EntryDate,\n        ROW_NUMBER() OVER (PARTITION BY EmployeeNumber ORDER BY EntryDate) AS RowNum\n    FROM \n        Attendance\n    WHERE \n        Status = 'A'\n),\nConsecutiveAbsences AS (\n    SELECT \n        EmployeeNumber, \n        COUNT(*) AS ConsecutiveDays,\n        MIN(EntryDate) AS StartDate,\n        MAX(EntryDate) AS EndDate\n    FROM (\n        SELECT \n            EmployeeNumber, \n            EntryDate,\n            RowNum,\n            EntryDate - ROW_NUMBER() OVER (PARTITION BY EmployeeNumber ORDER BY EntryDate) AS DateDiff\n        FROM \n            AbsentDays\n    ) AS T\n    GROUP BY \n        EmployeeNumber, \n        DateDiff\n)\nSELECT \n    EmployeeNumber, \n    StartDate, \n    EndDate, \n    ConsecutiveDays\nFROM \n    ConsecutiveAbsences\nWHERE \n    ConsecutiveDays >= @n -- Replace @n with the number of days you are looking for\nORDER BY \n    EmployeeNumber, \n    StartDate;