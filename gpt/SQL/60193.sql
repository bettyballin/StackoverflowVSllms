-- Define a recursive CTE to generate the last 30 days\nWITH DateSeries AS (\n    SELECT CAST(GETDATE() - 29 AS DATE) AS DateValue\n    UNION ALL\n    SELECT DATEADD(DAY, 1, DateValue)\n    FROM DateSeries\n    WHERE DateValue < CAST(GETDATE() AS DATE)\n)\n-- Select from the generated dates and left join with Orders\nSELECT \n    ds.DateValue AS Date, \n    COALESCE(SUM(o.SubTotal), 0) AS SalesSum\nFROM \n    DateSeries ds\nLEFT JOIN \n    Orders o ON CAST(o.DateCreated AS DATE) = ds.DateValue\nGROUP BY \n    ds.DateValue\nORDER BY \n    ds.DateValue\nOPTION (MAXRECURSION 0); -- Allows recursion beyond the default 100 levels