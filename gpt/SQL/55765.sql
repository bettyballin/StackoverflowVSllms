CREATE FUNCTION dbo.SplitString \n( \n    @String NVARCHAR(MAX), \n    @Delimiter CHAR(1) \n)\nRETURNS @Results TABLE (Items NVARCHAR(MAX))\nAS\nBEGIN\n    DECLARE @Index INT\n    DECLARE @Slice NVARCHAR(MAX)\n\n    SELECT @Index = 1\n    WHILE @Index != 0\n    BEGIN\n        SELECT @Index = CHARINDEX(@Delimiter, @String)\n        IF @Index != 0\n            SELECT @Slice = LEFT(@String, @Index - 1)\n        ELSE\n            SELECT @Slice = @String\n\n        INSERT INTO @Results(Items) VALUES(@Slice)\n        SELECT @String = RIGHT(@String, LEN(@String) - @Index)\n        IF LEN(@String) = 0 BREAK\n    END\n    RETURN\nEND