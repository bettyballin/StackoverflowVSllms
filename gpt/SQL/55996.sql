SELECT \n    card_type = \n        CASE \n            WHEN substring(pan, 1, 2) = '37' THEN 'AMEX'\n            WHEN substring(pan, 1, 1) = '4' THEN 'VISA'\n            WHEN substring(pan, 1, 1) = '5' THEN 'MasterCard'\n            WHEN substring(pan, 1, 1) = '3' THEN 'Diners'\n            ELSE 'unknown' \n        END,\n    COUNT(*) as transaction_count,\n    SUM(amount) as total_amount\nFROM transactions\nGROUP BY \n    CASE \n        WHEN substring(pan, 1, 2) = '37' THEN 'AMEX'\n        WHEN substring(pan, 1, 1) = '4' THEN 'VISA'\n        WHEN substring(pan, 1, 1) = '5' THEN 'MasterCard'\n        WHEN substring(pan, 1, 1) = '3' THEN 'Diners'\n        ELSE 'unknown'\n    END;