-- Create PRICE table\nCREATE TABLE PRICE (\n  date DATE,\n  itemid INT,\n  price DECIMAL(10, 2)\n);\n\n-- Insert data into PRICE table\nINSERT INTO PRICE (date, itemid, price) VALUES\n('2008-12-04', 1, 1.00),\n('2008-12-11', 1, 3.00),\n('2008-12-15', 1, 7.00);\n\n-- Create VOLUME table\nCREATE TABLE VOLUME (\n  date DATE,\n  itemid INT,\n  volume_amt INT\n);\n\n-- Insert data into VOLUME table\nINSERT INTO VOLUME (date, itemid, volume_amt) VALUES\n('2008-12-04', 1, 12345),\n('2008-12-05', 1, 23456),\n('2008-12-08', 1, 34567),\n('2008-12-09', 1, 0),\n('2008-12-10', 1, 0),\n('2008-12-11', 1, 0),\n('2008-12-12', 1, 0),\n('2008-12-15', 1, 0),\n('2008-12-16', 1, 0),\n('2008-12-17', 1, 0),\n('2008-12-18', 1, 0);\n\n-- Perform the join and fill in the gaps\nSELECT \n  v.date,\n  COALESCE(p.price, LAG(p.price) OVER (PARTITION BY v.itemid ORDER BY v.date)) AS price,\n  v.volume_amt\nFROM \n  VOLUME v\nLEFT JOIN \n  PRICE p\nON \n  v.date = p.date\n  AND v.itemid = p.itemid\nORDER BY \n  v.date;