<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <title>PHP Chat with Comet</title>\n</head>\n<body>\n    <div id="chat"></div>\n    <script>\n        const chatDiv = document.getElementById('chat');\n        let lastMessageId = 0;\n\n        function startLongPolling() {\n            const xhr = new XMLHttpRequest();\n            xhr.open('GET', 'chat_server.php?lastMessageId=' + lastMessageId, true);\n            xhr.onreadystatechange = function() {\n                if (xhr.readyState === XMLHttpRequest.DONE && xhr.status === 200) {\n                    // Process new messages\n                    const messages = xhr.responseText.trim().split('\n\n');\n                    messages.forEach(msg => {\n                        const lines = msg.split('\n');\n                        const id = parseInt(lines[0].split(': ')[1]);\n                        const text = lines[1].split(': ')[1];\n                        chatDiv.innerHTML += `<p>${text}</p>`;\n                        lastMessageId = id;\n                    });\n\n                    // Restart long polling\n                    startLongPolling();\n                }\n            };\n            xhr.send();\n        }\n\n        // Start the long polling process\n        startLongPolling();\n    </script>\n</body>\n</html>