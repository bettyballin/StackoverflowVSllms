# Function to get proxy for a URL\ndef get_proxy_for_url(url):\n    session = winhttp.WinHttpOpen(\n        ctypes.c_wchar_p("Python Script"),\n        WINHTTP_ACCESS_TYPE_DEFAULT_PROXY,\n        None,\n        None,\n        0\n    )\n\n    if not session:\n        raise ctypes.WinError()\n\n    auto_proxy_options = WINHTTP_AUTOPROXY_OPTIONS()\n    auto_proxy_options.dwFlags = 0x00000001  # WINHTTP_AUTOPROXY_AUTO_DETECT\n    auto_proxy_options.dwAutoDetectFlags = 0x00000001  # WINHTTP_AUTO_DETECT_TYPE_DHCP\n\n    proxy_info = WINHTTP_PROXY_INFO()\n\n    result = winhttp.WinHttpGetProxyForUrl(\n        session,\n        ctypes.c_wchar_p(url),\n        ctypes.byref(auto_proxy_options),\n        ctypes.byref(proxy_info)\n    )\n\n    if not result:\n        raise ctypes.WinError()\n\n    proxy = proxy_info.lpszProxy\n    bypass = proxy_info.lpszProxyBypass\n\n    winhttp.WinHttpCloseHandle(session)\n\n    return proxy, bypass\n\n# Example usage\nurl = "http://www.foo.com"\nproxy, bypass = get_proxy_for_url(url)\nprint(f"Proxy: {proxy}")\nprint(f"Proxy Bypass: {bypass}")