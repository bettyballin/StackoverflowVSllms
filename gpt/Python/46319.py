import re\n\ndef stripMatchedQuotes(item):\n    MatchedQuotes = re.compile(r"['\"](.*?)['\"]", re.LOCALE)\n    return MatchedQuotes.sub(r'\1', item)\n\ndef processVariables(item):\n    VariablePattern = re.compile(r'<%([^=]+)=(.*?)%>|<%([^=]+)%>', re.LOCALE)\n    Variables = {}\n\n    def replace_variable(match):\n        if match.group(1) and match.group(2):  # This is a variable definition\n            VarName = stripMatchedQuotes(match.group(1)).upper().strip()\n            VarDef = stripMatchedQuotes(match.group(2).strip())\n            Variables[VarName] = VarDef\n            return ''  # Remove the variable definition from the text\n        elif match.group(3):  # This is a variable use\n            VarName = stripMatchedQuotes(match.group(3)).upper().strip()\n            return Variables.get(VarName, '')  # Replace with variable value or empty string if not defined\n\n    item = VariablePattern.sub(replace_variable, item)\n    return item\n\n# Example usage\ninput_text = 'The Web <%TEST_VAR="This Is A Test Variable"%>'\noutput_text = processVariables(input_text)\nprint(output_text)  # Output: The Web This Is A Test Variable