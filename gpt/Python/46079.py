import io\nimport zipfile\nfrom django.http import HttpResponse\n\ndef create_zip_and_download(request, torrent):\n    files = torrent[0].files\n    zip_buffer = io.BytesIO()\n\n    with zipfile.ZipFile(zip_buffer, 'w', zipfile.ZIP_DEFLATED) as zip_file:\n        for f in files:\n            file_path = settings.PYRAT_TRANSMISSION_DOWNLOAD_DIR + "/" + f.name\n            with open(file_path, 'rb') as file:\n                zip_file.writestr(f.name, file.read())\n\n    zip_buffer.seek(0)\n    response = HttpResponse(zip_buffer, content_type='application/zip')\n    response['Content-Disposition'] = f'attachment; filename={torrent[0].name}.zip'\n    return response