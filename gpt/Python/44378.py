import winreg\n\ndef get_installed_programs():\n    uninstall_paths = [\n        r"SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall",\n        r"SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall"\n    ]\n    \n    installed_programs = []\n    \n    for uninstall_path in uninstall_paths:\n        try:\n            reg_key = winreg.OpenKey(winreg.HKEY_LOCAL_MACHINE, uninstall_path)\n            for i in range(0, winreg.QueryInfoKey(reg_key)[0]):\n                sub_key_name = winreg.EnumKey(reg_key, i)\n                sub_key = winreg.OpenKey(reg_key, sub_key_name)\n                try:\n                    program_name = winreg.QueryValueEx(sub_key, "DisplayName")[0]\n                    program_version = winreg.QueryValueEx(sub_key, "DisplayVersion")[0]\n                    installed_programs.append((program_name, program_version))\n                except FileNotFoundError:\n                    pass\n                finally:\n                    sub_key.Close()\n        except FileNotFoundError:\n            pass\n    \n    return installed_programs\n\ninstalled_programs = get_installed_programs()\nfor program, version in installed_programs:\n    print(f"Program: {program}, Version: {version}")