from sqlalchemy import create_engine, Table, Column, Integer, String, LargeBinary, MetaData, TIMESTAMP\n   from sqlalchemy.orm import sessionmaker\n   import os\n   import datetime\n   \n   DATABASE_URL = "postgresql://your_username:your_password@localhost:5432/file_storage"\n   \n   engine = create_engine(DATABASE_URL)\n   metadata = MetaData()\n   \n   files_table = Table('files', metadata,\n       Column('id', Integer, primary_key=True),\n       Column('name', String, nullable=False),\n       Column('tag', String),\n       Column('file_type', String),\n       Column('date', TIMESTAMP),\n       Column('content', LargeBinary)\n   )\n   \n   metadata.create_all(engine)\n   Session = sessionmaker(bind=engine)\n   session = Session()\n   \n   def add_file(file_path, tag):\n       file_name = os.path.basename(file_path)\n       file_type = os.path.splitext(file_path)[1]\n       with open(file_path, 'rb') as file:\n           content = file.read()\n       date = datetime.datetime.now()\n       \n       insert_stmt = files_table.insert().values(\n           name=file_name,\n           tag=tag,\n           file_type=file_type,\n           date=date,\n           content=content\n       )\n       session.execute(insert_stmt)\n       session.commit()\n   \n   def query_files(tag=None, name=None, file_type=None, date=None):\n       query = session.query(files_table)\n       if tag:\n           query = query.filter(files_table.c.tag == tag)\n       if name:\n           query = query.filter(files_table.c.name == name)\n       if file_type:\n           query = query.filter(files_table.c.file_type == file_type)\n       if date:\n           query = query.filter(files_table.c.date == date)\n       return query.all()\n   \n   # Example usage\n   add_file('/path/to/your/file.txt', 'example_tag')\n   result = query_files(tag='example_tag')\n   for file in result:\n       print(file.name, file.tag, file.file_type, file.date)