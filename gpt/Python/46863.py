from sqlalchemy import create_engine, Table, Column, Integer, String, MetaData\nfrom sqlalchemy.exc import OperationalError\n\n# Database connection\nengine = create_engine('sqlite:///dynamic_lookups.db')\nmetadata = MetaData()\n\ndef create_or_alter_table(dataset):\n    table_name = 'data'\n    columns = [Column('id', Integer, primary_key=True, autoincrement=True)]\n    \n    for column in dataset[0].keys():\n        columns.append(Column(column, String))\n    \n    try:\n        # Create table if it doesn't exist\n        table = Table(table_name, metadata, *columns)\n        table.create(engine)\n    except OperationalError:\n        # Alter table if it exists\n        with engine.connect() as conn:\n            for column in dataset[0].keys():\n                try:\n                    conn.execute(f'ALTER TABLE {table_name} ADD COLUMN {column} STRING')\n                except OperationalError:\n                    # Column already exists\n                    pass\n\ndef create_lookup_table(column_name):\n    lookup_table_name = f'lookup_{column_name}'\n    columns = [\n        Column('id', Integer, primary_key=True, autoincrement=True),\n        Column('value', String),\n        Column('description', String)\n    ]\n    \n    lookup_table = Table(lookup_table_name, metadata, *columns)\n    lookup_table.create(engine, checkfirst=True)\n\n# Example datasets\ndataset_a = [\n    {'name': 'Bob', 'dept': 'Sales', 'age': '24'},\n    {'name': 'Tim', 'dept': 'IT', 'age': '32'}\n]\n\ndataset_b = [\n    {'name': 'Bob', 'dept': 'Sales', 'age': '24', 'salary': '£20,000'},\n    {'name': 'Tim', 'dept': 'IT', 'age': '32', 'salary': '£20,000'}\n]\n\n# Process datasets\ncreate_or_alter_table(dataset_a)\ncreate_or_alter_table(dataset_b)\n\n# Create lookup tables (example for 'dept' and 'salary')\ncreate_lookup_table('dept')\ncreate_lookup_table('salary')