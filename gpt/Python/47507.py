from django.core import signing\n   from django.shortcuts import get_object_or_404, redirect\n   from django.contrib.auth import get_user_model\n   from django.http import HttpResponseBadRequest\n\n   User = get_user_model()\n\n   def confirm_email(request, uidb64, token):\n       try:\n           user_id = urlsafe_base64_decode(uidb64).decode()\n           user = get_object_or_404(User, pk=user_id)\n           signing.loads(token, max_age=3600, salt=settings.SECRET_KEY)  # token valid for 1 hour\n           user.is_active = True\n           user.save()\n           return redirect('success_page')\n       except signing.SignatureExpired:\n           return HttpResponseBadRequest("The confirmation link has expired.")\n       except signing.BadSignature:\n           return HttpResponseBadRequest("Invalid confirmation link.")