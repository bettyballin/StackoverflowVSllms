import csv\n\nwith open('somefile.csv', newline='') as csvfile:\n    reader = csv.reader(csvfile, delimiter='|', quotechar=None)\n    lines = list(reader)\n\nheader = lines[0]\n\nfor line_num, row in enumerate(lines[1:], start=1):\n    if line_num == len(lines) - 1:\n        print("This is the last line.")\n    else:\n        assert len(row) == len(header), f"Row length mismatch at line {line_num + 1}"\n    # Your processing code here