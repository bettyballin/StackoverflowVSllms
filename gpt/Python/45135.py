import base64\nimport hashlib\nimport hmac\nimport urllib.parse\n\ndef generate_oauth_signature(http_method, base_url, parameters, consumer_secret, token_secret=""):\n    # Normalize request parameters\n    sorted_params = sorted(parameters.items())\n    normalized_params = urllib.parse.urlencode(sorted_params, quote_via=urllib.parse.quote)\n    \n    # Create base string\n    base_string = f"{http_method.upper()}&{urllib.parse.quote(base_url, safe='')}&{urllib.parse.quote(normalized_params, safe='')}"\n    \n    # Create signing key\n    signing_key = f"{urllib.parse.quote(consumer_secret, safe='')}&{urllib.parse.quote(token_secret, safe='')}"\n    \n    # Generate signature using HMAC-SHA1\n    hashed = hmac.new(signing_key.encode(), base_string.encode(), hashlib.sha1)\n    signature = base64.b64encode(hashed.digest()).decode()\n    \n    return signature\n\n# Example usage\nhttp_method = "POST"\nbase_url = "https://api.twitter.com/oauth/request_token"\nparameters = {\n    "oauth_consumer_key": "your_consumer_key",\n    "oauth_nonce": "random_nonce",\n    "oauth_signature_method": "HMAC-SHA1",\n    "oauth_timestamp": "timestamp",\n    "oauth_version": "1.0"\n}\nconsumer_secret = "your_consumer_secret"\ntoken_secret = "your_token_secret"\n\nsignature = generate_oauth_signature(http_method, base_url, parameters, consumer_secret, token_secret)\nprint(f"Generated OAuth Signature: {signature}")