from ldap3 import Server, Connection, ALL, NTLM\n\n# Connection settings\nserver = Server('ldap://domain_name.com', get_info=ALL)\nconnection = Connection(server, user='domain_name\\username', password='password', authentication=NTLM)\n\n# Connect to the server\nif not connection.bind():\n    print('Error in bind', connection.result)\nelse:\n    # Search for the user and retrieve group membership\n    search_base = 'DC=domain,DC=com'\n    search_filter = '(sAMAccountName=username)'\n    connection.search(search_base, search_filter, attributes=['memberOf'])\n\n    # Extract and print group memberships\n    entry = connection.entries[0]\n    groups = entry.memberOf.values if 'memberOf' in entry else []\n    for group in groups:\n        print(group)\n\n    # Unbind the connection\n    connection.unbind()