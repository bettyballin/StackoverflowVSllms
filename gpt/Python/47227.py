import imaplib\nimport email\nfrom datetime import datetime, timedelta\n\n# Connect to the IMAP server\nmail = imaplib.IMAP4_SSL('imap.yourmailserver.com')\nmail.login('user@example.com', 'password')\n\n# Select the mailbox you want to analyze\nmail.select("inbox")\n\n# Search for all emails in the last 30 days\ndate = (datetime.now() - timedelta(30)).strftime("%d-%b-%Y")\nresult, data = mail.search(None, f'(SINCE {date})')\n\n# Count received emails\nreceived_count = len(data[0].split())\n\n# Select the sent items folder\nmail.select('"[Gmail]/Sent Mail"')  # Adjust based on your mail server\n\n# Search for all sent emails in the last 30 days\nresult, data = mail.search(None, f'(SINCE {date})')\n\n# Count sent emails\nsent_count = len(data[0].split())\n\nprint(f"Sent Emails: {sent_count}")\nprint(f"Received Emails: {received_count}")\n\n# Logout\nmail.logout()