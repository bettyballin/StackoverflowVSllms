import msvcrt\n\ndef open_file_exclusive_windows(path, mode):\n    file = open(path, mode)\n    try:\n        if "w" in mode:\n            msvcrt.locking(file.fileno(), msvcrt.LK_NBLCK, 1)  # Exclusive lock for writing\n        else:\n            msvcrt.locking(file.fileno(), msvcrt.LK_NBRLCK, 1)  # Shared lock for reading\n    except IOError:\n        file.close()\n        raise IOError("File is already locked")\n    return file\n\n# Usage example\ntry:\n    file = open_file_exclusive_windows("c:\\scr.txt", "r")\n    # Perform file operations\nfinally:\n    file.close()