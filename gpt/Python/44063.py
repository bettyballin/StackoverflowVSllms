import ctypes\nimport time\n\nclass LASTINPUTINFO(ctypes.Structure):\n    _fields_ = [("cbSize", ctypes.c_uint),\n                ("dwTime", ctypes.c_uint)]\n\ndef get_idle_duration():\n    lii = LASTINPUTINFO()\n    lii.cbSize = ctypes.sizeof(LASTINPUTINFO)\n    if ctypes.windll.user32.GetLastInputInfo(ctypes.byref(lii)):\n        millis = ctypes.windll.kernel32.GetTickCount() - lii.dwTime\n        return millis / 1000.0\n    else:\n        return 0\n\nif __name__ == "__main__":\n    while True:\n        print("Idle time: {} seconds".format(get_idle_duration()))\n        time.sleep(1)