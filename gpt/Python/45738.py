from django.db.models import OuterRef, Subquery\nfrom django.db.models.functions import Coalesce\n\n# Assuming 'ProjectFundingDetail' is the name of your related model\nlatest_funding = ProjectFundingDetail.objects.filter(\n    project=OuterRef('pk')\n).order_by('-end_date').values('budget')[:1]\n\nprojects_list = projects_list.annotate(\n    latest_budget=Subquery(latest_funding)\n).filter(latest_budget__lte=1000).distinct()