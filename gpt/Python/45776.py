def quicksort_3way(arr, low, high):\n    if low < high:\n        lt, gt = partition_3way(arr, low, high)\n        quicksort_3way(arr, low, lt - 1)\n        quicksort_3way(arr, gt + 1, high)\n\ndef partition_3way(arr, low, high):\n    pivot = arr[low]\n    lt = low\n    i = low\n    gt = high\n\n    while i <= gt:\n        if arr[i] < pivot:\n            arr[lt], arr[i] = arr[i], arr[lt]\n            lt += 1\n            i += 1\n        elif arr[i] > pivot:\n            arr[gt], arr[i] = arr[i], arr[gt]\n            gt -= 1\n        else:\n            i += 1\n\n    return lt, gt\n\n# Example usage\narr = [4, 9, 4, 4, 8, 4, 3, 4, 2, 4, 1, 4]\nquicksort_3way(arr, 0, len(arr) - 1)\nprint(arr)