import pyodbc\nfrom docx import Document\nfrom fpdf import FPDF\nfrom PyPDF2 import PdfFileWriter, PdfFileReader\n\n# Setup database connection\nconn = pyodbc.connect('DRIVER={SQL Server};SERVER=server_name;DATABASE=db_name;UID=user;PWD=password')\ncursor = conn.cursor()\n\n# Fetch data\ncursor.execute("SELECT * FROM your_table")\nrows = cursor.fetchall()\n\n# Function to create a PDF from a Word document\ndef create_pdf_from_docx(docx_path, pdf_path):\n    doc = Document(docx_path)\n    pdf = FPDF()\n    pdf.add_page()\n    pdf.set_font("Arial", size=12)\n    \n    for para in doc.paragraphs:\n        pdf.multi_cell(0, 10, para.text)\n    \n    pdf.output(pdf_path)\n\n# Function to merge PDFs\ndef merge_pdfs(letter_pdf, additional_pdfs, output_pdf):\n    pdf_writer = PdfFileWriter()\n    \n    # Add letter PDF\n    letter_reader = PdfFileReader(letter_pdf)\n    for page_num in range(letter_reader.numPages):\n        page = letter_reader.getPage(page_num)\n        pdf_writer.addPage(page)\n    \n    # Add additional PDFs\n    for pdf in additional_pdfs:\n        additional_reader = PdfFileReader(pdf)\n        for page_num in range(additional_reader.numPages):\n            page = additional_reader.getPage(page_num)\n            pdf_writer.addPage(page)\n    \n    with open(output_pdf, 'wb') as out:\n        pdf_writer.write(out)\n\n# Main process\nfor row in rows:\n    letter_path = f"letter_{row.id}.docx"\n    letter_pdf_path = f"letter_{row.id}.pdf"\n    \n    # Generate letter PDF\n    create_pdf_from_docx(letter_path, letter_pdf_path)\n    \n    # Determine number of brochures\n    pdf_count = row.PDFCount\n    additional_pdfs = [f"brochure_{i}.pdf" for i in range(pdf_count)]\n    \n    # Merge into a single PDF\n    output_pdf = f"final_letter_{row.id}.pdf"\n    merge_pdfs(letter_pdf_path, additional_pdfs, output_pdf)\n\n# Close database connection\nconn.close()