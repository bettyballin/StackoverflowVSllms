import os\nimport shutil\nimport ftplib\nimport paramiko\nimport requests\nfrom urllib.parse import urlparse\n\ndef transfer_file(uri, destination, operation='get'):\n    parsed_uri = urlparse(uri)\n    scheme = parsed_uri.scheme\n\n    if scheme == 'ftp':\n        ftp_transfer(parsed_uri, destination, operation)\n    elif scheme in ['http', 'https']:\n        http_transfer(parsed_uri, destination, operation)\n    elif scheme == 'sftp':\n        sftp_transfer(parsed_uri, destination, operation)\n    elif scheme == 'file':\n        local_transfer(parsed_uri, destination, operation)\n    else:\n        raise ValueError(f"Unsupported scheme: {scheme}")\n\ndef ftp_transfer(uri, destination, operation):\n    ftp = ftplib.FTP(uri.hostname)\n    ftp.login(uri.username, uri.password)\n    if operation == 'get':\n        with open(destination, 'wb') as f:\n            ftp.retrbinary(f'RETR {uri.path}', f.write)\n    elif operation == 'put':\n        with open(uri.path, 'rb') as f:\n            ftp.storbinary(f'STOR {destination}', f)\n    ftp.quit()\n\ndef http_transfer(uri, destination, operation):\n    if operation == 'get':\n        response = requests.get(uri.geturl(), stream=True)\n        with open(destination, 'wb') as f:\n            shutil.copyfileobj(response.raw, f)\n    else:\n        raise ValueError("HTTP/HTTPS only supports 'get' operation")\n\ndef sftp_transfer(uri, destination, operation):\n    transport = paramiko.Transport((uri.hostname, 22))\n    transport.connect(username=uri.username, password=uri.password)\n    sftp = paramiko.SFTPClient.from_transport(transport)\n    if operation == 'get':\n        sftp.get(uri.path, destination)\n    elif operation == 'put':\n        sftp.put(uri.path, destination)\n    sftp.close()\n    transport.close()\n\ndef local_transfer(uri, destination, operation):\n    if operation == 'get':\n        shutil.copyfile(uri.path, destination)\n    elif operation == 'put':\n        shutil.copyfile(destination, uri.path)\n\n\n# Example usage:\n# transfer_file('ftp://user:password@ftp.example.com/path/to/file', '/local/path', 'get')\n# transfer_file('http://example.com/file', '/local/path', 'get')\n# transfer_file('sftp://user:password@sftp.example.com/path/to/file', '/local/path', 'get')\n# transfer_file('file:///local/path/to/file', '/local/destination/path', 'get')