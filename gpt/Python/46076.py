import math\n\ndef row_index(i, M):\n    return int(math.ceil((-1 + math.sqrt(1 + 8 * i)) / 2)) - 1