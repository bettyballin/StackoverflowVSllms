import ctypes\n\n   GetKeyboardLayout = ctypes.windll.user32.GetKeyboardLayout\n   GetForegroundWindow = ctypes.windll.user32.GetForegroundWindow\n   GetWindowThreadProcessId = ctypes.windll.user32.GetWindowThreadProcessId\n\n   hwnd = GetForegroundWindow()\n   tid = GetWindowThreadProcessId(hwnd, None)\n   klid = GetKeyboardLayout(tid)\n\n   language_id = klid & 0xFFFF\n   print(hex(language_id))