TRANSACTION_FAILURE_CODES = [\n    25401,  # ORA_CANNOT_CONTINUE_FETCHES\n    25402,  # ORA_TRANSACTION_MUST_ROLLBACK\n    25408   # ORA_CANNOT_SAFELY_REPLAY_CALL\n]\n\ntry:\n    # Some database code\nexcept cx_Oracle.DatabaseError as e:\n    error_code = e.args[0].code\n    if error_code in TRANSACTION_FAILURE_CODES:\n        print('Transaction failure due to node going down, restarting transaction...')\n        conn.rollback()\n        continue\n    else:\n        raise e