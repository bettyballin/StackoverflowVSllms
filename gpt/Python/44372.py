import sqlite3\n\n# Connect to your database\nconn = sqlite3.connect('your_database.db')\ncursor = conn.cursor()\n\n# Get the list of flag names dynamically\ncursor.execute("SELECT Name FROM Flag")\nflags = cursor.fetchall()\n\n# Start building the SQL query\nquery = "SELECT f.Id AS FileId, f.Name AS FileName"\n\n# Add each flag as a column in the select statement\nfor flag in flags:\n    flag_name = flag[0]\n    query += f", (CASE WHEN ff.FlagId = (SELECT Id FROM Flag WHERE Name = '{flag_name}') THEN 1 ELSE 0 END) AS {flag_name}"\n\n# Join the necessary tables\nquery += """\nFROM File f\nLEFT JOIN FileFlags ff ON f.Id = ff.FileId\n"""\n\n# Execute and fetch the results\ncursor.execute(query)\nresults = cursor.fetchall()\n\n# Print the results\nprint(results)\n\n# Close the connection\nconn.close()