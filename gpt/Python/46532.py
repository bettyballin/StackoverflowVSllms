import random\n\ndef alias_setup(probs):\n    n = len(probs)\n    prob = [0] * n\n    alias = [0] * n\n    small = []\n    large = []\n    \n    scaled_probs = [p * n for p in probs]\n    \n    for i, sp in enumerate(scaled_probs):\n        if sp < 1:\n            small.append(i)\n        else:\n            large.append(i)\n    \n    while small and large:\n        l = small.pop()\n        g = large.pop()\n        \n        prob[l] = scaled_probs[l]\n        alias[l] = g\n        \n        scaled_probs[g] = scaled_probs[g] + scaled_probs[l] - 1\n        if scaled_probs[g] < 1:\n            small.append(g)\n        else:\n            large.append(g)\n    \n    while large:\n        g = large.pop()\n        prob[g] = 1\n\n    while small:\n        l = small.pop()\n        prob[l] = 1\n    \n    return prob, alias\n\ndef alias_draw(prob, alias):\n    n = len(prob)\n    i = random.randint(0, n - 1)\n    if random.random() < prob[i]:\n        return i\n    else:\n        return alias[i]\n\n# Example usage\nwords_frequencies = [("word1", 10), ("word2", 5), ("word3", 20)]\nwords, frequencies = zip(*words_frequencies)\ntotal_frequency = sum(frequencies)\nprobs = [f / total_frequency for f in frequencies]\n\nprob, alias = alias_setup(probs)\n\n# Select p words\np = 5\nselected_words = [words[alias_draw(prob, alias)] for _ in range(p)]\nprint(selected_words)