import csv\n\n# Open the input and output CSV files\nwith open("PALTemplateData.csv", mode='r', newline='', encoding='utf-8') as csvfile, \\n     open("PALTemplateDataOUT.csv", mode='w', newline='', encoding='utf-8') as csvout:\n\n    # Detect the dialect of the input CSV file\n    dialect = csv.Sniffer().sniff(csvfile.read(1024))\n    csvfile.seek(0)\n    \n    # Create a CSV reader and writer with the detected dialect\n    reader = csv.reader(csvfile, dialect)\n    writer = csv.writer(csvout, dialect)\n\n    total = 0\n    need_change = 0\n    changed = 0\n\n    # Iterate over rows in the input CSV file\n    for row in reader:\n        total += 1\n        # Assume the URL column is the last column (change index if different)\n        url_index = len(row) - 1\n        temp = row[url_index]\n        \n        # Check if the URL contains '/?' and needs to be replaced\n        if '/?' in temp:\n            need_change += 1\n            # Replace '/?' with '?'\n            temp = temp.replace('/?', '?')\n            row[url_index] = temp\n            changed += 1\n        \n        # Write the modified row to the output CSV file\n        writer.writerow(row)\n\n    print('Total URLs:', total)\n    print('Total URLs to change:', need_change)\n    print('Total URLs changed:', changed)