from flask import Flask, request, jsonify\nimport jwt\nimport datetime\n\napp = Flask(__name__)\napp.config['SECRET_KEY'] = 'your_secret_key'\n\n# Simulated user database\nusers = {\n    "user1": "password1",\n    "user2": "password2"\n}\n\n@app.route('/login', methods=['POST'])\ndef login():\n    auth = request.json\n    if not auth or not auth.get('username') or not auth.get('password'):\n        return jsonify({'message': 'Could not verify'}), 401\n    \n    user = users.get(auth.get('username'))\n    if not user or user != auth.get('password'):\n        return jsonify({'message': 'Invalid credentials'}), 401\n\n    token = jwt.encode({\n        'username': auth.get('username'),\n        'exp': datetime.datetime.utcnow() + datetime.timedelta(hours=1)\n    }, app.config['SECRET_KEY'], algorithm="HS256")\n\n    return jsonify({'token': token})\n\n@app.route('/protected', methods=['GET'])\ndef protected():\n    token = request.headers.get('Authorization')\n    if not token:\n        return jsonify({'message': 'Token is missing!'}), 401\n    \n    try:\n        data = jwt.decode(token, app.config['SECRET_KEY'], algorithms=["HS256"])\n    except:\n        return jsonify({'message': 'Token is invalid!'}), 401\n    \n    return jsonify({'message': 'Protected content', 'user': data['username']})\n\nif __name__ == '__main__':\n    app.run(debug=True)