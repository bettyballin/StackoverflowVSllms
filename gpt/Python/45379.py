def spiral_order(matrix):\n    if not matrix:\n        return []\n\n    result = []\n    top, bottom, left, right = 0, len(matrix)-1, 0, len(matrix[0])-1\n\n    while top <= bottom and left <= right:\n        # Traverse from left to right\n        for i in range(left, right+1):\n            result.append(matrix[top][i])\n        top += 1\n\n        # Traverse downwards\n        for i in range(top, bottom+1):\n            result.append(matrix[i][right])\n        right -= 1\n\n        if top <= bottom:\n            # Traverse from right to left\n            for i in range(right, left-1, -1):\n                result.append(matrix[bottom][i])\n            bottom -= 1\n\n        if left <= right:\n            # Traverse upwards\n            for i in range(bottom, top-1, -1):\n                result.append(matrix[i][left])\n            left += 1\n\n    return result\n\n# Example usage for a 3x3 matrix:\nmatrix1 = [\n    [1, 2, 3],\n    [4, 5, 6],\n    [7, 8, 9]\n]\nprint(spiral_order(matrix1))\n\n# Example usage for a 5x3 matrix:\nmatrix2 = [\n    [1, 2, 3],\n    [4, 5, 6],\n    [7, 8, 9],\n    [10, 11, 12],\n    [13, 14, 15]\n]\nprint(spiral_order(matrix2))