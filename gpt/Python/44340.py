import ctypes\n\ndef query_dos_device(device_name):\n    # Allocate buffer for the result\n    buffer = ctypes.create_unicode_buffer(1024)\n    \n    # Query the device name\n    result = ctypes.windll.kernel32.QueryDosDeviceW(device_name, buffer, len(buffer))\n    \n    if result == 0:\n        raise ctypes.WinError()\n    \n    return buffer.value\n\n# Example device path\ndevice_path = "\\Device\\CdRom0"\n\n# Iterate through possible drive letters\nfor drive_letter in range(ord('A'), ord('Z') + 1):\n    drive = f"{chr(drive_letter)}:"\n    try:\n        resolved_path = query_dos_device(drive)\n        if device_path in resolved_path:\n            print(f"The drive letter for {device_path} is {drive}\\")\n            break\n    except WindowsError:\n        continue