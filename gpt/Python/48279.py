def is_nice(s):\n    vowels = set("AEIOU")\n    \n    def is_vowel(c):\n        return c in vowels\n    \n    def is_ugly(s):\n        for i in range(len(s)):\n            if i >= 2 and all(is_vowel(s[j]) for j in range(i-2, i+1)):\n                return True\n            if i >= 4 and all(not is_vowel(s[j]) for j in range(i-4, i+1)):\n                return True\n        return False\n\n    def can_be_nice(s):\n        memo = {}\n        def dfs(index, pattern):\n            if index == len(s):\n                return not is_ugly(pattern)\n            if (index, pattern) in memo:\n                return memo[(index, pattern)]\n            \n            if s[index] == '?':\n                for c in "ABCDEFGHIJKLMNOPQRSTUVWXYZ":\n                    if dfs(index + 1, pattern + c):\n                        memo[(index, pattern)] = True\n                        return True\n            else:\n                if dfs(index + 1, pattern + s[index]):\n                    memo[(index, pattern)] = True\n                    return True\n            \n            memo[(index, pattern)] = False\n            return False\n\n        return dfs(0, "")\n    \n    return can_be_nice(s)\n\n# Test cases\nprint(is_nice("EE?FFFF"))  # Output: False\nprint(is_nice("H??LOWOR??"))  # Output: True