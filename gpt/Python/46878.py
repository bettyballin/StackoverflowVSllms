from flask import Flask, request, render_template_string\nfrom ldap3 import Server, Connection, MODIFY_REPLACE, Tls\nimport ssl\n\napp = Flask(__name__)\n\nLDAP_SERVER = 'ldap://your-ldap-server'\nLDAP_BASE_DN = 'dc=example,dc=com'\n\n@app.route('/', methods=['GET', 'POST'])\ndef change_password():\n    if request.method == 'POST':\n        username = request.form['username']\n        old_password = request.form['old_password']\n        new_password = request.form['new_password']\n        verify_password = request.form['verify_password']\n\n        if new_password != verify_password:\n            return 'New passwords do not match.'\n\n        user_dn = f'uid={username},{LDAP_BASE_DN}'\n\n        # Connect to LDAP server\n        server = Server(LDAP_SERVER)\n        conn = Connection(server, user=user_dn, password=old_password)\n\n        if not conn.bind():\n            return 'Invalid username or password.'\n\n        # Change password\n        conn.modify(user_dn, {'userPassword': [(MODIFY_REPLACE, [new_password])]})\n        if conn.result['description'] == 'success':\n            return 'Password changed successfully.'\n        else:\n            return f"Password change failed: {conn.result['description']}"\n\n    return render_template_string('''\n        <form method="post">\n            Username: <input type="text" name="username"><br>\n            Old Password: <input type="password" name="old_password"><br>\n            New Password: <input type="password" name="new_password"><br>\n            Verify New Password: <input type="password" name="verify_password"><br>\n            <input type="submit" value="Change Password">\n        </form>\n    ''')\n\nif __name__ == '__main__':\n    app.run(debug=True)