import os\nimport subprocess\nfrom datetime import datetime\n\n# Configuration\ndb_name = "your_database"\ndb_user = "your_db_user"\nbackup_dir = "/path/to/backup/directory"\ns3_bucket = "s3://your-s3-bucket-name"\n\n# Create a timestamp for the backup file\ntimestamp = datetime.now().strftime("%Y%m%d%H%M%S")\nbackup_filename = f"{db_name}_backup_{timestamp}.sql.gz"\nbackup_filepath = os.path.join(backup_dir, backup_filename)\n\n# Perform the database dump and compress the output\ndump_command = f"pg_dump -U {db_user} {db_name} | gzip > {backup_filepath}"\nsubprocess.run(dump_command, shell=True, check=True)\n\n# Upload the backup file to S3\nupload_command = f"aws s3 cp {backup_filepath} {s3_bucket}/{backup_filename}"\nsubprocess.run(upload_command, shell=True, check=True)\n\n# Clean up old backups if necessary\n# Implement your retention policy here, e.g., delete backups older than a certain date\n\nprint("Backup completed successfully.")