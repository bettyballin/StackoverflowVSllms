from django.db import models\nfrom collections import defaultdict\n\nclass Car(models.Model):\n    mods = models.ManyToManyField('Mods')\n\nclass Mods(models.Model):\n    name = models.CharField(max_length=100)\n\ndef cars_by_common_mods():\n    # Fetch all cars with their related mods\n    cars = Car.objects.prefetch_related('mods').all()\n    \n    # Dictionary to hold the grouped cars by common mods\n    grouped_cars = defaultdict(list)\n    \n    for car in cars:\n        # Create a frozenset of mods for each car\n        car_mods = frozenset(car.mods.all())\n        # Append the car to the grouped dictionary\n        grouped_cars[car_mods].append(car)\n    \n    # Transform the grouped_cars dictionary into the desired output format\n    result = [\n        {\n            'mods': {mod.name for mod in mods},\n            'cars': {car.id for car in cars}\n        }\n        for mods, cars in grouped_cars.items()\n    ]\n    \n    return result