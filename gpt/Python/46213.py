import mysql.connector\nfrom mysql.connector import errorcode\n\ndef assign_tasks():\n    try:\n        connection = mysql.connector.connect(user='user', password='password', host='127.0.0.1', database='database')\n        cursor = connection.cursor()\n\n        while True:\n            try:\n                cursor.execute("START TRANSACTION;")\n\n                cursor.execute("""\n                SELECT url FROM urls\n                WHERE task_assigned IS NULL\n                ORDER BY id\n                LIMIT 100\n                FOR UPDATE;\n                """)\n                urls = cursor.fetchall()\n\n                if not urls:\n                    break\n\n                url_list = tuple(url[0] for url in urls)\n\n                cursor.execute("""\n                UPDATE urls\n                SET task_assigned = NOW()\n                WHERE task_assigned IS NULL\n                AND url IN %s;\n                """, (url_list,))\n\n                connection.commit()\n\n            except mysql.connector.Error as err:\n                if err.errno == errorcode.ER_LOCK_DEADLOCK:\n                    # Handle deadlock by retrying\n                    connection.rollback()\n                    continue\n                else:\n                    raise\n\n    except mysql.connector.Error as err:\n        print(f"Error: {err}")\n    finally:\n        cursor.close()\n        connection.close()\n\nassign_tasks()