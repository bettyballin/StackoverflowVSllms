import requests\nimport msal\n\n# Define your parameters\nclient_id = 'YOUR_CLIENT_ID'\nclient_secret = 'YOUR_CLIENT_SECRET'\ntenant_id = 'YOUR_TENANT_ID'\nauthority = f"https://login.microsoftonline.com/{tenant_id}"\nscope = ["https://graph.microsoft.com/.default"]\nsharepoint_site = "YOUR_SHAREPOINT_SITE_NAME"\nfile_path = "sites/YOUR_SITE_NAME/drive/root:/path/to/your/file.xlsx"\ndownload_path = "local_path_to_save_file.xlsx"\n\n# Authenticate and get an access token\napp = msal.ConfidentialClientApplication(client_id, authority=authority, client_credential=client_secret)\nresult = app.acquire_token_for_client(scopes=scope)\n\nif "access_token" in result:\n    access_token = result["access_token"]\n    headers = {\n        "Authorization": f"Bearer {access_token}"\n    }\n    \n    # Download the file\n    file_url = f"https://graph.microsoft.com/v1.0/{file_path}:/content"\n    response = requests.get(file_url, headers=headers)\n    \n    if response.status_code == 200:\n        with open(download_path, "wb") as file:\n            file.write(response.content)\n        print("File downloaded successfully")\n    else:\n        print(f"Failed to download file. Status code: {response.status_code}")\nelse:\n    print("Failed to acquire access token")