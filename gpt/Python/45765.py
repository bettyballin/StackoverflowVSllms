import re\n\ndef is_valid_windows_filename(filename):\n    # Define invalid characters\n    invalid_chars = r'[<>:"/\\|?*]'\n\n    # Reserved names\n    reserved_names = [\n        "CON", "PRN", "AUX", "NUL",\n        "COM1", "COM2", "COM3", "COM4", "COM5", "COM6", "COM7", "COM8", "COM9",\n        "LPT1", "LPT2", "LPT3", "LPT4", "LPT5", "LPT6", "LPT7", "LPT8", "LPT9"\n    ]\n\n    # Check for invalid characters\n    if re.search(invalid_chars, filename):\n        return False\n\n    # Check for trailing space or period\n    if filename.endswith(' ') or filename.endswith('.'):\n        return False\n\n    # Check if the filename is a reserved name\n    if filename.upper() in reserved_names:\n        return False\n\n    return True\n\n# Example usage\nprint(is_valid_windows_filename("valid_filename.txt"))  # True\nprint(is_valid_windows_filename("invalid|name.txt"))    # False\nprint(is_valid_windows_filename("COM1"))                # False