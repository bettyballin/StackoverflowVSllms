import pandas as pd\nimport smtplib\nfrom email.mime.multipart import MIMEMultipart\nfrom email.mime.text import MIMEText\nfrom email.mime.base import MIMEBase\nfrom email import encoders\nimport sqlite3\n\ndef get_data_from_db():\n    # Replace this with your actual database connection and query\n    conn = sqlite3.connect('your_database.db')\n    volunteers_df = pd.read_sql_query("SELECT * FROM volunteers_2009", conn)\n    venues_df = pd.read_sql_query("SELECT * FROM venues", conn)\n    conn.close()\n    return volunteers_df, venues_df\n\ndef export_to_csv(df, venue_id):\n    filename = f"volunteers_{venue_id}.csv"\n    df.to_csv(filename, index=False)\n    return filename\n\ndef send_email(to_email, subject, body, attachment_path):\n    from_email = "your_email@example.com"\n    password = "your_password"\n    \n    msg = MIMEMultipart()\n    msg['From'] = from_email\n    msg['To'] = to_email\n    msg['Subject'] = subject\n\n    msg.attach(MIMEText(body, 'plain'))\n\n    attachment = open(attachment_path, "rb")\n    part = MIMEBase('application', 'octet-stream')\n    part.set_payload((attachment).read())\n    encoders.encode_base64(part)\n    part.add_header('Content-Disposition', f"attachment; filename= {attachment_path}")\n    \n    msg.attach(part)\n    \n    server = smtplib.SMTP('smtp.example.com', 587)\n    server.starttls()\n    server.login(from_email, password)\n    text = msg.as_string()\n    server.sendmail(from_email, to_email, text)\n    server.quit()\n\ndef main():\n    volunteers_df, venues_df = get_data_from_db()\n    \n    for _, venue in venues_df.iterrows():\n        venue_id = venue['id']\n        chairman_email = venue['chair_email']\n        \n        filtered_volunteers = volunteers_df[volunteers_df['venue_id'] == venue_id]\n        csv_file = export_to_csv(filtered_volunteers, venue_id)\n        \n        subject = f"Volunteers List for Venue {venue_id}"\n        body = f"Please find attached the volunteers list for your venue (ID: {venue_id})."\n        \n        send_email(chairman_email, subject, body, csv_file)\n\nif __name__ == "__main__":\n    main()