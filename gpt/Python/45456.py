import os\nimport tempfile\n\ndef can_create_file(directory):\n    try:\n        # Attempt to create a temporary file in the specified directory\n        temp_file = tempfile.TemporaryFile(dir=directory)\n        temp_file.close()\n        return True\n    except (OSError, IOError):\n        return False\n\n# Example usage\ndirectory = r'C:\foo'\nif can_create_file(directory):\n    print(f"User has permission to create files in {directory}")\nelse:\n    print(f"User does NOT have permission to create files in {directory}")