from psd_tools import PSDImage\n\n# Load the PSD file\npsd = PSDImage.open('path/to/your/file.psd')\n\n# Iterate over each layer\nfor index, layer in enumerate(psd.descendants()):\n    if layer.is_group():\n        continue\n    \n    # Skip layers that are not visible\n    if not layer.visible:\n        continue\n\n    # Get the image data of the layer\n    image = layer.composite()\n\n    # Create the output filename\n    output_filename = f'layer_{index}.png'\n\n    # Save the layer as a PNG file\n    image.save(output_filename)\n    print(f'Saved layer {index} as {output_filename}')