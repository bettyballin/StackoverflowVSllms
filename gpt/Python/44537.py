from scipy.spatial import KDTree\nimport numpy as np\n\n# Example data: 450,000 points with (x, y, z, time)\ndata = np.random.rand(450000, 4)\n\n# Create the kd-tree\ntree = KDTree(data)\n\n# Define the query point and radii\nquery_point = [0.5, 0.5, 0.5, 0.5]\nspatial_radius = 0.1\ntime_radius = 0.1\n\n# Compute the squared distance threshold for the 4D radius\ntotal_radius = np.sqrt(spatial_radius**2 * 3 + time_radius**2)\n\n# Query the kd-tree for points within the radius\nneighbors = tree.query_ball_point(query_point, total_radius)\n\n# neighbors now contains the indices of all points within the given radius