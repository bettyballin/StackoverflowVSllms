import imaplib\nimport time\n\ndef process_new_mail():\n    print("New mail received!")\n\ndef idle(imap):\n    tag = imap._new_tag()\n    imap.send(f'{tag} IDLE\r\n')\n    response = imap.readline()\n    if response.startswith(f'+ '):\n        return tag\n\ndef end_idle(imap, tag):\n    imap.send(f'DONE\r\n')\n    imap.readline()\n    imap._get_tagged_response(tag)\n\ndef check_for_new_mail(imap):\n    imap.select('inbox')\n    result, data = imap.search(None, 'UNSEEN')\n    if data[0]:\n        process_new_mail()\n\ndef main():\n    # Connect to the server\n    imap_host = 'imap.gmail.com'\n    imap_user = 'your-email@gmail.com'\n    imap_pass = 'your-password'\n\n    imap = imaplib.IMAP4_SSL(imap_host)\n\n    # Login to the account\n    imap.login(imap_user, imap_pass)\n\n    while True:\n        tag = idle(imap)\n        time.sleep(60)  # IDLE timeout after 29 minutes, so refresh before that\n        check_for_new_mail(imap)\n        end_idle(imap, tag)\n\n    # Close the connection\n    imap.logout()\n\nif __name__ == '__main__':\n    main()