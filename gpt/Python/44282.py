from kombu import Connection, Exchange, Queue\n\n# Define the connection\nrabbit_url = 'amqp://guest:guest@localhost:5672//'\nconnection = Connection(rabbit_url)\n\n# Define the exchange and queue\nexchange = Exchange('example_exchange', type='direct')\nqueue = Queue('example_queue', exchange, routing_key='example_key')\n\n# Producer\nwith connection.Producer() as producer:\n    message = {'hello': 'world'}\n    producer.publish(message, exchange=exchange, routing_key='example_key')\n\n# Consumer\nwith connection.Consumer(queue, callbacks=[lambda body, message: print(body)]):\n    connection.drain_events(timeout=2)