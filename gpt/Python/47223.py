import pyodbc\n\nconn = pyodbc.connect('DSN=DataSourceName;UID=user;PWD=password')\ncursor = conn.cursor()\n\ncustid_value = 12345  # This is the value you want to use for @custid\n\nquery = """\nSELECT prodid, issue\nFROM Sales \nWHERE custid = ? \nAND datesold = (SELECT MAX(datesold) \n                FROM Sales s \n                WHERE s.prodid = Sales.prodid\n                  AND s.issue = Sales.issue\n                  AND s.custid = ?)\n"""\n\ncursor.execute(query, (custid_value, custid_value))\nresults = cursor.fetchall()\n\nfor row in results:\n    print(row)