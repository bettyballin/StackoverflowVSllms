import os\nimport uuid\nfrom flask import Flask, request, redirect, url_for\nfrom werkzeug.utils import secure_filename\n\napp = Flask(__name__)\nUPLOAD_FOLDER = 'pics'\napp.config['UPLOAD_FOLDER'] = UPLOAD_FOLDER\n\ndef allowed_file(filename):\n    return '.' in filename and filename.rsplit('.', 1)[1].lower() in {'png', 'jpg', 'jpeg', 'gif'}\n\n@app.route('/upload', methods=['POST'])\ndef upload_file():\n    if 'file' not in request.files:\n        return 'No file part'\n    file = request.files['file']\n    if file.filename == '':\n        return 'No selected file'\n    if file and allowed_file(file.filename):\n        user_id = request.form['user_id']\n        filename = secure_filename(file.filename)\n        unique_filename = f"{os.path.splitext(filename)[0]}_{user_id}_{uuid.uuid4().hex}{os.path.splitext(filename)[1]}"\n        user_folder = os.path.join(app.config['UPLOAD_FOLDER'], user_id)\n        os.makedirs(user_folder, exist_ok=True)\n        file.save(os.path.join(user_folder, unique_filename))\n        return redirect(url_for('uploaded_file', filename=unique_filename))\n\n@app.route('/uploads/<user_id>/<filename>')\ndef uploaded_file(user_id, filename):\n    return send_from_directory(os.path.join(app.config['UPLOAD_FOLDER'], user_id), filename)\n\nif __name__ == '__main__':\n    app.run()