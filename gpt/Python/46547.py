import sys\nimport ldap\nimport ldap.filter\n\n# Parse command-line arguments\nServer = "ldaps://my-ldap-server"\nDN = sys.argv[1]\nSecret = sys.argv[2]\nun = sys.argv[3]\n\nBase = "dc=mydomain,dc=co,dc=uk"\nScope = ldap.SCOPE_SUBTREE\nFilter = ldap.filter.filter_format("(&(objectClass=user)(sAMAccountName=%s))", [un])\nAttrs = ["displayName"]\n\ntry:\n    # Initialize LDAP connection\n    l = ldap.initialize(Server)\n    l.protocol_version = ldap.VERSION3\n    \n    # Perform a simple bind\n    l.simple_bind_s(DN, Secret)\n    \n    # Perform search\n    r = l.search(Base, Scope, Filter, Attrs)\n    Type, user = l.result(r, 60)\n    \n    if user:\n        Name, Attrs = user[0]\n        if 'displayName' in Attrs:\n            displayName = Attrs['displayName'][0].decode('utf-8')\n            print(displayName)\n        else:\n            print("Display name not found")\n    else:\n        print("User not found")\n\nexcept ldap.INVALID_CREDENTIALS:\n    print("Invalid credentials")\nexcept ldap.OPERATIONS_ERROR as e:\n    print(f"LDAP Operations error: {e}")\nexcept ldap.LDAPError as e:\n    print(f"LDAP error: {e}")\nfinally:\n    l.unbind_s()\n\nsys.exit()