import urllib.parse\n\ndef convert_uri_to_path(uri):\n    # Ensure the URI starts with 'file:///'\n    if not uri.startswith('file:///'):\n        raise ValueError("Invalid file URI. It should start with 'file:///'.")\n\n    # Remove the 'file:///' prefix\n    path = uri[8:]\n\n    # Decode percent-encoded characters (e.g., %20 -> space)\n    path = urllib.parse.unquote(path)\n\n    # Replace forward slashes with backslashes\n    path = path.replace('/', '\\')\n\n    # Optional: Validate the resulting path for invalid Windows filename characters\n    invalid_chars = '<>:"/\\|?*'\n    if any(char in path for char in invalid_chars):\n        raise ValueError("The path contains invalid Windows filename characters.")\n\n    return path\n\n# Example usage\nuri = 'file:///C:/DirA/DirB/With%20Spaces.txt'\ntry:\n    windows_path = convert_uri_to_path(uri)\n    print(windows_path)  # Output: C:\DirA\DirB\With Spaces.txt\nexcept ValueError as e:\n    print(f"Error: {e}")