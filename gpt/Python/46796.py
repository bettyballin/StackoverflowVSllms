def insert(d, keys, value):\n    for key in keys[:-1]:\n        d = d.setdefault(key, {})\n    d[keys[-1]] = value\n\ndef flatten_dict_to_nested(flat_dict):\n    nested_dict = {}\n    for key, value in flat_dict.items():\n        keys = key.split('/')\n        insert(nested_dict, keys, value)\n    return nested_dict\n\nflat_dict = {\n    'foo': {\n        'opt1': 1,\n        'opt2': 2,\n    },\n    'foo/bar': {\n        'opt3': 3,\n        'opt4': 4,\n    },\n    'foo/bar/baz': {\n        'opt5': 5,\n        'opt6': 6,\n    }\n}\n\nnested_dict = flatten_dict_to_nested(flat_dict)\nprint(nested_dict)