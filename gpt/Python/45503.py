ranges = [\n    (0, 100, 'a'),\n    (0, 75, 'b'),\n    (95, 150, 'c'),\n    (120, 130, 'd')\n]\n\n# Step 1: Collect all unique points\npoints = set()\nfor start, end, _ in ranges:\n    points.add(start)\n    points.add(end + 1)  # add end+1 to handle end inclusivity\n\n# Step 2: Sort these points\nsorted_points = sorted(points)\n\n# Step 3: Create non-overlapping ranges\nnon_overlapping_ranges = []\nfor i in range(len(sorted_points) - 1):\n    non_overlapping_ranges.append((sorted_points[i], sorted_points[i+1] - 1))\n\n# Step 4: Determine which original ranges overlap with each new range\nresult = []\nfor start, end in non_overlapping_ranges:\n    labels = set()\n    for r_start, r_end, label in ranges:\n        if not (end < r_start or start > r_end):\n            labels.add(label)\n    if labels:\n        result.append((start, end, sorted(labels)))\n\n# Print the result\nfor start, end, labels in result:\n    print(f"{start} - {end}: {', '.join(labels)}")