Imports System\nImports System.Windows.Forms\n\nModule Program\n    Sub Main()\n        ' Add the event handler for handling UI thread exceptions to the event.\n        AddHandler Application.ThreadException, AddressOf Application_ThreadException\n\n        ' Add the event handler for handling non-UI thread exceptions to the event.\n        AddHandler AppDomain.CurrentDomain.UnhandledException, AddressOf CurrentDomain_UnhandledException\n\n        ' Start the application.\n        Application.Run(New MainForm())\n    End Sub\n\n    Private Sub Application_ThreadException(sender As Object, e As Threading.ThreadExceptionEventArgs)\n        ' Handle the exception here\n        MessageBox.Show("An unhandled UI thread exception occurred: " & e.Exception.Message, _\n                        "Unhandled Exception", MessageBoxButtons.OK, MessageBoxIcon.Error)\n    End Sub\n\n    Private Sub CurrentDomain_UnhandledException(sender As Object, e As UnhandledExceptionEventArgs)\n        ' Handle the exception here\n        Dim ex As Exception = CType(e.ExceptionObject, Exception)\n        MessageBox.Show("An unhandled non-UI thread exception occurred: " & ex.Message, _\n                        "Unhandled Exception", MessageBoxButtons.OK, MessageBoxIcon.Error)\n    End Sub\nEnd Module