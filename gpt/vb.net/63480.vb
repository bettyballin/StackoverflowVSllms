Imports System.IO\nImports System.Threading\n\nModule Module1\n\n    Sub Main()\n        ' Example usage\n        Dim inputFiles As String() = {"image1.jpg", "image2.jpg", "image3.jpg"}\n        Dim outputFile As String = "resource.dat"\n        CreateResourceFile(inputFiles, outputFile)\n    End Sub\n\n    Sub CreateResourceFile(inputFiles As String(), outputFile As String)\n        Dim threads As New List(Of Thread)\n        Dim fileStream As New FileStream(outputFile, FileMode.Create, FileAccess.Write, FileShare.None)\n\n        For Each inputFile As String In inputFiles\n            Dim t As New Thread(Sub() AddFileToResource(inputFile, fileStream))\n            t.Start()\n            threads.Add(t)\n        Next\n\n        ' Wait for all threads to finish\n        For Each t As Thread In threads\n            t.Join()\n        Next\n\n        fileStream.Close()\n    End Sub\n\n    Sub AddFileToResource(inputFile As String, fileStream As FileStream)\n        SyncLock fileStream\n            Using inputStream As New FileStream(inputFile, FileMode.Open, FileAccess.Read)\n                Dim buffer As Byte() = New Byte(inputStream.Length - 1) {}\n                inputStream.Read(buffer, 0, buffer.Length)\n                fileStream.Write(buffer, 0, buffer.Length)\n            End Using\n        End SyncLock\n    End Sub\n\nEnd Module