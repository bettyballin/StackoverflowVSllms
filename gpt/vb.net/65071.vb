Imports System.Xml.Linq\n\nPublic Class Profile\n    Public Property Name As String\n    Public Property Items As List(Of ProfileItem)\n\n    Public Function GetProfileItems() As List(Of ProfileItem)\n        Return Items\n    End Function\nEnd Class\n\nPublic Class ProfileItem\n    Public Property Name As String\n    Public Property Action As String\n    Public Property Type As String\n    Public Property Arguments As String\n    Public Property Dependencies As List(Of ProfileItem)\n\n    Public Function GetDependencies() As List(Of ProfileItem)\n        Return Dependencies\n    End Function\nEnd Class\n\nPublic Function GenerateXml(profiles As List(Of Profile)) As XDocument\n    Dim xdoc As XDocument = _\n        <?xml version="1.0" encoding="utf-8"?>\n        <profiles>\n            <%= From p In profiles _\n                Select <profile name=<%= p.Name %>>\n                           <%= GenerateProfileItems(p.GetProfileItems) %>\n                       </profile> _ %>\n        </profiles>\n    Return xdoc\nEnd Function\n\nPrivate Function GenerateProfileItems(items As List(Of ProfileItem)) As IEnumerable(Of XElement)\n    Return From i In items _\n           Select <item>\n                      <name><%= i.Name %></name>\n                      <action><%= i.Action %></action>\n                      <type><%= i.Type %></type>\n                      <arguments><%= i.Arguments %></arguments>\n                      <dependencies>\n                          <%= GenerateProfileItems(i.GetDependencies) %>\n                      </dependencies>\n                  </item>\nEnd Functio