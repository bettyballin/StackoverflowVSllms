Imports System.Net\nImports System.Net.Sockets\nImports System.Text\n\nPublic Class SmtpServer\n\n    Private Listener As TcpListener\n\n    Public Sub New(port As Integer)\n        Listener = New TcpListener(IPAddress.Loopback, port)\n    End Sub\n\n    Public Sub Start()\n        Listener.Start()\n        Console.WriteLine("SMTP Server Started...")\n\n        While True\n            Dim client As TcpClient = Listener.AcceptTcpClient()\n            Dim clientThread As New Threading.Thread(AddressOf HandleClient)\n            clientThread.Start(client)\n        End While\n    End Sub\n\n    Private Sub HandleClient(client As TcpClient)\n        Dim stream As NetworkStream = client.GetStream()\n        Dim reader As New IO.StreamReader(stream, Encoding.ASCII)\n        Dim writer As New IO.StreamWriter(stream, Encoding.ASCII) With {.AutoFlush = True}\n\n        writer.WriteLine("220 localhost Simple SMTP Server")\n\n        ' Handle SMTP commands from client\n        While True\n            Dim line As String = reader.ReadLine()\n            If String.IsNullOrEmpty(line) Then Exit While\n\n            Console.WriteLine("Received: " & line)\n            If line.StartsWith("HELO") Then\n                writer.WriteLine("250 Hello " & line.Split(" "c)(1))\n            ElseIf line.StartsWith("MAIL FROM:") Then\n                writer.WriteLine("250 OK")\n            ElseIf line.StartsWith("RCPT TO:") Then\n                writer.WriteLine("250 OK")\n            ElseIf line.StartsWith("DATA") Then\n                writer.WriteLine("354 End data with <CR><LF>.<CR><LF>")\n                Dim data As New StringBuilder()\n                While True\n                    Dim dataLine As String = reader.ReadLine()\n                    If dataLine = "." Then Exit While\n                    data.AppendLine(dataLine)\n                Next\n                ' Here you could save the email data to a file or handle it as needed\n                writer.WriteLine("250 OK")\n            ElseIf line.StartsWith("QUIT") Then\n                writer.WriteLine("221 Bye")\n                Exit While\n            Else\n                writer.WriteLine("502 Command not implemented")\n            End If\n        End While\n\n        client.Close()\n    End Sub\n\nEnd Class\n\nModule Module1\n    Sub Main()\n        Dim smtpServer As New SmtpServer(25) ' Port 25 for SMTP\n        smtpServer.Start()\n    End Sub\nEnd Module