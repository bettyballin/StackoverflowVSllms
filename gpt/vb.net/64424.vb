Imports System.Web.Script.Serialization\n   \n   Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load\n       Dim myTableAdapter As New myDatasetTableAdapters.tblMapsTableAdapter()\n       Dim myTable As myDataset.tblMapsDataTable = myTableAdapter.GetAllMaps()\n\n       ' Convert the DataTable to a List of Dictionaries\n       Dim mapsList As New List(Of Dictionary(Of String, String))()\n       For Each row As DataRow In myTable.Rows\n           Dim map As New Dictionary(Of String, String)()\n           map("Map_ID") = row("Map_ID").ToString()\n           map("Coordinates") = row("Coordinates").ToString()\n           map("MarkerTitle") = row("MarkerTitle").ToString()\n           map("MarkerField") = row("MarkerField").ToString()\n           mapsList.Add(map)\n       Next\n\n       ' Serialize the list to JSON\n       Dim js As New JavaScriptSerializer()\n       Dim jsonMaps As String = js.Serialize(mapsList)\n\n       ' Register the JSON string as a JavaScript variable\n       ClientScript.RegisterStartupScript(Me.GetType(), "mapsData", "var mapsData = " & jsonMaps & ";", True)\n   End Sub