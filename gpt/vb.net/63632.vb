Imports System.Web.UI\n\nPartial Class Successful\n    Inherits Page\n\n    Protected Sub Page_Load(ByVal sender As Object, ByVal e As EventArgs) Handles Me.Load\n        If Not IsPostBack Then\n            ProcessPayment()\n        End If\n    End Sub\n\n    Private Sub ProcessPayment()\n        Try\n            ' Retrieve data from the payment provider\n            Dim transactionId As String = Request.QueryString("transactionId")\n            Dim status As String = Request.QueryString("status")\n\n            If status = "success" Then\n                ' Perform processing, like updating database fields\n                ' Example: Set Paid, PaidDate fields\n                ' Your database update logic here\n\n                ' Log success\n                System.Diagnostics.Trace.WriteLine("Payment processed successfully for transaction ID: " & transactionId)\n            Else\n                ' Handle failure case\n                System.Diagnostics.Trace.WriteLine("Payment failed for transaction ID: " & transactionId)\n            End If\n        Catch ex As Exception\n            ' Log exception\n            System.Diagnostics.Trace.WriteLine("Error processing payment: " & ex.Message)\n        End Try\n    End Sub\nEnd Class