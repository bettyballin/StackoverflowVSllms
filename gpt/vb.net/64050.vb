Imports System.Data.SqlClient\nImports System.IO\n\nSub ExecuteSqlScript(con As SqlConnection, scriptPath As String)\n    Try\n        ' Read the script from file\n        Dim dbScript As String = File.ReadAllText(scriptPath)\n\n        ' Split the script by "GO" statements\n        Dim scripts As String() = dbScript.Split(New String() {"GO"}, StringSplitOptions.RemoveEmptyEntries)\n\n        ' Open the connection\n        con.Open()\n\n        For Each script As String In scripts\n            If Not String.IsNullOrWhiteSpace(script) Then\n                Using cmd As New SqlCommand(script, con)\n                    cmd.ExecuteNonQuery()\n                End Using\n            End If\n        Next\n\n    Catch ex As Exception\n        ' Handle exceptions\n        Console.WriteLine(ex.Message)\n    Finally\n        ' Ensure the connection is closed\n        If con.State = ConnectionState.Open Then\n            con.Close()\n        End If\n    End Try\nEnd Sub