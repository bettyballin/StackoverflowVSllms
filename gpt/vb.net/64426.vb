Imports System.ComponentModel\nImports System.Windows.Forms\n\n<TypeConverter(GetType(ExpandableObjectConverter))>\nPublic Class StateOfMyCustomControl\n\n    Public Enum EnumVisibility\n        Visible\n        NonVisible\n    End Enum\n\n    Public Enum EnumEventManagement\n        Automatic\n        Manual\n    End Enum\n\n    Private mAssociatedControl As MyCustomControl\n    Private mVisibility As EnumVisibility\n    Private mEventManagement As EnumEventManagement\n\n    Public Sub New(ByVal AssociatedControl As MyCustomControl)\n        mAssociatedControl = AssociatedControl\n    End Sub\n\n    Public Property Visibility() As EnumVisibility\n        Get\n            Return mVisibility\n        End Get\n        Set(ByVal value As EnumVisibility)\n            mVisibility = value\n            mAssociatedControl.Visible = (mVisibility = EnumVisibility.Visible)\n        End Set\n    End Property\n\n    Public Property EventManagement() As EnumEventManagement\n        Get\n            Return mEventManagement\n        End Get\n        Set(ByVal value As EnumEventManagement)\n            mEventManagement = value\n        End Set\n    End Property\n\n    Public Overrides Function ToString() As String\n        ' This is to show something meaningful in the property grid\n        Return "State Settings"\n    End Function\n\nEnd Class\n\nPublic Class MyCustomControl\n    Inherits Control\n\n    Private mState As StateOfMyCustomControl\n\n    Public Sub New()\n        mState = New StateOfMyCustomControl(Me)\n    End Sub\n\n    <DesignerSerializationVisibility(DesignerSerializationVisibility.Content)>\n    Public Property State() As StateOfMyCustomControl\n        Get\n            Return mState\n        End Get\n        Set(ByVal value As StateOfMyCustomControl)\n            mState = value\n        End Set\n    End Property\n\nEnd Class