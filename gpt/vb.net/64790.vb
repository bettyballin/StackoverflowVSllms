Using cn As SqlConnection = MyApp.GetConnection\n  Using cmd As New SqlCommand(strSQL, cn)\n    Using da As New SqlDataAdapter(cmd)\n      Dim ds As New DataSet\n      Try\n        da.Fill(ds)\n        \n        ' Fetch primary key information\n        Dim schemaCmd As New SqlCommand("SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE WHERE TABLE_NAME = 'YourTableName' AND OBJECTPROPERTY(OBJECT_ID(CONSTRAINT_SCHEMA + '.' + CONSTRAINT_NAME), 'IsPrimaryKey') = 1", cn)\n        Dim primaryKeyColumn As String = schemaCmd.ExecuteScalar().ToString()\n        \n        ' Set primary key\n        If ds.Tables.Count > 0 Then\n          Dim dt As DataTable = ds.Tables(0)\n          dt.PrimaryKey = New DataColumn() {dt.Columns(primaryKeyColumn)}\n        End If\n        \n        Return ds\n      Catch ex As Exception\n        MyAppClass.LogWarning(ex, EventLogEntryType.Error)\n        Throw\n      End Try\n    End Using \n  End Using \nEnd Using