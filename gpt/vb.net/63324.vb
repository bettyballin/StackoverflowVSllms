Dim binding As New NetTcpBinding()\nbinding.Security.Mode = SecurityMode.Message\nbinding.Security.Message.AlgorithmSuite = System.ServiceModel.Security.SecurityAlgorithmSuite.Basic128\nbinding.Security.Message.ClientCredentialType = MessageCredentialType.Windows\n\nDim upn As String = "usertest@testdomain.com"\n\nDim ep As New EndpointAddress(New Uri("net.tcp://server1.testdomain.com:1111/ServiceTest"), _\n                              EndpointIdentity.CreateUpnIdentity(upn))\n\nDim factory As New ChannelFactory(Of Credential.Interface.ICredentialTest)(binding, ep)\nfactory.Credentials.Windows.AllowNtlm = False\nfactory.Credentials.Windows.AllowedImpersonationLevel = System.Security.Principal.TokenImpersonationLevel.Delegation\n\nDim iproxy As Credential.Interface.ICredentialTest = factory.CreateChannel()\nDim co As ICommunicationObject = CType(iproxy, ICommunicationObject)\nTry\n    iproxy.ToService(result)\n    co.Close()\nCatch ex As Exception\n    co.Abort()\n    Throw\nEnd Try