' MouseDown event to start the drag operation\nPrivate Sub DataGridView1_MouseDown(ByVal sender As System.Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles DataGridView1.MouseDown\n    If e.Button = MouseButtons.Left Then\n        If DataGridView1.CurrentCell IsNot Nothing Then\n            DataGridView1.DoDragDrop(DataGridView1.CurrentCell, DragDropEffects.Copy)\n        End If\n    End If\nEnd Sub\n\n' DragDrop event to handle the drop\nPrivate Sub DataGridView1_DragDrop(ByVal sender As System.Object, ByVal e As System.Windows.Forms.DragEventArgs) Handles DataGridView1.DragDrop\n    If e.Data.GetDataPresent(GetType(DataGridViewCell)) Then\n        Dim copyedFromCell As DataGridViewCell = DirectCast(e.Data.GetData(GetType(DataGridViewCell)), DataGridViewCell)\n\n        If copyedFromCell IsNot Nothing AndAlso DataGridView1.CurrentCell IsNot Nothing Then\n            Dim copyedFromKey As String = GetMappingForCell(copyedFromCell)\n            Dim thisKey As String = GetMappingForCell(DataGridView1.CurrentCell)\n            Dim copyedFromValue As Object = copyedFromCell.Value\n            Dim thisValue As Object = DataGridView1.CurrentCell.Value\n\n            ' Swap the dictionary mappings\n            mappings(copyedFromKey) = DataGridView1.CurrentCell\n            mappings(thisKey) = copyedFromCell\n\n            ' Swap the cell values\n            DataGridView1.CurrentCell.Value = copyedFromValue\n            copyedFromCell.Value = thisValue\n        End If\n    End If\nEnd Sub\n\n' DragEnter event to set the effect\nPrivate Sub DataGridView1_DragEnter(ByVal sender As System.Object, ByVal e As System.Windows.Forms.DragEventArgs) Handles DataGridView1.DragEnter\n    If e.Data.GetDataPresent(GetType(DataGridViewCell)) Then\n        e.Effect = DragDropEffects.Copy\n    Else\n        e.Effect = DragDropEffects.None\n    End If\nEnd Sub