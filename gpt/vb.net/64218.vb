Public Sub New()\n    ' This call is required by the Windows Form Designer.\n    InitializeComponent()\n\n    ' Enable double buffering for the panels to reduce flicker\n    SetDoubleBuffered(Panel2)\n    SetDoubleBuffered(Panel3)\nEnd Sub\n\nPrivate Sub SetDoubleBuffered(ByVal panel As Panel)\n    ' Set the DoubleBuffered property to True to reduce flicker\n    Dim panelType As Type = panel.GetType()\n    Dim prop As System.Reflection.PropertyInfo = panelType.GetProperty("DoubleBuffered", System.Reflection.BindingFlags.Instance Or System.Reflection.BindingFlags.NonPublic)\n    prop.SetValue(panel, True, Nothing)\nEnd Sub\n\nPrivate Sub TrackBar2_Scroll(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TrackBar2.Scroll, TrackBar1.Scroll\n    If (Panel2.Tag <> TrackBar1.Value) Then\n        Panel2.Tag = TrackBar1.Value\n        Panel2.BackgroundImage = tops(TrackBar1.Value) ' img array for the top panel\n        Panel2.Invalidate() ' Use Invalidate instead of Update\n    End If\n\n    If (Panel3.Tag <> TrackBar2.Value) Then\n        Panel3.Tag = TrackBar2.Value\n        If (TrackBar2.Value > 0) Then\n            Panel3.Location = New Point(182, 210)\n        Else\n            Panel3.Location = New Point(182, 209)\n        End If\n        Panel3.BackgroundImage = bottoms(TrackBar2.Value) ' img array for the bottom panel\n        Panel3.Invalidate() ' Use Invalidate instead of Update\n    End If\nEnd Sub