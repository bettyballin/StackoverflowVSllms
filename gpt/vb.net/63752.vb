Imports System.Xml.Linq\nImports System.Reflection\n\nPrivate Shared Function CreateBaseArrayInputs(Of T)(ByVal ListOfItems As List(Of T), ByVal propertyName As String) As XElement\n    Dim InputElementsArray As XElement = New XElement("ArrayInputs", \n                                                      New XElement("InputName", "TestFailureCodeList"), \n                                                      New XElement("DataType", "StringArray"), \n                                                      New XElement("ValueList", From d In ListOfItems \n                                                                                Select New XElement("InputValue", d.GetType().GetProperty(propertyName).GetValue(d, Nothing))))\n    Return InputElementsArray\nEnd Functio