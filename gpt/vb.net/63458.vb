<TestMethod>\nPublic Sub Index_ReturnsCorrectViewModel()\n  ' Arrange\n  Dim mockPortalClientService As New Mock(Of IPortalClientService)()\n  Dim mockMembershipService As New Mock(Of IMembershipService)()\n  \n  ' Set up the mock services with test data\n  mockPortalClientService.Setup(Function(s) s.GetFirstClient()).Returns(New Client() With {.ID = 1})\n  mockPortalClientService.Setup(Function(s) s.GetClients()).Returns(New List(Of Client)() From {New Client() With {.ID = 1, .ClientName = "Test Client"}})\n  mockMembershipService.Setup(Function(s) s.GetUsersByClientId(It.IsAny(Of Integer), It.IsAny(Of Integer), It.IsAny(Of Integer), It.IsAny(Of Integer).Ref)).Returns(New MembershipUserCollection())\n\n  Dim controller As New MyController(mockPortalClientService.Object, mockMembershipService.Object)\n\n  ' Act\n  Dim result As ActionResult = controller.Index(Nothing)\n\n  ' Assert\n  Dim viewResult As ViewResult = CType(result, ViewResult)\n  Dim model As UserListViewModel = CType(viewResult.Model, UserListViewModel)\n  Assert.IsNotNull(model)\n  Assert.AreEqual(1, model.Clients.First().Value)\nEnd Sub