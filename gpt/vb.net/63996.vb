Imports System.Linq.Dynamic.Core\n\nFunction MemberData(ByVal sidx As String, ByVal sord As String, ByVal page As Integer, ByVal rows As Integer) As JsonResult\n    Dim allRecords As IQueryable(Of Models.Member) = Me.MemberRepository.FindAllMembers()\n    Dim pageIndex As Integer = page - 1\n    Dim pageSize As Integer = rows\n    Dim totalRecords As Integer = allRecords.Count()\n    Dim totalPages As Integer = CInt(Math.Ceiling(totalRecords / pageSize))\n\n    Dim orderBy As String = sidx & " " & sord\n\n    Dim currentPageRecords As IQueryable(Of Models.Member) = allRecords.OrderBy(orderBy).Skip(pageIndex * pageSize).Take(pageSize)\n\n    Dim jsonData = New With {\n        .total = totalPages,\n        .page = page,\n        .records = totalRecords,\n        .rows = currentPageRecords.Select(Function(member) New With {\n            .id = member.MemberId,\n            .cell = GenerateCellData(member)\n        }).ToArray()\n    }\n\n    Return Json(jsonData)\nEnd Functio