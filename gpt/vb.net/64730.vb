Function IsUserMemberOfGroup(sAMAccountName As String, groupName As String) As Boolean\n    Dim objUser As Object\n    Dim objGroup As Object\n    Dim objRootDSE As Object\n    Dim strDomain As String\n    Dim strUserDN As String\n    Dim strGroupDN As String\n    Dim blnIsMember As Boolean\n\n    On Error GoTo ErrorHandler\n\n    ' Get the domain from the RootDSE object\n    Set objRootDSE = GetObject("LDAP://RootDSE")\n    strDomain = objRootDSE.Get("defaultNamingContext")\n\n    ' Get the user and group distinguished names\n    strUserDN = "LDAP://CN=" & sAMAccountName & ",CN=Users," & strDomain\n    strGroupDN = "LDAP://CN=" & groupName & ",CN=Users," & strDomain\n\n    ' Get the user and group objects\n    Set objUser = GetObject(strUserDN)\n    Set objGroup = GetObject(strGroupDN)\n\n    ' Check if the user is a member of the group\n    blnIsMember = objGroup.IsMember(strUserDN)\n\n    IsUserMemberOfGroup = blnIsMember\n\n    Exit Function\n\nErrorHandler:\n    IsUserMemberOfGroup = False\nEnd Functio