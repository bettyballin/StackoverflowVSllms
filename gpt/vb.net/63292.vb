Public Function GetProperties(searchParams As Dictionary(Of String, String)) As DataTable\n    Dim query As New StringBuilder()\n    query.Append("SELECT p.*, pic.*, f.* FROM Properties p ")\n    query.Append("LEFT JOIN Pictures pic ON p.PropertyID = pic.PropertyID ")\n    query.Append("LEFT JOIN Features f ON p.PropertyID = f.PropertyID ")\n    query.Append("WHERE 1=1 ")\n\n    Dim parameters As New List(Of SqlParameter)()\n\n    For Each param In searchParams\n        Select Case param.Key\n            Case "Country"\n                query.Append("AND p.Country = @Country ")\n                parameters.Add(New SqlParameter("@Country", param.Value))\n            Case "Region"\n                query.Append("AND p.Region = @Region ")\n                parameters.Add(New SqlParameter("@Region", param.Value))\n            Case "Area"\n                query.Append("AND p.Area = @Area ")\n                parameters.Add(New SqlParameter("@Area", param.Value))\n            Case "Bedrooms"\n                query.Append("AND p.Bedrooms = @Bedrooms ")\n                parameters.Add(New SqlParameter("@Bedrooms", param.Value))\n            Case "PriceRange"\n                query.Append("AND p.Price BETWEEN @MinPrice AND @MaxPrice ")\n                Dim priceRange = param.Value.Split("-"c)\n                parameters.Add(New SqlParameter("@MinPrice", priceRange(0)))\n                parameters.Add(New SqlParameter("@MaxPrice", priceRange(1)))\n            ' Add more cases for other search parameters if needed\n        End Select\n    Next\n\n    Dim dt As New DataTable()\n    Using conn As New SqlConnection("your_connection_string")\n        Using cmd As New SqlCommand(query.ToString(), conn)\n            cmd.Parameters.AddRange(parameters.ToArray())\n            Using da As New SqlDataAdapter(cmd)\n                da.Fill(dt)\n            End Using\n        End Using\n    End Using\n\n    Return dt\nEnd Functio