Protected Sub GridView1_RowDataBound(ByVal sender As Object, ByVal e As GridViewRowEventArgs) Handles GridView1.RowDataBound\n    If e.Row.RowType = DataControlRowType.DataRow Then\n        ' Your existing code for calculating totals\n        TotalOffered += Convert.ToDouble(DataBinder.Eval(e.Row.DataItem, "Offered"))\n        TotalHandled += Convert.ToDouble(DataBinder.Eval(e.Row.DataItem, "Handled"))\n        TotalHandled30 += Convert.ToDouble(DataBinder.Eval(e.Row.DataItem, "Handled30"))\n        TotalHandlingTime += Convert.ToDouble(DataBinder.Eval(e.Row.DataItem, "AHT")) * Convert.ToDouble(DataBinder.Eval(e.Row.DataItem, "Handled"))\n        TotalTalkTime += (Convert.ToDouble(DataBinder.Eval(e.Row.DataItem, "AHT")) * Convert.ToDouble(DataBinder.Eval(e.Row.DataItem, "Talk"))) * Convert.ToDouble(DataBinder.Eval(e.Row.DataItem, "Handled"))\n        TotalHoldTime += (Convert.ToDouble(DataBinder.Eval(e.Row.DataItem, "AHT")) * Convert.ToDouble(DataBinder.Eval(e.Row.DataItem, "Hold"))) * Convert.ToDouble(DataBinder.Eval(e.Row.DataItem, "Handled"))\n        TotalWrapTime += (Convert.ToDouble(DataBinder.Eval(e.Row.DataItem, "AHT")) * Convert.ToDouble(DataBinder.Eval(e.Row.DataItem, "Work"))) * Convert.ToDouble(DataBinder.Eval(e.Row.DataItem, "Handled"))\n\n        ' Checking for agent data and hiding columns based on the existence of data\n        If IsDBNull(DataBinder.Eval(e.Row.DataItem, "Pri_Agent_Sign_in")) Then\n            GridView1.Columns(0).Visible = False\n        Else\n            TotalSignedin += Convert.ToDouble(DataBinder.Eval(e.Row.DataItem, "Pri_Agent_Sign_in"))\n            TotalAvail += Convert.ToDouble(DataBinder.Eval(e.Row.DataItem, "Pri_Agent_Sign_in")) * Convert.ToDouble(DataBinder.Eval(e.Row.DataItem, "Avail_Time"))\n            TotalIdle += Convert.ToDouble(DataBinder.Eval(e.Row.DataItem, "Pri_Agent_Sign_in")) * Convert.ToDouble(DataBinder.Eval(e.Row.DataItem, "Unavail_Time"))\n        End If\n    End If\nEnd Sub\n\nProtected Sub GridView1_DataBound(ByVal sender As Object, ByVal e As EventArgs) Handles GridView1.DataBound\n    ' Iterate through each column to check if it should be hidden\n    For Each column As DataControlField In GridView1.Columns\n        Dim visible As Boolean = False\n\n        ' Check each row for data in the current column\n        For Each row As GridViewRow In GridView1.Rows\n            If row.RowType = DataControlRowType.DataRow Then\n                Dim cellText As String = row.Cells(GridView1.Columns.IndexOf(column)).Text\n                If Not String.IsNullOrEmpty(cellText) AndAlso cellText <> "&nbsp;" Then\n                    visible = True\n                    Exit For\n                End If\n            End If\n        Next\n\n        ' Hide column if no data is found\n        If Not visible Then\n            column.Visible = False\n        End If\n    Next\nEnd Sub