Imports Microsoft.Win32\nImports System.Security.Principal\nImports System.Runtime.InteropServices\n\nModule RegistryHelper\n\n    Const HKEY_USERS As String = "HKEY_USERS"\n\n    <DllImport("advapi32.dll", SetLastError:=True)>\n    Private Function RegLoadKey(hKey As IntPtr, lpSubKey As String, lpFile As String) As Integer\n    End Function\n\n    <DllImport("advapi32.dll", SetLastError:=True)>\n    Private Function RegUnLoadKey(hKey As IntPtr, lpSubKey As String) As Integer\n    End Function\n\n    Sub Main()\n        Dim username As String = "targetUsername"\n        Dim userProfilePath As String = "C:\Users\" & username & "\NTUSER.DAT"\n        Dim targetHive As String = "TempHive"\n\n        ' Load the user's registry hive\n        Dim result As Integer = RegLoadKey(New IntPtr(&H80000003), targetHive, userProfilePath)\n        If result <> 0 Then\n            Throw New System.ComponentModel.Win32Exception(result)\n        End If\n\n        ' Access the user's registry settings\n        Using key As RegistryKey = Registry.Users.OpenSubKey(targetHive)\n            If key IsNot Nothing Then\n                ' Perform operations on the user's registry settings here\n            End If\n        End Using\n\n        ' Unload the user's registry hive\n        result = RegUnLoadKey(New IntPtr(&H80000003), targetHive)\n        If result <> 0 Then\n            Throw New System.ComponentModel.Win32Exception(result)\n        End If\n    End Sub\nEnd Module