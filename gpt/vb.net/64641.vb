For Each fileName As String In Directory.GetFiles("C:\TEMP\", "*.xls")\n    Dim connectionString As String = String.Format("Provider=Microsoft.Jet.OLEDB.4.0; data source={0}; Extended Properties=""Excel 8.0;HDR=NO;IMEX=1;""", fileName)\n    Dim adapter As New OleDbDataAdapter("SELECT * FROM [Sheet1$]", connectionString)\n    Dim ds As New DataSet\n    adapter.Fill(ds, "anyNameHere")\n    Dim TempTable As DataTable\n    TempTable = ds.Tables.Item("anyNameHere")\n\n    ' Ensure all columns have the same data type\n    For Each column As DataColumn In TempTable.Columns\n        If table1.Columns.Contains(column.ColumnName) AndAlso table1.Columns(column.ColumnName).DataType <> column.DataType Then\n            column.DataType = table1.Columns(column.ColumnName).DataType\n        End If\n    Next\n\n    table1.Merge(TempTable)\n    MsgBox(fileName)\nNext\n\nDataGridView1.DataSource = table1\nMsgBox(table1.Rows.Count)