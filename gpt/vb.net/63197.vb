Imports System.Data.SqlClient\n\nPublic Sub InsertData()\n    ' Define the connection string (update with your actual connection string)\n    Dim connectionString As String = "your_connection_string_here"\n\n    Using connection As New SqlConnection(connectionString)\n        connection.Open()\n\n        ' Start a local transaction\n        Dim transaction As SqlTransaction = connection.BeginTransaction()\n\n        Try\n            ' Create the command and associate it with the transaction\n            Dim command As New SqlCommand("YourCombinedStoredProcedure", connection, transaction)\n            command.CommandType = CommandType.StoredProcedure\n\n            ' Add parameters to the command as needed\n            ' command.Parameters.AddWithValue("@param1", value1)\n\n            ' Execute the command\n            command.ExecuteNonQuery()\n\n            ' Commit the transaction if all commands succeed\n            transaction.Commit()\n        Catch ex As Exception\n            ' Handle the error\n            Console.WriteLine("An error occurred: " & ex.Message)\n\n            Try\n                ' Attempt to rollback the transaction\n                transaction.Rollback()\n            Catch ex2 As Exception\n                ' Handle the error that occurred during the rollback\n                Console.WriteLine("An error occurred during rollback: " & ex2.Message)\n            End Try\n        End Try\n    End Using\nEnd Sub