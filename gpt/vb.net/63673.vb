Imports System.Runtime.CompilerServices\nImports System.Collections.Generic\n\nModule DictionaryExtensions\n    ''' <summary> \n    ''' Adds the specified value to the multi value dictionary. \n    ''' </summary> \n    ''' <param name="key">The key of the element to add.</param> \n    ''' <param name="value">The value of the element to add. The value can be null for reference types.</param> \n    <Extension()>\n    Public Sub Add(Of KeyType, ListType As {IList(Of ValueType), New}, ValueType) _\n                  (ByVal thisDictionary As Dictionary(Of KeyType, ListType), ByVal key As KeyType, ByVal value As ValueType)\n        'if the dictionary doesn't contain the key, make a new list under the key \n        If Not thisDictionary.ContainsKey(key) Then\n            thisDictionary.Add(key, New ListType())\n        End If\n\n        'add the value to the list at the key index \n        thisDictionary(key).Add(value)\n    End Sub\nEnd Module