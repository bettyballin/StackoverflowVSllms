Sub Main()\n    On Error GoTo ErrorHandler\n\n    ' Your code here\n\n    Exit Sub\n\nErrorHandler:\n    Dim ex As Exception = New Exception("An error occurred.")\n    ex = New Exception("An error occurred.", Err.GetException)\n    Throw ex ' This will be caught in a structured handler\nEnd Sub\n\nTry\n    Main()\nCatch ex As Exception\n    ' This will print the stack trace\n    Console.WriteLine(ex.ToString())\nEnd Try