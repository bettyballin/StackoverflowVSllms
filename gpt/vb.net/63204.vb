Imports System.DirectoryServices\n\nPublic Function GetDomainUsers() As List(Of String)\n    Dim domainUsers As New List(Of String)\n    Dim entry As New DirectoryEntry("LDAP://DC=Mydomain,DC=local")\n    Dim searcher As New DirectorySearcher(entry)\n\n    searcher.Filter = "(&(objectClass=user)(objectCategory=person))"\n    searcher.PageSize = 1000 ' Use paging to handle large results\n    searcher.PropertiesToLoad.Add("sAMAccountName")\n\n    Try\n        Dim results As SearchResultCollection = searcher.FindAll()\n        For Each result As SearchResult In results\n            If result.Properties.Contains("sAMAccountName") Then\n                domainUsers.Add(result.Properties("sAMAccountName")(0).ToString())\n            End If\n        Next\n    Catch ex As Exception\n        ' Handle exception\n        Console.WriteLine("Error: " & ex.Message)\n    Finally\n        searcher.Dispose()\n        entry.Dispose()\n    End Try\n\n    Return domainUsers\nEnd Functio