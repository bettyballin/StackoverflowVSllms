Protected Sub dsTreatmentCats_Deleted(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.SqlDataSourceStatusEventArgs) Handles dsTreatmentCats.Deleted\n    Dim returnValue As Integer = CInt(e.Command.Parameters("@RetVal").Value)\n    \n    Select Case returnValue\n        Case 0\n            ' It worked, so no action\n            lblError.Visible = False\n        Case 1\n            lblError.Text = "Unable to delete this category because it still has treatments associated with it."\n            lblError.Visible = True\n        Case 2\n            lblError.Text = "Unable to delete this category due to an unexpected error. Please try again later."\n            lblError.Visible = True\n    End Select\nEnd Sub