Dim objApp As New Microsoft.Office.Interop.Visio.InvisibleApp\n\n' Save the current security settings\nDim originalSecurity As Integer = objApp.SecuritySettings.EnableMacro\n\n' Lower macro security to the lowest level\nobjApp.SecuritySettings.EnableMacro = Microsoft.Office.Core.MsoAutomationSecurity.msoAutomationSecurityLow\n\n' Open the document\nDim objDoc As Microsoft.Office.Interop.Visio.Document\nobjDoc = objApp.Documents.Open(VisioFilename)\n\n' Process the document (e.g., convert to SVG)\n\n' Restore the original security settings\nobjApp.SecuritySettings.EnableMacro = originalSecurity\n\n' Clean up\nobjDoc.Close()\nobjApp.Quit()\nMarshal.ReleaseComObject(objDoc)\nMarshal.ReleaseComObject(objApp)