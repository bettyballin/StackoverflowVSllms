Dim cmd As DbCommand\nDim ResultValue as String\nDim lDBCommand as String = "dbo.GetNumberToProcess"\nDim actionDB As Sql.SqlDatabase = New Sql.SqlDatabase(lConnectionString)\n\n' Use GetStoredProcCommand to specify that this is a stored procedure\ncmd = actionDB.GetStoredProcCommand(lDBCommand)\n\nDim SQLreturnValue As New SqlParameter()\nSQLreturnValue.ParameterName = "RETURN_VALUE"\nSQLreturnValue.DbType = DbType.Int32\nSQLreturnValue.Direction = ParameterDirection.ReturnValue\n\ncmd.Parameters.Add(SQLreturnValue)\n\n' Execute the command and put the result into the ResultValue for later processing\nactionDB.ExecuteNonQuery(cmd)\nResultValue = cmd.Parameters("RETURN_VALUE").Value.ToString()