Imports System.Diagnostics\n\nPublic Sub LogExceptionToEventLog(ex As Exception)\n    Dim eventLog As New EventLog()\n    If Not EventLog.SourceExists("MyASPNetApp") Then\n        EventLog.CreateEventSource("MyASPNetApp", "Application")\n    End If\n    eventLog.Source = "MyASPNetApp"\n    eventLog.WriteEntry("Message: " & ex.Message & vbCrLf & "StackTrace: " & ex.StackTrace, EventLogEntryType.Error)\nEnd Sub