Public Shared Function GetDataTable(ByVal CmdText As String, ByVal memberID As String, ByVal fromDate As DateTime, ByVal toDate As DateTime) As DataTable\n    Dim myConn As New SqlConnection(ConfigurationManager.ConnectionStrings("Conn").ConnectionString)\n    Dim myCmd As New SqlCommand(CmdText, myConn)\n    \n    ' Add parameters to prevent SQL injection and handle datetime conversion\n    myCmd.Parameters.AddWithValue("@MemberID", memberID)\n    myCmd.Parameters.AddWithValue("@FromDate", fromDate)\n    myCmd.Parameters.AddWithValue("@ToDate", toDate)\n    \n    myConn.Open()\n    Dim myReader As SqlDataReader = myCmd.ExecuteReader()\n    Dim myTable As New DataTable()\n    myTable.Load(myReader)\n    myConn.Close()\n    Return myTable\nEnd Functio