Dim sqlcmd As String\nDim collCmd As New Collection()\n\nFor x As Integer = 1 To intCount\n    sqlcmd = "UPDATE tableB b " &\n             "SET b.col1 = ( " &\n             "  SELECT CASE " &\n             "    WHEN a.col1 = 0 AND a.col2 = 0 THEN :value1 " &\n             "    ELSE :value2 " &\n             "  END " &\n             "  FROM tableA a " &\n             "  WHERE a.some_column = b.some_column " &\n             ") " &\n             "WHERE EXISTS ( " &\n             "  SELECT 1 " &\n             "  FROM tableA a " &\n             "  WHERE a.some_column = b.some_column " &\n             ");"\n\n    collCmd.Add(sqlcmd)\nNext\n\n' Execute the collection of SQL commands in a transaction\nUsing connection As New OracleConnection(connectionString)\n    connection.Open()\n    Using transaction As OracleTransaction = connection.BeginTransaction()\n        Try\n            For Each cmdText As String In collCmd\n                Using command As New OracleCommand(cmdText, connection)\n                    command.Parameters.Add(New OracleParameter(":value1", thisValue))\n                    command.Parameters.Add(New OracleParameter(":value2", otherValue))\n                    command.ExecuteNonQuery()\n                End Using\n            Next\n            transaction.Commit()\n        Catch ex As Exception\n            transaction.Rollback()\n            Throw\n        End Try\n    End Using\nEnd Using