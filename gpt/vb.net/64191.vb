Public Function CleanText(ByVal str As String) As String\n    ' Removes HTML tags and other characters that title tags and descriptions don't like\n    If Not String.IsNullOrEmpty(str) Then\n        ' Mini db of extended tags to get rid of\n        Dim indexChars() As String = {"<a", "<img", "<input type=""hidden"" name=""tax""", "<input type=""hidden"" name=""handling""", "<span", "<p", "<ul", "<div", "<embed", "<object", "<param"}\n\n        For i As Integer = 0 To indexChars.GetUpperBound(0) ' Loop through indexchars array\n            Dim indexOfInput As Integer = 0\n            Do ' Get rid of links\n                indexOfInput = str.IndexOf(indexChars(i)) ' Find instance of indexChar\n                If indexOfInput <> -1 Then\n                    Dim indexNextLeftBracket As Integer = str.IndexOf("<", indexOfInput + 1) + 1\n                    Dim indexRightBracket As Integer = str.IndexOf(">", indexOfInput) + 1\n                    ' Check to make sure a right bracket hasn't been left off a tag\n                    If indexNextLeftBracket > indexRightBracket Then ' Normal case\n                        str = str.Remove(indexOfInput, indexRightBracket - indexOfInput)\n                    Else\n                        ' Add the right bracket right before the next left bracket, just remove everything\n                        ' in the bad tag\n                        str = str.Insert(indexNextLeftBracket - 1, ">")\n                        indexRightBracket = str.IndexOf(">", indexOfInput) + 1\n                        str = str.Remove(indexOfInput, indexRightBracket - indexOfInput)\n                    End If\n                End If\n            Loop Until indexOfInput = -1\n        Next\n    End If\n    Return str\nEnd Functio