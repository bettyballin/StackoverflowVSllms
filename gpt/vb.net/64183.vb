Private mIsSorting As Boolean = False\nPrivate mFirstTime As Boolean = True\n\nPrivate Sub IncidentGrid_Loaded(sender As Object, e As RoutedEventArgs) Handles IncidentGrid.Loaded\n    AddHandler IncidentGrid.Sorting, AddressOf IncidentGrid_Sorting\nEnd Sub\n\nPrivate Sub IncidentGrid_Sorting(sender As Object, e As DataGridSortingEventArgs)\n    mIsSorting = True\nEnd Sub\n\nPrivate Sub IncidentGrid_SelectionChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles IncidentGrid.SelectionChanged\n    If mIsSorting Then\n        mIsSorting = False\n        Return\n    End If\n\n    If mFirstTime Then\n        mFirstTime = False\n    Else\n        Dim data As SimpleASMX.EMailMonitor = CType(IncidentGrid.SelectedItem, SimpleASMX.EMailMonitor)\n        Dim selectedGridItem As SimpleASMX.EMailMonitor = Nothing\n\n        If IncidentGrid.SelectedItem IsNot Nothing Then\n            selectedGridItem = CType(IncidentGrid.SelectedItem, SimpleASMX.EMailMonitor)\n            EmailPopupTextBox.Text = selectedGridItem.Address\n            SelectedItemTextBlock.Text = selectedGridItem.AppliesToUserID\n            WhereClauseTextBox.Text = selectedGridItem.whereClause\n            IncidentGrid.SelectedIndex = mEmailMonitorData.IndexOf(selectedGridItem)\n        End If\n\n        If IncidentGrid.SelectedIndex > -1 Then\n            EditPersonPopupGrid.Visibility = Windows.Visibility.Visible\n        Else\n            EditPersonPopupGrid.Visibility = Windows.Visibility.Collapsed\n        End If\n    End If\nEnd Sub\n\nPrivate Sub IncidentGrid_MouseLeftButtonUp(sender As Object, e As MouseButtonEventArgs) Handles IncidentGrid.MouseLeftButtonUp\n    Dim hit = IncidentGrid.InputHitTest(e.GetPosition(IncidentGrid))\n    If TypeOf hit Is DataGridCell OrElse TypeOf hit Is DataGridRowHeader Then\n        RaiseEvent IncidentGrid.SelectionChanged(IncidentGrid, New EventArgs())\n    End If\nEnd Sub