Imports EnvDTE\nImports EnvDTE80\nImports System.Runtime.InteropServices\n\nPublic Class SolutionDirectoryHelper\n    Public Shared Function GetSolutionDirectory() As String\n        ' Get the currently running Visual Studio IDE instance\n        Dim dte As DTE2 = CType(Marshal.GetActiveObject("VisualStudio.DTE.16.0"), DTE2) ' Version number might need to be adjusted\n\n        If dte IsNot Nothing AndAlso dte.Solution IsNot Nothing AndAlso dte.Solution.FullName IsNot Nothing Then\n            ' Get the full path of the solution file\n            Dim solutionFullName As String = dte.Solution.FullName\n            \n            ' Extract the directory from the solution path\n            Return System.IO.Path.GetDirectoryName(solutionFullName)\n        End If\n\n        Return Nothing\n    End Function\nEnd Class