Imports System.Text.RegularExpressions\n\nSub ModifyLinks(ByRef editorContent As String, myInternalDomain As String)\n    Dim regExString As String = "<a\b[^<>]*href\s*=\s*[\""\'](?<domain>https?:\/\/[^\/\s\'\""]*)*\/?(?<path>\/?[^\s\""]+?)?[\""\']"\n    Dim matchEvaluator As MatchEvaluator = Function(m As Match) As String\n                                               Dim domain As String = m.Groups("domain").Value\n                                               Dim path As String = m.Groups("path").Value\n                                               Dim replacement As String = m.Value\n\n                                               If domain <> myInternalDomain And domain <> "" Then\n                                                   ' This is an external domain; add JavaScript code to onclick attribute\n                                                   If Not replacement.Contains("onclick=") Then\n                                                       replacement = replacement.Replace("<a", "<a onclick=""externalLinkClicked();""")\n                                                   End If\n                                               End If\n\n                                               If path.EndsWith(".pdf") Then\n                                                   ' It is a PDF; specify that it opens in a new window\n                                                   If Not replacement.Contains("target=") Then\n                                                       replacement = replacement.Replace("<a", "<a target=""_blank""")\n                                                   Else\n                                                       ' Ensure _blank target\n                                                       replacement = Regex.Replace(replacement, "target\s*=\s*[""'].*?[""']", "target=""_blank""")\n                                                   End If\n                                               End If\n\n                                               Return replacement\n                                           End Function\n\n    editorContent = Regex.Replace(editorContent, regExString, matchEvaluator)\nEnd Sub