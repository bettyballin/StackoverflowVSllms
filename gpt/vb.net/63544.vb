Imports Microsoft.Practices.EnterpriseLibrary.Data\nImports System.Data.OracleClient\n\nPublic Function GetNextJobNumber() As Object\n    Dim db As Database = DatabaseFactory.CreateDatabase()\n    Dim myresult As Object = Nothing\n\n    Using cmd As DbCommand = db.GetStoredProcCommand("begin ? := CORPHIER_PKG.get_job_no; end;")\n        Dim retval As New OracleParameter("retval", OracleType.Number) With {\n            .Direction = ParameterDirection.ReturnValue\n        }\n        cmd.Parameters.Add(retval)\n\n        db.ExecuteNonQuery(cmd)\n        myresult = Convert.ToDecimal(retval.Value)\n    End Using\n\n    Return myresult\nEnd Functio