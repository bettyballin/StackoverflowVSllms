Public Shared Function GetUniversalName(ByVal sFilePath As String) As String\n    If String.IsNullOrEmpty(sFilePath) OrElse sFilePath.IndexOf(":") = -1 Then\n        Return sFilePath\n    End If\n\n    If sFilePath.StartsWith("\") Then\n        Return (New Uri(sFilePath)).ToString()\n    End If\n\n    Dim searcher As New ManagementObjectSearcher("SELECT RemoteName FROM win32_NetworkConnection WHERE LocalName = '" & sFilePath.Substring(0, 2) & "'")\n    For Each managementObject As ManagementObject In searcher.[Get]()\n        Dim sRemoteName As String = TryCast(managementObject("RemoteName"), String)\n        If sRemoteName IsNot Nothing Then\n            sRemoteName += sFilePath.Substring(2)\n            Return (New Uri(sRemoteName)).ToString()\n        End If\n    Next\n\n    Return sFilePath\nEnd Functio