Imports System.Runtime.InteropServices\nImports System.Text\n\nPublic Class ClipboardHelper\n\n    <StructLayout(LayoutKind.Sequential)>\n    Private Structure FILEGROUPDESCRIPTOR\n        Public cItems As UInt32\n        <MarshalAs(UnmanagedType.ByValArray, SizeConst:=260)>\n        Public szFileName As Char()\n    End Structure\n\n    Public Shared Function GetFileNameFromClipboard() As String\n        Dim fileName As String = String.Empty\n\n        If Clipboard.ContainsData("FileGroupDescriptorW") Then\n            Dim ms As IO.MemoryStream = CType(Clipboard.GetData("FileGroupDescriptorW"), IO.MemoryStream)\n            Dim bytes(ms.Length - 1) As Byte\n            ms.Read(bytes, 0, bytes.Length)\n            ms.Close()\n\n            Dim handle As GCHandle = GCHandle.Alloc(bytes, GCHandleType.Pinned)\n            Try\n                Dim descriptor As FILEGROUPDESCRIPTOR = CType(Marshal.PtrToStructure(handle.AddrOfPinnedObject(), GetType(FILEGROUPDESCRIPTOR)), FILEGROUPDESCRIPTOR)\n                fileName = New String(descriptor.szFileName).TrimEnd(ChrW(0))\n            Finally\n                handle.Free()\n            End Try\n        End If\n\n        Return fileName\n    End Function\n\nEnd Class