Public Shared Function HashString(ByVal StringToHash As String) As String\n    ' Use UTF8 encoding instead of UTF32\n    Dim myEncoder As New System.Text.UTF8Encoding\n    Dim Key() As Byte = myEncoder.GetBytes(My.Settings.PortalHASH)\n    Dim XML() As Byte = myEncoder.GetBytes(StringToHash)\n    Dim myHMACSHA256 As New System.Security.Cryptography.HMACSHA256(Key)\n    Dim HashCode As Byte() = myHMACSHA256.ComputeHash(XML)\n    Return Convert.ToBase64String(HashCode)\nEnd Functio