Imports System\nImports System.ServiceProcess\n\nModule ServiceMain\n    Sub Main()\n        ' Register the unhandled exception handler\n        AddHandler AppDomain.CurrentDomain.UnhandledException, AddressOf UnhandledExceptionHandler\n\n        ' Start the Windows Service\n        ServiceBase.Run(New MyWindowsService())\n    End Sub\n\n    ' Unhandled exception handler\n    Private Sub UnhandledExceptionHandler(ByVal sender As Object, ByVal e As UnhandledExceptionEventArgs)\n        Dim ex As Exception = CType(e.ExceptionObject, Exception)\n        ' Call into your custom exception handling component\n        MyExceptionHandlingComponent.ManuallyHandleException(ex)\n        \n        ' Optionally, exit the application with a non-zero exit code\n        Environment.Exit(-1)\n    End Sub\nEnd Module\n\nPublic Class MyWindowsService\n    Inherits ServiceBase\n\n    Protected Overrides Sub OnStart(ByVal args() As String)\n        ' Add code here to start your service. This method should set things\n        ' in motion so your service can do its work.\n        MyServiceComponent.Start()\n    End Sub\n\n    Protected Overrides Sub OnStop()\n        ' Add code here to perform any tear-down necessary to stop your service.\n        MyServiceComponent.Stop()\n    End Sub\nEnd Class