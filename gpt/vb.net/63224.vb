Function DecryptFileToStream(ByVal sInputFilename As String, ByVal sKey As String) As MemoryStream\n    Dim DES As New DESCryptoServiceProvider()\n    ' A 64-bit key and an IV are required for this provider.\n    ' Set the secret key for the DES algorithm.\n    DES.Key = System.Text.Encoding.ASCII.GetBytes(sKey)\n    ' Set the initialization vector.\n    DES.IV = System.Text.Encoding.ASCII.GetBytes(sKey)\n\n    ' Create the file stream to read the encrypted file.\n    Using fsread As New FileStream(sInputFilename, FileMode.Open, FileAccess.Read)\n        ' Create the DES decryptor from the DES instance.\n        Dim desdecrypt As ICryptoTransform = DES.CreateDecryptor()\n        ' Create the crypto stream set to read and to do a DES decryption transform on incoming bytes.\n        Using cryptostreamDecr As New CryptoStream(fsread, desdecrypt, CryptoStreamMode.Read)\n            ' Read the decrypted data into a MemoryStream.\n            Dim msDecrypted As New MemoryStream()\n            cryptostreamDecr.CopyTo(msDecrypted)\n            msDecrypted.Position = 0 ' Reset the position to the beginning of the stream.\n            Return msDecrypted\n        End Using\n    End Using\nEnd Functio