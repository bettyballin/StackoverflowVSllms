Dim RetVal as RetType\n\nTry\n    ' Your code logic here\n    If ... Then\n        RetVal = RetType.FailedParse\n        ' end try is not used here\n    End If\n    ' More code logic if needed\nCatch ex As Exception\n    ' Handle any exceptions if necessary\n    RetVal = RetType.SomeError\nFinally\n    ' Set the UserStr based on RetVal\n    Select Case RetVal\n        Case RetType.FailedParse\n            UserStr = "Failed to parse"\n        Case RetType.SomeError\n            UserStr = "An error occurred"\n        ' Add more cases as needed\n    End Select\nEnd Try\n\nReturn RetVal