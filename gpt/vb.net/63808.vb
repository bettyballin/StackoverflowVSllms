Protected Sub GridView1_RowDataBound(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewRowEventArgs) Handles GridView1.RowDataBound\n    If e.Row.RowType = DataControlRowType.DataRow Then\n        Dim deptvalue As String = e.Row.Cells(0).Text\n        Dim ddlmgr As New DropDownList\n\n        ddlmgr.ID = "ddlmgr" & e.Row.RowIndex ' Ensure unique ID\n        AddHandler ddlmgr.SelectedIndexChanged, AddressOf ddlmgr_SelectedIndexChanged\n\n        ddlmgr.AutoPostBack = True\n        ddlmgr.Items.Clear()\n        ddlmgr.Items.Insert(0, "--Select a Manager--")\n        ddlmgr.AppendDataBoundItems = True\n        ddlmgr.DataTextField = "Name"\n        ddlmgr.DataValueField = "number"\n        ddlmgr.DataSource = SqlDataSource2\n        ddlmgr.DataBind()\n\n        ddlmgr.Attributes.Add("onchange", "setDepart('" & deptvalue & "')")\n\n        e.Row.Cells(2).Controls.Add(ddlmgr)\n    End If\nEnd Sub\n\nProtected Sub ddlmgr_SelectedIndexChanged(ByVal sender As Object, ByVal e As EventArgs)\n    Dim ddl As DropDownList = CType(sender, DropDownList)\n    ' Handle the selected index change event here\n    ' For example, you can get the selected value using ddl.SelectedValue\nEnd Sub