Private Property _includeTime As Boolean\n    Get\n        Dim o As Object = ViewState("IncludeTime")\n        If o Is Nothing Then\n            Return False\n        Else\n            Return CType(o, Boolean)\n        End If\n    End Get\n    Set(ByVal value As Boolean)\n        ViewState("IncludeTime") = value\n    End Set\nEnd Property\n\nPrivate Property _value As DateTime\n    Get\n        Dim o As Object = ViewState("SelectedDateTime")\n        If o Is Nothing Then\n            Return DateTime.MinValue\n        Else\n            Return CType(o, DateTime)\n        End If\n    End Get\n    Set(ByVal value As DateTime)\n        ViewState("SelectedDateTime") = value\n    End Set\nEnd Property\n\nPublic Property IncludeTime() As Boolean\n    Get\n        Return _includeTime\n    End Get\n    Set(ByVal value As Boolean)\n        _includeTime = value\n    End Set\nEnd Property\n\nPublic Property SelectedDateTime() As DateTime\n    Get\n        Try\n            _value = DateTime.Parse(txtDate.Text)\n            If IncludeTime Then\n                _value = _value.AddHours(Short.Parse(txtHour.Text))\n                _value = _value.AddMinutes(Short.Parse(txtMinute.Text))\n                _value = _value.AddSeconds(Short.Parse(txtSecond.Text))\n            End If\n        Catch ex As Exception\n            _value = DateTime.MinValue\n        End Try\n        Return _value\n    End Get\n    Set(ByVal value As DateTime)\n        _value = value\n    End Set\nEnd Property