Imports Microsoft.Extensions.DependencyInjection\n\nModule Program\n    Public ServiceProvider As IServiceProvider\n\n    Sub Main()\n        Dim services As New ServiceCollection()\n        ConfigureServices(services)\n\n        ServiceProvider = services.BuildServiceProvider()\n\n        ' Example usage\n        Dim userService = ServiceProvider.GetService(Of ICurrentUserService)()\n        userService.CurrentUser = New CurrentUser With {.UserName = "JohnDoe", .UserId = 1}\n    End Sub\n\n    Private Sub ConfigureServices(services As IServiceCollection)\n        services.AddSingleton(Of ICurrentUserService, CurrentUserService)()\n    End Sub\nEnd Module