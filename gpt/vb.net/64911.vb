Public Class Class1\n        Implements IDisposable\n\n        Private disposedValue As Boolean = False ' To detect redundant calls\n\n        ' IDisposable\n        Protected Overridable Sub Dispose(disposing As Boolean)\n            If Not Me.disposedValue Then\n                If disposing Then\n                    ' TODO: free managed resources when explicitly called\n                End If\n                ' TODO: free unmanaged resources\n            End If\n            Me.disposedValue = True\n        End Sub\n\n        ' This code added to correctly implement the disposable pattern.\n        Public Sub Dispose() Implements IDisposable.Dispose\n            Dispose(True)\n            GC.SuppressFinalize(Me)\n        End Sub\n\n        Protected Overrides Sub Finalize()\n            Dispose(False)\n            MyBase.Finalize()\n        End Sub\n    End Class