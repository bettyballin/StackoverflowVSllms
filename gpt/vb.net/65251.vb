Imports System.Threading\n\nPublic Class MyService\n    Private indexingThread As Thread\n\n    Public Sub New()\n        ' Initialize your service\n        InitializeComponent()\n    End Sub\n\n    Protected Overrides Sub OnStart(ByVal args() As String)\n        ' Start the indexing thread\n        indexingThread = New Thread(AddressOf IndexFolders)\n        indexingThread.Priority = ThreadPriority.Lowest\n        indexingThread.Start()\n    End Sub\n\n    Protected Overrides Sub OnStop()\n        ' Stop the indexing thread\n        If indexingThread IsNot Nothing AndAlso indexingThread.IsAlive Then\n            indexingThread.Abort()\n        End If\n    End Sub\n\n    Private Sub IndexFolders()\n        While True\n            ' Perform the indexing work here\n\n            ' Sleep for a bit to yield CPU time to other processes\n            Thread.Sleep(100)\n        End While\n    End Sub\nEnd Class