Imports Microsoft.VisualStudio.TestTools.UnitTesting\n\n<TestClass>\nPublic Class DiaryModeTests\n\n    Public Enum DiaryMode\n        Admin\n        Academy\n        Scouting\n    End Enum\n\n    Public Function GetModeObject(ByVal mode As DiaryMode) As Object\n        Dim modeObject As Object\n\n        If mode = DiaryMode.Admin Then\n            modeObject = DBNull.Value\n        ElseIf mode = DiaryMode.Academy Then\n            modeObject = ApplicationSettings.Academy\n        ElseIf mode = DiaryMode.Scouting Then\n            modeObject = ApplicationSettings.Scouting\n        Else\n            Throw New NotSupportedException()\n        End If\n\n        Return modeObject\n    End Function\n\n    <TestMethod>\n    <ExpectedException(GetType(NotSupportedException))>\n    Public Sub GetModeObject_InvalidEnumValue_ThrowsNotSupportedException()\n        ' Arrange\n        Dim invalidMode As DiaryMode = CType(999, DiaryMode) ' Assuming 999 is an invalid value\n\n        ' Act\n        Dim result = GetModeObject(invalidMode)\n\n        ' Assert\n        ' Exception is expected, so no need for additional assertions\n    End Sub\n\nEnd Class