Public Shared Function GetItems(ByVal itemsList As List(Of OrderItem), ByVal whichForm As ItemsFor, ByVal formID As Integer) As List(Of OrderItem)\n    Dim propertyName As String = String.Empty\n\n    Select Case whichForm\n        Case ItemsFor.MfrCredit\n            propertyName = "ManufacturerCreditID"\n        Case ItemsFor.CustomerCredit\n            propertyName = "CustomerCreditID"\n        Case ItemsFor.Invoice\n            propertyName = "InvoiceID"\n        Case ItemsFor.PurchaseOrder\n            propertyName = "PurchaseOrderID"\n        Case ItemsFor.Quote\n            propertyName = "QuoteID"\n        Case ItemsFor.StockingOrder\n            propertyName = "StockingOrderID"\n    End Select\n\n    Dim query = From oi As OrderItem In itemsList\n                Where CInt(oi.GetType().GetProperty(propertyName).GetValue(oi)) = formID\n                Select oi\n\n    Return query.ToList()\nEnd Functio