Imports System.DirectoryServices.AccountManagement\n\nPublic Function IsUserInGroup(userName As String, groupName As String, domain As String) As Boolean\n    Using context As New PrincipalContext(ContextType.Domain, domain)\n        ' Find the user\n        Dim user As UserPrincipal = UserPrincipal.FindByIdentity(context, userName)\n        If user Is Nothing Then\n            Throw New Exception($"User {userName} not found.")\n        End If\n\n        ' Find the group\n        Dim group As GroupPrincipal = GroupPrincipal.FindByIdentity(context, groupName)\n        If group Is Nothing Then\n            Throw New Exception($"Group {groupName} not found.")\n        End If\n\n        ' Check if the user is a member of the group\n        Return group.Members.Contains(user)\n    End Using\nEnd Functio