Public Sub Compress(ByVal infile As String, ByVal outfile As String)\n    Using sourceFile As FileStream = File.OpenRead(infile)\n        Using destFile As FileStream = File.Create(outfile)\n            Using compStream As New GZipStream(destFile, CompressionMode.Compress)\n                Dim buffer(4096) As Byte\n                Dim bytesRead As Integer\n                Do\n                    bytesRead = sourceFile.Read(buffer, 0, buffer.Length)\n                    If bytesRead > 0 Then\n                        compStream.Write(buffer, 0, bytesRead)\n                    End If\n                Loop While bytesRead > 0\n            End Using\n        End Using\n    End Using\nEnd Sub