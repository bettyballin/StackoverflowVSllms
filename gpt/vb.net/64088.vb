Imports System.Diagnostics\nImports System.IO\n\nPublic Class FileTraceListener\n    Inherits TraceListener\n\n    Private filePath As String\n\n    Public Sub New(filePath As String)\n        MyBase.New()\n        Me.filePath = filePath\n    End Sub\n\n    Public Overrides Sub Write(message As String)\n        SyncLock Me\n            File.AppendAllText(filePath, message)\n        End SyncLock\n    End Sub\n\n    Public Overrides Sub WriteLine(message As String)\n        SyncLock Me\n            File.AppendAllText(filePath, message & Environment.NewLine)\n        End SyncLock\n    End Sub\nEnd Class\n\nModule Module1\n    Sub Main()\n        ' Specify the log file path\n        Dim logFilePath As String = "C:\path\to\your\logfile.txt"\n\n        ' Create an instance of your custom TraceListener\n        Dim fileListener As New FileTraceListener(logFilePath)\n\n        ' Add the custom listener to the Trace listeners\n        Trace.Listeners.Add(fileListener)\n\n        ' Now any Trace.WriteLine call will also log to the file\n        Trace.WriteLine("This is a test message.")\n    End Sub\nEnd Module