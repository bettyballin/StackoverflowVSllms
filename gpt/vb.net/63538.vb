Public Sub RehydrateTo(Of T As New)(ByVal input As String, ByRef output As T)\n    Dim ms As MemoryStream = MsFromString(input)\n    Dim f As New DataContractSerializer(GetType(T))\n\n    Try\n        output = CType(f.ReadObject(ms), T)\n    Catch ex As SerializationException\n        ' Explicitly get the type of T using reflection\n        Dim targetType As Type = GetType(T)\n        \n        ' Create a new instance of T using reflection\n        output = DirectCast(Activator.CreateInstance(targetType), T)\n        \n        ' Try to cast the newly created object to ILegacyDeserializer\n        Dim ild As ILegacyDeserializer = TryCast(output, ILegacyDeserializer)\n        If ild IsNot Nothing Then\n            ' Call the legacy deserialization logic\n            ild.LegacyDeserialize(input)\n        End If\n    End Try\nEnd Sub