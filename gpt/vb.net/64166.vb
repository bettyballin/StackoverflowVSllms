Imports System.Data.OleDb\n\nDim pagedData As New PagedDataSource\n\nSub Page_Load(ByVal obj As Object, ByVal e As EventArgs)\n    If Not IsPostBack Then\n        doPaging()\n    End If\nEnd Sub\n\nFunction getTheData() As DataTable\n    Dim DS As New DataSet()\n    ' Use Server.MapPath to get the correct path to the database\n    Dim connectionString As String = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & Server.MapPath("~/App_Data/ArtDatabase.mdb")\n    Dim strConnect As New OleDbConnection(connectionString)\n    \n    Try\n        Dim objOleDBAdapter As New OleDbDataAdapter("SELECT ArtID, FileLocation, Title, UserName, ArtDate FROM Art ORDER BY Art.ArtDate DESC", strConnect)\n        objOleDBAdapter.Fill(DS, "Art")\n    Catch ex As Exception\n        ' Log error or handle it appropriately\n        Throw New Exception("Error retrieving data from database: " & ex.Message)\n    End Try\n\n    Return DS.Tables("Art").Copy\nEnd Function\n\nSub doPaging()\n    pagedData.DataSource = getTheData().DefaultView\n    pagedData.AllowPaging = True\n    pagedData.PageSize = 2\n\n    Try\n        If Not String.IsNullOrEmpty(Request.QueryString("Page")) Then\n            pagedData.CurrentPageIndex = Int32.Parse(Request.QueryString("Page"))\n        Else\n            pagedData.CurrentPageIndex = 0\n        End If\n    Catch ex As Exception\n        pagedData.CurrentPageIndex = 0\n    End Try\n\n    btnPrev.Visible = Not pagedData.IsFirstPage\n    btnNext.Visible = Not pagedData.IsLastPage\n\n    pageNumber.Text = (pagedData.CurrentPageIndex + 1) & " of " & pagedData.PageCount\n\n    ArtRepeater.DataSource = pagedData\n    ArtRepeater.DataBind()\nEnd Sub