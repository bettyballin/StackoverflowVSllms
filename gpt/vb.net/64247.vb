Imports CrystalDecisions.CrystalReports.Engine\nImports CrystalDecisions.Shared\n\nPublic Sub SetReportDataSource(mainReport As ReportDocument, dataset As DataSet)\n    ' Set the datasource for the main report\n    mainReport.SetDataSource(dataset.Tables("Header"))\n\n    ' Find the subreport object\n    Dim subReportObject As SubreportObject = CType(mainReport.ReportDefinition.ReportObjects("SubreportName"), SubreportObject)\n    Dim subReportDocument As ReportDocument = subReportObject.OpenSubreport(subReportObject.SubreportName)\n\n    ' Set the datasource for the subreport\n    subReportDocument.SetDataSource(dataset.Tables("Detail"))\n\n    ' Refresh the report\n    mainReport.Refresh()\nEnd Sub