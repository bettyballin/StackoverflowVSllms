Dim connection As SqlConnection = CreateConnection()\n    Dim command As SqlCommand = New SqlCommand(procName, connection)\n    command.CommandType = CommandType.StoredProcedure\n    command.CommandTimeout = _commandTimeOut\n\n    Try\n        connection.Open()\n        Dim adapter As New SqlDataAdapter(command)\n        For Each param As SqlParameter In parameters\n            command.Parameters.Add(param)\n        Next\n        adapter.Fill(tableToFill)\n        adapter.Dispose()\n    Finally\n        command.Dispose()\n        connection.Close()\n    End Try