Dim loHttp As HttpWebRequest = CType(WebRequest.Create(_url), HttpWebRequest)\nloHttp.Timeout = 10000\nloHttp.Method = "GET"\nloHttp.KeepAlive = True\nloHttp.AllowAutoRedirect = False ' Handle redirections manually\nloHttp.PreAuthenticate = True\nDim _cred1 As NetworkCredential = New NetworkCredential("username", "password")\nloHttp.Credentials = _cred1\n\nTry\n    Dim redirectCount As Integer = 0\n    Dim maxRedirects As Integer = 5\n    Dim responseUri As String = _url\n\n    While redirectCount < maxRedirects\n        loHttp = CType(WebRequest.Create(responseUri), HttpWebRequest)\n        loHttp.Timeout = 10000\n        loHttp.Method = "GET"\n        loHttp.KeepAlive = True\n        loHttp.AllowAutoRedirect = False ' Handle redirections manually\n        loHttp.PreAuthenticate = True\n        loHttp.Credentials = _cred1\n\n        Using loWebResponse As HttpWebResponse = CType(loHttp.GetResponse(), HttpWebResponse)\n            If loWebResponse.StatusCode >= HttpStatusCode.Moved AndAlso loWebResponse.StatusCode <= HttpStatusCode.PermanentRedirect Then\n                responseUri = loWebResponse.Headers("Location")\n                redirectCount += 1\n            Else\n                ' Handle the response here\n                Exit While\n            End If\n        End Using\n    End While\n\n    If redirectCount >= maxRedirects Then\n        Throw New Exception("Too many redirects")\n    End If\n\nCatch ex As WebException\n    ' Handle the exception here\nEnd Try