Try\n    DoSomeWork()\nCatch ex As Exception\n    ' Log the detailed error message for internal use\n    LogError(ex)\n    ' Display a user-friendly error message\n    lblError.Text = "An error occurred while processing your request. Please try again later."\nEnd Try\n\nPublic Sub LogError(ByVal ex As Exception)\n    ' Assuming you have a logging mechanism in place (e.g., log to a file, database, etc.)\n    Dim errorMessage As New StringBuilder()\n    Do\n        errorMessage.AppendLine(ex.Message)\n        ex = ex.InnerException\n    Loop While ex IsNot Nothing\n    ' Log the error message\n    ' Example: File.AppendAllText("error_log.txt", errorMessage.ToString())\nEnd Sub