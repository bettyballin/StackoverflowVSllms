' Module: modConsole\nOption Explicit\n\nPrivate Declare Function AllocConsole Lib "kernel32" () As Long\nPrivate Declare Function FreeConsole Lib "kernel32" () As Long\nPrivate Declare Function GetStdHandle Lib "kernel32" (ByVal nStdHandle As Long) As Long\nPrivate Declare Function WriteConsole Lib "kernel32" Alias "WriteConsoleA" (ByVal hConsoleOutput As Long, ByVal lpBuffer As Any, ByVal nNumberOfCharsToWrite As Long, lpNumberOfCharsWritten As Long, lpReserved As Any) As Long\nPrivate Declare Function SetConsoleCtrlHandler Lib "kernel32" (ByVal HandlerRoutine As Long, ByVal Add As Long) As Long\n\nPrivate Const STD_OUTPUT_HANDLE = -11&\nPrivate hConsole As Long\n\nPublic Sub Main()\n    ' Allocate a console for this app\n    If AllocConsole() = 0 Then\n        MsgBox "Unable to allocate console."\n        Exit Sub\n    End If\n    \n    ' Get the handle to the console output\n    hConsole = GetStdHandle(STD_OUTPUT_HANDLE)\n    \n    ' Write a message to the console\n    WriteToConsole "Hello, this is a VB6 console application!"\n    \n    ' Set the Console Control Handler\n    If SetConsoleCtrlHandler(AddressOf ConsoleCtrlHandler, True) = 0 Then\n        MsgBox "Unable to set control handler."\n    End If\n    \n    ' Keep the console open\n    MsgBox "Press OK to close the console."\n    \n    ' Free the console once done\n    FreeConsole\nEnd Sub\n\nPrivate Sub WriteToConsole(ByVal sText As String)\n    Dim lWritten As Long\n    WriteConsole hConsole, ByVal sText, Len(sText), lWritten, ByVal 0&\nEnd Sub\n\nPrivate Function ConsoleCtrlHandler(ByVal CtrlType As Long) As Long\n    ' Handle the console control events here\n    Select Case CtrlType\n        Case 0 ' CTRL_C_EVENT\n            ' Do something when Ctrl+C is pressed\n        Case 1 ' CTRL_BREAK_EVENT\n            ' Do something when Ctrl+Break is pressed\n        Case 2 ' CTRL_CLOSE_EVENT\n            ' Do something when the console window is closed\n        Case 5 ' CTRL_LOGOFF_EVENT\n            ' Do something when the user logs off\n        Case 6 ' CTRL_SHUTDOWN_EVENT\n            ' Do something when the system is shutting down\n    End Select\n    ConsoleCtrlHandler = 1 ' Return 1 to indicate that you handled the event\nEnd Functio