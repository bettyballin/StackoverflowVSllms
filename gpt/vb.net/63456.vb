Dim maxProducts As Integer = 5\nDim productId As String = Request.QueryString("id")\n\n' Initialize the cookie if it does not exist\nDim productCookie As HttpCookie = HttpContext.Current.Request.Cookies("xxx")\nIf productCookie Is Nothing Then\n    productCookie = New HttpCookie("xxx")\n    productCookie.Expires = DateTime.Now.AddDays(365)\nElse\n    ' Retrieve existing product IDs\n    Dim productIds As New List(Of String)\n    For i As Integer = 0 To maxProducts - 1\n        Dim productValue As String = productCookie("product" & i)\n        If Not String.IsNullOrEmpty(productValue) Then\n            productIds.Add(productValue)\n        End If\n    Next\n\n    ' Add new product ID if it doesn't already exist\n    If Not productIds.Contains(productId) Then\n        If productIds.Count = maxProducts Then\n            productIds.RemoveAt(0) ' Remove the oldest product ID\n        End If\n        productIds.Add(productId)\n    Else\n        ' Move the existing product to the most recent position\n        productIds.Remove(productId)\n        productIds.Add(productId)\n    End If\n\n    ' Update the cookie with the new list of product IDs\n    For i As Integer = 0 To productIds.Count - 1\n        productCookie("product" & i) = productIds(i)\n    Next\n\n    ' Clear remaining slots if any\n    For i As Integer = productIds.Count To maxProducts - 1\n        productCookie("product" & i) = Nothing\n    Next\nEnd If\n\n' Save the cookie\nHttpContext.Current.Response.Cookies.Add(productCookie)