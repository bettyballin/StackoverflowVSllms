Public Sub DownloadBlob(ByVal Blob As Byte(), ByVal FileName As String, ByVal Response As HttpResponse)\n    Response.Clear()\n    Response.AddHeader("content-disposition", String.Format("attachment;filename={0}", FileName.Replace(" ", "_")))\n    Response.ContentType = String.Format("application/{0}", Path.GetExtension(FileName).Substring(1))\n    Response.BinaryWrite(Blob)\n    Response.End() ' This will stop further processing of the response\nEnd Sub