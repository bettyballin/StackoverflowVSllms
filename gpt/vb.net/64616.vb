Public Function CountAttachments(TableName As String, FieldName As String) As DAO.Recordset\n    Dim db As DAO.Database\n    Dim rs As DAO.Recordset\n    Dim rsAttachment As DAO.Recordset\n    Dim sql As String\n\n    sql = "SELECT [" & TableName & "].ID, Count([" & FieldName & "].FileData) AS AttachmentCount " & _\n          "FROM [" & TableName & "] " & _\n          "LEFT JOIN [" & TableName & "].[" & FieldName & "] AS [" & FieldName & "] " & _\n          "ON [" & TableName & "].ID = [" & FieldName & "].ParentID " & _\n          "GROUP BY [" & TableName & "].ID"\n\n    Set db = CurrentDb()\n    Set rs = db.OpenRecordset(sql)\n    \n    Set CountAttachments = rs\nEnd Functio