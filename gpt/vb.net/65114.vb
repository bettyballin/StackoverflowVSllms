Imports System.Text\nImports System.IO\n\nPublic Class EmailAttachmentExtractor\n    Public Shared Function ExtractAttachment(emailContent As String, boundary As String) As Byte()\n        Dim boundaryBytes = Encoding.UTF8.GetBytes("--" & boundary)\n        Dim base64Marker = Encoding.UTF8.GetBytes("Content-Transfer-Encoding: base64")\n        \n        Using stream = New MemoryStream(Encoding.UTF8.GetBytes(emailContent))\n            Using reader = New StreamReader(stream)\n                Dim line As String\n                Dim foundBase64 = False\n                Dim attachmentBytes As New List(Of Byte)()\n                \n                While Not reader.EndOfStream\n                    line = reader.ReadLine()\n\n                    If foundBase64 Then\n                        If line.StartsWith("--" & boundary) Then\n                            Exit While\n                        End If\n                        If Not String.IsNullOrWhiteSpace(line) Then\n                            attachmentBytes.AddRange(Convert.FromBase64String(line))\n                        End If\n                    ElseIf line.Contains("Content-Transfer-Encoding: base64") Then\n                        foundBase64 = True\n                        \n                        ' Skip the following lines until we reach the actual content\n                        While Not reader.EndOfStream\n                            line = reader.ReadLine()\n                            If String.IsNullOrWhiteSpace(line) Then\n                                Exit While\n                            End If\n                        End While\n                    End If\n                End While\n                \n                If attachmentBytes.Count > 0 Then\n                    Return attachmentBytes.ToArray()\n                End If\n            End Using\n        End Using\n\n        Return Nothing\n    End Function\nEnd Class