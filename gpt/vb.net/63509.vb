Sub Test()\n    Dim dt As New DataTable\n\n    ' Fill datatable code omitted. there are 150 rows in the datatable after this\n\n    ' Create a DataSet and add the DataTable to it\n    Dim ds As New DataSet\n    ds.Tables.Add(dt)\n\n    ' Convert DataSet to XML string\n    Dim xmlStr As String = ds.GetXml()\n\n    ' Create a SqlConnection and SqlCommand to call the stored procedure\n    Using conn As New SqlConnection("your_connection_string")\n        Using cmd As New SqlCommand("ProcessFile", conn)\n            cmd.CommandType = CommandType.StoredProcedure\n\n            ' Add the XML parameter to the command\n            cmd.Parameters.Add(New SqlParameter("@x", SqlDbType.Xml)).Value = xmlStr\n\n            ' Open the connection and execute the command\n            conn.Open()\n            cmd.ExecuteNonQuery()\n        End Using\n    End Using\nEnd Sub