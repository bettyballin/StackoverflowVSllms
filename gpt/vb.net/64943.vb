Dim groupedTable As New DataTable()\ngroupedTable.Columns.Add("UserName", GetType(String))\ngroupedTable.Columns.Add("roleNames", GetType(String))\n\nDim userRoleDict As New Dictionary(Of String, List(Of String))()\n\n' Group the roles by UserName\nFor Each row As DataRow In ds.Tables(0).Rows\n    Dim userName As String = row("UserName").ToString()\n    Dim roleName As String = row("roleName").ToString()\n\n    If Not userRoleDict.ContainsKey(userName) Then\n        userRoleDict(userName) = New List(Of String)()\n    End If\n\n    userRoleDict(userName).Add(roleName)\nNext\n\n' Build the new datatable with grouped roles\nFor Each userName As String In userRoleDict.Keys\n    Dim newRow As DataRow = groupedTable.NewRow()\n    newRow("UserName") = userName\n    newRow("roleNames") = String.Join(", ", userRoleDict(userName))\n    groupedTable.Rows.Add(newRow)\nNext\n\n' Assign the new grouped table to the dataset or use it as needed\nds.Tables.RemoveAt(0)\nds.Tables.Add(groupedTable)