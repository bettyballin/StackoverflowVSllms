Imports System.Runtime.InteropServices\n\nPublic Class NetworkFolderAccess\n    <DllImport("mpr.dll", CharSet:=CharSet.Auto)>\n    Private Shared Function WNetAddConnection2(ByRef netResource As NETRESOURCE, password As String, username As String, flags As Integer) As Integer\n    End Function\n\n    <DllImport("mpr.dll", CharSet:=CharSet.Auto)>\n    Private Shared Function WNetCancelConnection2(lpName As String, dwFlags As Integer, fForce As Boolean) As Integer\n    End Function\n\n    <StructLayout(LayoutKind.Sequential)>\n    Private Structure NETRESOURCE\n        Public dwScope As Integer\n        Public dwType As Integer\n        Public dwDisplayType As Integer\n        Public dwUsage As Integer\n        <MarshalAs(UnmanagedType.LPTStr)>\n        Public lpLocalName As String\n        <MarshalAs(UnmanagedType.LPTStr)>\n        Public lpRemoteName As String\n        <MarshalAs(UnmanagedType.LPTStr)>\n        Public lpComment As String\n        <MarshalAs(UnmanagedType.LPTStr)>\n        Public lpProvider As String\n    End Structure\n\n    Private Const RESOURCETYPE_DISK As Integer = &H1\n\n    Public Shared Function ConnectToNetworkFolder(remotePath As String) As Boolean\n        Dim nr As New NETRESOURCE() With {\n            .dwType = RESOURCETYPE_DISK,\n            .lpLocalName = Nothing,\n            .lpRemoteName = remotePath,\n            .lpProvider = Nothing\n        }\n\n        ' Flags: CONNECT_INTERACTIVE = 8, CONNECT_PROMPT = 16\n        Dim result As Integer = WNetAddConnection2(nr, Nothing, Nothing, 8 + 16)\n\n        Return result = 0\n    End Function\n\n    Public Shared Function DisconnectNetworkFolder(remotePath As String) As Boolean\n        Dim result As Integer = WNetCancelConnection2(remotePath, 0, True)\n        Return result = 0\n    End Function\nEnd Class