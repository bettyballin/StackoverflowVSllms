Imports System.Threading\n\nPublic Class YourComLibrary\n    Private ReadOnly mainThreadId As Integer = Thread.CurrentThread.ManagedThreadId\n\n    Private Sub EnsureSingleThread()\n        If Thread.CurrentThread.ManagedThreadId <> mainThreadId Then\n            Throw New InvalidOperationException("This library must be accessed from the main thread only.")\n        End If\n    End Sub\n\n    Public Sub YourMethod()\n        EnsureSingleThread()\n        ' Your method implementation\n    End Sub\nEnd Class