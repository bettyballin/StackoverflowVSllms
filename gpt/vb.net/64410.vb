Private Async Function PerformUploadAsync() As Task\n    ' Show the loading overlay\n    ShowLoadingOverlay()\n    \n    ' Perform the upload on a background thread\n    Await Task.Run(Sub()\n                       ' Your existing code to print the document and upload it to the server\n                       PrintDocumentToPDF()\n                       UploadPDFToSQLServer()\n                   End Sub)\n    \n    ' Hide the loading overlay\n    HideLoadingOverlay()\nEnd Functio