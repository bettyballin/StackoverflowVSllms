Private Function GetCycleLength(ByVal D As Integer) As Integer\n    Dim remainders As New Dictionary(Of Integer, Integer)()\n    Dim remainder As Integer = 1\n    Dim position As Integer = 0\n\n    While remainder <> 0 AndAlso Not remainders.ContainsKey(remainder)\n        remainders(remainder) = position\n        remainder = (remainder * 10) Mod D\n        position += 1\n    End While\n\n    If remainder = 0 Then\n        Return 0\n    Else\n        Return position - remainders(remainder)\n    End If\nEnd Function\n\nPrivate Function LongestRepeatingCycle(ByVal limit As Integer) As Integer\n    Dim maxLength As Integer = 0\n    Dim resultD As Integer = 0\n\n    For D As Integer = 1 To limit - 1\n        Dim cycleLength As Integer = GetCycleLength(D)\n        If cycleLength > maxLength Then\n            maxLength = cycleLength\n            resultD = D\n        End If\n    Next\n\n    Return resultD\nEnd Function\n\nConsole.WriteLine(LongestRepeatingCycle(1000))