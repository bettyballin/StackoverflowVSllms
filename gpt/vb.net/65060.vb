Public Structure Result\n    Public Success as Boolean\n    Public Message as String\nEnd Structure\n\nPrivate _Repository as IEntityRepository\n\nPublic Function SaveOrganization(ByVal organization As rv_o_Organization) As Result\n    Dim result As New Result()\n    \n    Try\n        _Repository.Connection.Open()\n        _Repository.Transaction = _Repository.Connection.BeginTransaction()\n\n        ' Performs validation then saves it to the database\n        ' using the current transaction\n        result = SaveMasterOrganization(organization.MasterOrganization)\n        If Not result.Success Then\n            Throw New Exception(result.Message)\n        End If\n\n        ' Performs validation then saves it to the database\n        ' using the current transaction\n        result = SaveOrganization(dbOrg, organization)\n        If Not result.Success Then\n            Throw New Exception(result.Message)\n        End If\n\n        _Repository.Transaction.Commit()\n    Catch ex As Exception\n        _Repository.Transaction.Rollback()\n        result.Success = False\n        result.Message = ex.Message\n    Finally\n        _Repository.Connection.Close()\n    End Try\n\n    Return result\nEnd Functio