Public Class Form1\n    Private WithEvents treeView1 As New TreeView()\n    Private WithEvents textBoxEdit As New TextBox()\n    Private editingNode As TreeNode\n\n    Public Sub New()\n        InitializeComponent()\n        Me.Controls.Add(treeView1)\n        Me.Controls.Add(textBoxEdit)\n\n        ' Initialize TreeView\n        treeView1.Dock = DockStyle.Fill\n        treeView1.LabelEdit = False ' Disable default label editing\n        treeView1.Nodes.Add("Node1")\n        treeView1.Nodes.Add("Node2")\n\n        ' Initialize TextBox\n        textBoxEdit.Visible = False\n    End Sub\n\n    Private Sub treeView1_NodeMouseDoubleClick(sender As Object, e As TreeNodeMouseClickEventArgs) Handles treeView1.NodeMouseDoubleClick\n        ' Start editing on double-click\n        editingNode = e.Node\n        textBoxEdit.Bounds = editingNode.Bounds\n        textBoxEdit.Text = editingNode.Text\n        textBoxEdit.Visible = True\n        textBoxEdit.Focus()\n    End Sub\n\n    Private Sub textBoxEdit_Leave(sender As Object, e As EventArgs) Handles textBoxEdit.Leave\n        ' Finish editing when TextBox loses focus\n        If editingNode IsNot Nothing Then\n            editingNode.Text = textBoxEdit.Text\n            textBoxEdit.Visible = False\n            editingNode = Nothing\n        End If\n    End Sub\n\n    Private Sub textBoxEdit_KeyDown(sender As Object, e As KeyEventArgs) Handles textBoxEdit.KeyDown\n        ' Finish editing on Enter key\n        If e.KeyCode = Keys.Enter Then\n            editingNode.Text = textBoxEdit.Text\n            textBoxEdit.Visible = False\n            editingNode = Nothing\n        ElseIf e.KeyCode = Keys.Escape Then\n            ' Cancel editing on Escape key\n            textBoxEdit.Visible = False\n            editingNode = Nothing\n        End If\n    End Sub\nEnd Class