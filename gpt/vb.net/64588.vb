Sub RefreshLinksAndSetPrimaryKeys()\n    Dim db As DAO.Database\n    Dim tdf As DAO.TableDef\n    Dim rst As DAO.Recordset\n    Dim primaryKeyField As String\n\n    Set db = CurrentDb\n    \n    ' Refresh the links\n    For Each tdf In db.TableDefs\n        If Len(tdf.Connect) > 0 Then\n            tdf.RefreshLink\n        End If\n    Next tdf\n    \n    ' Open the table containing primary key information\n    Set rst = db.OpenRecordset("SELECT * FROM AccessViewPKInfo")\n    \n    ' Loop through each record in the table\n    Do While Not rst.EOF\n        ' Find the linked table\n        On Error Resume Next\n        Set tdf = db.TableDefs(rst!ViewName)\n        On Error GoTo 0\n        \n        If Not tdf Is Nothing Then\n            ' Set the primary key\n            primaryKeyField = rst!PrimaryKeyField\n            tdf.Fields(primaryKeyField).Attributes = dbAutoIncrField\n        End If\n        \n        ' Move to the next record\n        rst.MoveNext\n    Loop\n    \n    ' Clean up\n    rst.Close\n    Set rst = Nothing\n    Set db = Nothing\nEnd Sub