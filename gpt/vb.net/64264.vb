Imports System.Drawing\nImports System.Drawing.Imaging\n\nPublic Sub AdjustBrightness(ByRef img As Bitmap, ByVal brightness As Double)\n    Dim rect As New Rectangle(0, 0, img.Width, img.Height)\n    Dim bmpData As BitmapData = img.LockBits(rect, ImageLockMode.ReadWrite, img.PixelFormat)\n\n    Dim ptr As IntPtr = bmpData.Scan0\n    Dim bytes As Integer = Math.Abs(bmpData.Stride) * img.Height\n    Dim rgbValues(bytes - 1) As Byte\n\n    System.Runtime.InteropServices.Marshal.Copy(ptr, rgbValues, 0, bytes)\n\n    For k As Integer = 0 To rgbValues.Length - 1 Step 4\n        rgbValues(k) = Math.Min(255, rgbValues(k) * brightness) ' Blue\n        rgbValues(k + 1) = Math.Min(255, rgbValues(k + 1) * brightness) ' Green\n        rgbValues(k + 2) = Math.Min(255, rgbValues(k + 2) * brightness) ' Red\n    Next\n\n    System.Runtime.InteropServices.Marshal.Copy(rgbValues, 0, ptr, bytes)\n    img.UnlockBits(bmpData)\nEnd Sub