Public Function GetALList(Of T As {New, Class})(ByVal storedproc As String) As List(Of T)\n    Dim lstGenericList As New List(Of T)\n    Dim oProviderFactory As New ProviderFactory\n    Dim oConnection As DbConnection\n    Dim oReader As System.Data.IDataReader\n    Dim oFactory As DbProviderFactory\n    Dim oCmd As DbCommand\n\n    oFactory = oProviderFactory.GetFactory()\n    oConnection = oProviderFactory.GetProviderConnection(oFactory)\n    oCmd = oConnection.CreateCommand()\n    oCmd.CommandType = CommandType.StoredProcedure\n    oCmd.CommandText = storedproc\n\n    Using (oConnection)\n        oConnection.Open()\n        oReader = oCmd.ExecuteReader()\n\n        While oReader.Read()\n            Dim oGenericListItem As New T()\n            For Each prop In GetType(T).GetProperties()\n                If Not oReader.IsDBNull(oReader.GetOrdinal(prop.Name)) Then\n                    prop.SetValue(oGenericListItem, oReader(prop.Name))\n                End If\n            Next\n            lstGenericList.Add(oGenericListItem)\n        End While\n\n        oConnection.Close()\n    End Using\n\n    Return lstGenericList\nEnd Functio