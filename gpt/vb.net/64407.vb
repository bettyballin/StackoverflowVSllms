Imports System.ComponentModel\nImports System.Collections.ObjectModel\nImports System.Drawing\nImports System.Windows.Forms\nImports System.ComponentModel.Design\n\nPublic Class Gauge\n    Inherits Control\n\n    Private _Captions As New CaptionCollection\n\n    <DesignerSerializationVisibility(DesignerSerializationVisibility.Content)>\n    <Editor(GetType(CollectionEditor), GetType(UITypeEditor))>\n    Public Property Captions() As CaptionCollection\n        Get\n            Return _Captions\n        End Get\n        Set(ByVal value As CaptionCollection)\n            _Captions = value\n        End Set\n    End Property\n\n    Public Class Caption\n        Private _Text As String = ""\n        Private _Color As Color = Color.Black\n        Private _TextIsValue As Boolean\n        Private _Position As New Point(0, 0)\n\n        Public Property Text() As String\n            Get\n                Return _Text\n            End Get\n            Set(ByVal value As String)\n                If _Text <> value Then\n                    _Text = value\n                End If\n            End Set\n        End Property\n\n        Public Property Color() As Color\n            Get\n                Return _Color\n            End Get\n            Set(ByVal value As Color)\n                If _Color <> value Then\n                    _Color = value\n                End If\n            End Set\n        End Property\n\n        Public Property TextIsValue() As Boolean\n            Get\n                Return _TextIsValue\n            End Get\n            Set(ByVal value As Boolean)\n                If _TextIsValue <> value Then\n                    _TextIsValue = value\n                End If\n            End Set\n        End Property\n\n        Public Property Position() As Point\n            Get\n                Return _Position\n            End Get\n            Set(ByVal value As Point)\n                If _Position <> value Then\n                    _Position = value\n                End If\n            End Set\n        End Property\n    End Class\n\n    Public Class CaptionCollection\n        Inherits CollectionBase\n        Implements ICustomTypeDescriptor\n\n        Public Sub Add(ByVal c As Caption)\n            Me.List.Add(c)\n        End Sub\n\n        Public Sub Remove(ByVal c As Caption)\n            Me.List.Remove(c)\n        End Sub\n\n        Default Public ReadOnly Property Item(ByVal index As Integer) As Caption\n            Get\n                Return DirectCast(Me.List(index), Caption)\n            End Get\n        End Property\n\n        ' Implementing ICustomTypeDescriptor methods\n        Public Function GetComponentName() As String Implements ICustomTypeDescriptor.GetComponentName\n            Return TypeDescriptor.GetComponentName(Me, True)\n        End Function\n\n        Public Function GetAttributes() As AttributeCollection Implements ICustomTypeDescriptor.GetAttributes\n            Return TypeDescriptor.GetAttributes(Me, True)\n        End Function\n\n        Public Function GetClassName() As String Implements ICustomTypeDescriptor.GetClassName\n            Return TypeDescriptor.GetClassName(Me, True)\n        End Function\n\n        Public Function GetConverter() As TypeConverter Implements ICustomTypeDescriptor.GetConverter\n            Return TypeDescriptor.GetConverter(Me, True)\n        End Function\n\n        Public Function GetDefaultEvent() As EventDescriptor Implements ICustomTypeDescriptor.GetDefaultEvent\n            Return TypeDescriptor.GetDefaultEvent(Me, True)\n        End Function\n\n        Public Function GetDefaultProperty() As PropertyDescriptor Implements ICustomTypeDescriptor.GetDefaultProperty\n            Return TypeDescriptor.GetDefaultProperty(Me, True)\n        End Function\n\n        Public Function GetEditor(ByVal editorBaseType As Type) As Object Implements ICustomTypeDescriptor.GetEditor\n            Return TypeDescriptor.GetEditor(Me, editorBaseType, True)\n        End Function\n\n        Public Function GetEvents() As EventDescriptorCollection Implements ICustomTypeDescriptor.GetEvents\n            Return TypeDescriptor.GetEvents(Me, True)\n        End Function\n\n        Public Function GetEvents(ByVal attributes() As Attribute) As EventDescriptorCollection Implements ICustomTypeDescriptor.GetEvents\n            Return TypeDescriptor.GetEvents(Me, attributes, True)\n        End Function\n\n        Public Function GetProperties() As PropertyDescriptorCollection Implements ICustomTypeDescriptor.GetProperties\n            Return TypeDescriptor.GetProperties(Me, True)\n        End Function\n\n        Public Function GetProperties(ByVal attributes() As Attribute) As PropertyDescriptorCollection Implements ICustomTypeDescriptor.GetProperties\n            Return TypeDescriptor.GetProperties(Me, attributes, True)\n        End Function\n\n        Public Function GetPropertyOwner(ByVal pd As PropertyDescriptor) As Object Implements ICustomTypeDescriptor.GetPropertyOwner\n            Return Me\n        End Function\n    End Class\nEnd Class