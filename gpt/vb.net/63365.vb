Private Sub LoadAddIns()\n    ' Get add-in templates\n    Dim addIns = GetTemplates(TemplateTypes.AddIn)\n    ' Get the current document\n    Dim sectionId As String = CStr(Request.QueryString("sectionId"))\n    Dim docId As Integer = CInt(Split(sectionId, ":")(0))\n    Dim manual = GetTempManual(docId)\n    Dim content As XElement = manual.ManualContent\n    ' Find which templates have been used to create this document.\n    Dim usedTemplates = (From t In content.<header>.<templates>.<template> _\n                         Select CInt(t.<id>.Value)).ToList()\n    ' Exclude add-ins that have already been used.\n    If usedTemplates IsNot Nothing Then\n        addIns = addIns.Where(Function(a) Not usedTemplates.Contains(a.TemplateID)).ToList()\n    End If\n    ' Bind available add-ins to dropdown\n    With ddlAddIns\n        .DataSource = addIns\n        .DataTextField = "Title"\n        .DataValueField = "TemplateID"\n        .DataBind()\n        .Items.Insert(0, New ListItem("[select an add-in]", "0"))\n    End With\nEnd Sub