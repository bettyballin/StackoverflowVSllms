Imports System.Data.SqlClient\nImports System.Text\n\nPartial Class TreeView\n    Inherits System.Web.UI.Page\n\n    Protected Sub Page_Load(ByVal sender As Object, ByVal e As EventArgs) Handles Me.Load\n        If Not IsPostBack Then\n            GenerateTreeView()\n        End If\n    End Sub\n\n    Private Sub GenerateTreeView()\n        Dim sb As New StringBuilder()\n        Dim connStr As String = "Your_Connection_String"\n        Dim queryRegions As String = "SELECT Region_Name, Region_ID FROM Regions"\n        Dim queryAreas As String = "SELECT Area_Name, Region_ID FROM Areas"\n\n        Using conn As New SqlConnection(connStr)\n            Dim cmdRegions As New SqlCommand(queryRegions, conn)\n            Dim cmdAreas As New SqlCommand(queryAreas, conn)\n\n            conn.Open()\n\n            Dim regions As New Dictionary(Of Integer, String)\n            Using reader As SqlDataReader = cmdRegions.ExecuteReader()\n                While reader.Read()\n                    regions.Add(reader("Region_ID"), reader("Region_Name").ToString())\n                End While\n            End Using\n\n            Dim areas As New Dictionary(Of Integer, List(Of String))\n            Using reader As SqlDataReader = cmdAreas.ExecuteReader()\n                While reader.Read()\n                    Dim regionId As Integer = Convert.ToInt32(reader("Region_ID"))\n                    Dim areaName As String = reader("Area_Name").ToString()\n\n                    If Not areas.ContainsKey(regionId) Then\n                        areas(regionId) = New List(Of String)()\n                    End If\n                    areas(regionId).Add(areaName)\n                End While\n            End Using\n        End Using\n\n        sb.Append("<ul>")\n\n        For Each region In regions\n            sb.AppendFormat("<li><a href='yourpage.aspx?region={0}'>{1}</a>", region.Key, region.Value)\n            If areas.ContainsKey(region.Key) Then\n                sb.Append("<ul>")\n                For Each area In areas(region.Key)\n                    sb.AppendFormat("<li><a href='yourpage.aspx?area={0}'>{1}</a></li>", area, area)\n                Next\n                sb.Append("</ul>")\n            End If\n            sb.Append("</li>")\n        Next\n\n        sb.Append("</ul>")\n\n        ' Render the HTML to a Literal control or directly to the page\n        LiteralTreeView.Text = sb.ToString()\n    End Sub\nEnd Class