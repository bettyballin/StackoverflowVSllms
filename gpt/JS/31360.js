var presenter = new Practicum.Web.TEI.StudentPlacement2009.CreateLetter_class(); // This is a class generated by Ajax.Net\n\nfunction GetLetters() {\n    var GetLettersParams = {\n        TemplateType: $('#LetterTypes').val()\n    };\n    presenter.GetLetters(GetLettersParams, function(response) {\n        if (response.error != null) {\n            alert('An error has occurred\r\n' + response.error.Message);\n        } else {\n            createOptions('Templates', response.value, 'Id', 'Name', true);\n        }\n    });\n}\n\nfunction createOptions(selectId, optionsData, valueField, textField, clearFirst) {\n    var select = document.getElementById(selectId);\n    if (clearFirst) {\n        select.options.length = 0;\n    }\n    for (var i = 0; i < optionsData.length; i++) {\n        var option = document.createElement('option');\n        option.value = optionsData[i][valueField];\n        option.text = optionsData[i][textField];\n        select.appendChild(option);\n    }\n}