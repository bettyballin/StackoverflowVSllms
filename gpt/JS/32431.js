$(function() {\n    var IntervalId;\n    var counter = 0;\n    var divs = $('#div1,#div2,#div3');\n\n    function showDiv() {\n        divs.hide() // hide all divs\n            .filter(function(index) {\n                return index == counter % 3;\n            })\n            .show('fast'); // and show it\n        counter++;\n    }\n\n    function first_function() {\n        showDiv();     \n        IntervalId = setInterval(showDiv, 5000);\n    }\n\n    function second_function() {  \n        clearInterval(IntervalId);\n    }\n\n    $("#link1").toggle(\n        first_function, \n        second_function\n    );\n\n    // Ensure the counter is not reset when toggling\n    $("#link1").click(function() {\n        if ($(this).data('toggled')) {\n            $(this).data('toggled', false);\n        } else {\n            $(this).data('toggled', true);\n        }\n    });\n});