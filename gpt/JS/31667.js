function test() {\n    var d = new doh.Deferred();\n    \n    // First asynchronous login\n    Comm.login('larry', '123', function(result, msg) {\n        try {\n            // Check with doh.t and doh.is\n            d.callback(true);\n        } catch (e) {\n            d.errback(e);\n        }\n    });\n\n    d.addCallback(function() {\n        // Synchronous logout\n        Comm.logout();\n        try {\n            // Check with doh.t and doh.is\n            return true;\n        } catch (e) {\n            d.errback(e);\n        }\n    });\n\n    d.addCallback(function() {\n        var d2 = new doh.Deferred();\n        \n        // Second asynchronous login\n        Comm.login('alex', 'asdf', function(result, msg) {\n            try {\n                // Check with doh.t and doh.is\n                d2.callback(true);\n            } catch (e) {\n                d2.errback(e);\n            }\n        });\n        \n        return d2; // Returning doh.Deferred -- expect d to wait for d2.callback\n    });\n\n    return d;\n}