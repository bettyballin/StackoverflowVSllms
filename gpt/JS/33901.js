var xhReq = createXMLHttpRequest();\n\nfunction createXMLHttpRequest() {\n  try { return new ActiveXObject("Msxml2.XMLHTTP"); } catch (e) {}\n  try { return new ActiveXObject("Microsoft.XMLHTTP"); } catch (e) {}\n  try { return new XMLHttpRequest(); } catch(e) {}\n  alert("XMLHttpRequest not supported");\n  return null;\n}\n\nfunction mySubmit(id, bigText) {\n  var url    = "SubmitPost.cfm";\n  var params = "id=" + id + "&bigtext=" + encodeURIComponent(bigText);\n\n  xhReq.open("POST", url, true);\n\n  // Send the header information along with the request\n  xhReq.setRequestHeader("Content-type", "application/x-www-form-urlencoded");\n  xhReq.setRequestHeader("Connection", "close");\n\n  xhReq.onreadystatechange = onPostSubmit;\n  xhReq.send(params);\n}\n\nfunction onPostSubmit() {\n  if (xhReq.readyState == 4) {\n    if (xhReq.status != 200) {\n      alert('BadStatus');\n      return;\n    }\n    // Handle the response here\n  }\n}