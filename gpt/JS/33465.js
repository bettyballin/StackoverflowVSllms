<script type="text/javascript">\n    function savePanelState(panelId, hiddenFieldId) {\n        var panel = $find(panelId);\n        var hiddenField = document.getElementById(hiddenFieldId);\n        hiddenField.value = panel.get_Collapsed();\n    }\n\n    function saveAllPanelStates() {\n        savePanelState('<%= CollapsiblePanelExtender1.ClientID %>', '<%= HiddenField1.ClientID %>');\n        // Repeat for other panels if you have more.\n    }\n\n    // Hook into the form's submit event to save state before postback\n    document.forms[0].onsubmit = saveAllPanelStates;\n</script>