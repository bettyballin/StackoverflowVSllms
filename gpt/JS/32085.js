var x;\nvar myRequest = new Array();\n\nfunction CreateXmlHttpReq(handler, progressHandler) {\n    var xmlhttp = null;\n    try {\n        xmlhttp = new XMLHttpRequest();\n    } catch (e) {\n        try {\n            xmlhttp = new ActiveXObject("Msxml2.XMLHTTP");\n        } catch (e) {\n            xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");\n        }\n    }\n    xmlhttp.onreadystatechange = handler;\n    xmlhttp.onprogress = progressHandler;\n    return xmlhttp;\n}\n\nfunction getResults() {\n    var r = Math.random();\n    var someVar = document.getElementById("myvar").value;\n    var myUrl = "url/of/my/phpScript.php?";\n    myUrl += "r=" + r;\n    myUrl += "&someVar=" + encodeURIComponent(someVar);\n    startLoading();\n    x = x || 0;\n    myRequest[x] = CreateXmlHttpReq(function () {\n        if (myRequest[x].readyState == 4 && myRequest[x].status == 200) {\n            stopLoading();\n        }\n    }, function (event) {\n        if (event.lengthComputable) {\n            var response = myRequest[x].responseText;\n            processIncrementalResponse(response);\n        }\n    });\n    myRequest[x].open("GET", myUrl, true);\n    myRequest[x].send(null);\n}\n\nvar lastProcessedIndex = 0;\n\nfunction processIncrementalResponse(response) {\n    var newText = response.substring(lastProcessedIndex);\n    lastProcessedIndex = response.length;\n\n    // Process the new text here\n    // For example, append it to a div\n    var div = document.getElementById("myDiv");\n    div.innerHTML += newText;\n}\n\nfunction startLoading() {\n    // Show loading overlay\n}\n\nfunction stopLoading() {\n    // Hide loading overlay\n}