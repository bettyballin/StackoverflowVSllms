var xmlhttp = sajax_init_object();\n\nfunction sajax_init_object() {\n    var A;\n    try {\n        A = new ActiveXObject("Msxml2.XMLHTTP");\n    } catch (e) {\n        try {\n            A = new ActiveXObject("Microsoft.XMLHTTP");\n        } catch (oc) {\n            A = null;\n        }\n    }\n    if (!A && typeof XMLHttpRequest !== "undefined")\n        A = new XMLHttpRequest();\n    if (!A)\n        console.error("Could not create connection object.");\n    return A;\n}\n\nfunction getSearchItem() {\n    var gs = document.forms.mainform.resultsfield;\n    var searchword = document.forms.mainform.searchform.value;\n    if (searchword.length >= 3) {\n        setWaitCursor();\n        clearResults();\n        var uri = "http://site.com/ajax_handler.php?s=" + encodeURIComponent(searchword);\n        console.log(uri);\n        xmlhttp.open("GET", uri, true);\n        xmlhttp.onreadystatechange = function () {\n            console.log("Ready state: " + xmlhttp.readyState);\n            if (xmlhttp.readyState == 4) {\n                if (xmlhttp.status == 200) {\n                    processResults(xmlhttp.responseText);\n                } else {\n                    console.error("HTTP error: " + xmlhttp.status);\n                }\n                removeWaitCursor();\n            }\n        };\n        xmlhttp.send(null);\n    } else {\n        alert("Please add at least 3 characters.");\n    }\n}