function initEditor() {\n    var writerFrame = frames['writer'];\n    var wc = document.getElementById('writerCopy');\n\n    if (writerFrame == null) return;\n\n    // Add an event listener for IE to ensure the content is fully loaded\n    writerFrame.onload = function() {\n        writerFrame.document.designMode = 'on';\n        writerFrame.document.body.innerHTML = styleSheet + wc.value;\n        writerFrame.focus();\n    };\n\n    // For other browsers, ensure designMode is on after loading\n    if (writerFrame.document.readyState === 'complete') {\n        writerFrame.document.designMode = 'on';\n        writerFrame.document.body.innerHTML = styleSheet + wc.value;\n        writerFrame.focus();\n    }\n}