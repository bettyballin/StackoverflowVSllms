function getCharacterOffset(textRange) {\n    // Create a duplicate of the TextRange\n    var duplicate = textRange.duplicate();\n    \n    // Move the end of the duplicate range to the start of the original range\n    duplicate.moveEnd('character', -textRange.text.length);\n    \n    // The length of the duplicate range is the character offset\n    var characterOffset = duplicate.text.length;\n    \n    return characterOffset;\n}\n\n// Usage example:\nvar range = document.selection.createRange(); // Assuming the selection range is already created\nvar offset = getCharacterOffset(range);\nconsole.log("Character offset: " + offset);