function getParentElementAtOffset(htmlString, offset) {\n    // Create a container element to hold the HTML string\n    let container = document.createElement('div');\n    container.innerHTML = htmlString;\n\n    // Initialize variables to traverse the DOM\n    let node = container;\n    let currentOffset = 0;\n\n    // Function to recursively traverse the node and find the offset\n    function traverseNodes(node) {\n        for (let child of node.childNodes) {\n            if (child.nodeType === Node.TEXT_NODE) {\n                if (currentOffset + child.textContent.length >= offset) {\n                    return child;\n                }\n                currentOffset += child.textContent.length;\n            } else if (child.nodeType === Node.ELEMENT_NODE) {\n                let result = traverseNodes(child);\n                if (result) return result;\n            }\n        }\n        return null;\n    }\n\n    // Find the node at the specified offset\n    let targetNode = traverseNodes(node);\n    if (targetNode) {\n        return targetNode.parentElement;\n    }\n\n    return null;\n}\n\n// Example usage:\nlet htmlString = `<h2>New Question</h2>\n\n<p>I am looking for a way in Javascript to get the parent element of a given position in an HTML string (e.g. document.innerHTML or document.body.innerHTML).</p>\n\n<p>Simple example:</p>\n\n<pre><code><p>I really <em>like <a href="...">stackoverflow</a></em> a lot.</p>\n                                   ^...........^\n                               Offset 35  to  48\n</code></pre>\n\n<p>Given offset 35 (to 48), the function should return the node object of the "a" element. I am wondering whether this is possible at all and, if it is, what would be a good approach to solve this.</p>\n\n<p><em>Thanks in advance for your efforts!</em></p>\n\n<hr>\n\n<h2>Old Question</h2>\n\n<p>Is there a way to highlight text at a given offset in an HTML document with Firefox?</p>\n\n<p>I have a list of offsets and lengths of strings to highlight. I suppose I need to find out the parent element of the text node at the given offset, is this right?</p>\n\n<p>I don't think it should be a problem for me to add the highlighting once I've got the right parent node, since this is simply DOM manipulation.</p>\n\n<p>Do you have any ideas or hints?</p>\n\n<p><strong>Clarification:</strong> The offsets are relative to the contents of the body tag. Thanks @ Jonathan for pointing this out.</p>\n\n<p>Thank you very much.</p>`;\nlet offset = 35;\n\nlet parentElement = getParentElementAtOffset(htmlString, offset);\nconsole.log(parentElement); // Should log the <a> element