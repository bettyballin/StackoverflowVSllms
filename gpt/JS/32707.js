function getHTTPObject() {\n    var xhr = false;\n    if (window.XMLHttpRequest) {\n        xhr = new XMLHttpRequest();\n    } else if (window.ActiveXObject) {\n        try {\n            xhr = new ActiveXObject("Msxml2.XMLHTTP");\n        } catch(e) {\n            try { \n                xhr = new ActiveXObject("Microsoft.XMLHTTP");\n            } catch(e) {\n                xhr = false;\n            }\n        }\n    }\n    return xhr;\n}\n\nfunction prepareLinks() {\n    var btn = document.getElementById("search");\n    btn.onclick = function() {\n        var url = "Account.aspx/GetData";\n        return !grabFile(url);\n    }; \n}\n\nfunction grabFile(file) {\n    var request = getHTTPObject();\n    if (request) {\n        displayLoading(document.getElementById("result"));\n        request.onreadystatechange = function() {\n            parseResponse(request);\n        };\n        // Open the connection and set the request method to POST\n        request.open("POST", file, true);\n        // Set the appropriate headers\n        request.setRequestHeader("Content-Type", "application/json; charset=utf-8");\n        // Send the request with an empty JSON object as the payload\n        request.send(JSON.stringify({}));\n        return true;\n    } else {\n        return false;\n    }\n}\n\nfunction parseResponse(request) {\n    if (request.readyState === 4) {\n        if (request.status === 200) {\n            var response = JSON.parse(request.responseText);\n            displayResult(response);\n        } else {\n            // Handle error\n            console.error("There was a problem with the request.");\n        }\n    }\n}\n\n// Make sure to call prepareLinks to attach the event handler\nprepareLinks();