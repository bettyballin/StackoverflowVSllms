function toProperCase(name) {\n    return name.split(' ').map(part => {\n        // Handle special cases like O'SMITH\n        if (part.includes("'")) {\n            return part.split("'").map(subPart => \n                subPart.charAt(0).toUpperCase() + subPart.slice(1).toLowerCase()\n            ).join("'");\n        }\n\n        // Handle hyphenated names like MCHYPHEN-SMITH\n        if (part.includes("-")) {\n            return part.split("-").map(subPart => \n                subPart.charAt(0).toUpperCase() + subPart.slice(1).toLowerCase()\n            ).join("-");\n        }\n\n        // Handle Mc/Mac prefixes\n        if (/^(Mc|Mac)/i.test(part)) {\n            return part.charAt(0).toUpperCase() + part.charAt(1).toLowerCase() + part.slice(2);\n        }\n\n        // General case\n        return part.charAt(0).toUpperCase() + part.slice(1).toLowerCase();\n    }).join(' ');\n}\n\n// Example usage:\nconsole.log(toProperCase("John SMITH"));          // John Smith\nconsole.log(toProperCase("Mary O'SMITH"));        // Mary O'Smith\nconsole.log(toProperCase("E.t MCHYPHEN-SMITH"));  // E.T McHyphen-Smith\nconsole.log(toProperCase("John Middlename SMITH"));// John Middlename Smith