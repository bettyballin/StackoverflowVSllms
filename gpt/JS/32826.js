var ajaxReq = function(url, callback) {\n    // Initialize the xhr object for different browsers\n    var xhr = window.ActiveXObject ? new ActiveXObject("Microsoft.XMLHTTP") : new XMLHttpRequest();\n\n    // Function to check if the request was successful\n    var httpSuccess = function(xhr) {\n        try {\n            return !xhr.status && location.protocol === "file:" ||\n                (xhr.status >= 200 && xhr.status < 300) ||\n                xhr.status == 304 || xhr.status == 1223 || xhr.status == 0;\n        } catch (e) {\n            return false;\n        }\n    };\n\n    // If no xhr object could be created, return 404 (Not Found)\n    if (!xhr) {\n        return 404;\n    }\n\n    // Set the function to be called when the readyState changes\n    xhr.onreadystatechange = function() {\n        if (xhr.readyState == 4) {\n            if (httpSuccess(xhr)) {\n                callback(xhr);\n            } else {\n                return 503; // Service Unavailable\n            }\n        }\n    };\n\n    // Open the request\n    xhr.open('GET', url, true);\n\n    // Set the headers\n    try {\n        xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");\n        xhr.setRequestHeader("Accept", "text/xml, application/xml, text/plain");\n    } catch (ex) {\n        window.alert('Error: ' + ex.toString());\n    }\n\n    // Send the request\n    try {\n        xhr.send('');\n    } catch (e) {\n        return 400; // Bad Request\n    }\n\n    return xhr;\n};\n\n// Call the function to make the AJAX request\nwindow.onload = function() {\n    ajaxReq('ConferenceRoomSchedules.xml', function(xhr) {\n        // In Firefox, this line works fine\n        // In IE, this line should now work too\n        if (xhr.responseText) {\n            window.document.getElementById('schedule').innerHTML = xhr.responseText;\n        }\n\n        // Firefox says 'xhr.responseXML is undefined' if the response is not XML\n        // Check if responseXML is not null and is a valid XML Document\n        if (xhr.responseXML && xhr.responseXML.documentElement) {\n            window.alert(xhr.responseXML.documentElement.nodeName);\n        } else {\n            window.alert('Response is not a valid XML document.');\n        }\n    });\n}