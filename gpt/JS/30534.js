const { getUserRole } = require('../models/user');\n\n// Define roles and permissions\nconst roles = {\n  admin: ['view_payroll', 'edit_payroll', 'view_job_costing', 'edit_job_costing'],\n  manager: ['view_payroll', 'view_job_costing'],\n  employee: ['view_job_costing']\n};\n\nmodule.exports = (req, res, next) => {\n  const userId = req.header('userId'); // Assume userId is passed in the header for simplicity\n  const userRole = getUserRole(userId);\n\n  if (!userRole || !roles[userRole]) {\n    return res.status(403).json({ message: 'Access denied' });\n  }\n\n  req.user = { id: userId, role: userRole, permissions: roles[userRole] };\n  next();\n};