<method name="beforeOpen"><![CDATA[\n    importPackage(Packages.java.lang);\n    var schema = params["SCHEMA"];\n    \n    if(schema == null || schema.trim() == ""){\n        throw new IllegalArgumentException("Schema parameter cannot be null or empty");\n    }\n    \n    this.queryText = \n        "SELECT CURRENT DATE AS DATE, " +\n        "(CASE WHEN DAYOFWEEK(CURRENT DATE) = 1 THEN 'SUNDAY' " +\n        "      WHEN DAYOFWEEK(CURRENT DATE) = 2 THEN 'MONDAY' " +\n        "      WHEN DAYOFWEEK(CURRENT DATE) = 3 THEN 'TUESDAY' " +\n        "      WHEN DAYOFWEEK(CURRENT DATE) = 4 THEN 'WEDNESDAY' " +\n        "      WHEN DAYOFWEEK(CURRENT DATE) = 5 THEN 'THURSDAY' " +\n        "      WHEN DAYOFWEEK(CURRENT DATE) = 6 THEN 'FRIDAY' " +\n        "      WHEN DAYOFWEEK(CURRENT DATE) = 7 THEN 'SATURDAY' " +\n        "      END) AS DAYOFWEEK " +\n        "FROM " + schema + ".COBOL_CALENDAR " +\n        "WHERE SERVICE_DATE = CURRENT DATE";\n]]></method>