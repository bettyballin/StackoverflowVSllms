function check_username(username) {\n    var httpxml = new XMLHttpRequest(); // Initialize the XMLHttpRequest object\n\n    function stateck() {\n        if (httpxml.readyState == 4 && httpxml.status == 200) { // Check if request is complete and successful\n            if (httpxml.responseText.indexOf("Username Ok") !== -1) {\n                UserNameOk = true;\n            } else {\n                UserNameOk = false;\n            }\n            checkCanSubmit();\n            document.getElementById("user_div").innerHTML = httpxml.responseText;\n        }\n    }\n\n    httpxml.onreadystatechange = stateck;\n    var user_url = "ajax_username.php?username=" + encodeURIComponent(username.value); // Use encodeURIComponent to handle special characters\n    httpxml.open("GET", user_url, true);\n    httpxml.send(null);\n}\n\nfunction checkCanSubmit() {\n    if (UserNameOk && PasswordOk && EmailOk) {\n        document.getElementById("button").disabled = false;\n    } else {\n        document.getElementById("button").disabled = true;\n    }\n}