<script type="text/javascript">\n    $(document).ready(function() {\n        // make ajax call\n        var dataString = 'comment=' + comment;\n        $.ajax({\n            type: "POST",\n            url: "process.php",\n            data: dataString,\n            dataType: "json",\n            success: function(data) {\n                // result from 1st ajax call returns "captcha"\n                if (data.response === 'captcha') {\n                    // a bunch of code is ran\n                    ////////////////////////\n                    // then...\n                    $(document).on('cbox_closed', function() {\n                        var dataString2 = 'comment=' + comment + '&run=captchagood';\n                        \n                        // our nested ajax call\n                        // make sure to use the correct data parameter\n                        $.ajax({\n                            type: "POST",\n                            url: "process.php",\n                            data: dataString2,\n                            dataType: "json",\n                            success: function(data2) {\n                                if (data2.response === 'captchagood') {\n                                    alert('test');\n                                    $('div#loader').find('img.load-gif').remove();\n                                    $('div#loader').append('<span class="success">Thanks for your comment!</span>');\n                                    $('div#loader').hide().fadeIn('slow');\n                                    $('span.limit').remove();\n                                    $('div#comments').append(data2.comment); // Make sure to use data2.comment here\n                                    $('div#comments div.comment-unapproved:nth-child(1)').hide().slideDown('slow');\n                                    $('input#submit-comment').unbind('click').click(function() {\n                                        return false;\n                                    });\n                                    // success append the sanitized-comment to the page\n                                    $('#comments').prepend(data2.comment);\n                                }\n                                // end captcha status returned\n                            }\n                        });\n                    });\n                }\n                return false;\n            }\n        });\n    });\n</script>