var xpitest = {\n    ...\n    onFileChosen: function(e) {\n        var fileInput = e.explicitOriginalTarget;\n        if (fileInput.type == "file") {\n            var parentDiv = fileInput.parentNode;\n            var existingButton = parentDiv.querySelector("#Firefox_Now_button_id");\n            \n            // Remove the existing button if it exists\n            if (existingButton) {\n                parentDiv.removeChild(existingButton);\n            }\n\n            // Create a new button\n            var newButton = top.window.content.document.createElement("input");\n            newButton.setAttribute("type", "button");\n            newButton.setAttribute("id", "Firefox_Now_button_id");\n            newButton.setAttribute("value", "my button");\n            newButton.setAttribute("name", "Firefox_Now_button_name");\n            parentDiv.insertBefore(newButton, fileInput.nextSibling);\n        }\n    }\n    ...\n}\n\nwindow.addEventListener("change", function(e) { xpitest.onFileChosen(e) }, false);