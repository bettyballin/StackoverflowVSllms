<script>\nfunction startReportGeneration() {\n    fetch('/StartReportGeneration', { method: 'POST' })\n        .then(response => response.json())\n        .then(data => {\n            const reportId = data.reportId;\n            checkReportStatus(reportId);\n        });\n}\n\nfunction checkReportStatus(reportId) {\n    const interval = setInterval(() => {\n        fetch(`/CheckReportStatus?reportId=${reportId}`)\n            .then(response => response.json())\n            .then(data => {\n                if (data.isCompleted) {\n                    clearInterval(interval);\n                    window.location.href = `/DownloadReport?reportId=${reportId}`;\n                }\n            });\n    }, 5000); // Check every 5 seconds\n}\n\ndocument.getElementById('generateReportButton').addEventListener('click', startReportGeneration);\n</script>