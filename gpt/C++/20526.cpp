#include <windows.h>\n#include <iostream>\n\nbool IsClientMultiThreaded()\n{\n    HRESULT hr = CoInitializeEx(nullptr, COINIT_MULTITHREADED);\n    if (hr == S_OK)\n    {\n        CoUninitialize();\n        return true;\n    }\n    else if (hr == RPC_E_CHANGED_MODE)\n    {\n        std::cerr << "Client is already initialized as apartment-threaded\n";\n        return false;\n    }\n\n    std::cerr << "Failed to initialize COM library\n";\n    return false;\n}