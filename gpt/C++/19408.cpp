#include <comutil.h> // Required for SAFEARRAY handling\n\nHRESULT STDMETHODCALLTYPE YourClass::GetFoo(int bufferSize, SAFEARRAY** pBuffer)\n{\n    if (pBuffer == nullptr)\n        return E_POINTER;\n\n    // Access the array data\n    int* pArrayData = nullptr;\n    HRESULT hr = SafeArrayAccessData(*pBuffer, (void**)&pArrayData);\n    if (FAILED(hr))\n        return hr;\n\n    // Fill the array with data\n    for (int i = 0; i < bufferSize; ++i)\n    {\n        pArrayData[i] = i; // Example: fill with index values\n    }\n\n    // Release the array data\n    hr = SafeArrayUnaccessData(*pBuffer);\n    return hr;\n}