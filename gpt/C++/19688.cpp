HRESULT CMyClass::ConnectEvents(IHTMLElement* pElem)\n{\n    HRESULT hr;\n    CComPtr<IConnectionPointContainer> pCPC;\n    CComPtr<IConnectionPoint> pCP;\n    DWORD dwCookie;\n\n    hr = pElem->QueryInterface(IID_IConnectionPointContainer, (void**)&pCPC);\n    if (SUCCEEDED(hr))\n    {\n        hr = pCPC->FindConnectionPoint(DIID_HTMLElementEvents2, &pCP);\n        if (SUCCEEDED(hr))\n        {\n            // Use CComPtr to handle the reference counting automatically\n            CComPtr<IUnknown> pUnk;\n            hr = this->QueryInterface(IID_IUnknown, (void**)&pUnk);\n            if (SUCCEEDED(hr))\n            {\n                hr = pCP->Advise(pUnk, &dwCookie);\n                if (SUCCEEDED(hr))\n                {\n                    // Successfully advised\n                }\n                else\n                {\n                    // Handle Advise failure\n                }\n            }\n            else\n            {\n                // Handle QueryInterface failure\n            }\n        }\n        else\n        {\n            // Handle FindConnectionPoint failure\n        }\n    }\n    else\n    {\n        // Handle QueryInterface failure\n    }\n\n    return hr;\n}