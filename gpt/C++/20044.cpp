#include <atlbase.h>\n#include <mstscax.h>\n\nint main() {\n    HRESULT hr;\n    CComPtr<IMsRdpClient6> spRdpClient;\n    \n    // Initialize COM library\n    hr = CoInitialize(NULL);\n    if (FAILED(hr)) {\n        return -1;\n    }\n\n    // Create instance of the RDP control\n    hr = spRdpClient.CoCreateInstance(CLSID_MsRdpClient6);\n    if (FAILED(hr)) {\n        CoUninitialize();\n        return -1;\n    }\n\n    // Query for the IMsRdpClientNonScriptable4 interface\n    CComPtr<IMsRdpClientNonScriptable4> spRdpNonScriptable;\n    hr = spRdpClient.QueryInterface(&spRdpNonScriptable);\n    if (FAILED(hr)) {\n        CoUninitialize();\n        return -1;\n    }\n\n    // Enable CredSSP support\n    hr = spRdpNonScriptable->put_EnableCredSspSupport(VARIANT_TRUE);\n    if (FAILED(hr)) {\n        CoUninitialize();\n        return -1;\n    }\n\n    // Set Negotiate Security Layer\n    hr = spRdpClient->put_NegotiateSecurityLayer(VARIANT_TRUE);\n    if (FAILED(hr)) {\n        CoUninitialize();\n        return -1;\n    }\n\n    // Set Prompt for Credentials\n    hr = spRdpClient->put_PromptForCredentials(VARIANT_TRUE);\n    if (FAILED(hr)) {\n        CoUninitialize();\n        return -1;\n    }\n\n    // Set the server and other connection properties\n    hr = spRdpClient->put_Server(L"your_vista_machine");\n    // Set other necessary properties like username, domain, etc.\n\n    // Connect to the server\n    hr = spRdpClient->Connect();\n    if (FAILED(hr)) {\n        CoUninitialize();\n        return -1;\n    }\n\n    // Cleanup and exit\n    CoUninitialize();\n    return 0;\n}