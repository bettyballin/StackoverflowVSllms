class ATL_NO_VTABLE CMyLibrary :\n      public CComObjectRootEx<CComSingleThreadModel>,\n      public CComCoClass<CMyLibrary, &CLSID_MyLibrary>,\n      public IDispatchImpl<IMyLibrary, &IID_IMyLibrary, &LIBID_MyLibraryLib, /*wMajor =*/ 1, /*wMinor =*/ 0>\n   {\n   public:\n      CMyLibrary() {}\n\n      DECLARE_REGISTRY_RESOURCEID(IDR_MYLIBRARY)\n\n      BEGIN_COM_MAP(CMyLibrary)\n         COM_INTERFACE_ENTRY(IMyLibrary)\n         COM_INTERFACE_ENTRY(IDispatch)\n      END_COM_MAP()\n\n      DECLARE_PROTECT_FINAL_CONSTRUCT()\n\n      HRESULT FinalConstruct() { return S_OK; }\n      void FinalRelease() {}\n\n   public:\n      STDMETHOD(MyMethod)(BSTR input, BSTR* output);\n   };\n\n   STDMETHODIMP CMyLibrary::MyMethod(BSTR input, BSTR* output) {\n      CComBSTR result(L"Hello, ");\n      result.AppendBSTR(input);\n      *output = result.Detach();\n      return S_OK;\n   }