#include <afxwin.h>\n   #import "DotNetControl.tlb" raw_interfaces_only\n\n   using namespace DotNetControl;\n\n   class CMyDialog : public CDialog\n   {\n   public:\n       CMyDialog(CWnd* pParent = NULL) : CDialog(IDD_MYDIALOG, pParent) {}\n\n   protected:\n       virtual BOOL OnInitDialog()\n       {\n           CDialog::OnInitDialog();\n\n           HRESULT hr;\n           CLSID clsid;\n           hr = CLSIDFromProgID(OLESTR("DotNetControl.DotNetControlClass"), &clsid);\n           if (FAILED(hr))\n           {\n               AfxMessageBox(_T("Failed to get CLSID"));\n               return FALSE;\n           }\n\n           CWnd* placeholder = GetDlgItem(IDC_PLACEHOLDER); // Placeholder is a static control\n           CRect rect;\n           placeholder->GetWindowRect(&rect);\n           ScreenToClient(&rect);\n\n           IUnknown* pUnknown;\n           hr = CoCreateInstance(clsid, NULL, CLSCTX_INPROC_SERVER, IID_IUnknown, (void**)&pUnknown);\n           if (FAILED(hr))\n           {\n               AfxMessageBox(_T("Failed to create .NET control instance"));\n               return FALSE;\n           }\n\n           CComPtr<IDotNetControl> pDotNetControl;\n           hr = pUnknown->QueryInterface(IID_IDotNetControl, (void**)&pDotNetControl);\n           if (FAILED(hr))\n           {\n               AfxMessageBox(_T("Failed to get IDotNetControl interface"));\n               return FALSE;\n           }\n\n           pDotNetControl->SetText(L"Hello from MFC");\n\n           placeholder->DestroyWindow(); // Remove placeholder\n\n           CWnd* pWnd = CWnd::FromHandle((HWND)pUnknown);\n           pWnd->SetParent(this);\n           pWnd->MoveWindow(rect);\n\n           return TRUE;\n       }\n   };\n\n   class CMyApp : public CWinApp\n   {\n   public:\n       virtual BOOL InitInstance()\n       {\n           CoInitialize(NULL);\n\n           CMyDialog dlg;\n           m_pMainWnd = &dlg;\n           dlg.DoModal();\n\n           CoUninitialize();\n           return FALSE;\n       }\n   };\n\n   CMyApp theApp;