// CSimpleXMLParser::SelectNodes\nMSXML2::IXMLDOMNodeListPtr CSimpleXMLParser::SelectNodes(LPCTSTR strXPathFilter, MSXML2::IXMLDOMNodePtr pXMLNode)\n{\n    MSXML2::IXMLDOMNodeListPtr pList = nullptr;\n    try {\n        pList = pXMLNode->selectNodes(_bstr_t(strXPathFilter));\n    } catch (_com_error &e) {\n        // Handle COM error\n        wprintf(L"COM error: %s\n", e.ErrorMessage());\n    } catch (...) {\n        // Handle any other errors\n        wprintf(L"Unknown error occurred while selecting nodes.\n");\n    }\n    return pList;\n}\n\n// CXMLRecord::GetChildRecords\nbool CXMLRecord::GetChildRecords(std::vector<CXMLRecord*>& listRecords, LPCTSTR strXPathFilter)\n{\n    MSXML2::IXMLDOMNodeListPtr pListChildren = m_pParser->SelectNodes(strXPathFilter, m_pXMLNode);\n\n    if (!pListChildren || pListChildren->Getlength() == 0) {\n        wprintf(L"No child nodes found for XPath: %s\n", strXPathFilter);\n        return false;\n    }\n\n    for (long l = 0; l < pListChildren->Getlength(); ++l) {\n        MSXML2::IXMLDOMNodePtr pNode = pListChildren->Getitem(l);\n        if (pNode) {\n            listRecords.push_back(new CXMLRecord(pNode, m_pParser));\n        } else {\n            wprintf(L"Failed to get node at index %ld\n", l);\n        }\n    }\n\n    return true;\n}