#include <iomanip>  // for std::setw and std::setfill\n#include <fstream>  // for std::ofstream\n\nvoid WriteHexToFile(std::ofstream &stream, void *ptr, int buflen, const char *prefix)\n{\n    unsigned char *buf = (unsigned char*)ptr;\n\n    for (int i = 0; i < buflen; ++i)\n    {\n        if (i % 16 == 0)\n        {\n            stream << prefix;\n        }\n\n        // Output the byte in hexadecimal format\n        stream << std::hex << std::setw(2) << std::setfill('0') << (int)buf[i] << ' ';\n\n        if ((i + 1) % 16 == 0)\n        {\n            stream << '\n';\n        }\n    }\n\n    // Add a final newline if the last line wasn't complete\n    if (buflen % 16 != 0)\n    {\n        stream << '\n';\n    }\n\n    // Reset the formatting to default\n    stream << std::dec << std::setfill(' ') << std::setw(0);\n}