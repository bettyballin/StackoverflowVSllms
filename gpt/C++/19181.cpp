STDMETHODIMP QueryInterface(REFIID iid, void **ppvObject)\n{\n    if (!ppvObject)\n        return E_POINTER;\n\n    if (iid == IID_IUnknown || iid == __uuidof(IEvents))\n    {\n        *ppvObject = static_cast<IEvents*>(this);\n        AddRef();\n        return S_OK;\n    }\n    else\n    {\n        *ppvObject = NULL;\n        return E_NOINTERFACE;\n    }\n}\n\nULONG STDMETHODCALLTYPE AddRef()\n{\n    return InterlockedIncrement(&m_dwRefCount);\n}\n\nULONG STDMETHODCALLTYPE Release()\n{\n    ULONG ulRefCount = InterlockedDecrement(&m_dwRefCount);\n    if (0 == ulRefCount)\n    {\n        delete this;\n    }\n    return ulRefCount;\n}