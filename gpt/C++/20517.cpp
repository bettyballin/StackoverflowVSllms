IClassFactory* pClassFactory = nullptr;\n    HRESULT hr = CoGetClassObject(CLSID_MyClass, CLSCTX_INPROC_SERVER, nullptr, IID_IClassFactory, (void**)&pClassFactory);\n    if (SUCCEEDED(hr)) {\n        IMyInterface* pMyObject = nullptr;\n        hr = pClassFactory->CreateInstance(nullptr, IID_IMyInterface, (void**)&pMyObject);\n        if (SUCCEEDED(hr)) {\n            // Use the object\n            pMyObject->DoSomething();\n            pMyObject->Release();\n        }\n        pClassFactory->Release();\n    }