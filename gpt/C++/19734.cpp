//Application.exe\nSTARTUPINFO si = {sizeof(STARTUPINFO)};\nPROCESS_INFORMATION pi = {0};\n\nDetourCreateProcessWithDll(filename, NULL, NULL, NULL, TRUE, \n                           CREATE_DEFAULT_ERROR_MODE | CREATE_SUSPENDED, NULL, path,\n                           &si, &pi, detoured, hook, NULL);\n\nprocessID = pi.dwProcessId;\n\nhDll = InjectDLL(processID, hook);\n\nResumeThread(pi.hThread); // Resume the main thread first\n\nif (hDll != NULL)\n{\n    STARTER Starter = (STARTER)GetProcAddress(hDll, "Starter");\n    if (Starter != NULL)\n    {\n        Starter(); // Call Starter to create the monitoring thread\n    }\n}