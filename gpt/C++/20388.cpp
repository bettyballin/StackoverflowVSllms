CComPtr<IServiceProvider> spServiceProvider;\nHRESULT hr = m_spSite->QueryInterface(IID_IServiceProvider, (void**)&spServiceProvider);\nif (SUCCEEDED(hr) && spServiceProvider)\n{\n    hr = spServiceProvider->QueryService(SID_SWebBrowserApp, IID_IWebBrowser2, (void**)&spWebBrowser2);\n    if (SUCCEEDED(hr) && spWebBrowser2)\n    {\n        CString currentURL = GetCurrentPageURL(spWebBrowser2);\n        AfxMessageBox(currentURL);\n    }\n}