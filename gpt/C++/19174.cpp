void AddFiles(const AnsiString &path, TListBox *ListBox) {\n    TSearchRec sr;\n    int f = FindFirst(path + "\\*.*", faAnyFile, sr);\n    while (!f) {\n        if (sr.Attr & faDirectory) {\n            if (sr.Name != "." && sr.Name != "..") {\n                AnsiString newPath = path + "\\" + sr.Name;\n                AddFiles(newPath, ListBox);\n            }\n        } else {\n            ListBox->Items->Add(path + "\\" + sr.Name);\n        }\n        f = FindNext(sr);\n    }\n    FindClose(sr);\n}