HRESULT hresult = CoInitializeEx(NULL, COINIT_APARTMENTTHREADED);\n   if (SUCCEEDED(hresult)) {\n       IClassFactory *pIClassFactory = NULL;\n       hresult = CoGetClassObject(clsid, CLSCTX_LOCAL_SERVER, NULL, IID_IClassFactory, (LPVOID *)&pIClassFactory);\n       if (SUCCEEDED(hresult)) {\n           IUnknown *pUnk = NULL;\n           hresult = pIClassFactory->CreateInstance(NULL, IID_IUnknown, (LPVOID *)&pUnk);\n           if (SUCCEEDED(hresult)) {\n               IExample *pISimClass = NULL;\n               hresult = pUnk->QueryInterface(__uuidof(IExample), (LPVOID *)&pISimClass);\n               if (SUCCEEDED(hresult)) {\n                   // Successfully obtained IExample interface\n                   pISimClass->Release();\n               } else {\n                   // Handle E_NOINTERFACE error\n               }\n               pUnk->Release();\n           }\n           pIClassFactory->Release();\n       }\n       CoUninitialize();\n   }