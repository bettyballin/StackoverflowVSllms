#include <windows.h>\n#include <ole2.h>\n#include <iostream>\n\nHRESULT GetClipboardDataRetry(IDataObject** ppDataObject, int maxRetries = 5, int delayMs = 100) {\n    HRESULT hr;\n    int attempts = 0;\n    \n    while (attempts < maxRetries) {\n        hr = OleGetClipboard(ppDataObject);\n        if (SUCCEEDED(hr)) {\n            return hr;\n        } else if (hr == CLIPBRD_E_CANT_OPEN) {\n            Sleep(delayMs);\n            attempts++;\n        } else {\n            return hr;\n        }\n    }\n    \n    return hr;\n}\n\nint main() {\n    IDataObject* pDataObject = nullptr;\n    HRESULT hr = GetClipboardDataRetry(&pDataObject);\n    if (SUCCEEDED(hr)) {\n        std::cout << "Successfully retrieved clipboard data." << std::endl;\n        // Process clipboard data\n    } else {\n        std::cout << "Failed to retrieve clipboard data with error: " << hr << std::endl;\n    }\n    \n    if (pDataObject) {\n        pDataObject->Release();\n    }\n\n    return 0;\n}