#include <atlbase.h>\n#include <comutil.h>\n#include <iostream>\n\nvoid AddPropertyToBag(IPrintPipelinePropertyBag* pPrintPropertyBag, const wchar_t* propertyName, const wchar_t* someString) {\n    CComVariant varProperty;\n    varProperty.vt = VT_BSTR;\n    varProperty.bstrVal = SysAllocString(someString);\n    \n    if (varProperty.bstrVal == nullptr) {\n        // Handle allocation failure\n        std::cerr << "Failed to allocate BSTR" << std::endl;\n        return;\n    }\n    \n    HRESULT hr = pPrintPropertyBag->AddProperty(propertyName, &varProperty);\n    \n    if (FAILED(hr)) {\n        // Handle error\n        std::cerr << "Failed to add property" << std::endl;\n    }\n\n    // Clean up the VARIANT\n    VariantClear(&varProperty);\n}