#include <comdef.h>\n\nHRESULT YourMethod() {\n    // ... your code ...\n\n    // Create error info\n    CComPtr<ICreateErrorInfo> pCreateErrorInfo;\n    if (SUCCEEDED(CreateErrorInfo(&pCreateErrorInfo))) {\n        pCreateErrorInfo->SetDescription(L"C++ Exception");\n        pCreateErrorInfo->SetGUID(GUID_NULL); // or appropriate GUID\n        pCreateErrorInfo->SetSource(L"YourCOMServer");\n        pCreateErrorInfo->SetHelpFile(L"");\n        \n        CComPtr<IErrorInfo> pErrorInfo;\n        if (SUCCEEDED(pCreateErrorInfo->QueryInterface(IID_IErrorInfo, (void**)&pErrorInfo))) {\n            SetErrorInfo(0, pErrorInfo);\n        }\n    }\n    \n    return E_FAIL;  // or other appropriate failure code\n}