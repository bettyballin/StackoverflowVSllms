#include <windows.h>\n#include <string>\n#include <unordered_map>\n\nstd::unordered_map<HKEY, std::wstring> keyPathMap;\n\nLONG MyRegOpenKeyEx(HKEY hKey, LPCWSTR lpSubKey, DWORD ulOptions, REGSAM samDesired, PHKEY phkResult) {\n    LONG result = RegOpenKeyEx(hKey, lpSubKey, ulOptions, samDesired, phkResult);\n    if (result == ERROR_SUCCESS) {\n        std::wstring fullPath;\n        if (keyPathMap.find(hKey) != keyPathMap.end()) {\n            fullPath = keyPathMap[hKey] + L"\\" + lpSubKey;\n        } else {\n            fullPath = lpSubKey;\n        }\n        keyPathMap[*phkResult] = fullPath;\n    }\n    return result;\n}\n\nstd::wstring GetFullPathFromHandle(HKEY hKey) {\n    if (keyPathMap.find(hKey) != keyPathMap.end()) {\n        return keyPathMap[hKey];\n    }\n    return L"";\n}\n\nint main() {\n    HKEY hKey;\n    if (MyRegOpenKeyEx(HKEY_CURRENT_USER, L"Software\\MyApp", 0, KEY_READ, &hKey) == ERROR_SUCCESS) {\n        std::wstring fullPath = GetFullPathFromHandle(hKey);\n        wprintf(L"Full path: %s\n", fullPath.c_str());\n        RegCloseKey(hKey);\n    }\n    return 0;\n}