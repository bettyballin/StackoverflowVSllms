HRESULT RegisterServer(HMODULE hModule, const CLSID& clsid, const char* szFriendlyName, const char* szProgID)\n{\n    char szModule[MAX_PATH];\n    GetModuleFileName(hModule, szModule, ARRAYSIZE(szModule));\n\n    LPOLESTR clsidString;\n    StringFromCLSID(clsid, &clsidString);\n\n    // Prepare the registry entries\n    char szKey[256];\n    sprintf(szKey, "CLSID\\%ls", clsidString);\n\n    // Create registry entries\n    RegSetValue(HKEY_CLASSES_ROOT, szKey, REG_SZ, szFriendlyName, strlen(szFriendlyName));\n    sprintf(szKey, "CLSID\\%ls\\InprocServer32", clsidString);\n    RegSetValue(HKEY_CLASSES_ROOT, szKey, REG_SZ, szModule, strlen(szModule));\n    sprintf(szKey, "CLSID\\%ls\\ProgID", clsidString);\n    RegSetValue(HKEY_CLASSES_ROOT, szKey, REG_SZ, szProgID, strlen(szProgID));\n\n    CoTaskMemFree(clsidString);\n    return S_OK;\n}