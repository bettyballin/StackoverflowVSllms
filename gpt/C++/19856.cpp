#include <vector>\n#include <atlbase.h>\n#include <atlcom.h>\n\nclass CStringBuffer {\npublic:\n    CStringBuffer() : m_length(0) {}\n\n    void Append(const CComBSTR& str) {\n        m_data.insert(m_data.end(), str.m_str, str.m_str + str.Length());\n        m_length += str.Length();\n    }\n\n    CComBSTR ToBSTR() const {\n        return CComBSTR(m_length, m_data.data());\n    }\n\nprivate:\n    std::vector<WCHAR> m_data;\n    size_t m_length;\n};\n\n// Usage example\nint main() {\n    CStringBuffer buffer;\n    buffer.Append(CComBSTR(L"Hello, "));\n    buffer.Append(CComBSTR(L"World!"));\n    \n    CComBSTR result = buffer.ToBSTR();\n    wprintf(L"%s\n", static_cast<LPCWSTR>(result));\n    \n    return 0;\n}