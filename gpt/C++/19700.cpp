class CustomAudioNotifications : public IAudioSessionNotification\n{\npublic:\n    CustomAudioNotifications() : m_nRefCount(1) { InterlockedIncrement(&g_notifyCount); }\n    ~CustomAudioNotifications() { InterlockedDecrement(&g_notifyCount); }\n\n    // IUnknown interface\n    HRESULT __stdcall QueryInterface(REFIID riid, void **ppObj)\n    {\n        if (riid == IID_IUnknown || riid == __uuidof(IAudioSessionNotification))\n        {\n            *ppObj = static_cast<IAudioSessionNotification*>(this);\n            AddRef();\n            return S_OK;\n        }\n        *ppObj = NULL;\n        return E_NOINTERFACE;\n    }\n\n    ULONG __stdcall AddRef()\n    {\n        return InterlockedIncrement(&m_nRefCount);\n    }\n\n    ULONG __stdcall Release()\n    {\n        ULONG ulRefCount = InterlockedDecrement(&m_nRefCount);\n        if (0 == ulRefCount)\n        {\n            delete this;\n        }\n        return ulRefCount;\n    }\n\n    // IAudioSessionNotification\n    HRESULT __stdcall OnSessionCreated(IAudioSessionControl *NewSession)\n    {\n        // Handle new session creation\n        PostMessage(hWnd, WM_USER, 0, 0); // Assuming hWnd is a valid window handle\n        return S_OK;\n    }\n\nprivate:\n    LONG m_nRefCount;\n};