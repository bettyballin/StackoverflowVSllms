#include <Windows.h>\n#include <exdisp.h>\n#include <exdispid.h>\n#include <mshtml.h>\n#include <atlbase.h>\n#include <atlcom.h>\n\n// Function to post a message to the main thread\nvoid PostMessageToMainThread(HWND hwnd, WPARAM wParam, LPARAM lParam) {\n    PostMessage(hwnd, WM_USER, wParam, lParam);\n}\n\n// Message handler in the main thread\nLRESULT CALLBACK WindowProc(HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam) {\n    if (uMsg == WM_USER) {\n        // Retrieve the IWebBrowser2 pointer\n        CComPtr<IWebBrowser2> spWebBrowser2 = reinterpret_cast<IWebBrowser2*>(wParam);\n\n        // Retrieve the document from the web browser\n        CComPtr<IDispatch> spDisp;\n        spWebBrowser2->get_Document(&spDisp);\n\n        CComQIPtr<IHTMLDocument2> spHTMLDoc2(spDisp);\n        if (spHTMLDoc2) {\n            // Find the desired element\n            CComPtr<IHTMLElement> spElement;\n            spHTMLDoc2->getElementById(CComBSTR(L"elementId"), &spElement);\n            if (spElement) {\n                // Attach the event handler\n                CComQIPtr<IHTMLElement2> spElement2(spElement);\n                if (spElement2) {\n                    CComVariant varHandler(this); // Assuming 'this' is a valid event handler\n                    spElement2->attachEvent(CComBSTR(L"onclick"), varHandler);\n                }\n            }\n        }\n        return 0;\n    }\n    return DefWindowProc(hwnd, uMsg, wParam, lParam);\n}\n\n// Worker thread function\nDWORD WINAPI WorkerThread(LPVOID lpParam) {\n    // Perform some work\n\n    // Obtain the IWebBrowser2 pointer (using CoMarshalInterThreadInterfaceInStream and CoGetInterfaceAndReleaseStream)\n    CComPtr<IWebBrowser2> spWebBrowser2 = ...; // Assume this is obtained correctly\n\n    // Post a message to the main thread to attach the event handler\n    PostMessageToMainThread(hwndMain, reinterpret_cast<WPARAM>(spWebBrowser2.Detach()), 0);\n\n    return 0;\n}