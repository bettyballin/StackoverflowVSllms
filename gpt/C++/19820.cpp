void CMyClass::OnDocumentComplete(IDispatch* pDisp, VARIANT* URL)\n{\n    CComPtr<IWebBrowser2> spWebBrowser2;\n    CComPtr<IHTMLDocument2> spHTMLDoc2;\n    CComPtr<IHTMLElement> spBody;\n\n    HRESULT hr = pDisp->QueryInterface(IID_IWebBrowser2, (void**)&spWebBrowser2);\n    if (SUCCEEDED(hr))\n    {\n        CComPtr<IDispatch> spDocDisp;\n        hr = spWebBrowser2->get_Document(&spDocDisp);\n        if (SUCCEEDED(hr))\n        {\n            hr = spDocDisp->QueryInterface(IID_IHTMLDocument2, (void**)&spHTMLDoc2);\n            if (SUCCEEDED(hr))\n            {\n                hr = spHTMLDoc2->get_body(&spBody);\n                if (SUCCEEDED(hr))\n                {\n                    ConnectEvents(spBody);\n                }\n            }\n        }\n    }\n}