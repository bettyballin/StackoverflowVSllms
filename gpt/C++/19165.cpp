#include <atlbase.h>\n#include <atlcom.h>\n\nclass ATL_NO_VTABLE CMyComObject :\n    public CComObjectRootEx<CComSingleThreadModel>,\n    public CComCoClass<CMyComObject, &CLSID_MyComObject>,\n    public IDispatchImpl<IMyComObject, &IID_IMyComObject, &LIBID_MyLib, /*wMajor =*/ 1, /*wMinor =*/ 0>\n{\npublic:\n    // Constructor\n    CMyComObject() { }\n\n    DECLARE_REGISTRY_RESOURCEID(IDR_MYCOMOBJECT)\n\n    BEGIN_COM_MAP(CMyComObject)\n        COM_INTERFACE_ENTRY(IMyComObject)\n        COM_INTERFACE_ENTRY(IDispatch)\n    END_COM_MAP()\n\n    // Implement session management functions here\n\n    STDMETHOD(Connect)(BSTR service, LONG* sessionId) {\n        // Load and initialize the 3rd party DLL\n        // Generate and return a session ID\n    }\n\n    STDMETHOD(Disconnect)(LONG sessionId) {\n        // Disconnect the session identified by sessionId\n    }\n};\n\nOBJECT_ENTRY_AUTO(__uuidof(MyComObject), CMyComObject)