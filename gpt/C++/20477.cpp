String ReadLastDirectory() {\n       TRegistry* reg = new TRegistry(KEY_READ);\n       String lastDirectory = "default_directory"; // Default value\n       try {\n           reg->RootKey = HKEY_CURRENT_USER;\n           if (reg->OpenKey("\\Software\\YourAppName\\Options", false)) {\n               if (reg->ValueExists("Last Directory")) {\n                   lastDirectory = reg->ReadString("Last Directory");\n               }\n               reg->CloseKey();\n           }\n       } __finally {\n           delete reg;\n       }\n       return lastDirectory;\n   }