#include <atlbase.h>\n\nvoid update( HRESULT(IDispatch::*com_uint_getter)(UINT*), IDispatch* obj, UINT& u )\n{\n    UINT tmp;\n    if (obj && S_OK == (obj->*com_uint_getter)( &tmp )) {\n        u = tmp;\n    }\n}\n\n// only for compile purpose, it will not work at runtime\nint main(int, char*[])\n{\n    // I choose IDispatch::GetTypeInfoCount just for the sake of exemplification\n    CComPtr<IDispatch> ptr;\n    UINT u;\n    update(&IDispatch::GetTypeInfoCount, ptr, u);\n    return 0;\n}