// dllmain.cpp\n#include <windows.h>\n#include "dllheader.h"\n\nUserMainFunc userMain = NULL;\n\nextern "C" DLL_API void SetUserMain(UserMainFunc mainFunc) {\n    userMain = mainFunc;\n}\n\nextern "C" DLL_API int StartMessageLoop() {\n    if (userMain) {\n        userMain();\n    }\n\n    MSG msg;\n    BOOL done = FALSE;\n\n    while (!done) {\n        while (PeekMessage(&msg, NULL, 0, 0, PM_REMOVE)) {\n            if (msg.message == WM_QUIT) {\n                done = TRUE;\n            } else {\n                TranslateMessage(&msg);\n                DispatchMessage(&msg);\n            }\n        }\n    }\n\n    return (int)msg.wParam;\n}\n\nBOOL APIENTRY DllMain(HMODULE hModule, DWORD  ul_reason_for_call, LPVOID lpReserved) {\n    switch (ul_reason_for_call) {\n    case DLL_PROCESS_ATTACH:\n    case DLL_THREAD_ATTACH:\n    case DLL_THREAD_DETACH:\n    case DLL_PROCESS_DETACH:\n        break;\n    }\n    return TRUE;\n}