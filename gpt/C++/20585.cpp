#include <windows.h>\n#include <stdio.h>\n\nBOOL PostMessageWithRetry(DWORD dwThreadID, UINT Msg, WPARAM wParam, LPARAM lParam) {\n    BOOL bResult = FALSE;\n    int retry = 0;\n    DWORD dwError = 0;\n\n    do {\n        bResult = PostThreadMessage(dwThreadID, Msg, wParam, lParam);\n        if (!bResult) {\n            dwError = GetLastError();\n            if (dwError == ERROR_INVALID_THREAD_ID) {\n                printf("PostThreadMessage failed with ERROR_INVALID_THREAD_ID. Attempt %d\n", retry + 1);\n            } else {\n                printf("PostThreadMessage failed with error code %lu. Attempt %d\n", dwError, retry + 1);\n            }\n            retry++;\n            Sleep(500); // wait before retrying\n        }\n    } while (!bResult && retry < 3);\n\n    if (!bResult) {\n        printf("Failed to post message after %d attempts. Last error: %lu\n", retry, dwError);\n    }\n\n    return bResult;\n}