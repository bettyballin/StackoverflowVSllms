#include <iostream>\n    #include <comdef.h>\n\n    // Import the type library (generated from your C# assembly)\n    #import "YourAssembly.tlb" raw_interfaces_only\n\n    void doCalc(double* calcIn, int numIn, double* calcOut)\n    {\n        // Initialize COM\n        CoInitialize(NULL);\n\n        // Create the COM object\n        YourAssembly::ICalculatorPtr pICalc(__uuidof(YourAssembly::Calculator));\n\n        // Convert the input array to SAFEARRAY\n        SAFEARRAY* psaIn = SafeArrayCreateVector(VT_R8, 0, numIn);\n        memcpy(psaIn->pvData, calcIn, numIn * sizeof(double));\n\n        // Prepare the output SAFEARRAY\n        SAFEARRAY* psaOut = SafeArrayCreateVector(VT_R8, 0, numIn);\n\n        // Call the C# method\n        pICalc->DoCalculation(psaIn, numIn, &psaOut);\n\n        // Copy the results back to calcOut\n        memcpy(calcOut, psaOut->pvData, numIn * sizeof(double));\n\n        // Cleanup\n        SafeArrayDestroy(psaIn);\n        SafeArrayDestroy(psaOut);\n\n        // Uninitialize COM\n        CoUninitialize();\n    }