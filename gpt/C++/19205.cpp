#include <windows.h>\n#include <httpfilt.h>\n\nBOOL WINAPI GetFilterVersion(PHTTP_FILTER_VERSION pVer) {\n    pVer->dwFlags = SF_NOTIFY_SECURE_PORT | SF_NOTIFY_AUTHENTICATION;\n    strncpy_s(pVer->lpszFilterDesc, "Client Cert Filter", SF_MAX_FILTER_DESC_LEN);\n    return TRUE;\n}\n\nDWORD WINAPI HttpFilterProc(PHTTP_FILTER_CONTEXT pfc, DWORD dwNotificationType, LPVOID pvNotification) {\n    if (dwNotificationType == SF_NOTIFY_AUTHENTICATION) {\n        PHTTP_FILTER_AUTHENT pAuth = (PHTTP_FILTER_AUTHENT)pvNotification;\n        // Custom logic to check client cert and set user context.\n    }\n    return SF_STATUS_REQ_NEXT_NOTIFICATION;\n}