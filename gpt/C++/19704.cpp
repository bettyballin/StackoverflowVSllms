#include <atlbase.h>\n#include <atlcom.h>\n#import "C:\\Program Files\\Microsoft Office\\OfficeXX\\MSOUTL.OLB" rename_namespace("Outlook")\n\nvoid SearchOutlookContacts(const std::wstring& searchCriteria) {\n    CoInitialize(NULL);\n    \n    Outlook::_ApplicationPtr pApp;\n    HRESULT hr = pApp.CreateInstance(__uuidof(Outlook::Application));\n    \n    if (SUCCEEDED(hr)) {\n        Outlook::_NameSpacePtr pNamespace = pApp->GetNamespace("MAPI");\n        pNamespace->Logon("", "", false, false);\n\n        Outlook::_ItemsPtr pItems = pNamespace->GetDefaultFolder(Outlook::olFolderContacts)->Items;\n\n        // Create a restriction string for the search\n        std::wstring restriction = L"[FullName] = '" + searchCriteria + L"'";\n        \n        Outlook::_ItemsPtr pFilteredItems = pItems->Restrict(restriction.c_str());\n\n        for (long i = 1; i <= pFilteredItems->Count; ++i) {\n            Outlook::_ContactItemPtr pContact = pFilteredItems->Item(i);\n            if (pContact) {\n                wprintf(L"Name: %s\n", (LPCTSTR)pContact->FullName);\n                wprintf(L"Email: %s\n", (LPCTSTR)pContact->Email1Address);\n            }\n        }\n        \n        pNamespace->Logoff();\n    }\n\n    CoUninitialize();\n}\n\nint main() {\n    SearchOutlookContacts(L"John Doe");\n    return 0;\n}