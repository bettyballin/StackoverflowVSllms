#include <windows.h>\n\nHMODULE GetCurrentModuleHandle()\n{\n    HMODULE hModule = NULL;\n    // Use the address of a function in the current module (e.g., this function)\n    GetModuleHandleEx(\n        GET_MODULE_HANDLE_EX_FLAG_FROM_ADDRESS | GET_MODULE_HANDLE_EX_FLAG_UNCHANGED_REFCOUNT,\n        (LPCTSTR)GetCurrentModuleHandle,\n        &hModule\n    );\n\n    return hModule;\n}