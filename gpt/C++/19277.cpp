#include <afxwin.h>\n\nbool IsMessageLoopRunning()\n{\n    CWinApp* pApp = AfxGetApp();\n    ASSERT(pApp != nullptr);\n\n    // Call PumpMessage and check if any messages are being processed\n    MSG msg;\n    if (::PeekMessage(&msg, NULL, 0, 0, PM_NOREMOVE))\n    {\n        // There are messages in the queue, which means the message loop is running\n        return true;\n    }\n    return false;\n}\n\n// Usage\nif (IsMessageLoopRunning())\n{\n    // Attach to existing message loop\n}\nelse\n{\n    // Create your own message loop\n}