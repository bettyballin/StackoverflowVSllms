#include <windows.h>\n#include <detours.h>\n#include <iostream>\n\n// Original CreateFile function pointer\nstatic HANDLE (WINAPI * Real_CreateFile)(\n    LPCWSTR lpFileName,\n    DWORD dwDesiredAccess,\n    DWORD dwShareMode,\n    LPSECURITY_ATTRIBUTES lpSecurityAttributes,\n    DWORD dwCreationDisposition,\n    DWORD dwFlagsAndAttributes,\n    HANDLE hTemplateFile\n) = CreateFileW;\n\n// Hooked CreateFile function\nHANDLE WINAPI Hooked_CreateFile(\n    LPCWSTR lpFileName,\n    DWORD dwDesiredAccess,\n    DWORD dwShareMode,\n    LPSECURITY_ATTRIBUTES lpSecurityAttributes,\n    DWORD dwCreationDisposition,\n    DWORD dwFlagsAndAttributes,\n    HANDLE hTemplateFile\n) {\n    std::wcout << L"CreateFile called with: " << lpFileName << std::endl;\n    return Real_CreateFile(lpFileName, dwDesiredAccess, dwShareMode, lpSecurityAttributes, dwCreationDisposition, dwFlagsAndAttributes, hTemplateFile);\n}\n\nint main() {\n    // Attach Detours\n    DetourTransactionBegin();\n    DetourUpdateThread(GetCurrentThread());\n    DetourAttach(&(PVOID&)Real_CreateFile, Hooked_CreateFile);\n    DetourTransactionCommit();\n\n    // Your code to run the target process or monitor it\n\n    // Detach Detours before exiting\n    DetourTransactionBegin();\n    DetourUpdateThread(GetCurrentThread());\n    DetourDetach(&(PVOID&)Real_CreateFile, Hooked_CreateFile);\n    DetourTransactionCommit();\n\n    return 0;\n}