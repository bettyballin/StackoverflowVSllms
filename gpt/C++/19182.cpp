STDMETHODIMP CMyDispatch::Invoke(DISPID dispIdMember, REFIID riid, LCID lcid, WORD wFlags,\n                                 DISPPARAMS* pDispParams, VARIANT* pVarResult,\n                                 EXCEPINFO* pExcepInfo, UINT* puArgErr) {\n    if (wFlags & DISPATCH_PROPERTYPUT) {\n        // Ensure that there is exactly one argument\n        ASSERT(pDispParams->cArgs == 1);\n\n        // Check if the argument is of type VT_DISPATCH\n        if (pDispParams->rgvarg[0].vt == VT_DISPATCH) {\n            IDispatch* pDisp = pDispParams->rgvarg[0].pdispVal;\n            if (pDisp) {\n                // Attempt to cast the IDispatch pointer to CMyDispatch\n                CMyDispatch* pDispatch = dynamic_cast<CMyDispatch*>(pDisp);\n                if (pDispatch) {\n                    // Successfully casted to CMyDispatch, proceed with your logic\n                    // ...\n                } else {\n                    // Handle the case where the cast fails\n                    // ...\n                }\n            }\n        }\n    }\n\n    if (pVarResult) {\n        CMyDispatch* pDisp = new CMyDispatch();\n        CComVariant val(pDisp);\n        val.Detach(pVarResult);\n    }\n    return S_OK;\n}