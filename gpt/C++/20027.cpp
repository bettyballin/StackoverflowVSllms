STDMETHODIMP CAnalisis::Load(IStream *pStm)\n{\n    HRESULT hr;\n    ULONG read;\n\n    // Deserialize the DOUBLE, float, etc.\n    hr = pStm->Read(&img.size, sizeof(DOUBLE), &read);\n    if (FAILED(hr)) return hr;\n\n    hr = pStm->Read(&img.color, sizeof(float), &read);\n    if (FAILED(hr)) return hr;\n\n    hr = pStm->Read(&img.light, sizeof(float), &read);\n    if (FAILED(hr)) return hr;\n\n    // Deserialize BSTR imgName\n    ULONG len;\n    hr = pStm->Read(&len, sizeof(ULONG), &read);\n    if (FAILED(hr)) return hr;\n    img.imgName = SysAllocStringByteLen(NULL, len);\n    hr = pStm->Read(img.imgName, len, &read);\n    if (FAILED(hr)) return hr;\n\n    // Deserialize BSTR uname\n    hr = pStm->Read(&len, sizeof(ULONG), &read);\n    if (FAILED(hr)) return hr;\n    img.uname = SysAllocStringByteLen(NULL, len);\n    hr = pStm->Read(img.uname, len, &read);\n    if (FAILED(hr)) return hr;\n\n    return S_OK;\n}