#include <comutil.h>\n\n// Inside your Shell Extension\nSTDMETHODIMP IconOverlayHandler::IsMemberOf(LPCWSTR pwszPath, DWORD dwAttrib) {\n    CLSID clsid;\n    HRESULT hr = CLSIDFromProgID(L"YourCompany.OverlayService", &clsid);\n    if (FAILED(hr)) return S_FALSE;\n\n    IOverlayService* pService = NULL;\n    hr = CoCreateInstance(clsid, NULL, CLSCTX_INPROC_SERVER, IID_PPV_ARGS(&pService));\n    if (FAILED(hr)) return S_FALSE;\n\n    BSTR bstrPath = SysAllocString(pwszPath);\n    VARIANT_BOOL showOverlay;\n    hr = pService->ShouldShowOverlay(bstrPath, &showOverlay);\n    SysFreeString(bstrPath);\n    pService->Release();\n\n    return (showOverlay == VARIANT_TRUE) ? S_OK : S_FALSE;\n}