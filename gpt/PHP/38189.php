<?php\n// serve_image.php\nsession_start();\n\nif (!isset($_SESSION['authenticated']) || !$_SESSION['authenticated']) {\n    header('HTTP/1.0 403 Forbidden');\n    echo 'You are forbidden!';\n    exit;\n}\n\n$image_path = 'path/to/your/images/' . basename($_GET['image']);\nif (file_exists($image_path)) {\n    header('Content-Type: ' . mime_content_type($image_path));\n    readfile($image_path);\n} else {\n    header('HTTP/1.0 404 Not Found');\n    echo 'Image not found!';\n}\n?>