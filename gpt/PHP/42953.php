function capitalizeName($name) {\n    // List of common prefixes that should be capitalized\n    $prefixes = ['Mc', 'Mac', 'O\''];\n    // List of lowercase particles\n    $particles = ['de', 'von', 'van', 'da', 'di', 'du', 'le', 'la'];\n\n    // Convert the name to lowercase first\n    $name = strtolower($name);\n\n    // Capitalize the first letter of each word\n    $name = ucwords($name);\n\n    // Handle common prefixes\n    foreach ($prefixes as $prefix) {\n        $pattern = '/' . $prefix . '([a-z])/i';\n        $name = preg_replace_callback($pattern, function ($matches) use ($prefix) {\n            return $prefix . strtoupper($matches[1]);\n        }, $name);\n    }\n\n    // Handle lowercase particles\n    foreach ($particles as $particle) {\n        $pattern = '/\b' . ucfirst($particle) . '\b/i';\n        $name = preg_replace_callback($pattern, function ($matches) {\n            return strtolower($matches[0]);\n        }, $name);\n    }\n\n    return $name;\n}\n\n// Example usage\n$names = [\n    'JOHN FITZGERALD',\n    'MCDONALD',\n    'MACARTHUR',\n    'O\'LUNNEY\'S',\n    'THEO DE RAADT'\n];\n\nforeach ($names as $name) {\n    echo capitalizeName($name) . "\n";\n}