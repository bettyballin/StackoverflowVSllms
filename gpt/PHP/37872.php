$mysqli = new mysqli("hostname", "username", "password", "database");\n\necho "I'm in _getMemberDemographicAttrs\n";\nif (!empty($member_id)) {\n    $query .= ' AND member_id = ' . $member_id;\n}\n\nif ($result = $mysqli->query($query)) {\n    $rules = [];\n    while ($rule = $result->fetch_assoc()) {\n        $rules[] = $rule;\n\n        // Free memory for large datasets\n        if (count($rules) >= 1000) {\n            // Process the rules here or save them to a file\n            $rules = [];\n        }\n    }\n    $result->free();\n\n    if (!empty($rules)) {\n        echo "I'm leaving _getMemberDemographicAttrs\n";\n        return $rules;\n    }\n}\n\n$mysqli->close();