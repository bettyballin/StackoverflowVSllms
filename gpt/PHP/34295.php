$batchSize = 100;\n$batchData = [];\n$itemCount = 0;\n\nforeach ($itemList as $key => $item) {\n    $guid = $item['Guid']; // Assuming $item contains 'Guid'\n    $download_records = new DownloadRecords();\n\n    if (!$download_records->selectRecordsFromCondition("WHERE Guid=".$guid."")) {\n        // Collect record for insertion\n        $batchData[] = $item;\n    } else {\n        // Collect record for updating\n        // Here you can handle updates if needed\n    }\n\n    $itemCount++;\n\n    // When the batch size is reached, do the insertion\n    if ($itemCount % $batchSize == 0) {\n        insertBatch($batchData);\n        $batchData = []; // Reset batch data\n    }\n}\n\n// Insert any remaining records\nif (!empty($batchData)) {\n    insertBatch($batchData);\n}\n\nfunction insertBatch($batchData) {\n    if (empty($batchData)) {\n        return;\n    }\n\n    $values = [];\n    foreach ($batchData as $item) {\n        $guid = $item['Guid'];\n        $value = "('$guid', ...)"; // Add all necessary fields here\n        $values[] = $value;\n    }\n\n    $valuesString = implode(',', $values);\n    $query = "INSERT INTO your_table (Guid, ...) VALUES $valuesString"; // Add all necessary fields here\n\n    // Execute the query, assuming $conn is your database connection\n    global $conn;\n    if (mysqli_query($conn, $query)) {\n        echo "Batch inserted successfully.";\n    } else {\n        echo "Error: " . mysqli_error($conn);\n    }\n}