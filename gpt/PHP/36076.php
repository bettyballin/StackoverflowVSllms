$mh = curl_multi_init();\n$handles = [];\n$results = [];\n\n// Step 1: Initialize all cURL handles and add them to the multi-handle\nwhile ($dbo = pg_fetch_object($dbres)) {\n    $ch = curl_init();\n    curl_setopt($ch, CURLOPT_URL, $dbo->url);\n    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\n    curl_setopt($ch, CURLOPT_NOBODY, true); // Only fetch the headers (improves performance)\n    curl_multi_add_handle($mh, $ch);\n\n    // Store the handle and corresponding db object\n    $handles[$ch] = $dbo;\n}\n\n// Step 2: Execute all requests in parallel\n$running = null;\ndo {\n    curl_multi_exec($mh, $running);\n    curl_multi_select($mh);\n} while ($running > 0);\n\n// Step 3: Collect the results and process them\nforeach ($handles as $ch => $dbo) {\n    $ihttp_code = intval(curl_getinfo($ch, CURLINFO_HTTP_CODE));\n\n    // Do checks on $ihttp_code and update db\n    // Example:\n    // $timestamp = time();\n    // pg_query($dbconn, "UPDATE your_table SET last_checked = $timestamp WHERE id = $dbo->id");\n\n    // Close the individual handle\n    curl_multi_remove_handle($mh, $ch);\n    curl_close($ch);\n}\n\n// Step 4: Close the multi-handle\ncurl_multi_close($mh);\n\n// Do other stuff here