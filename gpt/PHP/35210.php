class My_Controller_Plugin_Auth extends Zend_Controller_Plugin_Abstract\n{\n    public function preDispatch(Zend_Controller_Request_Abstract $request)\n    {\n        $auth = Zend_Auth::getInstance();\n        if (!$auth->hasIdentity()) {\n            $session = new Zend_Session_Namespace('auth_redirect');\n            $session->requestedUri = $request->getRequestUri();\n\n            $redirector = Zend_Controller_Action_HelperBroker::getStaticHelper('redirector');\n            $redirector->gotoSimple('login', 'auth');\n        }\n    }\n}