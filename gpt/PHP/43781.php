<?php\n$mbox = imap_open("{myserver.com:110/pop3/notls}INBOX", "u", "p");\nif (!$mbox) {\n    die('Cannot connect/check mail! Exiting');\n}\n\n$hdr = imap_check($mbox);\nif (!$hdr) {\n    die("Failed to get mail");\n}\n\n$msgCount = $hdr->Nmsgs;\nfor ($msgno = 1; $msgno <= $msgCount; $msgno++) {\n    $msgStruct = imap_fetchstructure($mbox, $msgno);\n    \n    if (!isset($msgStruct->parts)) {\n        continue;\n    }\n\n    foreach ($msgStruct->parts as $key => $part) {\n        if (isset($part->disposition) && strtoupper($part->disposition) === 'ATTACHMENT') {\n            $attachment = imap_fetchbody($mbox, $msgno, $key+1);\n            switch ($part->encoding) {\n                case 3: // base64\n                    $attachment = base64_decode($attachment);\n                    break;\n                case 4: // quoted-printable\n                    $attachment = quoted_printable_decode($attachment);\n                    break;\n            }\n\n            if (isset($part->dparameters[0]->value)) {\n                $filename = $part->dparameters[0]->value;\n            } else {\n                $filename = "attachment_$key";\n            }\n\n            // Save the file to the server\n            $filePath = '/path/to/save/' . $filename;\n            file_put_contents($filePath, $attachment);\n            echo "Saved attachment to: $filePath\n";\n        }\n    }\n}\n\nimap_close($mbox);\n?>