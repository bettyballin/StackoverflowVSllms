function custom_explode($content) {\n    // Split the content by lines first\n    $lines = explode("\n", $content);\n    $result = [];\n    $buffer = '';\n\n    foreach ($lines as $line) {\n        // Check if the line ends with an unescaped '!'\n        if (preg_match('/(?<!\\\)!$/', $line)) {\n            // If buffer has content, append it to the result\n            if ($buffer !== '') {\n                $result[] = $buffer;\n                $buffer = '';\n            }\n            // Add the line to the buffer\n            $buffer .= rtrim($line, '!') . ' ';\n        } else {\n            // If buffer has content, append the current line to it\n            if ($buffer !== '') {\n                $buffer .= $line;\n                $result[] = $buffer;\n                $buffer = '';\n            } else {\n                // Otherwise, just add the current line to the result\n                $result[] = $line;\n            }\n        }\n    }\n    \n    // If buffer has content at the end, add it to the result\n    if ($buffer !== '') {\n        $result[] = $buffer;\n    }\n\n    return $result;\n}\n\n// Example usage\n$content = <<<EOD\nZOMFG\n&This is a comment\n(show "Hello, World\!");\n&This is a comment !\non multiple !\nlines.\n(show !\n"Hello, !\nWorld\!!\n");\nEOD;\n\n$result = custom_explode($content);\nprint_r($result);