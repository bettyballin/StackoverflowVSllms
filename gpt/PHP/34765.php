<?php\n// process.php\n\nsession_start();\nrequire_once 'UserRights.php';\nrequire_once 'BusinessLogic.php';\n\n// Ensure all input is sanitized\n$action = filter_input(INPUT_POST, 'action', FILTER_SANITIZE_STRING);\n$userId = filter_input(INPUT_POST, 'user_id', FILTER_VALIDATE_INT);\n\n// Check user rights\nif (!UserRights::hasAccess($userId, $action)) {\n    http_response_code(403);\n    echo 'Unauthorized access';\n    exit;\n}\n\n// Dispatch action\ntry {\n    switch ($action) {\n        case 'create':\n            $data = filter_input_array(INPUT_POST, [\n                'name' => FILTER_SANITIZE_STRING,\n                'email' => FILTER_VALIDATE_EMAIL\n            ]);\n            BusinessLogic::create($data);\n            break;\n        case 'update':\n            $data = filter_input_array(INPUT_POST, [\n                'id' => FILTER_VALIDATE_INT,\n                'name' => FILTER_SANITIZE_STRING,\n                'email' => FILTER_VALIDATE_EMAIL\n            ]);\n            BusinessLogic::update($data);\n            break;\n        case 'delete':\n            $id = filter_input(INPUT_POST, 'id', FILTER_VALIDATE_INT);\n            BusinessLogic::delete($id);\n            break;\n        default:\n            http_response_code(400);\n            echo 'Invalid action';\n    }\n} catch (Exception $e) {\n    // Log error\n    error_log($e->getMessage());\n    http_response_code(500);\n    echo 'Internal server error';\n}\n\n?>