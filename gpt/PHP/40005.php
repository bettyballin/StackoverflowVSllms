<?php\n// Start session securely\nsession_start([\n    'cookie_lifetime' => 86400, // Lifetime of the cookie in seconds\n    'cookie_secure' => true,    // Use only if HTTPS\n    'cookie_httponly' => true,  // Prevents JavaScript access to session cookie\n    'use_strict_mode' => true,  // Enforces strict session ID mode\n]);\n\n// Database connection\n$mysqli = new mysqli("localhost", "username", "password", "database");\n\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    // Retrieve email and password from POST data\n    $email = $mysqli->real_escape_string($_POST['email']);\n    $password = $_POST['password'];\n\n    // Query the database for the user\n    $stmt = $mysqli->prepare("SELECT id, first_name, password_hash FROM users WHERE email = ?");\n    $stmt->bind_param("s", $email);\n    $stmt->execute();\n    $stmt->store_result();\n    $stmt->bind_result($uid, $first_name, $password_hash);\n    $stmt->fetch();\n\n    // Verify the password\n    if ($stmt->num_rows > 0 && password_verify($password, $password_hash)) {\n        // Regenerate session ID to prevent session fixation attacks\n        session_regenerate_id(true);\n\n        // Store user data in session variables\n        $_SESSION['uid'] = $uid;\n        $_SESSION['first_name'] = $first_name;\n\n        // Redirect to a protected page\n        header("Location: protected_page.php");\n        exit();\n    } else {\n        // Invalid credentials\n        echo "Invalid email or password.";\n    }\n\n    $stmt->close();\n}\n\n// Logout logic\nif (isset($_GET['logout'])) {\n    // Destroy the session\n    session_unset();\n    session_destroy();\n    header("Location: index.php");\n    exit();\n}\n\n// Protecting a page\nif (!isset($_SESSION['uid'])) {\n    header("Location: index.php");\n    exit();\n}\n?>