$original = 'original_image.jpg';\n$thumbnail = 'output_thumbnail.jpg';\n\nlist($width, $height) = getimagesize($original);\n$width_ratio = 160 / $width;\n\nif ($height * $width_ratio <= 120) {\n    $adjusted_width = 160;\n    $adjusted_height = $height * $width_ratio;\n} else {\n    $height_ratio = 120 / $height;\n    $adjusted_width = $width * $height_ratio;\n    $adjusted_height = 120;\n}\n\n$image_p = imagecreatetruecolor(160, 120);\n\n// Set the background color to white\n$white = imagecolorallocate($image_p, 255, 255, 255);\nimagefill($image_p, 0, 0, $white);\n\n$image = imagecreatefromjpeg($original);\nimagecopyresampled($image_p, $image, ceil((160 - $adjusted_width) / 2), ceil((120 - $adjusted_height) / 2), 0, 0, ceil($adjusted_width), ceil($adjusted_height), $width, $height);\n\nimagejpeg($image_p, $thumbnail, 100);\n\n// Clean up\nimagedestroy($image_p);\nimagedestroy($image);