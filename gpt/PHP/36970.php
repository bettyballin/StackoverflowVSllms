<?php\nfunction generate_expiring_url($vid_id, $vid_file) {\n    $expiry_time = time() + 3600;  // Link valid for 1 hour\n    $hash = generate_hash($vid_id, $expiry_time);\n    return "stream.php?vid_id={$vid_id}&hash={$hash}&expires={$expiry_time}";\n}\n\nfunction generate_hash($vid_id, $expiry_time) {\n    $secret_key = "your_secret_key";  // Use a strong secret key\n    return substr(md5($vid_id . $expiry_time . $secret_key), 0, 12);\n}\n?>