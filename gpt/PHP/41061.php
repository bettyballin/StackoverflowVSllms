class Foo {\n    private static $instances = [];\n\n    public function __construct() {\n        self::$instances[] = $this;\n    }\n\n    public function __destruct() {\n        foreach (self::$instances as $key => $instance) {\n            if ($instance === $this) {\n                unset(self::$instances[$key]);\n            }\n        }\n    }\n\n    public static function getInstances() {\n        return self::$instances;\n    }\n}\n\n$a = new Foo();\n$b = new Foo();\n\n$instances = Foo::getInstances();\n\n// $instances should now be array($a, $b) or array($b, $a)\nprint_r($instances);