$q = Doctrine_Query::create()\n    ->select('*')\n    ->from('Order o')\n    ->leftJoin('o.LineItems li')\n    ->where('DATE(o.creation_date_time) = ?', $theDate);\n\n$orders = $q->execute();\n\n$totalRents = 0;\n$totalSales = 0;\n\nforeach ($orders as $order) {\n    foreach ($order->LineItems as $lineItem) {\n        if ($lineItem->type == 1) {\n            $totalRents++;\n        } else if ($lineItem->type == 2) {\n            $totalSales++;\n        }\n    }\n}