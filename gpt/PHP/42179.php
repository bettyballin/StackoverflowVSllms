$mysqli = new mysqli("hostname", "username", "password", "database");\n\nif ($mysqli->connect_error) {\n    die("Connection failed: " . $mysqli->connect_error);\n}\n\n$stmt = $mysqli->prepare("\nSELECT tblpm.*\nFROM tblpm\nJOIN (\n    SELECT thread_id, MAX(date_sent) as max_date\n    FROM tblpm\n    WHERE receiver_id = ? OR sender_id = ?\n    GROUP BY thread_id\n) as latest_msg ON tblpm.thread_id = latest_msg.thread_id AND tblpm.date_sent = latest_msg.max_date\nWHERE tblpm.receiver_id = ?\nORDER BY tblpm.date_sent DESC\n");\n\n$stmt->bind_param("iii", $usrID, $usrID, $usrID);\n$stmt->execute();\n$result = $stmt->get_result();\n\nwhile ($row = $result->fetch_assoc()) {\n    // Process each row\n}\n\n$stmt->close();\n$mysqli->close();