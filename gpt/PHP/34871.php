<?php\n$servername = "localhost";\n$username = "root";\n$password = "";\n$dbname = "your_database_name";\n\n$conn = new mysqli($servername, $username, $password, $dbname);\n\nif ($conn->connect_error) {\n    die("Connection failed: " . $conn->connect_error);\n}\n\nif($_SERVER['REQUEST_METHOD'] == 'POST' && isset($_POST['item_id']) && isset($_POST['tags'])) {\n    $item_id = intval($_POST['item_id']);\n    $tags = explode(',', $_POST['tags']);\n    \n    // Remove old tags\n    $conn->query("DELETE FROM ItemTag WHERE ItemID = $item_id");\n\n    foreach ($tags as $tag) {\n        $tag = trim($tag);\n        if(empty($tag)) continue;\n\n        // Check if tag exists\n        $result = $conn->query("SELECT TagID FROM Tag WHERE Title = '$tag'");\n        if ($result->num_rows > 0) {\n            $row = $result->fetch_assoc();\n            $tag_id = $row['TagID'];\n            $conn->query("UPDATE Tag SET Tag_Counter = Tag_Counter + 1 WHERE TagID = $tag_id");\n        } else {\n            $conn->query("INSERT INTO Tag (Title) VALUES ('$tag')");\n            $tag_id = $conn->insert_id;\n        }\n\n        // Add new tags\n        $conn->query("INSERT INTO ItemTag (ItemID, TagID) VALUES ($item_id, $tag_id)");\n    }\n    echo json_encode(['status' => 'success']);\n} else {\n    echo json_encode(['status' => 'error', 'message' => 'Invalid request']);\n}\n\n$conn->close();\n?>