<?php\n// Generate a secure token\nfunction generateToken() {\n    return bin2hex(random_bytes(32));\n}\n\n// Store the token in the database with an expiration time\nfunction storeToken($email, $token) {\n    $expiry = time() + 3600; // 1 hour expiration\n    // Store $email, $token, and $expiry in your database\n}\n\n// Validate the token\nfunction validateToken($email, $token) {\n    // Retrieve the token and expiry from the database using $email\n    // $storedToken = ...;\n    // $expiry = ...;\n\n    if ($storedToken === $token && time() < $expiry) {\n        // Invalidate the token after use\n        // DELETE token from the database\n        return true;\n    }\n    return false;\n}\n\n// Example usage\n$email = $_GET['email'];\n$token = $_GET['key'];\n\nif (validateToken($email, $token)) {\n    // Token is valid, allow access to the profile update page\n} else {\n    // Token is invalid or expired\n    echo "Invalid or expired token.";\n}\n?>