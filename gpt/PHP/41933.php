<?php\n   $targetDir = "uploads";\n   $fileName = isset($_REQUEST["name"]) ? $_REQUEST["name"] : uniqid("file_");\n   $chunk = isset($_REQUEST["chunk"]) ? intval($_REQUEST["chunk"]) : 0;\n   $chunks = isset($_REQUEST["chunks"]) ? intval($_REQUEST["chunks"]) : 1;\n\n   // Create target dir\n   if (!file_exists($targetDir)) {\n       mkdir($targetDir);\n   }\n\n   // Open temp file\n   $filePath = "{$targetDir}/{$fileName}";\n   $out = fopen("{$filePath}.part", $chunk == 0 ? "wb" : "ab");\n   if ($out) {\n       // Read binary input stream and append it to temp file\n       $in = fopen("php://input", "rb");\n       if ($in) {\n           while ($buff = fread($in, 4096)) {\n               fwrite($out, $buff);\n           }\n       } else {\n           die('{"jsonrpc" : "2.0", "error" : {"code": 102, "message": "Failed to open input stream."}, "id" : "id"}');\n       }\n       fclose($in);\n       fclose($out);\n   } else {\n       die('{"jsonrpc" : "2.0", "error" : {"code": 102, "message": "Failed to open output stream."}, "id" : "id"}');\n   }\n\n   // Check if file has been uploaded\n   if (!$chunks || $chunk == $chunks - 1) {\n       rename("{$filePath}.part", $filePath);\n   }\n\n   // Return success JSON-RPC response\n   die('{"jsonrpc" : "2.0", "result" : null, "id" : "id"}');\n   ?>