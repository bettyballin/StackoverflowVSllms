function getFinalUrlUsingHeaders($url) {\n    $headers = get_headers($url, 1);\n    if (isset($headers['Location'])) {\n        if (is_array($headers['Location'])) {\n            // If there are multiple redirects, get the last one\n            return end($headers['Location']);\n        } else {\n            return $headers['Location'];\n        }\n    }\n    return $url; // Return original URL if no redirection\n}\n\n// Example usage\n$initialUrl = "http://foo.com";\n$finalUrl = getFinalUrlUsingHeaders($initialUrl);\necho "Final URL: " . $finalUrl;