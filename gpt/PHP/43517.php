<?php\n$identifier = filter_input(INPUT_GET, 'buyer_id', FILTER_SANITIZE_STRING); // Sanitize input\n$path = WAREHOUSE_PATH . '/products/' . $identifier . '.zip';\n\nif (!file_exists($path)) {\n    die('File not found.');\n}\n\n$mm_type = "application/octet-stream";\n\nheader("Pragma: public");\nheader("Expires: 0");\nheader("Cache-Control: must-revalidate, post-check=0, pre-check=0");\nheader("Cache-Control: public");\nheader("Content-Description: File Transfer");\nheader("Content-Type: " . $mm_type);\nheader("Content-Length: " . (string)(filesize($path)));\nheader('Content-Disposition: attachment; filename="' . basename($path) . '"');\nheader("Content-Transfer-Encoding: binary");\n\n// Clear output buffer to avoid extra spaces or newlines\nif (ob_get_length()) {\n    ob_clean();\n}\n\nflush();\n\n$fp = @fopen($path, 'rb');\nif ($fp) {\n    while (!feof($fp)) {\n        print(fread($fp, 1024*8));\n        flush();\n        if (connection_status() != 0) {\n            @fclose($fp);\n            die();\n        }\n    }\n    @fclose($fp);\n}\n\nexit;\n?>