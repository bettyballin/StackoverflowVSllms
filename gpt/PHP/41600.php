<?php\nnamespace App\Event;\n\nuse Cake\Event\EventListenerInterface;\nuse Cake\ORM\TableRegistry;\n\nclass AppInitializationListener implements EventListenerInterface\n{\n    public function implementedEvents(): array\n    {\n        return [\n            'Server.buildMiddleware' => 'onBootstrap',\n        ];\n    }\n\n    public function onBootstrap()\n    {\n        // Access the database and set the timezone\n        $settingsTable = TableRegistry::getTableLocator()->get('Settings');\n        $timezone = $settingsTable->find()\n            ->where(['key' => 'timezone'])\n            ->first()\n            ->value;\n\n        if ($timezone) {\n            putenv("TZ={$timezone}");\n        }\n    }\n}