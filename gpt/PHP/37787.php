function addParam($url, $param, $value) {\n    $parsedUrl = parse_url($url);\n    parse_str(isset($parsedUrl['query']) ? $parsedUrl['query'] : '', $queryParams);\n\n    $queryParams[$param] = $value;\n    $parsedUrl['query'] = http_build_query($queryParams);\n\n    return build_url($parsedUrl);\n}\n\nfunction build_url($parsedUrl) {\n    $scheme = isset($parsedUrl['scheme']) ? $parsedUrl['scheme'] . '://' : '';\n    $host = isset($parsedUrl['host']) ? $parsedUrl['host'] : '';\n    $port = isset($parsedUrl['port']) ? ':' . $parsedUrl['port'] : '';\n    $user = isset($parsedUrl['user']) ? $parsedUrl['user'] : '';\n    $pass = isset($parsedUrl['pass']) ? ':' . $parsedUrl['pass'] : '';\n    $pass = ($user || $pass) ? "$pass@" : '';\n    $path = isset($parsedUrl['path']) ? $parsedUrl['path'] : '';\n    $query = isset($parsedUrl['query']) ? '?' . $parsedUrl['query'] : '';\n    $fragment = isset($parsedUrl['fragment']) ? '#' . $parsedUrl['fragment'] : '';\n\n    return "$scheme$user$pass$host$port$path$query$fragment";\n}\n\n// Example usage\n$printPageURL = "http://www.somesite.com/print.php?newUser=1";\n$redirectURL = addParam($printPageURL, 'mode', '1');\n\necho $redirectURL; // Outputs: http://www.somesite.com/print.php?newUser=1&mode=1