<?php\n// Start the session\nsession_start();\n\n// Regenerate session ID to prevent session fixation\nsession_regenerate_id(true);\n\n// Set session cookie parameters\nsession_set_cookie_params([\n    'lifetime' => 0, // Session cookie expires on browser close\n    'path' => '/',   // Cookie is available within the entire domain\n    'domain' => '',  // Default domain\n    'secure' => true, // Only send cookie over HTTPS\n    'httponly' => true, // Accessible only through HTTP, not JavaScript\n    'samesite' => 'Strict' // Prevent CSRF attacks\n]);\n\n// Store session data\n$_SESSION['user_id'] = $user_id;\n\n// Implement a session timeout\nif (isset($_SESSION['LAST_ACTIVITY']) && (time() - $_SESSION['LAST_ACTIVITY'] > 1800)) {\n    // Last request was more than 30 minutes ago\n    session_unset(); // Unset $_SESSION variable\n    session_destroy(); // Destroy session data\n}\n$_SESSION['LAST_ACTIVITY'] = time(); // Update last activity time\n?>