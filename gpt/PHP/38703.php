use Drupal\Core\TempStore\PrivateTempStoreFactory;\nuse Symfony\Component\DependencyInjection\ContainerInterface;\n\nclass FileDownloadService {\n  protected $tempStoreFactory;\n\n  public function __construct(PrivateTempStoreFactory $tempStoreFactory) {\n    $this->tempStoreFactory = $tempStoreFactory;\n  }\n\n  public static function create(ContainerInterface $container) {\n    return new static($container->get('tempstore.private'));\n  }\n\n  public function generateDownloadLink($file_path) {\n    $store = $this->tempStoreFactory->get('file_download_tokens');\n    $token = bin2hex(random_bytes(16));\n    $store->set($token, $file_path);\n\n    return \Drupal::url('custom_module.file_download', ['token' => $token], ['absolute' => TRUE]);\n  }\n}