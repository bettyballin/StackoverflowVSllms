<?php\nsession_start();\n$poll_id = 'poll_12345'; // unique identifier for the poll\n$cookie_name = "voted_$poll_id";\n$ip_address = $_SERVER['REMOTE_ADDR'];\n\n// Check if the user has already voted\nif (isset($_COOKIE[$cookie_name]) || hasVotedFromIP($poll_id, $ip_address)) {\n    echo "You have already voted.";\n    exit();\n}\n\n// Function to check if the IP has already voted\nfunction hasVotedFromIP($poll_id, $ip_address) {\n    // Connect to the database (use your own connection method)\n    $conn = new mysqli('localhost', 'username', 'password', 'database');\n    if ($conn->connect_error) {\n        die("Connection failed: " . $conn->connect_error);\n    }\n\n    $stmt = $conn->prepare("SELECT COUNT(*) FROM poll_votes WHERE poll_id = ? AND ip_address = ?");\n    $stmt->bind_param("ss", $poll_id, $ip_address);\n    $stmt->execute();\n    $stmt->bind_result($count);\n    $stmt->fetch();\n    $stmt->close();\n    $conn->close();\n    \n    return $count > 0;\n}\n\n// Function to record the vote\nfunction recordVote($poll_id, $ip_address) {\n    // Connect to the database (use your own connection method)\n    $conn = new mysqli('localhost', 'username', 'password', 'database');\n    if ($conn->connect_error) {\n        die("Connection failed: " . $conn->connect_error);\n    }\n\n    $stmt = $conn->prepare("INSERT INTO poll_votes (poll_id, ip_address) VALUES (?, ?)");\n    $stmt->bind_param("ss", $poll_id, $ip_address);\n    $stmt->execute();\n    $stmt->close();\n    $conn->close();\n}\n\n// Record the vote\nrecordVote($poll_id, $ip_address);\n\n// Set a cookie to indicate the user has voted\nsetcookie($cookie_name, '1', time() + (86400 * 30), "/"); // Cookie expires in 30 days\n\necho "Thank you for voting!";\n?>