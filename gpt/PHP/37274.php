// src/Middleware/JwtAuthMiddleware.php\n   namespace App\Middleware;\n\n   use Cake\Http\Response;\n   use Cake\Http\ServerRequest;\n   use Firebase\JWT\JWT;\n   use Psr\Http\Message\ResponseInterface;\n   use Psr\Http\Message\ServerRequestInterface;\n\n   class JwtAuthMiddleware {\n       public function __invoke(ServerRequestInterface $request, ResponseInterface $response, callable $next) {\n           $jwtToken = $request->getCookie('jwt_token');\n           if ($jwtToken) {\n               try {\n                   $decoded = JWT::decode($jwtToken, 'your_secret_key', ['HS256']);\n                   // Set user data in request object\n                   $request = $request->withAttribute('user', $decoded);\n               } catch (\Exception $e) {\n                   // Invalid token, handle the error\n               }\n           }\n           return $next($request, $response);\n       }\n   }