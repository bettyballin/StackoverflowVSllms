<?php\nsession_start();\n\n// Check if the user is logged in\nif (!isset($_SESSION['loggedin']) || $_SESSION['loggedin'] !== true) {\n    header('HTTP/1.0 403 Forbidden');\n    exit('You are not allowed to access this resource.');\n}\n\n// Define the path to the images directory\n$imagesDirectory = '/var/www/images/';\n\n// Get the requested image file name\n$imageFile = basename($_GET['image']);\n\n// Sanitize the file name\n$imageFile = filter_var($imageFile, FILTER_SANITIZE_STRING);\n\n// Create the full file path\n$filePath = $imagesDirectory . $imageFile;\n\n// Check if the file exists\nif (!file_exists($filePath)) {\n    header('HTTP/1.0 404 Not Found');\n    exit('Image not found.');\n}\n\n// Serve the image\nheader('Content-Type: ' . mime_content_type($filePath));\nheader('Content-Length: ' . filesize($filePath));\nreadfile($filePath);\nexit;\n?>