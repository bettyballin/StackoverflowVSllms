<?php\nsession_start();\n\n// Check if user is logged in\nif (!isset($_SESSION['loggedin']) || $_SESSION['loggedin'] !== true) {\n    http_response_code(403);\n    echo "Access denied.";\n    exit;\n}\n\n// Get the image name from the URL\n$imageName = basename($_GET['image']);\n$imagePath = __DIR__ . '/../uploads/' . $imageName;\n\n// Check if the file exists\nif (!file_exists($imagePath)) {\n    http_response_code(404);\n    echo "File not found.";\n    exit;\n}\n\n// Serve the image\nheader('Content-Type: ' . mime_content_type($imagePath));\nheader('Content-Length: ' . filesize($imagePath));\nreadfile($imagePath);\nexit;\n?>