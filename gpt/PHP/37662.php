<?php\nerror_reporting(E_ALL);\nini_set('display_errors', 1);\n\nif (isset($_GET["cmd"])) {\n    $cmd = $_GET["cmd"];\n} elseif (isset($_POST["cmd"])) {\n    $cmd = $_POST["cmd"];\n} else {\n    die("Invalid URL");\n}\n\nif (isset($_GET["pk"])) {\n    $pk = $_GET["pk"];\n} else {\n    die("Primary key (pk) is missing");\n}\n\n$checkfield = "";\n$checkboxes = isset($_POST['checkboxes']) ? $_POST['checkboxes'] : array();\n\nif (in_array('field', $checkboxes)) {\n    $checkfield = 'checked';\n} else {\n    $checkfield = ''; // Ensure the field is properly set if not checked.\n}\n\n$con = new mysqli("localhost", "user", "", "db");\n\nif ($con->connect_error) {\n    die("Connection failed: " . $con->connect_error);\n}\n\n$con->set_charset("utf8");\n\n$getformdata = $con->prepare("SELECT saleid, field FROM STATUS WHERE saleid = ?");\n$getformdata->bind_param("s", $pk);\n$getformdata->execute();\n$result = $getformdata->get_result();\n$saleid = "";\n\nif ($row = $result->fetch_assoc()) {\n    $saleid = $row['saleid'];\n    $checkfield = $row['field'];\n}\n\n$getformdata->close();\n\nif ($cmd == "submitinfo") {\n    if (empty($saleid)) {\n        $statusQuery = "INSERT INTO STATUS (saleid, field) VALUES (?, ?)";\n        $statusInfo = $con->prepare($statusQuery);\n        $statusInfo->bind_param("ss", $pk, $checkfield);\n        $statusInfo->execute();\n        $statusInfo->close();\n    } elseif ($saleid == $pk) {\n        $statusQuery = "UPDATE STATUS SET field = ? WHERE saleid = ?";\n        $statusInfo = $con->prepare($statusQuery);\n        $statusInfo->bind_param("ss", $checkfield, $pk);\n        $statusInfo->execute();\n        $statusInfo->close();\n    }\n}\n\nif ($cmd == "EditStatusData") {\n    echo "<form name=\"statusForm\" action=\"test.php?pk=" . $pk . "\" method=\"post\" enctype=\"multipart/form-data\">\n            <h1>Editing information for Auction No: " . $pk . "</h1>\n            <input type=\"checkbox\" name=\"checkboxes[]\" value=\"field\" " . ($checkfield === 'checked' ? 'checked' : '') . " />\n            <label for=\"field\">Test</label>\n            <br />\n            <input type=\"hidden\" name=\"cmd\" value=\"submitinfo\" />\n            <input name=\"Submit\" type=\"submit\" value=\"submit\" />\n        </form>";\n}\n\n$con->close();\n?>