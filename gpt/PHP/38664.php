<?php\n$descriptorspec = array(\n    0 => array("pipe", "r"),  // stdin\n    1 => array("pipe", "w"),  // stdout\n    2 => array("pipe", "w")   // stderr\n);\n\n$process = proc_open('hg clone ...', $descriptorspec, $pipes);\n\nif (is_resource($process)) {\n    // Close stdin as we don't need to provide input\n    fclose($pipes[0]);\n\n    // Read the output in real-time\n    while (!feof($pipes[1])) {\n        echo fgets($pipes[1]);\n        flush();\n    }\n\n    fclose($pipes[1]);\n    fclose($pipes[2]);\n\n    // Get the return value of the command\n    $return_value = proc_close($process);\n    echo "Command returned $return_value\n";\n}\n?>