<?php\n// Securely get filename and properFilename from GET request\n$filename = basename($_GET['file']);\n$properFilename = basename($_GET['properFilename']);\n\n// Validate and sanitize the inputs\nif(!file_exists($filename)){\n    die('File not found');\n}\n\n$ctype = mime_content_type($filename);\n\nheader("Pragma: public"); // required\nheader("Expires: 0");\nheader("Cache-Control: must-revalidate, post-check=0, pre-check=0");\nheader("Cache-Control: private", false); // required for certain browsers\nheader("Content-Type: $ctype");\nheader("Content-Disposition: attachment; filename=\"" . basename($properFilename) . "\";");\nheader("Content-Transfer-Encoding: binary");\nheader("Content-Length: " . filesize($filename));\nreadfile($filename);\nexit();\n?>