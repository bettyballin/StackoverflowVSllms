var $validate = array(\n    'username' => array(\n        'notEmpty' => array(\n            'rule' => array('minLength', 5),\n            'required' => true,\n            'allowEmpty' => false,\n            'message' => 'User name has to be at least 5 characters long'\n        ),\n        array(\n            'rule' => 'isUnique',\n            'message' => 'User name taken. Use another'\n        )\n    ),\n    'password' => array(\n        'notEmpty' => array(\n            'rule' => array('minLength', 6),\n            'required' => true,\n            'allowEmpty' => false,\n            'message' => 'Password has to be at least 6 characters long'\n        ),\n        'password_similar' => array(\n            'rule' => 'checkPasswords',\n            'message' => 'Entered passwords do not match'\n        )\n    ),\n    'email' => array(\n        'rule' => 'email',\n        'required' => true,\n        'allowEmpty' => false,\n        'message' => 'Please enter a valid email'\n    )\n);\n\nfunction checkPasswords($data) {\n    return $data['password'] === $this->data['User']['password2'];\n}