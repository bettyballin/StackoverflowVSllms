<?php\n// First of all, start with some advertisement\nheader("X-Powered-By:ZOMFG CMS, and of course PHP, but that's less important");\n// Then less important stuff\nsession_start(); // Start a session\nmysql_connect($db_host, $db_user, $db_pass); // Connect to the database\nmysql_select_db($db_name); // Select a database\n\n// Load core\nrequire_once("core.php");\n\n// Load settings class\nrequire_once("settings.php");\n\n// Load modules\n$res_modules = mysql_query("SELECT * FROM ".$_SERVER["db_prefix"]."modules WHERE enabled=1");\necho mysql_error();\n$module_exists = array();\nwhile($row_modules = mysql_fetch_array($res_modules))\n{\n    // Load module\n    $name = $row_modules["name"];\n    modules::load_module($name);\n    // and initialize it\n    eval($name."::init();");\n    // Yes, it exists\n    $module_exists[$name] = true;\n}\n\n// Check if the user wants something from a module\nif (isset($_GET["m"])) // Yes the user wants it\n{\n    // Does the module exist and activated, and has it a function called view?\n    if (isset($module_exists[$_GET["m"]]) && method_exists($_GET["m"], "view")) // Yep\n    {\n        // Load view (should be an array)\n        eval("\$module_view = ".$_GET["m"]."::view();");\n        if (!is_array($module_view)) // Not an array :(\n        {\n            error::e500module($_GET["m"], $_SERVER["REQUEST_URI"]);\n        }\n        else // The error would kill the entire script, m'kay\n        {\n            view::index();\n        }\n    }\n    else // Nope, so display error\n    {\n        error::e404($_SERVER['REQUEST_URI']);\n    }\n}\n?>