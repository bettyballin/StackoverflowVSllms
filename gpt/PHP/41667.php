// Joomla: After user logs in\nfunction generateSSOToken($userId) {\n    $token = bin2hex(random_bytes(16)); // Generate a random token\n    $expiration = time() + 300; // Token valid for 5 minutes\n\n    // Store token in database\n    $db = JFactory::getDbo();\n    $query = $db->getQuery(true)\n                ->insert($db->quoteName('#__sso_tokens'))\n                ->columns($db->quoteName(['user_id', 'token', 'expiration']))\n                ->values($db->quote($userId) . ', ' . $db->quote($token) . ', ' . $db->quote($expiration));\n    $db->setQuery($query);\n    $db->execute();\n\n    return $token;\n}\n\n// Generate token and create link\n$userId = JFactory::getUser()->id;\n$token = generateSSOToken($userId);\n$moodleUrl = "https://moodle.example.com/sso_login.php?token=$token";