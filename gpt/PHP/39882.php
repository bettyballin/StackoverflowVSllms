<?php\n   // Email account credentials\n   $hostname = '{imap.yourmailserver.com:993/imap/ssl}INBOX';\n   $username = 'your-email@example.com';\n   $password = 'your-email-password';\n\n   // Open an IMAP connection\n   $inbox = imap_open($hostname, $username, $password) or die('Cannot connect to mail server: ' . imap_last_error());\n\n   // Search for all emails\n   $emails = imap_search($inbox, 'ALL');\n\n   if ($emails) {\n       // Sort emails by newest first\n       rsort($emails);\n\n       foreach ($emails as $email_number) {\n           // Fetch the email overview\n           $overview = imap_fetch_overview($inbox, $email_number, 0);\n           $message = imap_fetchbody($inbox, $email_number, 1.1);\n           if (empty($message)) {\n               $message = imap_fetchbody($inbox, $email_number, 1);\n           }\n\n           // Get email subject and message\n           $subject = $overview[0]->subject;\n           $body = $message;\n\n           // Fetch email structure\n           $structure = imap_fetchstructure($inbox, $email_number);\n\n           // If there are attachments\n           if (isset($structure->parts) && count($structure->parts)) {\n               for ($i = 0; $i < count($structure->parts); $i++) {\n                   $attachments = [];\n                   if ($structure->parts[$i]->ifdparameters) {\n                       foreach ($structure->parts[$i]->dparameters as $object) {\n                           if (strtolower($object->attribute) == 'filename') {\n                               $filename = $object->value;\n                               $attachment = imap_fetchbody($inbox, $email_number, $i + 1);\n                               if ($structure->parts[$i]->encoding == 3) {\n                                   $attachment = base64_decode($attachment);\n                               } elseif ($structure->parts[$i]->encoding == 4) {\n                                   $attachment = quoted_printable_decode($attachment);\n                               }\n                               file_put_contents('/path/to/save/attachments/' . $filename, $attachment);\n                           }\n                       }\n                   }\n               }\n           }\n\n           // Save email subject and body to a file\n           file_put_contents('/path/to/save/emails/' . $email_number . '.txt', "Subject: $subject\n\n$body");\n       }\n   }\n\n   // Close the IMAP connection\n   imap_close($inbox);\n   ?>