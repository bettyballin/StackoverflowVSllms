<?php\n// Ensure the $pk is fetched from $_POST\nif (isset($_POST["pk"])) {\n    $pk = htmlspecialchars($_POST["pk"], ENT_QUOTES, 'UTF-8');\n}\n\n$con = new mysqli("localhost", "x", "x", "x");\n\nif ($con->connect_error) {\n    die("Connection failed: " . $con->connect_error);\n}\n\nif (isset($_FILES["file"])) {\n    $fileName = $_FILES["file"]["name"];\n    $fileType = $_FILES["file"]["type"];\n    $fileSize = $_FILES["file"]["size"];\n    $fileTmpName = $_FILES["file"]["tmp_name"];\n\n    echo "Upload: " . htmlspecialchars($fileName, ENT_QUOTES, 'UTF-8') . "<br />";\n    echo "Type: " . htmlspecialchars($fileType, ENT_QUOTES, 'UTF-8') . "<br />";\n    echo "Size: " . ($fileSize / 1024) . " Kb<br />";\n    echo "Temp file: " . htmlspecialchars($fileTmpName, ENT_QUOTES, 'UTF-8') . "<br />";\n\n    $destination = "./" . basename($fileName);\n\n    if (move_uploaded_file($fileTmpName, $destination)) {\n        echo "Stored in: " . htmlspecialchars($destination, ENT_QUOTES, 'UTF-8');\n\n        $fileQuery = "INSERT INTO FILES (pk, filename) VALUES (?, ?)";\n        if ($fileInsert = $con->prepare($fileQuery)) {\n            $fileInsert->bind_param("ss", $pk, $fileName);\n            $fileInsert->execute();\n            $fileInsert->close();\n        } else {\n            echo "Error: " . htmlspecialchars($con->error, ENT_QUOTES, 'UTF-8');\n        }\n    } else {\n        echo "File upload failed.";\n    }\n}\n\n$con->close();\n?>