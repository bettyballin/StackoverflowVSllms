<?php\n// Ensure the URL is correct and avoid appending it twice\n$this->headScript()->appendFile('http://maps.google.com/maps/api/js?key=ABQIAAAAHSJ3TgOTyvA1VzwU8g4Y7RT2yXp_ZAY8_ufC3CFXhHIE1NvwkxRmCy1h3nGv3n46kcqaFljsimqfWw&sensor=true');\n\n// Append the JavaScript code correctly\n$this->headScript()->appendScript("\n    var map = null;\n    var geocoder = null;\n\n    function initialize() {\n        if (GBrowserIsCompatible()) {\n            map = new GMap2(document.getElementById('map_canvas'));\n            map.setCenter(new GLatLng(37.4419, -122.1419), 13);\n            geocoder = new GClientGeocoder();\n        }\n    }\n\n    function showAddress(address) {\n        if (geocoder) {\n            geocoder.getLatLng(\n                address,\n                function(point) {\n                    if (!point) {\n                        alert(address + ' not found');\n                    } else {\n                        map.setCenter(point, 13);\n                        var marker = new GMarker(point);\n                        map.addOverlay(marker);\n                        marker.openInfoWindowHtml(address);\n                    }\n                }\n            );\n        }\n    }\n");\n\n// Call the initialize function when the window loads\n$this->headScript()->appendScript("\n    window.onload = function() {\n        initialize();\n    };\n");\n?>