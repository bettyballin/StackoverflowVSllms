function register() {\n    if ($this->data) {\n        $hashedPassword = $this->Auth->password($this->data['User']['password']);\n        $hashedConfirmPassword = $this->Auth->password($this->data['User']['confirm_password']);\n        \n        if ($hashedPassword != $hashedConfirmPassword) {\n            $this->Session->setFlash(__('Password and Confirm Password must match.', true));\n            $this->data['User']['password'] = '';\n            $this->data['User']['confirm_password'] = '';\n        } else {\n            $this->data['User']['password'] = $hashedPassword;  // Ensure password is hashed before saving\n            $this->User->create();\n            if ($this->User->save($this->data)) {\n                $this->redirect(array('action' => 'index'), null, true);\n            } else {\n                $this->data['User']['password'] = '';\n                $this->data['User']['confirm_password'] = '';\n                $this->Session->setFlash(__('Some problem saving your information.', true));\n            }\n        }\n    }\n}