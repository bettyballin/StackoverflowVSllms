$query = '\n    CREATE TABLE IF NOT EXISTS `data` (\n        `id` BIGINT NOT NULL AUTO_INCREMENT UNIQUE,\n        PRIMARY KEY (`id`)\n    );\n\n    INSERT INTO `data` (`field1`, `field2`)\n    SELECT `field1`, `field2` FROM table1 WHERE `active` = 1\n    UNION\n    SELECT DO_ONE(`field1`), DO_TWO(`field2`) FROM table2 WHERE `active` = 1\n    ORDER BY `field1`;\n';\n\nif (mysql_query($query)) {\n    return true;\n}\nreturn false;