<?php\nclass User {\n    private $db;\n    private $user_table = 'users';\n\n    public function __construct($host, $user, $pass, $dbname) {\n        $this->db = new mysqli($host, $user, $pass, $dbname);\n\n        if ($this->db->connect_error) {\n            die("Connection failed: " . $this->db->connect_error);\n        }\n    }\n\n    public function register($username, $password, $role) {\n        $hash = password_hash($password, PASSWORD_BCRYPT);\n        $stmt = $this->db->prepare("INSERT INTO $this->user_table (username, password, role) VALUES (?, ?, ?)");\n        $stmt->bind_param("sss", $username, $hash, $role);\n        return $stmt->execute();\n    }\n\n    public function login($username, $password) {\n        $stmt = $this->db->prepare("SELECT id, password, role FROM $this->user_table WHERE username = ?");\n        $stmt->bind_param("s", $username);\n        $stmt->execute();\n        $stmt->store_result();\n\n        if ($stmt->num_rows > 0) {\n            $stmt->bind_result($id, $hashed_password, $role);\n            $stmt->fetch();\n\n            if (password_verify($password, $hashed_password)) {\n                session_start();\n                $_SESSION['user_id'] = $id;\n                $_SESSION['username'] = $username;\n                $_SESSION['role'] = $role;\n                return true;\n            }\n        }\n        return false;\n    }\n\n    public function is_logged_in() {\n        session_start();\n        return isset($_SESSION['user_id']);\n    }\n\n    public function get_role() {\n        session_start();\n        return isset($_SESSION['role']) ? $_SESSION['role'] : null;\n    }\n\n    public function logout() {\n        session_start();\n        session_unset();\n        session_destroy();\n    }\n}\n\n// Usage example:\n// $user = new User('localhost', 'root', 'password', 'database_name');\n// $user->register('username', 'password', 'admin');\n// $user->login('username', 'password');