<?php\n$bufferSize = 256; // Must match BUFFER_SIZE in the C program\n\n// Load the required extension\nif (!extension_loaded('com_dotnet')) {\n    die('com_dotnet extension not loaded');\n}\n\ntry {\n    // Create a COM object for Windows API calls\n    $com = new COM('WScript.Shell');\n    \n    // Open the memory-mapped file\n    $handle = $com->CreateFileMapping(INVALID_HANDLE_VALUE, NULL, PAGE_READWRITE, 0, $bufferSize, "my_foo");\n\n    if (!$handle) {\n        die('Could not create file mapping object.');\n    }\n    \n    $view = $com->MapViewOfFile($handle, FILE_MAP_ALL_ACCESS, 0, 0, $bufferSize);\n\n    if (!$view) {\n        $com->CloseHandle($handle);\n        die('Could not map view of file.');\n    }\n\n    // Read data from the memory-mapped file\n    $data = '';\n    for ($i = 0; $i < $bufferSize; $i++) {\n        $char = chr($com->ReadByte($view + $i));\n        if ($char === "\0") break;\n        $data .= $char;\n    }\n    \n    echo "Data from shared memory: " . $data;\n\n    // Cleanup\n    $com->UnmapViewOfFile($view);\n    $com->CloseHandle($handle);\n\n} catch (Exception $e) {\n    die('Error: ' . $e->getMessage());\n}\n?>