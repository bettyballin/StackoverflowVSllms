<?php\ntry {\n    $dsn = 'pgsql:host=your_host;port=5432;dbname=your_dbname;';\n    $username = 'your_username';\n    $password = 'your_password';\n\n    // Establishing the connection\n    $pdo = new PDO($dsn, $username, $password, [\n        PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION\n    ]);\n\n    // Start the transaction\n    $pdo->beginTransaction();\n\n    // Prepare the statements\n    $stmtInsert = $pdo->prepare("INSERT INTO requests (user_id, description, date) VALUES (:user_id, :description, NOW())");\n    $stmtUpdateRequests = $pdo->prepare("UPDATE users SET num_requests = (num_requests + 1) WHERE id = :user_id");\n    $stmtUpdateActivity = $pdo->prepare("UPDATE users SET last_activity = NOW() WHERE id = :user_id");\n\n    // Execute the prepared statements\n    $userId = 4;\n    $description = 'This dont worth anything';\n\n    $stmtInsert->execute([':user_id' => $userId, ':description' => $description]);\n    $stmtUpdateRequests->execute([':user_id' => $userId]);\n\n    // Simulating an error condition\n    if (/* some condition */) {\n        throw new Exception("Something went wrong, rolling back.");\n    }\n\n    // Commit the transaction\n    $pdo->commit();\n} catch (Exception $e) {\n    // Rollback the transaction on error\n    $pdo->rollBack();\n    echo "Failed: " . $e->getMessage();\n}\n\n// Update last_activity outside the transaction\n$stmtUpdateActivity->execute([':user_id' => $userId]);\n?>