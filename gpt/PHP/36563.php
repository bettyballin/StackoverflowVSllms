class PremiumSitesController extends AppController {\n    var $name = 'PremiumSites';\n\n    function index() {\n        $cost = 5;\n\n        if (!empty($this->request->data)) {\n            $this->request->data['PremiumSite'] = $this->PremiumSite->prepareData($this->request->data['PremiumSite'], $cost);\n\n            $this->PremiumSite->create();\n            if ($this->PremiumSite->save($this->request->data)) {\n                $this->redirect(array('controller' => 'paypal_notifications', 'action' => 'send', $this->PremiumSite->getLastInsertID()));\n            } else {\n                $this->Session->setFlash('Please fix the problems below', 'default', array('class' => 'error'));\n            }\n        }\n\n        $this->set('sites', $this->PremiumSite->Site->find('list', array(\n            'conditions' => array(\n                'User.id' => $this->Auth->user('id'),\n                'Site.is_deleted' => 0\n            ),\n            'recursive' => 0\n        )));\n    }\n}