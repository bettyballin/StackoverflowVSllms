<?php\n$textlines = [\n    ['text' => 'This is some text', 'color' => '666666'],\n    ['text' => 'to be an image', 'color' => 'ff0000'],\n    ['text' => 'with multiple lines', 'color' => '0000ff']\n];\n\n$font = "arial.ttf";\n$size = 9;\n$padding = 10;\n$bgcolor = "ffffff";\n\n$fontfile = $font;\n$line_height = $size + 5; // Adjust as needed\n\n// Calculate total height and width\n$width = 0;\n$total_height = 0;\nforeach ($textlines as $line) {\n    $box = imageftbbox($size, 0, $fontfile, $line['text']);\n    $line_width = abs($box[4] - $box[0]);\n    $line_height = abs($box[5] - $box[1]);\n    if ($line_width > $width) {\n        $width = $line_width;\n    }\n    $total_height += $line_height + $padding;\n}\n$width += $padding * 2;\n$total_height += $padding;\n\n// Create the image\n$png = imagecreate($width, $total_height);\n\n// Set background color\n$bg_color = sscanf($bgcolor, "%02x%02x%02x");\n$bg = imagecolorallocate($png, $bg_color[0], $bg_color[1], $bg_color[2]);\n\n// Draw each line of text\n$y = $padding;\nforeach ($textlines as $line) {\n    $color = sscanf($line['color'], "%02x%02x%02x");\n    $tx = imagecolorallocate($png, $color[0], $color[1], $color[2]);\n    $box = imageftbbox($size, 0, $fontfile, $line['text']);\n    $textx = $padding;\n    $texty = $y + abs($box[5]);\n    imagettftext($png, $size, 0, $textx, $texty, $tx, $fontfile, $line['text']);\n    $y += $line_height + $padding;\n}\n\n// Output the image\nheader("Content-Type: image/jpeg");\nimagejpeg($png);\nimagedestroy($png);\nexit;\n?>