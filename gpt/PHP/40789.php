function CreatePageIndex($ItemsPerPage, $TotalNumberOfItems, $CurrentOffset, $URL, $URLArguments = array())\n{\n    foreach($URLArguments as $Key => $Value)\n    {\n        if(!isset($FirstIndexDone))\n        {\n            $URL .= sprintf("?%s=%s", $Key, $Value);\n            $FirstIndexDone = true;\n        }\n        else\n        {\n            $URL .= sprintf("&%s=%s", $Key, $Value);\n        }\n    }\n\n    $NumberOfPages = ceil($TotalNumberOfItems / $ItemsPerPage);\n    $CurrentPage = $CurrentOffset / $ItemsPerPage + 1;\n    $StartPage = max(1, $CurrentPage - 5);\n    $EndPage = min($NumberOfPages, $CurrentPage + 5);\n\n    Print("<div id=\"ResultsNavigation\">");\n    Print("Page: ");\n    Print("<span class=\"Links\">");\n\n    if ($CurrentPage > 6) {\n        Print("<a href=\"".$URL."&Offset=0\"><<</a> ");\n    }\n\n    for($x = $StartPage; $x <= $EndPage; $x++)\n    {\n        if($x == $CurrentPage)\n        {\n            Print("<span class=\"Selected\">".($x)." </span>");\n        }\n        else\n        {\n            $pageOffset = ($x - 1) * $ItemsPerPage;\n            Print("<a href=\"".$URL."&Offset=".$pageOffset."\">".($x)."</a> ");\n        }\n    }\n\n    if ($EndPage < $NumberOfPages) {\n        $lastPageOffset = ($NumberOfPages - 1) * $ItemsPerPage;\n        Print("<a href=\"".$URL."&Offset=".$lastPageOffset."\">>></a>");\n    }\n\n    Print("</span>");\n    Print(" (".$TotalNumberOfItems." results)");\n    Print("</div>");\n}