<?php\n// video.php\nsession_start();\n\n// Function to check if the user is logged in and has access\nfunction checkUserAccess($userId) {\n    // Implement your user validation logic here\n    // For example, you can check the session or a database to validate the user\n    return isset($_SESSION['user_id']) && $_SESSION['user_id'] == $userId;\n}\n\nif (isset($_GET['userId']) && isset($_GET['video'])) {\n    $userId = $_GET['userId'];\n    $video = basename($_GET['video']); // Prevent path traversal\n\n    if (checkUserAccess($userId)) {\n        $filePath = '/path/to/your/secure/video/directory/' . $video;\n\n        if (file_exists($filePath)) {\n            header('Content-Type: video/x-flv');\n            header('Content-Length: ' . filesize($filePath));\n            header('Content-Disposition: inline; filename="' . $video . '"');\n            readfile($filePath);\n            exit;\n        } else {\n            http_response_code(404);\n            echo "File not found.";\n        }\n    } else {\n        http_response_code(403);\n        echo "Access denied.";\n    }\n} else {\n    http_response_code(400);\n    echo "Invalid request.";\n}\n?>