$XMLData = rc4crypt::decrypt($key, urldecode($_POST["XMLData"]));\n$data = new XMLParser($XMLData);   // Parse that XML.\n$data->Parse();\n\n// go through each of the nodes\nforeach ($data->document->transactions[0]->transaction as $tx) {\n\n    $id = $tx->id[0]->tagData;\n    $store_id = $tx->store_id[0]->tagData;\n\n    // Check if custom_fields and custom_field exist\n    if (isset($tx->custom_fields[0]->custom_field)) {\n        // get the affiliateID\n        foreach ($tx->custom_fields[0]->custom_field as $field) {\n            $affiliateID = $field->custom_field_value[0]->tagData;\n            // You can do something with $affiliateID here\n        }\n    }\n\n}