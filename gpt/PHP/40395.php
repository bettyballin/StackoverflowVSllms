protected function getChar() {\n    $char = fgetc($this->_socket);\n    return $char;\n}\n\npublic function readFromSocket() {\n    // Set a reasonable timeout for reading from the socket\n    stream_set_timeout($this->_socket, 2); // 2 seconds timeout\n\n    $data = '';\n    while (true) {\n        $char = $this->getChar();\n        if ($char === false) {\n            // Check if the socket has timed out or if it's the end of the stream\n            $info = stream_get_meta_data($this->_socket);\n            if ($info['timed_out']) {\n                break; // Exit the loop on timeout\n            }\n            if ($info['eof']) {\n                break; // Exit the loop on end of file\n            }\n        } else {\n            $data .= $char;\n        }\n    }\n\n    return $data;\n}