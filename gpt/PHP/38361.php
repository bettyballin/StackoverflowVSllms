// src/Security/AuthenticationSuccessHandler.php\n\nnamespace App\Security;\n\nuse Symfony\Component\HttpFoundation\Request;\nuse Symfony\Component\HttpFoundation\RedirectResponse;\nuse Symfony\Component\Routing\RouterInterface;\nuse Symfony\Component\Security\Http\Authentication\AuthenticationSuccessHandlerInterface;\nuse Symfony\Component\Security\Core\Authentication\Token\TokenInterface;\n\nclass AuthenticationSuccessHandler implements AuthenticationSuccessHandlerInterface\n{\n    private $router;\n\n    public function __construct(RouterInterface $router)\n    {\n        $this->router = $router;\n    }\n\n    public function onAuthenticationSuccess(Request $request, TokenInterface $token)\n    {\n        $targetPath = $request->getSession()->get('_security.main.target_path');\n\n        if (!$targetPath) {\n            $targetPath = $this->router->generate('homepage');\n        }\n\n        return new RedirectResponse($targetPath);\n    }\n}