$buf = 'your_hex_encoded_data_here'; // Replace with your actual data\n\n// Convert hex string to binary data\n$decrypthex = hex2bin($buf);\n\n// Get the length of the ticket excluding the last 20 bytes (SHA1 hash)\n$ticketLn = strlen($decrypthex) - 20;\n\n// Grab all but the last 20 bytes\n$ticket = substr($decrypthex, 0, $ticketLn);\n\n// Grab the last 20 bytes (the SHA1 hash)\n$hash = substr($decrypthex, $ticketLn, 20);\n\n// Create a SHA1 hash of the ticket (binary output)\n$calculatedHash = sha1($ticket, true); // true for raw output\n\n// Compare the calculated hash with the extracted hash\nif (hash_equals($calculatedHash, $hash)) {\n    echo "Hashes match.";\n} else {\n    echo "Hashes do not match.";\n}