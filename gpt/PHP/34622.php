<?php\n$servername = "localhost";\n$username = "username";\n$password = "password";\n$dbname = "database";\n\n// Create connection\n$conn = new mysqli($servername, $username, $password, $dbname);\n\n// Check connection\nif ($conn->connect_error) {\n    die("Connection failed: " . $conn->connect_error);\n}\n\n$product_name = 'DELL';\n$target_quantity = 35;\n\n// Retrieve the data\n$sql = "SELECT price, quantity FROM \n        (SELECT price, quantity FROM quantity WHERE product_name = '$product_name' ORDER BY date DESC, position) AS Actions \n        GROUP BY price";\n$result = $conn->query($sql);\n\nif ($result->num_rows > 0) {\n    $total_quantity = 0;\n    $update_queries = [];\n\n    while($row = $result->fetch_assoc()) {\n        $price = $row['price'];\n        $quantity = $row['quantity'];\n\n        if ($total_quantity + $quantity >= $target_quantity) {\n            $remaining_quantity = $total_quantity + $quantity - $target_quantity;\n            $update_queries[] = "UPDATE quantity SET quantity = $remaining_quantity WHERE product_name = '$product_name' AND price = $price";\n            break;\n        } else {\n            $update_queries[] = "UPDATE quantity SET quantity = 0 WHERE product_name = '$product_name' AND price = $price";\n            $total_quantity += $quantity;\n        }\n    }\n\n    // Execute the update queries\n    foreach ($update_queries as $query) {\n        if ($conn->query($query) === TRUE) {\n            echo "Record updated successfully\n";\n        } else {\n            echo "Error updating record: " . $conn->error;\n        }\n    }\n} else {\n    echo "0 results";\n}\n\n$conn->close();\n?>