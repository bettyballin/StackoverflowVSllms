$mgr->setUploadUrl('http://www.imageshack.us/index.php');\n\n$fileImagePath = $row['cr_path'];\n\necho $fileImagePath . '<br><br>';\n\n$res = $mgr->upload($row['cr_path'], 'image/jpeg', 'avaojo');\n\n$newImagePath = explode(' ', $res);\n\n// Extract the URL safely\n$shackPath = trim(strip_tags($newImagePath[6]));\n\necho '>>>' . $shackPath . '<<<'; // Outputs >>>http://img194.imageshack.us/img194/5038/9444679.jpg<<<\n\n// Properly escaping the input to prevent SQL injection\n$shackPath = mysqli_real_escape_string($conn, $shackPath);\n$sql = "UPDATE avatar SET image_path = '$shackPath' WHERE avatar_id =" . (int)$row['cr_id'];\n\n// Execute the query securely\nif (mysqli_query($conn, $sql)) {\n    echo "Record updated successfully";\n} else {\n    echo "Error updating record: " . mysqli_error($conn);\n}