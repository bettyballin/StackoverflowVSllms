<?php\nfunction isAccountLocked($username, $ldapConnection) {\n    $baseDn = "DC=example,DC=com"; // Adjust this to your base DN\n    $filter = "(sAMAccountName=$username)";\n    $attributes = ["userAccountControl"];\n\n    // Search for the user in the directory\n    $searchResult = ldap_search($ldapConnection, $baseDn, $filter, $attributes);\n    if (!$searchResult) {\n        return false;\n    }\n\n    // Get the entries from the search result\n    $entries = ldap_get_entries($ldapConnection, $searchResult);\n    if ($entries["count"] > 0) {\n        $userAccountControl = $entries[0]["useraccountcontrol"][0];\n        \n        // Check if the ACCOUNTDISABLE bit is set\n        if (($userAccountControl & 0x0002) != 0) {\n            return true; // Account is locked\n        }\n    }\n\n    return false; // Account is not locked\n}\n\n// LDAP connection details\n$ldapServer = "ldap://your.ldap.server";\n$ldapUser = "cn=admin,dc=example,dc=com"; // LDAP bind user\n$ldapPassword = "password"; // LDAP bind password\n\n// Connect to LDAP server\n$ldapConnection = ldap_connect($ldapServer);\nldap_set_option($ldapConnection, LDAP_OPT_PROTOCOL_VERSION, 3);\nldap_bind($ldapConnection, $ldapUser, $ldapPassword);\n\n// Check if a specific user's account is locked\n$username = "jdoe"; // The username to check\nif (isAccountLocked($username, $ldapConnection)) {\n    echo "The user account is locked. Please contact IT.";\n} else {\n    echo "The user account is not locked.";\n}\n\n// Close the LDAP connection\nldap_unbind($ldapConnection);\n?>