<?php\n\nclass DynamicSheet {\n    private $pdo;\n\n    public function __construct($dsn, $username, $password) {\n        $this->pdo = new PDO($dsn, $username, $password);\n    }\n\n    public function createSheet($sheetName) {\n        $stmt = $this->pdo->prepare("INSERT INTO sheets (sheet_name) VALUES (:sheet_name)");\n        $stmt->execute([':sheet_name' => $sheetName]);\n        return $this->pdo->lastInsertId();\n    }\n\n    public function addRow($sheetId, $rowName) {\n        $stmt = $this->pdo->prepare("INSERT INTO rows (sheet_id, row_name) VALUES (:sheet_id, :row_name)");\n        $stmt->execute([':sheet_id' => $sheetId, ':row_name' => $rowName]);\n        return $this->pdo->lastInsertId();\n    }\n\n    public function addCell($rowId, $colName, $value) {\n        $stmt = $this->pdo->prepare("INSERT INTO cells (row_id, col_name, value) VALUES (:row_id, :col_name, :value)");\n        $stmt->execute([':row_id' => $rowId, ':col_name' => $colName, ':value' => $value]);\n    }\n\n    public function getCell($colName, $rowName, $sheetName) {\n        $stmt = $this->pdo->prepare("\n            SELECT c.value \n            FROM cells c\n            JOIN rows r ON c.row_id = r.row_id\n            JOIN sheets s ON r.sheet_id = s.sheet_id\n            WHERE s.sheet_name = :sheet_name AND r.row_name = :row_name AND c.col_name = :col_name\n        ");\n        $stmt->execute([\n            ':sheet_name' => $sheetName,\n            ':row_name' => $rowName,\n            ':col_name' => $colName\n        ]);\n        return $stmt->fetchColumn();\n    }\n}\n\n// Example usage\n$dsn = 'mysql:host=localhost;dbname=your_database';\n$username = 'your_username';\n$password = 'your_password';\n\n$sheet = new DynamicSheet($dsn, $username, $password);\n$sheetId = $sheet->createSheet('Price List');\n$rowIdA = $sheet->addRow($sheetId, 'model A');\n$rowIdB = $sheet->addRow($sheetId, 'model B');\n$rowIdC = $sheet->addRow($sheetId, 'model C');\n\n$sheet->addCell($rowIdA, '1', '2$');\n$sheet->addCell($rowIdA, '2', '5$');\n$sheet->addCell($rowIdA, '3', '8$');\n$sheet->addCell($rowIdA, '4', '10$');\n\n$sheet->addCell($rowIdB, '1', '3$');\n$sheet->addCell($rowIdB, '2', '6$');\n$sheet->addCell($rowIdB, '3', '9$');\n$sheet->addCell($rowIdB, '4', '12$');\n\n$sheet->addCell($rowIdC, '1', '4$');\n$sheet->addCell($rowIdC, '2', '8$');\n$sheet->addCell($rowIdC, '3', '10$');\n$sheet->addCell($rowIdC, '4', '13$');\n\n$price = $sheet->getCell('3', 'model B', 'Price List');\necho $price; // Prints '9$'\n?>