require 'vendor/autoload.php'; // Assuming you're using Composer\n\n// Step 1: Set up the Microsoft Client\n$client = new Microsoft_Client();\n$client->setClientId('YOUR_MICROSOFT_CLIENT_ID');\n$client->setClientSecret('YOUR_MICROSOFT_CLIENT_SECRET');\n$client->setRedirectUri('YOUR_REDIRECT_URI');\n$client->setScopes(["Contacts.Read"]);\n\n// Step 2: Authenticate and get the OAuth2 token\nif (!isset($_GET['code'])) {\n    $authUrl = $client->getAuthorizationUrl();\n    header('Location: ' . filter_var($authUrl, FILTER_SANITIZE_URL));\n} else {\n    $token = $client->getAccessToken($_GET['code']);\n\n    // Step 3: Use the Outlook API to get contacts\n    $contacts = $client->getContacts($token);\n\n    foreach ($contacts as $contact) {\n        echo $contact['givenName'] . " " . $contact['surname'] . " - " . $contact['emailAddresses'][0]['address'] . "<br>";\n    }\n}