<?php\nsession_start();\n\nif ($_SERVER['REQUEST_METHOD'] === 'POST') {\n    if (!empty($_POST['token']) && hash_equals($_SESSION['token'], $_POST['token'])) {\n        // Valid request, proceed with form processing\n        unset($_SESSION['token']); // Invalidate the token after successful submission\n\n        // Your form processing logic here\n\n        echo "Form submitted successfully.";\n    } else {\n        // Invalid request, handle the error\n        echo "Invalid CSRF token.";\n    }\n} else {\n    echo "Invalid request method.";\n}\n?>