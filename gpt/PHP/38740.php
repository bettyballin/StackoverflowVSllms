// In CodeIgniter Middleware\n        use Firebase\JWT\JWT;\n\n        class AuthMiddleware {\n            public function handle($request, Closure $next) {\n                $token = $request->header('Authorization');\n                if ($token) {\n                    try {\n                        $credentials = JWT::decode($token, env('JWT_SECRET'), ['HS256']);\n                        $request->user = User::find($credentials->sub);\n                    } catch (\Exception $e) {\n                        return response()->json(['error' => 'Invalid Token'], 401);\n                    }\n                } else {\n                    return response()->json(['error' => 'Token not provided'], 401);\n                }\n                return $next($request);\n            }\n        }