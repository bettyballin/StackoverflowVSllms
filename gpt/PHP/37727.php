// Perform a single query to fetch all necessary data\n$rows = query(\n    "SELECT key, string_data, numeric_data\n     FROM table"\n);\n\n$aggregate_data = [];\n$row_by_row_data = [];\n\n// Process the data and calculate aggregates\nforeach ($rows as $row) {\n    $key = $row['key'];\n\n    // Aggregate data\n    if (!isset($aggregate_data[$key])) {\n        $aggregate_data[$key] = 0;\n    }\n    $aggregate_data[$key] += $row['numeric_data'];\n\n    // Collect row-by-row data\n    if (!isset($row_by_row_data[$key])) {\n        $row_by_row_data[$key] = [];\n    }\n    $row_by_row_data[$key][] = $row['string_data'];\n}\n\n// Process aggregate data\nforeach ($aggregate_data as $key => $sum) {\n    // Process aggregated data\n    echo "Key: $key, Sum: $sum\n";\n}\n\n// Process row-by-row data\nforeach ($row_by_row_data as $key => $rows) {\n    // Process individual rows for each key\n    foreach ($rows as $string_data) {\n        echo "Key: $key, String Data: $string_data\n";\n    }\n}