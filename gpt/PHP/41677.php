// Reading the file as GD image data\n$imagedata = imagecreatefrompng($imagefile);\n\n// Do some GD processing: Adding watermarks etc. No problem here...\n\n// Start output buffering\nob_start();\n\n// Output the image to the buffer\nimagepng($imagedata);\n\n// Get the image data from the buffer as a string\n$stringdata = ob_get_clean();\n\n// Compressing the string data\n$zdata = gzdeflate($stringdata);\n\n// Don't forget to destroy the image resource to free memory\nimagedestroy($imagedata);