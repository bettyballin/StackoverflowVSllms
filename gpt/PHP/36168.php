$query = "\nSELECT \n  p.p_pid, \n  p.p_name, \n  p.p_url \nFROM \n  products p \n  JOIN (\n    SELECT \n      a.a_pid, \n      MAX(a.a_time) AS latest_time \n    FROM \n      activity a \n    WHERE \n      a.a_uid = ".$uid_int." \n      AND a.a_pid > 0 \n    GROUP BY \n      a.a_pid\n  ) latest_activity ON p.p_pid = latest_activity.a_pid \nORDER BY \n  latest_activity.latest_time DESC \nLIMIT 6\n";