<?php\nrequire 'path/to/PHPExcel.php';\n\n// Step 1: Query the database and store data in a multidimensional array\n$mysqli = new mysqli("localhost", "username", "password", "database");\nif ($mysqli->connect_errno) {\n    echo "Failed to connect to MySQL: " . $mysqli->connect_error;\n    exit();\n}\n\n$data = [];\n$query = "SELECT * FROM your_table";\nif ($result = $mysqli->query($query)) {\n    while ($row = $result->fetch_assoc()) {\n        $data[] = $row;\n    }\n    $result->free();\n}\n$mysqli->close();\n\n// Step 2: Create the PHPExcel object and populate sheets\n$objPHPExcel = new PHPExcel();\n$objPHPExcel->setActiveSheetIndex(0);\n\nforeach ($data as $rowIndex => $rowData) {\n    $sheet = $objPHPExcel->getActiveSheet();\n\n    // Populate data\n    $colIndex = 0;\n    foreach ($rowData as $cellData) {\n        $sheet->setCellValueByColumnAndRow($colIndex, $rowIndex + 1, $cellData);\n        $colIndex++;\n    }\n\n    // Apply styles and formulas as needed\n    // Example: Apply bold style to the first row\n    if ($rowIndex == 0) {\n        $sheet->getStyle("A1:Z1")->getFont()->setBold(true);\n    }\n}\n\n// Save the Excel file\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');\n$objWriter->save('path/to/save/yourfile.xlsx');\n\necho "Excel file has been generated successfully.";\n?>