<?php\n\nclass Enc\n{\n    const CIPHER = 'aes-128-cbc';\n    const IV = '0123456789abcdef';\n\n    function encrypt($str, $key) {\n        $key = $this->hex2bin($key);\n        $iv = self::IV;\n\n        $encrypted = openssl_encrypt($str, self::CIPHER, $key, OPENSSL_RAW_DATA, $iv);\n        \n        return bin2hex($encrypted);\n    }\n\n    function decrypt($code, $key) {\n        $key = $this->hex2bin($key);\n        $code = $this->hex2bin($code);\n        $iv = self::IV;\n\n        $decrypted = openssl_decrypt($code, self::CIPHER, $key, OPENSSL_RAW_DATA, $iv);\n\n        return utf8_encode(trim($decrypted));\n    }\n\n    function hex2bin($hexdata) {\n        return pack("H*", $hexdata);\n    }\n\n}\n\n$theEncryption = new Enc();\n$user = "John Doe";\n$email = "john@example.com";\n$userEncrypted = $theEncryption->encrypt($user, "0123456789abcdef");\n$emailEncrypted = $theEncryption->encrypt($email, "0123456789abcdef");\n\necho 'User: ' . $userEncrypted . "<br>";\necho 'Email: ' . $emailEncrypted . "<br>";\n\n$userDecrypted = $theEncryption->decrypt($userEncrypted, "0123456789abcdef");\n$emailDecrypted = $theEncryption->decrypt($emailEncrypted, "0123456789abcdef");\n\necho 'Decrypted User: ' . $userDecrypted . "<br>";\necho 'Decrypted Email: ' . $emailDecrypted . "<br>";\n\n?>