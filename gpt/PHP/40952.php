// auth.domain.com/login.php\nsession_start();\n\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    // Authenticate user\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    // Assume a function authenticate_user() that returns true if credentials are valid\n    if (authenticate_user($username, $password)) {\n        $_SESSION['user'] = $username;\n\n        // Generate a token\n        $token = bin2hex(random_bytes(16));\n        $_SESSION['token'] = $token;\n\n        // Store the token in a database or cache associated with the user session\n        // ...\n\n        // Redirect back to the originating domain with the token\n        $redirect_url = $_SESSION['redirect_url'];\n        header("Location: $redirect_url?token=$token");\n        exit;\n    } else {\n        echo "Invalid credentials";\n    }\n} else {\n    // Show login form\n    echo '<form method="post" action="">\n            Username: <input type="text" name="username"><br>\n            Password: <input type="password" name="password"><br>\n            <input type="submit" value="Login">\n          </form>';\n}