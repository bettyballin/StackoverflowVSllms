<?php\nsession_start();\n\nif ($_SERVER['REQUEST_METHOD'] === 'POST') {\n    // Authenticate user (e.g., check username and password)\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n    \n    // Assume authentication is successful\n    $_SESSION['authenticated'] = true;\n    $_SESSION['username'] = $username;\n    \n    // Generate a token (for simplicity, using a session ID)\n    $token = session_id();\n    \n    // Redirect back to the original domain with the token\n    $redirect_url = $_POST['redirect_url'];\n    header("Location: $redirect_url?token=$token");\n    exit();\n}\n\n// Display login form if not authenticated\nif (!isset($_SESSION['authenticated'])) {\n    echo '<form method="POST" action="auth-server.php">\n            <input type="hidden" name="redirect_url" value="' . htmlspecialchars($_GET['redirect_url']) . '">\n            <input type="text" name="username" placeholder="Username">\n            <input type="password" name="password" placeholder="Password">\n            <input type="submit" value="Login">\n          </form>';\n    exit();\n}\n?>