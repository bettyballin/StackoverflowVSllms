<?php\n// start session and include your authentication logic here\nsession_start();\n\nfunction isAuthenticated() {\n    // Replace this with your actual authentication check\n    return isset($_SESSION['user_id']);\n}\n\nif (!isAuthenticated()) {\n    header('HTTP/1.0 403 Forbidden');\n    echo 'You are forbidden!';\n    exit;\n}\n\n$baseDir = '/var/www/private_files/';\n$file = basename($_GET['file']); // sanitize the input to avoid security risks\n$path = $baseDir . $file;\n\nif (file_exists($path)) {\n    // Set headers to force download\n    header('Content-Description: File Transfer');\n    header('Content-Type: application/octet-stream');\n    header('Content-Disposition: attachment; filename=' . basename($path));\n    header('Expires: 0');\n    header('Cache-Control: must-revalidate');\n    header('Pragma: public');\n    header('Content-Length: ' . filesize($path));\n    readfile($path);\n    exit;\n} else {\n    header('HTTP/1.0 404 Not Found');\n    echo 'File not found!';\n    exit;\n}\n?>