// Assuming you have a valid Zend_Db_Adapter instance in $db\n$db = Zend_Db::factory($adapter, $config);\n\n// Create the first subquery\n$subquery1 = $db->select()\n    ->from(\n        ['tbl_energy'],\n        [\n            'energy_produced' => new Zend_Db_Expr('MAX(energy_produced)'),\n            'timestamp1' => new Zend_Db_Expr('MID(timestamp, 1, 10)')\n        ]\n    )\n    ->where('site_id = ?', 1366)\n    ->where(new Zend_Db_Expr('MID(timestamp, 1, 10) >= DATE_SUB(CURDATE(), INTERVAL 1 DAY)'))\n    ->group(new Zend_Db_Expr('MID(timestamp, 1, 10)'));\n\n// Create the second subquery\n$subquery2 = $db->select()\n    ->from(\n        ['tbl_energy'],\n        [\n            'energy_consumed' => new Zend_Db_Expr('MAX(energy_consumed)'),\n            'timestamp2' => new Zend_Db_Expr('MID(timestamp, 1, 10)')\n        ]\n    )\n    ->where('site_id = ?', 1366)\n    ->where(new Zend_Db_Expr('MID(timestamp, 1, 10) >= DATE_SUB(CURDATE(), INTERVAL 1 DAY)'))\n    ->group(new Zend_Db_Expr('MID(timestamp, 1, 10)'));\n\n// Combine the subqueries into the main query\n$select = $db->select()\n    ->from(\n        ['e1' => $subquery1],\n        [\n            'energy_produced',\n            'energy_consumed',\n            'timestamp' => 'timestamp1'\n        ]\n    )\n    ->joinInner(\n        ['e2' => $subquery2],\n        'e1.timestamp1 = e2.timestamp2',\n        []\n    );\n\n// Fetch the results\n$results = $db->fetchAll($select)->toArray();\n\n// Output the results\nprint_r($results);