// src/Shell/WorkerShell.php\nnamespace App\Shell;\n\nuse Cake\Console\Shell;\nuse Pheanstalk\Pheanstalk;\n\nclass WorkerShell extends Shell\n{\n    public function main()\n    {\n        $pheanstalk = Pheanstalk::create('127.0.0.1');\n\n        while (true) {\n            $job = $pheanstalk->watch('my_queue')->ignore('default')->reserve();\n\n            if ($job) {\n                $data = json_decode($job->getData(), true);\n                $this->out('Processing job: ' . $data['task']);\n\n                // Perform the task, e.g., call a CakePHP Task\n                $this->Tasks->{$data['task']}->execute($data['params']);\n\n                // Delete the job after processing\n                $pheanstalk->delete($job);\n            }\n        }\n    }\n}