<?php\nrequire 'vendor/autoload.php';\n\nuse PhpAmqpLib\Connection\AMQPStreamConnection;\nuse PhpAmqpLib\Message\AMQPMessage;\n\nfunction enqueueEmail($recipient, $subject, $body)\n{\n    $connection = new AMQPStreamConnection('localhost', 5672, 'guest', 'guest');\n    $channel = $connection->channel();\n    $channel->queue_declare('email_queue', false, true, false, false);\n\n    $data = json_encode(['recipient' => $recipient, 'subject' => $subject, 'body' => $body]);\n    $msg = new AMQPMessage($data, ['delivery_mode' => AMQPMessage::DELIVERY_MODE_PERSISTENT]);\n\n    $channel->basic_publish($msg, '', 'email_queue');\n    \n    $channel->close();\n    $connection->close();\n}