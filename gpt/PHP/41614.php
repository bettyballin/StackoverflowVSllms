$fileName = "../js/ajaxupload/tees/" . $fileName;\n\nlist($width, $height) = getimagesize($fileName);\n\n$newwidth = 257;\n$newheight = 197;\n\n$thumb = imagecreatetruecolor($newwidth, $newheight);\n\n// Ensure the thumbnail preserves transparency\nimagealphablending($thumb, false);\nimagesavealpha($thumb, true);\n\n$source = imagecreatefrompng($fileName);\n\n// Ensure the source image preserves transparency\nimagealphablending($source, true);\nimagesavealpha($source, true);\n\n// Resize the image\nimagecopyresampled($thumb, $source, 0, 0, 0, 0, $newwidth, $newheight, $width, $height);\n\n// Save the thumbnail as a PNG with transparency\nimagepng($thumb, $newFilename);\n\n// Free up memory\nimagedestroy($thumb);\nimagedestroy($source);