<?php\nsession_start();\n\n$server2 = explode(":", $xfr[3]);\n$_SESSION['server_address'] = $server2[0];\n$_SESSION['server_port'] = (int)$server2[1];\n\n$socket2 = pfsockopen($_SESSION['server_address'], $_SESSION['server_port']);\nif (!$socket2) {\n    die('Could not connect to server');\n}\n\n$_SESSION['username'] = $_POST['username'];\n$_SESSION['socket'] = $socket2;\n\necho '<b>Connected to 2nd server.</b><br />';\n\n// Send MSNP version\nfputs($socket2, "VER 0 MSNP10 CVR0\r\n");\necho fread($socket2, 5000) . '<br />';\n\n// Send user-agent\nfputs($socket2, "CVR 1 0x0409 php " . phpversion() . " i386 MSNMSGR 7.0.0000 MSMSGS " . $_SESSION['username'] . "\r\n");\necho fread($socket2, 5000) . '<br />';\n\n// Send username\nfputs($socket2, "USR 2 TWN I " . $_SESSION['username'] . "\r\n");\n\n// Read USR\n$usr = fread($socket2, 5000);\necho $usr . '<br />';\n$_SESSION['usr'] = $usr; // This can be useful later\n?>