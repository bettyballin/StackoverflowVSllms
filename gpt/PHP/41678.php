<?php\n// Set internal encoding to UTF-8\nmb_internal_encoding('UTF-8');\n\n// Set up database connection\n$serverName = "your_server_name";\n$connectionOptions = array(\n    "Database" => "your_database_name",\n    "Uid" => "your_username",\n    "PWD" => "your_password",\n    "CharacterSet" => "UTF-8"  // Ensure the connection uses UTF-8\n);\n$conn = sqlsrv_connect($serverName, $connectionOptions);\n\nif ($conn === false) {\n    die(print_r(sqlsrv_errors(), true));\n}\n\n// Query the database\n$sql = "SELECT CONVERT(varchar, column_name) AS column_name FROM your_table"; // Adjust this according to your query\n$stmt = sqlsrv_query($conn, $sql);\n\nif ($stmt === false) {\n    die(print_r(sqlsrv_errors(), true));\n}\n\n// Fetch and process results\n$results = [];\nwhile ($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)) {\n    $results[] = $row;\n}\n\n// Convert results to UTF-8\nforeach ($results as &$result) {\n    foreach ($result as &$value) {\n        $value = mb_convert_encoding($value, 'UTF-8', 'auto');\n    }\n}\n\n// Send mail (ensure mail headers are set to UTF-8)\n$to = 'recipient@example.com';\n$subject = 'Your Subject';\n$headers = "MIME-Version: 1.0" . "\r\n";\n$headers .= "Content-type:text/html;charset=UTF-8" . "\r\n";\n$headers .= 'From: <webmaster@example.com>' . "\r\n";\n\n$message = "<html><body>";\nforeach ($results as $result) {\n    $message .= "<p>" . htmlentities($result['column_name'], ENT_QUOTES, 'UTF-8') . "</p>";\n}\n$message .= "</body></html>";\n\nmail($to, $subject, $message, $headers);\n\n// Close the connection\nsqlsrv_close($conn);\n?>