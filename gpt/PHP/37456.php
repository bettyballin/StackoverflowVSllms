session_start();\n\nfunction isValidToken($token, $document) {\n    // Implement your token validation logic here\n    // For example, check if the token is stored in the session or database\n    return isset($_SESSION['tokens'][$document]) && $_SESSION['tokens'][$document] === $token;\n}\n\n$document = $_GET['document'];\n$token = $_GET['token'];\n\nif (isValidToken($token, $document)) {\n    // Serve the document\n    $filePath = "/path/to/uploads/" . $document;\n    header('Content-Type: application/pdf');\n    readfile($filePath);\n    exit;\n} else {\n    // Invalid token, prompt for password\n    header('HTTP/1.0 401 Unauthorized');\n    echo 'Unauthorized';\n    exit;\n}