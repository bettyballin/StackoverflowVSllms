<?php\nsession_start();\n\n// Set the session cookie parameters\n$cookie_lifetime = 0; // Session cookie will be deleted when the browser is closed\nsession_set_cookie_params($cookie_lifetime);\n\n// Set the session max lifetime to 5 minutes (300 seconds)\nini_set('session.gc_maxlifetime', 300);\n\n// Regenerate session ID to prevent session fixation attacks\nsession_regenerate_id(true);\n\n// Check login credentials (assuming you have a function to validate user)\nif (validate_user($username, $password)) {\n    $_SESSION['logged'] = '1';\n    $_SESSION['login_time'] = time(); // Store the login time\n} else {\n    // Handle invalid login\n}\n\n// Later in your code, check if the session is still valid\nif (isset($_SESSION['logged']) && $_SESSION['logged'] == '1') {\n    // Check if the session has expired\n    if (time() - $_SESSION['login_time'] > 300) {\n        // Session has expired\n        session_unset();\n        session_destroy();\n        header("Location: login.php");\n        exit();\n    } else {\n        // Session is still valid\n        // Update login time to keep the session alive\n        $_SESSION['login_time'] = time();\n    }\n} else {\n    // User is not logged in\n    header("Location: login.php");\n    exit();\n}\n?>