<?php\nfunction cleanUpMicrosoftWordHTML($html) {\n    // Use Tidy to clean up the HTML\n    $config = array(\n        'indent' => true,\n        'output-xhtml' => true,\n        'wrap' => 200,\n        'show-body-only' => true,\n        'drop-proprietary-attributes' => true\n    );\n    \n    $tidy = new tidy;\n    $tidy->parseString($html, $config, 'utf8');\n    $tidy->cleanRepair();\n    \n    $cleanedHtml = $tidy->value;\n\n    // Use regex to remove Microsoft specific tags and attributes\n    $patterns = array(\n        // Remove Word comments\n        '/<!--\[if.*?endif\]-->/is',\n        // Remove Word specific classes\n        '/class=(\'|\")?Mso[a-zA-Z]+(\'|\")?/i',\n        // Remove other Word specific attributes\n        '/style=\'(?:mso-|tab-).*?\'/i',\n        // Remove XML namespaces declarations\n        '/xmlns:(o|w)="[^"]+"/',\n        // Remove XML tags\n        '/<\?xml[^>]+>/',\n        // Remove empty spans\n        '/<span[^>]*>(\s|&nbsp;)*<\/span>/i'\n    );\n    \n    foreach ($patterns as $pattern) {\n        $cleanedHtml = preg_replace($pattern, '', $cleanedHtml);\n    }\n\n    return $cleanedHtml;\n}\n\n// Example usage\n$dirtyHtml = '<p class="MsoNormal" style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;">This is <span style="mso-spacerun:yes">&nbsp;</span>Word content with <span style="mso-bidi-font-size:11.0pt">formatting</span>.</p>';\n$cleanHtml = cleanUpMicrosoftWordHTML($dirtyHtml);\necho $cleanHtml;\n?>