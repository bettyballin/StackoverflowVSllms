session_start();\n    // Regenerate session ID to prevent session fixation\n    session_regenerate_id(true);\n\n    // Store the session ID in the database\n    $user_id = $_SESSION['user_id'];\n    $session_id = session_id();\n    $db->query("UPDATE users SET session_id = '$session_id' WHERE id = $user_id");\n\n    // Check if the session ID in the database matches the current session\n    $result = $db->query("SELECT session_id FROM users WHERE id = $user_id");\n    $row = $result->fetch_assoc();\n\n    if ($row['session_id'] !== $session_id) {\n        // If session ID doesn't match, destroy the session\n        session_destroy();\n        header("Location: login.php");\n        exit();\n    }