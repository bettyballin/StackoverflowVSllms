<?php\n\nnamespace App\Http\Middleware;\n\nuse Closure;\nuse Illuminate\Support\Facades\Auth;\n\nclass CheckAuthenticated\n{\n    /**\n     * Handle an incoming request.\n     *\n     * @param  \Illuminate\Http\Request  $request\n     * @param  \Closure  $next\n     * @return mixed\n     */\n    public function handle($request, Closure $next)\n    {\n        if (!Auth::check()) {\n            return redirect('login');\n        }\n\n        return $next($request);\n    }\n}