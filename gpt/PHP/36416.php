<?php\nfunction generateTemporaryUrl($filePath, $validityPeriodInMinutes) {\n    $secretKey = 'your_secret_key'; // Use a strong secret key\n    $expirationTime = time() + ($validityPeriodInMinutes * 60);\n    $token = hash_hmac('sha256', $filePath . $expirationTime, $secretKey);\n    \n    $url = "http://yourdomain.com/download.php?file=" . urlencode($filePath) . "&expires=" . $expirationTime . "&token=" . $token;\n    return $url;\n}