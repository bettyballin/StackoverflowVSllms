foreach($eventfiles as $eventfile) {\n    if($eventfile['filename']) { \n        $file = $eventfile['filepath'];\n        \n        // Define context options if the file is a URL\n        $contextOptions = [\n            "http" => [\n                "follow_location" => 1,\n                "max_redirects" => 10 // Increase this number as needed\n            ]\n        ];\n        $context = stream_context_create($contextOptions);\n\n        // Open File with context\n        if( !($fp = fopen($file, "r", false, $context))) {\n            echo '<br>CAN NOT READ FILE.';\n            exit;\n        }\n\n        // Read data from the file into $data\n        $data = "";\n        while (!feof($fp)) {\n            $data .= fread($fp, 1024);\n        }\n        fclose($fp);\n\n        // Update the database\n        query("update event_rtab set html = '".escape($data)."' where id = {$eventfile['id']}");\n    }\n    if($eventfile['eventType'] == 'email') {\n        query("INSERT INTO event_email_rtab (event_id, subject) values ({$eventfile['id']}, '".escape($eventfile['email_subject'])."')");\n    }\n}