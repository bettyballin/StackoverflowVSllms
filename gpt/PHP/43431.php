<?php\n// Database connection\n$mysqli = new mysqli("hostname", "username", "password", "database");\n\nif ($mysqli->connect_error) {\n    die("Connection failed: " . $mysqli->connect_error);\n}\n\n// Start transaction\n$mysqli->begin_transaction();\n\ntry {\n    // Lock the table or specific row\n    $query = "SELECT * FROM your_table WHERE your_condition FOR UPDATE";\n    $result = $mysqli->query($query);\n\n    // Check if the data exists\n    if ($result->num_rows == 0) {\n        // Data does not exist, proceed with the insert\n        $insertQuery = "INSERT INTO your_table (column1, column2) VALUES ('value1', 'value2')";\n        $mysqli->query($insertQuery);\n    }\n\n    // Commit the transaction\n    $mysqli->commit();\n} catch (Exception $e) {\n    // Rollback the transaction on error\n    $mysqli->rollback();\n    echo "Failed: " . $e->getMessage();\n}\n\n// Close the connection\n$mysqli->close();\n?>