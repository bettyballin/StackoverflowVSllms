<?php\n$baseDir = '/var/www/html'; // Define the base directory you want to allow access to\n\n$f = isset($_GET["f"]) ? $_GET["f"] : '/';\n\n// Resolve the absolute path\n$absolutePath = realpath($baseDir . '/' . $f);\n\nif ($absolutePath === false || strpos($absolutePath, $baseDir) !== 0) {\n    // If the path is not valid or does not start with the base directory, deny access\n    die("Invalid path.");\n}\n\n// Ensure the path is a directory\nif (!is_dir($absolutePath)) {\n    die("Not a directory.");\n}\n\n// Now you can safely open the directory and list its contents\n$dir = opendir($absolutePath);\n\nwhile (($file = readdir($dir)) !== false) {\n    echo htmlspecialchars($file) . "<br>";\n}\n\nclosedir($dir);\n?>