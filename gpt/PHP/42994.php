<?php\n// protected_page.php\nsession_start();\n\n$SECRET_KEY = 'your_secret_key';\n\nfunction isAuthenticated() {\n    if (!isset($_COOKIE['auth_token'])) {\n        return false;\n    }\n\n    $ip_address = $_SERVER['REMOTE_ADDR'];\n    $token = hash('sha256', $ip_address . $SECRET_KEY);\n\n    return $_COOKIE['auth_token'] === $token;\n}\n\nif (!isAuthenticated()) {\n    header('Location: login.php');\n    exit();\n}\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Protected Page</title>\n</head>\n<body>\n    <h1>Welcome to the protected page!</h1>\n</body>\n</html>