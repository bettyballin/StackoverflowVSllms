$img = imagecreatefromgif("./unit.gif");\n\n$size_x = imagesx($img);\n$size_y = imagesy($img);\n\n$temp = imagecreatetruecolor($size_x, $size_y);\n\n// Preserve transparency\n$transparencyIndex = imagecolortransparent($img);\n\nif ($transparencyIndex >= 0) {\n    $transparentColor = imagecolorsforindex($img, $transparencyIndex);\n    $transparencyIndex = imagecolorallocate($temp, $transparentColor['red'], $transparentColor['green'], $transparentColor['blue']);\n    imagefill($temp, 0, 0, $transparencyIndex);\n    imagecolortransparent($temp, $transparencyIndex);\n} else {\n    imagefill($temp, 0, 0, imagecolorallocate($temp, 0, 0, 0));\n}\n\nimagealphablending($temp, false);\nimagesavealpha($temp, true);\n\n// Flip the image horizontally\nfor ($x = 0; $x < $size_x; $x++) {\n    imagecopy($temp, $img, $size_x - $x - 1, 0, $x, 0, 1, $size_y);\n}\n\nheader("Content-type: image/gif");\nimagegif($temp);\nimagedestroy($img);\nimagedestroy($temp);