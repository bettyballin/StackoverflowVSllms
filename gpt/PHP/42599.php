<?php\n\nclass FlatFileDB {\n    private $dataDir;\n\n    public function __construct($dataDir) {\n        $this->dataDir = rtrim($dataDir, '/') . '/';\n        if (!is_dir($this->dataDir)) {\n            mkdir($this->dataDir, 0777, true);\n        }\n    }\n\n    public function insert($collection, $data) {\n        $filePath = $this->dataDir . $collection . '.json';\n        $currentData = $this->readFile($filePath);\n        $currentData[] = $data;\n        $this->writeFile($filePath, $currentData);\n    }\n\n    public function find($collection, $criteria = []) {\n        $filePath = $this->dataDir . $collection . '.json';\n        $data = $this->readFile($filePath);\n        return array_filter($data, function($item) use ($criteria) {\n            foreach ($criteria as $key => $value) {\n                if (!isset($item[$key]) || $item[$key] != $value) {\n                    return false;\n                }\n            }\n            return true;\n        });\n    }\n\n    private function readFile($filePath) {\n        if (!file_exists($filePath)) {\n            return [];\n        }\n        $file = fopen($filePath, 'r');\n        flock($file, LOCK_SH);\n        $data = fread($file, filesize($filePath));\n        flock($file, LOCK_UN);\n        fclose($file);\n        return json_decode($data, true) ?: [];\n    }\n\n    private function writeFile($filePath, $data) {\n        $file = fopen($filePath, 'w');\n        flock($file, LOCK_EX);\n        fwrite($file, json_encode($data));\n        flock($file, LOCK_UN);\n        fclose($file);\n    }\n}\n\n// Usage example\n$db = new FlatFileDB('data');\n$db->insert('users', ['id' => 1, 'name' => 'John Doe']);\n$result = $db->find('users', ['id' => 1]);\nprint_r($result);\n\n?>