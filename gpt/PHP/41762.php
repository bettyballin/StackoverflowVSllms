<?php\nfunction replace_field($node, $fields) {\n    $fieldName = $node->getAttribute('name');\n    if (isset($fields[$fieldName])) {\n        $newNode = $node->ownerDocument->createTextNode($fields[$fieldName]);\n        $node->parentNode->replaceChild($newNode, $node);\n    }\n}\n\nfunction parseXml($xmlString, $fields) {\n    $dom = new DOMDocument;\n    $dom->loadXML($xmlString);\n\n    $xpath = new DOMXPath($dom);\n    $query = '//field';\n\n    foreach ($xpath->query($query) as $node) {\n        replace_field($node, $fields);\n    }\n\n    return $dom->saveXML();\n}\n\n$xmlString = <<<XML\n<root>\n    <field name="outer">\n        <field name="inner">...</field>\n    </field>\n</root>\nXML;\n\n$fields = [\n    'outer' => 'Outer value',\n    'inner' => 'Inner value'\n];\n\n$resultXml = parseXml($xmlString, $fields);\necho $resultXml;\n?>