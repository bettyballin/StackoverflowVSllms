<?php\nfunction getmails($conn) {\n    $sql = "SELECT * FROM subscribes ORDER BY subscribe_id DESC";\n    $result = $conn->query($sql);\n\n    $elements = array();\n    while($row = $result->fetch_assoc()) {\n        $elements[] = $row['subscribe_email'];\n    }\n    $main = implode(', ', $elements);\n    return $main;\n}\n\nfunction announce($conn) {\n    if(isset($_POST['announce'])) {\n        $ToEmail = getmails($conn);\n        $EmailSubject = $_POST['title'];\n        $mailheader = "From: newsletter@subdomain.domain.com\r\n";\n        $mailheader .= "Reply-to: " . $_POST['author'] . "@subdomain.domain.com\r\n";\n        $mailheader .= "Content-type: text/html; charset=iso-8859-1\r\n";\n        $MESSAGE_BODY = "Author: " . $_POST['author'] . "<br>";\n        $MESSAGE_BODY .= "Newsletter: " . $_POST['content'] . "<br>";\n\n        if(mail($ToEmail, $EmailSubject, $MESSAGE_BODY, $mailheader)) {\n            echo "Mail sent successfully";\n        } else {\n            echo "Mail sending failed";\n        }\n    }\n}\n\n$servername = "your_server";\n$username = "your_username";\n$password = "your_password";\n$dbname = "your_database";\n\n// Create connection\n$conn = new mysqli($servername, $username, $password, $dbname);\n\n// Check connection\nif ($conn->connect_error) {\n    die("Connection failed: " . $conn->connect_error);\n}\n\nannounce($conn);\n\n$conn->close();\n?>