<?php\nclass domain {\n    var $domain = "";\n    var $servers = array(\n        array("com", "whois.verisign-grs.com", "No match"),\n        array("net", "whois.verisign-grs.com", "No match"),\n        array("org", "whois.pir.org", "NOT FOUND"),\n    );\n\n    function __construct($str_domainname) {\n        $this->domain = $str_domainname;\n    }\n\n    function get_tld() {\n        $parts = explode('.', $this->domain);\n        return strtolower(array_pop($parts));\n    }\n\n    function get_domain() {\n        $parts = explode('.', $this->domain);\n        array_pop($parts);\n        return strtolower(implode('.', $parts));\n    }\n\n    function get_whois_server() {\n        $tld = $this->get_tld();\n        foreach ($this->servers as $server) {\n            if ($server[0] == $tld) {\n                return $server[1];\n            }\n        }\n        return false;\n    }\n\n    function is_available() {\n        if (!$this->is_valid()) {\n            return false;\n        }\n\n        $whois_server = $this->get_whois_server();\n        if (!$whois_server) {\n            return false;\n        }\n\n        $fp = fsockopen($whois_server, 43);\n        if (!$fp) {\n            return false;\n        }\n\n        $dom = $this->domain . "\r\n";\n        fputs($fp, $dom);\n\n        $response = "";\n        while (!feof($fp)) {\n            $response .= fgets($fp, 128);\n        }\n        fclose($fp);\n\n        foreach ($this->servers as $server) {\n            if (strpos($response, $server[2]) !== false) {\n                return true;\n            }\n        }\n\n        return false;\n    }\n\n    function is_valid() {\n        return filter_var($this->domain, FILTER_VALIDATE_DOMAIN, FILTER_FLAG_HOSTNAME);\n    }\n}\n?>