function appendQueryParams($html, $domainURL, $appendedParams) {\n    $dom = new DOMDocument;\n    @$dom->loadHTML($html);\n    $xpath = new DOMXPath($dom);\n    $query = "//a[contains(@href, '$domainURL')]";\n    $nodes = $xpath->query($query);\n\n    foreach ($nodes as $node) {\n        $href = $node->getAttribute('href');\n        $parsed_url = parse_url($href);\n        \n        // Parse existing query parameters if any\n        if (isset($parsed_url['query'])) {\n            parse_str($parsed_url['query'], $query_params);\n        } else {\n            $query_params = [];\n        }\n\n        // Append new parameters\n        parse_str($appendedParams, $new_params);\n        $query_params = array_merge($query_params, $new_params);\n\n        // Build new query string\n        $new_query = http_build_query($query_params);\n        $new_url = $parsed_url['scheme'] . '://' . $parsed_url['host'] . $parsed_url['path'] . '?' . $new_query;\n        \n        // Set the new href\n        $node->setAttribute('href', $new_url);\n    }\n\n    return $dom->saveHTML();\n}\n\n$sHTML = '<a href="http://www.domain.com/page/?already=here&another=one" rel="nofollow noreferrer">http://www.domain.com/page/</a>';\n$domainURL = 'http://www.domain.com';\n$appendedParams = 'var1=2&var2=4';\n\n$newHTML = appendQueryParams($sHTML, $domainURL, $appendedParams);\necho $newHTML;