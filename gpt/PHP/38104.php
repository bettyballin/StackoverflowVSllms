<?php\n$nested_array = array(\n    array('name' => 'foo', 'depth' => 0),\n    array('name' => 'bar', 'depth' => 0),\n    array('name' => 'sub-bar', 'depth' => 1)\n);\n\nfunction buildHierarchy($items, $depth = 0) {\n    $output = "<ul>\n";\n    foreach ($items as $key => $item) {\n        if ($item['depth'] == $depth) {\n            unset($items[$key]);\n            $output .= "<li>{$item['name']}\n";\n            $subItems = array_filter($items, function($subItem) use ($depth) {\n                return $subItem['depth'] > $depth;\n            });\n            if (!empty($subItems)) {\n                $output .= buildHierarchy($subItems, $depth + 1);\n            }\n            $output .= "</li>\n";\n        }\n    }\n    $output .= "</ul>\n";\n    return $output;\n}\n\necho "<div>\n" . buildHierarchy($nested_array) . "</div>\n";\n?>