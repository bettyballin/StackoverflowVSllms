<?php\n$file = "phpsettings.php";\n$defaultContent = "<?php \$pref1 = \"default\"; ?>";\n$defaultPrefs = array(\n    'pref1' => 'default'\n);\n\nfunction writePrefsFile($file, $content) {\n    if ($handle = fopen($file, 'w')) {\n        fwrite($handle, $content);\n        fclose($handle);\n        return true;\n    } else {\n        error_log("Unable to open file: $file");\n        return false;\n    }\n}\n\n$mypref = isset($_POST['mypref']) ? $_POST['mypref'] : $defaultPrefs['pref1'];\n$content = "<?php \$pref1 = \"$mypref\"; ?>";\n\nif (!file_exists($file)) {\n    if (!writePrefsFile($file, $content)) {\n        // Handle error, e.g., alert user\n        die("Error: Unable to create preferences file.");\n    }\n} else {\n    if (!unlink($file)) {\n        error_log("Unable to delete file: $file");\n        // Handle error, e.g., alert user\n        die("Error: Unable to delete old preferences file.");\n    }\n\n    if (!writePrefsFile($file, $content)) {\n        // Handle error, e.g., alert user\n        die("Error: Unable to write new preferences file.");\n    }\n}\n\n// Include the prefs file where needed\nif (file_exists($file)) {\n    include $file;\n} else {\n    // Define default variables if prefs file doesn't exist\n    foreach ($defaultPrefs as $key => $value) {\n        $$key = $value;\n    }\n}\n\n?>