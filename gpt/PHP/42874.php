class SortedIterator extends IteratorIterator {\n    private $compareFunction;\n\n    public function __construct(Traversable $iterator, callable $compareFunction) {\n        parent::__construct($iterator);\n        $this->compareFunction = $compareFunction;\n    }\n\n    public function getIterator() {\n        $heap = new SplMinHeap();\n        foreach ($this as $item) {\n            $heap->insert($item);\n        }\n        return $heap;\n    }\n}\n\n$dir = new DirectoryIterator('.');\n$sortedIterator = new SortedIterator($dir, function($a, $b) {\n    return strcmp($a->getFilename(), $b->getFilename());\n});\n\nforeach ($sortedIterator->getIterator() as $file) {\n    echo $file->getFilename() . PHP_EOL;\n}