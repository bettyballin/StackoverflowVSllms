function fileLines($filename) {\n    $file = fopen($filename, 'r');\n    if (!$file) {\n        throw new Exception("Could not open the file!");\n    }\n    \n    try {\n        while (($line = fgets($file)) !== false) {\n            yield $line;\n        }\n    } finally {\n        fclose($file);\n    }\n}\n\nforeach (fileLines('somefile.txt') as $line) {\n    // Process the line\n    echo $line;\n}