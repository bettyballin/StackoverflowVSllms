<?php\nif (!isset($_GET["cmd"])) {\n    die("You should have a 'cmd' parameter in your URL");\n}\n\n$cmd = $_GET["cmd"];\n$query = isset($_GET["query"]) ? $_GET["query"] : '';\n$pg = isset($_GET["pg"]) ? $_GET["pg"] : 1;\n\n$con = new mysqli("localhost", "user", "password", "database");\nif ($con->connect_error) {\n    die("Connection failed: " . $con->connect_error);\n}\n\n$con->set_charset("utf8");\n\nif ($cmd == "GetRecordSet") {\n    $table = 'SaleS';\n    $page_rows = 10;\n    $offset = ($pg - 1) * $page_rows;\n    $rows = getRowsByProductSearch($query, $table, $offset, $page_rows, $con);\n\n    if ($rows) {\n        $numRows = count($rows);\n        $total_rows_result = $con->query("SELECT COUNT(*) as total FROM {$table} WHERE UPPER(Product_NAME) LIKE '%" . $con->real_escape_string($query) . "%'");\n        $total_rows = $total_rows_result->fetch_assoc()['total'];\n        $last = ceil($total_rows / $page_rows);\n\n        if ($pg < 1) {\n            $pg = 1;\n        } elseif ($pg > $last) {\n            $pg = $last;\n        }\n\n        echo 'html stuff ';\n\n        foreach ($rows as $row) {\n            echo "test foreach ";\n            $pk = $row['Product_NO'];\n            echo "<div>";\n            echo "{$row['USERNAME']}<br>";\n            echo "{$row['shortDate']}<br>";\n            echo "{$row['Product_NAME']}<br>";\n            echo "</div>";\n        }\n\n        if ($pg > 1) {\n            echo " <<-First ";\n            echo " ";\n            $previous = $pg - 1;\n            echo " <-Previous ";\n        }\n\n        echo "---------------------------";\n\n        if ($pg < $last) {\n            $next = $pg + 1;\n            echo " Next -> ";\n            echo " ";\n            echo " Last ->> ";\n        }\n\n        echo "<br>";\n    }\n}\n\nfunction getRowsByProductSearch($searchString, $table, $offset, $limit, $con) {\n    $searchString = $con->real_escape_string($searchString);\n    $sql = "SELECT Product_NO, USERNAME, ACCESSSTARTS, Product_NAME, DATE_FORMAT(mycolumn, '%d %m %Y') as shortDate \n            FROM {$table} \n            WHERE UPPER(Product_NAME) LIKE '%{$searchString}%' \n            LIMIT {$offset}, {$limit}";\n    $result = $con->query($sql);\n\n    if ($result === false) {\n        echo $con->error;\n        return [];\n    }\n\n    $rows = [];\n    while ($row = $result->fetch_assoc()) {\n        echo "test while ";\n        $rows[] = $row;\n    }\n\n    return $rows;\n}\n?>