$cipher_alg = MCRYPT_RIJNDAEL_128;\n$decrypted_string = mcrypt_decrypt($cipher_alg, $key, $encrypted_string, MCRYPT_MODE_CBC, trim(hex2bin(trim($hexiv))));\n\n// Remove padding (null characters) that might have been added during encryption\n$decrypted_string = rtrim($decrypted_string, "\0");\n\n// Optionally, you can also trim any additional whitespace\n$decrypted_string = trim($decrypted_string);