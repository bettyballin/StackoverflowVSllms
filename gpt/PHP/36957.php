<?php\nif (isset($_GET["vid_id"]) && isset($_GET["hash"]) && isset($_GET["expires"])) {\n    $vid_id = intval($_GET["vid_id"]);\n    $hash = $_GET["hash"];\n    $expires = intval($_GET["expires"]);\n    $vid_file = "directory/" . $vid_id . ".flv";  // Adjust as necessary\n\n    if (time() > $expires) {\n        die("Link expired");\n    }\n\n    $expected_hash = generate_hash($vid_id, $expires);\n    if ($hash !== $expected_hash) {\n        die("Invalid hash");\n    }\n\n    if (file_exists($vid_file)) {\n        header('Content-Type: video/x-flv');\n        header('Content-Length: ' . filesize($vid_file));\n        readfile($vid_file);\n        exit;\n    } else {\n        die("File not found");\n    }\n} else {\n    die("Invalid request");\n}\n\nfunction generate_hash($vid_id, $expiry_time) {\n    $secret_key = "your_secret_key";  // Use a strong secret key\n    return substr(md5($vid_id . $expiry_time . $secret_key), 0, 12);\n}\n?>