$regex = '/\n    (?<!\\\\)\'(?:\\\\.|[^\'])*\'(*SKIP)(*FAIL) # Skip over single-quoted strings\n    |\n    \{(\w+)\}                                   # Match the word in braces\n/x';\n\n$query = "blah blah {FOO} blah 'I\'m typing {BAR} here with an escaped backslash \\' blah blah {FOO} 'Three backslashes {BAR} and an escaped quote \\\\\\\' here {BAR}'";\n\npreg_match_all($regex, $query, $matches);\n\nprint_r($matches[1]); // This will output the matched words inside braces outside single quotes