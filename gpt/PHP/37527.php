function nestify($arrs, $depth_key = 'depth', $id_key = 'id', $parent_key = 'parent_id') {\n    $nested = array();\n    $depths = array();\n\n    foreach ($arrs as $key => $arr) {\n        $arr['children'] = array(); // Initialize the children array\n        if ($arr[$depth_key] == 0) {\n            $nested[$key] = $arr;\n            $depths[$arr[$depth_key] + 1] = &$nested[$key];\n        } else {\n            $parent =& $depths[$arr[$depth_key]];\n            $parent['children'][$key] = $arr;\n            $depths[$arr[$depth_key] + 1] = &$parent['children'][$key];\n        }\n    }\n\n    return $nested;\n}\n\n// Example usage:\n$data = array(\n    array('id' => 1, 'parent_id' => 0, 'depth' => 0, 'name' => 'Root'),\n    array('id' => 2, 'parent_id' => 1, 'depth' => 1, 'name' => 'Child 1'),\n    array('id' => 3, 'parent_id' => 1, 'depth' => 1, 'name' => 'Child 2'),\n    array('id' => 4, 'parent_id' => 2, 'depth' => 2, 'name' => 'Grandchild 1')\n);\n\n$nestedArray = nestify($data);\n$json = json_encode($nestedArray, JSON_PRETTY_PRINT);\necho $json;