class Model_Person\n{\n    protected static $_gateway;\n\n    protected $_person;\n\n    public static function init()\n    {\n        if (self::$_gateway === null) {\n            self::$_gateway = new Model_Table_Person();\n        }\n    }\n\n    public static function get($searchString, $searchType = 'id')\n    {\n        self::init();\n\n        switch ($searchType) {\n            case 'id':\n                $row = self::$_gateway->find($searchString)->current();\n                break;\n            default:\n                return null;\n        }\n\n        return self::factory($row);\n    }\n\n    public static function getCollection($searchString, $searchType = null)\n    {\n        self::init();\n\n        switch ($searchType) {\n            case 'userType':\n                $personRowset = self::$_gateway->findByPersonType($searchString);\n                break;\n            default:\n                $personRowset = self::$_gateway->fetchAll();\n                break;\n        }\n\n        $personArray = array();\n        foreach ($personRowset as $person) {\n            $personArray[] = self::factory($person);\n        }\n\n        return $personArray;\n    }\n\n    public function getCompany()\n    {\n        return $this->_person->findParentRow('Company');\n    }\n\n    public function getStore()\n    {\n        return $this->_person->findParentRow('Store');\n    }\n\n    protected static function factory(Zend_Db_Table_Row $row)\n    {\n        $class = 'Model_Person_' . ucfirst($row->personType);\n        if (class_exists($class)) {\n            return new $class($row);\n        }\n        return new self($row);\n    }\n\n    protected function __construct(Zend_Db_Table_Row $personRow)\n    {\n        $this->_person = $personRow;\n    }\n}