<?php\n// site1.com - other domain\n\nif (!isset($_COOKIE['session_id'])) {\n    header('Location: https://auth.example.com?redirect=' . urlencode('http://site1.com'));\n    exit;\n}\n\n// Validate the session with the central auth server\n$sessionID = $_COOKIE['session_id'];\n$response = file_get_contents("https://auth.example.com?session_id=$sessionID");\n$data = json_decode($response, true);\n\nif (isset($data['status']) && $data['status'] === 'logged_in') {\n    echo 'User is logged in!';\n} else {\n    echo 'User is not logged in!';\n}\n?>