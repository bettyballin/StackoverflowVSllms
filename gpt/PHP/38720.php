<?php\nsession_start();\n// Assuming $user_id is retrieved from the database upon successful login\n\n// Generate a secure token\n$token = bin2hex(random_bytes(32));\n\n// Store token in the session\n$_SESSION['token'] = $token;\n\n// Store token in the database with the user ID\n// Use prepared statements to prevent SQL injection\n$stmt = $db->prepare("UPDATE users SET token = ? WHERE id = ?");\n$stmt->execute([$token, $user_id]);\n?>