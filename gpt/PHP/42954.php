<?php\n\nfunction shortenWithHighlight($text, $word, $maxLength = 50) {\n    $pattern = '/\b' . preg_quote($word, '/') . '\b/';\n    if (preg_match($pattern, $text, $matches, PREG_OFFSET_CAPTURE)) {\n        $matchPos = $matches[0][1];\n        $start = max(0, $matchPos - ($maxLength / 2));\n        $end = min(strlen($text), $start + $maxLength);\n        $shortenedText = substr($text, $start, $end - $start);\n\n        if ($start > 0) {\n            $shortenedText = '...' . $shortenedText;\n        }\n        if ($end < strlen($text)) {\n            $shortenedText .= '...';\n        }\n\n        return highlightExactMatch($shortenedText, $word);\n    }\n\n    return $text;\n}\n\n$text = "This is a long string that contains the word am somewhere in the middle of the text.";\n$word = "am";\n\n$shortenedText = shortenWithHighlight($text, $word);\necho $shortenedText;\n\n?>