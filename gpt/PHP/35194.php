$chart = array();\n$roll = array();\n\n// Database connection\n$mysqli = new mysqli("localhost", "username", "password", "database");\n\n// Check connection\nif ($mysqli->connect_error) {\n    die("Connection failed: " . $mysqli->connect_error);\n}\n\n// Select used terms\n$rosh = $mysqli->query("SELECT DISTINCT term FROM search_terms");\n\nif ($rosh === false) {\n    die("Query failed: " . $mysqli->error);\n}\n\nwhile ($roshrow = $rosh->fetch_assoc()) {\n    $roll[] = $roshrow['term'];\n}\n\n// Select term_number for each term\nforeach ($roll as $sterm) {\n    $termarray = array();\n    $bashq = "SELECT term_number FROM search_terms WHERE term = '" . $mysqli->real_escape_string($sterm) . "'";\n    $bash = $mysqli->query($bashq);\n\n    if ($bash === false) {\n        die("Query failed: " . $mysqli->error);\n    }\n\n    while ($brow = $bash->fetch_assoc()) {\n        $termarray[] = $brow['term_number'];\n    }\n\n    $termsum = array_sum($termarray);\n\n    // Put term=>number array for chart script\n    $chart[$sterm] = $termsum;\n}\n\n// Sort array so high numbers at beginning\narsort($chart);\n\n// Slice top 10 terms\n$chart = array_slice($chart, 0, 10);\n\n// Close connection\n$mysqli->close();