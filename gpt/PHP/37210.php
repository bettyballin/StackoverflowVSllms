session_start();\n\n// Regenerate session ID to prevent session fixation\nif (!isset($_SESSION['created'])) {\n    $_SESSION['created'] = time();\n} else if (time() - $_SESSION['created'] > 1800) {\n    // Regenerate session ID every 30 minutes\n    session_regenerate_id(true);\n    $_SESSION['created'] = time();\n}\n\n// Example of setting session data\nif (!isset($_SESSION['user_id'])) {\n    // Fetch user data from the database\n    $_SESSION['user_id'] = $userIdFromDatabase;\n    $_SESSION['user_role'] = $userRoleFromDatabase;\n}\n\n// Validate session data\nif ($_SESSION['user_id'] !== $expectedUserId) {\n    // Handle invalid session\n    session_unset();\n    session_destroy();\n    header("Location: login.php");\n    exit();\n}\n\n// Example of using session data\n$userId = $_SESSION['user_id'];\n$userRole = $_SESSION['user_role'];