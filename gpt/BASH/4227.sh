@echo off\nsetlocal\n\nREM Path to the .NET Framework installutil utility\nset INSTALLUTIL="C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\installutil.exe"\n\nREM Path to the service executable\nset SERVICE_EXE="DataService.exe"\n\nREM Path to the log file\nset LOG_FILE="program.log"\n\nREM Check if the service is already installed\nsc query "DataService" >nul 2>&1\nif %errorlevel% equ 0 (\n    REM Service is installed, ask for confirmation to uninstall\n    set /p confirm="Service is already installed. Do you want to uninstall it? (y/n): "\n    if /i "%confirm%" equ "y" (\n        echo Uninstalling service...\n        %INSTALLUTIL% /u %SERVICE_EXE%\n        if %errorlevel% equ 0 (\n            echo Service uninstalled successfully >> %LOG_FILE%\n            echo Service uninstalled successfully.\n        ) else (\n            echo Failed to uninstall service.\n        )\n    ) else (\n        echo Uninstallation canceled.\n    )\n) else (\n    REM Service is not installed, proceed with installation\n    echo Installing service...\n    %INSTALLUTIL% %SERVICE_EXE%\n    if %errorlevel% equ 0 (\n        echo Service installed successfully >> %LOG_FILE%\n        echo Service installed successfully.\n    ) else (\n        echo Failed to install service.\n    )\n)\n\nendlocal\npause