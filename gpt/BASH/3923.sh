@echo off\nsetlocal enabledelayedexpansion\n\nREM Set the path to the IIS log directory\nset logDir=C:\path\to\iis\logs\n\nREM Set the path to the directory where zipped files will be stored\nset zipDir=C:\path\to\zipped\logs\n\nREM Create the zip directory if it doesn't exist\nif not exist "%zipDir%" mkdir "%zipDir%"\n\nREM Change to the log directory\ncd /d "%logDir%"\n\nREM Get the current year and month\nfor /f "tokens=2 delims==" %%i in ('wmic os get localdatetime /value') do set dt=%%i\nset "yyyy=%dt:~0,4%"\n\nREM Loop through each month\nfor /L %%m in (1,1,12) do (\n    set "month=0%%m"\n    set "month=!month:~-2!"\n\n    REM Generate a list of log files for the month\n    set "fileList="\n    for %%f in (ex%yyyy%!month!*.log) do (\n        set "fileList=!fileList! %%f"\n    )\n\n    REM If there are log files for the month, zip them and delete the originals\n    if defined fileList (\n        set "zipFile=%zipDir%\IISLogs_%yyyy%_!month!.zip"\n        echo Zipping log files for %yyyy%-%month%...\n        7z a -tzip "!zipFile!" !fileList!\n        \n        REM Delete the original log files after zipping\n        echo Deleting original log files...\n        del /q !fileList!\n    )\n)\n\nendlocal\necho Done.\npause