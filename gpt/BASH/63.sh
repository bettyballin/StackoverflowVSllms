#!/bin/bash\n\nlogfile="path/to/your/logfile"\n\nawk '\n    /DoBind/ { \n        capture = 0; \n        conn = $NF; \n    }\n    /Bind name/ { \n        if ($0 ~ /cn=admin,ou=appids,o=admineq/) { \n            capture = 1; \n        } \n    }\n    capture && /Sending operation result 0/ {\n        if ($NF == conn) { \n            print buffer \n            print $0\n        }\n    }\n    capture && /Operation/ {\n        if ($NF == conn) { \n            print $0\n        }\n    }\n    {\n        buffer = $0\n    }\n' "$logfile"