@echo off\n\nsetlocal\n\nREM Define paths\nset BACKUP_DIR=C:\SharePointBackups\nset FULL_BACKUP_DIR=%BACKUP_DIR%\full\nset LATEST_FULL_BACKUP=%BACKUP_DIR%\latest_full_backup\nset DATE=%date:~-4%%date:~-10,2%%date:~-7,2%\n\nREM Perform full backup\nstsadm -o backup -directory %FULL_BACKUP_DIR% -backupmethod full\n\nREM Rename full backup directory with date\nrename %FULL_BACKUP_DIR% backup_%DATE%_full\n\nREM Update symbolic link to point to the latest full backup\nif exist %LATEST_FULL_BACKUP% rmdir %LATEST_FULL_BACKUP%\nmklink /d %LATEST_FULL_BACKUP% %BACKUP_DIR%\backup_%DATE%_full\n\nREM Perform differential backup\nstsadm -o backup -directory %LATEST_FULL_BACKUP% -backupmethod differential\n\nendlocal