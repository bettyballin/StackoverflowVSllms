#!/bin/bash\n\n# Step 1: Get the PID of the Java process\nPID=$(jps | grep <YourJavaApp> | awk '{print $1}')\n\n# Step 2: Use top to find the most CPU consuming thread\nTID=$(top -H -p $PID -n 1 | grep java | awk '{print $1}' | sort -nrk9 | head -n1)\n\n# Step 3: Convert TID to hexadecimal\nHEX_TID=$(printf "%x\n" $TID)\n\n# Step 4: Take a thread dump\njstack $PID > threaddump.txt\n\n# Step 5: Search for the hexadecimal TID in the thread dump\ngrep $HEX_TID threaddump.txt -A 30