# Define the database connection\n$serverName = "YourServerName"\n$databaseName = "YourDatabaseName"\n$connectionString = "Server=$serverName;Database=$databaseName;Integrated Security=True;"\n\n# Query to retrieve the stored procedures and functions scripts\n$query = @"\nSELECT ObjectName, ObjectType, ScriptText FROM #ObjectScripts\n"@\n\n# Execute the query and save the results\n$connection = New-Object System.Data.SqlClient.SqlConnection\n$connection.ConnectionString = $connectionString\n$connection.Open()\n\n$command = $connection.CreateCommand()\n$command.CommandText = $query\n$reader = $command.ExecuteReader()\n\nwhile ($reader.Read()) {\n    $objectName = $reader["ObjectName"]\n    $scriptText = $reader["ScriptText"]\n    $filePath = "C:\Path\To\Save\$objectName.sql"\n    [System.IO.File]::WriteAllText($filePath, $scriptText)\n}\n\n$connection.Close()