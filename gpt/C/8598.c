#include <Security/Security.h>\n\n// Define the ciphers you want to add, for example:\nSSLCipherSuite ciphers[] = {\n    TLS_RSA_WITH_AES_128_GCM_SHA256,\n    TLS_RSA_WITH_AES_256_GCM_SHA384,\n    TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,\n    TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\n};\n\n// Create a CFNumber array from the ciphers\nCFNumberRef cipherNumbers[sizeof(ciphers) / sizeof(ciphers[0])];\nfor (int i = 0; i < sizeof(ciphers) / sizeof(ciphers[0]); i++) {\n    cipherNumbers[i] = CFNumberCreate(kCFAllocatorDefault, kCFNumberSInt32Type, &ciphers[i]);\n}\n\n// Create a CFArray with the cipher numbers\nCFArrayRef ciphersArray = CFArrayCreate(kCFAllocatorDefault, (const void **)cipherNumbers, sizeof(ciphers) / sizeof(ciphers[0]), &kCFTypeArrayCallBacks);\n\n// Release the CFNumbers now that they are in the array\nfor (int i = 0; i < sizeof(ciphers) / sizeof(ciphers[0]); i++) {\n    CFRelease(cipherNumbers[i]);\n}\n\n// Set up the SSL settings dictionary\nconst void *keys[] = { kCFStreamSSLLevel, kCFStreamSSLAllowsExpiredCertificates, kCFStreamSSLAllowsExpiredRoots, kCFStreamSSLAllowsAnyRoot, kCFStreamSSLValidatesCertificateChain, kCFStreamSSLPeerName, kCFStreamSSLAllowedCiphers };\nconst void *values[] = { kCFStreamSocketSecurityLevelNegotiatedSSL, kCFBooleanFalse, kCFBooleanFalse, kCFBooleanFalse, kCFBooleanTrue, kCFNull, ciphersArray };\n\nCFDictionaryRef sslSettings = CFDictionaryCreate(kCFAllocatorDefault, keys, values, sizeof(keys) / sizeof(keys[0]), &kCFTypeDictionaryKeyCallBacks, &kCFTypeDictionaryValueCallBacks);\n\n// Apply the SSL settings to the read stream\nCFReadStreamSetProperty(theReadStream, kCFStreamPropertySSLSettings, sslSettings);\n\n// Release the created objects\nCFRelease(ciphersArray);\nCFRelease(sslSettings);