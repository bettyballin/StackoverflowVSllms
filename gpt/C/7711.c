#include <stdio.h>\n   #include <stdlib.h>\n   #include <string.h>\n   #include <netlink/netlink.h>\n   #include <netlink/genl/genl.h>\n   #include <netlink/genl/ctrl.h>\n   #include <linux/nl80211.h>\n\n   static int callback(struct nl_msg *msg, void *arg) {\n       struct genlmsghdr *gnlh = nlmsg_data(nlmsg_hdr(msg));\n\n       struct nlattr *tb[NL80211_ATTR_MAX + 1];\n       static struct nla_policy policy[NL80211_ATTR_MAX + 1] = {\n           [NL80211_ATTR_BSS] = { .type = NLA_NESTED },\n       };\n\n       nla_parse(tb, NL80211_ATTR_MAX, genlmsg_attrdata(gnlh, 0), genlmsg_attrlen(gnlh, 0), policy);\n\n       if (tb[NL80211_ATTR_BSS]) {\n           printf("Found a new network\n");\n           // Process the BSS attributes to extract SSID, channel, and encryption type\n       }\n\n       return NL_SKIP;\n   }\n\n   int main() {\n       struct nl_sock *sock = nl_socket_alloc();\n       if (!sock) {\n           fprintf(stderr, "Failed to allocate netlink socket.\n");\n           return -1;\n       }\n\n       if (genl_connect(sock)) {\n           fprintf(stderr, "Failed to connect to generic netlink.\n");\n           nl_socket_free(sock);\n           return -1;\n       }\n\n       int driver_id = genl_ctrl_resolve(sock, "nl80211");\n       if (driver_id < 0) {\n           fprintf(stderr, "nl80211 not found.\n");\n           nl_socket_free(sock);\n           return -1;\n       }\n\n       struct nl_msg *msg = nlmsg_alloc();\n       if (!msg) {\n           fprintf(stderr, "Failed to allocate netlink message.\n");\n           nl_socket_free(sock);\n           return -1;\n       }\n\n       genlmsg_put(msg, 0, 0, driver_id, 0, 0, NL80211_CMD_GET_SCAN, 0);\n\n       nla_put_u32(msg, NL80211_ATTR_IFINDEX, if_nametoindex("wlan0")); // Replace "wlan0" with your interface name\n\n       nl_socket_modify_cb(sock, NL_CB_VALID, NL_CB_CUSTOM, callback, NULL);\n\n       int ret = nl_send_auto_complete(sock, msg);\n       if (ret < 0) {\n           fprintf(stderr, "Failed to send message.\n");\n           nlmsg_free(msg);\n           nl_socket_free(sock);\n           return -1;\n       }\n\n       nlmsg_free(msg);\n\n       nl_recvmsgs_default(sock);\n\n       nl_socket_free(sock);\n\n       return 0;\n   }