#include <stdio.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <sys/types.h>\n#include <sys/wait.h>\n#include <errno.h>\n\nint execute_command(const char *cmd, char *output, size_t output_size) {\n    int pipefd[2];\n    pid_t pid;\n    int status;\n\n    if (pipe(pipefd) == -1) {\n        perror("pipe");\n        return -1;\n    }\n\n    if ((pid = fork()) == -1) {\n        perror("fork");\n        return -1;\n    }\n\n    if (pid == 0) {  // Child process\n        close(pipefd[0]);  // Close read end\n        dup2(pipefd[1], STDOUT_FILENO);  // Redirect stdout to pipe\n        dup2(pipefd[1], STDERR_FILENO);  // Redirect stderr to pipe\n        close(pipefd[1]);\n\n        execl("/bin/sh", "sh", "-c", cmd, (char *)NULL);\n        perror("execl");\n        _exit(EXIT_FAILURE);\n    } else {  // Parent process\n        close(pipefd[1]);  // Close write end\n\n        ssize_t bytes_read = read(pipefd[0], output, output_size - 1);\n        if (bytes_read >= 0) {\n            output[bytes_read] = '\0';  // Null-terminate the output\n        } else {\n            perror("read");\n            close(pipefd[0]);\n            return -1;\n        }\n        close(pipefd[0]);\n\n        if (waitpid(pid, &status, 0) == -1) {\n            perror("waitpid");\n            return -1;\n        }\n\n        if (WIFEXITED(status)) {\n            return WEXITSTATUS(status);\n        } else {\n            return -1;\n        }\n    }\n}\n\nint main() {\n    char output[1024];\n    int ret = execute_command("ls -l", output, sizeof(output));\n    if (ret != -1) {\n        printf("Command output:\n%s\n", output);\n        printf("Command exited with status: %d\n", ret);\n    } else {\n        printf("Failed to execute command\n");\n    }\n    return 0;\n}