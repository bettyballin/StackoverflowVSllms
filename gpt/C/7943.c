#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <unistd.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <sys/select.h>\n\n#define PORT 8080\n\nvoid setup_socket(int *server_fd, struct sockaddr_in *address) {\n    int opt = 1;\n    int addrlen = sizeof(*address);\n\n    // Creating socket file descriptor\n    if ((*server_fd = socket(AF_INET, SOCK_STREAM, 0)) == 0) {\n        perror("socket failed");\n        exit(EXIT_FAILURE);\n    }\n\n    // Forcefully attaching socket to the port\n    if (setsockopt(*server_fd, SOL_SOCKET, SO_REUSEADDR | SO_REUSEPORT, &opt, sizeof(opt))) {\n        perror("setsockopt");\n        exit(EXIT_FAILURE);\n    }\n\n    address->sin_family = AF_INET;\n    address->sin_addr.s_addr = INADDR_ANY;\n    address->sin_port = htons(PORT);\n\n    // Binding the socket to the address\n    if (bind(*server_fd, (struct sockaddr *)address, sizeof(*address)) < 0) {\n        perror("bind failed");\n        exit(EXIT_FAILURE);\n    }\n\n    // Start listening on the socket\n    if (listen(*server_fd, 3) < 0) {\n        perror("listen");\n        exit(EXIT_FAILURE);\n    }\n}\n\nint main() {\n    int server_fd, new_socket;\n    struct sockaddr_in address;\n    int addrlen = sizeof(address);\n    int command;\n\n    setup_socket(&server_fd, &address);\n\n    fd_set readfds;\n    int max_sd;\n\n    while (1) {\n        // Clear the socket set\n        FD_ZERO(&readfds);\n        \n        // Add server socket to set\n        FD_SET(server_fd, &readfds);\n        max_sd = server_fd;\n\n        // Wait for an activity on one of the sockets\n        int activity = select(max_sd + 1, &readfds, NULL, NULL, NULL);\n\n        if ((activity < 0) && (errno != EINTR)) {\n            perror("select error");\n        }\n\n        // If something happened on the server socket, then it means an incoming connection\n        if (FD_ISSET(server_fd, &readfds)) {\n            if ((new_socket = accept(server_fd, (struct sockaddr *)&address, (socklen_t*)&addrlen)) < 0) {\n                perror("accept");\n                exit(EXIT_FAILURE);\n            }\n\n            // Read the command from the new socket\n            read(new_socket, &command, sizeof(int));\n            switch (command) {\n                // Handle different commands here\n                // ...\n            }\n\n            // Close the socket after handling the command\n            close(new_socket);\n        }\n    }\n\n    return 0;\n}