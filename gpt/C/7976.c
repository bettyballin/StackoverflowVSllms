#include <nids.h>\n\nvoid tcp_callback(struct tcp_stream *a_tcp, void **args) {\n    if (a_tcp->nids_state == NIDS_JUST_EST) {\n        nids_discard(a_tcp, 0);\n    } else if (a_tcp->nids_state == NIDS_DATA) {\n        if (a_tcp->client.count_new) {\n            printf("Data from client: %.*s\n", a_tcp->client.count_new, a_tcp->client.data);\n        }\n        if (a_tcp->server.count_new) {\n            printf("Data from server: %.*s\n", a_tcp->server.count_new, a_tcp->server.data);\n        }\n    }\n}\n\nint main() {\n    nids_params.device = "eth0";\n    if (!nids_init()) {\n        fprintf(stderr, "Error initializing libnids: %s\n", nids_errbuf);\n        return 1;\n    }\n\n    nids_register_tcp(tcp_callback);\n    nids_run();\n    return 0;\n}