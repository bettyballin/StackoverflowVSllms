#include <ecpglib.h>\n#include <ecpgerrno.h>\n#include <sqlca.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define INT_ARR_NULL -1\n\nstruct foobar {\n    int *foo;\n    int *bar;\n};\n\nvoid init_foobar(struct foobar *fb) {\n    fb->foo = (int*) calloc(11, sizeof(int));\n    fb->bar = (int*) calloc(11, sizeof(int));\n    fb->foo[10] = INT_ARR_NULL;\n    fb->bar[10] = INT_ARR_NULL;\n    int i;\n    for (i = 0; i < 10; ++i) {\n        fb->foo[i] = i;\n        fb->bar[i] = i;\n    }\n}\n\nvoid array_to_string(int *array, char *str) {\n    char buffer[12];\n    int *cursor = array;\n    str[0] = '\0';\n    strcat(str, "{");\n    while (*cursor != INT_ARR_NULL) {\n        sprintf(buffer, "%d", *cursor);\n        strcat(str, buffer);\n        cursor++;\n        if (*cursor != INT_ARR_NULL) {\n            strcat(str, ",");\n        }\n    }\n    strcat(str, "}");\n}\n\nvoid insert_into_db(struct foobar *fb) {\n    char foo_str[256];\n    char bar_str[256];\n\n    array_to_string(fb->foo, foo_str);\n    array_to_string(fb->bar, bar_str);\n\n    EXEC SQL BEGIN DECLARE SECTION;\n    char *foo_array = foo_str;\n    char *bar_array = bar_str;\n    EXEC SQL END DECLARE SECTION;\n\n    EXEC SQL CONNECT TO mydb USER myuser PASSWORD mypassword;\n\n    EXEC SQL WHENEVER SQLERROR SQLPRINT;\n\n    EXEC SQL INSERT INTO mytable (foo_column, bar_column) VALUES (:foo_array, :bar_array);\n\n    EXEC SQL COMMIT;\n\n    EXEC SQL DISCONNECT;\n}\n\nint main() {\n    struct foobar fb;\n    init_foobar(&fb);\n    insert_into_db(&fb);\n\n    free(fb.foo);\n    free(fb.bar);\n\n    return 0;\n}