// ExampleServer.c\n#include <windows.h>\n#include <stdio.h>\n#include "Example.h"\n\nvoid ExampleProc(long* pData)\n{\n    *pData += 1; // Example implementation\n}\n\nint main()\n{\n    RPC_STATUS status;\n\n    status = RpcServerUseProtseqEp(\n        (unsigned char *)"ncacn_ip_tcp",\n        RPC_C_PROTSEQ_MAX_REQS_DEFAULT,\n        (unsigned char *)"4747",\n        NULL);\n\n    if (status)\n    {\n        exit(status);\n    }\n\n    status = RpcServerRegisterIf2(\n        Example_v1_0_s_ifspec,\n        NULL,\n        NULL,\n        RPC_IF_ALLOW_LOCAL_ONLY,\n        RPC_C_LISTEN_MAX_CALLS_DEFAULT,\n        (unsigned)-1,\n        NULL);\n\n    if (status)\n    {\n        exit(status);\n    }\n\n    printf("Server is listening...\n");\n\n    status = RpcServerListen(\n        1,\n        RPC_C_LISTEN_MAX_CALLS_DEFAULT,\n        FALSE);\n\n    if (status)\n    {\n        exit(status);\n    }\n\n    return 0;\n}\n\n// Memory allocation function\nvoid __RPC_FAR * __RPC_USER midl_user_allocate(size_t len)\n{\n    return(malloc(len));\n}\n\n// Memory deallocation function\nvoid __RPC_USER midl_user_free(void __RPC_FAR * ptr)\n{\n    free(ptr);\n}