#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <curl/curl.h>\n\nstruct MemoryStruct {\n    char *memory;\n    size_t size;\n};\n\nstatic size_t WriteMemoryCallback(void *contents, size_t size, size_t nmemb, void *userp) {\n    size_t realsize = size * nmemb;\n    struct MemoryStruct *mem = (struct MemoryStruct *)userp;\n\n    char *ptr = realloc(mem->memory, mem->size + realsize + 1);\n    if(ptr == NULL) {\n        // Out of memory\n        printf("not enough memory (realloc returned NULL)\n");\n        return 0;\n    }\n\n    mem->memory = ptr;\n    memcpy(&(mem->memory[mem->size]), contents, realsize);\n    mem->size += realsize;\n    mem->memory[mem->size] = 0;\n\n    return realsize;\n}\n\nint main(void) {\n    CURL *curl_handle;\n    CURLcode res;\n\n    struct MemoryStruct chunk;\n\n    chunk.memory = malloc(1);  // Initial size\n    chunk.size = 0;            // No data at this point\n\n    curl_global_init(CURL_GLOBAL_ALL);\n\n    curl_handle = curl_easy_init();\n\n    if(curl_handle) {\n        curl_easy_setopt(curl_handle, CURLOPT_URL, "http://example.com");\n        curl_easy_setopt(curl_handle, CURLOPT_WRITEFUNCTION, WriteMemoryCallback);\n        curl_easy_setopt(curl_handle, CURLOPT_WRITEDATA, (void *)&chunk);\n\n        // Set a user-agent to avoid being blocked by some servers\n        curl_easy_setopt(curl_handle, CURLOPT_USERAGENT, "libcurl-agent/1.0");\n\n        res = curl_easy_perform(curl_handle);\n\n        if(res != CURLE_OK) {\n            fprintf(stderr, "curl_easy_perform() failed: %s\n",\n                    curl_easy_strerror(res));\n        } else {\n            printf("%lu bytes retrieved\n", (unsigned long)chunk.size);\n            printf("Data: %s\n", chunk.memory); // UTF-8 encoded data\n        }\n\n        curl_easy_cleanup(curl_handle);\n        free(chunk.memory);\n    }\n\n    curl_global_cleanup();\n\n    return 0;\n}