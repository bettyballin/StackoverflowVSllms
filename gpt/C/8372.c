#include <stdio.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <sys/ptrace.h>\n#include <sys/types.h>\n#include <sys/wait.h>\n#include <sys/user.h>\n#include <errno.h>\n\nvoid find_child_processes(pid_t parent_pid) {\n    pid_t pid;\n    int status;\n\n    // Attach to the parent process\n    if (ptrace(PTRACE_ATTACH, parent_pid, NULL, NULL) == -1) {\n        perror("ptrace(PTRACE_ATTACH)");\n        exit(EXIT_FAILURE);\n    }\n\n    // Wait for the parent process to stop\n    waitpid(parent_pid, &status, 0);\n\n    // Set options to trace children\n    if (ptrace(PTRACE_SETOPTIONS, parent_pid, NULL, PTRACE_O_TRACEFORK | PTRACE_O_TRACEVFORK | PTRACE_O_TRACECLONE) == -1) {\n        perror("ptrace(PTRACE_SETOPTIONS)");\n        exit(EXIT_FAILURE);\n    }\n\n    while (1) {\n        pid = waitpid(-1, &status, __WALL);\n\n        if (pid == -1) {\n            if (errno == ECHILD) {\n                break;\n            } else {\n                perror("waitpid");\n                exit(EXIT_FAILURE);\n            }\n        }\n\n        if (WIFSTOPPED(status)) {\n            if (status >> 8 == (SIGTRAP | (PTRACE_EVENT_FORK << 8)) ||\n                status >> 8 == (SIGTRAP | (PTRACE_EVENT_VFORK << 8)) ||\n                status >> 8 == (SIGTRAP | (PTRACE_EVENT_CLONE << 8))) {\n                \n                // Get the new child process ID\n                unsigned long new_pid;\n                if (ptrace(PTRACE_GETEVENTMSG, pid, NULL, &new_pid) == -1) {\n                    perror("ptrace(PTRACE_GETEVENTMSG)");\n                    exit(EXIT_FAILURE);\n                }\n\n                printf("New child process: %lu\n", new_pid);\n\n                // Continue the child process\n                if (ptrace(PTRACE_CONT, new_pid, NULL, NULL) == -1) {\n                    perror("ptrace(PTRACE_CONT)");\n                    exit(EXIT_FAILURE);\n                }\n            }\n\n            // Continue the traced process\n            if (ptrace(PTRACE_CONT, pid, NULL, NULL) == -1) {\n                perror("ptrace(PTRACE_CONT)");\n                exit(EXIT_FAILURE);\n            }\n        }\n    }\n\n    // Detach from the parent process\n    if (ptrace(PTRACE_DETACH, parent_pid, NULL, NULL) == -1) {\n        perror("ptrace(PTRACE_DETACH)");\n        exit(EXIT_FAILURE);\n    }\n}\n\nint main(int argc, char *argv[]) {\n    if (argc != 2) {\n        fprintf(stderr, "Usage: %s <parent_pid>\n", argv[0]);\n        exit(EXIT_FAILURE);\n    }\n\n    pid_t parent_pid = atoi(argv[1]);\n    find_child_processes(parent_pid);\n\n    return 0;\n}