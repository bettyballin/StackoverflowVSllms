#include <jni.h>\n#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <pwd.h>\n#include "FilePermissionChecker.h"\n\nJNIEXPORT jboolean JNICALL Java_FilePermissionChecker_checkFileAccess(JNIEnv *env, jobject obj, jstring path, jstring username) {\n    const char *filePath = (*env)->GetStringUTFChars(env, path, 0);\n    const char *user = (*env)->GetStringUTFChars(env, username, 0);\n\n    struct passwd *pwd = getpwnam(user);\n    if (pwd == NULL) {\n        (*env)->ReleaseStringUTFChars(env, path, filePath);\n        (*env)->ReleaseStringUTFChars(env, username, user);\n        return JNI_FALSE;\n    }\n\n    uid_t original_uid = geteuid();\n    seteuid(pwd->pw_uid);\n\n    int result = access(filePath, R_OK);\n\n    seteuid(original_uid);\n\n    (*env)->ReleaseStringUTFChars(env, path, filePath);\n    (*env)->ReleaseStringUTFChars(env, username, user);\n\n    return (result == 0) ? JNI_TRUE : JNI_FALSE;\n}