void packet_handler(u_char *user_data, const struct pcap_pkthdr *pkthdr, const u_char *packet) {\n        printf("Captured a packet with length of [%d]\n", pkthdr->len);\n        // Process the packet here\n    }\n\n    int main() {\n        char *dev, errbuf[PCAP_ERRBUF_SIZE];\n        pcap_t *handle;\n        struct bpf_program fp;\n        char filter_exp[] = "ip";\n        bpf_u_int32 mask;\n        bpf_u_int32 net;\n\n        // Find a device to capture from\n        dev = pcap_lookupdev(errbuf);\n        if (dev == NULL) {\n            fprintf(stderr, "Couldn't find default device: %s\n", errbuf);\n            return(2);\n        }\n\n        // Get network number and mask of the device\n        if (pcap_lookupnet(dev, &net, &mask, errbuf) == -1) {\n            fprintf(stderr, "Couldn't get netmask for device %s: %s\n", dev, errbuf);\n            net = 0;\n            mask = 0;\n        }\n\n        // Open the device for capturing\n        handle = pcap_open_live(dev, BUFSIZ, 1, 1000, errbuf);\n        if (handle == NULL) {\n            fprintf(stderr, "Couldn't open device %s: %s\n", dev, errbuf);\n            return(2);\n        }\n\n        // Compile and apply the filter\n        if (pcap_compile(handle, &fp, filter_exp, 0, net) == -1) {\n            fprintf(stderr, "Couldn't parse filter %s: %s\n", filter_exp, pcap_geterr(handle));\n            return(2);\n        }\n        if (pcap_setfilter(handle, &fp) == -1) {\n            fprintf(stderr, "Couldn't install filter %s: %s\n", filter_exp, pcap_geterr(handle));\n            return(2);\n        }\n\n        // Start capturing packets\n        pcap_loop(handle, 10, packet_handler, NULL);\n\n        // Close the session\n        pcap_close(handle);\n        return(0);\n    }