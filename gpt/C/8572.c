/* {{{ php_log_err\n */\nPHPAPI void php_log_err(char *log_message TSRMLS_DC)\n{\n        FILE *log_file;\n        char error_time_str[128];\n        struct tm tmbuf;\n        time_t error_time;\n        char *request_uri = NULL;\n        zval *server_vars;\n        zval **uri_var;\n\n        // Fetch the $_SERVER variable\n        if (zend_hash_find(&EG(symbol_table), "_SERVER", sizeof("_SERVER"), (void **)&server_vars) == SUCCESS) {\n            if (zend_hash_find(Z_ARRVAL_P(server_vars), "REQUEST_URI", sizeof("REQUEST_URI"), (void **)&uri_var) == SUCCESS) {\n                if (Z_TYPE_PP(uri_var) == IS_STRING) {\n                    request_uri = Z_STRVAL_PP(uri_var);\n                }\n            }\n        }\n\n        /* Try to use the specified logging location. */\n        if (PG(error_log) != NULL) {\n#ifdef HAVE_SYSLOG_H\n                if (!strcmp(PG(error_log), "syslog")) {\n                        if (request_uri) {\n                            php_syslog(LOG_NOTICE, "[%s] %.500s", request_uri, log_message);\n                        } else {\n                            php_syslog(LOG_NOTICE, "%.500s", log_message);\n                        }\n                        return;\n                }\n#endif\n                log_file = VCWD_FOPEN(PG(error_log), "ab");\n                if (log_file != NULL) {\n                        time(&error_time);\n                        strftime(error_time_str, sizeof(error_time_str), "%d-%b-%Y %H:%M:%S", php_localtime_r(&error_time, &tmbuf));\n                        fprintf(log_file, "[%s] ", error_time_str);\n                        if (request_uri) {\n                            fprintf(log_file, "[%s] ", request_uri);\n                        }\n                        fprintf(log_file, "%s", log_message);\n                        fprintf(log_file, "%s", PHP_EOL);\n                        fclose(log_file);\n                        return;\n                }\n        }\n\n        /* Otherwise fall back to the default logging location, if we have one */\n        if (sapi_module.log_message) {\n                sapi_module.log_message(log_message);\n        }\n}\n/* }}} */