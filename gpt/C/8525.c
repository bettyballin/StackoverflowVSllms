#include <openssl/pem.h>\n#include <openssl/rsa.h>\n#include <openssl/sha.h>\n#include <openssl/err.h>\n#include <string.h>\n\n// Function to verify product key\nint verify_product_key(const char *product_key, unsigned char *signature, size_t signature_len) {\n    FILE *fp = fopen("public_key.pem", "r");\n    if (!fp) return -1;\n\n    RSA *rsa = PEM_read_RSA_PUBKEY(fp, NULL, NULL, NULL);\n    fclose(fp);\n    if (!rsa) return -1;\n\n    unsigned char hash[SHA256_DIGEST_LENGTH];\n    SHA256((unsigned char*)product_key, strlen(product_key), hash);\n\n    int result = RSA_verify(NID_sha256, hash, SHA256_DIGEST_LENGTH, signature, signature_len, rsa);\n    RSA_free(rsa);\n\n    return result == 1 ? 0 : -1;\n}