#include <pcap.h>\n#include <stdio.h>\n\nvoid packet_handler(u_char *user, const struct pcap_pkthdr *header, const u_char *packet) {\n    printf("Packet captured: length %d\n", header->len);\n}\n\nint main() {\n    char errbuf[PCAP_ERRBUF_SIZE];\n    pcap_t *handle;\n\n    // Open the device for capturing\n    handle = pcap_open_live("eth0", BUFSIZ, 1, 1000, errbuf);\n    if (handle == NULL) {\n        fprintf(stderr, "Could not open device: %s\n", errbuf);\n        return 2;\n    }\n\n    // Start the packet capture loop\n    pcap_loop(handle, 10, packet_handler, NULL);\n\n    // Close the handle\n    pcap_close(handle);\n    return 0;\n}