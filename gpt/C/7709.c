#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <unistd.h>\n#include <sys/types.h>\n#include <sys/socket.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/select.h>\n\nint main(int argc, char *argv[]) {\n    int server_fd, client_fd, port, max_sd;\n    struct sockaddr_in server_addr, client_addr;\n    fd_set readfds;\n    socklen_t addr_len = sizeof(client_addr);\n    char buffer[1024];\n    \n    if (argc != 2) {\n        fprintf(stderr, "Usage: %s <port>\n", argv[0]);\n        exit(EXIT_FAILURE);\n    }\n    \n    port = atoi(argv[1]);\n    server_fd = socket(AF_INET, SOCK_STREAM, 0);\n    if (server_fd < 0) {\n        perror("socket");\n        exit(EXIT_FAILURE);\n    }\n    \n    server_addr.sin_family = AF_INET;\n    server_addr.sin_addr.s_addr = INADDR_ANY;\n    server_addr.sin_port = htons(port);\n    \n    if (bind(server_fd, (struct sockaddr *)&server_addr, sizeof(server_addr)) < 0) {\n        perror("bind");\n        close(server_fd);\n        exit(EXIT_FAILURE);\n    }\n    \n    if (listen(server_fd, 5) < 0) {\n        perror("listen");\n        close(server_fd);\n        exit(EXIT_FAILURE);\n    }\n    \n    printf("Server listening on port %d\n", port);\n    \n    while (1) {\n        FD_ZERO(&readfds);\n        FD_SET(server_fd, &readfds);\n        max_sd = server_fd;\n        \n        client_fd = accept(server_fd, (struct sockaddr *)&client_addr, &addr_len);\n        if (client_fd < 0) {\n            perror("accept");\n            continue;\n        }\n        \n        printf("New connection from %s:%d\n", inet_ntoa(client_addr.sin_addr), ntohs(client_addr.sin_port));\n        \n        FD_SET(client_fd, &readfds);\n        if (client_fd > max_sd) {\n            max_sd = client_fd;\n        }\n        \n        int activity = select(max_sd + 1, &readfds, NULL, NULL, NULL);\n        if ((activity < 0) && (errno != EINTR)) {\n            perror("select");\n        }\n        \n        if (FD_ISSET(client_fd, &readfds)) {\n            int valread = read(client_fd, buffer, sizeof(buffer));\n            if (valread == 0) {\n                // Connection closed\n                printf("Client disconnected\n");\n                close(client_fd);\n                FD_CLR(client_fd, &readfds);\n            } else if (valread < 0) {\n                perror("read");\n                close(client_fd);\n                FD_CLR(client_fd, &readfds);\n            } else {\n                buffer[valread] = '\0';\n                printf("Received: %s\n", buffer);\n            }\n        }\n    }\n    \n    close(server_fd);\n    return 0;\n}