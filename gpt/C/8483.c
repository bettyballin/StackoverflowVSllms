#include <openssl/bio.h>\n#include <openssl/evp.h>\n#include <openssl/pem.h>\n#include <openssl/x509.h>\n#include <openssl/x509v3.h>\n\nint main() {\n    int ret = 0;\n\n    // Initialize OpenSSL\n    OpenSSL_add_all_algorithms();\n    ERR_load_BIO_strings();\n    ERR_load_crypto_strings();\n\n    // Generate key pair\n    EVP_PKEY *pkey = EVP_PKEY_new();\n    RSA *rsa = RSA_generate_key(2048, RSA_F4, NULL, NULL);\n    EVP_PKEY_assign_RSA(pkey, rsa);\n\n    // Create X509 certificate\n    X509 *x509 = X509_new();\n    ASN1_INTEGER_set(X509_get_serialNumber(x509), 1);\n    X509_gmtime_adj(X509_get_notBefore(x509), 0);\n    X509_gmtime_adj(X509_get_notAfter(x509), 31536000L); // Valid for 1 year\n    X509_set_pubkey(x509, pkey);\n\n    // Set the subject name\n    X509_NAME *name = X509_get_subject_name(x509);\n    X509_NAME_add_entry_by_txt(name, "C", MBSTRING_ASC, (unsigned char *)"US", -1, -1, 0);\n    X509_NAME_add_entry_by_txt(name, "O", MBSTRING_ASC, (unsigned char *)"My Organization", -1, -1, 0);\n    X509_NAME_add_entry_by_txt(name, "CN", MBSTRING_ASC, (unsigned char *)"localhost", -1, -1, 0);\n    X509_set_issuer_name(x509, name); // Self-signed\n\n    // Sign the certificate\n    X509_sign(x509, pkey, EVP_sha256());\n\n    // Write the private key to a file\n    FILE *pkey_file = fopen("private_key.pem", "wb");\n    PEM_write_PrivateKey(pkey_file, pkey, NULL, NULL, 0, NULL, NULL);\n    fclose(pkey_file);\n\n    // Write the certificate to a file\n    FILE *x509_file = fopen("certificate.pem", "wb");\n    PEM_write_X509(x509_file, x509);\n    fclose(x509_file);\n\n    // Clean up\n    X509_free(x509);\n    EVP_PKEY_free(pkey);\n    CRYPTO_cleanup_all_ex_data();\n    ERR_free_strings();\n\n    return ret;\n}