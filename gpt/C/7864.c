#include <stdint.h>\n\n// CRC-16-CCITT polynomial: x^16 + x^12 + x^5 + 1 (0x1021)\n#define CRC16_POLY 0x1021\n\nuint16_t crc16(const uint8_t *data, size_t length) {\n    uint16_t crc = 0xFFFF;  // Initial value\n    for (size_t i = 0; i < length; i++) {\n        crc ^= (uint16_t)data[i] << 8;\n        for (uint8_t j = 0; j < 8; j++) {\n            if (crc & 0x8000) {\n                crc = (crc << 1) ^ CRC16_POLY;\n            } else {\n                crc <<= 1;\n            }\n        }\n    }\n    return crc;\n}