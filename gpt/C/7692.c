#include <sys/ptrace.h>\n   #include <sys/types.h>\n   #include <sys/wait.h>\n   #include <unistd.h>\n   #include <sys/syscall.h>\n   #include <stdio.h>\n\n   int main() {\n       pid_t child;\n       long orig_rax;\n       child = fork();\n       if(child == 0) {\n           ptrace(PTRACE_TRACEME, 0, NULL, NULL);\n           execl("/bin/ls", "ls", NULL);\n       } else {\n           wait(NULL);\n           while(1) {\n               ptrace(PTRACE_SYSCALL, child, NULL, NULL);\n               wait(NULL);\n               orig_rax = ptrace(PTRACE_PEEKUSER, child, sizeof(long)*ORIG_RAX, NULL);\n               printf("Syscall: %ld\n", orig_rax);\n               if(orig_rax == SYS_exit || orig_rax == SYS_exit_group)\n                   break;\n               ptrace(PTRACE_SYSCALL, child, NULL, NULL);\n               wait(NULL);\n           }\n       }\n       return 0;\n   }