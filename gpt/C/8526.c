#include <openssl/pem.h>\n#include <openssl/rsa.h>\n#include <openssl/sha.h>\n#include <openssl/err.h>\n#include <string.h>\n\n// Function to sign product key\nint sign_product_key(const char *product_key, unsigned char *signature, size_t *signature_len) {\n    FILE *fp = fopen("private_key.pem", "r");\n    if (!fp) return -1;\n\n    RSA *rsa = PEM_read_RSAPrivateKey(fp, NULL, NULL, NULL);\n    fclose(fp);\n    if (!rsa) return -1;\n\n    unsigned char hash[SHA256_DIGEST_LENGTH];\n    SHA256((unsigned char*)product_key, strlen(product_key), hash);\n\n    if (RSA_sign(NID_sha256, hash, SHA256_DIGEST_LENGTH, signature, (unsigned int*)signature_len, rsa) != 1) {\n        RSA_free(rsa);\n        return -1;\n    }\n\n    RSA_free(rsa);\n    return 0;\n}