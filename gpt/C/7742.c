#include <stdio.h>\n#include <stdlib.h>\n#include <resolv.h>\n#include <netinet/in.h>\n#include <arpa/nameser.h>\n#include <string.h>\n\nvoid query_mx_records(const char *domain) {\n    unsigned char response[NS_PACKETSZ];\n    ns_msg handle;\n    ns_rr rr;\n    int response_length;\n\n    // Query for MX records\n    response_length = res_query(domain, ns_c_in, ns_t_mx, response, sizeof(response));\n\n    if (response_length < 0) {\n        perror("res_query");\n        return;\n    }\n\n    if (ns_initparse(response, response_length, &handle) < 0) {\n        perror("ns_initparse");\n        return;\n    }\n\n    // Loop through the answer section\n    int count = ns_msg_count(handle, ns_s_an);\n    for (int i = 0; i < count; ++i) {\n        if (ns_parserr(&handle, ns_s_an, i, &rr) < 0) {\n            perror("ns_parserr");\n            return;\n        }\n\n        // Check if this is an MX record\n        if (ns_rr_type(rr) == ns_t_mx) {\n            const unsigned char *rdata = ns_rr_rdata(rr);\n            uint16_t preference = ntohs(*(uint16_t *)rdata);\n            char exchange[NS_MAXDNAME];\n            if (dn_expand(response, response + response_length, rdata + 2, exchange, sizeof(exchange)) < 0) {\n                perror("dn_expand");\n                return;\n            }\n            printf("MX Record: Preference = %d, Exchange = %s\n", preference, exchange);\n        }\n    }\n}\n\nint main(int argc, char *argv[]) {\n    if (argc != 2) {\n        fprintf(stderr, "Usage: %s <domain>\n", argv[0]);\n        return EXIT_FAILURE;\n    }\n\n    // Initialize resolver\n    if (res_init() < 0) {\n        perror("res_init");\n        return EXIT_FAILURE;\n    }\n\n    query_mx_records(argv[1]);\n\n    return EXIT_SUCCESS;\n}