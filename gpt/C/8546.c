#include <stdio.h>\n    #include <string.h>\n    #include <curl/curl.h>\n\n    static const char *payload_text[] = {\n      "To: recipient@example.com\r\n",\n      "From: sender@example.com\r\n",\n      "Subject: Test Email\r\n",\n      "\r\n", /* empty line to divide headers from body, see RFC5322 */\n      "This is a test email sent using libcurl.\r\n",\n      NULL\n    };\n\n    struct upload_status {\n      int lines_read;\n    };\n\n    static size_t payload_source(void *ptr, size_t size, size_t nmemb, void *userp) {\n      struct upload_status *upload_ctx = (struct upload_status *)userp;\n      const char *data;\n\n      if ((size == 0) || (nmemb == 0) || ((size * nmemb) < 1)) {\n        return 0;\n      }\n\n      data = payload_text[upload_ctx->lines_read];\n\n      if (data) {\n        size_t len = strlen(data);\n        memcpy(ptr, data, len);\n        upload_ctx->lines_read++;\n        return len;\n      }\n\n      return 0;\n    }\n\n    int main(void) {\n      CURL *curl;\n      CURLcode res = CURLE_OK;\n      struct curl_slist *recipients = NULL;\n      struct upload_status upload_ctx;\n      \n      upload_ctx.lines_read = 0;\n\n      curl = curl_easy_init();\n      if (curl) {\n        /* Set the URL for the SMTP server */\n        curl_easy_setopt(curl, CURLOPT_URL, "smtp://smtp.example.com:25");\n\n        /* Set the username and password if needed */\n        curl_easy_setopt(curl, CURLOPT_USERNAME, "your_username");\n        curl_easy_setopt(curl, CURLOPT_PASSWORD, "your_password");\n\n        /* Set the sender */\n        curl_easy_setopt(curl, CURLOPT_MAIL_FROM, "<sender@example.com>");\n\n        /* Add recipients */\n        recipients = curl_slist_append(recipients, "<recipient@example.com>");\n        curl_easy_setopt(curl, CURLOPT_MAIL_RCPT, recipients);\n\n        /* Specify the payload */\n        curl_easy_setopt(curl, CURLOPT_READFUNCTION, payload_source);\n        curl_easy_setopt(curl, CURLOPT_READDATA, &upload_ctx);\n        curl_easy_setopt(curl, CURLOPT_UPLOAD, 1L);\n\n        /* Send the message */\n        res = curl_easy_perform(curl);\n\n        /* Check for errors */\n        if (res != CURLE_OK) {\n          fprintf(stderr, "curl_easy_perform() failed: %s\n", curl_easy_strerror(res));\n        }\n\n        /* Clean up */\n        curl_slist_free_all(recipients);\n        curl_easy_cleanup(curl);\n      }\n\n      return (int)res;\n    }