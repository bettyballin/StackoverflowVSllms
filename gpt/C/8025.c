#include <stdio.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <string.h>\n#include <sys/socket.h>\n#include <linux/netlink.h>\n#include <linux/rtnetlink.h>\n\n#define BUFFER_SIZE 8192\n\nvoid handle_netlink_message(struct nlmsghdr *nlh) {\n    struct ifinfomsg *ifi;\n    struct rtattr *rta;\n    int len;\n\n    ifi = NLMSG_DATA(nlh);\n    rta = IFLA_RTA(ifi);\n    len = IFLA_PAYLOAD(nlh);\n\n    for (; RTA_OK(rta, len); rta = RTA_NEXT(rta, len)) {\n        if (rta->rta_type == IFLA_IFNAME) {\n            printf("Interface %s changed\n", (char *)RTA_DATA(rta));\n        }\n    }\n}\n\nint main() {\n    int sock;\n    struct sockaddr_nl addr;\n    struct nlmsghdr *nlh;\n    char buffer[BUFFER_SIZE];\n    int len;\n\n    sock = socket(AF_NETLINK, SOCK_RAW, NETLINK_ROUTE);\n    if (sock < 0) {\n        perror("socket");\n        exit(EXIT_FAILURE);\n    }\n\n    memset(&addr, 0, sizeof(addr));\n    addr.nl_family = AF_NETLINK;\n    addr.nl_groups = RTMGRP_LINK;\n\n    if (bind(sock, (struct sockaddr *)&addr, sizeof(addr)) < 0) {\n        perror("bind");\n        close(sock);\n        exit(EXIT_FAILURE);\n    }\n\n    while (1) {\n        len = recv(sock, buffer, sizeof(buffer), 0);\n        if (len < 0) {\n            perror("recv");\n            close(sock);\n            exit(EXIT_FAILURE);\n        }\n\n        for (nlh = (struct nlmsghdr *)buffer; NLMSG_OK(nlh, len); nlh = NLMSG_NEXT(nlh, len)) {\n            if (nlh->nlmsg_type == NLMSG_DONE) {\n                break;\n            }\n            if (nlh->nlmsg_type == NLMSG_ERROR) {\n                fprintf(stderr, "Received error message\n");\n                close(sock);\n                exit(EXIT_FAILURE);\n            }\n            handle_netlink_message(nlh);\n        }\n    }\n\n    close(sock);\n    return 0;\n}