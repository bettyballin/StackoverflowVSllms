#include <sys/ptrace.h>\n#include <sys/types.h>\n#include <sys/wait.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <stdlib.h>\n\nvoid trace_process(pid_t pid) {\n    int status;\n    while (1) {\n        waitpid(pid, &status, 0);\n        if (WIFEXITED(status))\n            break;\n        if (WIFSTOPPED(status) && WSTOPSIG(status) == SIGTRAP) {\n            // A new child has been forked\n            struct user_regs_struct regs;\n            ptrace(PTRACE_GETREGS, pid, NULL, &regs);\n            pid_t new_child_pid = regs.rdi;  // On x86_64, the child PID is in RDI\n            printf("New child process with PID: %d\n", new_child_pid);\n        }\n        ptrace(PTRACE_SYSCALL, pid, NULL, NULL);\n    }\n}\n\nint main(int argc, char* argv[]) {\n    pid_t pid = fork();\n    if (pid == 0) {\n        // Child process\n        ptrace(PTRACE_TRACEME, 0, NULL, NULL);\n        execl("/path/to/your/program", "your_program", NULL);\n    } else {\n        // Parent process\n        trace_process(pid);\n    }\n    return 0;\n}