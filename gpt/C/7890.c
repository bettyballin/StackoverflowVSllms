#include <stdio.h>\n#include <string.h>\n#include <openssl/blowfish.h>\n\n#define BLOCK_SIZE 8\n\nint main() {\n    BF_KEY s_key;\n    char plain[1000000]; // the plaintext of the message\n    char cipher[1000000]; // the ciphertext of the message\n    char msg[1000000]; // the input msg from the user\n    char IV[8] = "MY*IV000"; // the initialization vector\n    int q = 0; // index reader\n    char in; // to read characters\n\n    printf("Please enter the message you wish to send:\n");\n\n    // Read the input message\n    while ((in = getchar()) != '?') {\n        msg[q++] = in;\n    }\n    msg[q] = '\0'; // truncate the string with the null character\n\n    // Padding the message to make its length a multiple of BLOCK_SIZE\n    int msg_len = strlen(msg);\n    int pad_len = BLOCK_SIZE - (msg_len % BLOCK_SIZE);\n    for (int i = 0; i < pad_len; i++) {\n        msg[msg_len + i] = pad_len; // PKCS5 padding\n    }\n    msg[msg_len + pad_len] = '\0';\n    msg_len += pad_len;\n\n    // Set up the shared key of the BF encryption\n    char dkey_buf[] = "your-secret-key"; // Replace with actual key\n    BF_set_key(&s_key, strlen(dkey_buf), (unsigned char*)dkey_buf);\n\n    // Encrypt the message\n    BF_cbc_encrypt((unsigned char*)msg, (unsigned char*)cipher, msg_len, &s_key, (unsigned char*)IV, BF_ENCRYPT);\n\n    // Decrypt the message\n    BF_cbc_encrypt((unsigned char*)cipher, (unsigned char*)plain, msg_len, &s_key, (unsigned char*)IV, BF_DECRYPT);\n\n    // Remove padding\n    pad_len = plain[msg_len - 1];\n    plain[msg_len - pad_len] = '\0';\n\n    printf("plain after decryption: %s\n", plain);\n\n    return 0;\n}