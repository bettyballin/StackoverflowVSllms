#include <pthread.h>\n#include <stdio.h>\n\ntypedef struct {\n    pthread_mutex_t mutex;\n    int lock;\n} test_and_set_lock;\n\nvoid init_lock(test_and_set_lock *lock) {\n    pthread_mutex_init(&lock->mutex, NULL);\n    lock->lock = 0;\n}\n\nint test_and_set(test_and_set_lock *lock) {\n    int old_value;\n    pthread_mutex_lock(&lock->mutex);\n    old_value = lock->lock;\n    lock->lock = 1;\n    pthread_mutex_unlock(&lock->mutex);\n    return old_value;\n}\n\nvoid acquire_lock(test_and_set_lock *lock) {\n    while (test_and_set(lock)) {\n        // Busy wait\n    }\n}\n\nvoid release_lock(test_and_set_lock *lock) {\n    pthread_mutex_lock(&lock->mutex);\n    lock->lock = 0;\n    pthread_mutex_unlock(&lock->mutex);\n}\n\nint main() {\n    test_and_set_lock lock;\n    init_lock(&lock);\n\n    // Example usage of the lock\n    acquire_lock(&lock);\n    // Critical section\n    release_lock(&lock);\n\n    pthread_mutex_destroy(&lock.mutex);\n    return 0;\n}