#include <ntddk.h>\n\nNTSTATUS\nMyFilterCreateClose(\n    PDEVICE_OBJECT DeviceObject,\n    PIRP Irp\n)\n{\n    PIO_STACK_LOCATION irpSp = IoGetCurrentIrpStackLocation(Irp);\n\n    if (irpSp->MajorFunction == IRP_MJ_CREATE)\n    {\n        PEPROCESS process = IoGetRequestorProcess(Irp);\n        CHAR imageName[256] = { 0 };\n\n        if (process)\n        {\n            RtlCopyMemory(imageName, PsGetProcessImageFileName(process), sizeof(imageName));\n            DbgPrint("File opened by process: %s\n", imageName);\n        }\n    }\n\n    Irp->IoStatus.Status = STATUS_SUCCESS;\n    IoCompleteRequest(Irp, IO_NO_INCREMENT);\n    return STATUS_SUCCESS;\n}\n\nVOID\nDriverUnload(\n    _In_ PDRIVER_OBJECT DriverObject\n)\n{\n    UNREFERENCED_PARAMETER(DriverObject);\n    DbgPrint("Driver Unloading\n");\n}\n\nNTSTATUS\nDriverEntry(\n    _In_ PDRIVER_OBJECT DriverObject,\n    _In_ PUNICODE_STRING RegistryPath\n)\n{\n    UNREFERENCED_PARAMETER(RegistryPath);\n\n    DriverObject->MajorFunction[IRP_MJ_CREATE] = MyFilterCreateClose;\n    DriverObject->DriverUnload = DriverUnload;\n\n    DbgPrint("Driver Loaded\n");\n    return STATUS_SUCCESS;\n}