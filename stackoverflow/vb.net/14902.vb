Dim connString As String = "Provider=Microsoft.Jet.OLEDB.4.0" & _\n                           ";Data Source=" & ExcelFile & _\n                           ";Extended Properties=Excel 8.0;"\n\nDim conn As OleDbConnection = Nothing\nDim dt As System.Data.DataTable = Nothing\nDim excelDataSet As New DataSet()\n\nTry\n\n    conn = New OleDbConnection(connString)\n\n    conn.Open()\n    dt = conn.GetOleDbSchemaTable(OleDbSchemaGuid.Tables, Nothing)\n\n    If dt Is Nothing Then\n        Return Nothing\n    End If\n\n    Dim excelSheets(dt.Rows.Count) As String\n    Dim i As Integer = 0\n    For Each row As DataRow In dt.Rows\n        excelSheets(i) = row("TABLE_NAME").ToString\n        System.Math.Min(System.Threading.Interlocked.Increment(i), i - 1)\n        If i = SheetNumber Then\n            Exit For\n        End If\n    Next\n\n    Using excelCommand As New OleDbCommand("Select * from [" & excelSheets(SheetNumber - 1) & "]", conn)\n        Using excelAdapter As New OleDbDataAdapter(excelCommand)\n            excelAdapter.Fill(excelDataSet)\n        End Using\n    End Using\n\n\nCatch ex As OleDbException\n    Throw\nCatch ex As Exception\n    Throw\nFinally\n\n    conn.Close()\n\n    If conn IsNot Nothing Then\n        conn.Dispose()\n    End If\n\n    If dt IsNot Nothing Then\n        dt.Dispose()\n    End If\n\nEnd Try\n\nReturn excelDataSet