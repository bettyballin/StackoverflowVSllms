Dim msgPath As String = message.Path\n    Dim msgURI As String = message.URI\n    Dim msgID As String = message.ID\n\n    MyCredentialCache = New System.Net.CredentialCache()\n    MyCredentialCache.Add(New System.Uri(_inboxPath), "BASIC", New System.Net.NetworkCredential(_username, _password, _domain))\n\n    Dim request As WebRequest = WebRequest.Create(msgURI)\n    request.Credentials = MyCredentialCache\n    request.ContentType = "text/xml"\n    request.Headers.Add("Translate", "f")\n    Dim response As HttpWebResponse = CType(request.GetResponse(), HttpWebResponse)\n\n    Dim file As FileStream = New FileStream(msgPath, FileMode.CreateNew)\n    Dim stream As Stream = response.GetResponseStream()\n\n    Dim buffer() As Byte = New Byte(4096) {}\n    Dim len As Integer = stream.Read(buffer, 0, buffer.Length)\n\n    While (len > 0)\n        file.Write(buffer, 0, len)\n        len = stream.Read(buffer, 0, buffer.Length)\n    End While\n\n    file.Close()\n    stream.Close()