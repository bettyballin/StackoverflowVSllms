Dim i As Integer = 0\nDim CurUser As String = ""\nDim CurRole As String = ""\nDim result As new StringBuilder()\nDim r as DataRowCollection = ds.Tables(0).Rows\n\nWhile i < r.Count\n    'Next User:'\n    CurUser = r(i)("UserName")\n    result.AppendFormat("<h2>{0}</h2>", CurUser).AppendLine()\n    result.AppendLine("<table>")\n\n    While i < r.Count AndAlso CurUser = r(i)("UserName")\n        'Next Role:'\n        CurRole = r(i)("roleName")\n        result.AppendFormat("<tr><td>{0}</td></tr>", CurRole).AppendLine()\n\n        While i < r.Count AndAlso CurUser = r(i)("UserName") AndAlso CurRole = r(i)("roleName")\n            i += 1 'Next Record: same user, role '\n        End While\n        'Finished this role'\n    End While\n    'Finished this user:'\n     result.AppendLine("</table>").AppendLine()\nEnd While