public sub Backup()\n  Dim Conn As SqlClient.SqlConnection\n  dim theCommand as SqlClient.SQLCommand\n  Conn = New SqlClient.SqlConnection("Data Source=.\MyInstance;Initial Catalog=Master;Integrated Security=SSPI;")\n  theCommand = Conn.CreateCommand\n\n  theCommand.CommandText = "BACKUP DATABASE [MyDatabase] TO DISK = '" & mDatabasePath & "\" & Filenames.SQLBackup & "' WITH NOFORMAT, INIT, NAME = 'MyDatabase-Full Database Backup', SKIP, NOREWIND, NOUNLOAD, STATS = 10"\n\n  AddHandler Conn.InfoMessage, AddressOf onSqlInfoMessage\n  'make sure the events are fired as they are available, instead of at the end.\n  Conn.FireInfoMessageEventOnUserErrors = True\n\n  Conn.Open()\n\n  theCommand.ExecuteNonQuery()\n      RemoveHandler Conn.InfoMessage, AddressOf onSqlInfoMessage\n\n  Conn.Close()\n\nend sub \n\n   Private Sub onSqlInfoMessage(ByVal sender As Object, ByVal args As SqlClient.SqlInfoMessageEventArgs)\n        If args.Message.EndsWith("percent processed.") Then\n            Dim theMatch As System.Text.RegularExpressions.Match\n            theMatch = mRegEx.Match(args.Message)\n            debug.print("Progress = " & theMatch.Value.Trim)\n        End If\n    End Sub