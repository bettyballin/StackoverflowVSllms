Private Function OpenDatabaseWithShell(pDatabaseFullPath As String) As Access.Application\n\nDim AccObj As Access.Application\n\n    On Error GoTo ErrorHandler\n\n    Set OpenDatabaseWithShell = Nothing\n\n    Dim cmd As String\n\n    On Error Resume Next\n\n    ' basically build full msaccess.exe path and append database name and command switches\n    cmd = SysCmd(acSysCmdAccessDir) & "MSAccess.exe """ & psDatabaseFullPath & """"\n    cmd = cmd & " /nostartup /excl"\n\n    'start ms access with shell\n    Shell PathName:=cmd\n\n    Do 'Wait for shelled process to finish.\n      Err = 0\n      Set AccObj = GetObject(pDatabaseFullPath)\n    Loop While Err <> 0\n\n    On Error GoTo ErrorHandler\n\n    'return access object\n    Set OpenDatabaseWithShell = AccObj\n\nNormalExit:\n    Exit Function\n\nErrorHandler:\n    'error logging here\n    Exit Function\n\nEnd Functio