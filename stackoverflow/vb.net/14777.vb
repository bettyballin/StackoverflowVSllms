Imports System.ComponentModel\n\nPartial Public Class Page\n    Inherits UserControl\n    Private bw As BackgroundWorker = New BackgroundWorker\n\n    Public Sub New()\n        InitializeComponent()\n\n        bw.WorkerReportsProgress = True\n        bw.WorkerSupportsCancellation = True\n        AddHandler bw.DoWork, AddressOf bw_DoWork\n        AddHandler bw.ProgressChanged, AddressOf bw_ProgressChanged\n        AddHandler bw.RunWorkerCompleted, AddressOf bw_RunWorkerCompleted\n\n    End Sub\n    Private Sub buttonStart_Click(ByVal sender As System.Object, ByVal e As System.Windows.RoutedEventArgs)\n        If Not bw.IsBusy = True Then\n            bw.RunWorkerAsync()\n        End If\n    End Sub\n    Private Sub buttonCancel_Click(ByVal sender As System.Object, ByVal e As System.Windows.RoutedEventArgs)\n        If bw.WorkerSupportsCancellation = True Then\n            bw.CancelAsync()\n        End If\n    End Sub\n    Private Sub bw_DoWork(ByVal sender As Object, ByVal e As DoWorkEventArgs)\n        Dim worker As BackgroundWorker = CType(sender, BackgroundWorker)\n\n        For i = 1 To 10\n            If bw.CancellationPending = True Then\n                e.Cancel = True\n                Exit For\n            Else\n                ' Perform a time consuming operation and report progress.\n                System.Threading.Thread.Sleep(500)\n                bw.ReportProgress(i * 10)\n            End If\n        Next\n    End Sub\n    Private Sub bw_RunWorkerCompleted(ByVal sender As Object, ByVal e As RunWorkerCompletedEventArgs)\n        If e.Cancelled = True Then\n            Me.tbProgress.Text = "Canceled!"\n        ElseIf e.Error IsNot Nothing Then\n            Me.tbProgress.Text = "Error: " & e.Error.Message\n        Else\n            Me.tbProgress.Text = "Done!"\n        End If\n    End Sub\n    Private Sub bw_ProgressChanged(ByVal sender As Object, ByVal e As ProgressChangedEventArgs)\n        Me.tbProgress.Text = e.ProgressPercentage.ToString() & "%"\n    End Sub\nEnd Class