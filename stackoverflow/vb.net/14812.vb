Public Declare Function WNetAddConnection2 Lib "mpr.dll" Alias "WNetAddConnection2A" _\n( ByRef lpNetResource As NETRESOURCE, ByVal lpPassword As String, _\n  ByVal lpUserName As String, ByVal dwFlags As Integer) As Integer\n\n Public Declare Function WNetCancelConnection2 Lib "mpr" Alias   "WNetCancelConnection2A" _\n    (ByVal lpName As String, ByVal dwFlags As Integer, ByVal fForce As Integer) As Integer\n\n    <StructLayout(LayoutKind.Sequential)> _\nPublic Structure NETRESOURCE\n        Public dwScope As Integer\n        Public dwType As Integer\n        Public dwDisplayType As Integer\n        Public dwUsage As Integer\n        Public lpLocalName As String\n        Public lpRemoteName As String\n        Public lpComment As String\n        Public lpProvider As String\n    End Structure\n\nPublic Const ForceDisconnect As Integer = 1\nPublic Const RESOURCETYPE_DISK As Long = &H1\n\nPublic Function MapDrive(ByVal DriveLetter As String, ByVal UNCPath As String) As Boolean\n\n        Dim nr As NETRESOURCE\n        Dim strUsername As String\n        Dim strPassword As String\n\n        nr = New NETRESOURCE\n        nr.lpRemoteName = UNCPath\n        nr.lpLocalName = DriveLetter & ":"\n        strUsername = Nothing '(add parameters to pass this if necessary)\n        strPassword = Nothing '(add parameters to pass this if necessary)\n        nr.dwType = RESOURCETYPE_DISK\n\n        Dim result As Integer\n        result = WNetAddConnection2(nr, strPassword, strUsername, 0)\n\n        If result = 0 Then\n            Return True\n        Else\n            Return False\n        End If\n    End Function\n\nPublic Function UnMapDrive(ByVal DriveLetter As String) As Boolean\n    Dim rc As Integer\n        rc = WNetCancelConnection2(DriveLetter & ":", 0, ForceDisconnect)\n\n        If rc = 0 Then\n            Return True\n        Else\n            Return False\n        End If\n\n    End Functio