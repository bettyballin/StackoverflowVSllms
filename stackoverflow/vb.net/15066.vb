Imports System.Drawing.Imaging\n\nPublic Class Form1\n\nDim g As Graphics\nDim img As Image\nDim r As Rectangle\n\nPrivate Sub Form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load\n  ' load photo file into picture box and initialize graphics\n  img = Image.FromFile("c:\tmp.jpg")\n  PictureBox1.Image = New Bitmap(PictureBox1.Width, PictureBox1.Height, PixelFormat.Format32bppArgb)\n  g = Graphics.FromImage(PictureBox1.Image)\n  r = New Rectangle(0, 0, PictureBox1.Width, PictureBox1.Height)\n  g.DrawImage(img, r)\nEnd Sub\n\nPrivate Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click\n  Call setBrightness(0.2)\nEnd Sub\n\nSub setBrightness(ByVal Brightness As Single)\n  ' Brightness should be -1 (black) to 0 (neutral) to 1 (white)\n\n  Dim colorMatrixVal As Single()() = { _\n     New Single() {1, 0, 0, 0, 0}, _\n     New Single() {0, 1, 0, 0, 0}, _\n     New Single() {0, 0, 1, 0, 0}, _\n     New Single() {0, 0, 0, 1, 0}, _\n     New Single() {Brightness, Brightness, Brightness, 0, 1}}\n\n  Dim colorMatrix As New ColorMatrix(colorMatrixVal)\n  Dim ia As New ImageAttributes\n\n  ia.SetColorMatrix(colorMatrix, ColorMatrixFlag.Default, ColorAdjustType.Bitmap)\n\n  g.DrawImage(img, r, 0, 0, img.Width, img.Height, GraphicsUnit.Pixel, ia)\n  PictureBox1.Refresh()\nEnd Sub\n\nEnd Class