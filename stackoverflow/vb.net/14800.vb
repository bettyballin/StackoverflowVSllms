Public Class Foo \n    Private ReadOnly _fooId As FooId \n\n    Public Sub New() \n        _fooId = New FooId() \n    End Sub \n\n    Public ReadOnly Property Id() As Integer \n        Get \n            Return _fooId.Id \n        End Get \n    End Property \nEnd Class \n\nPublic NotInheritable Class FooId \n    Private Shared _nextId As Integer \n    Private ReadOnly _id As Integer \n\n    Shared Sub New() \n        _nextId = 0 \n    End Sub \n\n    Public Sub New() \n        SyncLock GetType(FooId) \n            _id = System.Math.Max(System.Threading.Interlocked.Increment(_nextId),_nextId - 1) \n        End SyncLock \n    End Sub \n\n    Public ReadOnly Property Id() As Integer \n        Get \n            Return _id \n        End Get \n    End Property \nEnd Class 