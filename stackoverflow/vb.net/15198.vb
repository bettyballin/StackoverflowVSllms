\n   Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click\n\n        Dim FileName As String = "c:\form1.vb"\n        Dim SourceFile As System.IO.FileInfo = New FileInfo(FileName)\n        Dim SourceTextStream As System.IO.TextReader = SourceFile.OpenText()\n\n        Dim SourceFileContent() As String = Split(SourceTextStream.ReadToEnd(), vbCrLf)\n        SourceTextStream.Close()\n\n        Dim CurrentSourceLine As String\n        Dim CurrentSourceLineNumber As Long\n\n        Dim DestStream As StreamWriter = New StreamWriter(FileName)\n        Dim LogStream As StreamWriter = New StreamWriter(FileName + ".log")\n\n        For Each CurrentSourceLine In SourceFileContent\n            CurrentSourceLineNumber += 1\n            If InStr(CurrentSourceLine, "UPGRADE_WARNING") = 0 Then\n                DestStream.WriteLine(CurrentSourceLine)\n            Else\n                ' Write to Log File\n                LogStream.WriteLine("Line Skipped at number: " + CurrentSourceLineNumber.ToString())\n            End If\n        Next\n\n        DestStream.Close()\n        LogStream.Close()\n\n\n\n\n    End Sub