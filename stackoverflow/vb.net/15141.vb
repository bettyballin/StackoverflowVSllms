Public Sub FillRoundedRectangle(ByVal g As Drawing.Graphics, ByVal r As Rectangle, ByVal d As Integer, ByVal b As Brush)\n    Dim mode As Drawing2D.SmoothingMode = g.SmoothingMode\n    g.SmoothingMode = System.Drawing.Drawing2D.SmoothingMode.HighSpeed\n    g.FillPie(b, r.X, r.Y, d, d, 180, 90)\n    g.FillPie(b, r.X + r.Width - d, r.Y, d, d, 270, 90)\n    g.FillPie(b, r.X, r.Y + r.Height - d, d, d, 90, 90)\n    g.FillPie(b, r.X + r.Width - d, r.Y + r.Height - d, d, d, 0, 90)\n    g.FillRectangle(b, CInt(r.X + d / 2), r.Y, r.Width - d, CInt(d / 2))\n    g.FillRectangle(b, r.X, CInt(r.Y + d / 2), r.Width, CInt(r.Height - d))\n    g.FillRectangle(b, CInt(r.X + d / 2), CInt(r.Y + r.Height - d / 2), CInt(r.Width - d), CInt(d / 2))\n    g.SmoothingMode = mode\nEnd Sub