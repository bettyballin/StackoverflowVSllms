Sub AllCodeToDesktop()\n   'The reference for the FileSystemObject Object is Windows Script Host Object Model\n   'but it not necessary to add the reference for this procedure.\n\n   Dim fs As Object\n   Dim f As Object\n   Dim strMod As String\n   Dim mdl As Object\n   Dim i As Integer\n\n   Set fs = CreateObject("Scripting.FileSystemObject")\n\n   'Set up the file.\n   Set f = fs.CreateTextFile(SpFolder(Desktop) & "\" _\n       & Replace(CurrentProject.Name, ".", "") & ".txt")\n\n   'For each component in the project ...\n   For Each mdl In VBE.ActiveVBProject.VBComponents\n       'using the count of lines ...\n       i = VBE.ActiveVBProject.VBComponents(mdl.Name).CodeModule.CountOfLines\n       'put the code in a string ...\n       If VBE.ActiveVBProject.VBComponents(mdl.Name).codemodule.CountOfLines > 0 Then\n          strMod = VBE.ActiveVBProject.VBComponents(mdl.Name).codemodule.Lines(1, i)\n       End If\n       'and then write it to a file, first marking the start with\n       'some equal signs and the component name.\n       f.writeline String(15, "=") & vbCrLf & mdl.Name _\n           & vbCrLf & String(15, "=") & vbCrLf & strMod\n   Next\n\n   'Close eveything\n   f.Close\n   Set fs = Nothing\nEnd Sub