Public Module ControlParser\n    Sub New()\n    End Sub\n    <System.Runtime.CompilerServices.Extension> _\n    Public Sub ForEachRecursive(ByVal ctrl As Control, ByVal callback As Action(Of Control), ByVal onMethodEnter As Action, ByVal onMethodLeave As Action)\n        onMethodEnter.Invoke()\n        \n        If ctrl Is Nothing Then\n            Exit Sub\n        End If\n        \n        callback(ctrl)\n        \n        For Each curCtrl As Control In ctrl.Controls\n            ForEachRecursive(curCtrl, callback, onMethodEnter, onMethodLeave)\n        Next\n        \n        onMethodLeave.Invoke()\n    End Sub\nEnd Module