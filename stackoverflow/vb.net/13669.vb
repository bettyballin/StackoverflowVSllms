Imports System.Threading\n\nImports System.IO\n\nImports System.Text\n\nImports System.IO.Ports\n\n\nPublic Class clsBarcodeScanner\n\nPublic Event ScanDataRecieved(ByVal data As String)\nWithEvents comPort As SerialPort\n\nPublic Sub Connect()\n    Try\n        comPort = My.Computer.Ports.OpenSerialPort("COM5", 9600)\n    Catch\n    End Try\nEnd Sub\n\nPublic Sub Disconnect()\n\n    If comPort IsNot Nothing AndAlso comPort.IsOpen Then\n        comPort.Close()\n    End If\n\nEnd Sub\n\nPrivate Sub comPort_DataReceived(ByVal sender As Object, ByVal e As System.IO.Ports.SerialDataReceivedEventArgs) Handles comPort.DataReceived\n    Dim str As String = ""\n    If e.EventType = SerialData.Chars Then\n        Do\n            Dim bytecount As Integer = comPort.BytesToRead\n\n            If bytecount = 0 Then\n                Exit Do\n            End If\n            Dim byteBuffer(bytecount) As Byte\n\n\n            comPort.Read(byteBuffer, 0, bytecount)\n            str = str & System.Text.Encoding.ASCII.GetString(byteBuffer, 0, 1)\n\n        Loop\n    End If\n\n    RaiseEvent ScanDataRecieved(str)\n\nEnd Sub\nEnd Class