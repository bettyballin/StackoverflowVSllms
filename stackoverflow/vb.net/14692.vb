Dim FieldRegEx As New Regex("@([A-Z_]+)", RegexOptions.IgnoreCase)\nDim Fields As Match = FieldRegEx.Match(Query)\nDim Processed As New ArrayList\n\nWhile Fields.Success\n    Dim Key As String = Fields.Groups(1).Value\n    Dim Val As Object = Request.QueryString(Key)\n    If Val = "" Then Val = DBNull.Value\n    If Not Processed.Contains(Key) Then\n        Command.Parameters.AddWithValue("@" & Key, Val)\n        Processed.Add(Key)\n    End If\n    Fields = Fields.NextMatch()\nEnd While