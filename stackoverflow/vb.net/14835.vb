Imports System.Runtime.InteropServices\n\nPublic Class Form2\n\n    Private Declare Sub keybd_event Lib "user32" ( _\n        ByVal bVk As Byte, _\n        ByVal bScan As Byte, _\n        ByVal dwFlags As Integer, _\n        ByVal dwExtraInfo As Integer _\n    )\n    Private Const VK_CAPITAL As Integer = &H14\n    Private Const KEYEVENTF_EXTENDEDKEY As Integer = &H1\n    Private Const KEYEVENTF_KEYUP As Integer = &H2\n\n    Private Sub Button1_Click( _\n        ByVal sender As System.Object, _\n        ByVal e As System.EventArgs _\n    ) Handles Button1.Click\n\n        ' Toggle CapsLock\n\n        ' Simulate the Key Press\n        keybd_event(VK_CAPITAL, &H45, KEYEVENTF_EXTENDEDKEY Or 0, 0)\n\n        ' Simulate the Key Release\n        keybd_event(VK_CAPITAL, &H45, KEYEVENTF_EXTENDEDKEY Or KEYEVENTF_KEYUP, 0)\n    End Sub\n\nEnd Class 