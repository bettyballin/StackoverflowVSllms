Function getOffice (strname, uname) \n\nstrEmail = uname\nWScript.Echo "email: " & strEmail \nDim objRoot : Set objRoot = GetObject("LDAP://RootDSE")\nDim objDomain : Set objDomain = GetObject("LDAP://" & objRoot.Get("defaultNamingContext"))\nDim cn : Set cn = CreateObject("ADODB.Connection")\nDim cmd : Set cmd = CreateObject("ADODB.Command")\ncn.Provider = "ADsDSOObject"\ncn.Open "Active Directory Provider"\nSet cmd.ActiveConnection = cn\n\ncmd.CommandText = "SELECT physicalDeliveryOfficeName FROM '" & objDomain.ADsPath & "' WHERE mail='" & strEmail & "'"\ncmd.Properties("Page Size") = 1\ncmd.Properties("Timeout") = 300\ncmd.Properties("Searchscope") = ADS_SCOPE_SUBTREE\n\nDim objRS : Set objRS = cmd.Execute\n    If IsNull(objRS.Fields(0)) = TRUE Then \n        getOffice = "BLANK"\n    Else \n    getOffice = objRS.Fields(0)\n    WScript.Echo getOffice \n    End If \n\n\nSet objRS = Nothing\nSet cmd = Nothing\nSet cn = Nothing\nSet objDomain = Nothing\nSet objRoot = Nothing\nEnd Function 