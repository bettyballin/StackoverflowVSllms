Private Sub openTSMitem(ByVal menu As ContextMenuStrip, ByVal selectitem As ToolStripMenuItem)\n\n    'The menu needs to be open befor we call ShowDropDown\n    menu.Show()\n\n    'The list will first contain the parents in the order of bottom to top\n    'then we will reverse it so we can open the submenus from top to bottom\n    'otherwise it will not open them all\n    Dim parentsRevOrder As ArrayList = New ArrayList()\n\n    'Add the parents to the list\n    Dim parentItem As ToolStripMenuItem = selectitem.OwnerItem\n    While Not parentItem Is Nothing\n        parentsRevOrder.Add(parentItem)\n        parentItem = parentItem.OwnerItem\n    End While\n    'reverse the list. now its in the order top to bottom\n    'and the submenus will open correctly\n    parentsRevOrder.Reverse()\n\n    'now loop through and open the submenus\n    For Each tsiParent As ToolStripMenuItem In parentsRevOrder\n        tsiParent.ShowDropDown()\n    Next\n\n    'and finally select the menuItem we want\n    selectitem.Select()\n\nEnd Sub