Friend Class RingBuffer(Of T)\n    Private _slots() As T\n    Private _head As Integer\n    Private _tail As Integer\n\n    Private _readableSlots As Semaphore\n    Private _readLock As Object\n    Private _writableSlots As Semaphore\n    Private _writeLock As Object\n\n    Public Sub New(ByVal size As Integer)\n        ReDim _slots(size - 1)\n\n        _head = 0\n        _tail = 0\n        _readLock = New Object\n        _writeLock = New Object\n\n        _readableSlots = New Semaphore(0, size)\n        _writableSlots = New Semaphore(size, size)\n    End Sub\n\n    Public Function Dequeue() As T\n        Dim item As T\n        _readableSlots.WaitOne()\n        SyncLock _readLock\n            item = _slots(_head)\n            _head = (_head + 1) Mod _slots.Length\n        End SyncLock\n        _writableSlots.Release()\n        Return item\n    End Function\n\n    Public Sub Enqueue(ByVal item As T)\n        _writableSlots.WaitOne()\n        SyncLock _writeLock\n            _slots(_tail) = item\n            _tail = (_tail + 1) Mod _slots.Length\n        End SyncLock\n        _readableSlots.Release()\n    End Sub\nEnd Class