\nImports System\nImports System.Drawing\nImports System.Windows.Forms\n\nModule modSnap\n\n    Public Const strApplicationTitle As String = "Snap Demo"\n    Public frmSnap As SnapForm\n    Public ptSnap, ptStart, ptEnd As Point\n\n    Public Class SnapForm\n        Inherits Form\n        Public Sub New()\n            Me.Text = "Snap Demo"\n            Me.ClientSize = New Size(800, 600)\n            Me.FormBorderStyle = Windows.Forms.FormBorderStyle.FixedSingle\n            Me.MaximizeBox = False\n            Me.StartPosition = FormStartPosition.CenterScreen\n            Me.DoubleBuffered = True\n        End Sub\n        Protected Overrides Sub OnPaint(ByVal e As System.Windows.Forms.PaintEventArgs)\n            MyBase.OnPaint(e)\n            e.Graphics.Clear(Color.Black)\n            For row As Integer = 20 To 780 Step 20\n                For col As Integer = 20 To 580 Step 20\n                    e.Graphics.DrawEllipse(Pens.Blue, New Rectangle(row - 2, col - 2, 4, 4))\n                Next\n            Next\n            e.Graphics.DrawLine(Pens.Red, ptStart, ptEnd)\n        End Sub\n        Protected Overrides Sub OnMouseDown(ByVal e As System.Windows.Forms.MouseEventArgs)\n            MyBase.OnMouseDown(e)\n            Dim x As Integer = CInt(e.X / 20) * 20\n            Dim y As Integer = CInt(e.Y / 20) * 20\n            ptStart = New Point(x, y)\n            ptSnap = New Point(x, y)\n            Windows.Forms.Cursor.Position = Me.PointToScreen(ptSnap)\n        End Sub\n        Protected Overrides Sub OnMouseMove(ByVal e As System.Windows.Forms.MouseEventArgs)\n            MyBase.OnMouseMove(e)\n            If e.Button = Windows.Forms.MouseButtons.Left Then\n                Dim x As Integer = CInt(e.X / 20) * 20\n                Dim y As Integer = CInt(e.Y / 20) * 20\n                ' must be some delta away from original snap point\n                If (x < ptSnap.X - 15 Or x > ptSnap.X + 15) Or (y < ptSnap.Y - 15 Or y > ptSnap.Y + 15) Then\n                    ptSnap = New Point(x, y)\n                    ptEnd = New Point(x, y)\n                    Me.Invalidate(False)\n                    Windows.Forms.Cursor.Position = Me.PointToScreen(ptSnap)\n                End If\n            End If\n        End Sub\n    End Class\n\n    Public Sub main()\n        Try\n            frmSnap = New SnapForm\n            Application.Run(frmSnap)\n        Catch ex As Exception\n            MessageBox.Show(ex.Message, strApplicationTitle, MessageBoxButtons.OK, MessageBoxIcon.Error)\n        Finally\n            frmSnap.Dispose()\n        End Try\n    End Sub\n\nEnd Module