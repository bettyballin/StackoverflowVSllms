Sub Main()\n\n      Dim tbl As DataTable\n\n      Dim colsA() As String = {"ProjectNo", "Quantity"}\n      Dim colsB() As String = {"Customer"}\n      Dim sKey As String = "ProjectNo"\n\n      tbl = MergeData(tblA, tblB, colsA, colsB, sKey)\n\n   End Sub\n\n   Private Function MergeData(ByVal tblA As DataTable, ByVal tblB As DataTable, _\n                              ByVal colsA() As String, ByVal colsB() As String, _\n                              ByVal sKey As String) As DataTable\n\n      Dim tbl As DataTable\n      Dim col As DataColumn\n      Dim sColumnName As String\n      Dim row As DataRow\n      Dim newRow As DataRow\n      Dim dv As DataView\n\n      tbl = New DataTable\n      dv = tblB.DefaultView\n\n      For Each sColumnName In colsA\n         col = tblA.Columns(sColumnName)\n         tbl.Columns.Add(New DataColumn(col.ColumnName, col.DataType))\n      Next\n      For Each sColumnName In colsB\n         col = tblB.Columns(sColumnName)\n         tbl.Columns.Add(New DataColumn(col.ColumnName, col.DataType))\n      Next\n\n      For Each row In tblA.Rows\n         newRow = tbl.NewRow\n         For Each sColumnName In colsA\n            newRow(sColumnName) = row(sColumnName)\n         Next\n\n         dv.RowFilter = (sKey & " = " & row(sKey).ToString)\n         If dv.Count = 1 Then\n            For Each sColumnName In colsB\n               newRow(sColumnName) = dv(0).Item(sColumnName)\n            Next\n         End If\n         tbl.Rows.Add(newRow)\n      Next\n\n      Return tbl\n\n   End Functio