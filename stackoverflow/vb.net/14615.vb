Dim strNTUser, strUser, strDN, strRootTDSE\nDim objRootDSE, objConnection, objCommand, objRecordSet, objUser, objNTUserInfo\n\nstrNTUser = Request.ServerVariables("AUTH_USER")\nstrUser = Mid(strNTUser,(instr(1,strNTUser,"\")+1),len(strNTUser))\n\nSet objConnection = Server.CreateObject("ADODB.Connection")\nSet objCommand = Server.CreateObject("ADODB.Command")\nobjConnection.Provider = "ADsDSOObject"\nobjConnection.Open "Active Directory Provider"\nSet objCommand.ActiveConnection = objConnection\n\n'objCommand.Properties("Page Size") = 1000'\nobjCommand.Properties("Searchscope") = 2 'ADS_SCOPE_SUBTREE \n\nSet objRootDSE = GetObject("LDAP://rootDSE")\nstrRootTDSE = objRootDSE.Get("defaultNamingContext")\nSet objRootDSE = Nothing\n\nobjCommand.CommandText = _\n    "SELECT distinguishedName FROM 'LDAP://" & strRootTDSE & "' " & _\n        "WHERE objectCategory='user' AND sAMAccountName = '" & strUser & "'" \n\nSet objRecordSet = objCommand.Execute\n\nIf Not objRecordSet.BOF Then objRecordSet.MoveFirst\nIf Not objRecordSet.EOF Then\n    strDN = objRecordSet.Fields("distinguishedName").Value\nEnd If\n\nSet objConnection = Nothing\nSet objCommand = Nothing\nSet objRecordSet = Nothing\n\nSet objUser = GetObject("LDAP://" & strDN)\n'I can now use objUser to get the details'