Private Sub DHTMLEdit1_onkeypress()\n    Dim e As Object\n    Set e = DHTMLEdit1.DOM.parentWindow.event\n    'Perform smart-quote replacement'\n    Select Case e.keyCode\n    Case 34: 'Double-Quote'\n        e.keyCode = 0\n        If IsAtWordEnd Then\n            InsertDoubleUndo ChrW$(8221), ChrW$(34)\n        Else\n            InsertDoubleUndo ChrW$(8220), ChrW$(34)\n        End If\n    Case 39: 'Single-Quote'\n        e.keyCode = 0\n        If IsAtWordEnd Then\n            InsertDoubleUndo ChrW$(8217), ChrW$(39)\n        Else\n            InsertDoubleUndo ChrW$(8216), ChrW$(39)\n        End If\n    End Select\nEnd Sub\n\nPrivate Function IsLetter(ByVal character As String) As Boolean\n    IsLetter = UCase$(character) <> LCase$(character)\nEnd Function\n\nPrivate Sub InsertDoubleUndo(VisibleText As String, HiddenText As String)\n    Dim selection As Object\n    Set selection = DHTMLEdit1.DOM.selection.createRange()\n    selection.Text = HiddenText\n    selection.moveStart "character", -Len(HiddenText)\n    selection.Text = VisibleText\nEnd Sub\n\nPrivate Function IsAtWordEnd() As Boolean\n\n    Dim ch As String\n    ch = PreviousChar\n    IsAtWordEnd = (ch <> " ") And (ch <> "")\n\nEnd Function\n\nPrivate Function PreviousChar() As String\n\n    Dim selection As Object\n    Set selection = m_dom.selection.createRange()\n    selection.moveStart "character", -1\n    PreviousChar = selection.Text\n\nEnd Functio