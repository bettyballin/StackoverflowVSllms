Protected Sub ddlCountry_SelectedIndexChanged(ByVal sender As Object, ByVal e As EventArgs)\n    Dim CountryID As Integer = Convert.ToInt32(ddlCountry.SelectedValue.ToString())\n    FillStates(CountryID)\nEnd Sub\n\n\nPrivate Sub FillStates(ByVal countryID As Integer)\n  Dim strConn As String = ConfigurationManager.ConnectionStrings("DatabaseConnectionString").ConnectionString\n  Dim con As New SqlConnection(strConn)\n  Dim cmd As New SqlCommand()\n  cmd.Connection = con\n  cmd.CommandType = CommandType.Text\n  cmd.CommandText = "Select StateID, State from State where CountryID =@CountryID"\n  cmd.Parameters.AddWithValue("@CountryID", countryID)\n  Dim objDs As New DataSet()\n  Dim dAdapter As New SqlDataAdapter()\n  dAdapter.SelectCommand = cmd\n  con.Open()\n  dAdapter.Fill(objDs)\n  con.Close()\n  If objDs.Tables(0).Rows.Count > 0 Then\n    ddlState.DataSource = objDs.Tables(0)\n    ddlState.DataTextField = "State"\n    ddlState.DataValueField = "StateID"\n    ddlState.DataBind()\n    ddlState.Items.Insert(0, "--Select--")\n  Else\n    lblMsg.Text = "No states found"\n  End If\n End Sub