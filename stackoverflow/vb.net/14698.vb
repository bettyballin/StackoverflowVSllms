Public Function ExecuteSSISExportPackage(ByVal parameterValue1 As String, ByVal destinationDatabasePath As String) As Integer\n\n    Dim pkg As New Package\n    Dim app As New Microsoft.SqlServer.Dts.Runtime.Application\n    Dim pkgResults As DTSExecResult\n    Dim result As Integer = 1 'defaults to failure\n    Dim eventListener As New EventListener()\n\n    'create SSIS variables for dynamic parameters, retrieved from the appSettings in the [app.config] file\n    Dim SSISPackagePassword As String = ConfigurationManager.AppSettings.Item("SSISPackagePassword")\n    Dim SSISExportPackagePath As String = ConfigurationManager.AppSettings.Item("SSISExportPackagePath")\n    Dim SSISExportPackageServerName As String = ConfigurationManager.AppSettings.Item("SSISExportPackageServerName")\n    Dim SSISExportPackageServerUserName As String = ConfigurationManager.AppSettings.Item("SSISExportPackageServerUserName")\n    Dim SSISExportPackageServerPassword As String = ConfigurationManager.AppSettings.Item("SSISExportPackageServerPassword")\n    Dim SSISExportPackageDestinationDBName As String = ConfigurationManager.AppSettings.Item("SSISExportPackageDestinationDBName")\n\n    Try\n        'set package password\n        app.PackagePassword = SSISPackagePassword\n        pkg.PackagePassword = SSISPackagePassword\n\n        'load package from SQL server\n        pkg = app.LoadFromSqlServer(SSISExportPackagePath, SSISExportPackageServerName, SSISExportPackageServerUserName, SSISExportPackageServerPassword, eventListener)\n\n        'set package-level variables, to supply to the stored procedure parameters/sql calls in the SSIS Export package\n        pkg.Variables("xxxx").Value = parameterValue1\n\n        'set the package-level variable to supply the Access DB's (SSIS destination) file path\n        Dim databaseName As String = ConfigurationManager.AppSettings.Item("XXXClientDatabaseName")\n        pkg.Variables("destinationDatabasePath").Value = "C:\" + databaseName \n\n        'Dynamic SQL source connection string values\n        pkg.Variables("sourceDatabaseLocation").Value = SSISExportPackageServerName\n        pkg.Variables("sourceDBUserID").Value = SSISExportPackageServerUserName\n        pkg.Variables("sourceDBName").Value = SSISExportPackageDestinationDBName\n        pkg.Variables("sourceDBPassword").Value = SSISExportPackageServerPassword\n\n        'Execute the Import SSIS package, add an eventListener object for SSIS reflection\n        pkgResults = pkg.Execute(Nothing, Nothing, eventListener, Nothing, Nothing)\n\n        'Package execution results\n        Select Case pkgResults\n\n            Case DTSExecResult.Success\n                result = 0\n\n            Case DTSExecResult.Failure\n                result = 1\n\n        End Select\n\n    Catch ex As Exception\n\n        'Log the exception error here - omitted\n\n    Finally\n        app = Nothing\n        pkg = Nothing\n    End Try\n\n    Return result\n\nEnd Functio