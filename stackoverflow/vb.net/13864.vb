Dim DocumentOpenedTimer As Timer\n\nPrivate Sub DocumentEvents_DocumentOpened(ByVal Document As EnvDTE.Document) Handles DocumentEvents.DocumentOpened\n    DocumentOpenedTimer = New Timer(AddressOf ExpandRegionsCallBack, Nothing, 200, Timeout.Infinite)\nEnd Sub\n\nPrivate Sub ExpandRegionsCallBack(ByVal state As Object)\n    ExpandRegions()\n    DocumentOpenedTimer.Dispose()\nEnd Sub\n\nPublic Sub ExpandRegions()\n    Dim Document As EnvDTE.Document = DTE.ActiveDocument\n    If (Document.FullName.EndsWith(".vb") OrElse Document.FullName.EndsWith(".cs")) Then\n        If Not DTE.ActiveWindow.Caption.ToUpperInvariant.Contains("design".ToUpperInvariant) Then\n            Document.DTE.SuppressUI = True\n            Document.DTE.ExecuteCommand("Edit.CollapsetoDefinitions")\n            Dim objSelection As TextSelection = Document.Selection\n            objSelection.StartOfDocument()\n            Do While objSelection.FindText("#region", vsFindOptions.vsFindOptionsMatchInHiddenText)\n            Loop\n            objSelection.StartOfDocument()\n            Document.DTE.SuppressUI = False\n        End If\n    End If\nEnd Sub