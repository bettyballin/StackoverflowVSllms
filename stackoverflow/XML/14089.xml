<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"\n    xmlns:msxsl="urn:schemas-microsoft-com:xslt" exclude-result-prefixes="msxsl">\n    <xsl:output method="xml" indent="yes"/>\n\n    <xsl:template match="/">\n        <table>\n            <xsl:apply-templates select="//element3"></xsl:apply-templates>\n        </table>\n    </xsl:template>\n\n    <xsl:template match="element3">\n        <tr>\n            <td><xsl:value-of select="../../@A"/></td>\n            <td><xsl:value-of select="../../@B"/></td>\n            <td><xsl:value-of select="../@C"/></td>\n            <td><xsl:value-of select="../@D"/></td>\n            <td><xsl:value-of select="@E"/></td>\n            <td><xsl:value-of select="@F"/></td>\n        </tr>\n        <xsl:apply-templates select="*"></xsl:apply-templates>\n    </xsl:template>\n\n</xsl:stylesheet>