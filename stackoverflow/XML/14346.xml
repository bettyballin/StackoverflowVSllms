<?xml version="1.0" encoding="UTF-8"?>\n<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">\n\n    <xsl:output method="xml" indent="yes" encoding="UTF-8"/>\n\n    <xsl:key name="muench" match="/root/item/status" use="."/>\n\n    <xsl:template match="/">\n        <root>\n        <xsl:for-each select="/root/item/status[generate-id() = generate-id(key('muench',.)[1])]">\n            <xsl:call-template name="pivot">\n                <xsl:with-param name="status" select="."/>\n            </xsl:call-template>\n        </xsl:for-each>\n        </root>\n    </xsl:template>\n\n    <xsl:template name="pivot">\n        <xsl:param name="status"/>\n        <items>\n            <status><xsl:value-of select="$status"/></status>\n            <xsl:for-each select="/root/item[status=$status]">\n                <name><xsl:value-of select="name"/></name>\n            </xsl:for-each>\n        </items>\n    </xsl:template>\n\n</xsl:stylesheet>