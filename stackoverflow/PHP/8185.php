public function reformatData($array) {\n    if (!is_array($array)) {\n        return false;\n    }\n\n    $cols = $this->info(Zend_Db_Table_Abstract::METADATA);\n\n    if (is_array($cols)) {\n        foreach ($cols as $col) {\n            if (array_key_exists($col['COLUMN_NAME'], $array)) {\n                switch ($col['DATA_TYPE']) {\n                    case 'int': case 'tinyint':\n                        if ($array[$col['COLUMN_NAME']] == '') {\n                            $newArray[$col['COLUMN_NAME']] = new Zend_Db_Expr('null');\n                        }\n                        else {\n                            $newArray[$col['COLUMN_NAME']] = $array[$col['COLUMN_NAME']];\n                        }\n                        break;\n\n                    case 'date':\n                        if ($array[$col['COLUMN_NAME']] == '') {\n                            $newArray[$col['COLUMN_NAME']] = new Zend_Db_Expr('null');\n                        }\n                        elseif(!Zend_Date::isDate($array[$col['COLUMN_NAME']], 'YYYY-MM-dd')) {\n                            $date = new Zend_Date($array[$col['COLUMN_NAME']], null, 'en_GB');\n                            $newArray[$col['COLUMN_NAME']] = $date->toString('YYYY-MM-dd'); \n                        }\n                        else {\n                            $newArray[$col['COLUMN_NAME']] = $array[$col['COLUMN_NAME']];\n                        }\n                        break;\n\n                    case 'datetime':\n                        if ($array[$col['COLUMN_NAME']] == '') {\n                            $newArray[$col['COLUMN_NAME']] = new Zend_Db_Expr('null');\n                        }\n                        elseif(!Zend_Date::isDate($array[$col['COLUMN_NAME']], 'YYYY-MM-dd HH:MM')) {\n                            $date = new Zend_Date($array[$col['COLUMN_NAME']], null, 'en_GB');\n                            $newArray[$col['COLUMN_NAME']] = $date->toString('YYYY-MM-dd HH:MM'); \n                        }\n                        else {\n                            $newArray[$col['COLUMN_NAME']] = $array[$col['COLUMN_NAME']];\n                        }\n                        break;\n\n                    default:\n                        $newArray[$col['COLUMN_NAME']] = $array[$col['COLUMN_NAME']];\n                        break;\n                }           \n            }\n        }\n        return $newArray;\n    }\n    else {\n        return false;\n    }\n}