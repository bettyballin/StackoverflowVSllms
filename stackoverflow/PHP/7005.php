<?php\nfunction tidyHTML($buffer) {\n    // load our document into a DOM object\n    $dom = new DOMDocument();\n    // we want nice output\n    $dom->preserveWhiteSpace = false;\n    $dom->loadHTML($buffer);\n    $dom->formatOutput = true;\n    return($dom->saveHTML());\n}\n\n// start output buffering, using our nice\n// callback function to format the output.\nob_start("tidyHTML");\n\n?>\n<html>\n    <head>\n    <title>foo bar</title><meta name="bar" value="foo"><body><h1>bar foo</h1><p>It's like comparing apples to oranges.</p></body></html>\n<?php\n// this will be called implicitly, but we'll\n// call it manually to illustrate the point.\nob_end_flush();\n?>