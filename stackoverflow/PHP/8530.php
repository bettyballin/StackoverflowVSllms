var headings = array(...);\nvar treeLevels = array();\nvar treeRoots = array();\n\nforeach(headings as heading) {\n    if(heading.level == treeLevels.length) {\n        /* Adjacent siblings. */\n\n        if(heading.level == 1) {\n            treeRoots[] = heading;  // Append.\n        } else {\n            treeLevels[treeLevels.length - 2].children[] = heading;  // Add child to parent element.\n        }\n\n        treeLevels[treeLevels.length - 1] = heading;\n    } else if(heading.level > treeLevels.length) {\n        /* Child. */\n\n        while(heading.level - 1 > treeLevels.length) {\n            /* Create dummy headings if needed. */\n            treeLevels[] = new Heading();\n        }\n\n        treeLevels[] = heading;\n    } else {\n        /* Child of ancestor. */\n\n        treeLevels.remove(heading.level, treeLevels.length - 1);\n\n        treeLevels[treeLevels.length - 1].children[] = heading;\n        treeLevels[] = heading;\n    }\n}