function H($param) {\n    return md5($param);\n}\nfunction KD($a,$b) {\n    return H("$a:$b");\n}\nfunction parseHttpDigest($digest) {\n    $data = array();\n    $parts = explode(", ", $digest);\n\n    foreach ($parts as $element) {\n        $bits = explode("=", $element);\n        $data[$bits[0]] = str_replace('"','', $bits[1]);\n    }\n    return $data;\n}\n\nfunction response($wwwauth, $user, $pass, $httpmethod, $uri) {        \n        list($dummy_digest, $value) = split(' ', $wwwauth, 2);    \n        $x = parseHttpDigest($value);\n        $realm = $x['realm'];        \n        $A1 = $user.":".$realm.":".$pass;        \n        $A2 = $httpmethod.":".$uri;\n\n        if ($x['qop'] == 'auth') {\n            $cnonce = time();\n            $ncvalue = 1;\n            $noncebit = $x['nonce'].":".$ncvalue.":".$cnonce.":auth:".H($A2);\n            $respdig = KD(H($A1), $noncebit);\n        }else {\n            # FIX: handle error here\n        }\n\n        $base  = 'Digest username="'.$user.'", realm="';\n        $base .= $x['realm'].'", nonce="'.$x['nonce'].'",';\n        $base .= ' uri="'.$uri.'", cnonce="'.$cnonce;\n        $base .= '", nc="'.$ncvalue.'", response="'.$respdig.'", qop="auth"';\n        return $base;\n    }