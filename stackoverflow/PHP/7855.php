function textFormat($text) {\n    $raw = array(\n        '\'\[text\](?P&lt;id&gt;.*?)\[/text\]\'ise'\n    );\n    $out = array (\n        '\'&lt;a href="index.php?function=getData&reference=text&id=$1"&gt;\' . getTextTitle(\'$1\') . \'&lt;/a&gt;\''\n    );\n    preg_replace($raw, $out, $text);\n    return $text;\n}\n\nfunction getTextTitle($id) {\n     $sql = mysql_query("SELECT title FROM text WHERE id = '" . mysql_real_escape_string($id) . "'");\n     $res = mysql_result($sql);\n     $row = mysql_fetch_array($res);\n     return $row ? $row[0] : 'invalid ID';\n}