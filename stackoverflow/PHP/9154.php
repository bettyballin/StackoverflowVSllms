<?php\nabstract class A\n{\n  protected $id;\n\n  protected function __construct( $id )\n  {\n    $this->id = $id;\n  }\n\n  final public static function factory( $subclass, $id )\n  {\n    // Instantiate the object\n    if ( is_subclass_of( $subclass, __CLASS__ ) )\n    {\n      return new $subclass($id);\n    }\n    throw new Exception( "$subclass is not a valid class for this factory." );\n  }\n}\n\nclass B extends A{}\nclass C extends A{}\nclass D{}\n\ntry {\n  $b = A::factory( 'B', 1 );\n  $c = A::factory( 'C', 2 );\n  $d = A::factory( 'D', 2 );\n}\ncatch ( Exception $e )\n{\n  echo "Oops! " . $e->getMessage();\n}