<?php\nfunction test() {\n\n    // Do a regular session count\n    print "session_id: " . session_id() . "<br>";\n    if (!$_SESSION['session_count']) $_SESSION['session_count'] = 0;\n    $_SESSION['session_count']++;\n    print "session count: " . $_SESSION['session_count'] . "<br>";\n\n\n    // Do an application count\n    $count = get_cache( 'count' );\n    if ( !$count ) $count = 0;\n    $count++;\n    print "application count: $count<br>";\n    set_cache('count', $count);\n}\n\n\nfunction set_cache( $name, $value ) {\n    $old_session = switch_session("GlobalCache");\n    $_SESSION[$name] = $value;\n    switch_session( $old_session );\n}\n\nfunction get_cache( $name ) {\n    $old_session = switch_session("GlobalCache");\n    $value = $_SESSION[$name];\n    switch_session( $old_session );\n    return $value;\n}\n\nfunction switch_session( $session_id ) {\n\n    // switch the session and return the original\n    $old_id = session_id();\n\n    session_write_close();\n    session_id($session_id);\n    session_start();\n    return $old_id;\n}\n\nob_start();\nsession_start();\ntest();\nob_end_flush();\n?>