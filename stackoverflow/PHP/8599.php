class MatchTable \n{\n    var $_table_one_name;\n    var $_table_two_name;\n\n    var $_table_one_db_user;\n    var $_table_one_db_pass;\n    var $_table_one_db_host;\n    var $_table_one_db_name;\n\n    var $_table_two_db_user;\n    var $_table_two_db_pass;\n    var $_table_two_db_host;\n    var $_table_two_db_name;\n\n    var $_table_one_columns = array();\n    var $_table_two_columns = array();\n    var $_table_one_types = array();\n    var $_table_two_types = array();\n\n    var $_table_one_link;\n    var $_table_two_link;\n\n    var $_isTest;\n\n\n    function MatchTable($isLive = true)\n    {\n        $this->_isTest = !$isLive;\n    }\n\n    function matchTables($table1, $table2)\n    {\n        $this->_table_one_name = $table1;\n        $this->_table_two_name = $table2;\n\n        if(isset($this->_table_one_db_pass))\n        {\n            $this->db_connect('ONE');\n        }\n        list($this->_table_one_columns,$this->_table_one_types) = $this->getColumns($this->_table_one_name);\n\n        if(isset($this->_table_two_db_pass))\n        {\n            $this->db_connect('TWO');\n        }\n        list($this->_table_two_columns,$this->_table_two_types) = $this->getColumns($this->_table_two_name);\n\n        $this->addAdditionalColumns($this->getAdditionalColumns());\n    }\n\n    function setTableOneConnection($host, $user, $pass, $name)\n    {\n        $this->_table_one_db_host = $host;\n        $this->_table_one_db_user = $user;\n        $this->_table_one_db_pass = $pass;\n        $this->_table_one_db_name = $name;\n    }\n\n    function setTableTwoConnection($host, $user, $pass, $name)\n    {\n        $this->_table_two_db_host = $host;\n        $this->_table_two_db_user = $user;\n        $this->_table_two_db_pass = $pass;\n        $this->_table_two_db_name = $name;\n    }\n\n    function db_connect($table)\n    {\n        switch(strtoupper($table))\n        {\n            case 'ONE':\n                $host = $this->_table_one_db_host;\n                $user = $this->_table_one_db_user;\n                $pass = $this->_table_one_db_pass;\n                $name = $this->_table_one_db_name;\n                $link = $this->_table_one_link = mysql_connect($host, $user, $pass, true);\n                mysql_select_db($name) or die(mysql_error());\n            break;\n            case 'TWO';\n                $host = $this->_table_two_db_host;\n                $user = $this->_table_two_db_user;\n                $pass = $this->_table_two_db_pass;\n                $name = $this->_table_two_db_name;\n                $link = $this->_table_two_link = mysql_connect($host, $user, $pass, true);\n                mysql_select_db($name) or die(mysql_error());\n            break;\n            default:\n                die('Improper parameter in MatchTable->db_connect() expecting "one" or "two".');\n            break;\n        }\n        if (!$link) {\n            die('Could not connect: ' . mysql_error());\n        }\n    }\n\n    function getColumns($table_name)\n    {\n        $columns = array();\n        $types = array();\n        $qry = 'SHOW COLUMNS FROM '.$table_name;\n        $result = mysql_query($qry) or die(mysql_error());\n        while($row = mysql_fetch_assoc($result))\n        {\n            $field = $row['Field'];\n            $type = $row['Type'];\n            /*\n            $column = array('Field' => $field, 'Type' => $type);\n            array_push($columns, $column);\n            */\n            $types[$field] = $type;\n            array_push($columns, $field);\n        }\n        $arr = array($columns, $types);\n        return $arr;\n    }\n\n    function getAdditionalColumns()\n    {\n        $additional = array_diff($this->_table_one_columns,$this->_table_two_columns);\n        return $additional;\n    }\n\n    function addAdditionalColumns($additional)\n    {\n        $qry = '';\n        foreach($additional as $field)\n        {\n            $qry = 'ALTER TABLE '.$this->_table_two_name.' ADD '.$field.' '.$this->_table_one_types[$field].'; ';\n\n            if($this->_isTest)\n            {\n                echo $qry.'<br><br>';\n            }\n            else\n            {\n                mysql_query($qry) or die(mysql_error());\n            }\n        }\n    }\n\n    /**\n     * End of Class\n     */\n}