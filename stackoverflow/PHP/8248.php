// On the sending end:\ndefine('SECRET', '12734981273912379128739128739127938794729327492');\n$message = 'your-message';\n$packet = $message . sha1($message . SECRET);\n\n// On the receiving end:\ndefine('SECRET', '12734981273912379128739128739127938794729327492');\n$message = substr($packet, 0, -40);\nif(sha1($message . SECRET) != substr($packet, -40))\n    throw new Exception("Message Authentication failed!")\nelse\n    do_something_with($message);