for($x=0;$x<$width;$x++){\n    /*if($start_r==$end_r) $new_r = $start_r;*/\n    // ^^ the line above is useless, $new_r will be set below either way\n\n    $difference = $start_r-$end_r;\n    $new_r = $start_r-intval(($difference/$width)*$x); \n\n    /*if($start_g==$end_g) $new_g = $start_g;*/\n    // ^^ the line above is useless, $new_g will be set below either way\n\n    $difference = $start_g-$end_g;\n    $new_g = $start_g-intval(($difference/$width)*$x);     \n\n    /*if($start_b==$end_b) $new_b = $start_b;*/\n    // ^^ the line above is useless, $new_b will be set below either way\n\n    $difference = $start_b - $end_b;\n    $new_b = $start_b-intval(($difference/$width)*$x);\n\n    $new_color = imagecolorresolve($image,$new_r,$new_g,$new_b);\n    // ^^ used to be $row_color\n\n    for($y=0;$y<$height;$y++){\n        imagesetpixel($image,$x,$y,$new_color);\n    }    \n}