$lines = explode("\n",$message_data);\n$headers = array();\n$body = '';\n\n$in_body = false;\n\nforeach($lines as $line)\n{\n     if($in_body)\n     {\n          $body .= $line;\n     }\n     elseif($line == '')\n     {\n          $in_body = true;\n     }\n     else\n     {\n          list($header_name,$header_value) = explode(':',$line,2);\n          $headers[$header_name] = $header_body;\n     }\n}\n\n// now $headers is an array of all headers and you could get the from address via $headers['From']\n// $body contains just the body