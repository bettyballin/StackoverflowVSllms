<?php\n/**\n * Displays a condensed list of the posts grouped by month/year. \n *\n * @param $order The order of the posts.  Either 'DESC' or 'ASC', case sensitive.\n * @param $date_prefix Whether to prefix the posts with the month/date.\n * @param $display Whether to display the results or return it as a String. \n */\n\nfunction condensed_post_list($order='DESC', $date_prefix=true, $display=true){\n    global $wpdb;\n\n    if( !in_array($order, array('DESC','ASC' ) ) ) $order = 'DESC';\n    $query = "SELECT ID, post_title, post_date FROM $wpdb->posts ".\n             "WHERE post_type='post' AND post_status = 'publish' ".\n             "ORDER BY post_date $order";\n    $results = $wpdb->get_results( $query );\n\n    ob_start();\n    $current_month = '';\n    foreach( $results as $result ) {\n        if( $current_month != mysql2date('F Y', $result->post_date)) {\n            if( $current_month ) echo '</ul>';\n\n            $current_month = mysql2date('F Y', $result->post_date );\n            echo '<h2>'.$current_month.'</h2>';\n            echo '<ul>';\n        }\n        echo '<li>';\n        echo ($date_prefix ? mysql2date('M j: ', $result->post_date) : '');\n        echo '<a href="'.get_permalink($result->ID).'">';\n        echo $result->post_title.'</a></li>';\n    }\n    if( $current_month ) echo '</ul>';\n\n    if( $display ) {\n        ob_end_flush();\n    } else {\n        return ob_get_clean();\n    }\n}\n?>