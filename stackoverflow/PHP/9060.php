function utf8_to_unicode( $str ) {\n\n    $unicode = array();        \n    $values = array();\n    $lookingFor = 1;\n\n    for ($i = 0; $i < strlen( $str ); $i++ ) {\n        $thisValue = ord( $str[ $i ] );\n    if ( $thisValue < ord('A') ) {\n        // exclude 0-9\n        if ($thisValue >= ord('0') && $thisValue <= ord('9')) {\n             // number\n             $unicode[] = chr($thisValue);\n        }\n        else {\n             $unicode[] = '%'.dechex($thisValue);\n        }\n    } else {\n          if ( $thisValue < 128) \n        $unicode[] = $str[ $i ];\n          else {\n                if ( count( $values ) == 0 ) $lookingFor = ( $thisValue < 224 ) ? 2 : 3;                \n                $values[] = $thisValue;                \n                if ( count( $values ) == $lookingFor ) {\n                    $number = ( $lookingFor == 3 ) ?\n                        ( ( $values[0] % 16 ) * 4096 ) + ( ( $values[1] % 64 ) * 64 ) + ( $values[2] % 64 ):\n                        ( ( $values[0] % 32 ) * 64 ) + ( $values[1] % 64 );\n            $number = dechex($number);\n            $unicode[] = (strlen($number)==3)?"%u0".$number:"%u".$number;\n                    $values = array();\n                    $lookingFor = 1;\n          } // if\n        } // if\n    }\n    } // for\n    return implode("",$unicode);\n\n} // utf8_to_unicode