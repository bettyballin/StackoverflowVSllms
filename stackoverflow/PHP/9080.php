<?php\nfunction Image($image, $crop = ':', $size = null) {\n\n    $image = ImageCreateFromString(file_get_contents($image));\n\n    if (is_resource($image)) {\n\n        $x = 0;\n        $y = 0;\n        $width = imagesx($image);\n        $height = imagesy($image);\n\n        // CROP (Aspect Ratio) Section\n        $crop = array_filter(explode(':', $crop));\n\n        if (empty($crop)) {\n\n            $crop = [$width, $height];\n\n        } else {\n\n            $crop[0] = $crop[0] ?: $crop[1];\n            $crop[1] = $crop[1] ?: $crop[0];\n\n        }\n\n        $ratio = [$width / $height, $crop[0] / $crop[1]];\n\n        if ($ratio[0] > $ratio[1]) {\n\n            $width = $height * $ratio[1];\n            $x = (imagesx($image) - $width) / 2;\n\n        } else {\n\n            $height = $width / $ratio[1];\n            $y = (imagesy($image) - $height) / 2;\n\n        }\n\n\n        // Resize Section    \n        if (is_null($size)) {\n\n            $size = [$width, $height];\n\n        } else {\n\n            $size = array_filter(explode('x', $size));\n\n            if (empty($size)) {\n\n                $size = [imagesx($image), imagesy($image)];\n\n            } else {\n\n                $size[0] = $size[0] ?: round($size[1] * $width / $height);\n                $size[1] = $size[1] ?: round($size[0] * $height / $width);\n\n            }\n        }\n\n        $result = ImageCreateTrueColor($size[0], $size[1]);\n\n        if (is_resource($result)) {\n\n            ImageSaveAlpha($result, true);\n            ImageAlphaBlending($result, true);\n            ImageFill($result, 0, 0, ImageColorAllocate($result, 255, 255, 255));\n            ImageCopyResampled($result, $image, 0, 0, $x, $y, $size[0], $size[1], $width, $height);\n\n            ImageInterlace($result, true);\n            ImageJPEG($result, null, 90);\n\n        }\n    }\n\n    return false;\n}\n\nheader('Content-Type: image/jpeg');\nImage('http://upload.wikimedia.org/wikipedia/commons/4/47/PNG_transparency_demonstration_1.png', '1:1', '600x');\n\n?>