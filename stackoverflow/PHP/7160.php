<?php\n        function reduceto($data,$r) {\n            $c = count($data);\n\n            // just enough data\n            if ($c == $r) return $data;\n\n            // not enough data\n            if ($r > $c) {\n                $x = ceil($r/$c);\n                $temp = array();\n                foreach ($data as $v) for($i = 0; $i < $x; $i++) $temp[] = $v;\n                $data = $temp;\n                $c = count($data);\n            }\n\n            // more data then needed\n            if ($c > $r) {\n                $temp = array();\n                foreach ($data as $v) for($i = 0; $i < $r; $i++) $temp[] = $v;\n                $data = array_map('array_sum',array_chunk($temp,$c));\n            }\n            foreach ($data as $k => $v) $data[$k] = $v / $r;\n            return $data;\n        }\n    ?>