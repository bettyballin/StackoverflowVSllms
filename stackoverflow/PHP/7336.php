$text = "你好";\n// Convert UTF-8 string to HTML entities\n$text = mb_convert_encoding($text, 'HTML-ENTITIES',"UTF-8");\n// Convert HTML entities into ISO-8859-1\n$text = html_entity_decode($text,ENT_NOQUOTES, "ISO-8859-1");\n// Convert characters > 127 into their hexidecimal equivalents\n$out = "";\nfor($i = 0; $i < strlen($text); $i++) {\n    $letter = $text[$i];\n    $num = ord($letter);\n    if($num>127) {\n      $out .= "&#$num;";\n    } else {\n      $out .=  $letter;\n    }\n}