import codecs\nfrom winsys import fs\n\nbase = "c:/temp"\nwith codecs.open ("permissions.log", "wb", encoding="utf8") as log:\n  for f in fs.flat (base):\n  log.write ("\n" + f.filepath.relative_to (base) + "\n")\n  for ace in f.security ().dacl:\n    access_flags = fs.FILE_ACCESS.names_from_value (ace.access)\n    log.write (u"  %s => %s\n" % (ace.trustee, ", ".join (access_flags)))