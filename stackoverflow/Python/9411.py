from tempfile import mkstemp\nfrom shutil import move, copymode\nfrom os import fdopen, remove\n\ndef replace(file_path, pattern, subst):\n    #Create temp file\n    fh, abs_path = mkstemp()\n    with fdopen(fh,'w') as new_file:\n        with open(file_path) as old_file:\n            for line in old_file:\n                new_file.write(line.replace(pattern, subst))\n    #Copy the file permissions from the old file to the new file\n    copymode(file_path, abs_path)\n    #Remove original file\n    remove(file_path)\n    #Move new file\n    move(abs_path, file_path)