import win32file, win32api\nimport os\n\n\ndef ProgressRoutine(TotalFileSize, TotalBytesTransferred, StreamSize, StreamBytesTransferred,\n    StreamNumber, CallbackReason, SourceFile, DestinationFile, Data):\n    print Data\n    print TotalFileSize, TotalBytesTransferred, StreamSize, StreamBytesTransferred, StreamNumber, CallbackReason, SourceFile, DestinationFile\n    ##if TotalBytesTransferred > 100000:\n    ##    return win32file.PROGRESS_STOP\n    return win32file.PROGRESS_CONTINUE\n\ntemp_dir=win32api.GetTempPath()\nfsrc=win32api.GetTempFileName(temp_dir,'cfe')[0]\nfdst=win32api.GetTempFileName(temp_dir,'cfe')[0]\nprint fsrc, fdst\n\nf=open(fsrc,'w')\nf.write('xxxxxxxxxxxxxxxx\n'*32768)\nf.close()\n## add a couple of extra data streams\nf=open(fsrc+':stream_y','w')\nf.write('yyyyyyyyyyyyyyyy\n'*32768)\nf.close()\nf=open(fsrc+':stream_z','w')\nf.write('zzzzzzzzzzzzzzzz\n'*32768)\nf.close()\n\noperation_desc='Copying '+fsrc+' to '+fdst\nwin32file.CopyFileEx(fsrc, fdst, ProgressRoutine, operation_desc, False,   win32file.COPY_FILE_RESTARTABLE)