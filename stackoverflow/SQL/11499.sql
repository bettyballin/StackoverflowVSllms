SELECT\n   i1.id AS id1,\n   NULL AS id2,\n   NULL AS id3,\n   i1.amount\nFROM\n   items i1\nUNION ALL\nSELECT\n   i1.id AS id1,\n   i2.id AS id2,\n   i3.id AS id3,\n   i1.amount + i2.amount AS total\nFROM\n   items i1,\n   items i2\nWHERE\n   i1.amount + i2.amount = 30 AND\n   i1.id <> i2.id AND\n   i1.id <> i3.id\nUNION ALL\nSELECT\n   i1.id AS id1,\n   i2.id AS id2,\n   i3.id AS id3,\n   i1.amount + i2.amount + i3.amount AS total\nFROM\n   items i1,\n   items i2,\n   items i3\nWHERE\n   i1.amount + i2.amount + i3.amount = 30 AND\n   i1.id <> i2.id AND\n   i1.id <> i3.id AND\n   i2.id <> i3.id