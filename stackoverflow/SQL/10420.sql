CREATE LANGUAGE plpgsql;\nCREATE OR REPLACE FUNCTION get_top_parent(\n        child integer\n) RETURNS integer as $$\nDECLARE\n        parent integer;\n        last_parent integer;\nBEGIN\n        last_parent := child;\n        SELECT INTO parent parentid\n        FROM example\n        WHERE id = child;\n\n        IF parent is NOT NULL THEN\n                parent := get_top_parent(parent);\n        ELSE\n                parent := last_parent;\n        END IF;\n        RETURN parent;\nEND\n$$ LANGUAGE plpgsql;