SELECT * \nFROM Table as si\nJOIN (\n  SELECT SiteId\n  FROM [UtilityWeb].[dbo].[GroupSites]\n  WHERE GroupId = ISNULL(@NewGroupId, GroupId)\n  /* --Or, if all SiteIds aren't in GroupSites, or GroupSites is unusually large \n     --this might work better\n  SELECT @newGroupId\n  UNION ALL\n  SELECT SiteId FROM [UtilityWeb].[dbo].[GroupSites]\n  WHERE GroupId = @NewGroupId\n  */\n) as gs ON\n  si.SiteId = gs.SiteId