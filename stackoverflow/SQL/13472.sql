CREATE FUNCTION [dbo].[GetReportTree](@ItemId uniqueidentifier)\nRETURNS XML\nBEGIN RETURN \n  (SELECT   ca.ItemId AS '@ItemId',\n            ca.Name AS '@Name',\n            ca.Type AS '@Type',\n            dbo.GetReportTree(ca.ItemId)\n   FROM dbo.Catalog ca\n   WHERE (@ItemId IS NULL AND ParentId IS NULL) OR ParentID=@ItemId\n   FOR XML PATH('CatalogItem'), TYPE)\nEND\n\nSELECT dbo.[GetReportTree](NULL)   