SELECT t.ID, t.Status, t.SDateTime, \n    (SELECT Top 1 SDateTime \n     FROM t t1 WHERE t1.Status = 1 \n     AND t1.ID=t.ID \n     AND t1.SDateTime<t.SDateTime \n     AND t1.SDateTime>=\n         Nz((SELECT Top 1 SDateTime \n             FROM t t2 \n             WHERE t2.Status=3 \n             AND t2.ID=t.ID \n             AND t2.SDateTime<t.SDateTime),0)) AS DateStart, \n[SDateTime]-[DateStart] AS Result\nFROM t\nWHERE t.Status=3