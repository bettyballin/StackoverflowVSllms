WITH RecordsWithRn AS (\nSELECT id, Type, Name,\n   ROW_NUMBER() OVER (PARTITION BY Type ORDER BY ... intra-type ordering ...) as rn\n        FROM Records\n        WHERE Name LIKE '%Foo%') \nSELECT TOP 100 id, Type, Name\n   FROM RecordsWithRn\n   ORDER BY RN, ... inter-type ordering ...