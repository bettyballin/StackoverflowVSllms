SELECT U.UserId, UP.Profile, UP.UserParentID\nFROM aspnet_Users U\n    LEFT OUTER JOIN UserProperties UP ON U.UserId = UP.UserId\n    OUTER APPLY UP.Profile.nodes('/Properties/property') p(prof)\n\nWHERE UP.Profile.exist('/Properties/property[contains(.,sql:variable("@cLookup"))]') = 1\n    AND p.prof.value('@id', 'nvarchar(20)') = 'BusinessName'\n\nORDER BY p.prof.value('@name', 'nvarchar(100)')