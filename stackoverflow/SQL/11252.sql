Create table #Contacts (id int)\nDeclare @ContactTypes int\nDeclare @CAD varchar(100)\nDeclare @I int\nDeclare @sql nvarchar(4000)\nSet @i = 1\nSelect @ContactTypes =   \nSum(sub.Types) \nfrom ( Select Count(1) as Types from contacts\ngroup by ContactName, Designation) as sub\nPrint @ContactTypes\nWhile @i <= @ContactTypes\nBegin\n    set @sql = 'alter table #Contacts Add  ContactName' + \n    Cast(@I as varchar(10)) + ' varchar(100)'\n    exec sp_executesql @sql\n    Set @I = @i + 1\nEnd\nInsert into #Contacts (id) values (1)\nSet @i = 1\nDeclare crsPivot  cursor \nfor Select ContactName + ' ' + Designation\nfrom contacts\nopen crsPivot\nFetch next from crsPivot into @CAD\nWhile (@@Fetch_Status = 0)\nBegin   \n    Set @sql = 'Update  #Contacts  set ContactName' \n    + Cast(@I as varchar(10)) +' = ' + quotename(@CAD,'''')\n    exec sp_executesql @sql\n    Set @i = @i + 1\n    Fetch next from crsPivot into @CAD\nEnd\nclose crsPivot\nDeallocate crsPivot\nselect * From #Contacts