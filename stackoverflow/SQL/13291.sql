create table #Product (\n    ID      int identity(1, 1) primary key,\n    Name        varchar(800),\n    DateAdded   datetime default getdate()\n)\n\ninsert  #Product(Name) select 'Chocolate'\ninsert  #Product(Name,DateAdded) select 'Candy', GETDATE() + 1\ninsert  #Product(Name,DateAdded) select 'Chocolate', GETDATE() + 5\nselect * from #Product\n\n;with Ranked as (\n    select  ID, \n        dense_rank() \n        over (partition by Name order by DateAdded desc) as DupeCount\n    from    #Product P\n)\ndelete  R\nfrom    Ranked R\nwhere   R.DupeCount > 1\n\nselect * from #Product