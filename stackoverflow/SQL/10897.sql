SELECT \n  COUNT(incident_id) AS "Calls",\n  MAX(open_time),\n  days.open_day\nFROM\n(\n  select datepart(dd,dateadd(day,-6,getdate())) as open_day union\n  select datepart(dd,dateadd(day,-5,getdate())) as open_day union\n  select datepart(dd,dateadd(day,-4,getdate())) as open_day union\n  select datepart(dd,dateadd(day,-3,getdate())) as open_day union\n  select datepart(dd,dateadd(day,-2,getdate())) as open_day union\n  select datepart(dd,dateadd(day,-1,getdate())) as open_day union\n  select datepart(dd,dateadd(day, 0,getdate())) as open_day \n) days\nleft join \n(\n SELECT\n   incident_id,\n   opened_by,\n   open_time - (9.0/24) AS open_time,\n   DATEPART(dd, (open_time-(9.0/24))) AS open_day\n FROM incidentsm1 \n WHERE DATEDIFF(DAY, open_time-(9.0/24), GETDATE()) < 7\n) inc1 ON days.open_day = incidents.open_day\nGROUP BY days.open_day