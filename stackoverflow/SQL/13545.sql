declare ... all the variables to hold the different columns.\ndeclare @CurrentOrder ... proper datatype\n\nset @CurrentOrder = ... initial value\nwhile(1=1)\nbegin\n  Select @Var1 = Column1, @Var2 = Column2, etc, @GotoWhere = GotoWhere\n  from SCHOOL_DATA\n  where Order = @CurrentOrder\n  select @RC = @@Rowcount, @E = @@ERROR\n  ... do error handling if @RC <> 1 or @E <> 0. Can wrap with try catch if using 2005+\n  ... do work.\n  ... error out if @GotoWhere is null\n  if (... done condition ...)\n     exit\n  set @CurrentOrder = @GotoWhere\nend