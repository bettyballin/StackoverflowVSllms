select \n  a.[Index], \n  max(a.[Tenant]) as [Tenant], \n  max(a.[AmountCharged]) as [AmountCharged],\n  max(a.[AmountPaid]) as [AmountPaid],\n  sum(\n    iif(isnull(b.[AmountCharged]),0,b.[AmountCharged])+\n    iif(isnull(b.[AmountPaid]),0,b.[AmountPaid])\n    ) as [Balance]\nfrom \n  [Transactions] as a\nleft outer join \n  [Transactions] as b on\n    a.[Tenant] = b.[Tenant] and\n    a.[Index] >= b.[Index]\ngroup by \n  a.[Index];