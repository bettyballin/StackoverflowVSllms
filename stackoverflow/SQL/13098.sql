/* Where'd @NewEstimateID come from? */\n/* If there are several records in EstimateJobHeader with @OldEstimateID,\n *  this will insert one new record for each of them */\nINSERT EstimateJobHeader (ServiceID,EstimateID)\n     SELECT ServiceID, @NewEstimateID \n     FROM EstimateJobHeader\n     WHERE EstimateID= @OldEstimateID\n\n/* Copy EstimateDetail records from old estimate to new estimate */\nINSERT EstimateDetail (JobHeaderID, OtherCols) \n    SELECT (new.JobHeaderID,ed.OtherCols) \n    FROM EstimateJobHeader new\n    INNER JOIN EstimateJobHeader old ON old.EstimateID= @OldEstimateID \n        AND new.EstimateID= @NewEstimateID AND old.ServiceID=new.ServiceID\n    INNER JOIN EstimateDetail ed ON ed.JobHeaderID= old.JobHeaderID\n\n/* Copy EstimateJobDetail records from old estimate to new estimate */\nINSERT EstimateJobDetail (JobHeaderID, OtherCols)\n    SELECT (new.JobHeaderID,ed.OtherCols) \n    FROM EstimateJobHeader new\n    INNER JOIN EstimateJobHeader old ON old.EstimateID= @OldEstimateID \n        AND new.EstimateID= @NewEstimateID AND old.ServiceID=new.ServiceID\n    INNER JOIN EstimateJobDetail ejd ON ejd.JobHeaderID= old.JobHeaderID