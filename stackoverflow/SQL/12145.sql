select \n    cat.*\n    , max( ans.id )\nfrom cat\nleft join ques on ques.cat_id = cat.id\nleft join ans on ans.ques_id = ques.id\ngroup by cat.id, cat.name\n\ncreate table cat ( id serial, name varchar (10) );\ncreate table ques ( id serial, name varchar (10), cat_id integer );\ncreate table ans ( id serial, name varchar (10), ques_id integer );\n\ninsert into cat (name) values ( 'cat 1' );\ninsert into cat (name)  values ( 'cat 2' );\ninsert into cat  (name) values ( 'cat 3' );\n\ninsert into ques (name, cat_id) values ( 'ques 1', 1 );\ninsert into ques (name, cat_id)  values ( 'ques 2', 1 );\ninsert into ques (name, cat_id)  values ( 'ques 3', 1 );\ninsert into ques (name, cat_id)  values ( 'ques 4', 2 );\ninsert into ques (name, cat_id)  values ( 'ques 5', 2 );\ninsert into ques (name, cat_id)  values ( 'ques 6', 2 );\ninsert into ques (name, cat_id)  values ( 'ques 7', 2 );\n\ninsert into ans (name, ques_id)  values ( 'ans 1', 1 );\ninsert into ans (name, ques_id)  values ( 'ans 2', 2 );\ninsert into ans (name, ques_id)  values ( 'ans 3', 2 );\ninsert into ans (name, ques_id)  values ( 'ans 4', 1 );\ninsert into ans (name, ques_id)  values ( 'ans 5', 2 );\ninsert into ans (name, ques_id)  values ( 'ans 6', 1 );\ninsert into ans (name, ques_id)  values ( 'ans 7', 1 );\ninsert into ans (name, ques_id)  values ( 'ans 8', 1 );\ninsert into ans (name, ques_id)  values ( 'ans 9', 2 );\ninsert into ans (name, ques_id)  values ( 'ans 10', 2 );