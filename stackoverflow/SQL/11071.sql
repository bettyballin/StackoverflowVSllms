-- UPDATE rows using an INNER JOIN with matching TRADENAME. No need to update TRADENAME column.\nUPDATE drug\nSET [CDM] = tmp.[CDM]\n  , [NDC] = tmp.[NDC]\n  , [IP_COST] = tmp.[IP_COST]\n  , [OP_COST] = tmp.[OP_COST]\n  , [HH_COST] = tmp.[HH_COST]\n  , [VAR_COST] = tmp.[VAR_COST]\n  , [LSTUPDATE] = tmp.[LSTUPDATE]\nFROM [RX_Billing].[dbo].[FS_Drug] drug\nINNER JOIN [RX_Billing].[dbo].[FS_Drug_TEMP] tmp  \n    ON drug.[TRADENAME] = tmp.[TRADENAME]\n\n-- Insert rows that don't have matching TRADENAME\nINSERT INTO drug\nSELECT \n    tmp.[TRADENAME]\n  , tmp.[CDM]\n  , tmp.[NDC]\n  , tmp.[IP_COST]\n  , tmp.[OP_COST]\n  , tmp.[HH_COST]\n  , tmp.[VAR_COST]\n  , tmp.[LSTUPDATE]\nFROM [RX_Billing].[dbo].[FS_Drug] drug\nRIGHT OUTER JOIN [RX_Billing].[dbo].[FS_Drug_TEMP] tmp \n    ON  drug.[TRADENAME] = tmp.[TRADENAME]\nWHERE drug.[TRADENAME] IS NULL 