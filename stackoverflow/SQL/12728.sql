DECLARE @LookupID int\n\n--Our test value\nSET @LookupID = 1;\n\nWITH cteLevelOne (ParentID, CustID, Depth) AS\n(\n        SELECT   a.ParentID, a.CustID, 1\n        FROM     tblCustomer AS a\n        WHERE    a.CustID = @LookupID\n    UNION ALL\n        SELECT   a.ParentID, a.CustID, c.Depth + 1\n        FROM     tblCustomer AS a\n        INNER JOIN cteLevelOne AS c ON a.CustID = c.ParentID \n        WHERE c.CustID <> a.CustID\n)\nselect * from CTELevelone where Depth = (select max(Depth) from CTELevelone)