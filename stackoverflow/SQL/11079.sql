CREATE FUNCTION FullMonthsSeparation \n(\n    @DateA DATETIME,\n    @DateB DATETIME\n)\nRETURNS INT\nAS\nBEGIN\n    DECLARE @Result INT\n\n    DECLARE @DateX DATETIME\n    DECLARE @DateY DATETIME\n\n    IF(@DateA < @DateB)\n    BEGIN\n        SET @DateX = @DateA\n        SET @DateY = @DateB\n    END\n    ELSE\n    BEGIN\n        SET @DateX = @DateB\n        SET @DateY = @DateA\n    END\n\n    SET @Result = (\n                    SELECT \n                    CASE \n                        WHEN DATEPART(DAY, @DateX) > DATEPART(DAY, @DateY)\n                        THEN DATEDIFF(MONTH, @DateX, @DateY) - 1\n                        ELSE DATEDIFF(MONTH, @DateX, @DateY)\n                    END\n                    )\n\n    RETURN @Result\nEND\nGO\n\nSELECT dbo.FullMonthsSeparation('2009-04-16', '2009-05-15') as MonthSep -- =0\nSELECT dbo.FullMonthsSeparation('2009-04-16', '2009-05-16') as MonthSep -- =1\nSELECT dbo.FullMonthsSeparation('2009-04-16', '2009-06-16') as MonthSep -- =2