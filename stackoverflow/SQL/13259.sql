SELECT\n  FIRST_NAME.ORIGINAL_INPUT_DATA\n ,FIRST_NAME.TITLE\n ,FIRST_NAME.FIRST_NAME\n ,CASE WHEN 0 = CHARINDEX(' ',FIRST_NAME.REST_OF_NAME)\n       THEN NULL  --no more spaces?  assume rest is the last name\n       ELSE SUBSTRING(\n                       FIRST_NAME.REST_OF_NAME\n                      ,1\n                      ,CHARINDEX(' ',FIRST_NAME.REST_OF_NAME)-1\n                     )\n       END AS MIDDLE_NAME\n ,SUBSTRING(\n             FIRST_NAME.REST_OF_NAME\n            ,1 + CHARINDEX(' ',FIRST_NAME.REST_OF_NAME)\n            ,LEN(FIRST_NAME.REST_OF_NAME)\n           ) AS LAST_NAME\nFROM\n  (  \n  SELECT\n    TITLE.TITLE\n   ,CASE WHEN 0 = CHARINDEX(' ',TITLE.REST_OF_NAME)\n         THEN TITLE.REST_OF_NAME --No space? return the whole thing\n         ELSE SUBSTRING(\n                         TITLE.REST_OF_NAME\n                        ,1\n                        ,CHARINDEX(' ',TITLE.REST_OF_NAME)-1\n                       )\n    END AS FIRST_NAME\n   ,CASE WHEN 0 = CHARINDEX(' ',TITLE.REST_OF_NAME)  \n         THEN NULL  --no spaces @ all?  then 1st name is all we have\n         ELSE SUBSTRING(\n                         TITLE.REST_OF_NAME\n                        ,CHARINDEX(' ',TITLE.REST_OF_NAME)+1\n                        ,LEN(TITLE.REST_OF_NAME)\n                       )\n    END AS REST_OF_NAME\n   ,TITLE.ORIGINAL_INPUT_DATA\n  FROM\n    (   \n    SELECT\n      --if the first three characters are in this list,\n      --then pull it as a "title".  otherwise return NULL for title.\n      CASE WHEN SUBSTRING(TEST_DATA.FULL_NAME,1,3) IN ('MR ','MS ','DR ','MRS')\n           THEN LTRIM(RTRIM(SUBSTRING(TEST_DATA.FULL_NAME,1,3)))\n           ELSE NULL\n           END AS TITLE\n      --if you change the list, don't forget to change it here, too.\n      --so much for the DRY prinicple...\n     ,CASE WHEN SUBSTRING(TEST_DATA.FULL_NAME,1,3) IN ('MR ','MS ','DR ','MRS')\n           THEN LTRIM(RTRIM(SUBSTRING(TEST_DATA.FULL_NAME,4,LEN(TEST_DATA.FULL_NAME))))\n           ELSE LTRIM(RTRIM(TEST_DATA.FULL_NAME))\n           END AS REST_OF_NAME\n     ,TEST_DATA.ORIGINAL_INPUT_DATA\n    FROM\n      (\n      SELECT\n        --trim leading & trailing spaces before trying to process\n        --disallow extra spaces *within* the name\n        REPLACE(REPLACE(LTRIM(RTRIM(FULL_NAME)),'  ',' '),'  ',' ') AS FULL_NAME\n       ,FULL_NAME AS ORIGINAL_INPUT_DATA\n      FROM\n        (\n        --if you use this, then replace the following\n        --block with your actual table\n              SELECT 'GEORGE W BUSH' AS FULL_NAME\n        UNION SELECT 'SUSAN B ANTHONY' AS FULL_NAME\n        UNION SELECT 'ALEXANDER HAMILTON' AS FULL_NAME\n        UNION SELECT 'OSAMA BIN LADEN JR' AS FULL_NAME\n        UNION SELECT 'MARTIN J VAN BUREN SENIOR III' AS FULL_NAME\n        UNION SELECT 'TOMMY' AS FULL_NAME\n        UNION SELECT 'BILLY' AS FULL_NAME\n        UNION SELECT NULL AS FULL_NAME\n        UNION SELECT ' ' AS FULL_NAME\n        UNION SELECT '    JOHN  JACOB     SMITH' AS FULL_NAME\n        UNION SELECT ' DR  SANJAY       GUPTA' AS FULL_NAME\n        UNION SELECT 'DR JOHN S HOPKINS' AS FULL_NAME\n        UNION SELECT ' MRS  SUSAN ADAMS' AS FULL_NAME\n        UNION SELECT ' MS AUGUSTA  ADA   KING ' AS FULL_NAME      \n        ) RAW_DATA\n      ) TEST_DATA\n    ) TITLE\n  ) FIRST_NAME