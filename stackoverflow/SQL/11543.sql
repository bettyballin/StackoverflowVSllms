USE AdventureWorks;\nGO\n\nDECLARE @columns NVARCHAR(MAX);\n\nSELECT x.ProductName\nINTO #products\nFROM (SELECT p.[Name] AS ProductName\n    FROM Purchasing.Vendor AS v\n    INNER JOIN Purchasing.PurchaseOrderHeader AS poh ON v.VendorID = poh.VendorID\n    INNER JOIN Purchasing.PurchaseOrderDetail AS pod ON poh.PurchaseOrderID = pod.PurchaseOrderID\n    INNER JOIN Production.Product AS p ON pod.ProductID = p.ProductID\n    GROUP BY p.[Name]) AS x;\n\nSELECT @columns = STUFF(\n    (SELECT ', ' + QUOTENAME(ProductName, '[') AS [text()]\n       FROM #products FOR XML PATH ('')\n    ), 1, 1, '');\n\nSELECT @columns;