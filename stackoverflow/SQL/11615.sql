SET QUOTED_IDENTIFIER ON\n  GO\n  CREATE FUNCTION [dbo].[ListToTable] (\n  /*\n  FUNCTION ListToTable\n  Usage: select entry from listtotable('abc,def,ghi') order by entry desc\n  PURPOSE: Takes a comma-delimited list as a parameter and returns the values of that list into a table variable.\n  */\n  @mylist varchar(8000)\n  )\n  RETURNS @ListTable TABLE (\n  seqid int not null,\n  entry varchar(255) not null)\n\n  AS\n\n  BEGIN\n      DECLARE \n          @this varchar(255), \n          @rest varchar(8000),\n          @pos int,\n          @seqid int\n\n      SET @this = ' '\n      SET @seqid = 1\n      SET @rest = @mylist\n      SET @pos = PATINDEX('%,%', @rest)\n      WHILE (@pos > 0)\n      BEGIN\n          set @this=substring(@rest,1,@pos-1)\n          set @rest=substring(@rest,@pos+1,len(@rest)-@pos)\n          INSERT INTO @ListTable (seqid,entry)  VALUES (@seqid,@this)\n          SET @pos= PATINDEX('%,%', @rest)\n          SET @seqid=@seqid+1\n      END\n      set @this=@rest\n      INSERT INTO @ListTable (seqid,entry) VALUES (@seqid,@this)\n      RETURN \n  END