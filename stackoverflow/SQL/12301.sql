SELECT node.name, (COUNT(parent.name) - (sub_tree.depth + 1)) AS depth\nFROM line_items AS node,\n    line_items AS parent,\n    line_items AS sub_parent,\n    (SELECT node.name AS name, (COUNT(parent.name) - 1) AS depth\n        FROM line_items AS node,\n        line_items AS parent\n        WHERE node.lft BETWEEN parent.lft AND parent.rgt\n        AND node.name = 'Power Up'\n        GROUP BY node.name\n        ORDER BY node.lft\n    ) AS sub_tree\nWHERE node.lft BETWEEN parent.lft AND parent.rgt\n    AND node.lft BETWEEN sub_parent.lft AND sub_parent.rgt\n    AND sub_parent.name = sub_tree.name\nGROUP BY node.name\nHAVING depth <= 1\nORDER BY node.lft;