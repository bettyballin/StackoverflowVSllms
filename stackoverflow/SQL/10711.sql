DECLARE @JobName VARCHAR(20)  --Job Name\nDECLARE @Owner VARCHAR(200)   --Job Owner\nDECLARE @DBName VARCHAR(200)  --Database Name\nDECLARE @JobCode VARCHAR(4000) --Create Statement for Job\nSET @JobName = 'Test2'\nSET @Owner = 'BrianD'\nSET @DBName = 'master'\nSET @JobCode = 'USE msdb\nGO\nBEGIN TRANSACTION\nDECLARE @ReturnCode INT\nSELECT @ReturnCode = 0\nIF NOT EXISTS (SELECT name FROM msdb.dbo.syscategories WHERE name=N''[Uncategorized (Local)]'' AND category_class=1)\nBEGIN\nEXEC @ReturnCode = msdb.dbo.sp_add_category @class=N''JOB'', @type=N''LOCAL'', @name=N''[Uncategorized (Local)]''\nIF (@@ERROR <> 0 OR @ReturnCode <> 0) GOTO QuitWithRollback\nEND\nDECLARE @jobId BINARY(16)\nEXEC @ReturnCode =  msdb.dbo.sp_add_job @job_name=N''' + @JobName + ''', \n        @enabled=1, \n        @notify_level_eventlog=0, \n        @notify_level_email=0, \n        @notify_level_netsend=0, \n        @notify_level_page=0, \n        @delete_level=0, \n        @description=N''No description available.'', \n        @category_name=N''[Uncategorized (Local)]'', \n        @owner_login_name=N''' + @Owner + ''', @job_id = @jobId OUTPUT\nIF (@@ERROR <> 0 OR @ReturnCode <> 0) GOTO QuitWithRollback\nEXEC @ReturnCode = msdb.dbo.sp_add_jobstep @job_id=@jobId, @step_name=N''Version and Prod Level'', \n        @step_id=1, \n        @cmdexec_success_code=0, \n        @on_success_action=1, \n        @on_success_step_id=0, \n        @on_fail_action=2, \n        @on_fail_step_id=0, \n        @retry_attempts=0, \n        @retry_interval=0, \n        @os_run_priority=0, @subsystem=N''TSQL'', \n        @command=N''select SERVERPROPERTY(''''productversion''''), SERVERPROPERTY(''''productlevel'''')'', \n        @database_name=N''' + @DBName + ''', \n        @flags=0\nIF (@@ERROR <> 0 OR @ReturnCode <> 0) GOTO QuitWithRollback\nEXEC @ReturnCode = msdb.dbo.sp_update_job @job_id = @jobId, @start_step_id = 1\nIF (@@ERROR <> 0 OR @ReturnCode <> 0) GOTO QuitWithRollback\nEXEC @ReturnCode = msdb.dbo.sp_add_jobserver @job_id = @jobId, @server_name = N''(local)''\nIF (@@ERROR <> 0 OR @ReturnCode <> 0) GOTO QuitWithRollback\nCOMMIT TRANSACTION\nGOTO EndSave\nQuitWithRollback:\n    IF (@@TRANCOUNT > 0) ROLLBACK TRANSACTION\nEndSave:\nGO'\nExec (@JobCode)