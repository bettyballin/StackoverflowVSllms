select parent, child, level from (\nselect parent_table.table_name parent, child_table.table_name child\n from user_tables      parent_table,\n      user_constraints parent_constraint,\n      user_constraints child_constraint,\n      user_tables      child_table\nwhere parent_table.table_name = parent_constraint.table_name\n  and parent_constraint.constraint_type IN( 'P', 'U' )\n  and child_constraint.r_constraint_name = parent_constraint.constraint_name\n  and child_constraint.constraint_type   = 'R'\n  and child_table.table_name = child_constraint.table_name\n  and child_table.table_name != parent_table.table_name\n)\nstart with parent = 'DEPT'\nconnect by prior child = parent