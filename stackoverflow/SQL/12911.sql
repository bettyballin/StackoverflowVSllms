SELECT  b.*, m.*, t,*\n        (\n        SELECT  COUNT(*)\n        FROM    topics ti\n        WHERE   ti.boardid = b.boardid\n        ) AS topiccount,\n        (\n        SELECT  COUNT(*)\n        FROM    topics ti, messages mi\n        WHERE   ti.boardid = b.boardid\n                AND mi.topicid = ti.topicid\n        ) AS messagecount\nFROM    boards b\nLEFT JOIN\n        messages m\nON      m.messageid = (\n        SELECT  mii.messageid\n        FROM    topics tii, messages mii\n        WHERE   tii.boardid = b.boardid\n                AND mii.topicid = tii.topicid\n        ORDER BY\n                mii.date DESC\n        LIMIT 1\n        )\nLEFT JOIN\n        topics t\nON      t.topicid = m.topicid