delimiter ||\nDROP FUNCTION IF EXISTS substrCount||\nCREATE FUNCTION substrCount(s VARCHAR(255), ss VARCHAR(255)) RETURNS TINYINT(3) UNSIGNED LANGUAGE SQL NOT DETERMINISTIC READS SQL DATA\nBEGIN\nDECLARE count TINYINT(3) UNSIGNED;\nDECLARE offset TINYINT(3) UNSIGNED;\nDECLARE CONTINUE HANDLER FOR SQLSTATE '02000' SET s = NULL;\n\nSET count = 0;\nSET offset = 1;\n\nREPEAT\nIF NOT ISNULL(s) AND offset > 0 THEN\nSET offset = LOCATE(ss, s, offset);\nIF offset > 0 THEN\nSET count = count + 1;\nSET offset = offset + 1;\nEND IF;\nEND IF;\nUNTIL ISNULL(s) OR offset = 0 END REPEAT;\n\nRETURN count;\nEND;\n\n||\n\ndelimiter ;