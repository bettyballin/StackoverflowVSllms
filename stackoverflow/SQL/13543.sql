SELECT\n    RNG.sensor_id,\n    RNG.start_date,\n    RDG1.value AS v1,\n    RNG.end_date,\n    RDG2.value AS v2,\n    RNG.description\nFROM\n    Ranges RNG\nINNER JOIN Readings RDG1 ON\n    RDG1.sensor_id = RNG.sensor_id AND\n    RDG1.acquired => RNG.start_date\nLEFT OUTER JOIN Readings RDG1_NE ON\n    RDG1_NE.sensor_id = RDG1.sensor_id AND\n    RDG1_NE.acquired >= RNG.start_date AND\n    RDG1_NE.acquired < RDG1.acquired\nINNER JOIN Readings RDG2 ON\n    RDG2.sensor_id = RNG.sensor_id AND\n    RDG2.acquired => RNG.end_date\nLEFT OUTER JOIN Readings RDG1_NE ON\n    RDG2_NE.sensor_id = RDG2.sensor_id AND\n    RDG2_NE.acquired >= RNG.end_date AND\n    RDG2_NE.acquired < RDG2.acquired\nWHERE\n    RDG1_NE.sensor_id IS NULL AND\n    RDG2_NE.sensor_id IS NULL