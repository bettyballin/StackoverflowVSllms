USE master\n GO\n CREATE PROCEDURE sp_FindDependencies\n (\n         @ObjectName SYSNAME,\n         @ObjectType VARCHAR(5) = NULL\n )\n AS\n BEGIN\n     DECLARE @ObjectID AS BIGINT    \n\n         SELECT TOP(1) @ObjectID = object_id\n         FROM sys.objects\n         WHERE name = @ObjectName\n         AND type = ISNULL(@ObjectType, type)    \n\n     SET NOCOUNT ON ;    \n\n       WITH DependentObjectCTE (DependentObjectID, DependentObjectName, ReferencedObjectName, ReferencedObjectID)\n         AS\n         (\n         SELECT DISTINCT\n                sd.object_id,\n                OBJECT_NAME(sd.object_id),\n                ReferencedObject = OBJECT_NAME(sd.referenced_major_id),\n                ReferencedObjectID = sd.referenced_major_id\n         FROM    \n                sys.sql_dependencies sd\n                JOIN sys.objects so ON sd.referenced_major_id = so.object_id\n         WHERE   \n                sd.referenced_major_id = @ObjectID\n         UNION ALL\n         SELECT\n                sd.object_id,\n                OBJECT_NAME(sd.object_id),\n                OBJECT_NAME(referenced_major_id),\n                object_id\n         FROM    \n                sys.sql_dependencies sd\n             JOIN DependentObjectCTE do ON sd.referenced_major_id = do.DependentObjectID       \n         WHERE\n                sd.referenced_major_id <> sd.object_id     \n         )\n         SELECT DISTINCT\n                DependentObjectName\n         FROM   \n                DependentObjectCTE c\n END