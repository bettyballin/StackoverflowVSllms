DECLARE @LoopVar int\n\nDECLARE\n  @long int,\n  @lat int,\n  @businessname varchar(30),\n  @winner int\n\nSET @LoopVar = (SELECT MIN(rowID) FROM Locations)\n\nWHILE @LoopVar is not null\nBEGIN\n  --initialize the variables.\n  SELECT \n    @long = null,\n    @lat = null,\n    @businessname = null,\n    @winner = null\n\n  -- load data from the known good row.  \n  SELECT\n    @long = long,\n    @lat = lat,\n    @businessname = businessname\n  FROM Locations\n  WHERE rowID = @LoopVar\n\n  --find the winning row with that data\n  SELECT top 1 @Winner = rowID\n  FROM Locations\n  WHERE @long = long\n    AND @lat = lat\n    AND @businessname = businessname\n  ORDER BY\n    CASE WHEN URL is not null THEN 1 ELSE 2 END,\n    CASE WHEN Caption is not null THEN 1 ELSE 2 END,\n    RowId\n\n  --delete any losers.\n  DELETE FROM Locations\n  WHERE @long = long\n    AND @lat = lat\n    AND @businessname = businessname\n    AND @winner != rowID\n\n  -- prep the next loop value.\n  SET @LoopVar = (SELECT MIN(rowID) FROM Locations WHERE @LoopVar < rowID)\nEND