with cte_entertime as (\nSELECT\n    [PersonId] = t.c.value('(../personid)[1]', 'NVARCHAR(50)')\n    ,[First Name] = t.c.value('(../firstname)[1]', 'NVARCHAR(50)')\n    ,[Last Name] = t.c.value('(../lastname)[1]', 'NVARCHAR(50)')\n    ,[Entertime] = t.c.value('.', 'NVARCHAR(50)')\n    ,[entry_number] = ROW_NUMBER() OVER (ORDER BY t.c)\nFROM @x.nodes('root/person/entertime') t(c))\n, cte_leavetime as (\n    SELECT\n    [Leavetime] = t.c.value('.', 'NVARCHAR(50)')\n    ,[entry_number] = ROW_NUMBER() OVER (ORDER BY t.c)\nFROM @x.nodes('root/person/leavetime') t(c))\nSELECT PersonID\n    , [First Name]\n    , [Last Name] \n    , [Entertime]\n    , [Leavetime]\n    FROM cte_entertime e \n    LEFT OUTER JOIN cte_leavetime l on e.entry_number = l.entry_number