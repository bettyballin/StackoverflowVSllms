CREATE TABLE test\n(\n    id int identity(1, 1) not null,\n    description varchar(50) not null\n)\n\nINSERT INTO test VALUES('The dog jumped over the fence')\nINSERT INTO test VALUES('The giant tripped on the fence')\n\nCREATE FUNCTION dbo.Split\n(\n    @RowData nvarchar(2000),\n    @SplitOn nvarchar(5)\n)  \nRETURNS @RtnValue table \n(\n    Id int identity(1,1),\n    Data nvarchar(100)\n) \nAS  \nBEGIN \n    Declare @Cnt int\n    Set @Cnt = 1\n\n    While (Charindex(@SplitOn,@RowData)>0)\n    Begin\n        Insert Into @RtnValue (data)\n        Select \n            Data = ltrim(rtrim(Substring(@RowData,1,Charindex(@SplitOn,@RowData)-1)))\n\n        Set @RowData = Substring(@RowData,Charindex(@SplitOn,@RowData)+1,len(@RowData))\n        Set @Cnt = @Cnt + 1\n    End\n\n    Insert Into @RtnValue (data)\n    Select Data = ltrim(rtrim(@RowData))\n\n    Return\nEND\n\nCREATE FUNCTION dbo.SplitAll(@SplitOn nvarchar(5))\nRETURNS @RtnValue table\n(\n    Id int identity(1,1),\n    Data nvarchar(100)\n)\nAS\nBEGIN\nDECLARE My_Cursor CURSOR FOR SELECT Description FROM dbo.test\nDECLARE @description varchar(50)\n\nOPEN My_Cursor\nFETCH NEXT FROM My_Cursor INTO @description\nWHILE @@FETCH_STATUS = 0\nBEGIN\n    INSERT INTO @RtnValue\n    SELECT Data FROM dbo.Split(@description, @SplitOn)\n   FETCH NEXT FROM My_Cursor INTO @description\nEND\nCLOSE My_Cursor\nDEALLOCATE My_Cursor\n\nRETURN\n\nEND\n\nSELECT DISTINCT Data FROM dbo.SplitAll(N' ')