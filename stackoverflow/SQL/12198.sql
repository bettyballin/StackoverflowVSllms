CREATE FUNCTION [dbo].[RoundTime] (@Time datetime, @RoundTo float) RETURNS datetime\nAS\nBEGIN\n    DECLARE @RoundedTime smalldatetime, @Multiplier float\n\n    SET @Multiplier = 24.0 / @RoundTo\n\n    SET @RoundedTime= ROUND(CAST(CAST(CONVERT(varchar, @Time, 121) AS datetime) AS float) * @Multiplier, 0) / @Multiplier\n\n    RETURN @RoundedTime\nEND\n\n-- Usage    \nSELECT dbo.RoundTime('13:15', 0.5)