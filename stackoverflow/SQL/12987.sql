With AddrTable as (\nSelect AddrFld, MailAddr From (\nSelect Cast(ISNULL([Line1], '') as Varchar(102)) as [A1], \n       Cast(ISNULL([Line2], '') as Varchar(102)) as [A2], \n       Cast(ISNULL([Line3], '') as Varchar(102)) as [A3], \n       Cast(ISNULL(LTRIM(RTRIM(City)),'') + ' ' + ISNULL(LTRIM(RTRIM(RegionCode)),'') + '  ' + ISNULL(LTRIM(RTRIM(PostalCode)),'') as Varchar(102)) as A4\nFrom TableName Where UniqueID=@UniqueID) p\nUnpivot (MailAddr For AddrFld in ([A1], [A2], [A3], [A4])) as unpvt)\nSelect Row_Number() over (Order by (Case Len(MailAddr) When 0 then 1 else 0 end), AddrFld) as RN, \nMailAddr From AddrTable \nOrder By RN