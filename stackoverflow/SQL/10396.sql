SELECT\n     PR.RunID,\n     PR.TemplateID,\n     CASE\n          WHEN MAX(SB.LowerBound) > MAX(CB.LowerBound) AND\n                      MAX(SB.LowerBound) > MAX(PB.LowerBound) THEN MAX(SB.LowerBound)\n          WHEN MAX(CB.LowerBound) > MAX(PB.LowerBound) THEN MAX(CB.LowerBound)\n          ELSE MAX(PB.LowerBound)\n     END AS LowerBound,\n     CASE\n          WHEN MIN(SB.UpperBound) < MIN(CB. UpperBound) AND\n                      MIN(SB. UpperBound) < MIN(PB. UpperBound) THEN MIN(SB. UpperBound)\n          WHEN MIN(CB. UpperBound) < MIN(PB. UpperBound) THEN MIN(CB. UpperBound)\n          ELSE MIN(PB. UpperBound)\n     END\nFROM\n     ProductionRuns PR\nINNER JOIN TemplateMeasurements TM ON\n      TM.TemplateID = PR.TemplateID\nLEFT OUTER JOIN SimpleBounds SB ON\n     SB.TemplateID = PR.TemplateID AND\n     SB.MeasurementTypeID = TM.MeasurementTypeID\nLEFT OUTER JOIN ContainerBounds CB ON\n     CB.TemplateID = PR.TemplateID AND\n     CB.MeasurementTypeID = TM.MeasurementTypeID AND\n     CB.ContainerName = PR.ContainerName\nLEFT OUTER JOIN ProductBounds PB ON\n     PB.TemplateID = PR.TemplateID AND\n     PB.MeasurementTypeID = TM.MeasurementTypeID AND\n     PB.ProductName = PR.ProductName\nGROUP BY\n     PR.RunID,\n     PR.TemplateID