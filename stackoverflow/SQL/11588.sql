CREATE TABLE MyTable\n(\n    MyDate datetime NOT NULL PRIMARY KEY,\n    Col2 decimal(14,4) NOT NULL,\n    Col3 decimal(14,4) NOT NULL,\n    Col4 decimal(14,4) NOT NULL,\n    Col5 decimal(14,4) NOT NULL\n)\nGO\n\nINSERT INTO MyTable\nSELECT '1/3/2000 12:00:00 AM', 5209.540000000, 5384.660000000, 5209.540000000, 5375.110000000 \n UNION ALL \nSELECT '1/4/2000 12:00:00 AM', 5533.980000000, 5533.980000000, 5376.430000000, 5491.010000000\n UNION ALL \nSELECT '1/5/2000 12:00:00 AM', 5265.090000000, 5464.350000000, 5184.480000000, 5357.000000000\n UNION ALL \nSELECT '1/6/2000 12:00:00 AM', 5424.210000000, 5489.860000000, 5391.330000000, 5421.530000000 \n UNION ALL \nSELECT '1/7/2000 12:00:00 AM', 5358.280000000, 5463.250000000, 5330.580000000, 5414.480000000 \n UNION ALL \nSELECT '1/10/2000 12:00:00 AM', 5617.590000000, 5668.280000000, 5459.970000000, 5518.390000000 \n UNION ALL \nSELECT '1/11/2000 12:00:00 AM', 5513.040000000, 5537.690000000, 5221.280000000, 5296.300000000 \n UNION ALL \nSELECT '1/12/2000 12:00:00 AM', 5267.850000000, 5494.300000000, 5267.850000000, 5491.200000000\nGO\n\nCREATE VIEW MyView \nAS\nSELECT T1.*,\n    CalculatedColumn = Col3 - \n      (SELECT Col3 FROM MyTable Q2\n       WHERE Q2.MyDate = (SELECT MAX(Q1.MyDate) \n                          FROM MyTable Q1 \n                          WHERE Q1.MyDate < T1.MyDate)\n    )\nFROM MyTable T1\nGO\n\nSELECT * FROM MyView\nGO