CREATE FUNCTION gc_init(dummy VARCHAR(255)) RETURNING LVARCHAR;\n    RETURN '';\nEND FUNCTION;\n\nCREATE FUNCTION gc_iter(result LVARCHAR, value VARCHAR(255))\n    RETURNING LVARCHAR;\n    IF result = '' THEN\n        RETURN TRIM(value);\n    ELSE\n        RETURN result || ',' || TRIM(value);\n    END IF;\nEND FUNCTION;\n\nCREATE FUNCTION gc_comb(partial1 LVARCHAR, partial2 LVARCHAR)\n    RETURNING LVARCHAR;\n    IF partial1 IS NULL OR partial1 = '' THEN\n        RETURN partial2;\n    ELIF partial2 IS NULL OR partial2 = '' THEN\n        RETURN partial1;\n    ELSE\n        RETURN partial1 || ',' || partial2;\n    END IF;\nEND FUNCTION;\n\nCREATE FUNCTION gc_fini(final LVARCHAR) RETURNING LVARCHAR;\n    RETURN final;\nEND FUNCTION;\n\nCREATE AGGREGATE group_concat\n    WITH (INIT = gc_init, ITER = gc_iter,\n          COMBINE = gc_comb, FINAL = gc_fini);