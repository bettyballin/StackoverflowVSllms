SELECT rownum, a.* \n  FROM (<<your complex query including GROUP BY and ORDER BY>>) a