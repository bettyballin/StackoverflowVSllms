Create Function dbo.fnDateTable\n(\n  @StartDate datetime,\n  @EndDate datetime,\n  @DayPart char(5) -- support 'day','month','year','hour', default 'day'\n)\nReturns @Result Table\n(\n  [Date] datetime\n)\nAs\nBegin\n  Declare @CurrentDate datetime\n  Set @CurrentDate=@StartDate\n  While @CurrentDate<=@EndDate\n  Begin\n    Insert Into @Result Values (@CurrentDate)\n    Select @CurrentDate=\n    Case\n    When @DayPart='year' Then DateAdd(yy,1,@CurrentDate)\n    When @DayPart='month' Then DateAdd(mm,1,@CurrentDate)\n    When @DayPart='hour' Then DateAdd(hh,1,@CurrentDate)\n    Else\n      DateAdd(dd,1,@CurrentDate)\n    End\n  End\n  Return\nEnd