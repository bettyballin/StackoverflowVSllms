Create Function [dbo].[split]\n    (@input   varChar(8000)        -- List of delimited items\n    ,@delimit varChar(8000) = ',') -- delimiter that separates items\nReturns @List Table ([item] varChar(8000)) As\nBegin\n\nDeclare @item VarChar(8000);\n\nwhile charIndex(@delimit, @input, 0) <> 0 Begin\n\n    Select\n        @item  = rTrim(lTrim(subString(@input, 1, charIndex(@delimit, @input, 0) - 1))),\n        @input = rTrim(lTrim(subString(@input, charIndex(@delimit, @input, 0) + Len(@delimit), Len(@input))));\n\n    If Len(@item) > 0 Insert Into @List Select @item\n\nEnd\n\nIf Len(@input) > 0 Insert Into @List Select @input\n\nReturn;\n\nEnd