WITH Hierarchy(TaskID, [Subject], ParentID, IsProject, HLevel)\nAS\n(\n    SELECT \n        TaskID, \n        [Subject], \n        ParentID ,\n        IsProject,\n        0 as HLevel\n    FROM \n        Task \n    WHERE \n        TaskID = 59\n\n    UNION ALL\n\n    SELECT \n        SubDepartment.TaskID, \n        SubDepartment.[Subject], \n        SubDepartment.ParentID ,\n        SubDepartment.IsProject,\n        HLevel + 1\n    FROM \n        Task SubDepartment\n    INNER JOIN \n        Hierarchy ParentDepartment\n    ON \n        SubDepartment.TaskID = ParentDepartment.ParentID \n)\n\nSELECT \n    TaskID, \n    [Subject], \n    ParentID,\n    IsProject,\n    HLevel\nFROM  \n    Hierarchy\nORDER BY\n    HLevel DESC