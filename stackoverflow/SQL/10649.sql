with foo as\n(\nselect 1 as id, null as parent, 'CatA' as cat from dual\nunion select 2, null, 'CatB' from dual\nunion select 3, null, 'CatC' from dual\nunion select 4, 1, 'SubCatA_1' from dual\nunion select 5, 1, 'SubCatA_2' from dual\nunion select 6, 2, 'SubCatB_1' from dual\nunion select 7, 2, 'SubCatB_2' from dual\n)\nselect child.cat\nfrom foo parent right outer join foo child on parent.id = child.parent\norder by case when parent.id is not null then parent.cat else child.cat end,\n         case when parent.id is not null then 1 else 0 end