WITH hier(cnt) AS\n        (\n        SELECT  1\n        UNION ALL\n        SELECT  cnt + 1\n        FROM    hier\n        WHERE   cnt <= 100\n        )\nSELECT  CASE WHEN ROW_NUMBER() OVER (ORDER BY id) = 1 THEN ref ELSE ' / ' + SUBSTRING(ref, mc + 1, LEN(ref)) END \nFROM    (\n        SELECT  MIN(common) AS mc\n        FROM    (\n                SELECT  (\n                        SELECT  MAX(cnt)\n                        FROM    hier\n                        WHERE   SUBSTRING(initref, 1, cnt) = SUBSTRING(ref, 1, cnt)\n                                AND cnt <= LEN(ref)\n                        ) AS common\n                FROM    (\n                        SELECT  TOP 1 ref AS initref\n                        FROM    tableA\n                        ) i,\n                        tableA\n                ) q\n        ) q2, tableA\nFOR XML PATH('')\n\n---\n\n3536757616 / 17 / 18 / 28 / 29 / 30