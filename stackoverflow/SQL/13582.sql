DECLARE @ProcuctCode  int\nSET @ProductCode=11\n\nSELECT\n    h.* \n    FROM ProductPriceHistory h\n        INNER JOIN (SELECT\n                        ProductCode\n                            ,MAX(EffectDate) AS MaxEffectDate\n                        FROM ProductPriceHistory\n                        WHERE ProductCode=@ProductCode\n                            AND IsActive='true'\n                        GROUP BY ProductCode\n                   ) dt ON h.ProductCode=dt.ProductCode AND h.EffectDate=dt.MaxEffectDate\n    WHERE h.ProductCode =@ProductCode