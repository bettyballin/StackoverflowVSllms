SET NOCOUNT ON;\n\nDECLARE @host VARCHAR(50), @login NVARCHAR(128);\n\nSET @host = 'fooHost'; --NULL to kill sessions from all hosts.\nSET @login = 'fooLogin';\n\nDECLARE @cmd NVARCHAR(255);\nDECLARE @possition INT, @total INT, @selSpid SMALLINT;\nDECLARE @spidInfo TABLE\n(\n    [id] INT IDENTITY(1,1),\n    spid SMALLINT,\n    loginame NVARCHAR(128)\n);\n\nINSERT @spidInfo(spid, loginame)\nSELECT session_id, login_name \nFROM sys.dm_exec_sessions\nWHERE is_user_process = 1 AND [status] = 'sleeping' AND \n    login_name = @login AND [host_name] = COALESCE(@host, [host_name]);\n\nSELECT @total = @@IDENTITY, @selSpid = 0, @possition = 0;\n\nWHILE @possition < @total\n    BEGIN\n        SELECT TOP 1 @selSpid = spid, @possition = [id]\n        FROM @spidInfo\n        WHERE [ID] > @possition\n\n        SET @cmd = N'KILL ' + CAST(@selSpid AS NVARCHAR(10));\n        EXEC sp_executesql @cmd;\n        PRINT 'SessionId = ' + CAST(@selSpid AS NVARCHAR(10)) + '[' + @login + \n            '] killed by ' + system_user + ' at ' + CAST(GETDATE() AS VARCHAR(50));\n    END;\n\nIF (@total = 0)\n    PRINT 'No sessions owned by user ' + '[' + @login + ']';