SELECT category.category_id,\n    ancestor4.category_id AS lvl4,\n    ancestor3.category_id AS lvl3,\n    ancestor2.category_id AS lvl2,\n    ancestor1.category_id AS lvl1\nFROM categories AS category\n    LEFT JOIN categories AS ancestor1 ON ancestor1.category_id=category.category_id\n    LEFT JOIN categories AS ancestor2 ON ancestor2.category_id=ancestor1.parent\n    LEFT JOIN categories AS ancestor3 ON ancestor3.category_id=ancestor2.parent\n    LEFT JOIN categories AS ancestor4 ON ancestor4.category_id=ancestor3.parent;