WITH q AS\n        (\n        SELECT  sample_id, created_on\n        FROM    sample\n        WHERE   sam_tmpl_id = 18\n        )\nSELECT  sample_id,\n        created_on,\n        s_acid,\n        s_ph,\n        s_titr\nFROM    (\n        SELECT  sample_id, -- Rows w/ same sample_id to columns\n                MAX (CASE WHEN tst_tmpl_id = 36 THEN status END) AS s_acid,\n                MAX (CASE WHEN tst_tmpl_id = 43 THEN status END) AS s_ph,\n                MAX (CASE WHEN tst_tmpl_id = 66 THEN status END) AS s_titr\n        FROM    (\n                SELECT  test_id, test_tmpl_id, sample_id\n                FROM    test\n                )\n        JOIN    q\n        USING   (sample_id)\n        GROUP BY\n                sample_id\n        )\nJOIN    q\nUSING   (sample_id)