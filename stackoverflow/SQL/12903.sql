select ud.name,\n       order1.order_id,\n       order1.order_type,\n       order1.create_date,\n       order2.order_id,\n       order2.order_type,\n       order2.create_date\n  from user_data ud,\n       order_data order1,\n       order_data order2\n where ud.user_id = order1.user_id\n   and ud.user_id = order2.user_id\n   and order1.order_id = (select max(order_id)\n                            from order_data od1\n                           where od1.user_id = ud.user_id\n                             and od1.order_type = 'Type1')\n   and order2.order_id = (select max(order_id)\n                             from order_data od2\n                            where od2.user_id = ud.user_id\n                              and od2.order_type = 'Type2')