SELECT t.location, \n  l.city, \n  f.year, \n  f.customer,\n  SUM( NVL( CASE WHEN t.code ='C' THEN t.sale_quantity ELSE 0 END, 0)) sale_quantity\nFROM loc t, location l, father_table f \nWHERE f.number = t.number(+) \nAND f.code = '0001' \nAND f.c_code = '01' \nAND t.location= l.code(+) \nAND t.code IN ('C', 'S') \nAND t.co_code IN ('G', 'V', 'A', 'D') \nAND t.year = '2008' \nGROUP BY t.location, l.city, f.year\nORDER BY l.city, f.year