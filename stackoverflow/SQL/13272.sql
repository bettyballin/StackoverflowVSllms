SELECT\n     P.pkPatientID,\n     P.FirstName,\n     P.LastName,\n     PS1.StatusCode AS FirstStatusCode,\n     PS1.StartDate AS FirstStatusStartDate,\n     PS1.EndDate AS FirstStatusEndDate,\n     PS2.StatusCode AS SecondStatusCode,\n     PS2.StartDate AS SecondStatusStartDate,\n     PS2.EndDate AS SecondStatusEndDate\nFROM\n     Patient P\nINNER JOIN PatientStatus PS1 ON\n     PS1.fkPatientID = P.pkPatientID\nINNER JOIN PatientStatus PS2 ON\n     PS2.fkPatientID = P.pkPatientID AND\n     PS2.StartDate > PS1.StartDate\nLEFT OUTER JOIN PatientStatus PS3 ON\n     PS3.fkPatientID = P.pkPatientID AND\n     PS3.StartDate < PS1.StartDate\nLEFT OUTER JOIN PatientStatus PS4 ON\n     PS4.fkPatientID = P.pkPatientID AND\n     PS4.StartDate > PS1.StartDate AND\n     PS4.StartDate < PS2.StartDate\nWHERE\n     PS3.pkPatientStatusID IS NULL AND\n     PS4.pkPatientStatusID IS NULL