USE tempdb\nGO\n\nCREATE TABLE TableA (\n    ID int NOT NULL PRIMARY KEY,\n    ColumnA varchar(10) NOT NULL,\n    ColumnB varchar(10) NOT NULL,\n    ColumnC varchar(10) NOT NULL\n)\n\nCREATE TABLE TableB (\n    [Identity]  int IDENTITY(1,1) NOT NULL PRIMARY KEY,\n    ColumnX varchar(30) NOT NULL\n)\n\nCREATE TABLE TableC (\n    TableA_ID  int NOT NULL,\n    TableB_ID  int NOT NULL,\n    PRIMARY KEY (TableA_ID, TableB_ID)\n)\n\nGO\n\nINSERT INTO TableA VALUES (1, 'A', 'A', 'A')\nINSERT INTO TableA VALUES (2, 'A', 'A', 'B')\nINSERT INTO TableA VALUES (3, 'A', 'A', 'C')\nINSERT INTO TableA VALUES (11, 'A', 'B', 'A')\nINSERT INTO TableA VALUES (12, 'A', 'B', 'B')\nINSERT INTO TableA VALUES (13, 'A', 'B', 'C')\nINSERT INTO TableA VALUES (21, 'A', 'C', 'A')\nINSERT INTO TableA VALUES (22, 'A', 'C', 'B')\nINSERT INTO TableA VALUES (23, 'A', 'C', 'C')\nGO\n\n-- Do row-by-row processing to get the desired results\nSET NOCOUNT ON\nDECLARE @TableA_ID int\nDECLARE @TableB_Identity int\nDECLARE @ColumnX varchar(100)\n\nSET @TableA_ID = 0\n\nWHILE 1=1 BEGIN\n\n  -- Get the next row to process\n  SELECT TOP 1 \n    @TableA_ID=ID,\n    @ColumnX = ColumnA + ColumnB + ColumnC\n  FROM TableA\n  WHERE ID > @TableA_ID\n\n  -- Check if we are all done\n  IF @@ROWCOUNT = 0\n    BREAK\n\n  -- Insert row into TableB\n  INSERT INTO TableB (ColumnX)\n    SELECT @ColumnX\n\n  -- Get the identity of the new row\n  SET @TableB_Identity = SCOPE_IDENTITY()\n\n  -- At this point, you have @TableA_ID and @TableB_Identity.\n  -- Go to town with whatever extra processing you need to do\n  INSERT INTO TableC (TableA_ID, TableB_ID)\n    SELECT @TableA_ID, @TableB_Identity\n\nEND\nGO\n\nSELECT * FROM TableC\nGO