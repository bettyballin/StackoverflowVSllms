DECLARE SH CURSOR FAST_FORWARD FOR\n    SELECT PRODUCTID,EXITDEPOT, Sum(Qty) as TOTALQTY\n    FROM PRODUCTDETAILS  \n    WHERE (EXITDEPOT IS NOT NULL) \n    GROUP BY PRODUCTID, EXITDEPOT\nOPEN SH\nFETCH NEXT FROM SH INTO @SK,@DP,@DEMAND