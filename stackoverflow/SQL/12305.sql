DECLARE @DB  sysname ; set @DB = DB_NAME()\nDECLARE @U  sysname ; set @U = QUOTENAME('UserID')\n\nDECLARE @ID           integer,\n        @LAST_ID     integer,\n        @NAME        varchar(1000),\n        @SQL         varchar(4000)\n\nSET @LAST_ID = 0\n\nWHILE @LAST_ID IS NOT NULL\nBEGIN\n    SELECT @ID = MIN(id)\n    FROM dbo.sysobjects\n    WHERE id > @LAST_ID  AND type = 'P' AND category = 0\n\n    SET @LAST_ID = @ID\n\n    -- We have a record so go get the name\n    IF @ID IS NOT NULL\n    BEGIN\n        SELECT @NAME = name\n        FROM dbo.sysobjects\n        WHERE id = @ID\n\n        -- Build the DCL to do the GRANT\n        SET @SQL = 'GRANT EXECUTE ON ' + @NAME + ' TO ' + @U\n\n        -- Run the SQL Statement you just generated\n        EXEC master.dbo.xp_execresultset @SQL, @DB\n\n    END   \nEND