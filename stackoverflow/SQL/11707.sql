USE tempdb;\nGO\n\nCREATE TABLE t1 (foo int);\nCREATE TABLE t2 (id int IDENTITY, foo int);\nCREATE TABLE t3 (t2_id int);\nGO\n\nCREATE TRIGGER t1_insert ON t1\nFOR INSERT AS\nBEGIN   \n    DECLARE @new_rows TABLE(new_id INT, old_foo INT);\n\n    INSERT t2(foo)\n      OUTPUT inserted.id, inserted.foo \n      INTO @new_rows\n    SELECT foo\n    FROM inserted;\n\n    INSERT t3 SELECT new_id FROM @new_rows;\nEND\nGO\n\nINSERT t1(foo) SELECT 1 UNION ALL SELECT 5;\nSELECT * FROM t1;\nSELECT * FROM t2;\nSELECT * FROM t3;\nGO\n\nDROP TABLE t1,t2,t3;