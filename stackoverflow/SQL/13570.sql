WITH BracketIndeces AS\n(\n  SELECT \n    ColumnX AS ColVal,\n    CHARINDEX('(', ColumnX) as first_open_bracket,\n    CHARINDEX('(', ColumnX, CHARINDEX('(', ColumnX)+1) as second_open_bracket,\n    CHARINDEX(')', ColumnX) as first_close_bracket,\n    CHARINDEX(')', ColumnX, CHARINDEX(')', ColumnX)+1) as second_close_bracket\n  FROM SomeTable\n)\nSELECT\n  CASE\n    WHEN second_close_bracket = 0 THEN\n        SUBSTRING(ColVal, first_open_bracket+1, first_close_bracket - first_open_bracket-1)\n    ELSE\n        SUBSTRING(ColVal, second_open_bracket+1, second_close_bracket - second_open_bracket-1)      \n  END AS Column1,\n  CASE\n    WHEN second_close_bracket = 0 THEN\n        NULL\n    ELSE\n        SUBSTRING(ColVal, first_open_bracket+1, first_close_bracket - first_open_bracket-1)\n  END AS Column2\nFROM BracketIndeces\nWHERE first_open_bracket <> 0\nAND first_close_bracket <> 0\nAND first_open_bracket < first_close_bracket\nAND (\n  (second_open_bracket = 0 AND second_close_bracket = 0) \n  OR\n  (second_open_bracket < second_close_bracket \n    AND second_open_bracket > first_close_bracket\n  )\n)