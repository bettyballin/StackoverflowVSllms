SELECT\n    r.RequesterID,\n    p.FirstName + ' ' + p.LastName AS RequesterName,\n    sra1.ModifiedDate as UrgentModifiedDate,\n    sra1.AttributeValue as Urgent,\n    sra2.ModifiedDate as ClosedModifiedDate,\n    sra2.AttributeValue as Closed\nFROM\n    Personnel AS p\nINNER JOIN\n    Requester AS r \nON\n(\n    r.UserID = p.ContractorID\nOR\n    r.UserID = p.EmployeeID\n)\nLEFT OUTER JOIN\n(\n    SELECT\n        sr1.RequesterID,\n        sr1.ModifiedDate,\n        sa1.Attribute,\n        sa1.AttributeValue\n    FROM\n        SubRequester AS sr1\n    INNER JOIN\n        SubRequesterAttribute AS sa1\n    ON\n        sr1.SubRequesterID = sa1.SubRequesterID\n    AND\n        sa1.Attribute = 'Urgent'\n) sra1\nON\n    sra1.RequesterID = r.RequesterID\nLEFT OUTER JOIN\n(\n    SELECT\n        sr2.RequesterID,\n        sr2.ModifiedDate,\n        sa2.Attribute,\n        sa2.AttributeValue\n    FROM\n        SubRequester AS sr2\n    INNER JOIN\n        SubRequesterAttribute AS sa2\n    ON\n        sr2.SubRequesterID = sa2.SubRequesterID\n    AND\n        sa2.Attribute = 'Closed'\n) sra1\nON\n    sra2.RequesterID = r.RequesterID