SELECT s_id, s_title, log10(Z) + (Y * s_timediff)/45000 AS redditfunction \n    FROM (\n    SELECT stories.s_id, stories.s_title, stories.s_time, \n    stories.s_time - now() AS s_timediff, \n    count(s_ups.s_id) - count(s_downs.s_id) as X, \n    if(X>0,1,if(x<0,-1,0)) as Y, \n    if(abs(x)>=1,abs(x),1) as Z\n    FROM stories \n    LEFT JOIN s_ups ON stories.q_id=s_ups.s_id\n    LEFT JOIN s_downs ON stories.s_id=s_downs.s_id\n    GROUP BY stories.s_id\n    ) as derived_table1