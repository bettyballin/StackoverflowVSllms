SELECT \n  astats.AQTORStatsID\n, astats.ServerName\n, astats.Remarks\n, astats.StatsBeginDateTime\n, astats.StatsEndDateTime\n\n, QtCPU_Average           = max(case when asi.AQTORStatName = 'QtCPU_Average'           then asi.AQTORStatValue end)\n, QtCPU_TopQuintile       = max(case when asi.AQTORStatName = 'QtCPU_TopQuintile'       then asi.AQTORStatValue end)\n, QtCPU_TopOnePercent     = max(case when asi.AQTORStatName = 'QtCPU_TopOnePercent'     then asi.AQTORStatValue end)\n, QtCl_Average            = max(case when asi.AQTORStatName = 'QtCl_Average'            then asi.AQTORStatValue end)\n, QtCl_TopQuintile        = max(case when asi.AQTORStatName = 'QtCl_TopQuintile'        then asi.AQTORStatValue end)\n, QtCl_TopOnePercent      = max(case when asi.AQTORStatName = 'QtCl_TopOnePercent'      then asi.AQTORStatValue end)\n, UpdPrcStd_Average       = max(case when asi.AQTORStatName = 'UpdPrcStd_Average'       then asi.AQTORStatValue end)\n, UpdPrcStd_TopQuintile   = max(case when asi.AQTORStatName = 'UpdPrcStd_TopQuintile'   then asi.AQTORStatValue end)\n, UpdPrcStd_TopOnePercent = max(case when asi.AQTORStatName = 'UpdPrcStd_TopOnePercent' then asi.AQTORStatValue end)\n, RcRsUPr_Average         = max(case when asi.AQTORStatName = 'RcRsUPr_Average'         then asi.AQTORStatValue end)\n, RcRsUPr_TopQuintile     = max(case when asi.AQTORStatName = 'RcRsUPr_TopQuintile'     then asi.AQTORStatValue end)\n, RcRsUPr_TopOnePercent   = max(case when asi.AQTORStatName = 'RcRsUPr_TopOnePercent'   then asi.AQTORStatValue end)\n\nfrom tb_dAQTORStats astats\njoin tb_rAQTORStatsItem asi on asi.AQTORStatsID = astats.AQTORStatsID  \n\ngroup by \n  astats.AQTORStatsID\n, astats.ServerName\n, astats.Remarks\n, astats.StatsBeginDateTime\n, astats.StatsEndDateTime