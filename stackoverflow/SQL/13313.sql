SELECT COALESCE(st.Price, rg.Price, gn.Price) AS Price\n  FROM dbo.Prices gn  /*General price*/\n  LEFT OUTER JOIN dbo.Prices rg /*Regional price*/\n    ON rg.Product = @Product AND rg.Region = @Region AND rg.Store IS NULL\n  LEFT OUTER JOIN dbo.Prices st  /*Store price*/\n    ON rg.Product = @Product AND rg.Region = @Region AND rg.Store = @Store\n  WHERE gn.Product = @Product\n    AND gn.Region IS NULL AND gn.Store IS NULL