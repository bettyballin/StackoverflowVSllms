select q.question_id, question_text, a.answer_id, a.answer_text, count(user_ip)\n  from questions q\n inner join answers a on (q.question_id = a.question_id)\n  left join answered_questions aq on (a.question_id = aq.question_id\n                                      and a.answer_id = aq.answer_id)\n where created_at = (select max(created_at)\n                       from questions\n                     )\n group by q.question_id, a.answer_id, q.question_text, a.answer_text