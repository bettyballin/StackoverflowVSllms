SELECT  *\nFROM    (\n        SELECT  DISTINCT\n                c.name AS c_name,\n                sc.name AS sc_name,\n                ssc.name AS ssc_name\n        FROM    categories c\n        LEFT JOIN\n                subcategories sc\n        ON      c.id = sc.category_id\n        LEFT JOIN\n                subsubcategories ssc\n        ON      sc.id = ssc.subcategory_id\n        GROUP BY\n                c.name, sc.name, ssc.name WITH ROLLUP\n        HAVING  c_name IS NOT NULL\n        ) q\nORDER BY\n        c_name, sc_name, ssc_name