SELECT \n    SUBSTRING(LTRIM(STR(Blockid)), 1, 6) AS blockid,\n    COUNT(DISTINCT SUBSTRING(LTRIM(STR(Blockid)), 7, 2)) AS noofBlocks,\n    SUM(CASE Stateorprivate WHEN 'Deemana' THEN 1 ELSE 0 END) AS Deemana,\n    SUM(CASE Stateorprivate WHEN 'State' THEN 1 ELSE 0 END) AS [State],\n    SUM(CASE Stateorprivate WHEN 'Private' THEN 1 ELSE 0 END) AS [Private],\n    SUM(CASE Stateorprivate\n        WHEN 'Deemana' THEN 1\n        WHEN 'State' THEN 1\n        WHEN 'Private' THEN 1\n        ELSE 0\n    END) AS Amt_of_Deemana_State_Private\nFROM LandParcels\nGROUP BY SUBSTRING(LTRIM(STR(Blockid)), 1, 6)