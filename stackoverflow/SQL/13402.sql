select distinct id, value,\ndecode(startMonth, null,\n  lag(startMonth) over(partition by id, value order by startMonth, endMonth),  --if start is null, it's an end so take from the row before\nstartMonth) startMonth,\n\n  decode(endMonth, null,\n  lead(endMonth) over(partition by id, value order by startMonth, endMonth),  --if end is null, it's an start so take from the row after\nendMonth) endMonth    \n\nfrom (\nselect id, value, startMonth, endMonth from(\nselect id, value, \ndecode(month+1, lead(month) over(partition by id,value order by month), null, month)     \nstartMonth, --get the beginning month for each interval\ndecode(month-1, lag(month) over(partition by id,value order by month), null, month)     \nendMonth --get the end month for each interval from Tbl\n) a \nwhere startMonth is not null or endMonth is not null --remain with start and ends only\n)b