ALTER PROCEDURE [WTFAULT].[usp_WTFault_GetPartFaultStatus](@linxPartId int = -1,\n@faultStatus varchar(10) output)\nAS   \n\nSELECT COUNT(*) as MaturityCount,WTFAULT.FAULT.MATURITY  INTO #Temp\nFROM WTFAULT.PART JOIN WTFAULT.FAULT \n    ON WTFAULT.PART.FAULT_COID = WTFAULT.FAULT.COID \nWHERE TFAULT.PART.LINX_PARTID = @linxPartId \nGROUP BY WTFAULT.FAULT.MATURITY\n\nIf (select MaturityCount from #temp where WTFAULT.FAULT.MATURITY = 'ALLOCATED') >0\n    BEGIN\n        SET @faultStatus = 'ALLOCATED'\n    END\nELSE IF\n(select MaturityCount from #temp where WTFAULT.FAULT.MATURITY = 'DRAFT') >0\n    BEGIN\n        SET @faultStatus = 'DRAFT'\n    END\nELSE IF\n(select MaturityCount from #temp where WTFAULT.FAULT.MATURITY = 'CLOSED') >0\n    BEGIN\n        SET @faultStatus = 'CLOSED'  \n    END\nELSE \n    BEGIN                                        \n        SET @faultStatus = ''                        \n    END  