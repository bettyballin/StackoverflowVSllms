DECLARE @TABLE1 TABLE\n        (\n        id                  INT,\n        status              VARCHAR(50),\n        date_this_status    DATETIME\n        )\n\nDECLARE @TABLE1_hist TABLE\n        (\n        id                  INT,\n        status              VARCHAR(50),\n        date_this_status    DATETIME\n        )\n\n--TABLE1\nINSERT  @TABLE1\nSELECT  1,  'open',     '2008-12-12'    UNION ALL\nSELECT  2,  'closed',   '2009-01-01'    UNION ALL\nSELECT  3,  'pending',  '2009-05-05'    UNION ALL\nSELECT  4,  'pending',  '2009-05-06'    UNION ALL\nSELECT  5,  'open',     '2009-06-01'\n\n--TABLE1_hist\nINSERT  @TABLE1_hist\nSELECT  2,  'open',     '2008-12-24'    UNION ALL\nSELECT  2,  'pending',  '2008-12-26'    UNION ALL\nSELECT  3,  'open',     '2009-04-24'    UNION ALL\nSELECT  4,  'open',     '2009-05-04'\n\nSELECT      x.id,\n            ISNULL(y.[status], x.[status])                  AS [status],\n            ISNULL(y.date_this_status, x.date_this_status)  AS date_this_status\nFROM        @TABLE1 x\nLEFT JOIN   (\n            SELECT      a.*\n            FROM        @TABLE1_hist a\n            INNER JOIN  (\n                        SELECT      id,\n                                    MIN(date_this_status) AS date_this_status\n                        FROM        @TABLE1_hist\n                        GROUP BY    id\n                        ) b\n                    ON  a.id = b.id\n                    AND a.date_this_status = b.date_this_status\n            ) y\n        ON  x.id = y.id