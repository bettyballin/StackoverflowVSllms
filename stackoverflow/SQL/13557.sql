--CREATE TABLE so1008354 (\n--  Name1 VARCHAR(10)\n--  ,Name2 VARCHAR(10)\n--  ,Name3 VARCHAR(10)\n--  ,Name4 VARCHAR(10)\n--)\n--\n--INSERT INTO so1008354 (Name1, Name2, Name3, Name4) VALUES ( 'N1', 'N2', 'N3', 'N4' ) \n--INSERT INTO so1008354 (Name1, Name2, Name3, Name4) VALUES ( '1', '2', '4', '7' ) \n--INSERT INTO so1008354 (Name1, Name2, Name3, Name4) VALUES ( '3', '1', '8', '7' ) \n--INSERT INTO so1008354 (Name1, Name2, Name3, Name4) VALUES ( '4', '8', '5', '7' ) \n--INSERT INTO so1008354 (Name1, Name2, Name3, Name4) VALUES ( '7', '5', '3', '8' ) \n\nSELECT  *\nFROM    so1008354\n\n--\n;\nWITH    unpvt\n          AS ( SELECT   col1,\n                        col2\n               FROM     so1008354 UNPIVOT ( col2 FOR col1 IN ( [Name1], [Name2], [Name3], [Name4] ) ) AS unpvt\n             ) ,\n        XLate\n          AS ( SELECT   col1 AS NameList_pre,\n                        col2 AS NameList\n               FROM     unpvt\n               WHERE    col2 LIKE 'N%'\n             ) ,\n        Data\n          AS ( SELECT   col1 AS NameList_pre,\n                        col2 AS Tokens\n               FROM     unpvt\n               WHERE    col2 NOT LIKE 'N%'\n             )\n    SELECT  XLate.NameList,\n            Data.Tokens\n    FROM    Data\n            INNER JOIN XLate ON XLate.NameList_pre = Data.NameList_pre\n    ORDER BY XLate.NameList,\n            Data.Tokens