CREATE PROCEDURE dbo.p_cleanUpCursor @cursorName varchar(255) AS\nBEGIN\n\n    DECLARE @cursorStatus int\n    SET @cursorStatus =  (SELECT cursor_status('global',@cursorName))\n\n    DECLARE @sql varchar(255)\n    SET @sql = ''\n\n    IF @cursorStatus > 0\n        SET @sql = 'CLOSE '+@cursorName\n\n    IF @cursorStatus > -3\n        SET @sql = @sql+' DEALLOCATE '+@cursorName\n\n    IF @sql <> ''\n        exec(@sql)\n\nEND