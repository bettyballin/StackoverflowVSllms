CREATE TABLE #MaxVal(id INT,VALUE varchar(10),SomeDate DATETIME)\n    INSERT #MaxVal VALUES(1,'a','2009-02-10 14:48:45.143')\n    INSERT #MaxVal VALUES(1,'b','2009-02-10 13:48:45.143')\n    INSERT #MaxVal VALUES(1,'c','2009-02-10 11:48:45.143')\n    INSERT #MaxVal VALUES(2,'d','2009-02-10 11:48:45.143')\n    INSERT #MaxVal VALUES(2,'e','2009-02-10 12:48:45.143')\n    INSERT #MaxVal VALUES(2,'f','2009-02-10 13:48:45.143')\n    INSERT #MaxVal VALUES(3,'g','2009-02-10 11:48:45.143')\n    INSERT #MaxVal VALUES(3,'h','2009-02-10 14:48:45.143')\n\n\n\n\nSELECT t.* FROM(\n    SELECT id,MAX(SomeDate) AS MaxValue\n    FROM #MaxVal\n    WHERE SomeDate >='2009-02-10'\n        AND SomeDate < '2009-02-11'\n    GROUP BY id) x\n    JOIN #MaxVal t ON x.id =t.id\n    AND x.MaxValue =t.SomeDate