Create Procedure GetPagedData\n@Page Integer = 1,\n@PageSize Integer = 100,\n@UsersFilteringCOnditions,\n@UsersSortOptions\nAs\nSet NoCount On\n\nDeclare @Start Integer,\nDeclare @End Integer\nDeclare @NumRecs Integer\n\n   -- Declare a temp table variable to hold all the pk values...\n   Declare @Keys Table (rowNum integer Identity Primary Key NotNull,\n                        keyVal Integer Not Null)\n\n   -- Insert all the Primary Keys into the temp table variable...\n   Insert @keys(keyVal)\n   Select PrimaryKey From MyMillionRowTable\n   Where UsersFilterConditionsAreTrue\n   Order By UsersSortOptions\n\n  -- Then, select from your big table only the data \n  -- from the rows for the page the user wants\n\n   Select @NumRecs = Count(*) From Keys \n   Set @End = @Page * @PageSize\n   Set @Start = @End + 1 - @PageSize\n\n   Select {Insert ColumnListHere}\n   From MyMillionRowTable T\n       Join @Keys K On K.KeyVal = T.PrimaryKey \n   Where K.rowNum Between @Start And @End