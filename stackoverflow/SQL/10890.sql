create function ProperCase(@Text as varchar(8000))\nreturns varchar(8000)\nas\nbegin\n  declare @Reset bit;\n  declare @Ret varchar(8000);\n  declare @i int;\n  declare @c char(1);\n\n  if @Text is null\n    return null;\n\n  select @Reset = 1, @i = 1, @Ret = '';\n\n  while (@i <= len(@Text))\n    select @c = substring(@Text, @i, 1),\n      @Ret = @Ret + case when @Reset = 1 then UPPER(@c) else LOWER(@c) end,\n      @Reset = case when @c like '[a-zA-Z]' then 0 else 1 end,\n      @i = @i + 1\n  return @Ret\nend