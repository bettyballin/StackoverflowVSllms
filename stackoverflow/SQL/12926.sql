declare @maxSlot int \nset @maxSlot = select max(slots) from SlotTable\n\ntruncate ProjectedTable\nwhile @i > 0 \n    begin\n    insert into ProjectedTable (\n          SlotSum\n          ,Slot\n    ) values (\n          (select sum(slotValue) from SlotTable where slots >= @maxSlot)\n         ,@maxSlot\n    )\n    set @maxSlot = @maxSlot - 1 \nend\nselect SlotSum, Slot from ProjectedTable