declare @emails varchar(2000)\nset @emails = 'person1@yahoo.com;person2@hotmail.com;person1@yahoo.com;'\n\ndeclare @results table (row int identity(1,1), email varchar(500))\n\nwhile ((select charindex(';',@emails)) > 0)\nbegin   \n    insert into @results select substring(@emails,1,charindex(';',@emails))\n    select @emails = substring(@emails,charindex(';',@emails)+1,len(@emails))\nend\n\nselect distinct email from @results