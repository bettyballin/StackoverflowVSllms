DECLARE @YourTable TABLE (\n  A VARCHAR(2)\n  , B VARCHAR(2)\n  , C VARCHAR(2)\n  , D VARCHAR(2))\n\nINSERT INTO @YourTable VALUES (NULL, 'd0', 'd0', NULL)\nINSERT INTO @YourTable VALUES (NULL, 'd0', 'd1', NULL)\nINSERT INTO @YourTable VALUES (NULL, 'd0', 'd2', 'a0')\nINSERT INTO @YourTable VALUES ('d0', 'd1', 'd1', NULL)\nINSERT INTO @YourTable VALUES ('d0', 'd2', 'd2', 'a0')\n\n\nSELECT A, B, C = MIN(C), D\nFROM @YourTable\nGROUP BY A, B, D