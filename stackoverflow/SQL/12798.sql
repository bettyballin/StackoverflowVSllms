create or replace function example_subtree (integer)\nreturns setof example as\n'declare results record;\n         child record;\n begin\n  select into results * from example where parent_id = $1;\n  if found then\n    return next results;\n    for child in select id from example\n                  where parent_id = $1\n      loop\n        for temp in select * from example_subtree(child.id)\n        loop\n          return next temp;\n        end loop;\n      end loop;\n  end if;\n  return null;\nend;' language 'plpgsql';\n\nselect sum(value) as value_sum\n  from example_subtree(1234);