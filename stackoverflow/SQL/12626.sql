CREATE PROCEDURE prc_clean_tables (Y INT, Z INT)\nBEGIN\n        BEGIN TRANSACTION;\n\n        DECLARE _now DATETIME;\n        SET _now := NOW();\n\n        INSERT\n        INTO    b\n        SELECT  *\n        FROM    a\n        WHERE   timestamp < _now - INTERVAL Y DAY;\n        FOR UPDATE;\n\n        DELETE\n        FROM    a\n        WHERE   timestamp < _now - INTERVAL Y DAY;\n\n        DELETE\n        FROM    b\n        WHERE   timestamp < _now - INTERVAL Z DAY;\n\n        COMMIT;\nEND