DECLARE @test TABLE\n(\n  street VARCHAR(100)\n)\n\nINSERT INTO @test (street) VALUES('Street')\nINSERT INTO @test (street) VALUES('Street 1A')\nINSERT INTO @test (street) VALUES('Street1 12B')\nINSERT INTO @test (street) VALUES('Street 22A')\nINSERT INTO @test (street) VALUES('Street1 200B-8a')\nINSERT INTO @test (street) VALUES('')\nINSERT INTO @test (street) VALUES(NULL)\n\nSELECT\n  street,\n  CASE \n    WHEN LEN(street) > 0 AND CHARINDEX(' ', REVERSE(street)) > 0\n    THEN CASE\n      WHEN RIGHT(street, CHARINDEX(' ', REVERSE(street)) - 1) LIKE '%[0-9]%'\n      THEN LEFT(street, LEN(street) - CHARINDEX(' ', REVERSE(street)))\n    END\n  END street_part,\n  CASE \n    WHEN LEN(street) > 0 AND CHARINDEX(' ', REVERSE(street)) > 0\n    THEN CASE \n      WHEN RIGHT(street, CHARINDEX(' ', REVERSE(street)) - 1) LIKE '%[0-9]%'\n      THEN RIGHT(street, CHARINDEX(' ', REVERSE(street)) - 1)\n    END\n  END house_part,\n  CASE \n    WHEN LEN(street) > 0 AND CHARINDEX(' ', REVERSE(street)) > 0\n    THEN CASE \n      WHEN RIGHT(street, CHARINDEX(' ', REVERSE(street)) - 1) LIKE '%[0-9]%'\n      THEN CASE\n        WHEN PATINDEX('%[a-z]%', LOWER(RIGHT(street, CHARINDEX(' ', REVERSE(street)) - 1))) > 0\n        THEN CONVERT(INT, LEFT(RIGHT(street, CHARINDEX(' ', REVERSE(street)) - 1), PATINDEX('%[^0-9]%', LOWER(RIGHT(street, CHARINDEX(' ', REVERSE(street)) - 1))) - 1))\n      END\n    END\n  END house_part_num\nFROM\n  @test \nORDER BY\n  street_part,\n  house_part_num,\n  house_part