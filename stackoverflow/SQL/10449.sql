WITH file AS (\n  SELECT t.content_id,\n         MAX(t.file_location) keep (DENSE_RANK t.first ORDER BY t.resolution DESC) 'fileLocation',\n         MAX(t.file_size) keep (DENSE_RANK t.first ORDER BY t.resolution DESC) 'fileSize'\n    FROM mat t\nGROUP BY t.content_id)\nSELECT m.material_id, \n       m.content_id,\n       f.fileLocation,\n       f.fileSize\n  FROM mat m\n  JOIN file f ON f.content_id = m.content_id