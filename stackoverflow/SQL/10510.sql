CREATE TABLE t1 (a integer PRIMARY KEY);\n\nCREATE FUNCTION test_exception() RETURNS boolean LANGUAGE plpgsql AS\n$$BEGIN\n   INSERT INTO t1 (a) VALUES (1);\n   INSERT INTO t1 (a) VALUES (2);\n   INSERT INTO t1 (a) VALUES (1);\n   INSERT INTO t1 (a) VALUES (3);\n   RETURN TRUE;\nEXCEPTION\n   WHEN integrity_constraint_violation THEN\n      RAISE NOTICE 'Rollback to savepoint';\n      RETURN FALSE;\nEND;$$;\n\nBEGIN;\n\nSELECT test_exception();\nNOTICE:  Rollback to savepoint\n test_exception \n----------------\n f\n(1 row)\n\nCOMMIT;\n\nSELECT count(*) FROM t1;\n count \n-------\n     0\n(1 row)