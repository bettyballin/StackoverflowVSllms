SELECT\n     value_column1,\n     (\n     SELECT\n          AVG(value_column1) AS moving_average\n     FROM\n          Table1 T2\n     WHERE\n          (\n               SELECT\n                    COUNT(*)\n               FROM\n                    Table1 T3\n               WHERE\n                    date_column1 BETWEEN T2.date_column1 AND T1.date_column1\n          ) BETWEEN 1 AND 20\n     )\nFROM\n     Table1 T1