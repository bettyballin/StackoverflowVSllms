SELECT  creation_time \n        ,last_execution_time\n        ,total_physical_reads\n        ,total_logical_reads \n        ,total_logical_writes\n        , execution_count\n        , total_worker_time\n        , total_elapsed_time\n        , total_elapsed_time / execution_count avg_elapsed_time\n        ,SUBSTRING(st.text, (qs.statement_start_offset/2) + 1,\n         ((CASE statement_end_offset\n          WHEN -1 THEN DATALENGTH(st.text)\n          ELSE qs.statement_end_offset END\n            - qs.statement_start_offset)/2) + 1) AS statement_text\nFROM sys.dm_exec_query_stats AS qs\nCROSS APPLY sys.dm_exec_sql_text(qs.sql_handle) st\nORDER BY total_elapsed_time / execution_count DESC;