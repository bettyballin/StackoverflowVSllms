select *\nfrom (\n  with target_person as (\n    select \n      p.person_id,\n      p.family_number,\n      p.relationship_type_id\n    from \n      people p\n    where\n      p.relationship_type_id = 1 -- parent\n  )\n  select\n    target_person.person_id,\n    related_person.related_person_id,\n    related_person.relationship_type_id\n  from\n    target_person,\n    target_person related_person\n  where\n    target_person.person_id != related_person.person_id\n    and target_person.family_number = related_person.family_number\n);