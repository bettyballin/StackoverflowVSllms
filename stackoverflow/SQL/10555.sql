DECLARE @Key2 INT\nDECLARE @Subset VARCHAR(1000)\nDECLARE @tblResults TABLE\n(\n    Key2 INT,\n    Subset VARCHAR(1000)\n)\n\nSET @Subset = ''\nSELECT @Key2 = MIN(Key2) FROM #t1\n\nWHILE @Key2 IS NOT NULL\nBEGIN\n    SELECT @Subset = @Subset + CAST(Key1 AS VARCHAR(10))\n    FROM #t1\n    WHERE Key2 = @Key2\n\n    INSERT INTO @tblResults (Key2, Subset)\n    VALUES (@Key2, @Subset)\n\n    SET @Subset = ''\n    SELECT @Key2 = MIN(Key2) FROM #t1 WHERE Key2 > @Key2\nEND\n\nSELECT * FROM @tblResults