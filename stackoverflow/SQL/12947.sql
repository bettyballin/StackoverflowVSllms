SELECT TOP 1 allDates.intPK, allDates.datLastAction AS datLastScan, allDates.operation, dbo.viwAssets.strFriendlyName, tblAssetsInUse_join.intAssetID\nFROM (SELECT TOP 1 intPK, intAssetID, datCheckedOut AS datLastAction, 'Out' AS operation\n  FROM dbo.tblAssetsInUse AS tblAssetsInUse_out\n  ORDER BY datCheckedOut DESC\n\n  UNION ALL\n\n  SELECT TOP 1 intPK, intAssetID, datCheckedIn AS datLastAction, 'In' AS operation\n  FROM dbo.tblAssetsInUse AS tblAssetsInUse_in\n  ORDER BY datCheckedIn DESC) AS allDates \nINNER JOIN\n  dbo.viwAssets ON allDates.intAssetID = dbo.viwAssets.intPK\nORDER BY datLastScan DESC