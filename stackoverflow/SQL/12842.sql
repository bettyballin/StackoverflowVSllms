/*\n    Splits string into parts delimitered with specified character.\n*/\nCREATE FUNCTION [dbo].[SDF_SplitString]\n(\n    @sString nvarchar(2048),\n    @cDelimiter nchar(1)\n)\nRETURNS @tParts TABLE ( part nvarchar(2048) )\nAS\nBEGIN\n    if @sString is null return\n    declare @iStart int,\n            @iPos int\n    if substring( @sString, 1, 1 ) = @cDelimiter \n    begin\n        set @iStart = 2\n        insert into @tParts\n        values( null )\n    end\n    else \n        set @iStart = 1\n    while 1=1\n    begin\n        set @iPos = charindex( @cDelimiter, @sString, @iStart )\n        if @iPos = 0\n            set @iPos = len( @sString )+1\n        if @iPos - @iStart > 0          \n            insert into @tParts\n            values  ( substring( @sString, @iStart, @iPos-@iStart ))\n        else\n            insert into @tParts\n            values( null )\n        set @iStart = @iPos+1\n        if @iStart > len( @sString ) \n            break\n    end\n    RETURN\n\nEND