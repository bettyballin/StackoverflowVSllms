CREATE VIEW dbo.StudentStartDates\nAS\n    SELECT\n        S.StudentID,\n        S.StartDate,\n        S.Field1,\n        S.Field2\n    FROM\n        dbo.Students S\n    LEFT OUTER JOIN dbo.Students PREV ON\n        PREV.StudentID = S.StudentID AND\n        PREV.Field1 = S.Field1 AND\n        PREV.Field2 = S.Field2 AND\n        PREV.EndDate = DATEADD(dy, -1, S.StartDate)\n    WHERE PREV.StudentID IS NULL\nGO\n\nCREATE VIEW dbo.StudentEndDates\nAS\n    SELECT\n        S.StudentID,\n        S.EndDate,\n        S.Field1,\n        S.Field2\n    FROM\n        dbo.Students S\n    LEFT OUTER JOIN dbo.Students NEXT ON\n        NEXT.StudentID = S.StudentID AND\n        NEXT.Field1 = S.Field1 AND\n        NEXT.Field2 = S.Field2 AND\n        NEXT.StartDate = DATEADD(dy, 1, S.EndDate)\n    WHERE NEXT.StudentID IS NULL\nGO\n\n\nSELECT\n    SD.StudentID,\n    SD.StartDate,\n    ED.EndDate,\n    SD.Field1,\n    SD.Field2\nFROM\n    dbo.StudentStartDates SD\nINNER JOIN dbo.StudentEndDates ED ON\n    ED.StudentID = SD.StudentID AND\n    ED.Field1 = SD.Field1 AND\n    ED.Field2 = SD.Field2 AND\n    ED.EndDate > SD.StartDate AND\n    NOT EXISTS (SELECT * FROM dbo.StudentEndDates ED2 WHERE ED2.StudentID = SD.StudentID AND ED2.Field1 = SD.Field1 AND ED2.Field2 = SD.Field2 AND ED2.EndDate < ED.EndDate AND ED2.EndDate > SD.StartDate)\nGO