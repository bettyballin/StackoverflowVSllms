function isoDateStringToDate (datestr) {\n  if (! this.re) {\n    // The date in YYYY-MM-DD or YYYYMMDD format\n    var datere = "(\\d{4})-?(\\d{2})-?(\\d{2})";\n    // The time in HH:MM:SS[.uuuu] or HHMMSS[.uuuu] format\n    var timere = "(\\d{2}):?(\\d{2}):?(\\d{2}(?:\\.\\d+)?)";\n    // The timezone as Z or in +HH[:MM] or -HH[:MM] format\n    var tzre = "(Z|(?:\\+|-)\\d{2}(?:\\:\\d{2})?)?";\n    this.re = new RegExp("^" + datere + "[ T]" + timere + tzre + "$");\n  }\n\n  var matches = this.re.exec(datestr);\n  if (! matches)\n    return null;\n\n  var year = matches[1];\n  var month = matches[2] - 1;\n  var day = matches[3];\n  var hour = matches[4];\n  var minute = matches[5];\n  var second = Math.floor(matches[6]);\n  var ms = matches[6] - second;\n  var tz = matches[7];\n  var ms = 0;\n  var offset = 0;\n\n  if (tz && tz != "Z") {\n    var tzmatches = tz.match(/^(\+|-)(\d{2})(\:(\d{2}))$/);\n    if (tzmatches) {\n      offset = Number(tzmatches[2]) * 60 + Number(tzmatches[4]);\n      if (tzmatches[1] == "-")\n        offset = -offset;\n    }\n  }\n\n  offset *= 60 * 1000;\n  var dateval = Date.UTC(year, month, day, hour, minute, second, ms) - offset;\n\n  return new Date(dateval);\n}