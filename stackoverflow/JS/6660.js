TG.util.oauth = {\n    win: null,\n    timer: null,\n    loginUpdate: function() {\n        $.getJSON('/-login/check?format=json', TG.util.oauth.loginCallback);\n    },\n    loginCallback: function(data) {\n        if (data && data.loggedin) {\n            TG.util.login.update(data);\n        }\n    },\n    winCheck: function() {\n        if (!TG.util.oauth.win || TG.util.oauth.win.closed) {\n            window.clearInterval(TG.util.oauth.timer);\n            return TG.util.oauth.loginUpdate();\n        }\n    },\n    loginClick: function() {\n        TG.util.oauth.win = window.open('/-oauth-twitter/request?gotoafter=1&gotor=oauthtwitter&gotop=action%3Dwindowend', \n            'OAuthTwitterRequest', \n            'menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes,width=800,height=400');\n        if (!TG.util.oauth.win) return true;\n\n        TG.util.oauth.timer = window.setInterval(TG.util.oauth.winCheck, 300);\n        return false;\n    }\n};