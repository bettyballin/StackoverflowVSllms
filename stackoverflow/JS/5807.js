;(function($) {\n    var rq = [];\n    var ajax = $.ajax;\n    $.ajax = function(settings) {\n        // override complete() operation\n        var complete = settings.complete;\n        settings.complete = function(xhr) {\n            if (xhr) {\n                // xhr may be undefined, for example when downloading JavaScript\n                for (var i = 0, len = rq.length; i < len; ++i) {\n                    if (rq[i] == xhr) {\n                        // drop completed xhr from list\n                        rq.splice(i, 1);\n                        break;\n                    }\n                }\n            }\n            // execute base\n            if (complete) {\n                complete.apply(this, arguments)\n            }\n        }\n\n        var r = ajax.apply(this, arguments);\n        if (r) {\n            // r may be undefined, for example when downloading JavaScript\n            rq.push(r);\n        }\n        return r;\n    };\n\n    // 'kill' all pending xhrs\n    $(window).bind('beforeunload', function() {\n        $.each(rq, function(i, xhr) {\n            try {\n                xhr.abort();\n            } catch(e) {\n                $debug.fail('failed to abort xhr');\n            }\n        });\n        rq = [];\n    });\n})(jQuery);