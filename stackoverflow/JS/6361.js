function hideColumns(tableId, colIndexArray) {\n  var tbl = document.getElementById(tableId);\n  if(!tbl) return;\n\n  var rows = tbl.getElementsByTagName("TBODY");\n\n  if(rows.length == 0)\n    rows = tbl.getElementsByTagName("TR");\n  else\n    rows = rows[0].getElementsByTagName("TR");\n\n  var cols = rows[rows.length - 1].getElementsByTagName("TD");\n  var colgroup = document.createElement("COLGROUP");\n\n  for(var i = 0, l = cols.length; i < l; i++) {\n    var col = document.createElement("COL");\n\n    for(var num in colIndexArray) {\n      if(colIndexArray[num] == i) {\n        if(document.all)\n          col.style.display = 'none'\n        else\n          col.style.visibility = 'collapse';\n\n        break;\n      }\n    }\n\n    colgroup.appendChild(col);\n  }\n\n  tbl.insertBefore(colgroup, tbl.childNodes[0]);\n}