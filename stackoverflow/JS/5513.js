function refactor() {\n    var array = jQuery.makeArray($('ul#remapped > li:not(.target)'));\n    var mappedArray = jQuery.map(array, function(i) {\n        var merged = $(i).find('ul.merge > li:not(.target) > span');\n        return {\n            column: $(i).children('span').text(),\n            merged: jQuery.map(jQuery.makeArray(merged), function(mi) { return { column: mi.innerText }; })\n        };\n    });\n\n    var xml = '<columns>';\n    jQuery.each(mappedArray, function(index, item) {\n        xml += '\n\t<column>';\n        xml += '\n\t\t<name>' + item.column + '</name>';\n        if (item.merged.length > 0) {\n            xml += '\n\t\t\t<merged>';\n            jQuery.each(item.merged, function(mindex, mitem) {\n                xml += '\n\t\t\t\t<name>' + mitem.column + '</name>';\n            });\n            xml += '\n\t\t\t</merged>';\n        }\n        xml += '\n\t</column>';\n    });\n    xml += '\n</columns>';\n\n    $('div#result').load('/Tools/Csv/Refactor', { mapping: xml });\n}