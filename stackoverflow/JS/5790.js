function getXHR()\n{\n    var result = null\n    if (window.XMLHttpRequest)\n    {\n        result = new XMLHttpRequest();\n    }\n    else\n    {\n        try { result = new ActiveXObject("MSXML2.XMLHTTP.3.0") }\n        catch (e) { }\n\n        if (result == null)\n        {\n            try { result = new ActiveXObject("Microsoft.XMLHTTP") }\n            catch (e) { }\n        }\n    }\n    return result; \n}\n\n\nfunction ajaxRequest(url, data, callBack)\n{\n    var xmlHttpReq = getXHR();\n    if (xmlHttpReq)\n    {\n        xmlHttpReq.open(data != null ? 'GET' : 'POST', url, true);\n        xmlHttpReq.onreadystatechange = function()\n        {\n            if (xmlHttpReq.readyState == 4)\n            {\n                //what happens if status is not 200\n                callBack(xmlHttpReq.responseText);\n            }\n        };\n        xmlHttpReq.send(null);\n        return true;\n    }\n    else\n    {\n        return false;\n    }\n}\n\nfunction doAjax()\n{\n     var result = ajaxRequest('handler.php', null, handleAjaxResponse);\n     if (!result) alert("Your browser does not support AJAX. Please use an AJAX compatible browser.");\n     return result;\n}