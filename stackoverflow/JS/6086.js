(function($) {\n    $.fn.blowfish = function() {\n\n    // hide original ul dom tree\n    $(this).hide();\n\n    // create container from top-level li tags\n    var top = $(this).children('li');\n    var container = $('<div/>').addClass('bfcontainer').attr('id', 'cv' + Math.floor(Math.random()*10e10)).insertAfter(this);\n    var topdiv = $('<div class="top"></div>').appendTo(container);\n\n    // check if IE and set fixed width for first column\n    if($.browser.msie) {\n        $('.top').width('200px');\n    }\n\n    $.each(top, function(i, item) {\n        var topitem = $(':eq(0)', item).clone().data('sub', $(item).children('ul')).appendTo(topdiv);\n\n        if($(topitem).data('sub').length) {\n            $(topitem).addClass('hasChildMenu');\n\n            if($.browser.safari) {\n                $(topitem).css({'margin-right' : '15px'});\n            }\n        }\n    });\n\n    // event handlers\n    $('a', container).live('click', function() {\n        var container = $(this).parents('.bfcontainer');\n\n        // click handler\n        var level = $('div', container).index($(this).parents('div'));\n\n        // remove blocks to the right in the tree, and 'deactivate' other links within the same level\n        $('div:gt('+level+')', container).remove();\n        $('div:eq('+level+') a', container).removeClass('active').removeClass('inpath');\n        $('.active', container).addClass('inpath');\n        $(this).addClass('active');\n\n        if($(this).data('sub').children('li').length) {\n            // add submenu if container has children\n            submenu(container, this);\n\n            return false;\n        }\n        else {\n            // show title or link if container has no children\n            /*\nvar title = $('<a/>').attr({href : $(this).attr('href')}).text($(this).attr('title') ? $(this).attr('title') : $(this).text());\n            var featurebox = $('<div/>').html(title).addClass('feature').appendTo(container);\n\n            // set width\n            var remainingspace = 0;\n\n            $.each($(container).children('div').slice(0, -1), function(i, item) {\n                remainingspace += $(item).width();\n            });\n\n            var fillwidth = $(container).width() - remainingspace;\n\n            $(featurebox).css({'top': 0, 'left' : remainingspace}).width(fillwidth).show('slow');\n*/\n            /* window.location($(this).attr('href')); */\n        }\n    });\n};\n\n// create submenus\nfunction submenu(container, item) {\n    var leftPos = 0;\n\n    $.each($(container).children('div'), function(i, mydiv) {\n        leftPos += $(mydiv).width();\n    });\n\n    var submenu = $('<div/>').css({'top' : 0, 'left' : leftPos}).appendTo(container).fadeIn();\n\n    // check if IE and set fixed width for submenu column\n    if($.browser.msie) {\n        $(submenu).width('200px');\n    }\n\n    var subitems = $(item).data('sub').children('li');\n\n    $.each(subitems, function(i, subitem) {\n        var subsubitem = $(':eq(0)', subitem).clone().data('sub', $(subitem).children('ul')).appendTo(submenu);\n\n        if($(subsubitem).data('sub').length) {\n            $(subsubitem).addClass('hasChildMenu');\n\n            if($.browser.safari) {\n                $(subsubitem).css({'margin-right' : '15px' });\n            }\n        }\n    });\n}  \n})(jQuery);