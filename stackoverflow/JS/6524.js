function getSelection(inputBox) {\n        if ("selectionStart" in inputBox) {\n                return {\n                        start: inputBox.selectionStart,\n                        end: inputBox.selectionEnd\n                }\n        }\n\n        //and now, the blinkered IE way\n        var bookmark = document.selection.createRange().getBookmark()\n        var selection = inputBox.createTextRange()\n        selection.moveToBookmark(bookmark)\n\n        var before = inputBox.createTextRange()\n        before.collapse(true)\n        before.setEndPoint("EndToStart", selection)\n\n        var beforeLength = before.text.length\n        var selLength = selection.text.length\n\n        return {\n                start: beforeLength,\n                end: beforeLength + selLength\n        }\n}