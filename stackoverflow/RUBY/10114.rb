class Product < ActiveRecord::Base\n  #... other logic and stuff here...\n\n  validate :generated_permalink_is_not_reserved\n\n  def generated_permalink_is_not_reserved\n    create_unique_permalink # permalink_fu method to set up permalink\n    #TODO feels really ugly having controller/routing logic in the model. Maybe extract this out and inject it somehow so the model doesn't depend on routing\n    unless ActionController::Routing::Routes.recognize_path("/products/#{permalink}", :method => :get) == {:controller => 'products', :id => permalink, :action => 'show'}\n      errors.add(:name, "is reserved")\n    end\n  end\nend