def getGroupsOfDN(userDN)\n\n     groups = []\n     groupsExplored = []\n     groupsToExplore = []\n\n\n     current = userDN\n     groupsToExplore << userDN\n\n     while(!groupsToExplore.empty?)\n\n\n        ldapentry = ldap_lookup(current)\n\n        if (!ldapentry.nil?)\n           groups << current\n           current_groups = ldapentry.getAttributes("memberOf")\n           current_groups.each do |groupDN|\n              if(groupsExplored.indexOf(groupDN) != -1)\n                 groupsToExplore << groupDN\n                 groupsExplored << groupDN\n              end\n           end\n        end\n\n        groupsToExplore.remove(current)\n        if (!groupsToExplore.empty?)\n           current = groupsToExplore.get(0)            \n     end\n     return groups\nend