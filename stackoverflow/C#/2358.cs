public int GetWebSiteId(string serverName, string websiteName)\n{\n  int result = -1;\n\n  DirectoryEntry w3svc = new DirectoryEntry(\n                      string.Format("IIS://{0}/w3svc", serverName));\n\n  foreach (DirectoryEntry site in w3svc.Children)\n  {\n    if (site.Properties["ServerComment"] != null)\n    {\n      if (site.Properties["ServerComment"].Value != null)\n      {\n        if (string.Compare(site.Properties["ServerComment"].Value.ToString(), \n                             websiteName, false) == 0)\n        {\n            result = int.Parse(site.Name);\n            break;\n        }\n      }\n    }\n  }\n\n  return result;\n}