private static string GetContentTypeFromRegistry(string file)\n{\n    RegistryKey contentTypeKey = Registry.ClassesRoot.OpenSubKey(@"MIME\Database\Content Type");\n\n    foreach (string keyName in contentTypeKey.GetSubKeyNames())\n    {\n        if (System.IO.Path.GetExtension(file).ToLower().CompareTo((string)contentTypeKey.OpenSubKey(keyName).GetValue("Extension")) == 0)\n        {\n            return keyName;\n        }\n    }\n\n    return "unknown";\n}\n\nprivate static string GetFileExtensionFromRegistry(string contentType)\n{\n    RegistryKey contentTypeKey = Registry.ClassesRoot.OpenSubKey(@"MIME\Database\Content Type\" + contentType);\n\n    if (contentTypeKey != null)\n    {\n        string extension = (string)contentTypeKey.GetValue("Extension");\n\n        if (extension != null)\n        {\n            return extension;\n        }\n    }\n\n    return String.Empty;\n}