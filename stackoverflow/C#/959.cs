protected virtual void ExecuteScript(SqlConnection connection, string script)\n{\n    string[] commandTextArray = script.Split(new string[] { "GO" }, StringSplitOptions.RemoveEmptyEntries); // See EDIT below!\n    connection.Open();\n    foreach (string commandText in commandTextArray)\n    {\n        if (commandText.Trim() == string.Empty) continue;\n        SqlCommand command = new SqlCommand(commandText, connection);\n        command.ExecuteNonQuery();\n    }\n    connection.Close();\n}