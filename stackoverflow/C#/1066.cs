namespace MyApp.Custom.Security\n{\n    public class Secure : AuthorizeAttribute\n    {\n        /// <summary>\n        /// Checks to see if the user is authenticated and has a valid session object\n        /// </summary>        \n        /// <param name="httpContext"></param>\n        /// <returns></returns>\n        protected override bool AuthorizeCore(HttpContextBase httpContext)\n        {\n            if (httpContext == null) throw new ArgumentNullException("httpContext");\n\n            // Make sure the user is authenticated.\n            if (httpContext.User.Identity.IsAuthenticated == false) return false;\n\n            // This will check my session variable and a few other things.\n            return Helpers.SecurityHelper.IsSignedIn();\n        }\n    }\n}