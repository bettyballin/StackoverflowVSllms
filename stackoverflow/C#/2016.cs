Microsoft.Practices.EnterpriseLibrary.Data.Database db = Microsoft.Practices.EnterpriseLibrary.Data.DatabaseFactory.CreateDatabase("ConnectionString");\n System.Data.Common.DbCommand cmd = db.GetStoredProcCommand("StoredProcedureName");\n cmd.CommandTimeout = 600;\n db.AddInParameter(cmd, "ParameterName", DbType.String, "Value");\n\n // Added to handle paramValues array conversion\n foreach (System.Data.SqlClient.SqlParameter param in parameterValues) \n {\n     db.AddInParameter(cmd, param.ParameterName, param.SqlDbType, param.Value);\n }\n\n return cmd.ExecuteScalar();