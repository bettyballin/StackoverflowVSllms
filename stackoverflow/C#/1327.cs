Process[] processlist = Process.GetProcesses();\n            bool rdpclipFound = false;\n\n            foreach (Process theprocess in processlist)\n            {\n                String ProcessUserSID = GetProcessInfoByPID(theprocess.Id);\n                String CurrentUser = WindowsIdentity.GetCurrent().Name.Replace("SERVERNAME\\",""); \n\n                if (theprocess.ProcessName == "rdpclip" && ProcessUserSID == CurrentUser)\n                {\n                    theprocess.Kill();\n                    rdpclipFound = true;\n                }\n\n            }\n            Process.Start("rdpclip");\n            if (rdpclipFound)\n            {\n               MessageBox.Show("rdpclip.exe successfully restarted"); }\n            else\n            {\n               MessageBox.Show("rdpclip was not running under your username.  It has been started, please try copying and pasting again.");\n            }\n\n            }