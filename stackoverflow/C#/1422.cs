public static class Extensions\n{\n    public static string ToCSV(this DataTable table)\n    {\n        var result = new StringBuilder();\n        for (int i = 0; i < table.Columns.Count; i++)\n        {\n            result.Append(table.Columns[i].ColumnName);\n            result.Append(i == table.Columns.Count - 1 ? "\n" : ",");\n        }\n\n        foreach (DataRow row in table.Rows)\n        {\n            for (int i = 0; i < table.Columns.Count; i++)\n            {\n                result.Append(row[i].ToString());\n                result.Append(i == table.Columns.Count - 1 ? "\n" : ",");\n            }\n        }\n\n        return result.ToString();\n    }\n}