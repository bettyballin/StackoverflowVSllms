using System;\nusing System.Drawing;\nusing System.Windows.Forms;\nusing System.Runtime.InteropServices;\n\nnamespace WindowsFormsApplication1 {\n  public partial class Form1 : Form {\n    int oldcolor;\n    public Form1() {\n      InitializeComponent();\n      oldcolor = GetSysColor(COLOR_WINDOW);\n      this.FormClosed += new FormClosedEventHandler(Form1_FormClosed);\n      this.button1.Click += new EventHandler(button1_Click);\n    }\n\n    private void Form1_FormClosed(object sender, FormClosedEventArgs e) {\n      int element = COLOR_WINDOW;\n      SetSysColors(1, ref element, ref oldcolor);\n    }\n\n    private int Color2COLORREF(Color color) {\n      return color.R | (color.G << 8) | (color.B << 0x10);\n    }\n\n    private void button1_Click(object sender, EventArgs e) {\n      int element = COLOR_WINDOW;\n      int colorref = Color2COLORREF(Color.NavajoWhite);\n      SetSysColors(1, ref element, ref colorref);\n    }\n\n    private const int COLOR_WINDOW = 5;\n    [DllImport("user32.dll")]\n    private static extern bool SetSysColors(int one, ref int element, ref int color);\n    [DllImport("user32.dll")]\n    private static extern int GetSysColor(int element);\n\n  }\n}