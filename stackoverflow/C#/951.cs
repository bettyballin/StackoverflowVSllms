Type excel9Type = Type.GetTypeFromProgID("Excel.Application.9");\nType excelType = Type.GetTypeFromProgID("Excel.Application");\n\nif (excelType == excel9Type)\n{\n    Console.WriteLine("Default Excel.Application is pointing to 'Verion 9' yay");\n}\nelse\n{\n    Console.WriteLine("Excel is installed, but it's not 'Version 9'");\n}\n\nif (excel9Type == null)\n{\n    throw new InvalidOperationException("Excel.Application.9 is not a registered progid");\n}\n\nobject excelApplication = Activator.CreateInstance(excel9Type);\n\n// Cast excelApplication to whatever you are using as your application type. 