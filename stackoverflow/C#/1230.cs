//select users\nDictionary<int, User> users = new Dictionary<int, User>();\nforeach (User user in selectUsersFromDatabase())\n{\n  users.Add(user.Id, user);\n}\n//select groups\nDictionary<int, Group> groups = new Dictionary<int, Group>();\nforeach (Group group in selectGroupsFromDatabase())\n{\n  groups.Add(group.Id, group);\n}\n//select relations\n//and join groups to users\n//and join users to groups\nforeach (Relation relation in selectRelationsFromDatabase())\n{\n  //find user in dictionary\n  User user = users[relation.userId];\n  //find group in dictionary\n  Group group = groups[relation.groupId];\n  //add group to user and add user to group\n  user.BelongsTo.Add(group);\n  group.Users.Add(user);\n}