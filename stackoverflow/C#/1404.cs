public double IPAddressToNumber(string IPaddress)\n    {\n        int i;\n        string [] arrDec;\n        double num = 0;\n        if (IPaddress == "")\n        {\n            return 0;\n        }\n        else\n        {\n            arrDec = IPaddress.Split('.');\n            for(i = arrDec.Length - 1; i >= 0 ; i = i -1)\n                {\n                    num += ((int.Parse(arrDec[i])%256) * Math.Pow(256 ,(3 - i )));\n                }\n            return num;\n        }\n    }