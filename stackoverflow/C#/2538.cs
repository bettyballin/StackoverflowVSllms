XDocument writeContacts = new XDocument(\n   new XElement("contacts",\n      new XElement("contact",\n         new XElement("name", "Patrick Hines"),\n         new XElement("phone", "206-555-0144",\n             new XAttribute("type", "home")),\n         new XElement("phone", "425-555-0145",\n             new XAttribute("type", "work")),\n         new XElement("address",\n            new XElement("street1", "123 Main St"),\n            new XElement("city", "Mercer Island"),\n            new XElement("state", "WA"),\n            new XElement("postal", "68042")\n         )\n      )\n   )\n);\n\nRijndael RijndaelAlg = Rijndael.Create();\n\nFileStream writeStream = File.Open("data.xml", FileMode.Create);\nCryptoStream cStream = new CryptoStream(writeStream,\n    RijndaelAlg.CreateEncryptor(RijndaelAlg.Key, RijndaelAlg.IV),\n    CryptoStreamMode.Write);\n\nStreamWriter writer = new StreamWriter(cStream);\n\nwriteContacts.Save(writer);\n\nwriter.Flush();\nwriter.Close();\n\nFileStream readStream = File.OpenRead("data.xml");\n\ncStream = new CryptoStream(readStream,\n  RijndaelAlg.CreateDecryptor(RijndaelAlg.Key, RijndaelAlg.IV),\n  CryptoStreamMode.Read);\n\nXmlTextReader reader = new XmlTextReader(cStream);\n\nXDocument readContacts = XDocument.Load(reader);\n\n//manipulate with Linq and Save() when needed