using Microsoft.Win32;\n\npublic class FileAssoc\n{\n    public string Extension;\n    public string Filetype;\n\n    public FileAssoc(string fileext, string name)\n    {\n        Extension = fileext;\n        Filetype = name;\n    }\n}\n\npublic static class EnumRegFiles\n{\n    public static List<FileAssoc> GetFileAssociations()\n    {\n        List<FileAssoc> result = new List<FileAssoc>();\n        RegistryKey rk = Registry.ClassesRoot;\n\n        String[] names = rk.GetSubKeyNames();\n        foreach (string file in names)\n        {\n            if (file.StartsWith("."))\n            {\n                RegistryKey rkey = rk.OpenSubKey(file);\n                object descKey = rkey.GetValue("");\n\n                if (descKey != null)\n                {\n                    string desc = descKey.ToString();\n                    if (!string.IsNullOrEmpty(desc))\n                    {\n                        result.Add(new FileAssoc(file, desc));\n                    }\n                }\n            }\n        }\n\n        return result;\n    }\n}