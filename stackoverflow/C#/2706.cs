// Gets the application pool collection from the server.\n[ModuleServiceMethod(PassThrough = true)]\npublic ArrayList GetApplicationPoolCollection()\n{\n    // Use an ArrayList to transfer objects to the client.\n    ArrayList arrayOfApplicationBags = new ArrayList();\n\n    ServerManager serverManager = new ServerManager();\n    ApplicationPoolCollection applicationPoolCollection = serverManager.ApplicationPools;\n    foreach (ApplicationPool applicationPool in applicationPoolCollection)\n    {\n        PropertyBag applicationPoolBag = new PropertyBag();\n        applicationPoolBag[ServerManagerDemoGlobals.ApplicationPoolArray] = applicationPool;\n        arrayOfApplicationBags.Add(applicationPoolBag);\n        // If the applicationPool is stopped, restart it.\n        if (applicationPool.State == ObjectState.Stopped)\n        {\n            applicationPool.Start();\n        }\n\n    }\n\n    // CommitChanges to persist the changes to the ApplicationHost.config.\n    serverManager.CommitChanges();\n    return arrayOfApplicationBags;\n}