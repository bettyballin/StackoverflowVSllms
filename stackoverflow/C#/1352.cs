StringBuilder query = new StringBuilder();\n\nusing (XmlWriter xmlWriter = XmlWriter.Create(query))\n{\n    xmlWriter.WriteStartElement("rows");\n    xmlWriter.WriteElementString("page", "1");\n\n    foreach(...)\n    {\n\n        xmlWriter.WriteStartElement("rows");\n        xmlWriter.WriteAttributeString("row", "1");\n\n        foreach(...)\n        {\n            xmlWriter.WriteElementString("cell", "Row 1, Column 1");\n        }\n\n        xmlWriter.WriteEndElement();            \n    }\n\n    xmlWriter.WriteEndElement();\n}