List<Int32> numbering = new List<Int32>();\n\nInt32 lastNestingLevel = -1;\n\nforeach (String line in lines)\n{\n    String[] parts = line.Split(new Char[] { ' ' }, 2);\n\n    Int32 currentNestingLevel = parts[0].Count(c => c == '.');\n\n    if (currentNestingLevel > lastNestingLevel)\n    {\n        // Start a new nesting level with number one.\n        numbering.Add(1);\n    }\n    else if (currentNestingLevel == lastNestingLevel)\n    {\n         // Increment the number of the current nesting level.\n        numbering[currentNestingLevel] += 1;        }\n    else if (currentNestingLevel < lastNestingLevel)\n    {\n         // Remove the deepest nesting level...\n        numbering.RemoveAt(numbering.Count - 1);\n         // ...and increment the numbering of the current nesting level.\n        numbering[currentNestingLevel] += 1;\n    }\n\n    lastNestingLevel = currentNestingLevel;\n\n    String newNumbering = String.Join(".", numbering\n        .Select(n => n.ToString())\n        .ToArray());\n\n    Console.WriteLine(newNumbering + " " + parts[1]);\n}