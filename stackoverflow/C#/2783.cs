public class CrcB\n{\n    const ushort __crcBDefault = 0xffff;\n\n    private static ushort UpdateCrc(byte b, ushort crc)\n    {\n            unchecked\n            {\n                byte ch = (byte)(b^(byte)(crc & 0x00ff));\n                ch = (byte)(ch ^ (ch << 4));\n                return (ushort)((crc >> 8)^(ch << 8)^(ch << 3)^(ch >> 4));\n            }\n    }\n\n    public static ushort ComputeCrc(byte[] bytes)\n    {\n            var res = __crcBDefault;\n            foreach (var b in bytes)\n                    res = UpdateCrc(b, res);\n            return (ushort)~res;\n    }\n}