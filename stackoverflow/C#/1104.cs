\nprivate void ExportCanvas(int width, int height)\n{\n    string path = @"c:\temp\Test.tif";\n    FileStream fs = new FileStream(path, FileMode.Create);\n\n\n    RenderTargetBitmap renderBitmap = new RenderTargetBitmap(width,\n                                                             height, 1/300, 1/300, PixelFormats.Pbgra32);\n\n    DrawingVisual visual = new DrawingVisual();\n    using (DrawingContext context = visual.RenderOpen())\n    {\n        VisualBrush brush = new VisualBrush(MyCanvas);\n        context.DrawRectangle(brush,\n                              null,\n                              new Rect(new Point(), new Size(MyCanvas.Width, MyCanvas.Height)));\n    }\n\n    visual.Transform = new ScaleTransform(width / MyCanvas.ActualWidth, height / MyCanvas.ActualHeight);\n\n    renderBitmap.Render(visual);\n\n    BitmapEncoder encoder = new TiffBitmapEncoder();\n    encoder.Frames.Add(BitmapFrame.Create(renderBitmap));\n    encoder.Save(fs);\n    fs.Close();\n}