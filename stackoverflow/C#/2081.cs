private int CountWorkDays( DateTime startDate, DateTime endDate, List<DateTime> excludedDates )\n{\n    int dayCount = 0;\n    int inc = 1;\n    bool endDateIsInPast = startDate > endDate;\n    DateTime tmpDate = startDate;\n    DateTime finiDate = endDate;\n\n    if( endDateIsInPast )\n    {\n        // Swap dates around\n        tmpDate = endDate;\n        finiDate = startDate;\n\n        // Set increment value to -1, so it DayCount decrements rather \n        // than increments\n        inc = -1;\n    }\n\n    while( tmpDate <= finiDate )\n    {\n        if( !excludedDates.Contains( tmpDate ) )\n        {\n            dayCount += inc;\n        }\n\n        // Move onto next day\n        tmpDate = tmpDate.AddDays( 1 );\n    }\n\n    return dayCount;\n}