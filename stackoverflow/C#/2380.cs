using System;\n    using System.IO;\n    using System.Data.SqlClient;\n    using System.Collections.Generic;\n\n    //Microsoft.SqlServer.Smo.dll\n    using Microsoft.SqlServer.Management.Smo;\n    //Microsoft.SqlServer.ConnectionInfo.dll\n    using Microsoft.SqlServer.Management.Common;\n\n    public class RunAllSqlSriptsInDirectory\n    {\n        public static void Main()\n        {\n            string scriptDirectory = "c:\\temp\\sqltest\\";\n            string sqlConnectionString = "Integrated Security=SSPI;" + \n                "Persist Security Info=True;Initial Catalog=Northwind;Data Source=(local)";\n            DirectoryInfo di = new DirectoryInfo(scriptDirectory);\n            FileInfo[] rgFiles = di.GetFiles("*.sql");\n            foreach (FileInfo fi in rgFiles)\n            {\n                FileInfo fileInfo = new FileInfo(fi.FullName);\n                string script = fileInfo.OpenText().ReadToEnd();\n                SqlConnection connection = new SqlConnection(sqlConnectionString);\n                Server server = new Server(new ServerConnection(connection));\n                server.ConnectionContext.ExecuteNonQuery(script);\n            }\n        }\n    }