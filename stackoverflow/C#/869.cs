public class serviceUtils\n{\n    unsafe public long stringToCoTaskPtr( ref str thestring )\n    {\n        return (long)Marshal.StringToCoTaskMemAnsi(thestring.theString).ToPointer();//TODO : what errors occur from here? handle them\n    }\n\n    unsafe public long bytesToCoTaskPtr( ref bytes thebytes, ref short byteCnt)\n    {\n        byteCnt = (short)thebytes.theArray.Length;\n        IntPtr tmpptr = new IntPtr();\n        tmpptr = Marshal.AllocCoTaskMem(byteCnt);\n        Marshal.Copy(thebytes.theArray, 0, tmpptr, byteCnt);\n        return (long)tmpptr.ToPointer();\n    }\n\n    public void freeCoTaskMemPtr(long ptr)\n    {\n        Marshal.FreeCoTaskMem(new IntPtr(ptr));//TODO : errors from here?\n    }\n\n    public string coTaskPtrToString(long theptr)\n    {\n        return Marshal.PtrToStringAnsi(new IntPtr(theptr));\n    }\n\n    public byte[] coTaskPtrToBytes(long theptr, short thelen)\n    {\n        byte[] tmpbytes = new byte[thelen];\n        Marshal.Copy(new IntPtr(theptr), tmpbytes, 0, thelen);\n        return tmpbytes;\n    }\n}