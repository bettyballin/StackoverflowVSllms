public class Table\n{\n   public Table(IMapInfo map)\n   {\n      _map = map;\n   }\n\n   public string Name\n   {\n      get \n      {\n        string value = _map.Eval("myexpression");\n        if (String.IsNullOrEmpty(value))\n        {\n            value = "none";\n        }\n        return value;\n      }\n   }\n\n   private IMapInfo _map;\n}\n\n[TestFixture]\npublic class TableFixture // is this a pun?\n{\n   [Test]\n   public void CanHandleNullsFromCOM()\n   {\n       MockRepository mocks = new MockRepository(); // rhino mocks, btw\n       IMapInfo map = mocks.CreateMock<IMapInfo>();\n\n       using (mocks.Record())\n       {\n          Expect.Call(map.Eval("myexpression").Return(null);\n       }\n\n       using (mocks.PlayBack())\n       {\n          Table table = new Table(map);\n          Assert.AreEqual("none", table.Name, "We didn't handle nulls correctly.");\n       }\n\n       mocks.verify();\n   }\n}