private static Random rnd = new Random();\n\nprivate static DirectoryEntry GetRandomUser()\n{\n    DirectoryEntry luckyGuy;\n    var de = new DirectoryEntry(/*conn string*/);\n    de.Username = /* your user */;\n    de.Password = /* your pass */;\n    \n    // error handling and try-catch removed for clarity and brevity\n    var s = new DirectorySearcher( de );\n    s.Filter = "(objectClass=user)";\n    var res = s.FindAll();\n    \n    if( res.Count > 0 )\n    {\n      var idex = rnd.Next(0, res.Count);\n      luckyGuy = res[idex].GetDirectoryEntry();\n    }\n    \n    return luckyGuy;\n}