proc.StartInfo.FileName                 = target;\nproc.StartInfo.RedirectStandardError    = true;\nproc.StartInfo.RedirectStandardOutput   = true;\nproc.StartInfo.UseShellExecute          = false;\n\nproc.Start();\n\nproc.WaitForExit\n    (\n        (timeout <= 0)\n            ? int.MaxValue : timeout * NO_MILLISECONDS_IN_A_SECOND *\n                NO_SECONDS_IN_A_MINUTE\n    );\n\nerrorMessage = proc.StandardError.ReadToEnd();\nproc.WaitForExit();\n\noutputMessage = proc.StandardOutput.ReadToEnd();\nproc.WaitForExit();