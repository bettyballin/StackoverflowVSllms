public static bool IsRegistered(string name, string dllPath)\n{\n    RegistryKey typeLibKey = Registry.ClassesRoot.OpenSubKey("TypeLib");\n    foreach (string libIdKeyName in typeLibKey.GetSubKeyNames())\n    {\n        RegistryKey libIdKey = typeLibKey.OpenSubKey(libIdKeyName);\n        foreach (string versionKeyName in libIdKey.GetSubKeyNames())\n        {\n            RegistryKey versionKey = libIdKey.OpenSubKey(versionKeyName);\n            string regName = (string)versionKey.GetValue("");\n            if (regName == name)\n            {\n                foreach (string itterKeyName in versionKey.GetSubKeyNames())\n                {\n                    int throwawayint;\n                    if (int.TryParse(itterKeyName, out throwawayint))\n                    {\n                        RegistryKey itterKey = versionKey.OpenSubKey(itterKeyName);\n                        string regDllPath = (string)itterKey.OpenSubKey("win32").GetValue("");\n                        if (regDllPath == dllPath)\n                        {\n                            return true;\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    return false;\n}