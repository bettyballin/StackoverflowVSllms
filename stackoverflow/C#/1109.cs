using System.DirectoryServices; \n\npublic class test\n{\n\n    private void main()\n    {\n        foreach (string @group in GetGroups())\n        {\n            Debug.Print(@group);\n        }\n    }\n\n    public List<string> GetGroups()\n    {\n        DirectoryEntry objADAM = default(DirectoryEntry);\n        // Binding object. \n        DirectoryEntry objGroupEntry = default(DirectoryEntry);\n        // Group Results. \n        DirectorySearcher objSearchADAM = default(DirectorySearcher);\n        // Search object. \n        SearchResultCollection objSearchResults = default(SearchResultCollection);\n        // Results collection. \n        string strPath = null;\n        // Binding path. \n        List<string> result = new List<string>();\n\n        // Construct the binding string. \n        strPath = "LDAP://stefanserver.stefannet.local";\n        //Change to your ADserver \n\n        // Get the AD LDS object. \n        try\n        {\n            objADAM = new DirectoryEntry(strPath);\n            objADAM.RefreshCache();\n        }\n        catch (Exception e)\n        {\n            throw e;\n        }\n\n        // Get search object, specify filter and scope, \n        // perform search. \n        try\n        {\n            objSearchADAM = new DirectorySearcher(objADAM);\n            objSearchADAM.Filter = "(&(objectClass=group))";\n            objSearchADAM.SearchScope = SearchScope.Subtree;\n            objSearchResults = objSearchADAM.FindAll();\n        }\n        catch (Exception e)\n        {\n            throw e;\n        }\n\n        // Enumerate groups \n        try\n        {\n            if (objSearchResults.Count != 0)\n            {\n                foreach (SearchResult objResult in objSearchResults)\n                {\n                    objGroupEntry = objResult.GetDirectoryEntry();\n                    result.Add(objGroupEntry.Name);\n                }\n            }\n            else\n            {\n                throw new Exception("No groups found");\n            }\n        }\n        catch (Exception e)\n        {\n            throw new Exception(e.Message);\n        }\n\n        return result;\n    }\n\n}