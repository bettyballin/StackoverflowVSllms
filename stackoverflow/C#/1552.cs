//Namespace References\nusing System.Data;\nusing System.Data.SqlClient\n\n/// <summary>\n/// Returns a DataTable, based on the command passed\n/// </summary>\n/// <param name="cmd">\n/// the SqlCommand object we wish to execute\n/// </param>\n/// <returns>\n/// a DataTable populated with the data\n/// specified in the SqlCommand object\n/// </returns>\n/// <remarks></remarks>\n\npublic static DataTable GetDataTable(SqlCommand cmd)\n{\n    try\n    {\n        // create a new data adapter based on the specified query.\n        SqlDataAdapter da = new SqlDataAdapter();\n\n        //set the SelectCommand of the adapter\n        da.SelectCommand = cmd;\n\n        // create a new DataTable\n        DataTable dtGet = new DataTable();\n\n        //fill the DataTable\n        da.Fill(dtGet);\n\n        //return the DataTable\n        return dtGet;\n      }\n      catch (SqlException ex)\n      {\n          MessageBox.Show(ex.Message);\n      }\n      catch (Exception ex)\n      {\n          MessageBox.Show(ex.Message);\n      }\n  } 