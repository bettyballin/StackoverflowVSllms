using System;\nusing System.DirectoryServices;\nnamespace ConsoleApplication1\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            string path = @"IIS://Localhost/W3SVC/1/root/MyApp";\n            Console.WriteLine(GetAspNetVersion(path));\n        }\n\n        private static string GetAspNetVersion(string path)\n        {\n            using (DirectoryEntry app = new DirectoryEntry(path))\n            {\n                PropertyValueCollection pvc = app.Properties["ScriptMaps"];\n\n                foreach (string scriptMap in pvc)\n                {\n                    if (scriptMap.StartsWith(".aspx"))\n                    {\n                        string[] mapping = scriptMap.Split(',');\n                        string scriptProcessor = mapping[1];\n\n                        // The version numbers come from the path\n                        // C:\Windows\Microsoft.NET\Framework\\n                        // which will be present in the script processor \n                        // DLL path\n                        if (scriptProcessor.Contains("v1.1.4322"))\n                        {\n                            return "1.1";\n                        }\n\n                        if (scriptProcessor.Contains("v2.0.50727"))\n                        {\n                            return "2.0";\n                        }\n                    }\n                }\n                throw new Exception("Unknown version ASP.NET version.");\n            }\n        }\n    }\n}