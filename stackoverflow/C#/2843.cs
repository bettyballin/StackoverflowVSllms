private string DoItalicsAndBold (string text)\n{\n    // <strong> must go first:\n    text = Regex.Replace (text, @"(\*\*|__) (?=\S) (.+?[*_]*) (?<=\S) \1", \n                          new MatchEvaluator (BoldEvaluator),\n                          RegexOptions.IgnorePatternWhitespace | RegexOptions.Singleline);\n\n    // Then <em>:\n    text = Regex.Replace (text, @"(\*|_) (?=\S) (.+?) (?<=\S) \1",\n                          new MatchEvaluator (ItalicsEvaluator),\n                          RegexOptions.IgnorePatternWhitespace | RegexOptions.Singleline);\n    return text;\n}\n\nprivate string ItalicsEvaluator (Match match)\n{\n    return string.Format ("<em>{0}</em>", match.Groups[2].Value);\n}\n\nprivate string BoldEvaluator (Match match)\n{\n    return string.Format ("<strong>{0}</strong>", match.Groups[2].Value);\n}