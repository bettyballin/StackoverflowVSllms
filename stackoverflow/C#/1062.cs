// the data\n        var outer = new[] {\n            new[] {\n                new {ID=1,Amount=4}, // [0] [Child_0] [ID: 1, Amount: 4]\n                new {ID=2,Amount=7}  // [0] [Child_1] [ID: 2, Amount: 7]\n            },\n            new[] {\n                new {ID=1, Amount=2}, // [1] [Child_0] [ID: 1, Amount: 2]\n                new {ID=2, Amount=4}  // [1] [Child_1] [ID: 2, Amount: 4]\n            },\n            new[] {\n                new {ID=1, Amount=5}, // [2] [Child_0] [ID: 1, Amount: 5]\n                new {ID=2, Amount=3}  // [2] [Child_1] [ID: 2, Amount: 3]\n            }\n        };\n        var qry = from x in outer\n                  from y in x\n                  group y by y.ID into grp\n                  select new { Id = grp.Key, Avg = grp.Average(z => z.Amount) };\n\n        foreach (var item in qry)\n        {\n            Console.WriteLine("{0}: {1}", item.Id, item.Avg);\n        }