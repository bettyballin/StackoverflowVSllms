WqlEventQuery wQuery = \n new WqlEventQuery("Select * From __InstanceDeletionEvent Within 1 Where TargetInstance ISA 'Win32_Process'");\n\nusing (ManagementEventWatcher wWatcher = new ManagementEventWatcher(scope, wQuery))\n{    \n  bool stopped = false;\n\n  while (stopped == false)\n  {\n    using (ManagementBaseObject MBOobj = wWatcher.WaitForNextEvent())\n    {\n      if (((ManagementBaseObject)MBOobj["TargetInstance"])["ProcessID"].ToString() == ProcID)\n      {\n        // the process has stopped\n        stopped = true;\n      }\n    }\n  }\n\n  wWatcher.Stop();\n}