Point start = Point.Empty;\n    Point end = Point.Empty;\n    \n    int bitmapWidth = bmp.Width;\n    int bitmapHeight = bmp.Height;\n    \n    #region find start and end point\n    BitmapData data = bmp.LockBits(new Rectangle(0, 0, bitmapWidth, bitmapHeight), ImageLockMode.ReadOnly, PixelFormat.Format32bppArgb);\n    try\n    {\n        unsafe\n        {\n            byte* pData0 = (byte*)data.Scan0;\n            for (int y = 0; y < bitmapHeight; y++)\n            {\n                for (int x = 0; x < bitmapWidth; x++)\n                {\n                    byte* pData = pData0 + (y * data.Stride) + (x * 4);\n    \n                    byte xyBlue = pData[0];\n                    byte xyGreen = pData[1];\n                    byte xyRed = pData[2];\n                    byte xyAlpha = pData[3];\n    \n    \n                    if (color.A != xyAlpha\n                            || color.B != xyBlue\n                            || color.R != xyRed\n                            || color.G != xyGreen)\n                    {\n                        //ignore transparent pixels\n                        if (xyAlpha == 0)\n                            continue;\n                        if (start.IsEmpty)\n                        {\n                            start = new Point(x, y);\n                        }\n                        else if (start.Y > y)\n                        {\n                            start.Y = y;\n                        }\n                        if (end.IsEmpty)\n                        {\n                            end = new Point(x, y);\n                        }\n                        else if (end.X < x)\n                        {\n                            end.X = x;\n                        }\n                        else if (end.Y < y)\n                        {\n                            end.Y = y;\n                        }\n                    }\n                }\n            }\n        }\n    }\n    finally\n    {\n        bmp.UnlockBits(data);\n    }\n    #endregio