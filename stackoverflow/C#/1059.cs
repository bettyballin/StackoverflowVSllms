using (new Impersonator("username", "", "password"))\n{\n    try\n    {\n        X509Store serviceRuntimeUserCertificateStore = new X509Store(StoreName.My);\n        string baseDir = AppDomain.CurrentDomain.BaseDirectory;\n        string certPath = Path.Combine(baseDir, certificateFolder);\n\n        string certificateFile = "c:\\file.cert";\n        string certificatePassword = "somePassword";\n        string certificateLocation = certPath + "\\" + certificateFile;\n\n        InstallCertificate(certificateLocation, certificatePassword);\n    }\n    catch (Exception ex)\n    {\n        Console.WriteLine(ex);\n    }\n}\n\nprivate static void InstallCertificate(string certificatePath, string certificatePassword)\n{\n    try\n    {\n        var serviceRuntimeUserCertificateStore = new X509Store(StoreName.My);\n        serviceRuntimeUserCertificateStore.Open(OpenFlags.ReadWrite);\n\n        X509Certificate2 cert;\n\n        try\n        {\n            cert = new X509Certificate2(certificatePath, certificatePassword);\n        }\n        catch(Exception ex)\n        {\n            Console.WriteLine("Failed to load certificate " + certificatePath);\n            throw new DataException("Certificate appeared to load successfully but also seems to be null.", ex);\n        }\n\n        serviceRuntimeUserCertificateStore.Add(cert);\n        serviceRuntimeUserCertificateStore.Close();\n    }\n    catch(Exception)\n    {\n        Console.WriteLine("Failed to install {0}.  Check the certificate index entry and verify the certificate file exists.", certificatePath);\n    }\n}