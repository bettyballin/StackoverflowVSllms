static List<Process> GetChildProcesses(int parentId) {\n  var query = "Select * From Win32_Process Where ParentProcessId = "\n          + parentId;\n  ManagementObjectSearcher searcher = new ManagementObjectSearcher(query);\n  ManagementObjectCollection processList = searcher.Get();\n\n  var result = processList.Cast<ManagementObject>().Select(p =>\n    Process.GetProcessById(Convert.ToInt32(p.GetPropertyValue("ProcessId")));\n  ).ToList();\n\n  return result;\n}