IPAddress[] host;\n    IPAddress[] local;\n    bool isLocal = false;\n\n    host = Dns.GetHostAddresses(uri.Host);\n    local = Dns.GetHostAddresses(Dns.GetHostName());\n\n    foreach (IPAddress hostAddress in host)\n    {\n        if (IPAddress.IsLoopback(hostAddress))\n        {\n            isLocal = true;\n            break;\n        }\n        else\n        {\n            foreach (IPAddress localAddress in local)\n            {\n                if (hostAddress.Equals(localAddress))\n                {\n                    isLocal = true;\n                    break;\n                }\n            }\n\n            if (isLocal)\n            {\n                break;\n            }\n        }\n    }