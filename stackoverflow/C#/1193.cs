protected string GetCommandLogString(IDbCommand command)\n{\n    string outputText;\n\n    if (command.Parameters.Count == 0)\n    {\n        outputText = command.CommandText;\n    }\n    else\n    {\n        StringBuilder output = new StringBuilder();\n        output.Append(command.CommandText);\n        output.Append("; ");\n\n        IDataParameter p;\n        int count = command.Parameters.Count;\n        for (int i = 0; i < count; i++)\n        {\n            p = (IDataParameter) command.Parameters[i];\n            output.Append(string.Format("{0} = '{1}'", p.ParameterName, p.Value));\n\n            if (i + 1 < count)\n            {\n                output.Append(", ");\n            }\n        }\n        outputText = output.ToString();\n    }\n    return outputText;\n}