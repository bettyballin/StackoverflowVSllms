List<FieldInfo> dependencyPropertyFields = elementType.GetFields(\n    BindingFlags.Static | BindingFlags.Public | BindingFlags.DeclaredOnly).ToList();\n\n// Iterate through the fields defined on any base types as well\nType baseType = elementType.BaseType;\nwhile (baseType != null)\n{\n    dependencyPropertyFields.AddRange(\n        baseType.GetFields(\n            BindingFlags.Static | BindingFlags.Public | BindingFlags.DeclaredOnly));\n\n    baseType = baseType.BaseType;\n}