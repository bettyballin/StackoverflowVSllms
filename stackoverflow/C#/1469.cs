using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Text;\nusing System.Windows.Forms;\nusing System.Threading;\n\n//...\n\nvoid SetField(WebBrowser wb, string formname, string fieldname, string fieldvalue) {\n  HtmlElement f = wb.Document.Forms[formname].All[fieldname];\n  f.SetAttribute("value", fieldvalue);\n}\n\nvoid SetRadio(WebBrowser wb, string formname, string fieldname, bool isChecked) {\n  HtmlElement f = wb.Document.Forms[formname].All[fieldname];\n  f.SetAttribute("checked", isChecked ? "True" : "False");\n}\n\nvoid SubmitForm(WebBrowser wb, string formname) {\n  HtmlElement f = wb.Document.Forms[formname];\n  f.InvokeMember("submit");\n}\n\nvoid ClickButtonAndWait(WebBrowser wb, string buttonname,int timeOut) {\n  HtmlElement f = wb.Document.All[buttonname];\n  webReady = false;\n  f.InvokeMember("click");\n  DateTime endTime = DateTime.Now.AddSeconds(timeOut);\n  bool finished = false;\n  while (!finished) {\n    if (webReady)\n      finished = true;\n    Application.DoEvents();\n    if (aborted)\n      throw new EUserAborted();\n    Thread.Sleep(50);\n    if ((timeOut != 0) && (DateTime.Now>endTime)) {\n      finished = true;\n    }\n  }\n}\n\nvoid ClickButtonAndWait(WebBrowser wb, string buttonname) {\n  ClickButtonAndWait(wb, buttonname, 0);\n}\n\nvoid Navigate(string url,int timeOut) {\n  webReady = false;\n  webBrowser1.Navigate(url);\n  DateTime endTime = DateTime.Now.AddSeconds(timeOut);\n  bool finished = false;\n  while (!finished) {\n    if (webReady)\n      finished = true;\n    Application.DoEvents();\n    if (aborted)\n      throw new EUserAborted();\n    Thread.Sleep(50);\n    if ((timeOut != 0) && (DateTime.Now > endTime)) {\n      finished = true;\n    }\n  }\n}\n\nprivate void webBrowser1_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e) {\n  webReady = true;\n}