void RunWithRedirect(string cmdPath)\n{\n    var proc = new Process();\n    proc.StartInfo.FileName = cmdPath;\n\n    // set up output redirection\n    proc.StartInfo.RedirectStandardOutput = true;\n    proc.StartInfo.RedirectStandardError = true;    \n    proc.EnableRaisingEvents = true;\n    proc.StartInfo.CreateNoWindow = true;\n    // see below for output handler\n    proc.ErrorDataReceived += proc_DataReceived;\n    proc.OutputDataReceived += proc_DataReceived;\n\n    proc.Start();\n\n    proc.BeginErrorReadLine();\n    proc.BeginOutputReadLine();\n\n    proc.WaitForExit();\n}\n\nvoid proc_DataReceived(object sender, DataReceivedEventArgs e)\n{\n    // output will be in string e.Data\n}