static public byte[] RSAEncrypt(byte[] data,\n    RSAParameters keyInfo, \n    bool doOAEPPadding)\n{\n    byte[] encryptedData;\n    using (RSACryptoServiceProvider rsa = new RSACryptoServiceProvider())\n    {\n        //Import the RSA Key information. This only needs\n        //toinclude the public key information.\n        rsa.ImportParameters(keyInfo);\n\n        //Encrypt the passed byte array and specify OAEP padding.  \n        //OAEP padding is only available on Microsoft Windows XP or later.  \n        encryptedData = rsa.Encrypt(data, doOAEPPadding);\n    }\n    return encryptedData;       \n}