/// <summary>\n/// Escapes the LDAP search filter to prevent LDAP injection attacks.\n/// </summary>\n/// <param name="searchFilter">The search filter.</param>\n/// <see cref="https://blogs.oracle.com/shankar/entry/what_is_ldap_injection" />\n/// <see cref="http://msdn.microsoft.com/en-us/library/aa746475.aspx" />\n/// <returns>The escaped search filter.</returns>\nprivate static string EscapeLdapSearchFilter(string searchFilter)\n{\n    StringBuilder escape = new StringBuilder(); // If using JDK >= 1.5 consider using StringBuilder\n    for (int i = 0; i < searchFilter.Length; ++i)\n    {\n        char current = searchFilter[i];\n        switch (current)\n        {\n            case '\\':\n                escape.Append(@"\5c");\n                break;\n            case '*':\n                escape.Append(@"\2a");\n                break;\n            case '(':\n                escape.Append(@"\28");\n                break;\n            case ')':\n                escape.Append(@"\29");\n                break;\n            case '\u0000':\n                escape.Append(@"\00");\n                break;\n            case '/':\n                escape.Append(@"\2f");\n                break;\n            default:\n                escape.Append(current);\n                break;\n        }\n    }\n\n    return escape.ToString();\n}