public System.Management.ManagementEventWatcher mgmtWtch;\n\n    public Form1()\n    {\n        InitializeComponent();\n        mgmtWtch = new System.Management.ManagementEventWatcher("Select * From Win32_ProcessStartTrace");\n        mgmtWtch.EventArrived += new System.Management.EventArrivedEventHandler(mgmtWtch_EventArrived);\n        mgmtWtch.Start();\n    }\n\n    void mgmtWtch_EventArrived(object sender, System.Management.EventArrivedEventArgs e)\n    {\n        MessageBox.Show((string)e.NewEvent["ProcessName"]);\n    }\n\n    private void Form1_FormClosing(object sender, FormClosingEventArgs e)\n    {\n        mgmtWtch.Stop();\n    }