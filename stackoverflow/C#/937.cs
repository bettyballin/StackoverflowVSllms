var iCounter = 0;\nforeach (Employee item in employees)\n{\n\n   if (iCounter == 0)\n  {\n    cmd.BeginTransaction;\n  }\n  string sql = @"INSERT INTO Mytable (id, name, salary) \n    values ('@id', '@name', '@salary')";\n  // replace @par with values\n  cmd.CommandText = sql; // cmd is IDbCommand\n  cmd.ExecuteNonQuery();\n  iCounter ++;\n  if(iCounter >= 500)\n  {\n     cmd.CommitTransaction;\n     iCounter = 0;\n  }\n}\n\nif(iCounter > 0)\n   cmd.CommitTransaction;