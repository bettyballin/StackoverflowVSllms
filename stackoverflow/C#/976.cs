using System.Runtime.InteropServices;\n// Add the following as a COM reference - C:\WINDOWS\Microsoft.NET\Framework\vXXXXXX\mscoree.tlb\nusing mscoree;                              \n\n        public static IList<AppDomain> GetAppDomains()\n        {\n            IList<AppDomain> _IList = new List<AppDomain>();\n            IntPtr enumHandle = IntPtr.Zero\n            CorRuntimeHostClass host = new mscoree.CorRuntimeHostClass();\n            try\n            {\n                host.EnumDomains(out enumHandle);\n                object domain = null;\n                while (true)\n                {\n                    host.NextDomain(enumHandle, out domain);\n                    if (domain == null) break;\n                    AppDomain appDomain = (AppDomain)domain;\n                    _IList.Add(appDomain);\n                }\n                return _IList;\n            }\n            catch (Exception e)\n            {\n                Console.WriteLine(e.ToString());\n                return null;\n            }\n            finally\n            {\n                host.CloseEnum(enumHandle);\n                Marshal.ReleaseComObject(host);\n            }\n        } \n    }