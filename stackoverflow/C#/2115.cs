public static void CommandExecNonQuery(SqlCommand cmd, string query, SqlParameter[] prms)\n{\n    cmd.CommandText = query;\n    cmd.Parameters.AddRange(prms);\n    cmd.ExecuteNonQuery();\n    cmd.Parameters.Clear();\n}\n\nstatic void Main(string[] args)\n{\n    string insertQuery = \n        @"INSERT TESTTABLE (COLUMN1, COLUMN2) " + \n            "VALUES(@ParamCol1, @ParamCol2)";\n    using (SqlConnection connection = new SqlConnection(connectionString))\n    {\n        using (SqlCommand command = connection.CreateCommand())\n        {\n            SqlTransaction transaction = null;\n            try\n            {\n                // BeginTransaction() Requires Open Connection\n                connection.Open();\n\n                transaction = connection.BeginTransaction();\n\n                // Assign Transaction to Command\n                command.Transaction = transaction;\n                for (int i = 0; i < 100; i++)\n                    CommandExecNonQuery(command, insertQuery, \n                        new SqlParameter[] { \n                        new SqlParameter("@ParamCol1", i), \n                        new SqlParameter("@ParamCol2", i.ToString()) });\n                transaction.Commit();\n            }\n            catch\n            {\n                transaction.Rollback();\n                throw;\n            }\n            finally\n            {\n                connection.Close();\n            }\n        }\n    }\n}