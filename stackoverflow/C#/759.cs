public static string HtmlReformat(string html)\n    {\n        var sw = new StringWriter();\n        HtmlTextWriter htmlWriter = new HtmlTextWriter(sw);\n\n        XmlReader rdr = XmlReader.Create(new StringReader(html));\n\n        while (rdr.Read())\n        {\n            switch (rdr.NodeType)\n            {\n                case XmlNodeType.EndElement:\n                    htmlWriter.WriteEndTag(rdr.Name);\n                    htmlWriter.Write(System.Environment.NewLine);\n                    break;\n                case XmlNodeType.Element:\n                        htmlWriter.WriteBeginTag(rdr.Name);\n                        for (int attributeIdx = 0; attributeIdx < rdr.AttributeCount; attributeIdx++)\n                        {\n                                string attribName = rdr.GetAttribute(attributeIdx);\n                                htmlWriter.WriteAttribute(rdr.Name, attribName);\n                        }\n                        htmlWriter.Write(">");\n                        htmlWriter.Write(System.Environment.NewLine);\n                        break;\n                case XmlNodeType.Text:\n                    htmlWriter.Write(rdr.Value);\n                    break; \n                default:\n                    throw new NotImplementedException("Handle " + rdr.NodeType);\n            }\n\n        }\n        return sw.ToString();\n    }