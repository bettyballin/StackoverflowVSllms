System.Data.DataSet ds1;\n\nconst string ConnStringSql= "Provider=sqloledb;Data Source=dinoch-8;Initial Catalog=Northwind;Integrated Security=SSPI;" ;\nconst string OutputFilename= "ExtractToExcel.xls";\n\nconst string ConnStringExcel= \n"Provider=Microsoft.Jet.OLEDB.4.0;" + \n"Data Source=" + OutputFilename + ";" + \n"Extended Properties=\"Excel 8.0;HDR=yes;\"";  // FIRSTROWHASNAMES=1;READONLY=false\"\n\nconst string sqlSelect="SELECT top 10 ProductId, ProductName, QuantityPerUnit, UnitPrice, UnitsInStock, GETDATE() as Extracted  from Products order by UnitPrice";\nconst string sqlInsert="INSERT INTO Extracto (ProductId, ProductName, QuantityPerUnit, UnitPrice, UnitsInStock, Extracted) VALUES (@ProductId, @ProductName, @QuantityPerUnit, @UnitPrice, @UnitsInStock, @Extracted)"; \n\nprivate void ReadFromSql()\n{\n    var ConnSql= new System.Data.OleDb.OleDbConnection(ConnStringSql);\n\n    var da1 = new System.Data.OleDb.OleDbDataAdapter();\n    da1.SelectCommand=  new System.Data.OleDb.OleDbCommand(sqlSelect);\n    da1.SelectCommand.Connection= ConnSql;\n\n    ds1= new System.Data.DataSet();\n    da1.Fill(ds1, "Extracto");\n}\n\n\n\nprivate void InsertIntoExcel()\n{\n    // need to update the row so the DA does the insert...\n    foreach (System.Data.DataRow r in ds1.Tables[0].Rows)\n    { \n      r.SetModified(); // mark the row as updated to force an insert\n    }\n\n    var da2 = new System.Data.OleDb.OleDbDataAdapter();\n\n    da2.UpdateCommand= new System.Data.OleDb.OleDbCommand(sqlInsert);\n    da2.UpdateCommand.Connection= ConnExcel;\n\n    da2.UpdateCommand.Parameters.Add("@ProductId", System.Data.OleDb.OleDbType.Integer, 4, "ProductId");\n    da2.UpdateCommand.Parameters.Add("@ProductName", System.Data.OleDb.OleDbType.VarWChar, 40, "ProductName");\n    da2.UpdateCommand.Parameters.Add("@QuantityPerUnit", System.Data.OleDb.OleDbType.VarWChar, 20, "QuantityPerUnit");\n    da2.UpdateCommand.Parameters.Add("@UnitPrice", System.Data.OleDb.OleDbType.Currency, 8, "UnitPrice");\n    da2.UpdateCommand.Parameters.Add("@UnitsInStock", System.Data.OleDb.OleDbType.SmallInt, 2, "UnitsInStock");\n    da2.UpdateCommand.Parameters.Add("@Extracted", System.Data.OleDb.OleDbType.Date, 8, "Extracted");\n\n    da2.Update(ds1, "Extracto");\n}