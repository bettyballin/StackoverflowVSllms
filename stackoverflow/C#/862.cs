public class PrevUrlAttribute : ActionFilterAttribute\n{\n    public override void OnActionExecuting(ActionExecutingContext filterContext)\n    {\n        var httpContext = filterContext.HttpContext;\n        var session = filterContext.HttpContext.Session;\n\n        if (httpContext.Request.RequestType == "GET"\n            && !httpContext.Request.IsAjaxRequest())\n        {\n            session["PrevUrl"] = session["CurUrl"] ?? httpContext.Request.Url;\n            session["CurUrl"] = httpContext.Request.Url;\n        }\n    }\n}