Engine_Base^  engine_for_app;\nAssembly^ SampleAssembly;\nType^  engineType;\n\nif (this->M_ENGINE == "A")\n{\n    SampleAssembly = Assembly::LoadFrom("path\\Engine_A.dll");\n\n    engineType = SampleAssembly->GetType("Engine_A");\n    engine_for_app = static_cast<Engine_Base^>(Activator::CreateInstance(engineType, param1, param2));\n}\nelse\n{\n    SampleAssembly = Assembly::LoadFrom("path\\Engine_B.dll");\n\n    engineType = SampleAssembly->GetType("Engine_B");\n    engine_for_app = static_cast<Engine_Base^>(Activator::CreateInstance(engineType, param1, param2, param3, param4));\n}