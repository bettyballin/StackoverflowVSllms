public class RestModule : IHttpModule\n{\n    public void Dispose() { }\n\n    public void Init(HttpApplication app)\n    {\n        app.BeginRequest += delegate\n        {\n            HttpContext ctx = HttpContext.Current;\n            string path = ctx.Request.AppRelativeCurrentExecutionFilePath;\n\n            int i = path.IndexOf('/', 2);\n            if (i > 0)\n            {\n                string svc = path.Substring(0, i) + ".svc";\n                string rest = path.Substring(i, path.Length - i);\n                ctx.RewritePath(svc, rest, ctx.Request.QueryString.ToString(), false);\n            }\n        };\n    }\n}