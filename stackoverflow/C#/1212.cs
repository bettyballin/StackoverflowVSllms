static double Profile(string description, int iterations, Action func) {\n    //Run at highest priority to minimize fluctuations caused by other processes/threads\n    Process.GetCurrentProcess().PriorityClass = ProcessPriorityClass.High;\n    Thread.CurrentThread.Priority = ThreadPriority.Highest;\n\n    // warm up \n    func();\n\n    var watch = new Stopwatch(); \n\n    // clean up\n    GC.Collect();\n    GC.WaitForPendingFinalizers();\n    GC.Collect();\n\n    watch.Start();\n    for (int i = 0; i < iterations; i++) {\n        func();\n    }\n    watch.Stop();\n    Console.Write(description);\n    Console.WriteLine(" Time Elapsed {0} ms", watch.Elapsed.TotalMilliseconds);\n    return watch.Elapsed.TotalMilliseconds;\n}