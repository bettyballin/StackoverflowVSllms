public bool killProcess(int pid)\n {\n  bool didIkillAnybody = false;\n  try\n  {\n   Process[] procs = Process.GetProcesses();\n   for (int i = 0; i < procs.Length; i++)\n   {\n    didIkillAnybody = GetParentProcess(procsIdea.Id) == pid) &&\n                                   killProcess(procsIdea.Id);\n   }\n   try\n   {\n    Process myProc = Process.GetProcessById(pid);\n    myProc.Kill();\n    return true;\n   }\n   catch { }\n  }\n  catch (Exception ex)\n  {\n   try\n   {\n    new Logger().Write("Exception caught at JobExecution.killProcess()", ex.Message, System.Diagnostics.EventLogEntryType.Warning, false);\n   }\n   catch { }\n  }\n  return didIkillAnybody;\n }\n\n private int GetParentProcess(int Id)\n {\n  int parentPid = 0;\n  using (ManagementObject mo = new ManagementObject("win32_process.handle='" + Id.ToString() + "'"))\n  {\n   mo.Get();\n   parentPid = Convert.ToInt32(mo["ParentProcessId"]);\n  }\n  return parentPid;\n }