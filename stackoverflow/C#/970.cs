private static IEnumerable<T[,]> GetWindows<T>(\n    T[,] array,\n    int windowWidth,\n    int windowHeight)\n{\n    for (var y = 0; y < array.GetLength(1) - windowHeight + 1; y++)\n    {\n        for (var x = 0; x < array.GetLength(0) - windowWidth + 1; x++)\n        {\n            var slice = new T[windowWidth, windowHeight];\n            CopyArray(array, x, y, slice, 0, 0, windowWidth, windowHeight);\n            yield return slice;\n        }\n    }\n}