[STAThread]\nstatic void Main(string[] args)\n{\n    System.Type t = System.Type.GetTypeFromProgID("VisualStudio.DTE.8.0", true);\n    DTE2 dte = (EnvDTE80.DTE2)System.Activator.CreateInstance(t, true);\n\n    // See http://msdn.microsoft.com/en-us/library/ms228772.aspx for the\n    // code for MessageFilter - just paste it in.\n    MessageFilter.Register();\n\n    dte.DoStuff();\n    dte.Quit();\n}\n\npublic class MessageFilter : IOleMessageFilter\n{\n   ... Continues at http://msdn.microsoft.com/en-us/library/ms228772.aspx