using System;\n  using System.Drawing;\n  using System.Runtime.InteropServices;\n\n  sealed class Win32\n  {\n      [DllImport("user32.dll")]\n      static extern IntPtr GetDC(IntPtr hwnd);\n\n      [DllImport("user32.dll")]\n      static extern Int32 ReleaseDC(IntPtr hwnd, IntPtr hdc);\n\n      [DllImport("gdi32.dll")]\n      static extern uint GetPixel(IntPtr hdc, int nXPos, int nYPos);\n\n      static public System.Drawing.Color GetPixelColor(int x, int y)\n      {\n       IntPtr hdc = GetDC(IntPtr.Zero);\n       uint pixel = GetPixel(hdc, x, y);\n       ReleaseDC(IntPtr.Zero, hdc);\n       Color color = Color.FromArgb((int)(pixel & 0x000000FF),\n                    (int)(pixel & 0x0000FF00) >> 8,\n                    (int)(pixel & 0x00FF0000) >> 16);\n       return color;\n      }\n   }