char *\nstrfry (char *string)\n{\n  static int init;\n  static struct random_data rdata;\n  size_t len, i;\n\n  if (!init)\n    {\n      static int state[8] = { 1, 2, 3, 4, 5, 6, 7, 8 };\n      rdata.state = NULL;\n      __initstate_r (time ((time_t *) NULL), state, 8, &rdata);\n      init = 1;\n    }\n\n  len = strlen (string);\n  for (i = 0; i < len; ++i)\n    {\n      int32_t j;\n      char c;\n\n      __random_r (&rdata, &j);\n      j %= len;\n\n      c = string[i];\n      string[i] = string[j];\n      string[j] = c;\n    }\n\n  return string;\n}