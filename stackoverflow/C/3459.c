/* Example calculates the sum of the prime factors of the first 32 Fibonacci numbers */\n#include <stdio.h>\n\ntypedef enum{false=0, true=1}bool;\n\n/* the following line is the only time I have ever required "auto" */\n#define FOR(i,iterator) auto bool lambda(i); yield_init = (void *)&lambda; iterator; bool lambda(i)\n#define DO {\n#define     YIELD(x) if(!yield(x))return\n#define     BREAK return false\n#define     CONTINUE return true\n#define OD CONTINUE; }\n/* Warning: _Most_ FOR(,){ } loops _must_ have a CONTINUE as the last statement. \n *  *   Otherwise the lambda will return random value from stack, and may terminate early */\n\ntypedef void iterator; /* hint at procedure purpose */\nstatic volatile void *yield_init;\n#define YIELDS(type) bool (*yield)(type) = yield_init\n\niterator fibonacci(int n){\n   YIELDS(int);\n   int i;\n   int pair[2] = {0,1};\n   YIELD(0); YIELD(1);\n   for(i=2; i<n; i++){\n      pair[i%2] = pair[0] + pair[1];\n      YIELD(pair[i%2]);\n   }\n}\n\niterator factors(int n){\n  YIELDS(int); \n  int i;\n  for(i=2; i*i<=n; i++){\n    while(n%i == 0 ){\n      YIELD(i);\n      n/=i;\n    }\n  }\n  YIELD(n);\n}\n\nmain(){\n    FOR(int i, fibonacci(32)){\n        printf("%d:", i);\n        int sum = 0;\n        FOR(int factor, factors(i)){\n            sum += factor;\n            printf(" %d",factor);\n            CONTINUE;\n        }\n        printf(" - sum of factors: %d\n", sum);\n        CONTINUE;\n    }\n}