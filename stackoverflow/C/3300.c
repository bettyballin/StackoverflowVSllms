char *ip_address;\nchar *uri;\n\nip_address = sapi_getenv("HTTP_X_FORWARDED_FOR", 20 TSRMLS_CC);\nif (ip_address == NULL) {\n  ip_address = sapi_getenv("REMOTE_ADDR", 11 TSRMLS_CC);\n  if (ip_address == NULL) {\n    ip_address = "no_ip_address";\n  }\n}\n\nuri = sapi_getenv("REQUEST_URI", 11 TSRMLS_CC);\nif (uri == NULL) {\n  uri = "no_uri";\n}\n\nphp_syslog(LOG_NOTICE, "%.500s [ip:%s][uri:%s]", log_message, ip_address, uri);