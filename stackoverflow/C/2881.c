DWORD  verHandle = 0;\nUINT   size      = 0;\nLPBYTE lpBuffer  = NULL;\nDWORD  verSize   = GetFileVersionInfoSize( szVersionFile, &verHandle);\n\nif (verSize != NULL)\n{\n    LPSTR verData = new char[verSize];\n\n    if (GetFileVersionInfo( szVersionFile, verHandle, verSize, verData))\n    {\n        if (VerQueryValue(verData,"\\",(VOID FAR* FAR*)&lpBuffer,&size))\n        {\n            if (size)\n            {\n                VS_FIXEDFILEINFO *verInfo = (VS_FIXEDFILEINFO *)lpBuffer;\n                if (verInfo->dwSignature == 0xfeef04bd)\n                {\n\n                    // Doesn't matter if you are on 32 bit or 64 bit,\n                    // DWORD is always 32 bits, so first two revision numbers\n                    // come from dwFileVersionMS, last two come from dwFileVersionLS\n                    TRACE( "File Version: %d.%d.%d.%d\n",\n                    ( verInfo->dwFileVersionMS >> 16 ) & 0xffff,\n                    ( verInfo->dwFileVersionMS >>  0 ) & 0xffff,\n                    ( verInfo->dwFileVersionLS >> 16 ) & 0xffff,\n                    ( verInfo->dwFileVersionLS >>  0 ) & 0xffff\n                    );\n                }\n            }\n        }\n    }\n    delete[] verData;\n}