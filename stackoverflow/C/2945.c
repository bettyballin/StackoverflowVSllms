bool GetProcessName(LPWSTR pszProcessName, DWORD cchProcessName)\n{\n    bool success = false;\n    // GetCurrentProcess() can't fail.\n    DWORD cch = GetProcessImageFileName(GetCurrentProcess(), pszProcessName, cchProcessName);\n    if (cch > 0)\n    {\n        LPWSTR pszFileName = PathFindFileName(pszProcessName);\n        if (pszFileName)\n        {\n            wmemmove(pszProcessName, pszFileName, lstrlen(pszFileName) + 1);\n        }\n        success = true;\n    }\n    return success;    \n}