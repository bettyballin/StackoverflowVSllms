BEGIN_EVENTSINK_MAP(CMyHTMLDlg, CDHtmlDialog)\n    ON_EVENT(CMyHTMLDlg, AFX_IDC_BROWSER, DISPID_BEFORENAVIGATE2, OnBeforeNavigate2, VTS_DISPATCH VTS_VARIANT VTS_VARIANT VTS_VARIANT VTS_VARIANT VTS_VARIANT VTS_PBOOL)\nEND_EVENTSINK_MAP()\n\nvoid CMyHTMLDlg::OnBeforeNavigate2(LPDISPATCH pDisp, VARIANT* URL,VARIANT* Flags, VARIANT* TargetFrameName, VARIANT* PostData,VARIANT* Headers, BOOL* Cancel)\n{\n\n    ...\n\n    if (URL != NULL)\n    {\n        // Check if navigation is to a folder..\n        CString url = CString(*URL);\n\n        if(url.Left(11) != _T("javascript:"))\n        {\n            _OnBeforeNavigate2(pDisp, URL, Flags, TargetFrameName, PostData, Headers, (BOOL*)Cancel);\n            // If dynamic linking MFC then the above handler doesn't exist. Need to call OnBeforeNavigate direct. \n            // This is from a code site, and it compiles, but I've never tested it to see if it works.\n            //CDHtmlDialog::OnBeforeNavigate(pDisp,(LPCSTR)URL);\n        }\n    }\n}