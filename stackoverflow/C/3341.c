#include <tchar.h>\n#include <windows.h>\n#include "mmsystem.h"\n\nint _tmain( int argc, wchar_t *argv[] )\n{\n    UINT deviceCount = waveInGetNumDevs();\n\n    if ( deviceCount > 0 )\n    {\n        for ( int i = 0; i < deviceCount; i++ )\n        {\n            WAVEINCAPSW waveInCaps;\n\n            waveInGetDevCapsW( i, &waveInCaps, sizeof( WAVEINCAPS ) );\n\n            // do some stuff with waveInCaps...\n        }\n    }\n\n    return 0;\n}