#include <atlbase.h>\n\ntemplate < typename interface_t >\nvoid update( interface_t* p, HRESULT (__stdcall interface_t::*com_uint_getter)(UINT*), UINT& u )\n{\n   UINT tmp;\n   if ( S_OK == (p->*com_uint_getter)( &tmp ) ) {\n      u = tmp;\n   }\n}\n\n// only for compile purpose, it will not work at runtime\nint main(int, char*[])\n{\n   // I choose IDispatch::GetTypeInfoCount just for the sake of exemplification\n   CComPtr< IDispatch > ptr;\n   UINT u;\n   update( ptr.p, &IDispatch::GetTypeInfoCount, u );\n   return 0;\n}