unsigned next_set_of_n_elements(unsigned x) \n  {\n     unsigned smallest, ripple, new_smallest, ones;\n   \n     if (x == 0) return 0;\n     smallest     = (x & -x);\n     ripple       = x + smallest;\n     new_smallest = (ripple & -ripple);\n     ones         = ((new_smallest/smallest) >> 1) - 1;\n     return ripple | ones;\n  }\n\n  // test code (shown for two-bit digits)\n\n  void test (void)\n  {\n    int bits = 2;\n    int a = pow(2,bits) - 1;\n    int i;\n\n    for (i=0; i<100; i++)\n    {\n       printf ("next number is %d\n", a);\n       a = next_set_of_n_elements(a);\n    }\n  }