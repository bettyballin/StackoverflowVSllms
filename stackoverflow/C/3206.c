Bignum modpow(Bignum base, Bignum exponent, Bignum modulus) {\n\n    Bignum result = 1;\n\n    while (exponent > 0) {\n        if ((exponent & 1) == 1) {\n            // multiply in this bit's contribution while using modulus to keep result small\n            result = (result * base) % modulus;\n        }\n        // move to the next bit of the exponent, square (and mod) the base accordingly\n        exponent >>= 1;\n        base = (base * base) % modulus;\n    }\n\n    return result;\n}