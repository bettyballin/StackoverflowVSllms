typedef struct ShortString {\n  char len;\n  char data[255];\n};\ntypedef void (_stdcall *GETCPUID)(struct ShortString *result, BYTE cpuCore);\n\nGETCPUID pGetSerial;\n\nHMODULE hWtsLib = LoadLibrary("HardwareIDExtractor.dll");\nif (hWtsLib) {\n  ShortString serial;\n  pGetSerial = (GETCPUID)GetProcAddress(hWtsLib, "GetCPUID");\n  pGetSerial(&serial, '1');\n  char *str = malloc(serial.len + 1); // include space for the trailing \0\n  strlcpy(str, serial.data, serial.len);\n  str[serial.len] = '\0'; // drop in the trailing null\n}