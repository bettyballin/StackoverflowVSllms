shared_ptr<Image> CreateImage(BYTE *blob, size_t blobSize)\n{\n    HGLOBAL hMem = ::GlobalAlloc(GMEM_MOVEABLE,blobSize);\n    BYTE *pImage = (BYTE*)::GlobalLock(hMem);\n\n    for (size_t iBlob = 0; iBlob < blobSize; ++iBlob)\n        pImage[iBlob] = blob[iBlob];\n\n    ::GlobalUnlock(hMem);\n\n    CComPtr<IStream> spStream;\n    HRESULT hr = ::CreateStreamOnHGlobal(hMem,TRUE,&spStream);\n\n    shared_ptr<Image> image = new Image(spStream);  \n    return image;\n}