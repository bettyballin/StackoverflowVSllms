if( WinHttpGetIEProxyConfigForCurrentUser( &ieProxyConfig ) )\n{\n    if( ieProxyConfig.fAutoDetect )\n    {\n        fAutoProxy = TRUE;\n    }\n\n    if( ieProxyConfig.lpszAutoConfigUrl != NULL )\n    {\n        fAutoProxy = TRUE;\n        autoProxyOptions.lpszAutoConfigUrl = ieProxyConfig.lpszAutoConfigUrl;\n    }\n}\nelse\n{\n    // use autoproxy\n    fAutoProxy = TRUE;\n}\n\nif( fAutoProxy )\n{\n    if ( autoProxyOptions.lpszAutoConfigUrl != NULL )\n    {\n        autoProxyOptions.dwFlags = WINHTTP_AUTOPROXY_CONFIG_URL;\n    }\n    else\n    {\n        autoProxyOptions.dwFlags = WINHTTP_AUTOPROXY_AUTO_DETECT;\n        autoProxyOptions.dwAutoDetectFlags = WINHTTP_AUTO_DETECT_TYPE_DHCP | WINHTTP_AUTO_DETECT_TYPE_DNS_A;\n    }\n\n    // basic flags you almost always want\n    autoProxyOptions.fAutoLogonIfChallenged = TRUE;\n\n    // here we reset fAutoProxy in case an auto-proxy isn't actually\n    // configured for this url\n    fAutoProxy = WinHttpGetProxyForUrl( hiOpen, pwszUrl, &autoProxyOptions, &autoProxyInfo );\n}\n\nif ( fAutoProxy )\n{\n    // set proxy options for libcurl based on autoProxyInfo\n}\nelse\n{\n    if( ieProxyConfig.lpszProxy != NULL )\n    {\n        // IE has an explicit proxy. set proxy options for libcurl here\n        // based on ieProxyConfig\n        //\n        // note that sometimes IE gives just a single or double colon\n        // for proxy or bypass list, which means "no proxy"\n    }\n    else\n    {\n        // there is no auto proxy and no manually configured proxy\n    }\n}