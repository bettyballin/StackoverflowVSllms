bool ArrayToVariant(CArray<BYTE, BYTE>& array, VARIANT& vtResult)\n{\nSAFEARRAY FAR*  psarray;\nSAFEARRAYBOUND sabounds[1]; \n\nsabounds[0].lLbound=0;\nsabounds[0].cElements = (ULONG)array.GetSize();\n\nlong nLbound;\n\npsarray = SafeArrayCreate(VT_UI1, 1, sabounds);\nif(psarray == NULL)\n    return false;\n\nfor(nLbound = 0; nLbound < (long)sabounds[0].cElements ; nLbound++){\n    if(FAILED(SafeArrayPutElement(psarray, &nLbound, &array[nLbound]))){\n        SafeArrayDestroy(psarray);\n        return false;\n    }\n}\n\nVariantFree(vtResult);\nvtResult.vt = VT_ARRAY|VT_UI1;\nvtResult.parray = psarray;\nreturn true;\n}