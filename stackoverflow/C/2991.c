#include <fstream>\n#include <sstream>\nusing std::ios_base;\n\ntemplate<typename Iterator, typename Value>\nvoid iota(Iterator start, Iterator end, Value val) {\n    while (start != end) {\n        *(start++) = val++;\n    }\n}\n\nint main() {\n\n    const int dim = 1000;\n    const int cubesize = dim*dim*dim;\n    const int squaresize = dim*dim;\n    const int steps = 7; //ranges from 1 to  255\n    typedef unsigned char uchar;\n\n    uchar *partMap = new uchar[cubesize];\n    // dummy data. I timed this separately and it takes about\n    // a second, so I won't worry about its effect on overall timings.\n    iota(partMap, partMap + cubesize, uchar(7));\n    uchar *projection = new uchar[squaresize];\n\n    for (int stage = 1; stage < steps; stage++) {\n        for (int j = 0; j < dim; j++) {\n                for (int i = 0; i < dim; i++)\n                {\n                        int sum = 0;\n                        for (int k = 0; k < dim; k++)\n                            if (partMap[(((i * dim) + k) * dim) + j] >= stage)\n                                sum++;\n\n                        projection[(j*dim) + i] = sum;\n                }\n        }\n\n        std::stringstream filename;\n        filename << "results" << stage << ".bin";\n        std::ofstream file(filename.str().c_str(), \n            ios_base::out | ios_base::binary | ios_base::trunc);\n        file.write((char *)projection, squaresize);\n    }\n\n    delete[] projection;\n    delete[] partMap;\n}