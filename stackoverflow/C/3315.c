OnUserEnter()\n{\n   if (UsersDetected == 0)\n   {\n      FirstDetectionTime = Now();\n   }\n   UsersDetected++;\n   CurrentlyInUse = true;\n}\n\nOnUserExit()\n{\n  CurrentlyInUse = false;\n  if (UsersDetected >= MaxUsersBetweenFlushes || \n         Now() - FirstDetectionTime > StinkInterval)\n  {\n     Flush();\n  }\n}\n\nOnTimer()\n{\n   if (!CurrentlyInUse && \n          UsersDetected > 0 && \n          Now() - FirstDetectionTime > StinkInterval)\n   {\n      Flush();\n   }\n}\n\nFlush()\n{\n   FlushTheUrinal();\n   UsersDetected = 0;\n}