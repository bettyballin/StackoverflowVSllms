void AddFiles(AnsiString path, TDataSet *DataSet)\n{\nTSearchRec sr;\nint f;\n    f = FindFirst(path+"\\*.*", faAnyFile, sr);\n    while( !f )\n    {\n        if(sr.Attr & faDirectory)\n        {\n            if(sr.Name != "."   &&   sr.Name != "..")\n            {\n                path.sprintf("%s%s%s", path, "\\", sr.Name);\n                AddFiles(path, DataSet);\n            }\n        }\n        else\n        {\n            DataSet->Append();\n            DataSet->FieldByName("Name")->Value = sr.Name;\n            /* other fields ... */\n            DataSet->Post();\n        }\n        f = FindNext(sr);\n    }\n    FindClose(sr);\n}