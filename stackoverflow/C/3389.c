#define ci(container) container ## iter\n#define foreach_value(var, container) \\n    for (typeof((container).begin()) ci(container) = container.begin(); \\n         ci(container) != container.end(); ) \\n        for (typeof(ci(container)->second)* var = &ci(container)->second; \\n             ci(container) != container.end(); \\n             (++ci(container) != container.end()) ? \\n                 (var = &ci(container)->second) : var)