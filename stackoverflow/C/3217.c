#include <stdlib.h>\n#include <stdio.h>\n\nstatic int *a;\nstatic int n;\n\nvoid print_bracelet(int n, int a[])\n{\n    int i;\n\n    printf("[");\n    for (i = 0; i < n; i++)\n        printf(" %c", 'a' + a[i]);\n    printf(" ]\n");\n}\n\nint check_rev(int t, int i)\n{\n    int j;\n\n    for (j = i+1; j <= (t + 1)/2; j++)\n    {\n        if (a[j] < a[t-j+1])\n            return 0;\n        if (a[j] > a[t-j+1])\n            return -1;\n    }\n\n    return 1;\n}\n\nvoid gen_bracelets(int n_a, int n_b, int t, int p, int r, int u, int v, int rs)\n{\n    if (2 * (t - 1) > (n + r))\n    {\n        if (a[t-1] > a[n-t+2+r])\n            rs = 0;\n        else if (a[t-1] < a[n-t+2+r])\n            rs = 1;\n    }\n    if (t > n)\n    {\n        if (!rs && (n % p) == 0)\n            print_bracelet(n, a + 1);\n    }\n    else\n    {\n        int n_a2 = n_a;\n        int n_b2 = n_b;\n\n        a[t] = a[t-p];\n\n        if (a[t] == 0)\n            n_a2--;\n        else\n            n_b2--;\n\n        if (a[t] == a[1])\n            v++;\n        else\n            v = 0;\n\n        if ((u == (t - 1)) && (a[t-1] == a[1]))\n            u++;\n\n        if ((n_a2 >= 0) && (n_b2 >= 0) && !((t == n) && (u != n) && (a[n] == a[1])))\n        {\n            if (u == v) {\n                int rev = check_rev(t, u);\n\n                if (rev == 0)\n                    gen_bracelets(n_a2, n_b2, t + 1, p, r, u, v, rs);\n\n                if (rev == 1)\n                    gen_bracelets(n_a2, n_b2, t + 1, p, t, u, v, 0);\n            }\n            else\n                gen_bracelets(n_a2, n_b2, t + 1, p, r, u, v, rs);\n        }\n\n        if (u == t)\n            u--;\n\n        if (a[t-p] == 0 && n_b > 0)\n        {\n            a[t] = 1;\n\n            if (t == 1)\n                gen_bracelets(n_a, n_b - 1, t + 1, t, 1, 1, 1, rs);\n            else\n                gen_bracelets(n_a, n_b - 1, t + 1, t, r, u, 0, rs);\n        }\n    }\n}\n\nint main(int argc, char *argv[])\n{\n    int n_a, n_b;\n\n    if (argc < 3)\n    {\n        fprintf(stderr, "Usage: %s <a> <b>\n", argv[0]);\n        return -2;\n    }\n\n    n_a = atoi(argv[1]);\n    n_b = atoi(argv[2]);\n\n    if (n_a < 0 || n_b < 0)\n    {\n        fprintf(stderr, "a and b must be nonnegative\n");\n        return -3;\n    }\n\n    n = n_a + n_b;\n    a = malloc((n + 1) * sizeof(int));\n\n    if (!a)\n    {\n        fprintf(stderr, "could not allocate array\n");\n        return -1;\n    }\n\n    a[0] = 0;\n\n    gen_bracelets(n_a, n_b, 1, 1, 0, 0, 0, 0);\n\n    free(a);\n    return 0;\n}