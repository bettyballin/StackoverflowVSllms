#define TreeView_SetItemState(hwndTV, hti, data, _mask) \\n{ TVITEM _ms_TVi;\\n  _ms_TVi.mask = TVIF_STATE; \\n  _ms_TVi.hItem = (hti); \\n  _ms_TVi.stateMask = (_mask);\\n  _ms_TVi.state = (data);\\n  SNDMSG((hwndTV), TVM_SETITEM, 0, (LPARAM)(TV_ITEM *)&_ms_TVi);\\n}\n\n#define TreeView_SetCheckState(hwndTV, hti, fCheck) \\n  TreeView_SetItemState(hwndTV, hti, INDEXTOSTATEIMAGEMASK((fCheck)?2:1), TVIS_STATEIMAGEMASK)