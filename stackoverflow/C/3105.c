double samplesPerPixel = (double)L / _width;\ndouble firstSample = 0;\nint endSample = firstSample + L - 1;\nfor (short pixel = 0; pixel < _width; pixel++)\n{\n    int lastSample = __min(endSample, (int)(firstSample + samplesPerPixel));\n    double Y = _data[channel][(int)firstSample];\n    double minY = Y;\n    double maxY = Y;\n    for (int sample = (int)firstSample + 1; sample <= lastSample; sample++)\n    {\n        Y = _data[channel][sample];\n        minY = __min(Y, minY);\n        maxY = __max(Y, maxY);\n    }\n    x = pixel + _offsetx;\n    y1 = Value2Pixel(minY);\n    y2 = Value2Pixel(maxY);\n    if (y1 == y2)\n    {\n        g->DrawImageUnscaled(bm, x, y1);\n    }\n    else\n    {\n        g->DrawLine(pen, x, y1, x, y2);\n    }\n    firstSample += samplesPerPixel;\n}