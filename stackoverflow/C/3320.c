typedef struct {\n    int type;\n    int result;\n} DialogData;\n    \nstatic gboolean\ndisplay_dialog(gpointer user_data)\n{\n    DialogData *dialog_data = user_data;\n    GtkWidget *dialog;\n    \n    if (dialog_data->type & MB_YESNO)\n        dialog = gtk_message_dialog_new(...);\n    else\n        dialog = gtk_message_dialog_new(...);\n    \n    // Set title, etc.\n    \n    dialog_data->result = gtk_dialog_run(...);\n    \n    gtk_main_quit();  // Quits the main loop run in MessageBox()\n    \n    return FALSE;\n}\n    \nint MessageBox(...)\n{\n    DialogData dialog_data;\n    \n    dialog_data.type = type;\n    \n    gtk_idle_add(display_dialog, &dialog_data);\n    \n    gtk_main();\n    \n    // Do stuff based on dialog_data.result\n}