WCHAR fileName[_MAX_PATH];\nDWORD size = GetModuleFileName(g_dllHandle, fileName, _MAX_PATH);\nfileName[size] = NULL;\nDWORD handle = 0;\nsize = GetFileVersionInfoSize(fileName, &handle);\nBYTE* versionInfo = new BYTE[size];\nif (!GetFileVersionInfo(fileName, handle, size, versionInfo))\n{\n    delete[] versionInfo;\n    return;\n}\n// we have version information\nUINT                len = 0;\nVS_FIXEDFILEINFO*   vsfi = NULL;\nVerQueryValue(versionInfo, L"\\", (void**)&vsfi, &len);\naVersion[0] = HIWORD(vsfi->dwFileVersionMS);\naVersion[1] = LOWORD(vsfi->dwFileVersionMS);\naVersion[2] = HIWORD(vsfi->dwFileVersionLS);\naVersion[3] = LOWORD(vsfi->dwFileVersionLS);\ndelete[] versionInfo;