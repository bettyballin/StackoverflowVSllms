#!/bin/bash\n\nfloppydev='/dev/sdb'\nsavepath='/srv/floppy_imgs'\nwhile true\ndo\n  echo "Press a key to create an image of the next floppy"\n  read -n 1\n\n  dd if=$floppydev of=/dev/null count=1 2> /dev/null\n  errlvl=$?\n  #if the disk isn't in the drive then wait\n  while [ $errlvl -ne 0 ]\n  do\n    sleep 1\n    dd if=$floppydev of=/dev/null count=1 2> /dev/null\n    errlvl=$?\n  done\n\n  filename=$(date +'img-%Y%m%d-%H%M%S.flp')\n\n  if [ ! -f $savepath/$filename ]\n  then\n    echo "creating image as $filename"\n    dd if=$floppydev of=$savepath/$filename\n    errlvl=$?\n\n    if [ $errlvl -ne 0 ]\n    then\n      echo 'the image copy failed!'\n      rm -i $savepath/$filename\n    else\n      mlabel -s -i $savepath/$filename ::\n      md5sum $savepath/$filename > $savepath/$filename.md5\n      echo "copy complete"\n      echo " "\n    fi\n  fi\n\ndone