CREATE PROCEDURE GetNextAutoIncValue\n       @TableName NVARCHAR(255),\n       @ColumnName NVARCHAR(255),\n       @NewValue INT OUTPUT\n   AS\n   BEGIN\n       -- Begin transaction\n       BEGIN TRANSACTION;\n\n       -- Update and fetch the next value atomically\n       UPDATE AutoInc\n       SET NextValue = NextValue + 1,\n           @NewValue = NextValue + 1\n       WHERE TableName = @TableName AND ColumnName = @ColumnName;\n\n       -- If not exists, insert with initial value 1\n       IF @@ROWCOUNT = 0\n       BEGIN\n           INSERT INTO AutoInc (TableName, ColumnName, NextValue)\n           VALUES (@TableName, @ColumnName, 1);\n           SET @NewValue = 1;\n       END\n\n       -- Commit transaction\n       COMMIT TRANSACTION;\n\n   END;