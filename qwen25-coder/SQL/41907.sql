WITH RankedPeople AS (\n    SELECT \n        p.Name AS PersonName,\n        g.RecordDate,\n        ROW_NUMBER() OVER (PARTITION BY p.Name ORDER BY g.RecordDate DESC) AS rn\n    FROM \n        People p\n    INNER JOIN \n        GroupRecords g ON p.GroupRecordsId = g.Id\n    WHERE \n        YEAR(g.SchoolYear) = 2000\n)\nSELECT DISTINCT\n    PersonName\nFROM \n    RankedPeople\nWHERE \n    rn = 1;