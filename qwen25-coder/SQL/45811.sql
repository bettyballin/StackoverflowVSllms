WITH TenantBalances AS (\n    SELECT tenant.ID AS TenantID, SUM(ISNULL(trans.Amount,0)) AS TenantBalance \n    FROM tblTenant tenant\n    LEFT JOIN tblTransaction trans ON tenant.ID = trans.TenantID\n    GROUP BY tenant.ID\n)\nSELECT t.TenantName, t.CarPlateNumber, t.CarColor, t.Sex, t.SSNO, t.Phone, t.Memo,\n       u.UnitNumber,\n       p.PropertyName,\n       tb.TenantBalance -- Added balance from the stored procedure\nFROM tblTenant t\nLEFT JOIN tblRentalUnit u ON t.UnitID = u.ID\nLEFT JOIN tblProperty p ON u.PropertyID = p.ID\nLEFT JOIN TenantBalances tb ON t.ID = tb.TenantID -- Joining with the CTE\nORDER BY p.PropertyName, t.CarPlateNumber;