WITH\n  x AS( SELECT 1 id FROM dual UNION SELECT 2 FROM dual UNION SELECT 3 FROM dual ),\n  y AS( SELECT 1 id, 1 nr, 'B' code FROM dual\n        UNION SELECT 1, 2, 'A'  FROM dual\n        UNION SELECT 2, 2, 'A' FROM dual\n      ),\n  y_filtered AS (\n    SELECT y.id, y.nr, y.code,\n           ROW_NUMBER() OVER (PARTITION BY y.id ORDER BY y.nr) AS rn\n    FROM y\n  )\nSELECT x.id, yf.nr, yf.code\nFROM x\nLEFT OUTER JOIN y_filtered yf ON x.id = yf.id AND yf.rn = 1;