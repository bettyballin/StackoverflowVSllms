SELECT \n    s.day AS splits_day, \n    s.ratio, \n    s.ticker, \n    d.day AS dividends_day, \n    d.amount, \n    d.ticker\nFROM \n    splits s\nLEFT JOIN \n    dividends d ON s.ticker = d.ticker AND s.day = d.day\n\nUNION\n\nSELECT \n    s.day AS splits_day, \n    s.ratio, \n    s.ticker, \n    d.day AS dividends_day, \n    d.amount, \n    d.ticker\nFROM \n    splits s\nRIGHT JOIN \n    dividends d ON s.ticker = d.ticker AND s.day = d.day\n\nORDER BY \n    COALESCE(s.day, d.day), \n    s.ticker;