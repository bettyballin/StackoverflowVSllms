SELECT t.Post_ID AS ID, t.DATE, t.Title, p.Text\nFROM Top_Level t\nJOIN Post p ON t.Post_ID = p.ID\nWHERE t.Post_ID IN (\n    SELECT DISTINCT COALESCE(t2.Post_ID, c.TopLv_ID)\n    FROM (\n        SELECT Post_ID, DATE\n        FROM Top_Level\n        UNION ALL\n        SELECT TopLv_ID AS Post_ID, DATE\n        FROM Comment\n    ) AS combined_dates\n    ORDER BY DATE DESC\n    LIMIT 1 OFFSET 0\n) OR t.Post_ID IN (\n    SELECT DISTINCT c.TopLv_ID\n    FROM Comment c\n    WHERE c.DATE >= (\n        SELECT MAX(DATE) \n        FROM Top_Level tl\n        WHERE tl.Post_ID = c.TopLv_ID\n    )\n)\nORDER BY GREATEST(t.DATE, (\n    SELECT COALESCE(MAX(c2.DATE), t.DATE)\n    FROM Comment c2\n    WHERE c2.TopLv_ID = t.Post_ID\n)) DESC;