CREATE PROCEDURE GetPagedSearchResults\n    @PageNumber INT,\n    @PageSize INT,\n    @CountOnly BIT = 0,\n    -- Add other parameters here as per your search criteria...\nAS\nBEGIN\n    DECLARE @SQL NVARCHAR(MAX);\n    SET NOCOUNT ON;\n\n    IF @CountOnly = 1\n    BEGIN\n        SET @SQL = N'SELECT COUNT(*) AS TotalCount FROM YourTable WHERE ...';\n        -- Append any dynamic conditions to the SQL here...\n\n        EXEC sp_executesql @SQL;\n    END\n    ELSE\n    BEGIN\n        SET @SQL = N'\n            WITH PagedResults AS (\n                SELECT \n                    ROW_NUMBER() OVER (ORDER BY YourColumn) AS RowNum, \n                    -- Select required columns here...\n                FROM YourTable \n                WHERE ...) '\n                -- Append any dynamic conditions to the SQL here...\n\n        + N' SELECT * FROM PagedResults\n               WHERE RowNum BETWEEN (@PageNumber - 1) * @PageSize + 1 AND @PageNumber * @PageSize;';\n\n        EXEC sp_executesql @SQL, N'@PageNumber INT, @PageSize INT', @PageNumber, @PageSize;\n    END\nEND