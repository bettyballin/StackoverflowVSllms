CREATE VIEW my_view AS \nSELECT metadata.ID, \n       metadata.Field1, \n       metadata.Field2, \n       metadata.Field3, \n       metadata.Field4, \n       attribute1.StrValue AS Attr1, \n       attribute2.StrValue AS Attr2 \nFROM metadata\nJOIN data AS attribute1 ON metadata.ID = attribute1.ID AND attribute1.name = 'attr1'\nJOIN data AS attribute2 ON metadata.ID = attribute2.ID AND attribute2.name = 'attr2'\nWHERE metadata.Type = 'TYPE1';