IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DictValue]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))\nDROP FUNCTION [dbo].[DictValue]\nGO\n\ncreate function DictValue(\n    @id int,\n    @key nvarchar(max)\n) returns nvarchar(max) as begin\n    return (\n        select \n            Pair.value('data(.)', 'nvarchar(max)')\n        from \n            (select Dict from TableWithXmlColumn where Id = @id) as t(Dict)\n        cross apply \n            t.Dict.nodes('/StringDictionary/Pair[@Key=sql:variable("@key")]') as d(Pair)\n    )\nend\nGO\n\ndeclare @xmlId int\ninsert TableWithXmlColumn (Dict) values (\n    N'<?xml version="1.0" encoding="utf-16"?>\n    <StringDictionary>\n      <Pair Key="color">red</Pair>\n      <Pair Key="count">123</Pair>\n    </StringDictionary>')\nset @xmlId = scope_identity()\n\nselect \n    dbo.DictValue(@xmlId, 'color') as color,\n    dbo.DictValue(@xmlId, 'count') as [count]