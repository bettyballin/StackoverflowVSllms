CREATE VIEW AccountBalances AS\nWITH MinMaxIDs AS (\n    SELECT \n        account_id,\n        DATE(date) AS transaction_date,\n        MIN(id) AS min_id,\n        MAX(id) AS max_id\n    FROM \n        Transactions\n    GROUP BY \n        account_id, DATE(date)\n)\nSELECT \n    mm.account_id,\n    mm.transaction_date,\n    t1.amount AS opening_balance,\n    t2.amount AS closing_balance\nFROM \n    MinMaxIDs mm\nLEFT JOIN \n    Transactions t1 ON mm.min_id = t1.id\nLEFT JOIN \n    Transactions t2 ON mm.max_id = t2.id;