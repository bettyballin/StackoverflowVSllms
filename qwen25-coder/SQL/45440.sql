SELECT \n    DATEADD(MONTH, DATEDIFF(MONTH, 0, a.OpenedDate), 0) AS OpenedMonth,\n    c.AddressState AS State,\n    SUM(p.Amount) AS TotalAmount\nFROM \n    Account a\nINNER JOIN \n    Customer c ON c.CustomerID = a.CustomerID\nINNER JOIN \n    Payment p ON p.AccountID = a.AccountID\nGROUP BY \n    DATEADD(MONTH, DATEDIFF(MONTH, 0, a.OpenedDate), 0),\n    c.AddressState\nORDER BY \n    OpenedMonth, State;