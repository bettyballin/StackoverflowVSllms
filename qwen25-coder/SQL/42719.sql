DECLARE @inputString NVARCHAR(100) = N'foo=abc;bar=def;baz=ghi';\nDECLARE @startPos INT, @endPos INT;\nDECLARE @value NVARCHAR(50);\n\n-- Find the start position of 'bar='\nSET @startPos = CHARINDEX('bar=', @inputString);\n\nIF @startPos > 0\nBEGIN\n    -- Adjust start position to point right after '='\n    SET @startPos = @startPos + LEN('bar=');\n    \n    -- Find the position of ';' after 'bar='\n    SET @endPos = CHARINDEX(';', @inputString, @startPos);\n    \n    -- Extract the substring using calculated positions\n    IF @endPos > 0\n    BEGIN\n        SET @value = SUBSTRING(@inputString, @startPos, @endPos - @startPos);\n    END\nEND\n\nSELECT @value AS BarValue;