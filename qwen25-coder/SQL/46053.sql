SELECT \n    ItemName AS ItemDescription,\n    MAX(ItemPrice) AS LatestEffectivePrice\nFROM \n    (SELECT \n        ItemName, \n        ItemPrice,\n        ROW_NUMBER() OVER (PARTITION BY ItemName ORDER BY ItemPriceEffectiveDate DESC) as rn\n     FROM \n        FunTable\n     WHERE \n        ItemPriceEffectiveDate <= CURRENT_DATE) subquery\nWHERE \n    rn = 1\nGROUP BY \n    ItemName;