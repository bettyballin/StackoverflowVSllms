WITH RECURSIVE TIME_BUCKETS (job_id, start_time, end_time) AS (\n    SELECT job_id,\n           start_time AS time_bucket_start,\n           GREATEST(start_time + INTERVAL '1' MINUTE, LEAST(end_time, TO_DATE('2023-10-17 07:00:00', 'YYYY-MM-DD HH24:MI:SS') + INTERVAL '24' HOUR)) AS time_bucket_end\n    FROM your_table\n    WHERE user_name = 'Alice'\n      AND start_time < TO_DATE('2023-10-17 07:00:00', 'YYYY-MM-DD HH24:MI:SS') + INTERVAL '24' HOUR\n      AND end_time > TO_DATE('2023-10-17 07:00:00', 'YYYY-MM-DD HH24:MI:SS')\n    UNION ALL\n    SELECT job_id,\n           time_bucket_start + INTERVAL '1' MINUTE AS time_bucket_start,\n           GREATEST(time_bucket_start + INTERVAL '2' MINUTE, LEAST(end_time, TO_DATE('2023-10-17 07:00:00', 'YYYY-MM-DD HH24:MI:SS') + INTERVAL '24' HOUR)) AS time_bucket_end\n    FROM TIME_BUCKETS\n    WHERE time_bucket_start < end_time - INTERVAL '1' MINUTE\n)\nSELECT job_id,\n       time_bucket_start,\n       time_bucket_end\nFROM TIME_BUCKETS\nORDER BY job_id, time_bucket_start;