CREATE FUNCTION dbo.GetBusinessDaysBetween(\n    @StartDate DATETIME,\n    @EndDate DATETIME\n)\nRETURNS @BusinessDays TABLE (BusinessDayCount INT)\nAS\nBEGIN\n    INSERT INTO @BusinessDays\n    SELECT COUNT(*) AS BusinessDayCount\n    FROM Calendar\n    WHERE Date >= CAST(@StartDate AS DATE)\n      AND Date <= CAST(@EndDate AS DATE)\n      AND IsWeekday = 1\n      AND IsHoliday = 0;\n    \n    RETURN;\nEND;