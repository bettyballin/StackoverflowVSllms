WITH RankedData AS (\n    SELECT\n        A.aID, A.bID, A.aCol1, A.aCol2, A.aCol3,\n        B.bID, B.cID, B.bCol1, B.bCol2, B.bCol3,\n        C.cID, C.cCol1, C.cCol2, C.col3, C.cCol4,\n        ROW_NUMBER() OVER (PARTITION BY C.col3 ORDER BY A.aID) AS rn\n    FROM\n        A\n    INNER JOIN\n        B ON A.bID = B.bID\n    INNER JOIN\n        C ON B.cID = C.cID\n)\nSELECT\n    aID, bID, aCol1, aCol2, aCol3,\n    bID, cID, bCol1, bCol2, bCol3,\n    cID, cCol1, cCol2, col3, cCol4\nFROM\n    RankedData\nWHERE\n    rn = 1;