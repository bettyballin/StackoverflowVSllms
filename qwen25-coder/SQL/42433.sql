WITH Scores AS (\n    SELECT \n        object_id,\n        SUM(vote) AS total_score\n    FROM \n        votes\n    WHERE \n        object_id IN (1, 2) -- This is where the group filter logic goes\n    GROUP BY \n        object_id\n),\nMinScoreAdjustment AS (\n    SELECT\n        MIN(total_score) AS min_total_score\n    FROM\n        Scores\n)\nSELECT\n    s.object_id,\n    IFNULL(CAST(s.total_score - COALESCE(m.min_total_score, 0) AS REAL) / SUM(s.total_score - COALESCE(m.min_total_score, 0)) OVER (), 0) AS normalized_score\nFROM\n    Scores s\nJOIN\n    MinScoreAdjustment m ON 1=1;