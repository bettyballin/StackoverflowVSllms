-- Step 1: Create a temporary table to hold mappings from old IDs to new IDs\nCREATE TABLE #IdMapping \n(\n    OldID INT,\n    NewID INT\n);\n\n-- Step 2: Insert into new table and capture old IDs along with newly generated IDs using the OUTPUT clause\nINSERT INTO MV6.Posts (Column1, Column2, ...)\nOUTPUT INSERTED.ID, MV5.OldID -- Adjust column list as necessary\nINTO #IdMapping (NewID, OldID)\nSELECT Column1, Column2, ...\nFROM MV5.Posts;\n\n-- Step 3: Update the old table with new IDs\nUPDATE MV5.Posts\nSET MV6ID = IdMap.NewID\nFROM MV5.Posts P\nJOIN #IdMapping IdMap ON P.OldID = IdMap.OldID;\n\n-- Clean up temporary table\nDROP TABLE #IdMapping;