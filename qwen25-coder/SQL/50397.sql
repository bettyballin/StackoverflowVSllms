CREATE PROCEDURE Get_Checksum\n    @DatabaseName      varchar(100),\n    @TableName         varchar(100),\n    @Checksum          float OUTPUT\nAS\nBEGIN\n\n    DECLARE @SQL        nvarchar(4000)\n    DECLARE @ColumnName varchar(100)\n    DECLARE @i          int\n    DECLARE @intColumns table (idRecord int identity(1,1), ColumnName varchar(255))\n    DECLARE @CS         table (MyCheckSum bigint)\n\n    SET @SQL = \n           'Insert Into @IntColumns(ColumnName)' + Char(13) + \n           'Select Column_Name' + Char(13) +\n           'From   ' + QUOTENAME(@DatabaseName) + '.Information_Schema.Columns (NOLOCK)' + Char(13) + \n           'Where  Table_Name = ''' + @TableName + '''' + Char(13) + \n           '       and Data_Type = ''int''' \n\n    EXEC sp_executeSql @SQL\n\n    SET @SQL = \n           'Insert Into @CS(MyChecksum)' + Char(13) + \n           'Select '\n\n    SET @i = 1\n\n    WHILE EXISTS(\n          SELECT 1\n          FROM   @IntColumns\n          WHERE  IdRecord = @i)\n      BEGIN\n        SELECT @ColumnName = ColumnName\n        FROM   @IntColumns\n        WHERE  IdRecord = @i\n\n        SET @SQL = @SQL + Char(13) + \n             CASE WHEN @i = 1 THEN \n                  '    Sum(Cast(IsNull(' + QUOTENAME(@ColumnName) + ',0) as bigint))'\n                  ELSE\n                  '    + Sum(Cast(IsNull(' + QUOTENAME(@ColumnName) + ',0) as bigint))'\n             END\n\n        SET @i = @i + 1\n      END\n\n    SET @SQL = @SQL + Char(13) + \n         'From ' + QUOTENAME(@DatabaseName) + '.' + QUOTENAME(@TableName) + ' (NOLOCK)'\n\n    EXEC sp_executeSql @SQL\n\n    SELECT TOP 1 @Checksum = MyChecksum FROM @CS\n    SET @Checksum = ISNULL(@Checksum, 0)\n\nEND\nGO