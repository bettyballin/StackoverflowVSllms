SELECT \n  t.location, \n  l.city, \n  f.year, \n  f.customer,\n  SUM(NVL(CASE WHEN t.code = 'C' THEN t.sale_quantity ELSE 0 END, 0)) AS sales_code_C,\n  SUM(NVL(t.sale_quantity, 0)) AS total_sales\nFROM \n  loc t\nJOIN \n  location l ON t.location = l.code(+)\nJOIN \n  father_table f ON f.number = t.number(+) AND f.year = '2008' AND f.code = '0001' AND f.c_code = '01'\nWHERE \n  t.code IN ('C', 'S') \n  AND t.co_code IN ('G', 'V', 'A', 'D')\nGROUP BY \n  t.location, l.city, f.year, f.customer\nORDER BY \n  l.city, f.year;