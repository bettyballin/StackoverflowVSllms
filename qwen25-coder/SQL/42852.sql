WITH RankedGrades AS (\n    SELECT \n        g.username,\n        at.taskID,\n        a.assignmentID,\n        g.grade,\n        ROW_NUMBER() OVER(PARTITION BY g.username, at.taskID ORDER BY g.date DESC) as rn\n    FROM \n        grades g\n    JOIN \n        assignment_tasks at ON g.taskID = at.taskID\n    WHERE \n        at.assignmentID = ? -- replace '?' with the specific assignmentID you want to query\n)\nSELECT \n    s.username,\n    s.forename,\n    COALESCE(rg.grade, 'u') as grade,\n    at.taskID\nFROM \n    students s\nCROSS JOIN \n    (SELECT DISTINCT taskID FROM assignment_tasks WHERE assignmentID = ?) at -- replace '?' with the specific assignmentID\nLEFT JOIN \n    RankedGrades rg ON s.username = rg.username AND at.taskID = rg.taskID AND rg.rn = 1;