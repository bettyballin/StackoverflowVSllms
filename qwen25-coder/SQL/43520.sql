WITH DateList AS (\n    SELECT MIN(TransactionDate) AS MonthStart, MAX(TransactionDate) AS MonthEnd\n    FROM Transactions\n),\nMonths AS (\n    SELECT DATEADD(month, DATEDIFF(month, 0, dl.MonthStart) + n.number, 0) AS MonthDate\n    FROM DateList dl\n    INNER JOIN (SELECT ROW_NUMBER() OVER (ORDER BY object_id)-1 as number FROM sys.objects) n \n        ON n.number <= DATEDIFF(month, dl.MonthStart, dl.MonthEnd)\n),\nFilledMonths AS (\n    SELECT \n        m.MonthDate,\n        MAX(t.TransactionValue) OVER (PARTITION BY DATEADD(month, DATEDIFF(month, 0, m.MonthDate), 0)\n                                      ORDER BY t.TransactionDate ROWS UNBOUNDED PRECEDING\n                                     ) AS TransactionValue\n    FROM Months m\n    LEFT JOIN Transactions t ON m.MonthDate <= t.TransactionDate AND DATEADD(MONTH, 1, m.MonthDate) > t.TransactionDate\n)\n\nSELECT \n    FORMAT(FilledMonths.MonthDate, 'M/yyyy') AS [Month],\n    FilledMonths.TransactionValue AS Value\nFROM \n    FilledMonths\nORDER BY \n    FilledMonths.MonthDate;