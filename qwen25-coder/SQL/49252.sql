-- This is an example assuming you have a way to generate dates between two points\nWITH RECURSIVE DateSeries AS (\n    SELECT MIN(order_date) AS dt, 1 as cnt\n    FROM Order\n    UNION ALL\n    SELECT DATE_ADD(dt, INTERVAL 1 DAY), cnt + 1\n    FROM DateSeries, (SELECT MAX(LEADTIME_DAYS*2) max_days from LeadTime) lt -- Adjusted interval based on max lead time\n    WHERE dt < DATE_ADD(MIN(order_date), INTERVAL lt.max_days DAY)\n)\n\n-- Create working days by excluding weekends and holidays\nSELECT ds.dt as calendar_date,\n       NOT WEEKDAY(ds.dt) IN (5,6) AND ds.dt not in (SELECT holiday_date FROM OffDays) AS is_working_day\nINTO TEMPORARY TABLE CalendarTable\nFROM DateSeries ds, Order o, LeadTime l\nWHERE ds.cnt <= l.leadtime_days*2 -- Make sure you have enough days\nOPTION(MAXRECURSION 0);