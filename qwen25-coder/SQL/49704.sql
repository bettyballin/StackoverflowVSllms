WITH SessionFirstPage AS (\n    SELECT \n        pv1.sessionid,\n        MIN(pv1.created) as created,\n        pv1.path as firstpagepath  -- Capture the path of the first page in this session\n    FROM \n        pageviews pv1 \n    INNER JOIN Sessions s1 ON pv1.SessionID = s1.SessionID\n    INNER JOIN Visitors v1 ON s1.VisitorID = v1.VisitorID\n    WHERE \n        pv1.Domain = ISNULL(@Domain, pv1.Domain) AND\n        v1.Campaign = @Campaign\n    GROUP BY \n        pv1.sessionid\n)\nSELECT \n    EntryPage,\n    COUNT(*) as [Count]\nFROM \n    SessionFirstPage sfp  \nGROUP BY \n    EntryPage;