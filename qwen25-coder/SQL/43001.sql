SELECT ...\nFROM [log]\nJOIN [table] ON [log].dimension_id = [table].id\nWHERE [table].mode = 0\n\nUNION \n\nSELECT ...\nFROM [log]\nJOIN [table] ON [log].dimension_id = [table].id\nWHERE [table].mode = 1 AND getDate() >= [log].interval_start\n\nUNION\n\nSELECT ...\nFROM [log]\nJOIN [table] ON [log].dimension_id = [table].id\nWHERE [table].mode = 2 AND getDate() >= [log].interval_start + [table].interval_period;