CREATE VIEW UserPropertiesView AS\nSELECT \n    u.Name,\n    u.Age,\n    MAX(CASE WHEN pc.PropertyCodeID = 1 THEN pcv.PropertValue END) AS Property1Value,\n    MAX(CASE WHEN pc.PropertyCodeID = 2 THEN pcv.PropertValue END) AS Property2Value\nFROM \n    User u\nJOIN \n    UserPropertyValues upv ON u.UserID = upv.UserID\nJOIN \n    PropertyCodes pc ON upv.PropertyCodeValueID = pcvc.PropertyCodeValueID\nJOIN \n    PropertyCodeValues pcvc ON upv.PropertyCodeValueID = pcvc.PropertyCodeValueID\nGROUP BY \n    u.Name, u.Age;