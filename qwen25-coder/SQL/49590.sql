SET NOCOUNT ON;\nDECLARE @BatchSize INT = 50000; -- Adjust the batch size as needed\nWHILE (1 = 1) BEGIN\n    WITH RankedRecords AS (\n        SELECT TOP (@BatchSize)\n            RecordID,\n            Row_Number() OVER (Partition BY BusinessName, latitude, longitude, Phone \n                               ORDER BY webaddress DESC, caption1 DESC, caption2 DESC) as rn\n        FROM tl_acxiomimport.dbo.tblacxiomlistings WITH (ROWLOCK)\n    )\n    DELETE FROM RankedRecords WHERE rn > 1;\n\n    IF @@ROWCOUNT < @BatchSize BREAK;\nEND;\nSET NOCOUNT OFF;