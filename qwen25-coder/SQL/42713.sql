SELECT \n    astats.AQTORStatsID, \n    astats.ServerName, \n    astats.Remarks, \n    astats.StatsBeginDateTime, \n    astats.StatsEndDateTime,\n    QtCPU_Average = MAX(CASE WHEN asi.AQTORStatName = 'QtCPU_Average' THEN asi.AQTORStatValue END),\n    QtCPU_TopQuintile = MAX(CASE WHEN asi.AQTORStatName = 'QtCPU_TopQuintile' THEN asi.AQTORStatValue END),\n    QtCPU_TopOnePercent = MAX(CASE WHEN asi.AQTORStatName = 'QtCPU_TopOnePercent' THEN asi.AQTORStatValue END),\n    QtCl_Average = MAX(CASE WHEN asi.AQTORStatName = 'QtCl_Average' THEN asi.AQTORStatValue END),\n    QtCl_TopQuintile = MAX(CASE WHEN asi.AQTORStatName = 'QtCl_TopQuintile' THEN asi.AQTORStatValue END),\n    QtCl_TopOnePercent = MAX(CASE WHEN asi.AQTORStatName = 'QtCl_TopOnePercent' THEN asi.AQTORStatValue END),\n    UpdPrcStd_Average = MAX(CASE WHEN asi.AQTORStatName = 'UpdPrcStd_Average' THEN asi.AQTORStatValue END),\n    UpdPrcStd_TopQuintile = MAX(CASE WHEN asi.AQTORStatName = 'UpdPrcStd_TopQuintile' THEN asi.AQTORStatValue END),\n    UpdPrcStd_TopOnePercent = MAX(CASE WHEN asi.AQTORStatName = 'UpdPrcStd_TopOnePercent' THEN asi.AQTORStatValue END),\n    RcRsUPr_Average = MAX(CASE WHEN asi.AQTORStatName = 'RcRsUPr_Average' THEN asi.AQTORStatValue END),\n    RcRsUPr_TopQuintile = MAX(CASE WHEN asi.AQTORStatName = 'RcRsUPr_TopQuintile' THEN asi.AQTORStatValue END),\n    RcRsUPr_TopOnePercent = MAX(CASE WHEN asi.AQTORStatName = 'RcRsUPr_TopOnePercent' THEN asi.AQTORStatValue END)\nFROM \n    tb_dAQTORStats astats\nINNER JOIN \n    tb_rAQTORStatsItem asi ON astats.AQTORStatsID = asi.AQTORStatsID\nGROUP BY \n    astats.AQTORStatsID, \n    astats.ServerName, \n    astats.Remarks, \n    astats.StatsBeginDateTime, \n    astats.StatsEndDateTime;