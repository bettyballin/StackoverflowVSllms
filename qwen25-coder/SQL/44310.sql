WITH RankedData AS (\n    SELECT \n        GROUP_ID,\n        ID,\n        VALUE,\n        ROW_NUMBER() OVER (PARTITION BY GROUP_ID ORDER BY ID) - 1 AS ParentID\n    FROM \n        YourTable\n)\nSELECT \n    RD.ID,\n    CASE WHEN ParentID = 0 THEN 0 ELSE \n         MAX(RD2.ID) END AS Parent,\n    RD.VALUE\nFROM \n    RankedData RD\nLEFT JOIN \n    RankedData RD2 ON RD.ParentID = RD2.ROW_NUMBER AND RD.GROUP_ID = RD2.GROUP_ID\nORDER BY \n    GROUP_ID, ID;