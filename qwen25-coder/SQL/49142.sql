WITH ProductOfferMatch AS (\n    SELECT PO, COUNT(DISTINCT PI) as pi_count_for_po\n    FROM your_table\n    GROUP BY PO\n),\nSelectedProductInstances AS (\n    SELECT DISTINCT value::int as PI  -- Assuming the input is a comma-separated string of numbers\n    FROM unnest(string_to_array('10,11,13', ',')) as t(value)  -- Replace '10,11,13' with your input\n)\nSELECT PO\nFROM ProductOfferMatch pom\nWHERE NOT EXISTS (\n    SELECT 1\n    FROM (SELECT PI FROM SelectedProductInstances EXCEPT SELECT PI FROM your_table WHERE your_table.PO = pom.PO) diff1\n    UNION ALL\n    SELECT 1\n    FROM (SELECT PI FROM your_table WHERE your_table.PO = pom.PO EXCEPT SELECT PI FROM SelectedProductInstances) diff2\n)\nAND pi_count_for_po = (SELECT COUNT(*) FROM SelectedProductInstances);