SELECT t2.name AS level_0,\n       t3.name AS level_1,\n       t4.name AS level_2\nFROM category_paths AS c2p1\nJOIN categories AS t2 ON t2.id = c2p1.ancestor AND c2p1.depth = 0\nLEFT JOIN category_paths AS c2p2 ON c2p2.ancestor = c2p1.descendant\nLEFT JOIN categories AS t3 ON t3.id = c2p2.ancestor AND c2p2.depth > 0\nLEFT JOIN category_paths AS c2p3 ON c2p3.ancestor = c2p2.descendant\nLEFT JOIN categories AS t4 ON t4.id = c2p3.ancestor AND c2p3.depth > 1;