UPDATE T1\nSET WorkerName = \n    CASE \n        WHEN CHARINDEX(',', T1.WorkerName) > 0 THEN \n            (SELECT TOP 1 T2.WorkerID \n             FROM T2 \n             WHERE LEFT(T1.WorkerName, CHARINDEX(',', T1.WorkerName) - 1) = T2.WorkerName)\n        ELSE \n            (SELECT TOP 1 T2.WorkerID \n             FROM T2 \n             WHERE T1.WorkerName = T2.WorkerName)\n    END\nFROM Table1 AS T1;