CREATE FUNCTION fnGetOpManualXMLDataFromInt \n(   \n    @valueXPath varchar(255), \n    @criteriaXPath varchar(255),\n    @intCriteriaVal int\n)\nRETURNS @returntable TABLE \n(\n    omId int,\n    xmlNodes xml\n)\nAS\nBEGIN\n\nINSERT INTO @returntable (omId, xmlNodes)\nSELECT \n    omID,\n    omText.query(N'(' + CAST(@valueXPath AS NVARCHAR(MAX)) + N')')\nFROM \n    dbo.htOperationsManuals\nWHERE \n    omText.value(CAST(@criteriaXPath AS NVARCHAR(MAX)), 'int') = @intCriteriaVal\n\nRETURN\nEND