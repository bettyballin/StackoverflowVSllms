WITH RevisionIds AS (\n    SELECT c.CreatedAt AS RevisionId \n    FROM Countries AS c \n    WHERE c.LocalId = @Country\n\n    UNION \n\n    SELECT p.CreatedAt AS RevisionId \n    FROM Provinces AS p \n    INNER JOIN Countries AS c ON p.CountryId = c.LocalId \n    WHERE c.LocalId = @Country\n\n    UNION\n\n    SELECT c.RemovedAt AS RevisionId \n    FROM Countries AS c \n    WHERE c.LocalId = @Country\n    AND c.RemovedAt IS NOT NULL  -- Ensure RemovedAt has a value\n\n    UNION\n\n    SELECT p.RemovedAt AS RevisionId \n    FROM Provinces AS p \n    INNER JOIN Countries AS c ON p.CountryId = c.LocalId \n    WHERE c.LocalId = @Country\n    AND p.RemovedAt IS NOT NULL  -- Ensure RemovedAt has a value\n)\nSELECT DISTINCT RevisionId FROM RevisionIds;