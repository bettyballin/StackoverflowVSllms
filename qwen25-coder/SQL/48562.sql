WITH RECURSIVE_DEPENDENCIES AS (\n    -- Anchor member: start with the root table\n    SELECT \n        ac.constraint_name,\n        ac.table_name as referenced_table,\n        acc.column_name as referenced_column,\n        acc_pk.table_name as referencing_table,\n        acc_pk.column_name as referencing_column,\n        0 as depth, -- To track the depth in recursion\n        ac.table_name || '.' || acc.column_name as path_info -- For debugging and tracking paths\n    FROM \n        all_constraints ac\n    JOIN \n        all_cons_columns acc ON ac.constraint_name = acc.constraint_name AND ac.owner = acc.owner\n    LEFT JOIN ( -- for primary keys of referenced table which should match foreign key in referencing table\n        SELECT * \n        FROM all_cons_columns \n        WHERE constraint_type = 'P'\n    ) acc_pk ON ac.r_constraint_name = acc_pk.constraint_name AND ac.r_owner = acc_pk.owner AND acc.position = acc_pk.position\n    WHERE \n        ac.constraint_type = 'R' -- Only foreign keys constraints\n      AND acc_pk.table_name IS NOT NULL -- Ensure it's referencing a valid table (primary key)\n      AND ac.table_name = :tablename\n    \n    UNION ALL\n    \n    -- Recursive member: find all tables that depend on the current level of dependencies\n    SELECT \n        ac.constraint_name,\n        ac.table_name as referenced_table,\n        acc.column_name as referenced_column,\n        rd.referencing_table as referencing_table,\n        acc_pk.column_name as referencing_column,\n        rd.depth + 1 as depth,\n        rd.path_info || ' -> ' || ac.table_name || '.' || acc.column_name as path_info\n    FROM \n        all_constraints ac\n    JOIN \n        all_cons_columns acc ON ac.constraint_name = acc.constraint_name AND ac.owner = acc.owner\n    LEFT JOIN ( -- for primary keys of referenced table which should match foreign key in referencing table\n        SELECT * \n        FROM all_cons_columns \n        WHERE constraint_type = 'P'\n    ) acc_pk ON ac.r_constraint_name = acc_pk.constraint_name AND ac.r_owner = acc_pk.owner AND acc.position = acc_pk.position\n    JOIN \n        RECURSIVE_DEPENDENCIES rd ON ac.table_name = rd.referencing_table\n    WHERE \n        ac.constraint_type = 'R' -- Only foreign keys constraints\n      AND acc_pk.table_name IS NOT NULL -- Ensure it's referencing a valid table (primary key)\n)\n\n-- Finally, select from the CTE to see all dependencies starting from :tablename\nSELECT * FROM RECURSIVE_DEPENDENCIES ORDER BY depth ASC;