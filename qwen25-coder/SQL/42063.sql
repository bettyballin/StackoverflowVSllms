CREATE TRIGGER trg_CheckChildExistsOnDelete\nON ChildTable\nAFTER DELETE\nAS\nBEGIN\n    IF EXISTS (\n        SELECT 1 \n        FROM ParentTable p\n        LEFT JOIN (SELECT DISTINCT parent_id FROM deleted) d ON p.id = d.parent_id\n        WHERE d.parent_id IS NULL\n    )\n    BEGIN\n        RAISERROR ('Cannot delete the last child record associated with a parent.', 16, 1);\n        ROLLBACK TRANSACTION;\n    END\nEND;\n\nCREATE TRIGGER trg_CheckChildExistsOnInsertOrUpdate\nON ChildTable\nAFTER INSERT, UPDATE\nAS\nBEGIN\n    IF EXISTS (\n        SELECT 1 \n        FROM ParentTable p\n        LEFT JOIN inserted d ON p.id = d.parent_id\n        WHERE d.parent_id IS NULL\n    )\n    BEGIN\n        RAISERROR ('No child record exists for this parent.', 16, 1);\n        ROLLBACK TRANSACTION;\n    END\nEND;