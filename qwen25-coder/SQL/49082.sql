WITH NumberedValues AS (\n    SELECT \n        timestamp,\n        value,\n        LAG(value, 1) OVER (ORDER BY timestamp) AS LastValue\n    FROM \n        your_table_name\n),\nDeltas AS (\n    SELECT \n        timestamp,\n        value,\n        LastValue,\n        CASE \n            WHEN LastValue IS NULL OR value >= LastValue THEN (value - COALESCE(LastValue, 0))\n            ELSE 0\n        END AS Delta\n    FROM \n        NumberedValues\n)\nSELECT \n    SUM(Delta) AS TotalDelta\nFROM \n    Deltas;