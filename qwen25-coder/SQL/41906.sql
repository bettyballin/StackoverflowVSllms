-- For Best Articles Today\nSELECT s.story_id, s.story_title,\n       SUM(IF(v.vote_code = 1 AND DATE(v.vote_date) = CURDATE(), 1, 0)) AS votes_yes_today,\n       SUM(IF(v.vote_code = 0 AND DATE(v.vote_date) = CURDATE(), 1, 0)) AS votes_no_today\nFROM stories s\nLEFT JOIN votes v ON s.story_id = v.vote_storyid\nGROUP BY s.story_id, s.story_title\nORDER BY votes_yes_today DESC;\n\n-- For Best Articles This Week\nSELECT s.story_id, s.story_title,\n       SUM(IF(v.vote_code = 1 AND YEARWEEK(v.vote_date) = CONCAT(YEAR(CURDATE()), WEEKOFYEAR(CURDATE())), 1, 0)) AS votes_yes_this_week,\n       SUM(IF(v.vote_code = 0 AND YEARWEEK(v.vote_date) = CONCAT(YEAR(CURDATE()), WEEKOFYEAR(CURDATE())), 1, 0)) AS votes_no_this_week\nFROM stories s\nLEFT JOIN votes v ON s.story_id = v.vote_storyid\nGROUP BY s.story_id, s.story_title\nORDER BY votes_yes_this_week DESC;\n\n-- For Best Articles This Month\nSELECT s.story_id, s.story_title,\n       SUM(IF(v.vote_code = 1 AND YEAR(v.vote_date) = YEAR(CURDATE()) AND MONTH(v.vote_date) = MONTH(CURDATE()), 1, 0)) AS votes_yes_this_month,\n       SUM(IF(v.vote_code = 0 AND YEAR(v.vote_date) = YEAR(CURDATE()) AND MONTH(v.vote_date) = MONTH(CURDATE()), 1, 0)) AS votes_no_this_month\nFROM stories s\nLEFT JOIN votes v ON s.story_id = v.vote_storyid\nGROUP BY s.story_id, s.story_title\nORDER BY votes_yes_this_month DESC;