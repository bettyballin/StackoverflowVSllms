CREATE FUNCTION dbo.fn_RoundTimeToHalfHour (@time TIME)\nRETURNS TIME\nAS\nBEGIN\n    DECLARE @RoundedTime TIME;\n\n    -- Convert the time to minutes since midnight\n    DECLARE @MinutesSinceMidnight INT;\n    SET @MinutesSinceMidnight = DATEPART(HOUR, @time) * 60 + DATEPART(MINUTE, @time);\n\n    -- Round the minutes to the nearest 30\n    SET @MinutesSinceMidnight = (@MinutesSinceMidnight + 15) / 30 * 30;\n\n    -- Convert back to time format\n    SET @RoundedTime = CONVERT(TIME, DATEADD(MINUTE, @MinutesSinceMidnight, '00:00:00'));\n\n    RETURN @RoundedTime;\nEND