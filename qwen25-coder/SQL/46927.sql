-- Replace 'YourTableName' with the name of your table attempting to add foreign key\n-- Replace ' ForeignKeyColumn1', 'ForeignKeyColumn2' with the columns in your table\nDECLARE @ParentTableSchema SYSNAME = 'dbo'; -- Adjust if your tables are not in the dbo schema\nDECLARE @ChildTable SYSNAME = 'YourTableName';\nDECLARE @ChildColumns TABLE (ColumnName SYSNAME);\nINSERT INTO @ChildColumns (ColumnName)\nVALUES ('ForeignKeyColumn1'), ('ForeignKeyColumn2'); -- Add more columns as necessary\n\n-- Find Primary Key columns in the referenced table\nWITH PKCols AS (\n    SELECT \n        kcu.TABLE_NAME AS ReferencedTable,\n        c.COLUMN_NAME\n    FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE kcu\n    INNER JOIN INFORMATION_SCHEMA.TABLE_CONSTRAINTS tc ON kcu.CONSTRAINT_NAME = tc.CONSTRAINT_NAME AND kcu.TABLE_SCHEMA = tc.TABLE_SCHEMA\n    INNER JOIN INFORMATION_SCHEMA.COLUMNS c ON kcu.TABLE_NAME = c.TABLE_NAME AND kcu.COLUMN_NAME = c.COLUMN_NAME\n    WHERE tc.CONSTRAINT_TYPE = 'PRIMARY KEY' \n)\n\n-- Compare the child columns with primary key columns of referenced table(s)\nSELECT cc.ColumnName, 'Column does not match any primary key column in referenced tables.' AS Issue\nFROM @ChildColumns cc\nWHERE NOT EXISTS (\n    SELECT 1 FROM PKCols pkc\n    WHERE cc.ColumnName = pkc.COLUMN_NAME\n);\n\n-- If you also want to check against unique constraints:\nWITH UKCols AS (\n    SELECT \n        kcu.TABLE_NAME AS ReferencedTable,\n        c.COLUMN_NAME\n    FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE kcu\n    INNER JOIN INFORMATION_SCHEMA.TABLE_CONSTRAINTS tc ON kcu.CONSTRAINT_NAME = tc.CONSTRAINT_NAME AND kcu.TABLE_SCHEMA = tc.TABLE_SCHEMA\n    INNER JOIN INFORMATION_SCHEMA.COLUMNS c ON kcu.TABLE_NAME = c.TABLE_NAME AND kcu.COLUMN_NAME = c.COLUMN_NAME\n    WHERE tc.CONSTRAINT_TYPE = 'UNIQUE'\n)\n\nSELECT cc.ColumnName, 'Column does not match any unique constraint column in referenced tables.' AS Issue\nFROM @ChildColumns cc\nWHERE NOT EXISTS (\n    SELECT 1 FROM UKCols ukc\n    WHERE cc.ColumnName = ukc.COLUMN_NAME\n);