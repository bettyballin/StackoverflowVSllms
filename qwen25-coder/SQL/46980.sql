SELECT \n    s.Sale_ID,\n    s.Product_ID,\n    s.Sale_Date,\n    p.Price\nFROM \n    Sales s\nJOIN \n    Prices p ON s.Product_ID = p.Product_ID \n              AND NOT EXISTS (\n                  SELECT 1 \n                  FROM Prices p2 \n                  WHERE p2.Product_ID = s.Product_ID \n                    AND p2.Sale_Date > p.Sale_Date \n                    AND p2.Sale_Date <= s.Sale_Date\n              )\nORDER BY \n    s.Sale_ID;