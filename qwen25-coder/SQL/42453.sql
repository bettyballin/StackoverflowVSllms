WITH Scores AS (\n    SELECT \n        object_id,\n        SUM(vote) AS total_score\n    FROM \n        votes\n    WHERE \n        object_id IN (1, 2)\n    GROUP BY \n        object_id\n),\nMinScoreAdjustment AS (\n    SELECT\n        MIN(total_score) AS min_total_score\n    FROM\n        Scores\n),\nSumAdjustedScores AS (\n    SELECT\n        s.object_id,\n        s.total_score - COALESCE(m.min_total_score, 0) AS adjusted_score\n    FROM\n        Scores s\n    JOIN\n        MinScoreAdjustment m ON 1=1\n)\nSELECT\n    asi.object_id,\n    (asi.adjusted_score / total_adjusted_scores.total_sum) AS normalized_score\nFROM\n    SumAdjustedScores asi\nJOIN (\n    SELECT \n        SUM(adjusted_score) AS total_sum\n    FROM \n        SumAdjustedScores\n) total_adjusted_scores ON 1=1;