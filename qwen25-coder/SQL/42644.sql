select distinct p2c.product_id \nfrom '.TABLE_PRODUCT_TO_CATEGORY.' p2c\ninner join '.TABLE_PRODUCT.' p on p2c.product_id = p.id \ninner join '.TABLE_PRODUCT_TAG.' pt on p.id = pt.product_id\ninner join '.TABLE_TAG_TYPE.' tt on pt.tag_type_id = tt.id\nwhere tt.id = '.PRODUCT_TAG_TYPE_FREE_TAG.'\n  and p.status = 1\n  and lower(pt.value) in ('cats', 'kittens')\ngroup by p2c.product_id\nhaving count(distinct pt.value) = 2;