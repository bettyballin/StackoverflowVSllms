SELECT \n    DATEPART(year, CreateDate) AS Year,\n    DATEPART(month, CreateDate) AS Month,\n    DATEPART(day, CreateDate) AS Day,\n    DATEPART(hour, CreateDate) AS Hour,\n    DATEPART(minute, CreateDate) AS Minute,\n    COUNT(ID) AS MessageCount\nINTO #MinuteAggregation\nFROM \n    Message\nGROUP BY \n    DATEPART(year, CreateDate),\n    DATEPART(month, CreateDate),\n    DATEPART(day, CreateDate),\n    DATEPART(hour, CreateDate),\n    DATEPART(minute, CreateDate)\nORDER BY \n    Year,\n    Month,\n    Day,\n    Hour,\n    Minute;