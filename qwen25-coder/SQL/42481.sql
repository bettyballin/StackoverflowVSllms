-- Update existing rows with matching id in TableA\nUPDATE ta\nSET /* list all columns except the primary key */\n    Column1 = tb.Column1,\n    Column2 = tb.Column2,\n    -- add all other columns from #TableB that need to be updated\nFROM TableA ta\nJOIN #TableB tb ON ta.id = tb.id;\n\n-- Insert new rows not existing in TableA (where there is no match on id)\nINSERT INTO TableA\nSELECT *\nFROM #TableB tb\nWHERE NOT EXISTS (\n    SELECT 1 FROM TableA ta \n    WHERE ta.id = tb.id\n);