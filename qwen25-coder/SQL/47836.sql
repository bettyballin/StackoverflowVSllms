-- First set: match ID AND NAME but different ADDRESS\nWITH Set1 AS (\n    SELECT DISTINCT t1.*\n    FROM table1 t1\n    INNER JOIN table2 t2 ON t2.ID = t1.ID AND t2.NAME = t1.NAME AND t2.ADDRESS <> t1.ADDRESS\n),\n-- Second set: match ID but different NAME and different ADDRESS, exclude those in Set1\nSet2 AS (\n    SELECT DISTINCT t1.*\n    FROM table1 t1\n    INNER JOIN table2 t2 ON t2.ID = t1.ID AND t2.NAME <> t1.NAME AND t2.ADDRESS <> t1.ADDRESS\n    WHERE NOT EXISTS (\n        SELECT 1 FROM Set1 s1 WHERE s1.ID = t1.ID AND s1.NAME = t2.NAME AND s1.ADDRESS <> t2.ADDRESS\n    )\n),\n-- Third set: different ID but matching NAME and different ADDRESS, exclude those in Set1 and Set2\nSet3 AS (\n    SELECT DISTINCT t1.*\n    FROM table1 t1\n    INNER JOIN table2 t2 ON t2.ID <> t1.ID AND t2.NAME = t1.NAME AND t2.ADDRESS <> t1.ADDRESS\n    WHERE NOT EXISTS (\n        SELECT 1 FROM Set1 s1 WHERE s1.ID = t1.ID AND s1.NAME = t2.NAME AND s1.ADDRESS <> t2.ADDRESS\n    )\n    AND NOT EXISTS (\n        SELECT 1 FROM Set2 s2 WHERE s2.ID = t1.ID AND s2.NAME <> t2.NAME AND s2.ADDRESS <> t2.ADDRESS\n    )\n)\n\nSELECT * FROM Set1\nUNION ALL\nSELECT * FROM Set2\nUNION ALL\nSELECT * FROM Set3;