CREATE PROCEDURE mySearchProc\n(\n    @IDCriteria BIGINT = NULL,\n    -- ... other parameters\n    @MaxDateCriteria DATETIME = NULL\n)\nAS\nBEGIN\n    DECLARE @SQL NVARCHAR(MAX);\n\n    SET @SQL = N'SELECT Col1, ..., ColN FROM MyTable WHERE 1=1';\n\n    IF @IDCriteria IS NOT NULL\n        SET @SQL += N' AND ID = @IDCriteria';\n\n    -- ... other conditions\n\n    IF @MaxDateCriteria IS NOT NULL\n        SET @SQL += N' AND Date < @MaxDateCriteria';\n\n    EXEC sp_executesql @SQL, \n                       N'@IDCriteria BIGINT,  ..., @MaxDateCriteria DATETIME',\n                       @IDCriteria = @IDCriteria,\n                       -- ... other parameters\n                       @MaxDateCriteria = @MaxDateCriteria;\nEND;