DECLARE @CurrentDate DATETIME\nSET @CurrentDate = '2008-12-31'  -- Example current date (Wednesday)\n\n-- Get the current issue by weekday name\nSELECT \n    ProdID,\n    ProdName,\n    CurrentIssue.PublishDate AS CurrentPublishDate,\n    PreviousIssue.PublishDate AS PreviousPublishDate\nFROM \n    Product Prod\nJOIN \n    Issue CurrentIssue ON Prod.ProdID = CurrentIssue.ProdID\nLEFT JOIN \n    Issue PreviousIssue ON Prod.ProdID = PreviousIssue.ProdID\nWHERE \n    DATEPART(WEEKDAY, CurrentIssue.PublishDate) = DATEPART(WEEKDAY, @CurrentDate)\nAND \n    (\n        NOT EXISTS(\n            SELECT 1\n            FROM Issue OtherIssue\n            WHERE Prod.ProdID = OtherIssue.ProdID\n              AND OtherIssue.PublishDate < CurrentIssue.PublishDate\n              AND OtherIssue.PublishDate > (SELECT MAX(PublishDate) FROM Issue Prev WHERE Prev.ProdID = Prod.ProdID AND DATEPART(WEEKDAY, Prev.PublishDate) = DATEPART(WEEKDAY, @CurrentDate))\n        )\n    )\nAND \n    (\n        PreviousIssue.PublishDate IS NULL\n        OR NOT EXISTS(\n            SELECT 1\n            FROM Issue OtherPrevIssue\n            WHERE Prod.ProdID = OtherPrevIssue.ProdID\n              AND OtherPrevIssue.PublishDate > PreviousIssue.PublishDate\n              AND OtherPrevIssue.PublishDate < (SELECT MIN(PublishDate) FROM Issue Post WHERE Post.ProdID = Prod.ProdID AND DATEPART(WEEKDAY, Post.PublishDate) = DATEPART(WEEKDAY, @CurrentDate))\n        )\n    )