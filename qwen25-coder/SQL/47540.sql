CREATE OR REPLACE FUNCTION concat_distinct(acc text, instr text)\nRETURNS text AS $$\nDECLARE\n    entries(text[]);\nBEGIN\n    -- Split the accumulated string into an array of distinct entries\n    IF acc IS NOT NULL AND acc <> '' THEN\n        entries := string_to_array(acc, ';');\n    ELSE\n        entries := '{}';\n    END IF;\n\n    -- Check if instr is already in the list to avoid duplicates\n    IF NOT instr = ANY(entries) THEN\n        entries := array_append(entries, instr);\n    END IF;\n\n    -- Join the array back into a single string\n    RETURN array_to_string(entries, ';');\nEND;\n$$ LANGUAGE plpgsql;