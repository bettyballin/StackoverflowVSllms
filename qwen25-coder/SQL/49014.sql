WITH RECURSIVE DateRange(start_date) AS (\n    SELECT '2023-05-01'::date\n    UNION ALL\n    SELECT start_date + INTERVAL '1 day'\n    FROM DateRange\n    WHERE start_date < '2023-05-31'\n),\nPropertyAvailability AS (\n    SELECT \n        p.property_id,\n        dr.start_date,\n        b.booking_start IS NULL AS is_free\n    FROM \n        Property p\n    CROSS JOIN \n        DateRange dr\n    LEFT JOIN \n        Booking b ON p.property_id = b.property_id AND NOT (b.end_date <= dr.start_date OR b.start_date >= dr.start_date + INTERVAL '3 day')\n)\nSELECT \n    property_id,\n    start_date AS free_slot_start,\n    start_date + INTERVAL '2 day' AS free_slot_end\nFROM \n    PropertyAvailability\nWHERE \n    is_free\nGROUP BY \n    property_id, start_date\nHAVING \n    COUNT(*) = 3;