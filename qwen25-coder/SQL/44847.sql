SELECT u2.UserId\nFROM Table1 u1\nJOIN Table1 u2 ON u1.EntityId = u2.EntityId AND u1.UserId = 1\nGROUP BY u2.UserId\nHAVING COUNT(DISTINCT u2.EntityId) = (\n    SELECT COUNT(DISTINCT EntityId)\n    FROM Table1\n    WHERE UserId = 1\n)\nAND NOT EXISTS (\n    SELECT 1\n    FROM Table1 u3\n    WHERE u3.UserId = u2.UserId\n      AND u3.EntityId NOT IN (\n          SELECT EntityId\n          FROM Table1\n          WHERE UserId = 1\n      )\n);