SELECT \n  MAX(CASE WHEN Name = 'N1' THEN Id END) AS Name1,\n  MAX(CASE WHEN Name = 'N2' THEN Id END) AS Name2,\n  MAX(CASE WHEN Name = 'N3' THEN Id END) AS Name3,\n  MAX(CASE WHEN Name = 'N4' THEN Id END) AS Name4\nFROM (\n  SELECT \n    Name, \n    Id, \n    ROW_NUMBER() OVER (PARTITION BY Name ORDER BY Id) as rn -- Assign row numbers based on their order within each group.\n  FROM your_table_name\n) subquery\nGROUP BY rn;