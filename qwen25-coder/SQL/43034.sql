-- Extract DDL for table1, modify paths as necessary\nSPOOL backup_ddl.sql\nSET LINESIZE 32767 PAGESIZE 0 HEAD OFF FEEDBACK OFF ECHO OFF;\n\nPROMPT Creating DDL for table TABLE1\nSELECT DBMS_METADATA.GET_DDL('TABLE', 'TABLE1') FROM DUAL;\n-- For indexes, triggers, constraints etc., you would have to manually collect these.\n\nSPOOL OFF;\n\n-- Export data from table1\nSET HEADING OFF FEEDBACK OFF TERMOUT OFF TRIMSPOOL ON LINESIZE 32767 PAGESIZE 0 ECHO OFF NUMWIDTH 16;\nSPOOL backup_data.sql\n\nPROMPT Inserting data for TABLE1 into BK_TABLE1\nSELECT 'INSERT INTO BK_TABLE1 (' || COLUMN_NAME || '...) VALUES ('\n       || CASE \n              WHEN DATA_TYPE = 'VARCHAR2' THEN '''' || REPLACE(COLUMN_VALUE, '''', '''''') || ''''\n              ELSE COLUMN_VALUE\n          END || ');'\nFROM (\n    SELECT COLUMN_NAME, DATA_TYPE,\n           MAX(\n               DECODE(COLUMN_ID, 1, COLUMN_NAME) ||\n               DECODE(COLUMN_ID, 2, ', ' || COLUMN_NAME) ||\n               ...\n             ) AS COLUMN_LIST,\n           MAX(\n               DECODE(COLUMN_ID, 1, CASE WHEN DATA_TYPE = 'VARCHAR2' THEN '''"' || REPLACE(column_value, '''', '''''') || '"'''\n                                          ELSE column_value END) ||\n               DECODE(COLUMN_ID, 2, ', ' || CASE WHEN DATA_TYPE = 'VARCHAR2' THEN '''"' || REPLACE(column_value, '''', '''''') || '"'''\n                                                 ELSE column_value END) ||\n              ...\n             ) AS COLUMN_VALUES\n    FROM (\n        SELECT A.COLUMN_ID, A.COLUMN_NAME, B.DATA_TYPE,\n               CASE \n                   WHEN A.DATA_TYPE = 'NUMBER' THEN TO_CHAR(A.COLUMN_VALUE)\n                   WHEN A.DATA_TYPE = 'VARCHAR2' THEN '"' || REPLACE(A.COLUMN_VALUE, '"', '""') || '"'\n                   WHEN A.DATA_TYPE = 'DATE' THEN '''"''||TO_CHAR(A.COLUMN_VALUE, ''YYYY-MM-DD HH24:MI:SS'')||''"''''\n               END AS COLUMN_VALUE\n        FROM DBA_TAB_COLUMNS A\n             JOIN USER_TAB_COLUMNS B ON A.TABLE_NAME = B.TABLE_NAME AND A.COLUMN_ID = B.COLUMN_ID\n             WHERE A.TABLE_NAME = 'TABLE1'\n    )\nGROUP BY TABLE_NAME;\n\nSPOOL OFF;