-- List all users and their roles in SQL Server 2000 & 2005\nSELECT \n    l.name AS [User],\n    g.name AS [Role]\nFROM sysusers l\nJOIN sysmembers m ON l.uid = m.memberuid\nJOIN sysobjects o ON m.groupuid = o.id\nJOIN syslogins g ON o.sid = g.sid\nORDER BY [User], [Role];\n\n-- List all permissions granted to roles in SQL Server 2005\nSELECT \n    dp.role_principal_id, \n    sp.name AS [Role],\n    dpm.permission_name, \n    dpm.state_desc\nFROM sys.database_permissions dpm\nJOIN sys.database_principals dp ON dpm.grantee_principal_id = dp.principal_id\nJOIN sys.database_principals sp ON dpm.major_id = sp.principal_id\nWHERE type IN ('R') -- Filter for roles only\nORDER BY [Role], permission_name;\n\n-- List all permissions granted to users in SQL Server 2005\nSELECT \n    dp.principal_id,\n    sp.name AS [User],\n    dpm.permission_name, \n    dpm.state_desc\nFROM sys.database_permissions dpm\nJOIN sys.database_principals dp ON dpm.grantee_principal_id = dp.principal_id\nJOIN sys.database_principals sp ON dp.principal_id = sp.principal_id\nWHERE type IN ('U') -- Filter for users only\nORDER BY [User], permission_name;