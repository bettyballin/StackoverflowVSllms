CREATE TRIGGER tr_RestrictIPConnection ON ALL SERVER FOR LOGON\nAS\nBEGIN\n    IF APP_NAME() = 'SpecificApp'\n    AND NOT EXISTS (\n        SELECT 1 FROM sys.dm_exec_connections ec\n                 INNER JOIN sys.tcp_endpoints AS sce ON ec.endpoint_id = sce.endpoint_id\n                 WHERE session_id = @@SPID \n                 AND client_net_address IN ('192.168.1.1', '192.168.1.2')\n    )\n    BEGIN\n        ROLLBACK;\n    END\nEND;