CREATE PROCEDURE GetSymmetricDifference\n    @TableName1 NVARCHAR(256),\n    @TableName2 NVARCHAR(256)\nAS\nBEGIN\n    DECLARE @PrimaryKeyColumn NVARCHAR(256);\n    DECLARE @SQL NVARCHAR(MAX);\n\n    -- Assume there is a primary key column named 'ID'; you need to adjust this to your actual PK if different.\n    SET @PrimaryKeyColumn = 'ID';\n\n    -- Construct the SQL query dynamically\n    SET @SQL = N'\n    SELECT ''In ' + QUOTENAME(@TableName1) + ''' AS Source, *\n    FROM ' + QUOTENAME(@TableName1) + N' t1\n    LEFT JOIN ' + QUOTENAME(@TableName2) + N' t2 ON t1.' + QUOTENAME(@PrimaryKeyColumn) + N' = t2.' + QUOTENAME(@PrimaryKeyColumn) + N'\n    WHERE t2.' + QUOTENAME(@PrimaryKeyColumn) + N' IS NULL\n\n    UNION ALL\n\n    SELECT ''In ' + QUOTENAME(@TableName2) + ''' AS Source, *\n    FROM ' + QUOTENAME(@TableName2) + N' t2\n    LEFT JOIN ' + QUOTENAME(@TableName1) + N' t1 ON t2.' + QUOTENAME(@PrimaryKeyColumn) + N' = t1.' + QUOTENAME(@PrimaryKeyColumn) + N'\n    WHERE t1.' + QUOTENAME(@PrimaryKeyColumn) + N' IS NULL;';\n\n    -- Execute the dynamic SQL\n    EXEC sp_executesql @SQL;\nEND;