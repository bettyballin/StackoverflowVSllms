SELECT \n    entries.entry_id, \n    entries.title, \n    entries.content,\n    entries.preview_image, \n    entries.preview_thumbnail, \n    entries.slug,\n    entries.view_count, \n    entries.posted_on, \n    entry_categories.title AS category_title,\n    entry_categories.slug AS category_slug, \n    entry_categories.parent AS category_parent,\n    entry_categories.can_comment AS can_comment, \n    entry_categories.can_rate AS can_rate,\n    users.user_id, \n    users.group_id, \n    users.username, \n    users.first_name, \n    users.last_name,\n    users.avatar_small, \n    users.avatar_big, \n    users.score AS user_score, \n    COUNT(entry_comments.comment_id) AS comment_count\nFROM entries\nJOIN entry_categories ON entries.category = entry_categories.category_id\nJOIN users ON entries.user_id = users.user_id\nLEFT JOIN entry_comments ON entries.entry_id = entry_comments.entry_id\nAND `entry_comments`.`publish` = 'Y' -- Move the condition here\nAND `entry_comments`.`deleted_at` IS NULL -- Move the condition here\nWHERE `entries`.`publish` = 'Y'\nAND `category` = 5\nGROUP BY \n    entries.entry_id, \n    entries.title, \n    entries.content,\n    entries.preview_image, \n    entries.preview_thumbnail, \n    entries.slug,\n    entries.view_count, \n    entries.posted_on, \n    category_title, \n    category_slug,\n    category_parent, \n    can_comment, \n    can_rate, \n    users.user_id, \n    users.group_id,\n    users.username, \n    users.first_name, \n    users.last_name, \n    users.avatar_big,\n    users.avatar_small, \n    user_score\nORDER BY posted_on DESC;