CREATE PROCEDURE ConvertSpExecuteSqlToQuery\n    @Input NVARCHAR(MAX)\nAS\nBEGIN\n    DECLARE \n        @SQL NVARCHAR(MAX) = '',\n        @Parameters NVARCHAR(MAX),\n        @ValuesPart NVARCHAR(MAX),\n        @Start INT,\n        @End INT;\n\n    -- Extracting the main query part\n    SET @Start = CHARINDEX(N'N''', @Input);\n    IF (@Start > 0)\n    BEGIN\n        SET @Start = @Start + 2;\n        SET @End = CHARINDEX(N'''', @Input, @Start);\n        IF (@End > 0)\n        BEGIN\n            SET @SQL = SUBSTRING(@Input, @Start, @End - @Start);\n        END\n    END\n\n    -- Extracting parameters declaration part\n    SET @Start = CHARINDEX(N'N''@someParameter', @Input, @End);\n    IF (@Start > 0)\n    BEGIN\n        SET @Start = @Start + 1;\n        SET @End = CHARINDEX(N')', @Input, @Start);\n        IF (@End > 0)\n        BEGIN\n            SET @Parameters = SUBSTRING(@Input, @Start, @End - @Start);\n        END\n    END\n\n    -- Extracting parameters values part\n    SET @Start = CHARINDEX(N'@ someParameter = ', @Input, @End);\n    IF (@Start > 0)\n    BEGIN\n        SET @ValuesPart = SUBSTRING(@Input, @Start + LEN('@ '), LEN(@Input));\n    END\n\n    -- Construct the final query with declared parameters\n    SET @SQL = 'DECLARE ' + @Parameters + '; SET ' + REPLACE(@ValuesPart,',', '; SET ') + ';' + @SQL;\n\n    PRINT @SQL;\nEND