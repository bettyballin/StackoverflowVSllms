SELECT deptno,\n       empno,\n       hiredate,\n       COUNT(*) OVER (PARTITION BY deptno \n                      ORDER BY hiredate\n                      RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_hired_before_range_current_row,\n       COUNT(*) OVER (PARTITION BY deptno \n                      ORDER BY hiredate\n                      ROWS BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_hired_before_rows_0_preceding,\n       COUNT(*) OVER (PARTITION BY deptno \n                      ORDER BY hiredate\n                      RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_hired_before_range_0_preceding\nFROM emp\nWHERE deptno = 30\nORDER BY deptno, hiredate;