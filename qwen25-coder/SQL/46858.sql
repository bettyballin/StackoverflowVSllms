SELECT \n  CASE \n    WHEN ssc.name IS NOT NULL THEN CONCAT(c.name, ' > ', sc.name, ' > ', ssc.name)\n    WHEN sc.name IS NOT NULL THEN CONCAT(c.name, ' > ', sc.name)\n    ELSE c.name\n  END AS full_path\nFROM (\n    SELECT c.id, c.name, NULL AS subcat_id, NULL AS subcategory_name, NULL AS subsubcat_id, NULL AS subsubcategory_name\n    FROM categories c\n    \n    UNION ALL\n    \n    SELECT c.id, c.name, sc.id, sc.name, NULL, NULL\n    FROM categories c\n    LEFT JOIN subcategories sc ON c.id = sc.category_id\n    WHERE sc.id IS NOT NULL\n    \n    UNION ALL\n    \n    SELECT c.id, c.name, sc.id, sc.name, ssc.id, ssc.name\n    FROM categories c\n    JOIN subcategories sc ON c.id = sc.category_id\n    JOIN subsubcategories ssc ON sc.id = ssc.subcategory_id\n) AS combined\nORDER BY id, subcat_id, subsubcat_id;