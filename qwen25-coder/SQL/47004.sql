DECLARE @OldName NVARCHAR(128), @NewName NVARCHAR(128)\nSET @OldName = N'tblFoo'\nSET @NewName = N'tblFooBar'\n\n-- Step 1: Rename table\nEXEC sp_rename @OldName, @NewName\n\n-- Step 2 & 3: Get current primary key constraint name and drop it\nDECLARE @OldPKConstraint NVARCHAR(128)\nSELECT \n    @OldPKConstraint = CONSTRAINT_NAME\nFROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS\nWHERE TABLE_NAME=@NewName AND CONSTRAINT_TYPE='PRIMARY KEY';\n\nIF (@OldPKConstraint IS NOT NULL) BEGIN\n    EXEC ('ALTER TABLE ' + QUOTENAME(@NewName) + ' DROP CONSTRAINT ' + QUOTENAME(@OldPKConstraint))\n\n    -- Recreate primary key with the new name\n    DECLARE @NewPKConstraint NVARCHAR(128)\n    SET @NewPKConstraint = REPLACE(@OldPKConstraint, @OldName, @NewName)\n\n    EXEC ('ALTER TABLE ' + QUOTENAME(@NewName) + \n          ' ADD CONSTRAINT ' + QUOTENAME(@NewPKConstraint) + \n          ' PRIMARY KEY CLUSTERED (YourPrimaryKeyColumn)')\nEND\n\n-- Step 4: Update each foreign key constraint that references the old table\nDECLARE @ForeignKeys TABLE (\n    Constraint_Name NVARCHAR(128),\n    Table_Schema NVARCHAR(128),\n    Table_Name NVARCHAR(128)\n)\n\nINSERT INTO @ForeignKeys (Constraint_Name, Table_Schema, Table_Name) \nSELECT \n    CONSTRAINT_NAME,\n    TABLE_SCHEMA,\n    TABLE_NAME\nFROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS RC \nINNER JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE KU ON RC.CONSTRAINT_NAME = KU.CONSTRAINT_NAME \nWHERE REFERENCED_TABLE_NAME = @NewName\n\nDECLARE @ConstraintName NVARCHAR(128), \n        @SchemaName NVARCHAR(128),\n        @TableName NVARCHAR(128)\n\nWHILE EXISTS (SELECT 1 FROM @ForeignKeys)\nBEGIN\n    SELECT TOP 1 \n        @ConstraintName = Constraint_Name, \n        @SchemaName = Table_Schema,\n        @TableName = Table_Name \n    FROM @ForeignKeys\n\n    -- Recreate the foreign key with the new name\n    DECLARE @NewForeignKey NVARCHAR(128) = REPLACE(@ConstraintName, @OldName, @NewName)\n\n    EXEC ('ALTER TABLE ' + QUOTENAME(@SchemaName) + '.' + QUOTENAME(@TableName) +\n          ' DROP CONSTRAINT ' + QUOTENAME(@ConstraintName))\n\n    -- Recreate the foreign key\n    EXEC ('ALTER TABLE ' + QUOTENAME(@SchemaName) + '.' + QUOTENAME(@TableName) +\n          ' ADD CONSTRAINT ' + QUOTENAME(@NewForeignKey) +\n          ' FOREIGN KEY (YourForeignKeyColumn) REFERENCES ' + QUOTENAME(@NewName) + '(YourPrimaryKeyColumn)')\n\n    DELETE FROM @ForeignKeys WHERE Constraint_Name = @ConstraintName\nEND