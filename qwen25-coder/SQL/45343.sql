WITH app_coverage AS (\n    SELECT \n        s.id_app,\n        COUNT(DISTINCT s.id_profile) AS skilled_profiles_count\n    FROM \n        SKILL s\n    WHERE \n        s.lvl >= 2\n    GROUP BY \n        s.id_app\n    HAVING \n        COUNT(DISTINCT s.id_profile) >= 2\n)\nSELECT \n    (COUNT(ac.id_app) * 100.0 / COUNT(a.id)) AS coverage_percentage\nFROM \n    app_coverage ac\nCROSS JOIN \n    APP a;