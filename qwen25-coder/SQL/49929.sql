WITH RECURSIVE ReportingUnitHierarchy AS (\n    -- Anchor member: Select the root reporting unit\n    SELECT Key, ParentReportingUnitKey\n    FROM ReportingUnit\n    WHERE Key = 'R1'\n    UNION ALL\n    -- Recursive member: Select child reporting units\n    SELECT ru.Key, ru.ParentReportingUnitKey\n    FROM ReportingUnit ru\n    INNER JOIN ReportingUnitHierarchy rhu ON ru.ParentReportingUnitKey = rhu.Key\n)\n-- Main query to get all facilities under the selected reporting unit hierarchy\nSELECT f.*\nFROM Facility f\nINNER JOIN ReportingUnitHierarchy rh ON f.ParentReportingUnitKey = rh.Key;