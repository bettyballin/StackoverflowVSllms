DECLARE @next INT = 0; -- Use INT for object IDs\nDECLARE @owner NVARCHAR(128);\nDECLARE @t NVARCHAR(256); -- Hold full table name\nDECLARE @SQL NVARCHAR(MAX); -- To hold the dynamic SQL\n\nWHILE 1=1\nBEGIN\n    SELECT TOP 1 \n        @next = o.id, -- Use o.id directly as it's an INT\n        @owner = u.name\n    FROM sys.columns c\n    INNER JOIN sys.objects o ON c.object_id = o.object_id\n    LEFT JOIN sys.schemas u ON o.schema_id = u.schema_id -- Use sys.schemas for schema (owner) names\n    WHERE c.name = 'criteria1' \n      AND o.id > @next \n    ORDER BY o.id;\n\n    IF @next IS NULL\n        BREAK;\n    ELSE\n    BEGIN\n        SET @t = QUOTENAME(@owner) + '.' + QUOTENAME(OBJECT_NAME(@next)); -- Safely handle schema and table names\n        SET @SQL = N'SELECT criteria1 FROM ' + @t + N' WHERE linenum = 1';\n        \n        EXEC sp_executesql @SQL;\n    END\nEND