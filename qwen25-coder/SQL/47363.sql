SELECT \n    CASE \n        WHEN LENGTH(fullname) - LENGTH(REPLACE(fullname, ' ', '')) = 2 THEN SUBSTRING_INDEX(SUBSTRING_INDEX(fullname, ' ', 1), ' ', -1)\n        ELSE SUBSTRING_INDEX(fullname, ' ', 1)\n    END AS first_name,\n    CASE \n        WHEN LENGTH(fullname) - LENGTH(REPLACE(fullname, ' ', '')) = 2 THEN SUBSTRING_INDEX(SUBSTRING_INDEX(fullname, ' ', 2), ' ', -1)\n        ELSE ''\n    END AS middle_name,\n    CASE \n        WHEN LENGTH(fullname) - LENGTH(REPLACE(fullname, ' ', '')) > 0 THEN SUBSTRING_INDEX(fullname, ' ', -1)\n        ELSE fullname\n    END AS last_name\nFROM your_table_name;