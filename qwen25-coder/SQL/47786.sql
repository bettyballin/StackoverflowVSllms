SELECT \n    r.`name`, \n    r.`latitude`, \n    r.`longitude`, \n    r.`indoor`, \n    r.`address`,\n    r.`phone`, \n    r.`email`, \n    r.`website`, \n    r.`closed`,\n    GROUP_CONCAT(rt.type SEPARATOR ', ') AS types\nFROM \n    rocks r\nINNER JOIN \n    (\n        SELECT DISTINCT id \n        FROM rock_types \n        WHERE type = "DWS" OR type = "Top rope"\n    ) AS filtered_types ON r.id = filtered_types.id\nLEFT JOIN \n    rock_types rt ON r.id = rt.id\nWHERE \n    (r.latitude > -180 AND r.latitude < 180) \n    AND (r.longitude > -180 AND r.longitude < 180)\nGROUP BY \n    r.`name`, \n    r.`latitude`, \n    r.`longitude`, \n    r.`indoor`, \n    r.`address`,\n    r.`phone`, \n    r.`email`, \n    r.`website`, \n    r.`closed`;