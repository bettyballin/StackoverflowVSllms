WITH DateRange AS (\n    SELECT TRUNC(SYSDATE - LEVEL + 1, 'MM') + INTERVAL '1' MONTH - INTERVAL '1' DAY AS last_day_of_month\n    FROM DUAL\n    CONNECT BY LEVEL <= 12\n),\nMaxDates AS (\n    SELECT fd.cust_id,\n           Trunc(fd.coll_date) AS coll_date,\n           Last_Value(Trunc(fd.coll_date)) OVER (PARTITION BY Trunc(fd.coll_date, 'MM')\n                                                 ORDER BY fd.coll_date ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS max_coll_date\n    FROM super_table fd\n    WHERE fd.cust_id = :CUST_ID\n      AND fd.coll_date >= SYSDATE - 365\n)\nSELECT md.cust_id,\n       md.server_name,\n       md.instance_name,\n       md.max_coll_date AS coll_date,\n       md.column_name\nFROM MaxDates md\nJOIN DateRange dr ON md.max_coll_date = dr.last_day_of_month\nGROUP BY md.cust_id, md.server_name, md.instance_name, md.max_coll_date, md.column_name\nORDER BY md.server_name, md.instance_name, md.max_coll_date;