CREATE OR REPLACE FUNCTION find_final_redirect(start_id INTEGER) RETURNS INTEGER AS $$\nDECLARE\n    current_id INTEGER := start_id;\n    next_id INTEGER;\nBEGIN\n    LOOP\n        SELECT redirectid INTO next_id FROM your_table WHERE id = current_id;\n        \n        EXIT WHEN next_id IS NULL;\n        \n        current_id := next_id;\n    END LOOP;\n    \n    RETURN current_id;\nEND;\n$$ LANGUAGE plpgsql;