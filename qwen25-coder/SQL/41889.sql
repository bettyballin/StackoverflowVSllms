WITH SequentialNumbers AS (\n    SELECT MIN(DocumentNumber) + 1 AS Number\n    FROM YourTable\n    UNION ALL\n    SELECT sn.Number + 1\n    FROM SequentialNumbers sn\n    WHERE sn.Number <= (SELECT MAX(DocumentNumber) FROM YourTable)\n)\nSELECT TOP 1 sn.Number AS SmallestUnusedNumber\nFROM SequentialNumbers sn\nLEFT JOIN YourTable t ON sn.Number = t.DocumentNumber\nWHERE t.DocumentNumber IS NULL\nOPTION (MAXRECURSION 0);