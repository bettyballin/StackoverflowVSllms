DECLARE @TotalCount INT;\n\nWITH SelectedItems AS \n(\n    SELECT Id, Row1, Row2, ROW_NUMBER() OVER (ORDER BY Row1) AS Position\n    FROM Items\n    WHERE Row2 = @Row2\n),\nRankedItems AS (\n    SELECT Id, Row1, Row2, Position,\n           COUNT(*) OVER () AS TotalRowCount\n    FROM SelectedItems\n)\nSELECT @TotalCount = MAX(TotalRowCount), Id, Row1, Row2\nINTO #ResultSet\nFROM RankedItems\nWHERE Position BETWEEN @From AND @To;\n\n-- Now you can use @TotalCount as your output parameter and process #ResultSet for the actual results.