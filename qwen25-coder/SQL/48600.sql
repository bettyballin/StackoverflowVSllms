SELECT \n    t.type,\n    SUM(CASE WHEN c.code = 1 THEN 1 ELSE 0 END) AS no_of_times_code1_occurs,\n    ROUND(SUM(CASE WHEN c.code = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(t.`no of times type occurs`), 2) \n        AS percentage_of_type,\n    ROUND(SUM(CASE WHEN c.code = 1 THEN 1 ELSE 0 END) * 100.0 / (SELECT SUM(`no of times code occurs`) FROM codes WHERE code = 1), 2)\n        AS percentage_of_code\nFROM types t\nJOIN codes c ON /* join condition, if any, or simulate with CROSS JOIN */\nWHERE t.type IN (101, 102)  -- Assuming you are interested in type 101 and 102\nGROUP BY t.type;