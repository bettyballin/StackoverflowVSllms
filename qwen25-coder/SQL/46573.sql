SELECT \n    c.CustomerID,\n    SUM(o.Quantity * p.Price) AS SalesVolume1995\nFROM \n    Orders o\nJOIN \n    Products p ON o.PRODUCTID = p.ID#\nWHERE \n    YEAR(o.DATE) = 1995\nGROUP BY \n    c.CustomerID\n\nHAVING \n    c.CustomerID IN (\n        SELECT \n            CustomerID\n        FROM \n            Orders o2\n        JOIN \n            Products p2 ON o2.PRODUCTID = p2.ID#\n        WHERE \n            YEAR(o2.DATE) = 1996\n        GROUP BY \n            o2.CustomerID\n        HAVING \n            SUM(o2.Quantity * p2.Price) > (\n                SELECT \n                    SUM(o3.Quantity * p3.Price)\n                FROM \n                    Orders o3\n                JOIN \n                    Products p3 ON o3.PRODUCTID = p3.ID#\n                WHERE \n                    YEAR(o3.DATE) = 1995 AND o3.CustomerID = c.CustomerID\n            )\n    );