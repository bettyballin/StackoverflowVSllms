WITH daily_transaction_counts AS (\n    SELECT \n        DATE(created) AS transaction_date,\n        COUNT(*) AS num_transactions\n    FROM \n        transactions\n    GROUP BY \n        DATE(created)\n),\ntransaction_categories AS (\n    SELECT \n        transaction_date,\n        num_transactions,\n        FLOOR((num_transactions - 1) / 2) * 2 + 1 AS category_start,\n        FLOOR(num_transactions / 2) * 2 + 2 AS category_end\n    FROM \n        daily_transaction_counts\n)\nSELECT \n    CONCAT(tc.category_start, '-', tc.category_end, ' transactions') AS transaction_range,\n    AVG(t.amount) AS average_amount\nFROM \n    transaction_categories tc\nJOIN \n    transactions t ON DATE(t.created) = tc.transaction_date\nGROUP BY \n    tc.category_start, tc.category_end\nORDER BY \n    tc.category_start;