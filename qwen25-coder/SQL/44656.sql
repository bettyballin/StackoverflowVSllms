-- Step 1: Calculate average RSSI and last ReadTime per readings_miu_id\nSELECT \n    A.readings_miu_id,\n    AVG(A.RSSI) AS AvgRSSI,\n    MAX(A.ReadDate) & ' to ' & MIN(A.ReadDate) AS DateRange,\n    (SELECT TOP 1 B.ReadTime \n     FROM analyzedCopy AS B \n     WHERE B.readings_miu_id = A.readings_miu_id\n       AND B.ReadDate BETWEEN #04/21/09# AND #04/29/09#\n     ORDER BY B.ReadTime DESC) AS LastReadTime\nINTO TempAverageRSSI\nFROM \n    analyzedCopy AS A\nWHERE \n    A.ReadDate BETWEEN #04/21/09# AND #04/29/09#\nGROUP BY \n    A.readings_miu_id;\n\n-- Step 2: Insert into the "analyzed" table from TempAverageRSSI\nINSERT INTO analyzed (\n    readings_miu_id, ReadDate, ReadTime, RSSI) -- Adjust this line according to your actual table schema\nSELECT \n    T.readings_miu_id, \n    T.DateRange AS ReadDate, \n    T.LastReadTime, \n    T.AvgRSSI AS RSSI\nFROM \n    TempAverageRSSI AS T;