CREATE PROCEDURE CopyFolder\n    @SourceFolderID INT,\n    @DestinationFolderID INT\nAS\nBEGIN\n    BEGIN TRANSACTION;\n\n    DECLARE @Offset INT;\n    DECLARE @RootLeft INT;\n    DECLARE @RootRight INT;\n\n    -- Get the left and right values of the source folder to calculate the offset\n    SELECT @RootLeft = LeftValue, @RootRight = RightValue \n    FROM YourTable \n    WHERE NodeID = @SourceFolderID;\n\n    SET @Offset = (SELECT MAX(RightValue) + 1 - @RootLeft FROM YourTable);\n\n    BEGIN TRY\n        -- Copy nodes\n        INSERT INTO YourTable (NodeID, ParentID, LeftValue, RightValue, OtherColumns)\n        SELECT \n            NodeID + @Offset AS NewNodeID,\n            CASE \n                WHEN ParentID = @SourceFolderID THEN @DestinationFolderID + @Offset \n                ELSE ParentID + @Offset \n            END AS NewParentID,\n            LeftValue + @Offset AS NewLeftValue,\n            RightValue + @Offset AS NewRightValue,\n            OtherColumns\n        FROM YourTable\n        WHERE LeftValue >= @RootLeft AND RightValue <= @RootRight;\n\n        COMMIT TRANSACTION;\n    END TRY\n    BEGIN CATCH\n        ROLLBACK TRANSACTION;\n        THROW;  -- Re-throw the caught exception.\n    END CATCH\nEND;