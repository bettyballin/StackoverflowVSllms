DECLARE @NumberDays INT = 90; -- Adjust the number of days as needed\nDECLARE @CurrentDate DATETIME;\nDECLARE @StartDate DATETIME = DATEADD(DAY, -@NumberDays, GETDATE());\nDECLARE @SqlQuery NVARCHAR(MAX) = N'SELECT TOP 1 DateTime, ACMKWHYTD_1 \n                                   FROM WideHistory AS wh \n                                   WHERE wwResolution = 60000 \n                                     AND wwRetrievalMode = ''cyclic'' \n                                     AND (';\n\n-- Build the date-time conditions dynamically\nSET @CurrentDate = @StartDate;\nWHILE @CurrentDate <= GETDATE()\nBEGIN\n    DECLARE @TimeOfDay NVARCHAR(25) = CONVERT(NVARCHAR, DATEADD(HOUR, DATEDIFF(HOUR, 0, GETDATE()), 0), 120); -- Adjust this to your specific time-of-day requirement\n    SET @SqlQuery += N'(wh.DateTime >= ''' + \n                     CONVERT(NVARCHAR, @CurrentDate, 120) + ''' AND ' +\n                     'wh.DateTime < ''' + \n                     CONVERT(NVARCHAR, DATEADD(DAY, 1, @CurrentDate), 120) + ''') OR ';\n    \n    SET @CurrentDate = DATEADD(DAY, 1, @CurrentDate);\nEND;\n\n-- Remove the trailing 'OR' and close the query\nSET @SqlQuery = LEFT(@SqlQuery, LEN(@SqlQuery) - 4) + N')\n                ORDER BY wh.DateTime';\n\nEXEC sp_executesql @SqlQuery;