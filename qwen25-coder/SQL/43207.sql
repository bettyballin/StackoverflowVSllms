WITH FiscalYearData AS (\n    SELECT \n        DATEADD(year, CASE WHEN MONTH([date]) >= 5 THEN 0 ELSE -1 END, DATEFROMPARTS(YEAR([date]), 1, 1)) + 4 AS StartOfYear,\n        [date]\n    FROM logins\n)\nSELECT \n    DATEADD(year, 1, StartOfYear) AS FiscalYearStart,\n    DATEADD(day, -1, DATEADD(year, 2, StartOfYear)) AS FiscalYearEnd,\n    COUNT(*) AS LoginCount\nFROM FiscalYearData\nGROUP BY StartOfYear\nORDER BY StartOfYear;