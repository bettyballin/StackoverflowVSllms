WITH DateRangeWeeks AS (\n    SELECT \n        DATEADD(DAY, (DATEDIFF(WEEK, 0, DATEADD(DAY, -DATEPART(WEEKDAY, '2007-05-29') + 1, '2007-05-29')) * 7), 0) AS StartOfWeek,\n        DATEADD(DAY, (DATEDIFF(WEEK, 0, DATEADD(DAY, -DATEPART(WEEKDAY, '2007-05-29') + 1, '2007-05-29')) * 7) + 6, 0) AS EndOfWeek,\n        0 as WeekNumber\n    UNION ALL\n    SELECT \n        DATEADD(DAY, 7, dr.StartOfWeek),\n        DATEADD(DAY, 13, dr.EndOfWeek),\n        dr.WeekNumber + 1\n    FROM DateRangeWeeks dr\n    WHERE DATEADD(DAY, 7, dr.StartOfWeek) <= '2009-05-29'\n)\nSELECT \n    StartOfWeek,\n    EndOfWeek\nFROM DateRangeWeeks\nOPTION (MAXRECURSION 32767); -- To ensure recursion limit doesn't prevent us from processing enough weeks