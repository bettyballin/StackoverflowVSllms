DELIMITER //\n\nCREATE PROCEDURE GetAncestors(IN starting_node INT)\nBEGIN\n    WITH RECURSIVE Ancestors AS (\n        SELECT parent_node_id, child_node_id\n        FROM hierarchy\n        WHERE child_node_id = starting_node\n        UNION ALL\n        SELECT h.parent_node_id, h.child_node_id\n        FROM hierarchy h\n        INNER JOIN Ancestors a ON h.child_node_id = a.parent_node_id\n    )\n    SELECT * FROM Ancestors;\nEND //\n\nDELIMITER ;