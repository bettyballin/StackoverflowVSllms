DECLARE @sql NVARCHAR(MAX)\n      , @tableName NVARCHAR(128) = 'YourTargetTable' -- Replace with your target table name\n      , @updateDate DATETIME = '2023-05-20 17:00:00' -- Replace with the desired update date\n\n-- Construct dynamic SQL pivot query based on FieldNames for a specific table and update date\nSELECT @sql = N'SELECT * FROM (\n    SELECT PrimaryKeyValue, FieldName, NewValue \n    FROM ERAUser.Audit \n    WHERE TableName = ''' + QUOTENAME(@tableName) + ''' \n      AND UpdateDate = ''' + CONVERT(VARCHAR, @updateDate, 126) + '''\n) AS Source\nPIVOT (\n    MAX(NewValue)\n    FOR FieldName IN (' + STUFF((\n        SELECT DISTINCT ',[' + QUOTENAME(FieldName) + ']'\n        FROM ERAUser.Audit\n        WHERE TableName = @tableName AND UpdateDate = @updateDate\n        ORDER BY FieldName\n        FOR XML PATH(''), TYPE).value('.', 'NVARCHAR(MAX)'), 1, 1, '') + ')\n) AS P'\n\n-- Execute the dynamically constructed SQL query\nEXEC sp_executesql @sql