Create PROCEDURE sp_test\nAS\nBEGIN\n    SET NOCOUNT ON;\n\n    DECLARE @A VARCHAR(255), \n            @B VARCHAR(255), \n            @C VARCHAR(255), \n            @D INT\n\n    DECLARE Table_Cursor CURSOR FOR \n        SELECT A, B, C FROM tbl_Member \n\n    OPEN Table_Cursor\n    FETCH NEXT FROM Table_Cursor INTO @A, @B, @C\n\n    WHILE @@FETCH_STATUS = 0\n    BEGIN\n        -- Insert into NewMember and get new IDENTITY value directly\n        INSERT INTO NewMember (A, B, C) \n        VALUES (@A, @B, @C)\n\n        SET @D = SCOPE_IDENTITY()\n\n        -- Insert into MemberId using the newly obtained ID\n        INSERT INTO MemberId (Mid) \n        VALUES(@D)\n\n        FETCH NEXT FROM Table_Cursor INTO @A, @B, @C\n    END\n\n    CLOSE Table_Cursor\n    DEALLOCATE Table_Cursor\nEND\nGO