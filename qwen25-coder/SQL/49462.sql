SELECT c.category_id, c.username, c.text, c.created_at\nFROM (\n    SELECT category_id, username, text, created_at,\n           @row_number:=CASE WHEN @current_category = category_id THEN @row_number + 1 ELSE 1 END AS row_num,\n           @current_category := category_id\n    FROM comments\n    ORDER BY category_id, created_at DESC\n) c\nJOIN categories cat ON c.category_id = cat.id\nWHERE c.row_num <= 5\nORDER BY c.category_id, c.created_at DESC;