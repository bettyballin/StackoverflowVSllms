WITH MinData AS (\n    SELECT \n        MIN(datepart(year, [Registration])) OVER (PARTITION BY Model, Make) AS MinYearRegistered,\n        MIN(SalePrice) OVER (PARTITION BY Model, Make) AS MinSalePrice,\n        datepart(year, [Registration]) AS YearRegistered,\n        SalePrice,\n        Model, \n        Make\n    FROM \n        VehicleSales\n)\nSELECT DISTINCT\n    MinYearRegistered AS YearRegistered,\n    MinSalePrice AS SalePrice,\n    Model, \n    Make\nFROM \n    MinData\nWHERE \n    YearRegistered = MinYearRegistered AND SalePrice = MinSalePrice;