-- Step 1: Create the new Name table\nCREATE TABLE Name (\n    Id INT IDENTITY(1,1) PRIMARY KEY,\n    Name NVARCHAR(255) NOT NULL UNIQUE\n);\n\n-- Step 2: Insert distinct names into the Name table\nINSERT INTO Name (Name)\nSELECT DISTINCT Name FROM Contacts;\n\n-- Step 3: Add a foreign key column to the Contacts table\nALTER TABLE Contacts\nADD NameId INT;\n\n-- Step 4: Update the Contacts table with the corresponding NameId\nUPDATE C\nSET C.NameId = N.Id\nFROM Contacts C\nJOIN Name N ON C.Name = N.Name;\n\n-- Optional Step: Remove or deprecate the original Name column if not needed anymore\n-- This is optional and depends on your requirements\n-- ALTER TABLE Contacts DROP COLUMN Name;