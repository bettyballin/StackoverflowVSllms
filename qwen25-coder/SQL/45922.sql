WITH RankedData AS (\n    SELECT \n        alternative_id, \n        indicator_id,\n        CAST(rank AS VARCHAR) AS rank_str\n    FROM \n        rankings\n    WHERE \n        analysis_id IN (1, 2) -- Use your list of analysis IDs here\n)\n\nSELECT \n    rd.alternative_id, \n    rd.indicator_id,\n    STUFF((\n            SELECT ', ' + rank_str \n            FROM RankedData AS rdSub \n            WHERE rdSub.alternative_id = rd.alternative_id AND rdSub.indicator_id = rd.indicator_id\n            ORDER BY rank_str \n            FOR XML PATH(''), TYPE).value('.', 'NVARCHAR(MAX)'), 1, 2, '') AS ranks\nFROM \n    RankedData AS rd\nGROUP BY \n    rd.alternative_id, \n    rd.indicator_id\nHAVING \n    COUNT(DISTINCT rd.rank) > 1;