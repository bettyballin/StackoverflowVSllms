CREATE FUNCTION dbo.SplitStringToWords(@String NVARCHAR(MAX), @Delimiter CHAR(1))\nRETURNS TABLE \nRETURN \n(\n    WITH Splitting AS (\n        SELECT CASE WHEN CHARINDEX(@Delimiter, @String) = 0 THEN @String ELSE LEFT(@String, CHARINDEX(@Delimiter, @String) - 1) END word,\n               CASE WHEN CHARINDEX(@Delimiter, @String) = 0 THEN '' ELSE RIGHT(@String, LEN(@String) - CHARINDEX(@Delimiter, @String)) END remaining\n        UNION ALL\n        SELECT CASE WHEN CHARINDEX(@Delimiter, remaining) = 0 THEN remaining ELSE LEFT(remaining, CHARINDEX(@Delimiter, remaining) - 1) END word,\n               CASE WHEN CHARINDEX(@Delimiter, remaining) = 0 THEN '' ELSE RIGHT(remaining, LEN(remaining) - CHARINDEX(@Delimiter, remaining)) END remaining\n        FROM Splitting \n        WHERE LEN(remaining) > 0\n    )\n    SELECT LTRIM(RTRIM(word)) AS Word\n    FROM Splitting\n    WHERE LEN(LTRIM(RTRIM(word))) > 0\n)\nOPTION (MAXRECURSION 0);