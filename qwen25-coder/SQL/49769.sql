SELECT pe.prodtree_element_id AS prodID, \n       pe.prodtree_element_name_s, \n       li.line_name, \n       av2.value\nFROM prodtree_element pe WITH (INDEX(PK_prodtree_element)) -- Assume PK_prodtree_element is the clustered index or relevant non-clustered index\nLEFT JOIN prodtree_link pl ON pe.prodtree_element_id = pl.to_prodtree_node_id\nLEFT JOIN line li ON pe.line_code = li.line_code\nINNER JOIN attribute_values av ON av.attribute_definition_id = 22 -- Use static value for performance\nLEFT JOIN attribute_values av2 ON pe.prodtree_element_id = av2.prodtree_element_id\nWHERE pe.prodtree_element_func_type <> 'WIZARD'\n  AND pe.prodtree_element_topo_type = 'NODE';