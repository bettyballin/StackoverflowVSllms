SELECT \n    STRING_AGG(\n        CASE WHEN GROUP_ID = 1 THEN NAME + ' (' + COMPANY + ')' ELSE NAME END,\n        ', '\n    ) WITHIN GROUP (ORDER BY GROUP_ID) AS NEWVALUE,\n    [GROUP] AS [GROUP]\nFROM (\n    SELECT \n        ROW_NUMBER() OVER(PARTITION BY [GROUP], SUBSTRING(VALUE, PATINDEX('%[^A-Za-z0-9]%', VALUE) + 1, LEN(VALUE)) \n                          ORDER BY [ID]) AS GROUP_ID,\n        CASE WHEN ROW_NUMBER() OVER(PARTITION BY [GROUP] ORDER BY [ID]) = 2 THEN VALUE END AS NAME,\n        CASE WHEN ROW_NUMBER() OVER(PARTITION BY [GROUP], SUBSTRING(VALUE, PATINDEX('%[^A-Za-z0-9]%', VALUE) + 1, LEN(VALUE)) \n                          ORDER BY [ID]) = 1 THEN VALUE END AS COMPANY,\n        [GROUP]\n    FROM your_table\n) AS subquery\nWHERE NAME IS NOT NULL OR COMPANY IS NOT NULL\nGROUP BY [GROUP];