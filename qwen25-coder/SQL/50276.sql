WITH RECURSIVE minute_intervals AS (\n    SELECT MIN(start_ts) AS interval_start,\n           datetime(MIN(start_ts), '+1 minutes') AS interval_end\n    FROM sessions\n    UNION ALL\n    SELECT interval_start + 60,\n           interval_end + 60\n    FROM minute_intervals\n    WHERE interval_end <= MAX(end_ts)\n)\n\nSELECT strftime('%H:%M', mi.interval_start) AS TIME_INTERVAL,\n       COUNT(DISTINCT s.session_id) AS ACTIVE_SESSIONS\nFROM minute_intervals mi\nLEFT JOIN sessions s ON s.start_ts < mi.interval_end AND s.end_ts >= mi.interval_start\nGROUP BY mi.interval_start\nORDER BY TIME_INTERVAL;