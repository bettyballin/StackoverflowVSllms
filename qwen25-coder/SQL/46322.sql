-- Create an Object Type for Order\nCREATE OR REPLACE TYPE order_obj AS OBJECT (\n    ORDERID NUMBER,\n    OrderDate DATE,\n    TotalAmount NUMBER(10, 2)\n);\n/\n\n-- Create a Table of Order Object\nCREATE OR REPLACE TYPE order_tab AS TABLE OF order_obj;\n/\n\n-- Create an Object Type for Company including Orders as Nested Structure\nCREATE OR REPLACE TYPE company_obj AS OBJECT (\n    COMPANYID NUMBER,\n    CompanyName VARCHAR2(100),\n    OrderRecords order_tab\n);\n/\n\n-- Create a Table of Company Objects\nCREATE OR REPLACE TYPE company_tab AS TABLE OF company_obj;\n/\n\n-- Create a Procedure to Return the Data in the Required Nested Structure\nCREATE OR REPLACE PROCEDURE GETCOMPANYLIST (\n  CompanyDetails OUT company_tab\n) IS\nBEGIN\n  SELECT CAST(MULTISET(\n        SELECT order_obj(ORDERID, OrderDate, TotalAmount)\n        FROM   ORDERS O\n        WHERE  O.CompanyID = C.COMPANYID\n    ) AS order_tab),\n         C.COMPANYID,\n         C.CompanyName\n  BULK COLLECT INTO CompanyDetails\n  FROM   COMPANIES C\n  WHERE  C.IsActive = 'T';\nEND GETCOMPANYLIST;\n/