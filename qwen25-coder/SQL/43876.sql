WITH RankedLogs AS (\n    SELECT \n        Log_ID, \n        FB_ID,\n        [Date],\n        Log_Name,\n        Log_Type,\n        ROW_NUMBER() OVER (PARTITION BY FB_ID ORDER BY [Date]) AS rn,\n        LAG(Log_Name) OVER (PARTITION BY FB_ID ORDER BY [Date]) AS prev_log_name\n    FROM Logs\n)\nSELECT \n    Log_ID, \n    FB_ID,\n    [Date],\n    Log_Name,\n    Log_Type\nFROM RankedLogs\nWHERE rn = 1 OR (prev_log_name IS NOT NULL AND prev_log_name <> Log_Name);