DECLARE @DynamicPivotQuery NVARCHAR(MAX)\nDECLARE @ColumnNameString NVARCHAR(MAX)\n\n-- Get distinct column names for pivot (Question Texts)\nSELECT @ColumnNameString = COALESCE(@ColumnNameString + ',[' + QuestionText + ']','[' + QuestionText + ']')\nFROM Question\n\nSET @DynamicPivotQuery = \n    N'SELECT ' + @ColumnNameString + '\n      FROM\n      (\n        SELECT q.QuestionText, r.ResponseText\n        FROM Response AS r\n        JOIN Question AS q ON r.QuestionID = q.QuestionID\n      ) src_table\n      PIVOT(\n          MIN(ResponseText)\n          FOR QuestionText IN (' + @ColumnNameString + ')\n      ) pivoted\n      ORDER BY [ResponseText]'\n\nEXEC sp_executesql @DynamicPivotQuery