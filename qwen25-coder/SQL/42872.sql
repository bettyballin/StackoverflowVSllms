WITH WordPairs AS (\n    SELECT \n        w1.DocID,\n        w1.WordID AS FirstWordID,\n        w2.WordID AS SecondWordID,\n        COUNT(*) AS BigramCount\n    FROM \n        Locations w1\n    INNER JOIN \n        Locations w2 ON w1.DocID = w2.DocID AND w1.Location + 1 = w2.Location\n    GROUP BY \n        w1.DocID, w1.WordID, w2.WordID\n)\nSELECT \n    wp.FirstWordID,\n    wp.SecondWordID,\n    wp.BigramCount\nFROM \n    WordPairs wp\nORDER BY \n    wp.BigramCount DESC;