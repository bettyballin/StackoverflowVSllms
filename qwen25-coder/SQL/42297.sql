SELECT \n    userid,\n    MAX(update_time) AS update_time,\n    CASE \n        WHEN update_type = 1 THEN 'updated their profile'\n        WHEN update_type = 2 THEN CONCAT('uploaded ', COUNT(*), ' new photos')\n        WHEN update_type = 3 THEN 'updated their mood'\n    END AS activity_description\nFROM (\n    SELECT \n        userid, \n        update_type,\n        DATE_FORMAT(FROM_UNIXTIME(update_time), '%Y-%m-%d %H:00') AS rounded_update_time\n    FROM \n        update_log\n    WHERE \n        update_time > UNIX_TIMESTAMP(NOW() - INTERVAL 1 DAY)  -- Adjust the interval as necessary\n    GROUP BY \n        userid, \n        update_type,\n        rounded_update_time\n    ORDER BY \n        MAX(update_time) DESC\n) AS aggregated_updates\nGROUP BY \n    userid, \n    activity_description\nORDER BY \n    MAX(update_time) DESC;