DECLARE @BatchSize INT = 10000, @StartRow INT = 0;\n   \n   WHILE (1=1)\n   BEGIN\n       WITH RowCTE AS (\n           SELECT TOP (@BatchSize)  ROW_NUMBER() OVER (ORDER BY pk) as RowNum, *\n           FROM OriginalTable\n           OFFSET @StartRow * @BatchSize ROWS FETCH NEXT @BatchSize ROWS ONLY\n       )\n       INSERT INTO NewTable (Column1, ..., TransformedColumn)\n       SELECT Column1, ..., CASE WHEN ... THEN ... END AS TransformedColumn\n       FROM RowCTE;\n   \n       SET @StartRow = @StartRow + 1;\n       IF @@ROWCOUNT < @BatchSize BREAK;\n   END