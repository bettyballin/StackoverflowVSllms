WITH NumberedData AS (\n    SELECT \n        ID,\n        Name,\n        ROW_NUMBER() OVER (ORDER BY ID) AS RowNum,\n        ROW_NUMBER() OVER (PARTITION BY Name ORDER BY ID) AS GroupNum\n    FROM YourTable\n),\nGroupedData AS (\n    SELECT \n        Name,\n        RowNum - GroupNum AS grp\n    FROM NumberedData\n)\nSELECT \n    Name,\n    COUNT(*) AS CountOfNames\nFROM GroupedData\nGROUP BY grp, Name\nORDER BY MIN(RowNum);