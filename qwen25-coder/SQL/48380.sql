WITH RankedTodos AS (\n    SELECT \n        t.id,\n        t.client_id,\n        t.description,\n        t.timestamp_due,\n        ROW_NUMBER() OVER (PARTITION BY t.client_id ORDER BY t.timestamp_due ASC, t.id ASC) as rn\n    FROM \n        todos t\n    WHERE \n        t.timestamp_completed IS NULL -- Filtering out completed todos\n)\nSELECT \n    rt.id,\n    rt.client_id,\n    rt.description,\n    rt.timestamp_due\nFROM \n    RankedTodos rt\nWHERE \n    rt.rn = 1; -- Selecting the earliest undone todo per client