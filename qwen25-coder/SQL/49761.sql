SELECT \n    a.identifier,\n    COALESCE(b.participant, '') AS participant,\n    a.closedate AS start\nFROM \n    performance a\nLEFT OUTER JOIN \n    (SELECT identifier, participant FROM performance WHERE activity = 2) b\nON \n    a.identifier = b.identifier\nWHERE \n    a.activity = 1 -- new status\n    AND a.identifier NOT IN (SELECT identifier FROM performance WHERE activity = 4); -- not closed