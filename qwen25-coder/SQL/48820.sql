-- Step 1: Insert just Primary Key into Temp Table\nINSERT INTO #PageIndexForUsers (UserId)\nSELECT u.UserId\nFROM   dbo.aspnet_Users u\nJOIN   dbo.aspnet_Membership m ON u.UserId = m.UserId\nWHERE  u.ApplicationId = @ApplicationId \nAND    u.LoweredUserName LIKE LOWER(@UserNameToMatch)\nORDER BY u.UserName\nOFFSET (@PageLowerBound - 1) ROWS FETCH NEXT (@PageUpperBound - @PageLowerBound + 1) ROWS ONLY;\n\n-- Step 2: Use the Temp Table to fetch full records\nSELECT u.UserName, m.Email, m.PasswordQuestion, m.Comment, m.IsApproved,\n       m.CreateDate, m.LastLoginDate, u.LastActivityDate, \n       m.LastPasswordChangedDate, u.UserId, m.IsLockedOut, m.LastLockoutDate\nFROM   dbo.aspnet_Membership m\nJOIN   dbo.aspnet_Users u ON u.UserId = m.UserId\nJOIN   #PageIndexForUsers p ON u.UserId = p.UserId;