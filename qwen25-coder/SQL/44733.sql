WITH LatestComments AS (\n    SELECT dc.DealID, MAX(dc.CommentTime) AS LastCommentTime\n    FROM DealComments dc\n    GROUP BY dc.DealID\n)\nSELECT d.DealID, d.Dealname, d.DealDetails, lc.LastCommentTime, dc2.CommentPerson, dc2.Comment\nFROM Deals d\nJOIN LatestComments lc ON d.DealID = lc.DealID\nLEFT JOIN DealComments dc2 ON lc.DealID = dc2.DealID AND lc.LastCommentTime = dc2.CommentTime;