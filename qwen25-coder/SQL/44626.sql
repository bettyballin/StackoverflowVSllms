DELIMITER //\nCREATE PROCEDURE MarkDuplicates()\nBEGIN\n    -- Declare variables for use in loops\n    DECLARE done INT DEFAULT FALSE;\n    DECLARE currentCode VARCHAR(255);\n    DECLARE firstDocID INT;\n    DECLARE cur CURSOR FOR SELECT Code, MIN(DocID) FROM your_table_name GROUP BY Code HAVING COUNT(*) > 1;\n\n    -- Handler to set 'done' flag when no more rows found\n    DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = TRUE;\n\n    -- Open the cursor\n    OPEN cur;\n\n    -- Loop through each group of codes with duplicates\n    read_loop: LOOP\n        FETCH cur INTO currentCode, firstDocID;\n        IF done THEN\n            LEAVE read_loop;\n        END IF;\n\n        -- Update IsDup to 1 and DupOf to the first DocID for duplicates\n        UPDATE your_table_name\n        SET IsDup = 1, DupOf = firstDocID\n        WHERE Code = currentCode AND DocID != firstDocID;\n\n        -- Set IsDup to 0 for the original document in each group of duplicates\n        UPDATE your_table_name\n        SET IsDup = 0\n        WHERE Code = currentCode AND DocID = firstDocID;\n    END LOOP;\n\n    -- Close the cursor\n    CLOSE cur;\nEND//\nDELIMITER ;