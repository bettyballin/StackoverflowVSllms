WITH NumberedOrders AS (\n    SELECT\n        WebStoreID,\n        webordernumber,\n        ROW_NUMBER() OVER (PARTITION BY WebStoreID ORDER BY webordernumber) AS rn\n    FROM orders\n    WHERE ordertype = 'WEB'\n),\nOrderGaps AS (\n    SELECT\n        WebStoreID,\n        webordernumber,\n        rn\n    FROM NumberedOrders\n    WHERE webordernumber <> rn + (SELECT MIN(webordernumber) - 1 FROM orders WHERE ordertype = 'WEB')\n)\nSELECT\n    og.WebStoreID,\n    nog.webordernumber AS MissingOrderNumber\nFROM OrderGaps og\nLEFT JOIN NumberedOrders nog ON og.WebStoreID = nog.WebStoreID AND nog.rn + 1 = og.rn\nWHERE nog.webordernumber IS NULL;