SELECT \n    ReferralID,\n    COUNT(DISTINCT [Assessment Date]) AS NumberOfAssessments,\n    COUNT(DISTINCT [Assessment Team]) AS TeamsAssessing,\n    COUNT(DISTINCT [Service Provided]) AS ServicesProvided,\n    (SELECT COUNT(DISTINCT [Service Team]) FROM YourTable AS SubQ WHERE SubQ.ReferralID = MainQ.ReferralID) AS NoTeamsProviding\nFROM \n    YourTable AS MainQ\nGROUP BY \n    ReferralID;