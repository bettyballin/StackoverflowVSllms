WITH RankedItems AS (\n    SELECT \n        p.person_name,\n        i.item_type,\n        COUNT(i.item_id) AS item_count,\n        ROW_NUMBER() OVER (PARTITION BY i.item_type ORDER BY COUNT(i.item_id) DESC) AS rn\n    FROM \n        items i\n    JOIN \n        person p ON i.person_id = p.person_id\n    WHERE \n        i.item_date BETWEEN '2023-01-01 00:00:00' AND '2023-12-31 23:59:59' -- Change the date range as needed\n    GROUP BY \n        p.person_id, i.item_type\n)\nSELECT \n    person_name,\n    item_type,\n    item_count\nFROM \n    RankedItems\nWHERE \n    rn <= 2\nORDER BY \n    item_type, item_count DESC;