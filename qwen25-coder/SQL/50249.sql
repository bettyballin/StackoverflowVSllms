SELECT \n    table1.column1,\n    table1.column2,\n    -- other columns from table1 and related tables\n    Fileimg.path\nFROM \n    (SELECT column1, column2, /* other columns */ FROM table1) AS table1\nLEFT JOIN \n    (SELECT column21, /* other columns */ FROM envelope) AS envelope ON table1.column1 = envelope.column1\nLEFT JOIN \n    (SELECT column21, column22, /* other columns */ FROM Table2) AS Table2 ON envelope.column21 = Table2.column21\nOUTER APPLY\n    (SELECT dbo.Fileimagepath(Table2.column21, Table2.column22) AS path) AS Fileimg\nWHERE \n    envelope.column21 = 8\nFOR XML PATH('xyz'), ELEMENTS XSINIL