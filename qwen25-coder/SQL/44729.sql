-- Ensure there is a unique index on the User column in Table 1\nCREATE UNIQUE INDEX IF NOT EXISTS idx_table1_user ON table1 (user);\n\n-- Use INSERT with ON CONFLICT to merge data from Table 2 into Table 1\nINSERT INTO table1 (Id, User, InternetAmountDue)\nSELECT \n    nextval('table1_id_seq'), -- Assuming there's a sequence for generating IDs\n    t2.UserName,\n    t2.AmountDue\nFROM table2 AS t2\nON CONFLICT (User) DO UPDATE\nSET InternetAmountDue = EXCLUDED.InternetAmountDue;