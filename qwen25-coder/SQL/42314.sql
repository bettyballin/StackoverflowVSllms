-- Find IDs of duplicates excluding the one to keep\nDELETE l1 FROM locations l1,\n       locations l2\nWHERE l1.lat = l2.lat AND l1.lng = l2.lng\n  AND (\n    -- Keep record with non-empty URL if exists, otherwise keep oldest\n    (l2.url != '' AND l1.id > l2.id)\n    OR (l2.url = '' AND l1.created_at > l2.created_at)\n  );\n\n-- Alternatively, using a subquery to find the minimum IDs for each group of duplicates with empty URLs\nDELETE FROM locations WHERE id NOT IN (\n    SELECT MIN(id) AS min_id FROM locations WHERE url != '' GROUP BY lat, lng\n    UNION\n    SELECT MIN(id) AS min_id FROM locations WHERE url = '' GROUP BY lat, lng ORDER BY created_at ASC\n);