SET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n-- =============================================\n-- Author:      Anthony Main\n-- Create date: 18/11/08\n-- Description: Produce Table of Dates for Month\n-- =============================================\nCREATE FUNCTION CalendarTable\n(   \n    @StartDate DATETIME,\n    @EndDate DATETIME\n)\nRETURNS @Calendar TABLE \n(\n    DateValue datetime,\n    [day of year] int,\n    [day] nvarchar(10),\n    [day of week] int,\n    [day of month] int,\n    [week] int,\n    [month] int,\n    [month name] nvarchar(15),\n    [quarter] int,\n    [year] int,\n    [HOUR] int,\n    [MIN] int,\n    [SEC] int,\n    [MILLISECOND] int\n)\nAS\nBEGIN \n    DECLARE @CurrentDate datetime = @StartDate;\n\n    WHILE (@CurrentDate <= @EndDate)\n    BEGIN\n        INSERT INTO @Calendar (DateValue, [day of year], [day], [day of week], [day of month], [week], [month], [month name], [quarter], [year], [HOUR], [MIN], [SEC], [MILLISECOND])\n        VALUES (\n            @CurrentDate,\n            datepart(dy, @CurrentDate),\n            datename(dw, @CurrentDate),\n            datepart(dw, @CurrentDate-1),\n            datepart(dd, @CurrentDate),\n            datepart(ww, @CurrentDate),\n            datepart(mm, @CurrentDate),\n            datename(mm, @CurrentDate),\n            datepart(qq, @CurrentDate),\n            datepart(yy, @CurrentDate),\n            datepart(HH, @CurrentDate),\n            datepart(MI, @CurrentDate),\n            datepart(SS, @CurrentDate),\n            datepart(MS, @CurrentDate)\n        )\n        \n        SET @CurrentDate = DATEADD(DAY, 1, @CurrentDate);\n    END\n\n    RETURN;\nEND\nGO