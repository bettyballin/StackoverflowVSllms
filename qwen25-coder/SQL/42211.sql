SELECT \nCONCAT('<SalesOrders>',\n       GROUP_CONCAT(CONCAT(\n         '<SalesOrder Id="', so.id, '" Code="', so.Code, '">',\n         '<Customer Code="', cu.Code, '" Name="', cu.Name, '"/>',\n         (SELECT IFNULL(GROUP_CONCAT(\n                    CONCAT('<SalesItem Item="', si.Item_Num, \n                           '" PartCode="', pa.Code, '"/>')\n                 ORDER BY si.Item_Num SEPARATOR ''), '') \n          FROM tblSalesItem si\n              LEFT JOIN tblPart pa ON pa.Id = si.Part_Id\n         WHERE so.id = si.SalesOrder_ID),\n        '</SalesOrder>'\n       ) SEPARATOR ''),\n    '</SalesOrders>') AS XMLData\nFROM tblSalesOrder so\nJOIN tblCustomer cu ON so.customer_id = cu.ID;