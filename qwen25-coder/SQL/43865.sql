SELECT p.id,\n       COALESCE(r_active.status, r_latest.status) AS status,\n       COALESCE(r_active.title, r_latest.title) AS title\nFROM page AS p\nLEFT JOIN (\n    SELECT r.pageId, r.id, r.status, r.title,\n           ROW_NUMBER() OVER (PARTITION BY r.pageId ORDER BY r.id DESC) as rn_active\n    FROM page_revision r\n    WHERE r.status = 'active'\n) AS r_active ON r_active.pageId = p.id AND r_active.rn_active = 1\nLEFT JOIN (\n    SELECT r.pageId, r.id, r.status, r.title,\n           ROW_NUMBER() OVER (PARTITION BY r.pageId ORDER BY r.id DESC) as rn_latest\n    FROM page_revision r\n) AS r_latest ON r_latest.pageId = p.id AND r_latest.rn_latest = 1;