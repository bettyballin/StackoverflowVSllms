-- Declare table variables to store inserted ID mappings\nDECLARE @MasterIDs TABLE (OldID INT, NewID INT);\nDECLARE @SlaveData TABLE (Master_ID_New INT, Name CHAR(10));\n\n-- Insert into master and output the old and new IDs\nINSERT INTO master (name)\nOUTPUT inserted.id, SCOPE_IDENTITY() AS NewID\nINTO @MasterIDs (NewID)\nSELECT id, name FROM \n(\n    -- Simulating existing data to be copied\n    SELECT 1 AS id, 'master a' AS name UNION ALL\n    SELECT 2 AS id, 'master b' AS name\n) AS SimulatedData;\n\n-- Prepare slave data with new master IDs\nINSERT INTO @SlaveData (Master_ID_New, Name)\nSELECT m.NewID, s.Name FROM \n(\n    -- Simulating existing slave data to be copied\n    SELECT 1 AS Master_ID, 'slave aa' AS Name UNION ALL\n    SELECT 2 AS Master_ID, 'slave bb' AS Name UNION ALL\n    SELECT 1 AS Master_ID, 'slave cc' AS Name UNION ALL\n    SELECT 2 AS Master_ID, 'slave dd' AS Name\n) AS SimulatedSlaveData s\nJOIN @MasterIDs m ON s.Master_ID = m.OldID;\n\n-- Insert into slave using the new master IDs\nINSERT INTO slave (master_id, name)\nSELECT Master_ID_New, Name FROM @SlaveData;