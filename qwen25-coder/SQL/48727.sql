-- Create a temporary table for precomputed UDF values\nCREATE TABLE #TempUDFResults (\n    AccountNo INT NOT NULL,\n    CostCenterNum INT NOT NULL,\n    LNTM INT NOT NULL,\n    CA_UNIT VARCHAR(6) NOT NULL\n);\n\n-- Precompute the UDF results and store them in the temporary table\nINSERT INTO #TempUDFResults (AccountNo, CostCenterNum, LNTM, CA_UNIT)\nSELECT \n    GL.ACCOUNT_NO,\n    CC.COST_CTR_NUM,\n    GL.LI_LNTM,\n    udf_BUPDEF(GL.ACCOUNT_NO, CC.COST_CTR_NUM, GL.LI_LNTM, 'N') AS CA_UNIT\nFROM \n    JOINGLAC AS GL\nCROSS JOIN \n    COSTCENT AS CC;\n\n-- Perform the final insert using precomputed values\nINSERT INTO [JOINCCAC] (\n    [CA_JCCAC],\n    [CA_COSTCENT],\n    [CA_GLACCOUNT],\n    [CA_LNTM],\n    [CA_UNIT]\n)\nSELECT  \n    Util.PADLEFT(CONVERT(varchar, T.CostCenterNum), '0', 7) + Util.PADLEFT(CONVERT(varchar, T.AccountNo), '0', 9) AS CC_JCCAC,\n    T.CostCenterNum AS CA_COSTCENT,\n    T.AccountNo % 900000000 AS CA_GLACCOUNT,\n    T.LNTM AS CA_LNTM,\n    T.CA_UNIT\nFROM \n    #TempUDFResults AS T;\n\n-- Drop the temporary table after use\nDROP TABLE #TempUDFResults;