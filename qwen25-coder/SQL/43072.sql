WITH OrderedValues AS (\n    SELECT \n        id,\n        month,\n        year,\n        value,\n        ROW_NUMBER() OVER (PARTITION BY id ORDER BY year, month) - \n        ROW_NUMBER() OVER (PARTITION BY id, value ORDER BY year, month) AS grp\n    FROM \n        your_table_name\n),\nGroupedRanges AS (\n    SELECT \n        id,\n        value,\n        MIN(month) AS startMonth,\n        MAX(month) AS endMonth,\n        MIN(year) AS startYear,\n        MAX(year) AS endYear\n    FROM \n        OrderedValues\n    GROUP BY \n        id, value, grp\n)\nSELECT \n    id,\n    startMonth,\n    endMonth,\n    startYear,\n    endYear,\n    value\nFROM \n    GroupedRanges\nORDER BY \n    id, startYear, startMonth;