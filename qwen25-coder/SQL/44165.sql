-- Update existing records with changes from the temp table\nUPDATE f\nSET \n    TRADENAME = t.TRADENAME,\n    CDM = t.CDM,\n    NDC = t.NDC,\n    IP_COST = t.IP_COST,\n    OP_COST = t.OP_COST,\n    HH_COST = t.HH_COST,\n    VAR_COST = t.VAR_COST,\n    LSTUPDATE = t.LSTUPDATE\nFROM [RX_Billing].[dbo].[FS_Drug] f\nJOIN [RX_Billing].[dbo].[FS_Drug_TEMP] t ON f.TRADENAME = t.TRADENAME;\n\n-- Insert new records from the temp table into the main table\nINSERT INTO [RX_Billing].[dbo].[FS_Drug]\n(TRADENAME, CDM, NDC, IP_COST, OP_COST, HH_COST, VAR_COST, LSTUPDATE)\nSELECT \n    TRADENAME, CDM, NDC, IP_COST, OP_COST, HH_COST, VAR_COST, LSTUPDATE\nFROM [RX_Billing].[dbo].[FS_Drug_TEMP]\nWHERE TRADENAME NOT IN (SELECT TRADENAME FROM [RX_Billing].[dbo].[FS_Drug]);