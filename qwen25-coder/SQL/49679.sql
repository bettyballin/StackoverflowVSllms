CREATE MATERIALIZED VIEW item_summary AS\n   SELECT \n       i.itemid,\n       akv1.itemvalue AS color,\n       akv2.itemvalue AS size,\n       akv3.itemvalue AS fabric\n   FROM items i\n   LEFT JOIN additional_key_value_pairs akv1 ON (i.itemid = akv1.itemid AND akv1.itemkey = 'colour')\n   LEFT JOIN additional_key_value_pairs akv2 ON (i.itemid = akv2.itemid AND akv2.itemkey = 'size')\n   LEFT JOIN additional_key_value_pairs akv3 ON (i.itemid = akv3.itemid AND akv3.itemkey = 'fabric');