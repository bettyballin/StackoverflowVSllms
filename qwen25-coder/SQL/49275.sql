WITH RankedOrders AS (\n    SELECT \n        custid,\n        ordid,\n        qty,\n        datesold,\n        ROW_NUMBER() OVER (PARTITION BY custid ORDER BY datesold DESC) AS rn\n    FROM \n        orders  -- Assuming your table is named 'orders'\n)\nSELECT \n    custid,\n    ordid,\n    qty,\n    datesold\nFROM \n    RankedOrders\nWHERE \n    rn = 2;  -- This line filters for the previous order of each customer