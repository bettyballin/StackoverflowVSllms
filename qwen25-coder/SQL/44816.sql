-- Create consumer groups\n   EXEC DBMS_RESOURCE_MANAGER.CREATE_CONSUMER_GROUP(consumer_group => 'CG_SYS', comment => 'SYS Sessions');\n   EXEC DBMS_RESOURCE_MANAGER.CREATE_CONSUMER_GROUP(consumer_group => 'CG_OLTP', comment => 'OLTP Sessions');\n   EXEC DBMS_RESOURCE_MANAGER.CREATE_CONSUMER_GROUP(consumer_group => 'CG_BATCH', comment => 'Batch Jobs');\n\n   -- Create resource plan\n   EXEC DBMS_RESOURCE_MANAGER.CREATE_PLAN(plan => 'MY_RESOURCE_PLAN', comment => 'Custom Resource Manager Plan');\n\n   -- Define subplans for hierarchical structure\n   EXEC DBMS_RESOURCE_MANAGER.CREATE_SUBPLAN(plan => 'MY_RESOURCE_PLAN', subplan => 'L1_SYS');\n   EXEC DBMS_RESOURCE_MANAGER.CREATE_SUBPLAN(plan => 'MY_RESOURCE_PLAN', subplan => 'L2_OLTP');\n   EXEC DBMS_RESOURCE_MANAGER.CREATE_SUBPLAN(plan => 'MY_RESOURCE_PLAN', subplan => 'L3_BATCH');\n\n   -- Set CPU allocations\n   EXEC DBMS_RESOURCE_MANAGER.UPDATE_PLAN_DIRECTIVE(\n      plan => 'MY_RESOURCE_PLAN',\n      group_or_subplan => 'L1_SYS',\n      cpu_p1 => 100);\n\n   EXEC DBMS_RESOURCE_MANAGER.UPDATE_PLAN_DIRECTIVE(\n      plan => 'MY_RESOURCE_PLAN',\n      group_or_subplan => 'MY_RESOURCE_PLAN',\n      subplan => 'L2_OLTP',\n      cpu_p2 => 100);\n\n   EXEC DBMS_RESOURCE_MANAGER.UPDATE_PLAN_DIRECTIVE(\n      plan => 'MY_RESOURCE_PLAN',\n      group_or_subplan => 'L2_OLTP',\n      group_or_subplan_mapping => 'CG_OLTP',\n      cpu_p3 => 100); -- OLTP gets all available at level 3 if others don't need it.\n\n   EXEC DBMS_RESOURCE_MANAGER.UPDATE_PLAN_DIRECTIVE(\n      plan => 'MY_RESOURCE_PLAN',\n      group_or_subplan => 'MY_RESOURCE_PLAN',\n      subplan => 'L3_BATCH',\n      cpu_p3 => 100);\n\n   -- Implement the plan\n   EXEC DBMS_RESOURCE_MANAGER.VALIDATE_PLAN(plan => 'MY_RESOURCE_PLAN');\n   ALTER SYSTEM SET RESOURCE_MANAGER_PLAN = 'MY_RESOURCE_PLAN';