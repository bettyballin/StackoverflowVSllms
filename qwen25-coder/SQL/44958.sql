WITH CalculatedConditions AS (\n    SELECT \n        col1,\n        col2,\n        col3,\n        CASE \n            WHEN condition2 THEN 1 \n            ELSE 0 \n        END AS Condition2Met,\n\n        CASE \n            WHEN condition1 THEN 1 \n            ELSE 0 \n        END AS Condition1Met\n    FROM table\n),\nCalculatedLogic AS (\n    SELECT \n        col1,\n        col2,\n        col3,\n        CASE \n            WHEN condition \n                AND Condition1Met = 1 \n                AND Condition2Met = 1 THEN calculation1\n            WHEN condition \n                AND Condition1Met = 1  \n                AND Condition2Met = 0 THEN calculation2\n            WHEN condition \n                AND Condition1Met = 0  \n                AND Condition2Met = 1 THEN calculation3\n            WHEN condition \n                    AND Condition1Met = 0  \n                    AND Condition2Met = 0 THEN calculation4\n\n            WHEN NOT condition \n                AND Condition1Met = 1  \n                AND Condition2Met = 1 THEN calculation5\n            WHEN NOT condition \n                AND Condition1Met = 1  \n                AND Condition2Met = 0 THEN calculation6\n            WHEN NOT condition \n                AND Condition1Met = 0  \n                AND Condition2Met = 1 THEN calculation7\n            ELSE calculation8\n        END AS calculatedcol1,\n\n        col4,\n        col5\n    FROM CalculatedConditions\n)\n\nSELECT col1, col2, col3, calculatedcol1, col4, col5\nFROM CalculatedLogic;