SELECT \n    u.user_id, \n    u.user_type,\n    CONCAT(\n        CASE WHEN u.user_type = 'person' THEN \n            CONCAT_WS(' ', up.profile_first_name, up.profile_last_name)\n        END,\n        CASE WHEN u.user_type = 'company' THEN \n            cp.profile_company_name\n        END\n    ) AS user_fullname\nFROM \n    users u\nLEFT JOIN \n    user_profiles up ON u.user_id = up.profile_user_id\nLEFT JOIN \n    company_profiles cp ON u.user_id = cp.profile_user_id;