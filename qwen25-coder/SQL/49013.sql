WITH DateSeries AS (\n    SELECT \n        DATEADD(DAY, -number + 1, CAST(GETDATE() AS DATE)) AS open_day\n    FROM \n        (SELECT TOP 7 ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) AS number FROM sys.objects) t\n),\nIncidentCounts AS (\n    SELECT \n        COUNT(incident_id) AS Calls,\n        MAX(open_time) AS LastCallTime,\n        DATEPART(dd, (open_time - (9.0/24))) AS open_day\n    FROM \n        incidentsm1\n    WHERE \n        DATEDIFF(DAY, open_time - (9.0/24), GETDATE()) < 7\n    GROUP BY \n        DATEPART(dd, (open_time - (9.0/24)))\n)\nSELECT \n    ds.open_day,\n    ISNULL(ic.Calls, 0) AS Calls,\n    ic.LastCallTime\nFROM \n    DateSeries ds\nLEFT JOIN \n    IncidentCounts ic ON ds.open_day = ic.open_day\nORDER BY \n    ds.open_day;