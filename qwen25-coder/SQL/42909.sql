-- Assuming you have a POINT column named location (latitude, longitude)\nSELECT id, address, location, ST_Distance_Sphere(location, POINT(:longitude, :latitude)) / 1000 AS distance_in_km\nFROM addresses\nWHERE MBRContains(\n    LineString(\n        Point((:longitude - (:distance / ABS(cos(Radians(:latitude))) * (180 / PI()) / 69.0)), \n              (:latitude - (:distance / 69.0))),\n        Point((:longitude + (:distance / ABS(cos(Radians(:latitude))) * (180 / PI()) / 69.0)),\n              (:latitude + (:distance / 69.0)))\n    ),\n    location\n)\nHAVING distance_in_km <= :distance -- distance in kilometers\nORDER BY distance_in_km;