SELECT \n    d.owner,\n    COUNT(d.dog_name) AS num_dogs,\n    COUNT(c.cat_name) AS num_cats\nFROM \n    dogs d\nLEFT JOIN \n    cats c ON d.owner = c.owner\nGROUP BY \n    d.owner\n\nUNION ALL\n\nSELECT \n    c.owner,\n    COUNT(d.dog_name) AS num_dogs,\n    COUNT(c.cat_name) AS num_cats\nFROM \n    cats c\nLEFT JOIN \n    dogs d ON c.owner = d.owner\nWHERE \n    d.owner IS NULL\nGROUP BY \n    c.owner\nORDER BY \n    owner;