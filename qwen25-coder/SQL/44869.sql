CREATE OR REPLACE VIEW parsed_flat_file_view AS\n   SELECT \n       CASE \n           WHEN SUBSTR(line_content, 1, 5) = 'TYPE1' THEN SUBSTR(line_content, 10, 9) \n           WHEN SUBSTR(line_content, 1, 5) = 'TYPE2' THEN SUBSTR(line_content, 23, 5) \n       END AS field1,\n       CASE \n           WHEN SUBSTR(line_content, 1, 5) = 'TYPE1' THEN SUBSTR(line_content, 26, 10)\n           WHEN SUBSTR(line_content, 1, 5) = 'TYPE2' THEN SUBSTR(line_content, 15, 5)\n       END AS field2\n   FROM flat_file_staging;