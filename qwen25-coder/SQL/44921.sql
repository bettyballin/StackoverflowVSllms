-- Disable IDENTITY_INSERT for the CommReceipt table\nSET IDENTITY_INSERT CommReceipt ON;\n\n-- Insert data with specified CR_Key values from your staging table\nINSERT INTO CommReceipt (CR_Key, Column1, Column2, ...)\nSELECT DistinctStaging.CR_Key, Staging.Column1, Staging.Column2, ...\nFROM StagingTable AS Staging\nLEFT JOIN CommReceipt AS Existing ON Staging.CR_Key = Existing.CR_Key\nWHERE Existing.CR_Key IS NULL; -- Ensure to not insert duplicates\n\n-- Handle primary key violations (optional logging)\nINSERT INTO KeyViolationLog (CR_Key, ErrorDescription)\nSELECT Staging.CR_Key, 'Primary Key Violation'\nFROM StagingTable AS Staging\nINNER JOIN CommReceipt AS Existing ON Staging.CR_Key = Existing.CR_Key;\n\n-- Re-enable IDENTITY_INSERT for the CommReceipt table\nSET IDENTITY_INSERT CommReceipt OFF;