WITH RankedVersions AS (\n    SELECT \n        ta.ID AS TableA_ID,\n        ta.Name AS TableA_Name,\n        tb.Name AS TableB_Name,\n        tb.DateStamp,\n        ROW_NUMBER() OVER (PARTITION BY ta.ID ORDER BY tb.DateStamp DESC) as rn\n    FROM \n        TableA ta\n    INNER JOIN \n        TableB tb ON ta.ID = tb.TableA_ID\n)\nSELECT \n    TableA_ID, \n    TableA_Name, \n    TableB_Name, \n    DateStamp\nFROM \n    RankedVersions\nWHERE \n    rn = 1;