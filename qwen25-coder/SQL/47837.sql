WITH RECURSIVE DateSeries AS (\n    SELECT MIN(created_at) as date FROM products_sold WHERE merchant_id = 1\n    UNION ALL\n    SELECT DATE_ADD(date, INTERVAL 1 DAY) \n    FROM DateSeries \n    WHERE DATE_ADD(date, INTERVAL 1 DAY) <= (SELECT MAX(created_at) FROM products_sold WHERE merchant_id = 1)\n)\n\nSELECT AVG(ps.sales_price) AS avg, ds.date\nFROM DateSeries ds\nLEFT JOIN products_sold ps ON DATE(ps.created_at) = ds.date AND ps.merchant_id = 1\nGROUP BY ds.date;