SELECT \n    c.CustomerName,\n    MAX(CASE WHEN p.ProductOrder = 1 THEN p.ProductName END) AS Product1Name,\n    MAX(CASE WHEN p.ProductOrder = 2 THEN p.ProductName END) AS Product2Name\nFROM \n    Customers c\nLEFT JOIN\n    (SELECT \n         CustomerID, ProductName,\n         ROW_NUMBER() OVER(PARTITION BY CustomerID ORDER BY ProductName) AS ProductOrder\n     FROM Products) p\nON \n    c.CustomerID = p.CustomerID\nGROUP BY \n    c.CustomerName;