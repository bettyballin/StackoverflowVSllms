-- Assume we have a small config table to determine which is the active table.\n-- Config Table = 'ActiveTableConfig' with column 'CurrentTableName'\n\nDECLARE @inactiveTable NVARCHAR(50);\nDECLARE @activeTable NVARCHAR(50);\n\nBEGIN TRANSACTION;\n\n-- Determine inactive table\nSELECT @activeTable = CurrentTableName \nFROM ActiveTableConfig;\n\nIF (@activeTable = N'ImportantTableA')\n    SET @inactiveTable = N'ImportantTableB';\nELSE\n    SET @inactiveTable = N'ImportantTableA';\n\n-- Perform data transformation and load into the inactive table.\n-- Replace with your actual transformation logic here\nEXEC TransformAndLoadData @targetTableName = @inactiveTable;\n\n-- Switch active table configuration\nUPDATE ActiveTableConfig\nSET CurrentTableName = @inactiveTable;\n\nCOMMIT TRANSACTION;\n\n-- Optionally, clean up the previous inactive table if needed\nTRUNCATE TABLE @activeTable;