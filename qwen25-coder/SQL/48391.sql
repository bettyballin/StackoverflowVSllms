-- Create a temporary table\nCREATE TEMPORARY TABLE TempSales AS\nSELECT customer_id, SUM(amount) as total_spent\nFROM Sales\nWHERE sale_date BETWEEN '2023-01-01' AND '2023-12-31'\nGROUP BY customer_id;\n\n-- Add an index to the temp table if necessary\nCREATE INDEX idx_temp_sales ON TempSales(customer_id);\n\n-- Use the temporary table in subsequent queries\nSELECT *\nFROM TempSales ts\nJOIN Customers c ON ts.customer_id = c.id\nWHERE ts.total_spent > 5000;