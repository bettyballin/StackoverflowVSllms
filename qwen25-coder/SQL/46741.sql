DECLARE @cols NVARCHAR(MAX),\n        @query NVARCHAR(MAX);\n\n-- Get all columns except the identity column\nSELECT @cols = STRING_AGG(COLUMN_NAME, ', ')\nFROM INFORMATION_SCHEMA.COLUMNS \nWHERE TABLE_NAME = 'T' AND COLUMNPROPERTY(OBJECT_ID('dbo.T'), COLUMN_NAME, 'IsIdentity') = 0;\n\n-- Construct the insert statement dynamically excluding the identity column\nSET @query = N'INSERT INTO T (' + @cols + ') SELECT ' + @cols + ' FROM #tmp';\n\n-- Execute the dynamic query\nEXEC sp_executesql @query;