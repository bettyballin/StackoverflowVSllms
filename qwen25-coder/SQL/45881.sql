CREATE VIEW ExtractedDatesView AS\nSELECT \n    OriginalColumn,\n    CASE \n        WHEN CHARINDEX('DSP', OriginalColumn) > 0 THEN \n            SUBSTRING(OriginalColumn, \n                      CHARINDEX('DSP', OriginalColumn) + 4, \n                      CHARINDEX('-', OriginalColumn, CHARINDEX('DSP', OriginalColumn)) - CHARINDEX('DSP', OriginalColumn) - 4)\n        WHEN CHARINDEX('DISCH', OriginalColumn) > 0 THEN \n            SUBSTRING(OriginalColumn, \n                      CHARINDEX('DISCH', OriginalColumn) + 6, \n                      PATINDEX('%[- ]%', SUBSTRING(OriginalColumn, CHARINDEX('DISCH', OriginalColumn) + 6, LEN(OriginalColumn))) - 1)\n        ELSE NULL\n    END AS ExtractedDate\nFROM YourTable;