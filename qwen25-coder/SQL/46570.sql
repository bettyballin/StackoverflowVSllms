DECLARE @UserName NVARCHAR(128) = N'username';\nDECLARE @ProcName NVARCHAR(128) = N'databasename..storedProcedureName';\n\nWITH UserRoles AS (\n    SELECT rp.name AS roleName, mp.name AS memberName\n    FROM sys.database_role_members drm\n    INNER JOIN sys.database_principals rp ON drm.role_principal_id = rp.principal_id\n    INNER JOIN sys.database_principals mp ON drm.member_principal_id = mp.principal_id\n    WHERE mp.name = @UserName\n)\nSELECT \n    CASE \n        WHEN perm.state_desc = 'GRANT' AND perm.permission_name = 'EXECUTE'\n        THEN 1 -- CAN EXECUTE\n        ELSE 0 -- CANNOT EXECUTE\n    END AS CanExecute\nFROM sys.database_permissions perm\nWHERE \n    (perm.grantee_principal_id = USER_ID(@UserName)\n     OR perm.grantee_principal_id IN (\n         SELECT USER_ID(roleName) FROM UserRoles\n     )\n    )\nAND \n    (perm.major_id = OBJECT_ID(@ProcName));