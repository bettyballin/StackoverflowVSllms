SELECT \n    s1.Id, \n    s1.Name AS StudentName, \n    s1.Parent, \n    s2.Id AS Child, \n    s2.Mark, \n    m.Ranking\nFROM \n    Students s1\nJOIN \n    (SELECT Parent, MAX(Mark) AS MaxMark\n     FROM Students\n     WHERE Mark >= 20\n     GROUP BY Parent) max_marks ON s1.Id = max_marks.Parent\nJOIN \n    Students s2 ON s1.Id = s2.Parent AND s2.Mark = max_marks.MaxMark\nLEFT JOIN \n    Marks m ON s1.Name = m.Name;