-- Assuming we want to find all occurrences of event 123 between two dates\nSELECT \n    DATE(start_time + INTERVAL (n.n * r.interval) DAY) AS occurrence_date,\n    TIME(start_time) AS start_time,\n    TIME(end_time) AS end_time\nFROM \n    Events e\nJOIN \n    Recurring_Events r ON e.event_id = r.event_id\nJOIN \n    (SELECT n FROM numbers WHERE n <= 365) n -- assuming yearly max, use sequence generator or range\nWHERE \n    e.event_id = 123 AND\n    DATE(start_time + INTERVAL (n.n * r.interval) DAY) BETWEEN '2024-01-01' AND '2024-12-31'\nEXCEPT\nSELECT event_date FROM Exceptions WHERE recurring_event_id = (SELECT recurring_event_id FROM Recurring_Events WHERE event_id = 123)\nORDER BY occurrence_date;