WITH allDates AS (\n    SELECT intPK, datCheckedOut AS datLastAction, 'CheckedOut' AS ActionSource\n    FROM dbo.tblAssetsInUse\n\n    UNION ALL\n\n    SELECT intPK, datCheckedIn AS datLastAction, 'CheckedIn' AS ActionSource\n    FROM dbo.tblAssetsInUse\n)\nSELECT TOP (1) ad.intPK, ad.datLastAction AS datLastScan, a.strFriendlyName, t.intAssetID, ad.ActionSource\nFROM allDates AS ad \nINNER JOIN dbo.tblAssetsInUse AS t ON ad.intPK = t.intPK \nINNER JOIN dbo.viwAssets AS a ON t.intAssetID = a.intPK\nWHERE ad.datLastAction IS NOT NULL  -- Optional: Exclude rows if both dates are NULL\nORDER BY datLastScan DESC;