WITH SymbolDateRange AS (\n    SELECT MIN(date) AS StartDate, MAX(date) AS EndDate\n    FROM Stockdata\n    WHERE symbol = 'Foo'\n)\nSELECT \n    M.date AS MDate,\n    S.date AS SDate,\n    S.symbol,\n    S.open,\n    S.high,\n    S.low,\n    S.close,\n    S.volume\nFROM \n    Masterdates M\nLEFT JOIN \n    Stockdata S ON M.date = S.date AND S.symbol = 'Foo'\nJOIN \n    SymbolDateRange SR ON M.date BETWEEN SR.StartDate AND SR.EndDate\nORDER BY \n    M.date;