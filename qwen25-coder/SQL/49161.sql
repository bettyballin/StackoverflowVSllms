CREATE PROCEDURE CheckJobStatus \n    @JobName NVARCHAR(128)\nAS\nBEGIN\n    DECLARE @JobId UNIQUEIDENTIFIER;\n\n    -- Get the Job ID using the Job Name\n    SELECT @JobId = job_id FROM msdb.dbo.sysjobs WHERE name = @JobName;\n\n    IF @JobId IS NULL\n    BEGIN\n        PRINT 'Job not found.';\n        RETURN;\n    END\n\n    -- Query the last run of the job\n    SELECT \n        sj.name AS JobName,\n        sh.run_status,\n        CASE sh.run_status\n            WHEN 0 THEN 'Failed'\n            WHEN 1 THEN 'Succeeded'\n            WHEN 2 THEN 'Retry'\n            WHEN 3 THEN 'Canceled'\n            WHEN 4 THEN 'In Progress'\n        END AS RunStatusDescription,\n        sh.message,\n        sh.step_name,\n        STUFF(STUFF(RIGHT('000000' + CAST(sh.run_duration AS VARCHAR(6)), 6), 5, 0, ':'), 3, 0, ':') AS [Duration (HH:MM:SS)],\n        sh.run_date AS LastRunDate,\n        sh.run_time AS LastRunTime\n    FROM \n        msdb.dbo.sysjobs sj\n    INNER JOIN \n        msdb.dbo.sysjobhistory sh ON sj.job_id = sh.job_id\n    WHERE \n        sj.job_id = @JobId\n    ORDER BY \n        sh.instance_id DESC -- Latest run first\n    OPTION (RECOMPILE);\nEND;