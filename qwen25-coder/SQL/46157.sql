SELECT r.Description, arq.DateReferred, arq.AssessmentResourceID\nFROM AssessmentXResource AS arq \nINNER JOIN Resource AS r ON arq.ResourceID = r.ResourceID\nWHERE (arq.AssessmentID, arq.DateReferred) IN (\n    SELECT AssessmentID, MAX(DateReferred)\n    FROM AssessmentXResource\n    WHERE AssessmentID IN (\n        SELECT aq.AssessmentID\n        FROM Assessment AS aq\n        INNER JOIN Case AS cq ON aq.CaseID = cq.CaseID\n        INNER JOIN Plan AS pq ON cq.CaseID = pq.CaseID\n        WHERE pq.PlanID = 22\n    )\n    GROUP BY AssessmentID\n)\nORDER BY r.Description;