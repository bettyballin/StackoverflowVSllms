BEGIN TRANSACTION;\n\n-- Read from table 1 using ROWLOCK hint to minimize lock escalations and potential deadlocks\nSELECT * FROM Table1 WITH (ROWLOCK) WHERE <condition>;\n\n-- Insert into table 2\nINSERT INTO Table2 (...) VALUES (...);\n\n-- Update table 1 with pointer to table 2 record, also using ROWLOCK\nUPDATE Table1 WITH (ROWLOCK)\nSET <column> = <value>\nWHERE <condition>;\n\nCOMMIT TRANSACTION;