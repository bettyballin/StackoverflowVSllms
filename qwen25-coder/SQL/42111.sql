DECLARE @TableName NVARCHAR(MAX) = 'YourTable'\nDECLARE @Query NVARCHAR(MAX) = N'SELECT * FROM (Your Query Here) AS T'\nDECLARE @InsertStatement NVARCHAR(MAX) = ''\n\nDECLARE @ColumnName NVARCHAR(128)\nDECLARE @ColumnValue NVARCHAR(MAX)\nDECLARE @IsFirst BIT\n\n-- Create a temporary table to store the results of your query\nSELECT TOP 0 *\nINTO ##TempTable\nFROM (Your Query Here) AS T\n\n-- Generate INSERT statements\nSELECT @InsertStatement = ''\nWHILE EXISTS (SELECT * FROM ##TempTable)\nBEGIN\n    SELECT TOP 1 @IsFirst = 1,\n                 @ColumnName = NULL, @ColumnValue = NULL\n    FROM ##TempTable\n    \n    WHILE EXISTS (SELECT TOP 1 Column_Name \n                  FROM INFORMATION_SCHEMA.COLUMNS \n                  WHERE TABLE_NAME = '##TempTable' AND COLUMN_NAME > ISNULL(@ColumnName, N''))\n    BEGIN\n        SELECT @ColumnName = Column_Name\n        FROM INFORMATION_SCHEMA.COLUMNS \n        WHERE TABLE_NAME = '##TempTable' AND COLUMN_NAME > ISNULL(@ColumnName, N'')\n        \n        IF @IsFirst = 1\n            SET @InsertStatement = ISNULL(@InsertStatement + ', ', '') + '[' + @ColumnName + ']'\n        ELSE\n            SELECT @ColumnValue = CASE \n                                    WHEN DATA_TYPE IN ('char', 'varchar', 'nchar', 'nvarchar') THEN ''''''' + REPLACE([sql_variant], '''', '''''') + ''''''\n                                    WHEN DATA_TYPE IN ('date', 'datetime', 'datetime2', 'smalldatetime') THEN ''''''' + CONVERT(NVARCHAR, [sql_variant], 126) + ''''''\n                                    WHEN DATA_TYPE = 'bit' THEN CAST([sql_variant] AS NVARCHAR)\n                                    ELSE CONVERT(NVARCHAR, [sql_variant])\n                                 END\n            FROM (SELECT COLUMNPROPERTY(OBJECT_ID('##TempTable'), @ColumnName, 'IsNullable') AS IsNullable,\n                         ISNULL(CAST(t.[sql_variant] AS NVARCHAR(MAX)), 'NULL') AS sql_variant\n                  FROM ##TempTable t) x\n            CROSS APPLY INFORMATION_SCHEMA.COLUMNS ic\n            WHERE ic.TABLE_NAME = '##TempTable' AND ic.COLUMN_NAME = @ColumnName\n\n        IF @IsFirst = 1\n            SET @InsertStatement = N'INSERT INTO [' + @TableName + '] (' + CHAR(13)\n        ELSE\n            SET @InsertStatement = ISNULL(@InsertStatement + ', ', '') + REPLACE(ISNULL(@ColumnValue, 'NULL'), '''NULL''', 'NULL') \n\n        IF NOT EXISTS (SELECT TOP 1 Column_Name \n                       FROM INFORMATION_SCHEMA.COLUMNS \n                       WHERE TABLE_NAME = '##TempTable' AND COLUMN_NAME > @ColumnName)\n        BEGIN\n            SET @InsertStatement = SUBSTRING(@InsertStatement + CHAR(13), PATINDEX('% (%)%', @InsertStatement) + 2, LEN(@InsertStatement) - PATINDEX('% (%)%', @InsertStatement)) + ') VALUES (' + CHAR(13)\n\n            -- Close the INSERT statement with a semicolon\n            SET @InsertStatement = SUBSTRING(@InsertStatement + ', ' + @ColumnValue + CHAR(13), 1, LEN(@InsertStatement) - 2) + ');' + CHAR(13)\n        END\n\n        SELECT @IsFirst = CASE WHEN ISNULL(@ColumnName, '') <> '' THEN 0 ELSE 1 END\n    END\n\n    PRINT @InsertStatement;\n    SET @InsertStatement = '';\n\n    DELETE TOP (1) FROM ##TempTable;\nEND\n\n-- Drop the temporary table\nDROP TABLE ##TempTable;