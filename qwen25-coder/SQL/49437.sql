WITH RankedAssignments AS (\n    SELECT \n        m.id, \n        a.type_id, \n        a.assign_id, \n        t.create_date,\n        ROW_NUMBER() OVER (PARTITION BY m.id ORDER BY t.create_date DESC) as rn\n    FROM \n        master m\n    JOIN \n        assignment a ON m.id = a.id\n    JOIN \n        type t ON a.type_id = t.type_id\n)\nSELECT \n    id, \n    type_id, \n    assign_id\nFROM \n    RankedAssignments\nWHERE \n    rn = 1;