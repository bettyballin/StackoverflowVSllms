WITH ActiveChildren AS (\n    SELECT LEVEL child_level, \n           CONNECT_BY_ROOT(id) root_id,\n           id\n    FROM your_table\n    WHERE is_active = 1\n      AND level > 1 -- Assuming level 1 are roots and we want children only\n    START WITH parent_id IS NULL\n    CONNECT BY parent_id = PRIOR id\n),\nMenuHierarchy AS (\n    SELECT LEVEL menu_level, \n           id, \n           name,\n           parent_id,\n           CASE WHEN EXISTS (SELECT 1 FROM ActiveChildren WHERE root_id = t.id) THEN '>' ELSE NULL END as indicator\n    FROM your_table t\n    WHERE is_active = 1\n      AND level > 0 -- Assuming you want to start with level 0 and beyond\n    START WITH parent_id IS NULL\n    CONNECT BY parent_id = PRIOR id\n)\nSELECT menu_level, \n       name,\n       CASE WHEN indicator = '>' THEN '>' ELSE '' END as has_children_indicator\nFROM MenuHierarchy;