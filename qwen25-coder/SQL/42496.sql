ALTER FUNCTION [dbo].[fnSplit2] \n(\n    @OLDSTRING AS VARCHAR(100),\n    @DELIMETER AS VARCHAR(1)\n)\nRETURNS @MYTABLE TABLE(COUNTER INT, STRINGVAL VARCHAR(100)) \nAS\nBEGIN \n    WITH SplitCTE AS (\n        SELECT      \n            1 AS COUNTER,\n            SUBSTRING(@OLDSTRING, 1, CHARINDEX(@DELIMETER, @OLDSTRING) - 1) AS STRINGVAL,\n            CHARINDEX(@DELIMETER, @OLDSTRING) + LEN(@DELIMETER) AS NEXTSTART\n        WHERE \n            @OLDSTRING IS NOT NULL AND @OLDSTRING <> ''\n        \n        UNION ALL\n        \n        SELECT      \n            COUNTER + 1,\n            SUBSTRING(@OLDSTRING, NEXTSTART, CHARINDEX(@DELIMETER, @OLDSTRING, NEXTSTART) - NEXTSTART),\n            CHARINDEX(@DELIMETER, @OLDSTRING, NEXTSTART) + LEN(@DELIMETER)\n        FROM SplitCTE\n        WHERE \n            NEXTSTART <= LEN(@OLDSTRING) AND NEXTSTART > 0\n    )\n    \n    INSERT INTO @MYTABLE (COUNTER, STRINGVAL)\n    SELECT COUNTER, STRINGVAL\n    FROM SplitCTE\n\n    RETURN\nEND