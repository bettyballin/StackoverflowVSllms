WITH \n    recent_orders AS (\n        SELECT * FROM orders WHERE order_date > CURRENT_DATE - INTERVAL '30 days'\n    ),\n    customer_info AS (\n        SELECT customer_id, name, email FROM customers\n    ),\n    detailed_order_report AS (\n        SELECT \n            ro.order_id,\n            ci.name AS customer_name,\n            ci.email AS customer_email,\n            ro.total_amount\n        FROM recent_orders ro\n        JOIN customer_info ci ON ro.customer_id = ci.customer_id\n    )\nSELECT * FROM detailed_order_report;