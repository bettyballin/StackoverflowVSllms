WITH first_name AS (\n    SELECT person_id, name_part\n    FROM NAME_PARTS\n    WHERE name_part_id = 1\n),\nmiddle_name AS (\n    SELECT person_id, name_part\n    FROM NAME_PARTS\n    WHERE name_part_id = 2\n),\nlast_name AS (\n    SELECT person_id, name_part\n    FROM NAME_PARTS\n    WHERE name_part_id = 3\n)\nSELECT \n    first_name.person_id,\n    first_name.name_part AS first_name_part,\n    middle_name.name_part AS middle_name_part,\n    last_name.name_part AS last_name_part\nFROM \n    first_name\nLEFT JOIN \n    middle_name\nON \n    first_name.person_id = middle_name.person_id\nLEFT JOIN \n    last_name\nON \n    first_name.person_id = last_name.person_id;