DECLARE @cols AS NVARCHAR(MAX),\n        @query  AS NVARCHAR(MAX)\n\n-- Step 1: Create column list for pivot\nSELECT @cols = STUFF((SELECT ',' + QUOTENAME(TYPE + '_' + SUBTYPE) \n                     FROM your_table_name\n                     GROUP BY TYPE, SUBTYPE\n                     ORDER BY TYPE, SUBTYPE\n                    FOR XML PATH(''), TYPE).value('.', 'NVARCHAR(MAX)'),1,1,'')\n\n-- Step 2: Construct the dynamic SQL query\nSET @query = '\nSELECT ID, MONTH, ' + @cols + '  \nFROM \n(\n    SELECT ID, TYPE + ''_'' + SUBTYPE AS TypeSubtype, COUNT, MONTH\n    FROM your_table_name\n) x\nPIVOT \n( SUM(COUNT)\n  FOR TypeSubtype IN (' + @cols + ')\n) p'\n\n-- Step 3: Execute the query\nEXEC sp_executesql @query;