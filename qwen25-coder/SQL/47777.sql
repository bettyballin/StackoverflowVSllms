WITH RecentOrdersType1 AS (\n    SELECT\n        userId,\n        orderId,\n        orderType,\n        createDate,\n        ROW_NUMBER() OVER (PARTITION BY userId ORDER BY createDate DESC) as rn\n    FROM\n        orderData\n    WHERE\n        orderType = '1'\n),\nRecentOrdersType2 AS (\n    SELECT\n        userId,\n        orderId,\n        orderType,\n        createDate,\n        ROW_NUMBER() OVER (PARTITION BY userId ORDER BY createDate DESC) as rn\n    FROM\n        orderData\n    WHERE\n        orderType = '2'\n)\nSELECT\n    u.userId,\n    u.name,\n    -- Additional user fields...\n    r1.orderId AS orderId1,\n    r1.orderType AS orderType1,\n    r1.createDate AS createDate1,\n    -- Additional order 1 fields if any...\n    r2.orderId AS orderId2,\n    r2.orderType AS orderType2,\n    r2.createDate AS createDate2\n    -- Additional order 2 fields if any...\nFROM\n    userData u\nLEFT JOIN RecentOrdersType1 r1 ON u.userId = r1.userId AND r1.rn = 1\nLEFT JOIN RecentOrdersType2 r2 ON u.userId = r2.userId AND r2.rn = 1;