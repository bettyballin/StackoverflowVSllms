SELECT \n    YEAR(`date`) as year,\n    MONTH(`date`) as month,\n    SUM(CASE WHEN `answer`=1 THEN 1 ELSE 0 END) as yes,\n    SUM(CASE WHEN `answer`=2 THEN 1 ELSE 0 END) as nope,\n    COUNT(*) as total\nFROM \n    results\nGROUP BY \n    YEAR(`date`), \n    MONTH(`date`)\nORDER BY \n    year, \n    month;