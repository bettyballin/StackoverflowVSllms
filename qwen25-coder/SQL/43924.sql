WITH NumberSequence AS (\n    SELECT TOP (SELECT MAX(Term) FROM PaymentSchedule)\n           ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) AS Num\n    FROM sys.all_columns ac1, sys.all_columns ac2 -- Cartesian product for quick generation\n)\nSELECT \n    ps.SchedID,\n    ns.Num AS PaymentNum,\n    DATEADD(MONTH, (ns.Num - 1) * ps.Frequency, ps.StartDate) AS DueDate,\n    CAST(ps.PaymentAmt * ns.Num AS DECIMAL(10,2)) AS ExpectedTotal\nFROM \n    PaymentSchedule ps\nCROSS JOIN \n    NumberSequence ns\nWHERE \n    ns.Num <= CEILING(CAST(ps.Term AS FLOAT) / ps.Frequency)\nORDER BY \n    ps.SchedID, PaymentNum;