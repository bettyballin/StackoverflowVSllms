-- Create a temporary table to hold the output id and match with original records from B\nDECLARE @TempTable TABLE (OldId INT IDENTITY, NewId INT);\n\nINSERT INTO A (fname, lname)\nOUTPUT INSERTED.id, @TempTable.OldId -- Inserted new identity value and old identity value from temp table\nINTO @TempTable (NewId, OldId)\nSELECT fname, lname\nFROM B;\n\n-- Update Table B with the new values from TempTable\nUPDATE B\nSET NewId = tt.NewId\nFROM B\nJOIN @TempTable tt ON tt.OldId = ROW_NUMBER() OVER (ORDER BY (SELECT NULL));