WITH BalanceComparison AS (\n    SELECT\n        T1.AccountNo,\n        T1.Balance as Balance1,\n        T2.Balance as Balance2,\n        CASE WHEN\n            -- Define match criteria (e.g., within 10% difference)\n            ABS(T1.Balance - T2.Balance) / NULLIF(MAX(T1.Balance, T2.Balance), 0) <= 0.10 THEN 'Match'\n            ELSE 'Mismatch'\n        END as Status\n    FROM Temp1 T1\n    INNER JOIN Temp2 T2 ON T1.AccountNo = T2.AccountNo\n),\nStats AS (\n    SELECT\n        SUM(CASE WHEN Status = 'Match' THEN 1 ELSE 0 END) as TotalMatches,\n        SUM(CASE WHEN Status = 'Mismatch' THEN 1 ELSE 0 END) as TotalMismatches\n    FROM BalanceComparison\n)\nSELECT\n    (TotalMatches * 1.0 / (TotalMatches + TotalMismatches)) * 100 AS MatchPercentage,\n    (TotalMismatches * 1.0 / (TotalMatches + TotalMismatches)) * 100 AS MismatchPercentage,\n    TotalMatches + TotalMismatches AS TotalAccounts\nFROM Stats;