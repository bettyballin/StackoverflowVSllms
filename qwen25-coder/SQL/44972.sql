DECLARE @Table TABLE ([group] INT, isok BIT, x INT, y INT);\nINSERT INTO @Table VALUES\n(20, 0, 1, 1),\n(20, 1, 2, 1),\n(20, 1, 3, 1),\n(20, 0, 1, 2),\n(20, 0, 2, 1),\n(21, 1, 1, 1),\n(21, 0, 2, 1),\n(21, 1, 3, 1),\n(21, 0, 1, 2),\n(21, 1, 2, 2);\n\nWITH OrderedData AS (\n    SELECT\n        t.[group],\n        t.isok,\n        ROW_NUMBER() OVER (PARTITION BY t.[group] ORDER BY t.x, t.y) AS rn\n    FROM @Table t\n)\nSELECT\n    o.[group],\n    STUFF((\n        SELECT CAST(o2.isok AS CHAR(1))\n        FROM OrderedData o2\n        WHERE o2.[group] = o.[group]\n        ORDER BY o2.rn\n        FOR XML PATH(''), TYPE).value('.', 'NVARCHAR(MAX)'), 1, 0, '') AS mask\nFROM OrderedData o\nGROUP BY o.[group];