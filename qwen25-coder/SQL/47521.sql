DECLARE \n    objName varchar2(50);\n    FileName varchar2(50);\n    ddl CLOB;\n    f UTL_FILE.FILE_TYPE;\n\n    cursor curProcs is\n        select OBJECT_NAME into objName\n          FROM ALL_PROCEDURES WHERE OWNER = 'AMS' \n          ORDER BY OBJECT_NAME; -- get all procs in db\nBEGIN\n    open curProcs;\n    LOOP\n        FETCH curProcs INTO objName;\n        EXIT WHEN curProcs%NOTFOUND;\n\n        ddl := DBMS_METADATA.GET_DDL('PROCEDURE', objName, 'AMS');\n        \n        FileName := objName || '.PRC.SQL';\n        f := UTL_FILE.FOPEN('SPOOLDIR', FileName, 'w');\n\n        IF f IS NOT NULL THEN\n            UTL_FILE.PUT_LINE(f, ddl);\n            UTL_FILE.FCLOSE(f);\n        END IF;\n    END LOOP;\n\n    CLOSE curProcs;\nEXCEPTION\n    WHEN OTHERS THEN\n        IF UTL_FILE.IS_OPEN(f) THEN\n            UTL_FILE.FCLOSE(f);\n        END IF;\n        DBMS_OUTPUT.PUT_LINE('Error: ' || SQLERRM);\nEND;