-- Declare variables to hold dynamic SQL command\nDECLARE @SQL NVARCHAR(MAX);\nDECLARE @SPName NVARCHAR(50);\nDECLARE @GroupExpression NVARCHAR(100);\n\n-- Function to create a single stored procedure\nCREATE PROCEDURE [dbo].[CreateDynamicSP]\n    @vName NVARCHAR(50),\n    @vGroup NVARCHAR(100)\nAS\nBEGIN\n    SET @SQL = N'\n    CREATE PROCEDURE ' + QUOTENAME(@vName) + N'\n        @StartDate varchar(50),\n        @EndDate varchar(50)\n    AS \n    BEGIN\n        SELECT ' + @vGroup + N' AS GroupField,\n               SUM([Project].[NumProject]) AS TotalProject,\n               SUM([Project].[Title]) AS SumTitle,\n               SUM([Project].[Duration]) AS SumDuration,\n               SUM([Project].[Info]) AS SumInfo,\n               SUM([Customer].[NumCustomer]) AS TotalNumCustomer,\n               SUM([Orders].[NumOrders]) AS TotalNumOrders,\n               SUM([OrderInspection].[NumInspects]) AS TotalNumInspects,\n               SUM([OrderInspection].[NumFails]) AS TotalNumFails,\n               SUM([CustomerInspection].[NumInspects]) AS TotalNumCustomerInspectionInspects,\n               SUM([CustomerInspection].[NumFails]) AS TotalNumCustomerInspectionFails,\n               SUM([Measurements].[NumMeasurements]) AS TotalNumMeasurementss\n        FROM ((((((sale \n                    LEFT JOIN Project ON [sale].[saleId] = [Project].[saleId])\n                   LEFT JOIN Customer ON [Project].[PrintId] = [Customer].[PrintId])\n                  LEFT JOIN Orders ON [Project].[PrintId] = [Orders].[PrintId])\n                 LEFT JOIN OrderInspection ON [Project].[PrintId] = [OrderInspection].[PrintId])\n                LEFT JOIN CustomerInspection ON [Project].[PrintId] = [CustomerInspection].[PrintId])\n               LEFT JOIN Measurements ON [Project].[PrintId] = [Measurements].[PrintId])\n        WHERE [sale].[DateTime] BETWEEN dbo.FormatDateTime((@StartDate), ''yyyy-mm-dd'')\n                                       AND dbo.FormatDateTime((@Enddate), ''yyyy-mm-dd'')\n        GROUP BY ' + @vGroup + N'\n        ORDER BY ' + @vGroup + ';\n    END';\n\n    -- Execute the SQL command to create the procedure\n    EXEC sp_executesql @SQL;\nEND;\n\n-- Create each SP using the function created above\nEXEC [dbo].[CreateDynamicSP] N'SummaryNone', N'YEAR([sale].[DateTime])';\nEXEC [dbo].[CreateDynamicSP] N'SummaryUser', N'[sale].[User]';\nEXEC [dbo].[CreateDynamicSP] N'SummarySale', N'[sale].[Sale]';\nEXEC [dbo].[CreateDynamicSP] N'SummaryBatch', N'[sale].[Batch]';\nEXEC [dbo].[CreateDynamicSP] N'SummaryDay', N'dbo.FormatDateTime([sale].[DateTime], ''yyyy-mm-dd'')';\nEXEC [dbo].[CreateDynamicSP] N'SummaryMonth', N'dbo.FormatDateTime(dbo.DateSerial(YEAR([sale].[DateTime]), MONTH([sale].[DateTime]), 1), ''yyyy-mm-dd'')';\nEXEC [dbo].[CreateDynamicSP] N'SummaryYear', N'YEAR([sale].[DateTime])';\n\n-- Drop the function after use\nDROP PROCEDURE [dbo].[CreateDynamicSP];