-- Create a temporary table to hold imported Excel data\nCREATE TABLE #TempData(\n    cedeviceid varchar(50),\n    vanwarehouse varchar(50),\n    username varchar(50),\n    devicesimnumber varchar(50),\n    UserGroup varchar(50),\n    ServiceMgr varchar(50)\n);\n\n-- Pretend we insert the data here (you'll use DTS or some other method)\nINSERT INTO #TempData(cedeviceid, vanwarehouse, username, devicesimnumber, UserGroup, ServiceMgr)\nSELECT cedeviceid, vanwarehouse, username, devicesimnumber, UserGroup, ServiceMgr\nFROM openrowset('Microsoft.Jet.OLEDB.4.0', 'Excel 8.0;Database=C:\\path_to_your_excel\\file.xls;', \n'SELECT * FROM [Sheet1$]');\n\n-- Variable to hold the last SenderCode value from the actual table\nDECLARE @LastSenderCode INT;\n-- Fetch the highest existing sendercode, if any\nSELECT @LastSenderCode = MAX(CAST(SUBSTRING(sendercode, 3, LEN(sendercode)) AS INT))\nFROM mw_gsmprofile;\n\nIF @LastSenderCode IS NULL SET @LastSenderCode = 0; -- Start from 0 if no data exists\n\n-- Insert the data into the actual table with incremented sendercode\nINSERT INTO mw_gsmprofile (cedeviceid, vanwarehouse, username, devicesimnumber, UserGroup, ServiceMgr, sendercode)\nSELECT cedeviceid, vanwarehouse, username ,devicesimnumber, UserGroup, ServiceMgr,\n       'SC' + RIGHT('00000' + CAST((@LastSenderCode := @LastSenderCode + 1) AS VARCHAR(5)), 5) as sendercode\nFROM #TempData;\n\n-- Clean up temp table\nDROP TABLE #TempData;