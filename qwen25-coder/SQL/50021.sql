WITH DateRanges AS (\n    SELECT \n        StudentID, StartDate, EndDate, Field1, Field2,\n        ROW_NUMBER() OVER (PARTITION BY StudentID ORDER BY StartDate) - ROW_NUMBER() OVER (PARTITION BY StudentID, Field1, Field2 ORDER BY StartDate) AS grp\n    FROM \n        YourTableName\n),\nMergedRanges AS (\n    SELECT \n        StudentID, Field1, Field2,\n        MIN(StartDate) AS StartDate,\n        MAX(EndDate) AS EndDate\n    FROM \n        DateRanges\n    GROUP BY \n        StudentID, Field1, Field2, grp\n)\nSELECT * FROM MergedRanges;