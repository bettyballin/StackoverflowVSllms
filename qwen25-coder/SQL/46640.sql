CREATE PROCEDURE sp_PagedQuery\n    @PageNumber INT,\n    @PageSize INT\nAS\nBEGIN\n    DECLARE @StartRow INT\n    SELECT @StartRow = (@PageNumber - 1) * @PageSize\n\n    SET ROWCOUNT @StartRow\n    SELECT FooID, Bar INTO #Temp FROM SomeTable ORDER BY FooID\n\n    SET ROWCOUNT @PageSize\n    SELECT FooID, Bar FROM SomeTable WHERE FooID > (SELECT MAX(FooID) FROM #Temp) ORDER BY FooID\n\n    DROP TABLE #Temp\nEND