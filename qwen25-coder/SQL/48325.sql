SELECT \n    Transaction_Date, \n    Transaction_Qty, \n    Transaction_Value, \n    COUNT(*) AS Count\nFROM \n    Transactions t1\nWHERE \n    NOT EXISTS (\n        SELECT 1 \n        FROM Transactions t2 \n        WHERE t1.Transaction_Date = t2.Transaction_Date \n          AND ABS(t1.Transaction_Qty) = ABS(t2.Transaction_Qty) \n          AND ABS(t1.Transaction_Value) = ABS(t2.Transaction_Value) \n          AND t2.Reversal = 'Y'\n    )\nGROUP BY \n    Transaction_Date, \n    Transaction_Qty, \n    Transaction_Value\nHAVING \n    COUNT(*) > 1;