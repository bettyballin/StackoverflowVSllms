WITH RankedMessages AS (\n    SELECT \n        MessageID,\n        CategoryID,\n        Priority,\n        MessageText,\n        ROW_NUMBER() OVER (PARTITION BY CategoryID ORDER BY Priority DESC) as RowNum\n    FROM \n        YourTableName -- Replace with your actual table name\n)\nSELECT \n    MessageID,\n    CategoryID,\n    Priority,\n    MessageText\nFROM \n    RankedMessages\nWHERE \n    RowNum = 1;