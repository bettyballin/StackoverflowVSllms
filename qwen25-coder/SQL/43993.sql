CREATE PROCEDURE [dbo].[sp_FindMatches] @SearchString varchar(30)\nAS\nBEGIN\n    DECLARE @Words TABLE (Word varchar(30))\n    -- Populate the table with each word in the search string\n    INSERT INTO @Words (Word) \n    SELECT value FROM STRING_SPLIT(@SearchString, ' ')\n\n    -- Select and rank according to the match criteria\n    SELECT *, \n        CASE \n            WHEN Field1 + ' ' + Field2 = @SearchString THEN 1 -- Exact match\n            WHEN (CHARINDEX(Field1 + ' ' + Field2, @SearchString) > 0 OR CHARINDEX(@SearchString, Field1 + ' ' + Field2) > 0) THEN 2 -- Substring match within the search string or vice-versa\n            ELSE \n                (SELECT COUNT(*) FROM @Words WHERE CHARINDEX(Word, Field1 + ' ' + Field2) > 0) -- Count of individual words found\n        END AS MatchRank\n    FROM Table1\n    ORDER BY MatchRank ASC; -- Rank results by match quality\nEND;