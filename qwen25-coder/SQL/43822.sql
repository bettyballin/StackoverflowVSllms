WITH DateRanges AS (\n    SELECT \n        ID,\n        effdate,\n        termdate,\n        CASE \n            WHEN COALESCE(DATEDIFF(day, (SELECT MAX(termdate) FROM your_table t2 WHERE t2.termdate < t1.effdate), '1900-01-01'), 0) + 1 = DATEDIFF(day, effdate, termdate)\n                THEN 1\n            ELSE 0\n        END AS IsStartOfSegment\n    FROM your_table t1\n),\nNumberedRanges AS (\n    SELECT \n        ID,\n        effdate,\n        termdate,\n        SUM(IsStartOfSegment) OVER (ORDER BY effdate ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS SegmentGroup\n    FROM DateRanges\n)\nSELECT \n    MIN(effdate) AS MinEffDate,\n    MAX(termdate) AS MaxTermDate\nFROM NumberedRanges\nGROUP BY SegmentGroup;