WITH RankedAnswers AS (\n    SELECT \n        ta.ShopID,\n        q.QuestionText,\n        qa.AnswerText,\n        ta.Created,\n        ROW_NUMBER() OVER (PARTITION BY ta.ShopID, q.QuestionText ORDER BY ta.Created DESC) as rn\n    FROM \n        tblTransactionAnswer qa\n    JOIN \n        tblQuestion q ON qa.QuestionId = q.Id\n    JOIN \n        tblTransaction ta ON qa.TransactionID = ta.ID\n)\nSELECT \n    ShopID,\n    QuestionText,\n    AnswerText,\n    Created\nFROM \n    RankedAnswers\nWHERE \n    rn = 1;