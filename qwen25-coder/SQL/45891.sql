WITH RankedWins AS (\n    SELECT \n        id,\n        user,\n        winner,\n        profit,\n        created,\n        ROW_NUMBER() OVER(PARTITION BY user ORDER BY created) - \n        SUM(winner) OVER(PARTITION BY user ORDER BY created) AS grp\n    FROM your_table_name\n    WHERE winner = 1\n),\nGroupedWins AS (\n    SELECT\n        MIN(created) AS first_created,\n        MAX(created) AS last_created,\n        COUNT(*) AS consecutive_wins,\n        SUM(profit) AS total_profit\n    FROM RankedWins \n    GROUP BY user, grp\n)\nSELECT\n    consecutive_wins,\n    first_created,\n    last_created,\n    total_profit\nFROM GroupedWins\nORDER BY consecutive_wins DESC\nLIMIT 1;