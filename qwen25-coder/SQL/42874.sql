INSERT INTO MainTable_Option ([MainTableID], [OptionID])\nSELECT ID, Option1.OptionID FROM DodgyOldTable\nJOIN (\n    SELECT CASE WHEN OptionVal1 = 'y' THEN (SELECT OptionID FROM Option WHERE OptionDesc = 'OptionVal1') END AS OptionID\n    FROM DodgyOldTable\n    UNION ALL\n    SELECT CASE WHEN OptionVal2 = 'y' THEN (SELECT OptionID FROM Option WHERE OptionDesc = 'OptionVal2') END AS OptionID\n    FROM DodgyOldTable\n    UNION ALL\n    SELECT CASE WHEN OptionVal3 = 'y' THEN (SELECT OptionID FROM Option WHERE OptionDesc = 'OptionVal3') END AS OptionID\n    FROM DodgyOldTable\n) AS Options ON DodgyOldTable.ID = Subquery.ID;