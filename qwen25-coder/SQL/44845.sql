WITH RECURSIVE CommentHierarchy AS (\n    -- Select all the parent comments\n    SELECT Id, ParentId, Comment, CommentDate\n    FROM Comments\n    WHERE ParentId = 0\n\n    UNION ALL\n\n    -- Recursively select the replies to each comment\n    SELECT c.Id, c.ParentId, c.Comment, c.CommentDate\n    FROM Comments c\n    INNER JOIN CommentHierarchy ch ON c.ParentId = ch.Id\n)\nSELECT * FROM CommentHierarchy\nORDER BY CASE WHEN ParentId != 0 THEN Id ELSE NULL END ASC,\n         CASE WHEN ParentId != 0 THEN ParentId ELSE Id END;