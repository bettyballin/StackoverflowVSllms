SELECT \n    Brand, \n    CASE \n        WHEN SUM(CASE WHEN HasWorms = 1 THEN 1 ELSE 0 END) > 0 THEN 0\n        ELSE 1\n    END AS IsUnspoiled\nFROM \n    Apples\nGROUP BY \n    Brand;