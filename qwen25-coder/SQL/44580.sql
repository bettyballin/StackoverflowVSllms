WITH RankedUsers AS (\n    SELECT \n        Username, \n        EmailActivationCode, \n        Email,\n        ROW_NUMBER() OVER (PARTITION BY Email ORDER BY Id) AS rn\n    FROM \n        Users\n    WHERE \n        IsActivated = 0 -- Assuming there's a flag to check if the user is activated or not\n)\nSELECT \n    Username, \n    EmailActivationCode, \n    Email\nFROM \n    RankedUsers\nWHERE \n    rn = 1;