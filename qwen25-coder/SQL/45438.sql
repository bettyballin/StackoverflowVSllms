SELECT\n  v.[VISITDATE], \n  CONVERT(VARCHAR, v.[STARTTIME], 105) AS 'StartDate', \n  CONVERT(VARCHAR, v.[STARTTIME], 108) AS 'StartTime', \n  CONVERT(VARCHAR, v.[bookeddate], 105) AS 'BookedDate', \n  CONVERT(VARCHAR, t.[starttime], 108) AS 'TimeSlotStart', \n  CONVERT(VARCHAR, t.[endtime], 108) AS 'TimeSlotEnd',\n  CASE \n    WHEN CAST(v.[bookeddate] AS DATETIME) + t.[starttime] <= v.[STARTTIME]\n     AND v.[STARTTIME] <= CAST(v.[bookeddate] AS DATETIME) + t.[endtime]\n    THEN 'True'\n    ELSE 'False'\n  END AS 'InTimeSlot',\n  v.[Status]       \nFROM\n  [tbl_repair_visit] v \nINNER JOIN \n  [ltbl_TimeSlots] t ON v.timeslot = t.[Slot];