WITH RECURSIVE SlotSequence AS (\n    SELECT 1 AS slot\n    UNION ALL\n    SELECT slot + 1\n    FROM SlotSequence\n    WHERE slot < (SELECT MAX(Slots) FROM your_table)\n),\nNameMaxSlot AS (\n    SELECT Name, MAX(Slots) AS max_slot\n    FROM your_table\n    GROUP BY Name\n)\nSELECT n.Name, \n       SUM(CASE WHEN s.slot <= t.Slots THEN t.SlotValue ELSE 0 END) AS SlotSum,\n       s.slot\nFROM SlotSequence s\nCROSS JOIN NameMaxSlot n\nLEFT JOIN your_table t ON t.Name = n.Name AND s.slot <= t.Slots\nGROUP BY n.Name, s.slot\nORDER BY n.Name, s.slot;