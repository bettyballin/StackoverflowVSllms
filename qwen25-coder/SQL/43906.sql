SELECT \n    id, -- Assuming there is some identifier in your table\n    MAX(CASE WHEN DATEPART(MONTH, '2023-01-01') BETWEEN DATEPART(MONTH, start_date) AND DATEPART(MONTH, end_date) THEN 1 ELSE 0 END) AS Jan,\n    MAX(CASE WHEN DATEPART(MONTH, '2023-02-01') BETWEEN DATEPART(MONTH, start_date) AND DATEPART(MONTH, end_date) THEN 1 ELSE 0 END) AS Feb,\n    MAX(CASE WHEN DATEPART(MONTH, '2023-03-01') BETWEEN DATEPART(MONTH, start_date) AND DATEPART(MONTH, end_date) THEN 1 ELSE 0 END) AS Mar,\n    MAX(CASE WHEN DATEPART(MONTH, '2023-04-01') BETWEEN DATEPART(MONTH, start_date) AND DATEPART(MONTH, end_date) THEN 1 ELSE 0 END) AS Apr,\n    MAX(CASE WHEN DATEPART(MONTH, '2023-05-01') BETWEEN DATEPART(MONTH, start_date) AND DATEPART(MONTH, end_date) THEN 1 ELSE 0 END) AS May,\n    MAX(CASE WHEN DATEPART(MONTH, '2023-06-01') BETWEEN DATEPART(MONTH, start_date) AND DATEPART(MONTH, end_date) THEN 1 ELSE 0 END) AS Jun,\n    MAX(CASE WHEN DATEPART(MONTH, '2023-07-01') BETWEEN DATEPART(MONTH, start_date) AND DATEPART(MONTH, end_date) THEN 1 ELSE 0 END) AS Jul,\n    MAX(CASE WHEN DATEPART(MONTH, '2023-08-01') BETWEEN DATEPART(MONTH, start_date) AND DATEPART(MONTH, end_date) THEN 1 ELSE 0 END) AS Aug,\n    MAX(CASE WHEN DATEPART(MONTH, '2023-09-01') BETWEEN DATEPART(MONTH, start_date) AND DATEPART(MONTH, end_date) THEN 1 ELSE 0 END) AS Sep,\n    MAX(CASE WHEN DATEPART(MONTH, '2023-10-01') BETWEEN DATEPART(MONTH, start_date) AND DATEPART(MONTH, end_date) THEN 1 ELSE 0 END) AS Oct,\n    MAX(CASE WHEN DATEPART(MONTH, '2023-11-01') BETWEEN DATEPART(MONTH, start_date) AND DATEPART(MONTH, end_date) THEN 1 ELSE 0 END) AS Nov,\n    MAX(CASE WHEN DATEPART(MONTH, '2023-12-01') BETWEEN DATEPART(MONTH, start_date) AND DATEPART(MONTH, end_date) THEN 1 ELSE 0 END) AS Dec\nFROM \n    your_table_name\nGROUP BY \n    id;