ALTER PROCEDURE [YourSchema].[YourProcedure]\nAS\nBEGIN\n    -- Start the main transaction\n    BEGIN TRANSACTION;\n\n    BEGIN TRY\n        -- Perform local transactional work here\n        INSERT INTO LocalTable (Col1, Col2)\n        VALUES ('Value1', 'Value2');\n\n        -- Execute non-transactional work on linked server\n        EXEC LinkedServer.RemoteDB.dbo.sp_executesql N'\n            BEGIN TRANSACTION;\n            INSERT INTO RemoteTable (Col1, Col2) \n            VALUES (@value1, @value2);\n            COMMIT TRANSACTION;', N'@value1 NVARCHAR(50), @value2 NVARCHAR(50)', 'Value3', 'Value4';\n\n        -- Commit the main transaction\n        COMMIT TRANSACTION;\n    END TRY\n    BEGIN CATCH\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\n\n        DECLARE @ErrorMessage NVARCHAR(4000);\n        DECLARE @ErrorSeverity INT;\n        DECLARE @ErrorState INT;\n\n        SELECT \n            @ErrorMessage = ERROR_MESSAGE(),\n            @ErrorSeverity = ERROR_SEVERITY(),\n            @ErrorState = ERROR_STATE();\n\n        RAISERROR (@ErrorMessage, @ErrorSeverity, @ErrorState);\n    END CATCH\nEND;