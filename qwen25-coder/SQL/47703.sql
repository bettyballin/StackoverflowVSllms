OPTIONS (SKIP=1)\nLOAD DATA\nINFILE 'your_data_file.csv'\nBADFILE 'your_data_file.bad'\nDISCARDFILE 'your_data_file.dsc'\nAPPEND\nINTO TABLE POSITION\nWHEN RECORD_ID = '@@@08016995BUILD  12/15/04POSITION'\nFIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"'\nTRAILING NULLCOLS (\n    FIELD1,\n    FIELD2,\n    FIELD3,\n    FIELD4,\n    FIELD5 "TO_NUMBER(:FIELD5)"\n)\n\nINTO TABLE SECDESC\nWHEN RECORD_ID = '@@@08016995BUILD  12/15/04SECDESC'\nFIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"'\nTRAILING NULLCOLS (\n    FIELD1,\n    FIELD2,\n    FIELD3,\n    FIELD4,\n    FIELD5,\n    FIELD6,\n    FIELD7 "TO_NUMBER(:FIELD7)",\n    FIELD8,\n    FIELD9 "TO_NUMBER(:FIELD9)"\n)\n\nINTO TABLE CUSTOMER\nWHEN RECORD_ID = '@@@08016995BUILD  12/15/04CUSTOMER'\nFIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"'\nTRAILING NULLCOLS (\n    FIELD1,\n    FIELD2,\n    FIELD3,\n    FIELD4,\n    FIELD5,\n    FIELD6,\n    FIELD7,\n    FIELD8,\n    FIELD9,\n    FIELD10,\n    FIELD11,\n    FIELD12,\n    FIELD13,\n    FIELD14\n)\n\n-- Custom logic to extract the record identifier which acts as a control record\n-- Note: We are also using preceeded by function to get the right line into each table\nBEFORE LOAD EXECUTE FUNCTION SET_ENV('RECORD_ID', SUBSTR(:COLUMN01, 1, 27)) OPTIONALLY ENCLOSED BY '"'