WITH HierarchicalData AS (\n    SELECT \n        SEQ, \n        LVL, \n        DESCR,\n        SYS_CONNECT_BY_PATH(DESCR, ' > ') AS PATH\n    FROM TEST\n    START WITH LVL = 1\n    CONNECT BY PRIOR SEQ < SEQ\n           AND PRIOR LVL <= LVL\n)\n\nSELECT \n    SEQ,\n    MAX(CASE WHEN LEVEL = 1 THEN REGEXP_SUBSTR(PATH, '[^>]+', 1) END) AS L1,\n    MAX(CASE WHEN LEVEL = 2 THEN REGEXP_SUBSTR(PATH, '[^>]+', 1, 2) END) AS L2,\n    MAX(CASE WHEN LEVEL = 3 THEN REGEXP_SUBSTR(PATH, '[^>]+', 1, 3) END) AS L3\nFROM HierarchicalData\nCONNECT BY PRIOR SEQ < SEQ AND PRIOR LVL <= LVL\nGROUP BY SEQ\nORDER BY SEQ;