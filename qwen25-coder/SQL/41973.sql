DECLARE @SourceTable SYSNAME = 'OriginalTable';\nDECLARE @TargetTable SYSNAME = 'BackupTable';\n\n-- Generate index creation scripts\nSELECT \n   'CREATE ' + \n   CASE WHEN i.is_unique = 1 THEN 'UNIQUE ' ELSE '' END +\n   i.type_desc COLLATE DATABASE_DEFAULT + \n   ' INDEX [' + i.name collate database_default + '] ON [' +\n   @TargetTable +\n   '](' +\n   KeyColumns +\n   ')' +\n   CASE WHEN i.included_columns > '' THEN ' INCLUDE (' + included_columns + ') ' ELSE '' END +\n   ';'\nAS CreateIndexScript\nFROM \n(\n    SELECT \n        ic.object_id, index_id, \n        STUFF((\n                SELECT ', ' + COL_NAME(ic2.object_id,ic2.column_id) \n                  FROM sys.index_columns ic2 \n                 WHERE ic2.object_id = ic1.object_id AND ic2.index_id = ic1.index_Id AND is_included_column = 0\n                FOR XML PATH(''), TYPE).value('.', 'NVARCHAR(MAX)'), 1, 2, '') AS KeyColumns,\n        STUFF((\n                SELECT ', ' + COL_NAME(object_id,column_id) \n                  FROM sys.index_columns \n                 WHERE object_id = ic.object_id AND index_id = ic.Index_Id AND is_included_column = 1\n                FOR XML PATH(''), TYPE).value('.', 'NVARCHAR(MAX)'), 1, 2, '') AS included_columns,\n        i.name, i.is_unique, i.type_desc, ic.column_id\n    FROM sys.index_columns ic\n    INNER JOIN sys.indexes i ON ic.object_id = i.object_id AND ic.Index_Id = i.Index_Id\n    WHERE OBJECT_NAME(ic.object_id) = @SourceTable AND index_id > 0\n) ic\nWHERE ic.column_id = 1;