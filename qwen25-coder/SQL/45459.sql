WITH UniqueChecks AS (\n    SELECT \n        customer_number,\n        customer_name,\n        customer_address,\n        COUNT(*) as occurrence_count\n    FROM unprocessed_invoices\n    GROUP BY \n        customer_number, \n        customer_name, \n        customer_address\n)\nSELECT CASE WHEN MAX(occurrence_count) > 1 THEN RAISE_APPLICATION_ERROR(-20001, 'Duplicate customer data found.') END as error_check\nFROM UniqueChecks;