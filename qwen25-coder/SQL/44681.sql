-- T-SQL script for checking SQL Logins password strength on SQL Server 2000 and 2005\n\nSET NOCOUNT ON;\n\nDECLARE @username NVARCHAR(128);\nDECLARE @password NVARCHAR(128);\nDECLARE @minLength INT = 8;\nDECLARE @hasUpper BIT, @hasLower BIT, @hasDigit BIT, @hasSpecial BIT;\n\n-- Create a temporary table to store login names with weak passwords\nCREATE TABLE #WeakLogins (\n    Username NVARCHAR(128)\n);\n\nDECLARE UserCursor CURSOR FOR\nSELECT name, password \nFROM master.dbo.sysxlogins \nWHERE issqluser = 1; -- Only SQL Server logins\n\nOPEN UserCursor;\n\nFETCH NEXT FROM UserCursor INTO @username, @password;\n\nWHILE @@FETCH_STATUS = 0\nBEGIN\n    SET @hasUpper = CASE WHEN PATINDEX('%[A-Z]%', @password) > 0 THEN 1 ELSE 0 END;\n    SET @hasLower = CASE WHEN PATINDEX('%[a-z]%', @password) > 0 THEN 1 ELSE 0 END;\n    SET @hasDigit = CASE WHEN PATINDEX('%[0-9]%', @password) > 0 THEN 1 ELSE 0 END;\n    SET @hasSpecial = CASE WHEN PATINDEX('%[^A-Za-z0-9]%', @password) > 0 THEN 1 ELSE 0 END;\n\n    IF LEN(@password) < @minLength OR \n       @hasUpper = 0 OR \n       @hasLower = 0 OR \n       @hasDigit = 0 OR \n       @hasSpecial = 0\n    BEGIN\n        INSERT INTO #WeakLogins (Username) VALUES (@username);\n    END\n\n    FETCH NEXT FROM UserCursor INTO @username, @password;\nEND;\n\nCLOSE UserCursor;\nDEALLOCATE UserCursor;\n\n-- Check for any weak logins found\nSELECT 'Weak SQL Logins:' AS Info, Username FROM #WeakLogins;\n\nDROP TABLE #WeakLogins;