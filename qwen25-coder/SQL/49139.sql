SELECT \n  c.COMPANY_NAME,\n  MAX(CASE WHEN SUBSTR(p.PRODUCT_NAME, 1, 30) = 'ProductA' THEN ps.SALE_COUNT END) AS ProdA_Sales,\n  MAX(CASE WHEN SUBSTR(p.PRODUCT_NAME, 1, 30) = 'ProductB' THEN ps.SALE_COUNT END) AS ProdB_Sales\n-- Add more products as necessary with unique aliases\nFROM \n  COMPANY c\nJOIN \n  PRODUCT_SALE ps ON c.ID_COMPANY = ps.ID_COMPANY\nJOIN \n  PRODUCT p ON ps.ID_PRODUCT = p.ID_PRODUCT\nGROUP BY \n  c.COMPANY_NAME;