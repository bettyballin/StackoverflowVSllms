-- Example transaction for updating credits\nBEGIN;\n\n-- Select the current value and version\nSELECT creds, version FROM credits WHERE user_id = 1 FOR KEY SHARE;\n\n-- Assume app logic calculates new_creds_value here\n\n-- Update only if the version hasn't changed since the read\nUPDATE credits \nSET creds = new_creds_value, \n    version = version + 1 \nWHERE user_id = 1 AND version = current_version_from_select;\n\nCOMMIT;