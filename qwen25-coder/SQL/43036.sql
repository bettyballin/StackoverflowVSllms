CREATE OR REPLACE FUNCTION validate_session_token(p_username IN VARCHAR2, p_token IN VARCHAR2) RETURN NUMBER IS\nBEGIN\n    DECLARE\n        v_stored_token session_tokens.token%TYPE;\n        CURSOR c_token IS SELECT token FROM session_tokens WHERE username = p_username AND SYSTIMESTAMP - created < INTERVAL '10' MINUTE;\n        \n        OPEN c_token;\n        FETCH c_token INTO v_stored_token;\n        \n        IF (v_stored_token IS NULL OR v_stored_token <> p_token) THEN\n            CLOSE c_token;\n            RETURN 0; -- Invalid token\n        ELSE\n            CLOSE c_token;\n            DELETE FROM session_tokens WHERE username = p_username AND token = p_token; -- Invalidate the token after use\n            COMMIT;\n            RETURN 1; -- Valid token\n        END IF;\n    EXCEPTION\n        WHEN OTHERS THEN\n            CLOSE c_token;\n            RETURN 0; -- Exception encountered, treat as invalid\n    END;\nEND validate_session_token;