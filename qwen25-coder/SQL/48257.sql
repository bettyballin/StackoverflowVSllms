DECLARE @BatchSize INT = 10000; -- Adjust batch size as necessary\nDECLARE @CurrentOffset INT = 0;\nDECLARE @RowsAffected INT = @BatchSize;\n\nCREATE TABLE #tempMatchResult\n(\n    matchId VARCHAR(50)\n);\n\nWHILE @RowsAffected = @BatchSize\nBEGIN\n    INSERT INTO #tempMatchResult (matchId)\n    SELECT TOP (@BatchSize) MatchId \n    FROM MatchResult \n    WHERE SOME_CONDITION AND matchId NOT IN (SELECT matchId FROM #tempMatchResult)\n    ORDER BY matchId; -- Order by a column that is indexed for performance\n\n    SET @RowsAffected = @@ROWCOUNT;\n\n    IF @RowsAffected > 0\n    BEGIN\n        DELETE TOP (@BatchSize) m \n        FROM MatchEvent m \n        INNER JOIN #tempMatchResult t ON m.MatchId = t.matchId;\n        \n        DELETE TOP (@BatchSize) m \n        FROM MatchResult m \n        INNER JOIN #tempMatchResult t ON m.MatchId = t.matchId;\n\n        SET @CurrentOffset = @CurrentOffset + @BatchSize;\n    END\nEND\n\nDROP TABLE #tempMatchResult;