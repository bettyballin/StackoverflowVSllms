SELECT \n    COUNT(Z.IDX) AS Count,\n    XY.IDX,\n    XY.IDY\nFROM (\n    SELECT X.ID AS IDX, Y.ID AS IDY\n    FROM X\n    CROSS JOIN Y\n) XY\nLEFT JOIN Z ON XY.IDX = Z.IDX AND XY.IDY = Z.IDY\nGROUP BY XY.IDX, XY.IDY\nORDER BY XY.IDX, XY.IDY;