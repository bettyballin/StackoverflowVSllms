CREATE TRIGGER trg_EnsureSingleActiveEntityAttributeRelationship \nON [dbo].[EntityAttributeRelship]\nAFTER INSERT, UPDATE AS\nBEGIN\n    SET NOCOUNT ON;\n\n    -- Check if more than one IsActive=1 for the same EntityIdNmb exists\n    IF EXISTS (\n        SELECT EntityIdNmb\n        FROM (\n            SELECT EntityIdNmb,\n                   SUM(CASE WHEN IsActive = 1 THEN 1 ELSE 0 END) AS ActiveCount\n            FROM [dbo].[EntityAttributeRelship]\n            GROUP BY EntityIdNmb\n        ) t\n        WHERE t.ActiveCount > 1\n    )\n    BEGIN\n        RAISERROR ('An Entity cannot have more than one active attribute relationship.', 16, 1);\n        ROLLBACK TRANSACTION;\n    END;\nEND;