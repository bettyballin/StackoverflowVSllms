CREATE FUNCTION dbo.SplitStrings_XML\n( \n    @List       NVARCHAR(MAX),\n    @Delimiter  CHAR(1)\n)\nRETURNS TABLE\nAS\nRETURN \n(\n    SELECT DISTINCT LTRIM(RTRIM(Split.a.value('.', 'NVARCHAR(MAX)'))) AS Recipient\n    FROM\n    (\n        SELECT CAST('<S>' + REPLACE(@List, @Delimiter, '</S><S>') + '</S>' AS XML).value('.', 'NVARCHAR(MAX)') AS String\n    ) AS X(x)\n    CROSS APPLY x.String.nodes('/S') AS Split(a)\n);