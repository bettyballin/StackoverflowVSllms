-- Assuming you have an enum or integer for statuses (e.g., 0 = pending, 1 = in_progress)\nBEGIN;\n\nUPDATE tasks\nSET status = 1  -- Set status to 'in progress'\nWHERE id IN (\n    SELECT id FROM tasks\n    WHERE status = 0  -- Only select where status is 'pending'\n    ORDER BY id       -- Optional: order by any criteria for fair distribution\n    LIMIT 100         -- Limit chunk size\n    FOR UPDATE SKIP LOCKED   -- Lock rows in an exclusive manner; skip already locked ones\n)\nRETURNING id;\n\nCOMMIT;