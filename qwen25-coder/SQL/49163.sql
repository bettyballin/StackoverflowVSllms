WITH Hours AS (\n    SELECT 0 AS hour\n    UNION ALL\n    SELECT hour + 1\n    FROM Hours\n    WHERE hour < 23\n),\nOrderCounts AS (\n    SELECT DATEPART(hh, order_date) AS order_hour, COUNT(order_id) AS total_orders\n    FROM ORDERS\n    GROUP BY DATEPART(hh, order_date)\n)\nSELECT h.hour AS hour_of_day,\n       COALESCE(oc.total_orders, 0) AS number_of_orders\nFROM Hours h\nLEFT JOIN OrderCounts oc ON h.hour = oc.order_hour\nORDER BY h.hour;