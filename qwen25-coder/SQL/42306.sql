CREATE OR ALTER PROCEDURE ForwardDemoDataDates\nAS\nBEGIN\n    DECLARE @LastForwardedDate DATE;\n    -- Assume DemoAccountSettings is a table where you store when the demo data was last forwarded\n    SELECT @LastForwardedDate = LastForwardedDateTime\n    FROM DemoAccountSettings\n    WHERE AccountType = 'Demo';\n\n    IF DATEDIFF(DAY, @LastForwardedDate, GETDATE()) >= 30\n    BEGIN\n        DECLARE @SQL NVARCHAR(MAX) = N'';\n        DECLARE @TableName SYSNAME;\n        DECLARE @ColumnName SYSNAME;\n\n        -- Cursor to iterate through tables and columns\n        DECLARE TableCursor CURSOR FAST_FORWARD FOR\n            SELECT TABLE_NAME, COLUMN_NAME\n            FROM INFORMATION_SCHEMA.COLUMNS\n            WHERE DATA_TYPE IN ('datetime', 'date')\n              AND TABLE_NAME NOT LIKE 'Report_%'\n              AND TABLE_NAME NOT IN ('Accounts', 'Manifest', 'System', 'Users');\n\n        OPEN TableCursor;\n        FETCH NEXT FROM TableCursor INTO @TableName, @ColumnName;\n\n        WHILE @@FETCH_STATUS = 0\n        BEGIN\n            SET @SQL += N'UPDATE [' + @TableName +'] \n                         SET ['+ @ColumnName + '] = DATEADD(DAY, DATEDIFF(DAY, ''' +\n                             CONVERT(VARCHAR(10), @LastForwardedDate, 126) + ''', GETDATE()), ' +\n                             '[' + @ColumnName + ']) \n                         WHERE CreatedBy = ''DemoUser'';';\n\n            FETCH NEXT FROM TableCursor INTO @TableName, @ColumnName;\n        END\n\n        CLOSE TableCursor;\n        DEALLOCATE TableCursor;\n\n        -- Execute the dynamic SQL\n        EXEC sp_executesql @SQL;\n\n        -- Update the last forwarded date in your settings table\n        UPDATE DemoAccountSettings \n        SET LastForwardedDateTime = GETDATE()\n        WHERE AccountType = 'Demo';\n    END\nEND;