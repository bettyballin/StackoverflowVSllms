WITH DateSeries AS (\n    SELECT DATEADD(DAY, -1, CAST(GETDATE() AS DATE)) AS DateValue -- Start from yesterday\n    UNION ALL\n    SELECT DATEADD(DAY, -1, DateValue)\n    FROM DateSeries\n    WHERE DateValue > DATEADD(DAY, -30, GETDATE()) -- Continue back to 30 days ago\n)\nSELECT ds.DateValue AS [Date], \n       COALESCE(SUM(o.SubTotal), 0) AS SalesSum\nFROM DateSeries ds\nLEFT JOIN Orders o ON ds.DateValue = CAST(o.DateCreated AS DATE)\nGROUP BY ds.DateValue\nORDER BY ds.DateValue DESC\nOPTION (MAXRECURSION 32); -- Ensure the recursion runs up to 30 times