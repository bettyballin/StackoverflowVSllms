WITH MonthlyData AS (\n    SELECT \n        mt.SalesManCode,\n        MONTH(mt.TargetMonthYear) AS TargetMonth,\n        mt.TargetValue AS Tar,\n        ISNULL(SUM(ms.AchievedValue), 0) AS Ach\n    FROM \n        MonthlyTarget mt\n    LEFT JOIN \n        MonthlySales ms ON mt.SalesManCode = ms.SalesManCode AND MONTH(ms.SaleDate) = MONTH(mt.TargetMonthYear) AND YEAR(ms.SaleDate) = YEAR(mt.TargetMonthYear)\n    GROUP BY \n        mt.SalesManCode, MONTH(mt.TargetMonthYear), mt.TargetValue\n)\n\nSELECT \n    SalesManCode,\n    SUM(CASE WHEN TargetMonth = 1 THEN Tar ELSE 0 END) AS JanTar,\n    SUM(CASE WHEN TargetMonth = 1 THEN Ach ELSE 0 END) AS JanAch,\n    SUM(CASE WHEN TargetMonth = 2 THEN Tar ELSE 0 END) AS FebTar,\n    SUM(CASE WHEN TargetMonth = 2 THEN Ach ELSE 0 END) AS FebAch,\n    -- ... Repeat for all months up to December\n    SUM(CASE WHEN TargetMonth = 12 THEN Tar ELSE 0 END) AS DecTar,\n    SUM(CASE WHEN TargetMonth = 12 THEN Ach ELSE 0 END) AS DecAch\nFROM \n    MonthlyData\nGROUP BY \n    SalesManCode;