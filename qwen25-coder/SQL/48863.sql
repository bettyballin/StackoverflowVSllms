SELECT \n    ST.ColumnName1,\n    JT.ColumnName2,\n    SJT.ColumnName3\nFROM \n    SourceTable ST\nINNER JOIN JoinTable JT\n    ON JT.SourceTableID = ST.SourceTableID\nINNER JOIN SecondJoinTable SJT\n    ON ST.SourceTableID = SJT.SourceTableID\n    AND JT.Column3 = SJT.Column4\nWHERE \n    ST.SourceTableID = X\n    AND JT.ColumnName3 = Y;\n\nUPDATE \n    TargetTable\nSET \n    ColumnName1 = @value,\n    ColumnName2 = @value2\nWHERE \n    Condition1 = @test;\n\nINSERT INTO TargetTable (\n    ColumnName1,\n    ColumnName2,\n    ColumnName3\n) VALUES (\n    @value1,\n    @value2,\n    @value3\n);