WITH numbered_dates AS (\n    SELECT\n        site_id,\n        start_date,\n        end_date,\n        date_trunc('day', start_date) - INTERVAL '1 day' * (ROW_NUMBER() OVER (PARTITION BY site_id ORDER BY start_date)) AS grp\n    FROM\n        your_table_name\n),\ngrouped_dates AS (\n    SELECT\n        site_id,\n        MIN(start_date) AS contiguous_start_date,\n        MAX(end_date) AS contiguous_end_date,\n        COUNT(*) AS days_count\n    FROM\n        numbered_dates\n    GROUP BY\n        site_id, grp\n)\nSELECT\n    site_id,\n    contiguous_start_date,\n    contiguous_end_date\nFROM\n    grouped_dates\nWHERE\n    days_count >= 15\nORDER BY\n    site_id, contiguous_start_date;