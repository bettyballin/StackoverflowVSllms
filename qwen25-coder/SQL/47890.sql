SELECT CLNDR_DATE\nFROM (\n    SELECT CLNDR_DATE, EFFECTIVE_DATE,\n           ROW_NUMBER() OVER (ORDER BY CLNDR_DATE DESC) AS rn,\n           SUM(CASE WHEN EFFECTIVE_DATE IS NOT NULL THEN 1 ELSE 0 END) \n               OVER (ORDER BY CLNDR_DATE DESC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS grp\n    FROM your_table_name\n) subquery\nWHERE EFFECTIVE_DATE IS NULL\nGROUP BY grp, CLNDR_DATE\nHAVING MAX(CASE WHEN EFFECTIVE_DATE IS NOT NULL THEN rn END) = MIN(rn);