WITH NumberedRows AS (\n    SELECT \n        id,\n        somedate,\n        somevalue,\n        ROW_NUMBER() OVER (ORDER BY somedate) AS RowNum\n    FROM \n        TestTable\n)\nSELECT \n    n.id,\n    n.somedate,\n    n.somevalue,\n    @RunningTotal := @RunningTotal + n.somevalue AS runningtotal\nFROM \n    NumberedRows n,\n    (SELECT @RunningTotal := 0) init_val\nORDER BY \n    n.RowNum;