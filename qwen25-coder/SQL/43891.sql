WITH TaskHierarchy (TaskID, [Subject], ParentID, HierarchyLevel, HierarchyPath) AS\n(\n   -- Base case\n   SELECT\n      TaskID,\n      [Subject],\n      ParentID,\n      1 as HierarchyLevel,\n      CONVERT(VARCHAR(MAX), '/') + CAST(TaskID AS VARCHAR(32)) + '/' AS HierarchyPath\n   FROM Task\n   WHERE TaskID = 2\n\n   UNION ALL\n\n   -- Recursive step: Move up the hierarchy from child to parent\n   SELECT\n      t.TaskID,\n      t.Subject,\n      t.ParentID,\n      th.HierarchyLevel + 1 AS HierarchyLevel,\n      CONVERT(VARCHAR(MAX), th.HierarchyPath) + CAST(t.TaskID AS VARCHAR(32)) + '/' AS HierarchyPath\n   FROM Task t\n      INNER JOIN TaskHierarchy th ON th.ParentID = t.TaskID\n)\nSELECT *\nFROM TaskHierarchy\nORDER BY HierarchyLevel DESC, [Subject]