WITH RankedSubTable AS (\n    SELECT \n        sub.main_table_id,\n        sub.tag,\n        ROW_NUMBER() OVER (PARTITION BY sub.main_table_id ORDER BY sub.tag) as rn\n    FROM \n        SubTable sub\n)\nSELECT \n    main.id,\n    main.title,\n    ranked.tag\nFROM \n    MainTable main\nLEFT OUTER JOIN \n    RankedSubTable ranked ON main.id = ranked.main_table_id AND ranked.rn = 1;