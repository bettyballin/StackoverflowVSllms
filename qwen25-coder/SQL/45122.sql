DECLARE @peak_minute_start DATETIME;\nSET @peak_minute_start = '2023-12-25 14:45:00'; -- Replace with actual peak minute start time\nDECLARE @peak_minute_end DATETIME;\nSET @peak_minute_end = DATEADD(minute, 1, @peak_minute_start);\n\nSELECT \n    DATEPART(year, CreateDate) AS Year,\n    DATEPART(month, CreateDate) AS Month,\n    DATEPART(day, CreateDate) AS Day,\n    DATEPART(hour, CreateDate) AS Hour,\n    DATEPART(minute, CreateDate) AS Minute,\n    DATEPART(second, CreateDate) AS Second,\n    COUNT(ID) AS MessageCount\nFROM \n    Message\nWHERE \n    CreateDate BETWEEN @peak_minute_start AND @peak_minute_end\nGROUP BY \n    DATEPART(year, CreateDate),\n    DATEPART(month, CreateDate),\n    DATEPART(day, CreateDate),\n    DATEPART(hour, CreateDate),\n    DATEPART(minute, CreateDate),\n    DATEPART(second, CreateDate)\nORDER BY \n    Year,\n    Month,\n    Day,\n    Hour,\n    Minute,\n    Second;