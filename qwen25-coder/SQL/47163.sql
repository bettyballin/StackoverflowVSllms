BEGIN TRANSACTION;\n\n-- Insert DestinationPerson into MailingListSubscription where SourcePerson exists and DestinationPerson does not already exist with that ListID\nINSERT INTO MailingListSubscription (ListID, PersonID)\nSELECT DISTINCT s.ListID, @DestPerson\nFROM MailingListSubscription s\nWHERE s.PersonID = @SourcePerson\nAND NOT EXISTS (\n    SELECT 1\n    FROM MailingListSubscription d\n    WHERE d.ListID = s.ListID AND d.PersonID = @DestPerson\n);\n\n-- Delete SourcePerson from MailingListSubscription\nDELETE FROM MailingListSubscription\nWHERE PersonID = @SourcePerson;\n\nCOMMIT TRANSACTION;