SELECT \n    e.event_id,\n    e.name,\n    MAX(CASE WHEN edi.repeat_type = 'day' THEN edi.interval_val END) AS repeat_day_interval,\n    GROUP_CONCAT(CASE WHEN edi.repeat_type = 'week' THEN edi.day_of_week END ORDER BY edi.day_of_week SEPARATOR ',') AS repeat_week_days,\n    MAX(CASE WHEN edi.repeat_type = 'month' THEN edi.day_of_month END) AS repeat_month_day\nFROM \n    events e\nLEFT JOIN \n    events_dateinfo edi ON e.event_id = edi.event_id\nGROUP BY \n    e.event_id, e.name;