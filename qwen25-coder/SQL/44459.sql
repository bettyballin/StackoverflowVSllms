-- Create a string split function\nCREATE FUNCTION dbo.SplitString\n(\n    @list nvarchar(max),\n    @delimiter char(1)\n)\nRETURNS @output TABLE(value nvarchar(max))\nBEGIN\n    DECLARE @start INT, @end INT\n    SET @list = LTRIM(RTRIM(@list) + @delimiter)\n    SET @start = 1\n    WHILE CHARINDEX(@delimiter,@list) > 0\n    BEGIN\n        SET @end = CHARINDEX(@delimiter ,@list)-1\n        IF SUBSTRING(@list, @start,1) != @delimiter AND @end >= @start\n            INSERT INTO @output (value)\n            VALUES (SUBSTRING(@list, @start, (@end - @start)+1))\n        SET @start = @end + 2\n    END\n    RETURN;\nEND