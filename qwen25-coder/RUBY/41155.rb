require 'active_record'\n\nnamespace :db do\n  namespace :schema do\n    desc "Dump Oracle schema"\n    task :dump => :environment do\n      connection = ActiveRecord::Base.connection.raw_connection\n\n      # Fetch table names\n      cursor = connection.parse("SELECT TABLE_NAME FROM USER_TABLES")\n      cursor.exec\n      tables = []\n      while row = cursor.fetch\n        tables << row[0]\n      end\n      cursor.close\n\n      # Output schema information to a file\n      File.open('oracle_schema_dump.sql', 'w') do |file|\n        tables.each do |table|\n          cursor = connection.parse("SELECT COLUMN_NAME, DATA_TYPE FROM USER_TAB_COLUMNS WHERE TABLE_NAME='#{table}'")\n          cursor.exec\n          file.puts "CREATE TABLE #{table} ("\n          columns = []\n          while row = cursor.fetch\n            columns << "#{row[0]} #{map_data_type(row[1])}"\n          end\n          cursor.close\n          file.puts columns.join(",\n  ")\n          file.puts ");\n\n"\n        end\n      end\n\n      puts "Schema dump complete. Check oracle_schema_dump.sql"\n    end\n\n    def map_data_type(oracle_type)\n      case oracle_type\n      when 'VARCHAR2'\n        'STRING'\n      when 'NUMBER'\n        'INTEGER' # or DECIMAL, depending on scale and precision\n      when 'DATE'\n        'DATETIME'\n      else\n        oracle_type\n      end\n    end\n  end\nend