require 'asn1'\ninclude ASN1\n\n# Define OID for sha512WithRSAEncryption\nsha512WithRSAEncryption = [1, 2, 840, 113549, 1, 1, 12]\n\n# Create the ASN.1 structure for Algorithm and Signature\nasn1_structure = SEQUENCE.new(\n  :Algorithm,\n  OBJECT_IDENTIFIER.new(:oid),\n  ANY_TAGGED.new(:opt, optional: true)\n).sequence(\n  :Signature,\n  SEQUENCE.new(:alg, Algorithm.clone),\n  BIT_STRING.new(:sig)\n)\n\n# Prepare the data to encode\ndata_to_encode = {\n  sig: [body].pack("B*"), # Assuming 'body' is a binary string of bits\n  alg: { oid: sha512WithRSAEncryption }\n}\n\n# Encode the data\nencoded_data = asn1_structure.encode(data_to_encode)\n\nputs encoded_data.inspect