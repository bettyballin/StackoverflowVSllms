class UserSessionsController < ApplicationController\n  def create_from_oauth\n    auth = request.env['omniauth.auth']\n    \n    # Find or create user from Authlogic\n    @user = User.find_or_create_by(oauth_token: auth.credentials.token, oauth_secret: auth.credentials.secret) do |u|\n      u.username = "#{auth.provider}_#{auth.uid}"\n      u.email = "#{auth.uid}@yourapp.com" # Ensure uniqueness and compliance with your model constraints\n      u.password = SecureRandom.hex(10)\n      u.save!\n    end\n\n    @user_session = UserSession.new\n    @user_session.user = @user\n    if @user_session.save\n      flash[:notice] = "Logged in successfully."\n      redirect_to root_path\n    else\n      flash.now[:alert] = "There was a problem logging you in through OAuth."\n      render :action => 'new'\n    end\n  end\n\n  def oauth_auth_failure\n    logger.warn("Login failure: #{params[:message]}")\n    flash[:error] = params[:message]\n    redirect_to root_path\n  end\nend