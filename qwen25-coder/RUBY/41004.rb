<% prefix = 'your_prefix_here' %>\n<%= text_field_tag "reservation[#{prefix}reserved_items][#{item.id}]",\n                   get_amount_value(item, @reservation),\n                   :size => 3,\n                   :id => "#{prefix}_amount_#{item.id}",\n                   :onchange => "updateAvailability(this, #{item.id.to_s}, '#{prefix}')"\n%>\n\n<script>\nfunction updateAvailability(element, itemId, prefix) {\n    // Get the values from datetime select fields\n    var pickUpTime = document.getElementById(prefix + '_pick_up_time').value;\n    var returnTime = document.getElementById(prefix + '_return_time').value;\n\n    // Prepare the data to be sent in the AJAX request\n    var data = 'amount=' + element.value +\n               '&item=' + itemId +\n               '&pick_up_time=' + encodeURIComponent(pickUpTime) +\n               '&return_time=' + encodeURIComponent(returnTime);\n\n    // Perform the remote function call using Rails' Prototype helpers (if you are using it)\n    new Ajax.Request('<%= url_for controller: :items, action: :availability %>', {\n        method: 'post',\n        parameters: data,\n        onSuccess: function(response) {\n            // Update the necessary parts of your page with the response\n            document.getElementById('availability_url').innerHTML = response.responseText;\n        }\n    });\n}\n</script>