# Fetching data with proper ActiveRecord result set\nrows = Event.joins(:patient)\n            .select("patients.lname, events.patient_id, events.event_type, MAX(events.event_date) as event_date")\n            .group("patients.lname, events.patient_id, events.event_type")\n\n# Converting each row into a hash or custom object\nresults = rows.map do |row|\n  {\n    lname: row.lname,\n    patient_id: row.patient_id,\n    event_type: row.event_type,\n    latest_event_date: row.event_date # Note that 'event_date' is aliased as 'latest_event_date'\n  }\nend\n\n# Output results\nresults.each { |result| puts result }