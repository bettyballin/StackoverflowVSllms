# Require necessary Selenium WebDriver modules\nrequire 'selenium-webdriver'\n\nBefore do\n  @driver = Selenium::WebDriver.for :firefox\n  # Setup implicit wait\n  @driver.manage.timeouts.implicit_wait = 10 # seconds\nend\n\nThen /^I should be (editing|viewing) the (\w+) with (\w+) "([^\"]*)"$/ do |action,model,field,value|\n  func = make_func(action,model)\n  m = find_model_by_field_and_value(model,field,value)\n\n  # Wait explicitly for the URL to match what we expect\n  wait = Selenium::WebDriver::Wait.new(timeout: 15) # seconds\n\n  wait.until { URI.parse(@driver.current_url).path == eval("#{func}(m)") }\nend