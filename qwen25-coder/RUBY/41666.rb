require 'net/imap'\nrequire 'date'\nrequire 'mail'\n\nimap = Net::IMAP.new('mail.xks.com')\nimap.login('web1_xk3', 'pxx2006')\nimap.select('INBOX')\n\nimap.search(["SENTSINCE", (Time.now - 1.day).strftime("%d-%b-%Y")]).each do |msgid|\n  # Fetch the raw email data\n  data = imap.fetch(msgid, "RFC822")[0].attr["RFC822"]\n\n  # Parse the raw email using Mail gem\n  mail = Mail.read_from_string(data)\n\n  # Access plain text part of the body\n  puts "Email Body: #{mail.text_part.decoded}"\nend\n\nimap.logout\nimap.disconnect