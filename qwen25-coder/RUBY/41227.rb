class SessionsController < ApplicationController\n  def create\n    user = User.find_by(email: params[:session][:email].downcase)\n    if user && user.authenticate(params[:session][:password])\n      log_in(user)\n      params[:session][:remember_me] == '1' ? user.remember_me : user.reset_remember_token!\n      redirect_back_or root_url\n    else\n      flash.now[:danger] = 'Invalid email/password combination'\n      render 'new'\n    end\n  end\n\n  def destroy\n    log_out if logged_in?\n    redirect_to login_path\n  end\n\n  private\n\n  # Logs in the given user.\n  def log_in(user)\n    session[:user_id] = user.id\n  end\n\n  # Logs out the current user.\n  def log_out\n    forget(current_user)\n    session.delete(:user_id)\n    @current_user = nil\n  end\n\n  # Remembers a user in a persistent session.\n  def remember(user)\n    user.remember\n    cookies.permanent.signed[:user_id] = user.id\n    cookies.permanent[:remember_token] = user.remember_token\n  end\n\n  # Forgets a persistent session.\n  def forget(user)\n    user.forget\n    cookies.delete(:user_id)\n    cookies.delete(:remember_token)\n  end\nend