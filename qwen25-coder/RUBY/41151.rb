require 'webrick'\ninclude WEBrick\nrequire 'cgi'\n\ndef run_cgi(script_path, req, res)\n  IO.popen('run_cgi.bat ' + script_path) do |io|\n    while line = io.gets\n      if line =~ /Content-type:(.*)/i then\n        res['content-type'] = $1.strip\n      elsif !line.match(/^$/) then\n        break\n      end\n    end\n    res.status = 200\n    res.body = line + io.read\n  end\nend\n\ns = HTTPServer.new(:Port => 2000, :DocumentRoot => Dir::pwd)\n\n# Custom CGI handler\ns.mount_proc('/cgi-bin/') do |req, res|\n  case req.script_name\n  when /.*\.cgi$/\n    script_path = File.join(s.config[:DocumentRoot], req.path_info)\n    if File.exist?(script_path) && File.executable?(script_path)\n      run_cgi(script_path, req, res)\n    else\n      res.status = 404\n      res.body = "File not found"\n    end\n  else\n    res.status = 403\n    res.body = "Forbidden"\n  end\nend\n\ns.start