class User < ApplicationRecord\n  before_save :regenerate_remember_token!\n\n  def regenerate_remember_token!\n    self.remember_token = generate_remember_token\n  end\n\n  def remember_me\n    self.remember_token_expires_at = 2.weeks.from_now.utc\n    save!(validate: false)\n    tokens[:remember_token] = remember_token\n    cookies.signed[:remember_for] = [id, remember_token].join("--")\n  end\n\n  def reset_remember_token!\n    self.update_column(:remember_token, nil)\n    cookies.delete(:remember_for)\n  end\n\n  private\n\n  def generate_remember_token\n    SecureRandom.urlsafe_base64\n  end\nend