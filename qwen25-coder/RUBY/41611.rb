require 'yaml'\nrequire 'active_model/callbacks'\n\nclass Foo\n  include ActiveModel::Callbacks\n\n  attr_accessor :new_instance_variable\n\n  define_model_callbacks :initialize\n  after_initialize :set_defaults\n\n  def initialize\n    run_callbacks(:initialize) { }\n  end\n\n  private\n\n  def set_defaults\n    self.new_instance_variable ||= 0\n  end\nend\n\n# Example usage:\nfoo = Foo.new\nputs foo.to_yaml\n\nloaded_foo = YAML.load(foo.to_yaml)\nputs loaded_foo.new_instance_variable  # Outputs: 0