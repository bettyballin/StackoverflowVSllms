data = [\n  ['header1', 'header2', 'header3'],\n  ['value1a', 'value2a', 'value3a'],\n  ['value1b', 'value2b', 'value3b'],\n  # ... more rows\n]\n\n# Define a condition for removal, e.g., remove columns where all values are empty strings after the header row\ncolumns_to_keep = data.first.each_index.select do |col|\n  !data[1..-1].all? { |row| row[col] == '' }\nend\n\nfiltered_data = data.map do |row|\n  row.values_at(*columns_to_keep)\nend\n\n# filtered_data now contains only the columns that meet the condition\nputs filtered_data.inspect