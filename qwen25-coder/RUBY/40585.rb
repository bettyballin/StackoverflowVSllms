# In your custom test script or performance test class method\ndef run_profiler(*args)\n  result = RubyProf.profile do\n    # Your code to profile here\n  end\n  \n  printer = RubyProf::GraphPrinter.new(result) # Change to Graph, CallTree, etc.\n  printer.print(File.open('profile.calltree', 'w'))\n  \n  # Optionally, you can also generate other formats like FlatTXT or HTML\n  flat_printer = RubyProf::FlatPrinter.new(result)\n  flat_printer.print(File.open("profile_flat.txt", "w"))\n\n  html_printer = RubyProf::CallTreePrinter.new(result)\n  html_printer.print(File.open('profile_graph.html', 'w'))\nend