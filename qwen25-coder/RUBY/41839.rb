# app/forms/query_form.rb\nclass QueryForm\n  include ActiveModel::Model\n\n  attr_accessor :name, :image_font_size, :analysis_type, :results_to_generate,\n                :graph_type, :graph_width, :theme, :age\n\n  validates :name, presence: { message: 'You must give a name' }\n  validate  :check_graph_parameters_if_needed\n  validate  :validate_age_format\n\n  private\n\n  def check_graph_parameters_if_needed\n    return unless analysis_type == 'development' || results_to_generate.include?('graph')\n    \n    %w[graph_type graph_width theme].each do |key|\n      value = send(key)\n      errors.add(key, "Cannot leave '#{key.humanize}' blank") if value.blank?\n    end\n  end\n\n  def validate_age_format\n    return if age.blank? || age.match(/\A\d+\z/)\n    errors.add(:age, 'must be a number')\n  end\nend