require 'win32/registry'\n\n# Define your environment variable and its value\nvariable_name = 'JAVA_HOME'\nvariable_value = 'C:\\Path\\To\\Java\\Home'\n\n# Access the registry key for environment variables\nWin32::Registry::HKEY_LOCAL_MACHINE.open(\n  'SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Environment',\n  Win32::Registry::KEY_WRITE\n) do |reg|\n  reg[variable_name] = [variable_value, Win32::Registry::REG_EXPAND_SZ]\nend\n\nputs "The environment variable #{variable_name} has been set to #{variable_value}."