import ctypes\nfrom ctypes import wintypes\n\nclass LASTINPUTINFO(ctypes.Structure):\n    _fields_ = [("cbSize", wintypes.UINT), ("dwTime", wintypes.DWORD)]\n\ndef get_idle_duration():\n    lii = LASTINPUTINFO()\n    lii.cbSize = ctypes.sizeof(LASTINPUTINFO)\n    if not ctypes.windll.user32.GetLastInputInfo(ctypes.byref(lii)):\n        raise Exception("Failed to get last input info")\n    millis = ctypes.windll.kernel32.GetTickCount() - lii.dwTime\n    return millis / 1000.0\n\nprint(f"Idle time on Windows: {get_idle_duration()} seconds")