import pandas as pd\n\n# Assuming df is the DataFrame returned from the SQL query\ndf = pd.read_sql_query(query, connection)\n\n# Pivot the table to get a 2D array of ratings\nratings_matrix = df.pivot_table(index='UserID', columns='MovieID', values='Rating')\n\n# Convert NaNs (which were NULL in SQL) to 0 or any other placeholder if needed\nratings_matrix.fillna(0, inplace=True)\n\n# Now ratings_matrix is a 2D numpy array suitable for SVD\nratings_array = ratings_matrix.to_numpy()