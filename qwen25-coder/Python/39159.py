import pyodbc\nimport os\nimport win32print\nfrom win32com.client import Dispatch\n\n# Connect to SQL Server\nconn = pyodbc.connect('DRIVER={SQL Server};SERVER=your_server;DATABASE=your_database;UID=your_username;PWD=your_password')\ncursor = conn.cursor()\n\n# Query the data for mail merge\nquery = "SELECT * FROM your_table"\ncursor.execute(query)\n\n# Printers\nprinter_name = win32print.GetDefaultPrinter()  # Use default printer\n\nfor row in cursor.fetchall():\n    letter_path = 'path_to_letters_folder/{}.pdf'.format(row.letter_id)  # Adjust path and filename accordingly\n    \n    # Print the letter\n    print_job(letter_path, printer_name)\n\n    # Print associated PDFs\n    for _ in range(int(row.PDFCount)):\n        pdf_path = 'path_to_pdfs_folder/{}.pdf'.format(row.pdf_id)  # Adjust path and filename accordingly\n        print_job(pdf_path, printer_name)\n\ndef print_job(file_path, printer):\n    word = Dispatch('Word.Application')\n    doc = word.Documents.Open(os.path.realpath(file_path))\n    doc.PrintOut(ActivePrinter=printer)\n    doc.Close(SaveChanges=False)\n    word.Quit()\n\n# Close connection\ncursor.close()\nconn.close()