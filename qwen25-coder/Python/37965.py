import os\nimport subprocess\n\n# File name of the captured data (from tshark)\npcap_filename = "capture.pcapng"\n\n# Run tshark and extract packet payloads\noutput = subprocess.check_output([\n    "tshark",\n    "-r", pcap_filename,\n    # For TCP payload, you can use:\n    "-Y tcp.payload",\n    "-T fields",\n    "-e", "tcp.payload.raw"\n], text=True)\n\npackets = output.strip().split('\n')\n\n# Write each packet's payload to a separate file\nfor i, packet in enumerate(packets):\n    if packet:  # Ensure there is some payload\n        with open(f"payload_{i}.txt", "w") as f:\n            f.write(packet)