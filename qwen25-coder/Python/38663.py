import ahocorasick\nimport mmap\n\ndef find_matching_sequences(file1, file2):\n    ac = ahocorasick.Automaton()\n    \n    # Open the first file and add all substrings to the automaton\n    with open(file1, "rb") as f:\n        content = f.read()\n        for index in range(len(content)):\n            ac.add_word(content[index:], (index,))\n    \n    ac.make_automaton()\n    \n    matches = []\n    \n    # Open the second file and search for matches\n    with open(file2, "r+b") as f:\n        mmapped_file = mmap.mmap(f.fileno(), 0)\n        offset = 0\n        for end_index, original_value in ac.iter(mmapped_file):\n            start_index = end_index - len(original_value) + 1\n            matches.append((start_index, end_index, mmapped_file[start_index:end_index+1]))\n    \n    return matches\n\n# Usage\nspybot_matches = find_matching_sequences("spybotsd160.exe", "TestuffSetup.exe")\nfor match in spybot_matches:\n    print(match)