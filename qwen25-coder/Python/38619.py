import psycopg2\n\n# Connect to your postgres DB\nconn = psycopg2.connect("dbname=test user=postgres password=secret")\n\ncur = conn.cursor()\n\n# Create a table with a bytea type column for storing BLOBs\ncur.execute("""\n    CREATE TABLE IF NOT EXISTS documents (\n        id SERIAL PRIMARY KEY,\n        name TEXT,\n        content BYTEA\n    )\n""")\n\n# Insert a file into the database\nfile_path = 'path/to/your/file.txt'\nwith open(file_path, 'rb') as f:\n    binary_data = f.read()\ncur.execute("INSERT INTO documents (name, content) VALUES (%s, %s)", ('file.txt', psycopg2.Binary(binary_data)))\n\n# Commit changes and close the connection\nconn.commit()\n\n# Retrieve a file from the database\ncur.execute("SELECT name, content FROM documents WHERE name = 'file.txt'")\nname, file_content = cur.fetchone()\nwith open(f"retrieved_{name}", 'wb') as f:\n    f.write(file_content)\n\ncur.close()\nconn.close()