from requests_oauthlib import OAuth2Session\n\nclient_id = 'YOUR_CLIENT_ID'\nclient_secret = 'YOUR_CLIENT_SECRET'\nredirect_uri = 'https://yourapp.com/callback'\n\n# Authorization URL and Token URL are specific to Microsoft Graph API\nauthorization_base_url = 'https://login.microsoftonline.com/common/oauth2/v2.0/authorize'\ntoken_url = 'https://login.microsoftonline.com/common/oauth2/v2.0/token'\n\nscope = ['Contacts.Read', 'User.Read']\n\n# Create OAuth2Session object\nms_graph = OAuth2Session(client_id, redirect_uri=redirect_uri, scope=scope)\n\n# Redirect user to Microsoft for authorization\nauthorization_url, state = ms_graph.authorization_url(authorization_base_url)\nprint('Please go here and authorize:', authorization_url)\n\n# After authorization, obtain the Authorization Code from callback URL\n# For this example, manually input the code after redirection.\nredirect_response = input('Paste the full redirect URL here:')\n\n# Fetch the access token\ntoken = ms_graph.fetch_token(\n    token_url,\n    client_secret=client_secret,\n    authorization_response=redirect_response\n)\n\n# Now you can use Microsoft Graph to fetch contacts\nresponse = ms_graph.get('https://graph.microsoft.com/v1.0/me/contacts')\nprint(response.json())