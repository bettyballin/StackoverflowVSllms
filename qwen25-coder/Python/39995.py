import mysql.connector\n\ndb = mysql.connector.connect(\n  host="localhost",\n  user="yourusername",\n  password="yourpassword",\n  database="yourdatabase"\n)\n\ncursor = db.cursor()\nquery = """\nSELECT DISTINCT type \nFROM contact_attributes;\n"""\n\ncursor.execute(query)\ntypes = [row[0] for row in cursor.fetchall()]\n\ndynamic_query = """\nSELECT \n    p.id AS profile_id, \n"""\nfor t in types:\n    dynamic_query += f"MAX(CASE WHEN a.type = '{t}' THEN a.value END) AS {t}, "\n\ndynamic_query = dynamic_query.rstrip(', ') + """\nFROM contact_profiles p\nLEFT JOIN contact_attributes a ON p.id = a.profile_id\nGROUP BY p.id;\n"""\n\ncursor.execute(dynamic_query)\nresults = cursor.fetchall()\n\nfor row in results:\n    print(row)\n\ndb.close()