function login(username, password):\n    if not https_enabled():\n        return error("SSL required")\n\n    // Fetch stored hash and salt for given username from database\n    (stored_hash, salt) = get_user_credentials(username)\n\n    // Hash the input password with the same salt used during signup\n    input_password_hash = hash_with_salt(password, salt)\n\n    // Compare the two hashes\n    if stored_hash == input_password_hash:\n        return success("Login successful!")\n    else:\n        return error("Invalid credentials")