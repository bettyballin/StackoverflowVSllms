from django.shortcuts import render\n\ndef by_location(request, country=None, state=None, city=None, big_city_nearby=None):\n    # Filter locations based on provided arguments\n    if country is None:\n        location_filter = {}\n    else:\n        location_filter = {'country': country}\n        if state:\n            location_filter['state'] = state\n        if city:\n            location_filter['city'] = city\n        if big_city_nearby:\n            location_filter['big_city_nearby'] = big_city_nearby\n\n    # Filter locations and fetch related items with their locations in one query\n    locations = Location.objects.filter(**location_filter).distinct()\n    items = Item.objects.filter(location__in=locations).select_related('location')\n\n    return render(request, 'item/by_location.html', {\n        "items": items,\n        "country": country,\n        "state": state,\n        "city": city,\n        "nearby": big_city_nearby,\n    })