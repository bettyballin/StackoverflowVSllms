import time\n\n# Open the database file\nwith open("db.csv", "r") as db:\n    for line in db:\n        # Strip newline characters and split the line into columns\n        row = line.strip().split(",")\n        \n        if len(row) < 3:\n            print(f"Skipping invalid line: {line}")\n            continue\n        \n        recipient = row[0]     # who the SMS is going to\n        s = row[1]             # gets the first hour of the "no alert" time range\n        f = row[2]             # gets last hour of above\n        curtime = int(time.strftime("%H"))  # current hour as an integer\n\n        if s == "no":\n            print(f"{recipient} always want alerts, sending email")\n            # send mail code goes here\n        else:\n            try:\n                start_hour = int(s)\n                end_hour = int(f)\n            except ValueError:\n                print(f"Skipping line due to invalid hour values: {line}")\n                continue\n\n            nrt = list(range(start_hour, end_hour))  # Create a list of hours in the range\n            if curtime in nrt:\n                print(f"They don't want an alert during the current hour ({curtime}), not sending")\n            else:\n                # they do want an alert during the current hour, send an email\n                # send mail code here\n                print(f"Sending email to {recipient} because it's not a no-alert time ({curtime})")