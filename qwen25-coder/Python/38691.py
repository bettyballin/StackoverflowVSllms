import sys\nimport ldap3\n\n# Using ldap3 for improved functionality and better error handling\nServer = "ldaps://my-ldap-server"  # Use LDAPS\nDomain, Secret, Username = sys.argv[1:4]\n\n# Correct DN format for AD\nUserDN = f"{Domain}\\{Username}"\n\n# Establishing connection\nserver = ldap3.Server(Server)\nconnection = ldap3.Connection(server, user=UserDN, password=Secret, auto_bind=True)\n\ntry:\n    # Binding to the server\n    connection.bind()\n    print("Bound successfully")\n    \n    # Searching for user\n    search_base = "dc=mydomain,dc=co,dc=uk"\n    search_filter = f"(&(objectClass=user)(sAMAccountName={Username}))"\n    attributes = ["displayName"]\n    \n    if connection.search(search_base, search_filter, attributes=attributes):\n        for entry in connection.entries:\n            print(entry.displayName.value)\n    else:\n        print("No entries found")\nexcept ldap3.core.exceptions.LDAPInvalidCredentialsResult as e:\n    print(f"Error: Invalid credentials - {e}")\nexcept ldap3.core.exceptions.LDAPOperationsError as e:\n    print(f"Error in operations - {e}")\nfinally:\n    connection.unbind()