# worker.py\nfrom celery import Celery\n\napp = Celery('tasks', broker='redis://localhost:6379/0')\n\n@app.task\ndef resize_image(image_path, sizes):\n    from PIL import Image\n    import os\n\n    # Load image\n    img = Image.open(image_path)\n\n    # Define target dimensions for different sizes\n    size_maps = {\n        'thumbnail': (128, 128),\n        'medium': (360, 360),\n        'large': (640, 480)\n    }\n\n    base_dir, filename = os.path.split(image_path)\n\n    for size in sizes:\n        img_copy = img.copy()\n        img_copy.thumbnail(size_maps[size])\n        resized_name = f"{base_dir}/{size}_{filename}"\n        img_copy.save(resized_name)\n\n# Start the worker with: celery -A worker.celery worker --loglevel=info