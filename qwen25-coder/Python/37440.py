import random\n\ndef prepare_alias_method(weights):\n    n = len(weights)\n    prob = [0] * n\n    alias = [-1] * n\n    \n    scaled_weights = [(w / sum(weights)) * n for w in weights]\n    \n    small, large = [], []\n    \n    for i, swi in enumerate(scaled_weights):\n        if swi < 1:\n            small.append(i)\n        else:\n            large.append(i)\n\n    while small and large:\n        l = small.pop()\n        g = large.pop()\n\n        prob[l] = scaled_weights[l]\n        alias[l] = g\n\n        scaled_weights[g] = (scaled_weights[g] + scaled_weights[l]) - 1\n        if scaled_weights[g] < 1:\n            small.append(g)\n        else:\n            large.append(g)\n\n    for l in small + large:\n        prob[l] = 1\n        alias[l] = l\n\n    return prob, alias\n\ndef select_word(prob, alias):\n    n = len(prob)\n    i = random.randint(0, n - 1)\n    \n    if random.random() < prob[i]:\n        return i\n    else:\n        return alias[i]