import redis\n\n# Setup Redis client\nr = redis.Redis(host='localhost', port=6379, db=0)\n\ndef add_message(user_id, message):\n    # Append new message to the list of messages for this user\n    r.lpush(f"user:{user_id}:messages", message)\n    # Trim the list to keep only latest 100 messages\n    r.ltrim(f"user:{user_id}:messages", 0, 99)\n\ndef get_recent_messages(user_id):\n    return r.lrange(f"user:{user_id}:messages", 0, -1)\n\n# Example usage\nadd_message('user_001', 'Hello World!')\nrecent_messages = get_recent_messages('user_001')\nprint([msg.decode() for msg in recent_messages])