from django.db.models import Q\n\n# Start with an empty queryset\nsoknad_list = Soknad.objects.all()\n\n# Apply filters based on provided variables\nif var1:\n    soknad_list = soknad_list.filter(pub_date__year=var1)\n\nif var2:\n    soknad_list = soknad_list.filter(muncipality__name__exact=var2)\n\nif var3:\n    soknad_list = soknad_list.filter(genre__name__exact=var3)\n\n# Process and apply search term if provided\nsearch_term = request.GET.get('q')\nif search_term:\n    # Clean the search term by removing stop words and stripping spaces\n    cleaned_search_terms = [word for word in search_term.split() if word.lower() not in STOP_WORDS]\n    query = Q()\n    for term in cleaned_search_terms:\n        query |= (Q(dream__icontains=term) | Q(tags__icontains=term) | \n                  Q(name__icontains=term) | Q(school__name__icontains=term))\n    \n    soknad_list = soknad_list.filter(query)