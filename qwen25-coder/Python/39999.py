def weighted_selection_with_replacement(items, weights, k):\n    cumulative_weights = []\n    current_sum = 0\n    \n    # Calculate cumulative weights once\n    for weight in weights:\n        current_sum += weight\n        cumulative_weights.append(current_sum)\n    \n    selected_items = []\n\n    for _ in range(k):\n        # Random selection based on cumulative weights\n        target = random.uniform(0, current_sum)\n        selected_index = bisect.bisect_left(cumulative_weights, target)\n        selected_items.append(items[selected_index])\n    \n    return selected_items\n\n# Example usage\nitems = ['a', 'b', 'c', 'd']\nweights = [10, 20, 30, 40]\nprint(weighted_selection_with_replacement(items, weights, 5))