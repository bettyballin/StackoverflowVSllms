import socket\nfrom subprocess import check_output\n\ndef run_applescript(script):\n    return check_output(['osascript', '-e', script])\n\nserver_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\nserver_socket.bind(('localhost', 12345))\nserver_socket.listen(1)\n\nprint('Listening for connections...')\nconn, addr = server_socket.accept()\nwith conn:\n    print(f'Connected by {addr}')\n    while True:\n        data = conn.recv(1024).decode('utf-8')\n        if not data: break\n        result = run_applescript(data)\n        conn.sendall(result)\nserver_socket.close()