function processFolder(make, model, versionFolder):\n    images = []\n    startYear = 1999\n    endYear = 2009\n\n    // If the folder is not "default" and doesn't contain image files, use default images\n    if versionFolder != 'default_version' and isEmpty(versionFolder + "/"):\n        versionImages = getImagesFromVersion("default_version", startYear, endYear)\n    else:\n        versionImages = getImagesFromVersion(versionFolder, startYear, endYear)\n\n    for (year, fileList) in versionImages.items():\n        for file in fileList:\n            // Output the row to the linking table\n            print "version: " + versionFolder + ", start: " + year + ", end: " + year + ", file_name: " + file\n\nfunction getImagesFromVersion(versionName, startYear, endYear):\n    images = {}\n    for year in range(startYear, endYear+1):\n        folderPath = make + "/" + model + "/" + versionName + "/" + str(year)\n        if exists(folderPath):\n            images[year] = listFilesOfType(folderPath, '.jpg')\n    return images\n\nfunction isEmpty(folderPath):\n    // Check if the folder is empty\n    return len(listFiles(folderPath)) == 0\n\nfunction listFilesOfType(folderPath, fileType):\n    // Return a list of files in the folder with the given type (e.g., .jpg)\n    return [f for f in listFiles(folderPath) if f.endswith(fileType)]\n\nfunction listFiles(folderPath):\n    // List all files in the directory (excluding subdirectories)\n    onlyfiles = [f for f in os.listdir(folderPath) if isfile(join(folderPath, f))]\n    return onlyfiles\n\n// Main execution\nmodelsAndMakesFolder = "your/models/and/makes/folder/"\nfor makeModelDir in listDirectories(modelsAndMakesFolder):\n    modelPath = modelsAndMakesFolder + "/" + makeModelDir\n    for versionDir in listDirectories(modelPath):\n        processFolder(makeModelDir.split("_")[0], makeModelDir.split("_")[1], versionDir)