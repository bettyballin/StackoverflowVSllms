from upnpclient import devices\n\n# Discover UPnP devices on the network\nall_devices = devices.ssdp_discover()\n\n# Filter for Internet Gateway Device (IGD)\nigd_device = None\nfor device in all_devices:\n    if 'InternetGatewayDevice' in str(device.device_type):\n        igd_device = device\n        break\n\nif not igd_device:\n    print("No IGD found.")\nelse:\n    # Example: Get external IP address\n    try:\n        response = igd_device.WANIPConn1.GetExternalIPAddress()\n        print(f"External IP Address: {response.NewExternalIPAddress}")\n    except Exception as e:\n        print(f"Failed to get external IP address: {e}")\n\n# For adding port mapping (example):\ntry:\n    # Assuming the service is WANIPConnection\n    igd_device.WANIPConn1.AddPortMapping(\n        NewRemoteHost='', \n        NewExternalPort=8080, \n        NewProtocol='TCP', \n        NewInternalClient='192.168.1.100', \n        NewInternalPort=8080, \n        NewEnabled=1, \n        NewDescription='Test Port Mapping'\n    )\n    print("Port mapping added successfully.")\nexcept Exception as e:\n    print(f"Failed to add port mapping: {e}")