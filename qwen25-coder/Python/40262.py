import csv\n\n# Open the input and output files\nwith open("PALTemplateData.csv", 'r', newline='') as csvfile, \\n     open("PALTemplateDataOUT.csv", 'w', newline='') as csvout:\n    \n    # Detect the CSV dialect or use a specific one if known\n    dialect = csv.Sniffer().sniff(csvfile.read(1024))\n    csvfile.seek(0)\n    \n    reader = csv.reader(csvfile, dialect)\n    writer = csv.writer(csvout, dialect)\n    \n    total = 0\n    needchange = 0\n    changed = 0\n    \n    # Initialize an empty list to store rows with changes if needed\n    changeList = []\n    \n    for row in reader:\n        total += 1\n        \n        # Assuming the URL is in the last column; adjust as necessary\n        url_index = len(row) - 1\n        temp = row[url_index]\n        \n        if '/?' in temp:\n            needchange += 1\n            \n            # Replace '/?' with '?'\n            new_temp = temp.replace('/?', '?')\n            \n            if new_temp != temp:  # Check if a change actually occurred\n                changed += 1\n                row[url_index] = new_temp\n                changeList.append(row)\n        else:\n            # If no change needed, just add the unmodified row to changeList\n            changeList.append(row)\n    \n    # Write all rows (modified and unmodified) to the output file\n    writer.writerows(changeList)\n\n# Print statistics\nprint('Total URLs:', total)\nprint('Total URLs to change:', needchange)\nprint('Total URLs changed:', changed)