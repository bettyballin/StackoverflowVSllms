import zipfile\nfrom io import BytesIO\nfrom django.http import HttpResponse\n\ndef download_zip(request):\n    files = torrent[0].files\n    # Create a buffer to write the in-memory zip file\n    memory_file = BytesIO()\n\n    with zipfile.ZipFile(memory_file, 'w', zipfile.ZIP_DEFLATED) as zf:\n        for f in files:\n            # Open each file and add it to the zip file\n            path = settings.PYRAT_TRANSMISSION_DOWNLOAD_DIR + "/" + f.name\n            zf.write(path, arcname=f.name)\n\n    # Rewind to beginning of buffer\n    memory_file.seek(0)\n\n    response = HttpResponse(memory_file, content_type='application/zip')\n    response['Content-Disposition'] = 'attachment; filename="{}.zip"'.format(torrent_name)\n    \n    return response