from formencode import Schema, validators, Invalid\n\nclass RegistrationForm(Schema):\n    filter_extra_fields = True\n    allow_extra_fields = True\n    username = validators.UnicodeString(not_empty=True)\n    email = validators.Email(if_missing=None)\n    password1 = validators.UnicodeString(min=6, not_empty=True)\n    password2 = validators.UnicodeString(not_empty=True)\n\n    def validate_python(self, value_dict, state):\n        if value_dict.get('password1') != value_dict.get('password2'):\n            raise Invalid('Passwords do not match', value_dict, state, error_name='password_mismatch')