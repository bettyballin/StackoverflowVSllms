from flask import Flask, request, abort\nimport gssapi\n\napp = Flask(__name__)\n\ndef validate_ticket(token):\n    # Decode the base64 token\n    service_name = gssapi.Name(f"HTTP@{request.host}", name_type=gssapi.C_NT_HOSTBASED_SERVICE)\n    ctx = gssapi.SecurityContext(name=service_name, usage='accept')\n    \n    try:\n        data = gssapi.Buffer(base64.b64decode(token.split(' ')[1]))\n        while not ctx.established:\n            ctx.step(data)\n        \n        # Print the client name if needed\n        print(ctx.initiator_name.display_as(gssapi.C_NT_USER_NAME))\n        return True\n    except Exception as e:\n        print(f"Authentication failed: {e}")\n        return False\n\n@app.route('/')\ndef index():\n    token = request.headers.get('Authorization')\n    if not validate_ticket(token):\n        abort(401, {'WWW-Authenticate': 'Negotiate'})\n    \n    # Proceed with handling the authenticated request...\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=8080)