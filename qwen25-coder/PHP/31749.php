// In lib/model/CustomerQuery.php\nclass CustomerQuery extends BaseCustomerQuery\n{\n    public function withCompletedOrderCount()\n    {\n        return $this->withColumn(\n            'COUNT(CASE WHEN o.status = \'completed\' THEN o.id END)',\n            'Number_of_Completed_Orders'\n        )\n        ->leftJoin('Customer.Order o')\n        ->groupBy('Customer.Id');\n    }\n}\n\n// Usage in your controller or wherever needed\n$customersWithCounts = CustomerQuery::create()\n    ->withCompletedOrderCount()\n    ->find();\n\nforeach ($customersWithCounts as $customer) {\n    echo $customer->getNumberOfCompletedOrders(); // Access the calculated field\n}