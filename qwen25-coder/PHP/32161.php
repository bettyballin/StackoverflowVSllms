<?php\nsession_start();\n\n// Check if user is authenticated\nif (!isset($_SESSION['user_id'])) {\n    header('HTTP/1.0 403 Forbidden');\n    die('Access Denied.');\n}\n\n$filePath = '/uploads/' . basename($_GET['file']);\n\n// Prevent path traversal attacks\nif (strpos($filePath, '../') !== false) {\n    die('Invalid file path.');\n}\n\n// Check if file exists and is readable\nif (is_readable($filePath)) {\n    header('Content-Description: File Transfer');\n    header('Content-Type: application/octet-stream');\n    header('Content-Disposition: inline; filename="' . basename($filePath) . '"');\n    header('Expires: 0');\n    header('Cache-Control: must-revalidate');\n    header('Pragma: public');\n    header('Content-Length: ' . filesize($filePath));\n    readfile($filePath);\n    exit;\n} else {\n    die('File not found.');\n}\n?>