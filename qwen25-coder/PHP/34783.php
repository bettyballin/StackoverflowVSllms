<?php\n$safe_base_path = '/safe/directory'; // Define a safe base path\n\n$f = $_GET["f"];\nif(!$f) {\n    $f = "/";\n}\n\n// Convert the provided path to an absolute path and resolve any symbolic links.\n$fullpath = realpath($safe_base_path . '/' . trim($f, '/'));\n$safe_fullpath = $safe_base_path . '/' . trim($f, '/');\n\n// Check if the resolved path starts with the safe base path\nif ($fullpath === false || strpos($fullpath, $safe_base_path) !== 0) {\n    die("Unsafe directory");\n}\n\n// Now open the directory and list files safely\nif (is_dir($safe_fullpath)) {\n    if ($handle = opendir($safe_fullpath)) {\n        while (false !== ($entry = readdir($handle))) {\n            if ($entry != "." && $entry != "..") { // Skip . and ..\n                echo "<p>$entry</p>\n";\n            }\n        }\n        closedir($handle);\n    } else {\n        die("Could not open directory");\n    }\n} else {\n    die("The given path is not a directory.");\n}\n?>