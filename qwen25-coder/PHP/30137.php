<?php\nrequire_once __DIR__ . '/vendor/autoload.php';\n\nsession_start();\n\n$fb = new \Facebook\Facebook([\n  'app_id' => '{your-app-id}',\n  'app_secret' => '{your-app-secret}',\n  'default_graph_version' => 'v15.0',\n]);\n\n$helper = $fb->getRedirectLoginHelper();\ntry {\n    $accessToken = $helper->getAccessToken();\n} catch (\Facebook\Exceptions\FacebookResponseException $e) {\n    // When Graph returns an error\n    echo 'Graph returned an error: ' . $e->getMessage();\n    exit;\n} catch (\Facebook\Exceptions\FacebookSDKException $e) {\n    // When validation fails or other local issues\n    echo 'Facebook SDK returned an error: ' . $e->getMessage();\n    exit;\n}\n\nif (!isset($accessToken)) {\n    if ($helper->getError()) {\n        header('HTTP/1.0 403 Forbidden');\n        echo "Error: " . htmlspecialchars($helper->getError());\n        echo "\n";\n        echo "Error Code: " . htmlspecialchars($helper->getErrorCode());\n        echo "\n";\n        echo "Error Reason: " . htmlspecialchars($helper->getErrorReason());\n        echo "\n";\n        echo "Error Description: " . htmlspecialchars($helper->getErrorDescription());\n        exit;\n    } else {\n        header('HTTP/1.0 400 Bad Request');\n        echo 'Bad request';\n        exit;\n    }\n}\n\n// Logged in\n$_SESSION['facebook_access_token'] = (string) $accessToken;\n\n// Redirect to the main page with session preserved\nheader('Location: index.php');\nexit;\n?>