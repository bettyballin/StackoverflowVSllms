$query = 'INSERT INTO `data` (`field1`, `field2`) \n          SELECT `table_with_field1`.`field1`, `table_with_field2`.`field2`\n          FROM `table_with_field1`\n          WHERE `active` = 1\n          UNION ALL\n          SELECT DO_ONE(`field1`), DO_TWO(`field2`)\n          FROM `table_with_field1`  -- Ensure this points to the correct table\n          WHERE `active` = 1';\n\nif (mysql_query($query)) {\n    return true;\n}\nreturn false;