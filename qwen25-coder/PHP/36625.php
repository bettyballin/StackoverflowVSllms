$query = "\n    SELECT t.id, t.title, c.date AS last_comment_date\n    FROM threads t\n    LEFT JOIN (\n        SELECT thread_id, MAX(date) AS max_date\n        FROM comments\n        GROUP BY thread_id\n    ) c ON t.id = c.thread_id\n    ORDER BY c.max_date DESC, t.date DESC\n";\n\n$threads = mysql_query($query);\n\nwhile ($thread = mysql_fetch_assoc($threads)) {\n    echo $thread['title'] . " - Last Comment: " . $thread['last_comment_date'];\n}