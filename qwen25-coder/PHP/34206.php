<?php\n$some_php_document = $_POST["some_value_submitted_via_ajax"];\n\n// Define base path where files can be included from\n$base_path = __DIR__ . '/valid-directory/';\n\n// Regular expression to match only relative paths\nif (preg_match('/^[a-zA-Z0-9\/\-_.]+$/', $some_php_document) !== 1 || preg_match('/^\.\.|^\//', $some_php_document)) {\n    $some_php_document = null;\n} else {\n    // Construct full path using the base directory\n    $full_path = realpath($base_path . '/' . $some_php_document);\n\n    // Check if the constructed path is within the allowed directory and exists\n    if ($full_path !== false && strpos($full_path, $base_path) === 0 && file_exists($full_path)) {\n        include($full_path);\n    } else {\n        $some_php_document = null;\n    }\n}\n?>