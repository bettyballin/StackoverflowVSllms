<?php\nfunction encryptSSN($ssn, $key) {\n    // Initialization Vector (IV)\n    $ivlen = openssl_cipher_iv_length("aes-256-cbc");\n    $iv = openssl_random_pseudo_bytes($ivlen);\n\n    // Encrypting the SSN\n    $ciphertext_raw = openssl_encrypt($ssn, 'aes-256-cbc', $key, OPENSSL_RAW_DATA,$iv);\n    $hmac = hash_hmac('sha256', $ciphertext_raw, $key, true);\n    return base64_encode( $iv.$hmac.$ciphertext_raw );\n}\n\nfunction decryptSSN($encryptedData, $key) {\n    // Decode the data\n    $c = base64_decode($encryptedData);\n    $ivlen = openssl_cipher_iv_length("aes-256-cbc");\n    $iv = substr($c, 0, $ivlen);\n    $hmac = substr($c, $ivlen, $sha2len=32);\n    $ciphertext_raw = substr($c, $ivlen+$sha2len);\n\n    // Check the hash\n    $original_hmac = hash_hmac('sha256', $ciphertext_raw, $key, true);\n    if (hash_equals($hmac, $original_hmac)) {\n        return openssl_decrypt($ciphertext_raw, 'aes-256-cbc', $key, OPENSSL_RAW_DATA, $iv);\n    }\n    return null;\n}\n\n// Example usage\n$key = random_bytes(32); // Generate a new key for AES-256\n$ssn = "123-45-6789";\n$encryptedSSN = encryptSSN($ssn, $key);\n\necho "Encrypted SSN: " . $encryptedSSN;\n$decryptedSSN = decryptSSN($encryptedSSN, $key);\necho "\nDecrypted SSN: " . $decryptedSSN; // Should print the original SSN\n?>