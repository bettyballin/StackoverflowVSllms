function cleanPastedWordContent($html) {\n    // Strip all tags except some allowed ones like <a>, <b>, <i>\n    $cleaned = strip_tags($html, '<a><b><i><u>');\n\n    // Remove empty <span> tags often pasted from Word\n    $cleaned = preg_replace('/<span[^>]*>(\s|&nbsp;)*<\/span>/i', '', $cleaned);\n\n    // Replace Microsoft styling attributes with nothing (optional)\n    $cleaned = preg_replace("/<([a-zA-Z0-9]+) [^>]*style.+?>/i", "<$1>", $cleaned);\n    \n    return $cleaned;\n}\n\n// Example usage\n$userInput = '<p style="margin: 0in; font-size: 12pt; font-family: Calibri, sans-serif;">This is a <b>bold</b> text from Word.</p>';\n$cleanHtml = cleanPastedWordContent($userInput);\necho htmlspecialchars($cleanHtml); // Output will be safe to display