session_start(); // Start the session at the beginning of your script\n\nclass Login {\n    public function __construct($username, $rawPassword) {\n        global $db;\n\n        require('edit/users/config.php');\n\n        $hashedPassword = sha1(SALT . $_POST['password']); // This should be improved as mentioned\n\n        // Use prepared statements for security\n        $stmt = $db->prepare("SELECT firstname FROM users WHERE user = ? AND pass = ? LIMIT 1");\n        $stmt->bind_param("ss", $username, $hashedPassword);\n        $stmt->execute();\n        $result = $stmt->get_result();\n\n        if ($result->num_rows == 1) {\n            $_SESSION['username'] = $username;\n            header('Location: ' . CONFIG_DIR_BASE);\n            exit(); // Always exit after redirect\n        } else {\n            ErrorHandler::addErrorToStack('Your username and/or password did not match one on our system.');\n        }\n    }\n\n    public static function isAuthenticated() {\n        return isset($_SESSION['username']);\n    }\n\n    // Add a method to log out the user\n    public static function logout() {\n        session_unset(); // Unset all session variables\n        session_destroy(); // Destroy the session\n        header('Location: /'); // Redirect to an appropriate page in your application\n        exit();\n    }\n}