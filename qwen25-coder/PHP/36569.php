function dateExp($timestamp) {\n    $exp = strtotime($timestamp); // Convert MySQL timestamp to PHP timestamp\n    $today = time(); // Get current timestamp\n\n    return $exp > $today; // Return true if end_date is in the future, false if passed\n}\n\n$qry = "select *   \n         from   news\n         where  display='Y'\n         order by priority, date_added, title";\n\n$news = _execQry($qry);\n\nforeach ($news as $n) {\n    if (dateExp($n['end_date'])) { // Display only if end_date is in the future\n        echo '<h3>'. htmlspecialchars($n['title']) .'</h3>';\n        echo '<p>'. nl2br(htmlspecialchars($n['story'])) .'</p>'; // Use htmlspecialchars to prevent XSS and nl2br for line breaks\n        echo '<br />Added on '. dateFormat($n['date_added']) .'<br />';\n    }\n}