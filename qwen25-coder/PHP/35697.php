if($cmd == "submitinfo") {\n    // Check if the username exists using prepared statement\n    $usernameQuery = "SELECT username FROM USERS WHERE username = ?";\n    $stmt = $con->prepare($usernameQuery);\n    \n    if ($stmt) {\n        $stmt->bind_param("s", $username);\n        $stmt->execute();\n        $result = $stmt->get_result();\n\n        // Use a flag to check existence\n        $usernameExists = $result->num_rows > 0;\n\n        if (!$usernameExists) { // Insert operation\n            $userInsertQuery = "INSERT INTO USERS VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)";\n            $insertStmt = $con->prepare($userInsertQuery);\n\n            if ($insertStmt) {\n                $insertStmt->bind_param("ssssssssssssssssssss", \n                    $username, $firstname, $lastname, $flaggedauctions, \n                    $lastauction, $street1, $city1, $postcode1, \n                    $street2, $city2, $postcode2, $phone, $mobilephone, \n                    $fax, $email, $website, $bank, $banknumber, \n                    $accountnumber, $comments);\n\n                if ($insertStmt->execute()) {\n                    echo "User inserted successfully.";\n                } else {\n                    echo "Insert failed: " . $con->error;\n                }\n\n                $insertStmt->close();\n            } else {\n                echo "Failed to prepare insert statement.";\n            }\n        } else { // Update operation\n            $userUpdateQuery = "UPDATE USERS SET firstname = ?, lastname = ?, flaggedauctions = ?, lastauction = ?, street1 = ?, city1 = ?, postcode1 = ?, street2 = ?, city2 = ?, postcode2 = ?, phone = ?, mobilephone = ?, fax = ?, email = ?, website = ?, bank = ?, banknumber = ?, accountnumber = ? WHERE username = ?";\n            $updateStmt = $con->prepare($userUpdateQuery);\n\n            if ($updateStmt) {\n                $updateStmt->bind_param("sssssssssssssssssss", \n                    $firstname, $lastname, $flaggedauctions, \n                    $lastauction, $street1, $city1, $postcode1, \n                    $street2, $city2, $postcode2, $phone, \n                    $mobilephone, $fax, $email, $website, \n                    $bank, $banknumber, $accountnumber, $username);\n\n                if ($updateStmt->execute()) {\n                    echo "User updated successfully.";\n                } else {\n                    echo "Update failed: " . $con->error;\n                }\n\n                $updateStmt->close();\n            } else {\n                echo "Failed to prepare update statement.";\n            }\n        }\n\n        $stmt->close();\n    } else {\n        echo "Failed to prepare check username statement.";\n    }\n}