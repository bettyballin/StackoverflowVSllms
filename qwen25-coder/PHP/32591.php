<?php\n\n// Assuming all variables like $VillainPaypal, $itemname, $row, etc., are defined elsewhere in the script.\n$discprice = $row['DiscountedPrice'];\n$state = $_GET['state']; // or however you obtain this value\n$category = "odilisting"; // or another category as per your requirements\n\n// Default values\n$shipping = 0;\n$tax = 0;\n\nswitch ($category) {\n    case "odilisting":\n        $shipping = 5.95;\n        calculateTax($discprice, $state);\n        break;\n    case "gnclisting":\n        $shipping = 6;\n        break;\n    case "bananarepubliclisting":\n        $shipping = 7;\n        // Call Banana Republic for list of taxable states\n        break;\n    case "guesslisting":\n        $shipping = 7.95;\n        calculateTax($discprice, $state, [\n            'AZ', 'CA', 'CO', 'CT', 'FL', 'GA', 'HI', 'IL', 'IN', 'KS',\n            'LA', 'MA', 'MD', 'MI', 'MN', 'MO', 'NJ', 'NV', 'NY', \n            'NC', 'OH', 'PA', 'RI', 'SC', 'TN', 'TX', 'VA', 'WA'\n        ]);\n        break;\n    case "footlockerlisting":\n        $shipping = 6.99;\n        calculateTax($discprice, $state, ['AK', 'DE', 'MT', 'NH', 'OR'], false);\n        break;\n    case "americaneaglelisting":\n        if ($discprice < 100) {\n            $shipping = 7;\n        }\n        $tax = $discprice * .09;\n        break;\n}\n\n// Function to calculate tax based on state and taxable states\nfunction calculateTax($discprice, $state, $taxableStates = [], $defaultHighTax = true) {\n    global $tax;\n    if (empty($taxableStates)) {\n        // Default list of states with 9% tax\n        $taxableStates = ['AL', 'AR', 'AZ', 'CA', 'CO', 'CT', \n            'DC', 'DE', 'FL', 'GA', 'HI', 'IA', 'ID', 'IL',\n            'IN', 'KS', 'KY', 'LA', 'MA', 'MD', 'ME', 'MI', \n            'MN', 'MO', 'MS', 'MT', 'NC', 'ND', 'NE', 'NH', \n            'NJ', 'NM', 'NV', 'NY', 'OH', 'OK', 'OR', 'PA', \n            'RI', 'SC', 'SD', 'TN', 'TX', 'UT', 'VA', 'VT',\n            'WA', 'WI', 'WV', 'WY'];\n    }\n\n    if (in_array($state, $taxableStates)) {\n        $tax = $discprice * .09;\n    } else {\n        $tax = $defaultHighTax ? $discprice * .02 : 0;\n    }\n}\n\necho "Status: Claimed!";\n?>\n\n<form action='https://www.paypal.com/cgi-bin/webscr' target='_blank' method='post'>\n    <input type='hidden' name='business' value='<?php echo $VillainPaypal; ?>'>\n    <input type='hidden' name='cmd' value='_xclick'>\n    <input type='hidden' name='item_name' value="<?php echo htmlspecialchars($itemname); ?>">\n    <input type='hidden' name='shipping' value="<?php echo number_format($shipping, 2); ?>">\n    <input type='hidden' name='tax' value="<?php echo number_format($tax, 2); ?>">\n    <input type='hidden' name='amount' value='<?php echo htmlspecialchars($row['DiscountedPrice']); ?>'>\n    <input type='hidden' name='currency_code' value='USD'> <!-- Ensure you specify the currency -->\n    \n    <button type="submit">Proceed to Checkout</button>\n</form>\n\n<?php\n// No need for these variables unless they have a purpose\n$var1 = $var2 = null;