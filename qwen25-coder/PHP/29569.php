<?php\nfunction CreateDynamicPageIndex($ItemsPerPage, $TotalNumberOfItems, $CurrentOffset, $URL, $AdditionalArguments = array()) {\n    // Calculate total number of pages\n    $NumberOfPages = ceil($TotalNumberOfItems / $ItemsPerPage);\n    // Determine current page\n    $CurrentPage = floor(($CurrentOffset / $ItemsPerPage) + 1);\n\n    // Build the base URL with additional arguments\n    $baseURL = !empty($AdditionalArguments) ? sprintf("%s?%s&", $URL, http_build_query($AdditionalArguments)) : $URL . "?";\n    \n    echo "<div id=\"ResultsNavigation\">";\n        echo "Page: ";\n        echo "<span class=\"Links\">";\n\n        // Display Previous button if not on first page\n        if ($CurrentPage > 1) {\n            $prevOffset = ($CurrentPage - 2) * $ItemsPerPage;\n            echo sprintf("<a href=\"%sOffset=%d\">&lt;</a> ", $baseURL, $prevOffset);\n        }\n\n        // Display page numbers (show current and adjacent pages)\n        $startPage = max(1, $CurrentPage - 5);\n        $endPage   = min($NumberOfPages, $CurrentPage + 5);\n\n        for ($x = $startPage; $x <= $endPage; $x++) {\n            if ($x == $CurrentPage) {\n                echo sprintf("<span class=\"Selected\">%d</span> ", $x);\n            } else {\n                $offset = ($x - 1) * $ItemsPerPage;\n                echo sprintf("<a href=\"%sOffset=%d\">%d</a> ", $baseURL, $offset, $x);\n            }\n        }\n\n        // Display Next button if not on last page\n        if ($CurrentPage < $NumberOfPages) {\n            $nextOffset = $CurrentPage * $ItemsPerPage;\n            echo sprintf("<a href=\"%sOffset=%d\">&gt;</a> ", $baseURL, $nextOffset);\n        }\n        \n        echo "</span>";\n        echo " (".$TotalNumberOfItems." results)";\n    echo "</div>";\n}\n?>