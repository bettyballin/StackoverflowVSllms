foreach ($stuff as $key) {\n    // Prepare and execute your SQL statement to prevent SQL injection.\n    $stmt3 = mysqli_prepare($link_id, "SELECT * FROM foobar WHERE id=?");\n    mysqli_stmt_bind_param($stmt3, 's', $key);\n    mysqli_stmt_execute($stmt3);\n    $result3 = mysqli_stmt_get_result($stmt3);\n\n    while ($data3 = mysqli_fetch_array($result3)) {\n        // Prepare and execute another SQL statement for the second query.\n        $stmt4 = mysqli_prepare($link_id, "SELECT * FROM foobar_img WHERE id=?");\n        mysqli_stmt_bind_param($stmt4, 's', $data3[0]);\n        mysqli_stmt_execute($stmt4);\n        $result4 = mysqli_stmt_get_result($stmt4);\n\n        while ($data4 = mysqli_fetch_array($result4)) {\n            $x += 1;\n            if ($x % 3 == 0) {\n                echo "a: " . htmlspecialchars($data3[2]);\n            } else {\n                echo "b: " . htmlspecialchars($data3[2]);\n            }\n        }\n\n        // Close the statement resource for second query.\n        mysqli_stmt_close($stmt4);\n    }\n\n    // Close the statement resource for first query.\n    mysqli_stmt_close($stmt3);\n}