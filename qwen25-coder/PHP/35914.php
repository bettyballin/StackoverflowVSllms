<?php\n\n$ldapServer = 'ldap://your-ldap-server';\n$baseDn = 'DC=example,DC=com'; // replace with your base DN\n$username = 'user@domain.com'; // user you want to check\n$password = 'temporaryPassword'; // temporary password for LDAP binding, not the user's\n\n// Initialize LDAP connection\n$ds = ldap_connect($ldapServer);\nif (!$ds) {\n    die('Could not connect to LDAP server.');\n}\n\n// Set some options\nldap_set_option($ds, LDAP_OPT_PROTOCOL_VERSION, 3);\nldap_set_option($ds, LDAP_OPT_REFERRALS, 0);\n\n// Bind as a temporary user (not the user you're checking)\nif (!@ldap_bind($ds, $username . ',' . $baseDn, $password)) {\n    die('Could not bind to LDAP server.');\n}\n\n// Search for the user\n$search = ldap_search($ds, $baseDn, "(sAMAccountName=" . ldap_escape(trim($_POST['username']), null, LDAP_ESCAPE_FILTER) . ")");\n$entry = ldap_first_entry($ds, $search);\n\nif ($entry) {\n    // Fetch the lockoutTime attribute\n    $lockoutTime = ldap_get_values_len($ds, $entry, 'lockoutTime');\n    if (isset($lockoutTime[0]) && !empty($lockoutTime[0])) {\n        echo "Account is locked. Please contact IT.";\n    } else {\n        echo "Account is not locked.";\n    }\n} else {\n    echo "User not found.";\n}\n\n// Close the connection\nldap_close($ds);\n\n?>