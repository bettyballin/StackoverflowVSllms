<?php\n// Start sessions\nsession_start();\n\n// Check if user is logged in\nif (!isset($_SESSION['loggedin']) || $_SESSION['loggedin'] !== true) {\n    die("Access denied.");\n}\n\n// Get the requested image name from GET request\n$imageName = isset($_GET['name']) ? basename($_GET['name']) : '';\n\n// Define directory where images are stored\n$imagesDir = '../private_images/';\n\n// Full path to the image file\n$imagePath = $imagesDir . $imageName;\n\n// Check if file exists and is an image\nif (file_exists($imagePath) && is_readable($imagePath)) {\n    // Get the MIME type of the image\n    $mime_type = mime_content_type($imagePath);\n\n    // Set headers for output\n    header("Content-Type: " . $mime_type);\n    readfile($imagePath);  // Output the image file content\n} else {\n    die("Image does not exist.");\n}\n?>