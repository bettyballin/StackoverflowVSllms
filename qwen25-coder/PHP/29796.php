<?php\n\nrequire 'vendor/autoload.php';\n\nuse Aws\S3\S3Client; \nuse GuzzleHttp\Client;\n\n// Initialize S3 client\n$s3 = new S3Client([\n    'version' => 'latest',\n    'region'  => 'your-region', // e.g., us-west-2\n    'credentials' => [\n        'key'    => 'your-s3-key-id',\n        'secret' => 'your-s3-secret-key',\n    ],\n]);\n\n$bucket = 'your-bucket-name';\n$uploadDIR = '/path/to/your/file.mp4';\n$name = basename($uploadDIR);\n\n// Upload file to S3\ntry {\n    $result = $s3->putObject([\n        'Bucket'      => $bucket,\n        'Key'         => $name,\n        'Body'        => fopen($uploadDIR, 'r'),\n        'ACL'         => 'public-read', // or private\n        '@http'       => [\n            'timeout' => 600, // Increase timeout to handle larger files\n        ],\n    ]);\n\n    if ($result['ObjectURL']) {\n        echo "File uploaded successfully.\n";\n\n        // Initialize cURL client\n        $client = new Client();\n        \n        // Prepare the URL for your EC2 instance with necessary parameters\n        $url = 'http://your-ec2-instance-url/process-file.php?file='.$name;\n\n        try {\n            // Send a request to EC2 instance to process file\n            $response = $client->request('GET', $url, [\n                'timeout' => 60, // Adjust timeout as needed\n            ]);\n\n            if ($response->getStatusCode() == 200) {\n                echo "EC2 instance acknowledged the request.\n";\n            } else {\n                echo "Failed to communicate with EC2 instance.\n";\n            }\n        } catch (\GuzzleHttp\Exception\RequestException $e) {\n            echo 'Error in calling EC2 instance: ' . $e->getMessage();\n        }\n\n    } else {\n        echo "File upload failed.";\n    }\n\n} catch (S3Exception $e) {\n    echo "There was an error uploading the file.\n";\n    echo $e->getMessage() . "\n";\n}