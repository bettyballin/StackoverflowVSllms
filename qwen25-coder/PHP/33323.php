<?php\n\nfunction parseRawEmail($rawEmail) {\n    // Split the raw email into header and body\n    $headerEndPos = strpos($rawEmail, "\r\n\r\n");\n    if ($headerEndPos === false) {\n        throw new Exception("Invalid email format: Missing headers.");\n    }\n    \n    // Extract the header part\n    $emailHeader = substr($rawEmail, 0, $headerEndPos);\n    \n    // Parse the header using PHP's built-in function\n    $parsedHeaders = imap_rfc822_parse_headers(trim($emailHeader));\n    \n    if ($parsedHeaders === false) {\n        throw new Exception('Failed to parse headers');\n    }\n    \n    // Extract the body part\n    $emailBody = substr($rawEmail, $headerEndPos + 4);\n    \n    return [\n        'headers' => $parsedHeaders,\n        'body' => $emailBody\n    ];\n}\n\n// Example usage:\n$rawEmailContent = "From: example@example.com\r\n".\n                   "To: recipient@recipient.com\r\n".\n                   "Subject: Test Email\r\n".\n                   "\r\n".\n                   "This is the body of the email.\r\n";\n\ntry {\n    $emailComponents = parseRawEmail($rawEmailContent);\n    print_r($emailComponents['headers']);\n    echo $emailComponents['body'];\n} catch (Exception $e) {\n    echo 'Error: ',  $e->getMessage();\n}\n\n?>