<?php\n// Assume $connection is a valid DB connection handle\n$user = $_POST['user'];\n$password = $_POST['password'];\n\n// Use prepared statements to prevent SQL injection\n$stmt = $connection->prepare("SELECT * FROM table WHERE user=?");\n$stmt->bind_param("s", $user);\n$stmt->execute();\n$result = $stmt->get_result();\n\n$myrow = $result->fetch_row();\n\nif ($myrow) {\n    // Encode the password using base64_encode just like it's stored\n    $somepass = base64_encode($password);\n\n    if ($myrow[1] === $somepass) {  // Use strict comparison\n        echo 'welcome';\n    } else {\n        echo 'error';\n    }\n} else {\n    echo 'user not found';\n}\n\n$stmt->close();\n?>