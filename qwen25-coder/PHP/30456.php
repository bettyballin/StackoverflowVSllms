<?php\n// Mantis Login Script - Token verification\n\nfunction verifySecureToken($receivedToken) {\n    if (!isset($_GET['token'])) return false;\n\n    // This should match what was generated. Here we just simulate the check.\n    $expectedToken = generateSecureToken('user_id', '+5 minutes');  // For real implementation, this needs to compare stored token or regenerate same hash\n\n    // Ensure it's not expired\n    if (time() > strtotime('+30 minutes')) {\n        return false;\n    }\n\n    // Compare hashes securely\n    return hash_equals($expectedToken, $receivedToken);\n}\n\nif (!verifySecureToken($_GET['token'])) {\n    echo "Access denied";\n    exit;\n} else {\n    // Log in the user without password check\n    $_SESSION['user_authenticated'] = true;  // Secure practice involves more checks and stored data.\n}\n?>