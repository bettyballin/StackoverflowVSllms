try {\n    $conn = new PDO("odbc:Driver={SQL Server Native Client 10.0};Server={$host};Database={$db};Uid={$user};Pwd={$pass}", \n                     $user, $pass);\n    $conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);\n\n    // Start a transaction\n    $conn->beginTransaction();\n\n    // Perform your insert operation\n    $stmt = $conn->prepare("INSERT INTO YourTable (column1, column2) VALUES (:value1, :value2)");\n    $stmt->execute([':value1' => 'data1', ':value2' => 'data2']);\n\n    // Get the last inserted ID using SCOPE_IDENTITY()\n    $lastInsertId = $conn->query('SELECT SCOPE_IDENTITY()')->fetchColumn();\n\n    // Commit the transaction\n    $conn->commit();\n\n    echo "Last Inserted ID: " . $lastInsertId;\n} catch (PDOException $e) {\n    // Rollback the transaction in case of error\n    if ($conn->inTransaction()) {\n        $conn->rollBack();\n    }\n    echo 'Connection failed: ' . $e->getMessage();\n}