<?php\n$friendEmail = $_POST['friend_email']; // Assuming this comes from a form submission\n\n// Database connection (make sure to handle your database credentials securely)\n$dbLink = mysql_connect("localhost", "username", "password");\nmysql_select_db("your_database_name", $dbLink);\n\n// Prepare the query to check if email already exists\n$emailCheckQuery = sprintf("SELECT COUNT(*) FROM referrals WHERE friend_email = '%s'", \n                           mysql_real_escape_string($friendEmail, $dbLink));\n\n$result = mysql_query($emailCheckQuery, $dbLink);\n$row = mysql_fetch_row($result);\n\nif ($row[0] == 0) {\n    // Email does not exist, proceed with the insert\n    $insertQuery = sprintf("INSERT INTO referrals (referral_user_id, friend_email) VALUES ('%s', '%s')", \n                             mysql_real_escape_string($_POST['user_id'], $dbLink), \n                             mysql_real_escape_string($friendEmail, $dbLink));\n\n    if (!mysql_query($insertQuery, $dbLink)) {\n        echo "Error in inserting data: " . mysql_error($dbLink);\n    } else {\n        echo "Referral added successfully!";\n    }\n} else {\n    echo "This email is already registered for referral points.";\n}\n\n// Free result set and close the database connection\nmysql_free_result($result);\nmysql_close($dbLink);\n?>