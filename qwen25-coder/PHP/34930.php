function outputFile($filePath, $fileName) {\n    // Determine MIME Type using file info\n    $finfo = finfo_open(FILEINFO_MIME_TYPE);\n    $mimeType = finfo_file($finfo, $filePath);\n    finfo_close($finfo);\n\n    // Get file size and sanitize filename\n    $fileSize = filesize($filePath);\n    $fileName = rawurldecode($fileName);\n\n    // Disable Output Buffering\n    @ob_end_clean();\n\n    // Prevent output compression by proxies/server\n    if(ini_get('zlib.output_compression')) {\n        ini_set('zlib.output_compression', 'Off');\n    }\n\n    // Send Headers\n    header('Content-Type: ' . $mimeType);\n    header('Content-Disposition: attachment; filename="' . $fileName . '"');\n    header('Content-Transfer-Encoding: binary');\n    header('Accept-Ranges: bytes');\n\n    // Prevent Caching of File\n    header('Cache-Control: private');\n    header('Pragma: private');\n    header('Expires: Mon, 26 Jul 1997 05:00:00 GMT');\n\n    if(isset($_SERVER['HTTP_RANGE'])) {\n        list($a, $range) = explode('=', $_SERVER['HTTP_RANGE'], 2);\n        list($rangeStart, $rangeEnd) = explode('-', $range, 2);\n\n        $rangeStart = intval($rangeStart);\n        $rangeEnd = ($rangeEnd != '') ? intval($rangeEnd) : $fileSize - 1;\n\n        if ($rangeStart >= $fileSize || $rangeStart > $rangeEnd) {\n            header('HTTP/1.1 416 Requested Range Not Satisfiable');\n            exit;\n        }\n\n        header('Content-Length: ' . ($rangeEnd - $rangeStart + 1));\n        header("Content-Range: bytes {$rangeStart}-{$rangeEnd}/$fileSize");\n        header('HTTP/1.1 206 Partial Content');\n    } else {\n        header('Content-Length: ' . $fileSize);\n    }\n\n    // Output File\n    $chunkSize = 1 * (1024*1024); //1MB chunks\n    $bytesSend = 0;\n\n    if ($file = fopen($filePath, 'r')) {\n        fseek($file, $rangeStart);\n\n        while(!feof($file) && !connection_aborted() && ($bytesSend < ($rangeEnd - $rangeStart + 1))) {\n            $buffer = fread($file, $chunkSize);\n            echo $buffer;\n            flush();\n            $bytesSend += strlen($buffer);\n        }\n        fclose($file);\n    }\n}