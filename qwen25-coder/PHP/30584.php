session_start();\n\nfunction generateCSRFToken() {\n    if (empty($_SESSION['csrf_token'])) {\n        $_SESSION['csrf_token'] = bin2hex(random_bytes(32));\n    }\n    return $_SESSION['csrf_token'];\n}\n\nfunction validateCSRFToken($token) {\n    return hash_equals($_SESSION['csrf_token'], $token);\n}\n\n// On routine.php\nif ($_SERVER['REQUEST_METHOD'] === 'POST') {\n    if (!validateCSRFToken($_SERVER['HTTP_X_CSRF_TOKEN'])) {\n        http_response_code(403);\n        echo "Invalid CSRF token";\n        die();\n    }\n    // Process request...\n}