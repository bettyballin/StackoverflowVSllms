function fnSanitizePost($data) //escapes,strips and trims all members of the post array\n{\n    if (is_array($data)) {\n        $areturn = array();\n        foreach ($data as $skey => $svalue) {\n            $areturn[$skey] = fnSanitizePost($svalue);\n        }\n        return $areturn;\n    } else {\n        // Handle magic quotes if enabled\n        if (get_magic_quotes_gpc()) {\n            $data = stripslashes($data);\n        }\n\n        // Standardize encoding to UTF-8 and convert special characters\n        $data = mb_convert_encoding((string) $data, 'UTF-8', 'UTF-8');\n\n        // Use regex to remove or normalize unwanted characters\n        // This example replaces smart quotes with straight quotes and other symbols\n        $data = preg_replace("/[\x{201C}\x{201D}]/u", '"', $data);  // Smart double quotes to straight double quotes\n        $data = preg_replace("/[\x{2018}\x{2019}]/u", "'", $data);  // Smart single quotes to straight single quotes\n        $data = preg_replace("/\xE2\x80\x99/u", "'", $data);       // Another representation of smart single quote to straight single quote\n\n        // Strip tags and escape string for database\n        $data = strip_tags($data);\n        $data = pg_escape_string($data);\n\n        // Trim whitespace\n        $data = trim($data);\n\n        return $data;\n    }\n}