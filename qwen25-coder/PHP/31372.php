<?php\nclass User_Auth {\n    private $pdo;\n\n    public function __construct($host, $dbname, $user, $password) {\n        try {\n            $this->pdo = new PDO("mysql:host=$host;dbname=$dbname;charset=utf8", $user, $password);\n            $this->pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);\n        } catch (PDOException $e) {\n            die("Could not connect to the database: " . $e->getMessage());\n        }\n    }\n\n    public function register($username, $email, $password, $role = 'user') {\n        $hashed_password = password_hash($password, PASSWORD_DEFAULT);\n        $stmt = $this->pdo->prepare("INSERT INTO users (username, email, password, role) VALUES (:username, :email, :password, :role)");\n        return $stmt->execute([\n            ':username' => $username,\n            ':email'    => $email,\n            ':password' => $hashed_password,\n            ':role'     => $role\n        ]);\n    }\n\n    public function login($username, $password) {\n        $stmt = $this->pdo->prepare("SELECT id, password, role FROM users WHERE username = :username");\n        $stmt->execute([':username' => $username]);\n        $user = $stmt->fetch(PDO::FETCH_ASSOC);\n        \n        if ($user && password_verify($password, $user['password'])) {\n            session_start();\n            $_SESSION['user_id'] = $user['id'];\n            $_SESSION['role']    = $user['role'];\n            return true;\n        }\n        return false;\n    }\n\n    public function logout() {\n        session_start();\n        session_unset();\n        session_destroy();\n    }\n\n    public function checkRole($requiredRole) {\n        session_start();\n        if (isset($_SESSION['role']) && $_SESSION['role'] === $requiredRole) {\n            return true;\n        }\n        return false;\n    }\n}\n?>