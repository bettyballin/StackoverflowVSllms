function checkbadges($userid,$points,$rank,$friends){\n    global $database;\n\n    // Map of operator strings to PHP comparison function names\n    $operators = [\n        '==' => function($a, $b) { return $a == $b; },\n        '>=' => function($a, $b) { return $a >= $b; },\n        '<=' => function($a, $b) { return $a <= $b; },\n        '!=' => function($a, $b) { return $a != $b; }\n    ];\n\n    // Fetch badges from database\n    $q = $database->db_query("SELECT * FROM badges");\n    \n    while($bq = $database->db_fetch_assoc($q)) {\n        // Safely fetch user variable value by name\n        $userValue = $$bq['badge_var']; // This assumes badge_var's values are valid variable names\n\n        // Get comparison function based on operator and call it\n        if(isset($operators[$bq['badge_sign']]) && $operators[$bq['badge_sign']]($userValue, $bq['badge_value'])) {\n            givebadge($userid, $bq['badge_id']);\n        }\n    }\n}