<?php\n\nfunction ip_in_range($ip, $ranges) {\n    foreach ($ranges as $range) {\n        // Check if the IP is in the range using cidr_match\n        if (filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_IPV4) && filter_var($range, FILTER_VALIDATE_IP, FILTER_FLAG_IPV4)) {\n            // For single IPs without CIDR notation, append /32\n            $range .= '/32';\n        }\n        if (cidr_match($ip, $range)) {\n            return true;\n        }\n    }\n    return false;\n}\n\nfunction cidr_match($ip, $cidr) {\n    list ($subnet, $bits) = explode('/', $cidr);\n    $ip = ip2long($ip);\n    $subnet = ip2long($subnet);\n    $mask = -1 << (32 - $bits);\n    return ($ip & $mask) == ($subnet & $mask);\n}\n\n$allowed_ranges = [\n    '10.0.0.0/8',\n    '200.10.10.0/24'\n];\n\n$client_ip = $_SERVER['REMOTE_ADDR'];\n\nif (!ip_in_range($client_ip, $allowed_ranges)) {\n    http_response_code(403);\n    echo "Access Denied";\n    exit;\n}\n\n// Rest of your PHP script here\necho "Welcome! Your IP is: " . htmlspecialchars($client_ip);\n\n?>