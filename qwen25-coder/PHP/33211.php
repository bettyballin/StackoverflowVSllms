<?php\n// Start the session at the very beginning\nsession_start();\n\n$dbconn = pg_connect("host=localhost port=5432 dbname=masi user=masi password=123");\n$result = pg_prepare($dbconn, "query22", "SELECT passhash_md5 FROM users WHERE email=$1;");\n\n$email = $_POST['email']; // Ensure to use POST instead of REQUEST\n$passhash_md5_from_user = md5($_POST['password']);\n\n$passhash_md5_from_db = pg_execute($dbconn, "query22", array($email));\n\n// Check if password matches and set session variables\nif ($passhash_md5_from_db[0]['passhash_md5'] === $passhash_md5_from_user) {\n    $_SESSION['logged_in'] = true;\n    $_SESSION['email'] = $email;\n    // Do not store plain or hashed passwords in sessions unnecessarily\n} else {\n    $_SESSION['logged_in'] = false;\n}\n\n// Redirect based on login status or display message\nif ($_SESSION['logged_in']) {\n    header("Location: welcome.php"); // Example redirect to welcome page\n    exit();\n} else {\n    echo "Login Failed";\n}\n?>