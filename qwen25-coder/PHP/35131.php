<?php\nsession_start();\n\nif (!isset($_SESSION['csrf_token'])) {\n    $_SESSION['csrf_token'] = bin2hex(random_bytes(32));\n}\n\n$token = $_SESSION['csrf_token'];\n\n// Pass this `$token` to your iFrame src as a query parameter or in a POST request\n\nif (isset($_GET['token']) && hash_equals($token, $_GET['token'])) {\n    // Token matches, proceed with loading the wiki content\n} else {\n    // Invalid token, redirect to login or show error\n    header('Location: http://foobar/login');\n    exit();\n}\n\n// Continue with wiki content loading\n?>