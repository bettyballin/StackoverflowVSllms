// Reading the file as GD image data\n$imagedata = imagecreatefrompng($imagefile);\n\n// Do some GD processing: Adding watermarks etc.\n// Example: Add a watermark (assuming $watermark is another GD resource)\nif ($watermark) {\n    // Calculate position for watermark\n    $marge_right = 10;\n    $marge_bottom = 10;\n    $sx = imagesx($watermark);\n    $sy = imagesy($watermark);\n\n    imagecopy($imagedata, $watermark, imagesx($imagedata) - $sx - $marge_right, imagesy($imagedata) - $sy - $marge_bottom, 0, 0, imagesx($watermark), imagesy($watermark));\n}\n\n// Start output buffering\nob_start();\nimagepng($imagedata);\n\n// Get the contents of the output buffer (the image as a string)\n$stringdata = ob_get_clean();\n\n// Free memory associated with GD image resource\nimagedestroy($imagedata);\n\n// Compressing the string data\n$zdata = gzdeflate($stringdata);