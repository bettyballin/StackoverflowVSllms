<?php\nsession_start();\nif (!isset($_SESSION['logged_in']) || $_SESSION['logged_in'] !== true) {\n    header('Location: login.php');\n    exit;\n}\n\n// Your code to list or serve files from the protected directory goes here.\n// Example: listing files in a directory\n$files = scandir('./protected_files/');\nforeach ($files as $file) {\n    if (!in_array($file, array('.', '..'))) {\n        echo '<li>' . htmlspecialchars($file) . '</li>';\n    }\n}\n?>