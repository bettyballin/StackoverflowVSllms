require 'vendor/autoload.php';\nuse PhpMimeMailParser\Parser;\n\nfunction clean($text) {\n    $parser = new Parser();\n    $parser->setText($text);\n\n    // Try to get the HTML body first.\n    try {\n        $htmlBody = $parser->getMessageBody('html');\n        return $htmlBody;\n    } catch (\Exception $e) {}\n\n    // If no HTML body, return the plain text body.\n    try {\n        $plainText = $parser->getMessageBody('text');\n        return nl2br(htmlentities($plainText)); // Convert new lines to <br> and escape HTML\n    } catch (\Exception $e) {}\n\n    // Fallback.\n    return "No readable content found.";\n}\n\n$text = "> This message is in MIME format. Since your mail reader does not understand\nthis format, some or all of this message may not be legible.\n\n--B_3331365494_4098727\nContent-type: text/plain;\ncharset=\"US-ASCII\"\nContent-transfer-encoding: 7bit\n\ntest\n\n--B_3331365494_4098727\nContent-type: text/html;\ncharset=\"US-ASCII\"\nContent-transfer-encoding: quoted-printable\n\n<HTML>\n<HEAD>\n<TITLE>Test</TITLE>\n</HEAD>\n<BODY>\n<FONT FACE=\"Calibri, Verdana, Helvetica, Arial\"><SPAN STYLE='font-size:11pt'>test</SPAN></FONT>\n</BODY>\n</HTML>\n\n\n--B_3331365494_4098727--";\necho clean($text);