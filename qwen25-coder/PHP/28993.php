<?php\nfunction resizeImage($imageUrl, $maxWidth, $maxHeight) {\n    // Load image from URL\n    $imageData = file_get_contents($imageUrl);\n    $im = imagecreatefromstring($imageData);\n\n    if (!$im) {\n        return null;\n    }\n\n    // Get current dimensions and calculate optimal size\n    $width = imagesx($im);\n    $height = imagesy($im);\n\n    $ratio = $width / $height;\n\n    if ($maxWidth / $maxHeight > $ratio) {\n        $newWidth = $maxHeight * $ratio;\n        $newHeight = $maxHeight;\n    } else {\n        $newWidth = $maxWidth;\n        $newHeight = $maxWidth / $ratio;\n    }\n\n    // Create a new true color image\n    $thumb = imagecreatetruecolor($newWidth, $newHeight);\n\n    // Resize and copy old image into new image\n    imagecopyresampled($thumb, $im, 0, 0, 0, 0, $newWidth, $newHeight, $width, $height);\n\n    // Encode the resized image in base64\n    ob_start();\n    imagejpeg($thumb);\n    $imageData = ob_get_contents();\n    ob_end_clean();\n\n    imagedestroy($im);\n    imagedestroy($thumb);\n\n    return 'data:image/jpeg;base64,' . base64_encode($imageData);\n}\n\n// Usage example\n$imageUrl = "http://example.com/large-image.jpg";\n$maxWidth = 150;\n$maxHeight = 100;\n\n$resizedImageBase64 = resizeImage($imageUrl, $maxWidth, $maxHeight);\necho '<img src="' . $resizedImageBase64 . '">';\n?>