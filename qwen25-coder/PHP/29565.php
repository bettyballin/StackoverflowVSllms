function getPictures() {\n    global $page, $per_page, $has_previous, $has_next;\n    if ( $handle = opendir(".") ) {\n        $lightbox = rand();\n        echo '<ul id="pictures">';\n\n        $files = [];\n        while ( false !== ($file = readdir($handle)) ) {\n            if ( ! is_dir($file) && getPictureType($file) != '' ) {\n                $files[] = $file;\n            }\n        }\n\n        // Sort files naturally\n        natsort($files);\n\n        $count = 0;\n        $skip = $page * $per_page;\n\n        if ( $skip != 0 )\n            $has_previous = true;\n\n        foreach ($files as $index => $file) {\n            if ($index < $skip) continue;\n            if ($index >= $skip && $index < $skip + $per_page) {\n                if ( ! is_dir('thumbs') ) {\n                    mkdir('thumbs');\n                }\n                if ( ! file_exists('thumbs/'.$file) ) {\n                    makeThumb( $file, getPictureType($file) );\n                }\n                echo '<li><a href="'.$file.'" class="zoom" rel="group">';\n                echo '<img src="thumbs/'.$file.'" alt="" />';\n                echo '</a></li>';\n                $count++;\n            } else if ($index >= $skip + $per_page) {\n                break;\n            }\n        }\n\n        echo '</ul>';\n\n        // Check for next page\n        if ( count($files) > $skip + $per_page ) {\n            $has_next = true;\n        }\n    }\n}