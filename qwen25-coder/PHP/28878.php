<?php\n$inputDir = "input/";\n$outputDir = "output/";\n\nif (!is_dir($inputDir)) {\n    die("Input directory not found.");\n}\nif (!is_dir($outputDir)) {\n    mkdir($outputDir, 0755);\n}\n\n$files = scandir($inputDir);\n$i = 0;\nforeach ($files as $imgfile) {\n    if ($imgfile != "." && $imgfile != "..") {\n        $uploadedFilePath = $inputDir . $imgfile;\n        $src = imagecreatefromgif($uploadedFilePath);\n        \n        // Check if the file was loaded successfully\n        if (!$src) {\n            echo "Error loading image: $uploadedFilePath\n";\n            continue;\n        }\n\n        list($width, $height) = getimagesize($uploadedFilePath);\n        $tmp = imagecreatetruecolor(240, 320);\n        \n        // Preserve transparency for GIFs\n        $transparentIndex = imagecolortransparent($src);\n        if ($transparentIndex >= 0) {\n            $transparentColor = imagecolorsforindex($src, $transparentIndex);\n            $transparentIndex = imagecolorallocate($tmp, $transparentColor['red'], $transparentColor['green'], $transparentColor['blue']);\n            imagefill($tmp, 0, 0, $transparentIndex);\n            imagecolortransparent($tmp, $transparentIndex);\n        }\n\n        imagecopyresampled($tmp, $src, 0, 0, 0, 0, 240, 320, $width, $height);\n\n        $outputFilePath = $outputDir . $imgfile;\n        imagegif($tmp, $outputFilePath, 100);\n       \n        imagedestroy($src);\n        imagedestroy($tmp);\n        \n        echo "Saved resized image as: $outputFilePath\n";\n    }\n}\n?>