function prepareString($str) {\n    // Convert everything to lowercase\n    $str = mb_strtolower(trim($str));\n\n    // Replace any non-Latin/ideographic characters with space\n    $str = preg_replace('/[^\p{Latin}\p{Han}0-9\s]+/u', ' ', $str);\n\n    // Split ideographic characters and keep numbers & Latin letters together\n    $result = preg_split('/(?<=[^\p{L}\p{N}])(?=\p{L}\p{N})|(?<=\d)(?=\D)|(?<=[^02])(?=[02])/', $str, -1, PREG_SPLIT_NO_EMPTY);\n\n    // Join the result array into a single string with spaces\n    return trim(implode(' ', $result));\n}\n\n$input = "hello 1234567890 蓄積した abc123def";\necho prepareString($input);