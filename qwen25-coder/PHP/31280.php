protected function PreRenderTextarea(WebPage $sender)\n{\n    $textarea = $sender->createElement('textarea');\n    // Copy attributes except 'value'\n    foreach ($this->attributes as $attribute) {\n        if ($attribute->name != 'value') {\n            $textarea->setAttribute($attribute->name, $attribute->value);\n        }\n    }\n    \n    // Set node value separately\n    $textarea->nodeValue = $this->getAttribute('value');\n    \n    // Keep logic separate\n    $this->migrateCustomLogic($textarea);\n    \n    // Replace the current element with textarea\n    $this->parentNode->replaceChild($textarea, $this);\n}\n\nprotected function migrateCustomLogic(DOMElement $newElement)\n{\n    // Reapply any custom logic or event handlers here\n    if ($this->modeSpecificBehavior) {\n        // Example behavior based on previous logic\n        $newElement->setAttribute('custom-behavior', 'active');\n    }\n    \n    // Add more logic as needed\n}\n\npublic function OnPreRender(WebPage $sender)\n{\n    parent::OnPreRender();\n    $this->setAttribute('value', $this->Value);\n\n    switch ($this->Mode) {\n        case 'normal':\n            $this->setAttribute('type', 'text');\n            break;\n        case 'password':\n            $this->setAttribute('type', 'password');\n            break;\n        case 'multiline':\n            $this->PreRenderTextarea($sender);\n            return;\n    }\n}