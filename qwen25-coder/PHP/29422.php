use Swift_Message;\n\n// Create a message instance\n$message = new Swift_Message();\n$message->setSubject('Exported Data');\n$message->setFrom(['sender@example.com' => 'Sender Name']);\n$message->addTo('recipient@example.com', 'Recipient Name');\n\n// Generate CSV data in memory\n$outputStream = fopen("php://memory", "r+");\n$dataArray = [\n    ['Name', 'Email'],\n    ['John Doe', 'john.doe@example.com'],\n    ['Jane Smith', 'jane.smith@example.com']\n];\nforeach ($dataArray as $row) {\n    fputcsv($outputStream, $row);\n}\nrewind($outputStream);\n\n// Attach the in-memory file to the email\n$message->attach(\n    \Swift_Attachment::fromStream($outputStream, 'data.csv')\n        ->setContentType('text/csv')\n);\n\n// Send the message using a transport mechanism\n$transport = (new Swift_SmtpTransport('smtp.example.com', 587))\n    ->setUsername('your_username')\n    ->setPassword('your_password');\n$mailer = new Swift_Mailer($transport);\n$result = $mailer->send($message);\n\nfclose($outputStream);