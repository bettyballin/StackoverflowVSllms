// Initialize session to store state across pages.\nsession_start();\n\nfunction performSearch($queryParameters) {\n    // Serialize the query parameters and save to session\n    $_SESSION['last_search_params'] = serialize($queryParameters);\n\n    // Delete previous search data if any (consider purging periodically instead)\n    clearPreviousSearchData();\n\n    // Perform actual search logic here, returning list of user IDs\n    $resultIDs = executeQuery($queryParameters);\n    \n    // Assign random order to the result IDs\n    shuffle($resultIDs);\n\n    // Insert new search into searches table\n    $searchID = insertIntoSearches(NULL); // Pass user_id if necessary\n\n    // Insert results with their random orders into searches_results table\n    foreach ($resultIDs as $order => $id) {\n        insertIntoSearchResults($searchID, $id, $order);\n    }\n\n    return $searchID;\n}\n\nfunction clearPreviousSearchData() {\n    // Implement logic to clean up old search and corresponding results.\n    // Use a background job or a cron task to do this periodically.\n}\n\nfunction executeQuery($queryParameters) {\n    // Logic to query database based on parameters, returning list of result IDs\n}\n\nfunction insertIntoSearches($userId) {\n    // Insert into searches table and return generated id\n}\n\nfunction insertIntoSearchResults($searchId, $resultId, $order) {\n    // Insert individual results with order\n}