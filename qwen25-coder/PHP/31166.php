function addFilm($filmData) {\n    // Connect to your database\n    $db = new PDO('mysql:host=localhost;dbname=movie_db', 'username', 'password');\n    \n    // Start a transaction\n    $db->beginTransaction();\n    \n    try {\n        // Insert or fetch director ID\n        $stmt = $db->prepare("INSERT INTO Directors (name) VALUES (?) ON DUPLICATE KEY UPDATE name=name RETURNING directorid");\n        $stmt->execute([$filmData['director']]);\n        $directorId = $stmt->fetchColumn();\n\n        // Insert or fetch genre ID\n        $stmt = $db->prepare("INSERT INTO Genres (genre) VALUES (?) ON DUPLICATE KEY UPDATE genre=genre RETURNING genreid");\n        $stmt->execute([$filmData['genre']]);\n        $genreId = $stmt->fetchColumn();\n\n        // Insert film data using the fetched IDs\n        $insertFilmStmt = $db->prepare("INSERT INTO Films (filmtitle, runningtime, description, year, director_id, genre_id) VALUES (?, ?, ?, ?, ?, ?)");\n        $insertFilmStmt->execute([\n            $filmData['filmtitle'],\n            $filmData['runningtime'],\n            $filmData['description'],\n            $filmData['year'],\n            $directorId,\n            $genreId\n        ]);\n\n        // Insert actors into the database if not already present, and link to film\n        foreach ($filmData['actors'] as $actorName) {\n            $stmt = $db->prepare("INSERT INTO Actors (name) VALUES (?) ON DUPLICATE KEY UPDATE name=name RETURNING actor_id");\n            $stmt->execute([$actorName]);\n            $actorId = $stmt->fetchColumn();\n\n            // Insert into Film_Actors table\n            $filmActorStmt = $db->prepare("INSERT INTO Film_Actors (filmid, actor_id) VALUES ((SELECT LAST_INSERT_ID()), ?)");\n            $filmActorStmt->execute([$actorId]);\n        }\n\n        // Commit transaction\n        $db->commit();\n    } catch (\Exception $e) {\n        // Rollback on error\n        $db->rollBack();\n        throw $e;\n    }\n}\n\n// Example usage:\n$filmData = [\n    'filmtitle' => 'Matrix',\n    'runningtime' => 136,\n    'description' => 'A computer hacker learns about the true nature of his reality and his role in the war against its controllers.',\n    'year' => 1999,\n    'director' => 'Lana Wachowski, Lilly Wachowski',\n    'genre' => 'Action',\n    'actors' => ['Keanu Reeves', 'Lawrence Fishburne', 'Carrie-Anne Moss']\n];\n\naddFilm($filmData);