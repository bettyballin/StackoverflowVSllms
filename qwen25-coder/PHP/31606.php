$unenc_path = __DIR__ . '/tmp/'. preg_replace('/[^0-9]/','', microtime()) . rand(0,1000) . "msg.txt";\n$enc_path = __DIR__ . '/tmp/'. preg_replace('/[^0-9]/','', microtime()) . rand(0,1000) . "enc.txt";\n\n// Ensure the directory exists and is writable\nif (!is_dir(__DIR__ . '/tmp')) {\n    mkdir(__DIR__ . '/tmp', 0755, true);\n}\n\n$fp = fopen($unenc_path, "w");\nfwrite($fp, $msg);\nfclose($fp);\n\n$easy_access_emails = ['person@##.com'];\n$headers =   "From: support@##.com <support@##.com>\r\n" . \n             "Reply-to: support@##.com\r\n" . \n             "Subject: " . $subject . "\r\n";\n\n$key = file_get_contents("../newcert.pem");\n\n$ArrayMessageProperties = explode("\r\n", $headers);\n\nif (openssl_pkcs7_encrypt($unenc_path, $enc_path, $key, $ArrayMessageProperties)) {\n    $info = file_get_contents($enc_path);\n    foreach ($easy_access_emails as $email) {\n        mail($email, $subject, $info, $headers);\n    }\n} else {\n    die("Failed Encryption: " . error_get_last()['message']);\n}