function pkcs7_unpad($text, $block_size) {\n    $len = strlen($text);\n    $pad_value = ord($text[$len - 1]);\n    \n    // Check if the padding is valid\n    for ($i = $len - $pad_value; $i < $len; $i++) {\n        if (ord($text[$i]) != $pad_value) {\n            return false; // Invalid padding\n        }\n    }\n    \n    return substr($text, 0, -$pad_value);\n}\n\n$cipher_alg = MCRYPT_RIJNDAEL_128;\n$decrypted_string = mcrypt_decrypt($cipher_alg, $key, \n    $encrypted_string, MCRYPT_MODE_CBC, trim(hex2bin(trim($hexiv))));\n\n// Assuming $block_size is 16 for Rijndael-128\n$decrypted_string = pkcs7_unpad($decrypted_string, 16);\n\nif ($decrypted_string === false) {\n    die('Invalid padding');\n}