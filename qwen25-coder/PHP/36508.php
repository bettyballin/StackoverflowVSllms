$XMLData = rc4crypt::decrypt($key, urldecode($_POST["XMLData"]));\n$data = new XMLParser($FoxyData);   // Parse that XML.\n$data->Parse();\n\n// go through each of the nodes\nforeach ($data->document->transactions[0]->transaction as $tx) {\n    $id = $tx->id[0]->tagData;\n    $store_id = $tx->id[0]->tagData;\n\n    // Check if custom_fields and custom_field node exists before iterating\n    if (isset($tx->custom_fields[0]) && isset($tx->custom_fields[0]->custom_field)) {\n        foreach ($tx->custom_fields[0]->custom_field as $field) {\n            $affiliateID = $field->custom_field_value[0]->tagData;\n        }\n    } else {\n        // Handle the case where custom_fields or custom_field is not present\n        echo "Custom fields are missing for this transaction.";\n    }\n}