<?php\n// Tech Support Site - Generate token and redirect\n\nfunction generateSecureToken($userId, $expiryTime = '+30 minutes') {\n    // Create a hash based on user ID, current time, and expiry time with random string.\n    return hash_hmac('sha256', $userId . time() . strtotime($expiryTime) . bin2hex(random_bytes(16)), 'SECRET_KEY_HERE');\n}\n\n$tokenId = generateSecureToken($_SESSION['user_id']);\n\n// Redirect to Mantis with token. Adjust url as necessary.\nheader("Location: /mantisbt/login.php?token=" . urlencode($tokenId));\nexit;\n?>