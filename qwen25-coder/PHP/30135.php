<?php\n   class YourNamespace_CategoryFilter_Model_Observer {\n\n       public function filterCategoriesByStoreView($observer)\n       {\n           $categoryCollection = $observer->getEvent()->getCollection();\n           if ($categoryCollection) {\n               $store = Mage::app()->getStore();\n               $categoryIdWithProducts = Mage::getModel('catalog/product')\n                   ->getCollection()\n                   ->addStoreFilter($store)\n                   ->setPage(1, 1)\n                   ->getAllIds();\n\n               $categoriesToRemoveIds = array();\n               foreach ($categoryCollection as $category) {\n                   if (!$this->hasProductInCategoryByStoreView($categoryIdWithProducts, $category->getId())) {\n                       $categoriesToRemoveIds[] = $category->getId();\n                   }\n               }\n\n               foreach ($categoriesToRemoveIds as $categoryId) {\n                   unset($categoryCollection[$categoryId]);\n               }\n           }\n       }\n\n       protected function hasProductInCategoryByStoreView(array $productIdsInStore, $categoryId)\n       {\n           if (empty($productIdsInStore)) return false;\n\n           /** @var Mage_Catalog_Model_Resource_Product_Category_Collection $prodCatColl */\n           $prodCatColl = Mage::getModel('catalog/category')->getProductCollection()\n               ->setCategoryFilterByStoreId(Mage::app()->getStore()->getId());\n\n           foreach ($prodCatColl as $_product) {\n               foreach ($_product->getAvailableInCategories() as $catId => $categoryName) {\n                   if (in_array($catId, $categoryId) && in_array($_product->getId(), $productIdsInStore)) return true;\n               }\n           }\n           return false;\n       }\n   }\n\n   ?>