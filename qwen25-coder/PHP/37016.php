if (preg_match_all('/{dropcap}([^}]+){\/dropcap}/', $row->text, $matches, PREG_PATTERN_ORDER) > 0) {\n    foreach ($matches[1] as $index => $match) {\n        $_params = explode('|', $match);\n        \n        // Default values\n        $SimpleDropCapPlugin->text_dropcap = trim($_params[0] ?? '');\n        $SimpleDropCapPlugin->colour_border = isset($_params[1]) ? '#' . preg_replace('/[^A-Fa-f0-9]/', '', $_params[1]) : '#000';\n        $SimpleDropCapPlugin->colour_background = isset($_params[2]) ? '#' . preg_replace('/[^A-Fa-f0-9]/', '', $_params[2]) : '#FFF';\n        $SimpleDropCapPlugin->colour_text = isset($_params[3]) ? '#' . preg_replace('/[^A-Fa-f0-9]/', '', $_params[3]) : '#000';\n        $SimpleDropCapPlugin->font_size = isset($_params[4]) ? (int)$_params[4] : 24;\n        $SimpleDropCapPlugin->font_family = htmlspecialchars(isset($_params[5]) ? $_params[5] : 'Arial');\n\n        // Creating the HTML\n        $style = "border: 1px solid {$SimpleDropCapPlugin->colour_border}; "\n               . "background: {$SimpleDropCapPlugin->colour_background} none repeat scroll 0% 0%; "\n               . "margin-right: 6px; margin-top: 5px; float: left; "\n               . "color: {$SimpleDropCapPlugin->colour_text}; -moz-background-clip: initial;"\n               . "-moz-background-origin: initial; -moz-background-inline-policy: initial;"\n               . "font-size: {$SimpleDropCapPlugin->font_size}px; line-height: 60px; padding-top: 2px;";\n        if (!empty($SimpleDropCapPlugin->font_family)) {\n            $style .= " font-family: {$SimpleDropCapPlugin->font_family};";\n        }\n        $SimpleDropCapPlugin->html = "<span style=\"{$style}\">" . strtoupper($SimpleDropCapPlugin->text_dropcap) . "</span>";\n\n        // Replacing the match in the original text\n        $row->text = str_replace($matches[0][$index], $SimpleDropCapPlugin->html, $row->text);\n    }\n}