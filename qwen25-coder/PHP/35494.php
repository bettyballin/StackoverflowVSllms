<?php\n\n// Assuming you have a PDO instance $pdo connected to your database\n\nfunction updatePopularIllustrations() {\n    $sql = "\n        SELECT \n            i.id,\n            COUNT(v.id) AS vote_count,\n            TIMESTAMPDIFF(HOUR, i.date_created, NOW()) AS age_in_hours,\n            (\n                (COUNT(v.id) * 1.5) - \n                (TIMESTAMPDIFF(HOUR, i.date_created, NOW()) / 48)\n            ) AS score\n        FROM \n            illustration i\n        LEFT JOIN \n            votes v ON i.id = v.illustration_id\n        GROUP BY \n            i.id, i.date_created\n        ORDER BY \n            score DESC\n        LIMIT 20;\n    ";\n\n    $stmt = $pdo->query($sql);\n    $popularIllustrations = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    // Clear existing popular illustrations\n    $pdo->exec("TRUNCATE TABLE popular_illustrations");\n\n    // Insert new top 20 into the popular_illustrations table\n    foreach ($popularIllustrations as $illustration) {\n        $stmt = $pdo->prepare("INSERT INTO popular_illustrations (id, score, updated_at) VALUES (:id, :score, NOW())");\n        $stmt->execute($illustration);\n    }\n}\n\nupdatePopularIllustrations();