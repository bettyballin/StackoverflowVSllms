$db = Zend_Db_Table::getDefaultAdapter();\n\n// Create the first sub-select for energy produced\n$subSelect1 = $db->select()\n                 ->from('tbl_energy', array('max(energy_produced) AS energy_produced', 'mid(timestamp, 1, 10) AS timestamp1'))\n                 ->where('site_id = ?', 1366)\n                 ->where('mid(timestamp, 1, 10) >= DATE_SUB(curdate(), INTERVAL 1 DAY)')\n                 ->group('timestamp1');\n\n// Create the second sub-select for energy consumed\n$subSelect2 = $db->select()\n                 ->from('tbl_energy', array('max(energy_consumed) AS energy_consumed', 'mid(timestamp, 1, 10) AS timestamp2'))\n                 ->where('site_id = ?', 1366)\n                 ->where('mid(timestamp, 1, 10) >= DATE_SUB(curdate(), INTERVAL 1 DAY)')\n                 ->group('timestamp2');\n\n// Create the main select query that joins the two sub-selects\n$select = $db->select()\n             ->from(array('e1' => new Zend_Db_Expr('(' . $subSelect1 . ')')), \n                    array('energy_produced', 'timestamp1 AS timestamp'))\n             ->join(array('e2' => new Zend_Db_Expr('(' . $subSelect2 . ')')),\n                  'e1.timestamp1 = e2.timestamp2', \n                  'energy_consumed');\n\n// Execute the query\n$result = $db->fetchAll($select);\n\nprint_r($result);