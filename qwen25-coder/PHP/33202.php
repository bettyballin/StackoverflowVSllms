<?php\n\n// Base directory to prevent directory traversal\n$baseDir = __DIR__ . '/images'; // Assuming images are stored in a folder named 'images'\n\n// Sanitize input but also validate it against expected values or patterns\n$foo = filter_var($_POST["foo"], FILTER_SANITIZE_STRING);\n$bar = isset($_POST["bar"]) ? trim($_POST["bar"]) : "";\n\n// Prevent directory traversal by checking if the constructed path is within the base directory\n$targetDir = realpath($baseDir . '/' . $foo);\n\nif ($targetDir !== false && strpos($targetDir, $baseDir) === 0) {\n    // Directory is safe to scan\n    $files = scandir($targetDir);\n    \n    foreach ($files as $file) {\n        if (in_array($file, ['.', '..'])) continue; // Skip current and parent directory links\n        \n        if (is_file("$targetDir/$file")) { // Ensure it's a file not a subdirectory\n            echo "<img src='/images/" . htmlspecialchars($foo . '/' . $file, ENT_QUOTES, 'UTF-8') ."'><br>";\n        }\n    }\n} else {\n    echo "Invalid directory.";\n}\n\n?>