<?php\nsession_start();\n\n// Function to generate a secure random token\nfunction generateToken() {\n    return bin2hex(random_bytes(32));\n}\n\n// Generate and store the token in session\nif (!isset($_SESSION['download_token'])) {\n    $_SESSION['download_token'] = generateToken();\n}\n\n// Function to validate the download request\nfunction isValidDownloadRequest($token) {\n    $expectedToken = $_SESSION['download_token'];\n    return hash_equals($expectedToken, $token);\n}\n\n// Check if this is a valid download request with a specific file reference and token\nif (isset($_GET['file'], $_GET['token']) && isValidDownloadRequest($_GET['token'])) {\n    // Safe to process the file download\n    $fileReference = htmlspecialchars($_GET['file']);\n    // Your logic to handle safe downloading goes here\n    echo "Downloading: " . $fileReference;\n} else {\n    header("HTTP/1.0 403 Forbidden");\n    die('Access denied.');\n}\n?>\n\n<!-- Example link on your own website -->\n<a href="download.php?file=the_file_refrence&token=<?php echo $_SESSION['download_token']; ?>">Download</a>