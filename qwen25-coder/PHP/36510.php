function Email($name, $from, $to, $subject, $message, $bcc = null, $attachments = null)\n{\n    ini_set('SMTP', 'localhost');\n    ini_set('sendmail_from', $from);\n\n    $name = filter_var($name, FILTER_SANITIZE_STRING);\n    $from = filter_var($from, FILTER_SANITIZE_EMAIL);\n    $subject = mb_encode_mimeheader(filter_var($subject, FILTER_SANITIZE_STRING), "UTF-8", "B");\n\n    $boundary = '_Boundary_' . md5(microtime(true) . mt_rand(0, PHP_INT_MAX));\n\n    $headers = array\n    (\n        'MIME-Version: 1.0',\n        'Content-Type: multipart/mixed; boundary="Mixed' . $boundary . '"',\n        'Date: ' . date('r', time()),\n        'From: "' . mb_encode_mimeheader($name, "UTF-8", "B") . '" <' . $from . '>',\n        'Reply-To: "' . mb_encode_mimeheader($name, "UTF-8", "B") . '" <' . $from . '>',\n        'Return-Path: "' . mb_encode_mimeheader($name, "UTF-8", "B") . '" <' . $from . '>',\n        'X-Mailer: PHP/' . phpversion(),\n    );\n\n    if (!is_null($to) && is_array($to)) {\n        $to = implode(', ', array_map(function ($email) { return filter_var(trim($email), FILTER_SANITIZE_EMAIL); }, $to));\n    } else {\n        $to = filter_var(trim((string)$to), FILTER_SANITIZE_EMAIL);\n    }\n\n    if (!is_null($bcc) && is_array($bcc)) {\n        $headers[] = 'BCC: ' . implode(', ', array_map(function ($email) { return filter_var(trim($email), FILTER_SANITIZE_EMAIL); }, $bcc));\n    } elseif (!is_null($bcc)) {\n        $headers[] = 'BCC: ' . filter_var(trim((string)$bcc), FILTER_SANITIZE_EMAIL);\n    }\n\n    if (!empty($attachments)) {\n        foreach ($attachments as $index => $file) {\n            if (file_exists($file)) {\n                $attachmentContent = chunk_split(base64_encode(file_get_contents($file)));\n                $message[] = "--Mixed$boundary";\n                $message[] = "Content-Type: application/octet-stream; name=\"" . basename($file) . "\"";\n                $message[] = "Content-Transfer-Encoding: base64"; \n                $message[] = "Content-Disposition: attachment"; \n                $message[] = $attachmentContent;\n            } else {\n                unset($attachments[$index]);\n            }\n        }\n    }\n\n    $message = array_merge(\n        ['This is a multi-part message in MIME format.', ''],\n        ["--Mixed$boundary"],\n        ['Content-Type: multipart/alternative; boundary="Alt' . $boundary . '"', ''],\n        ["--Alt$boundary"],\n        ['Content-Type: text/plain; charset="UTF-8"', 'Content-Transfer-Encoding: quoted-printable', '', quoted_printable_encode(strip_tags($message, '<a>'))],\n        ["--Alt$boundary"],\n        ['Content-Type: text/html; charset="UTF-8"', 'Content-Transfer-Encoding: quoted-printable', '', quoted_printable_encode($message)],\n        ["--Alt$boundary--", ''],\n        $attachments ?: [],\n        ["--Mixed$boundary--"]\n    );\n\n    return mail($to, $subject, implode("\r\n", $message), implode("\r\n", $headers));\n}