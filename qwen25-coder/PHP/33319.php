session_start();\n\n// Generate and store CSRF token in session\nif (!isset($_SESSION['csrf_token'])) {\n    $_SESSION['csrf_token'] = bin2hex(random_bytes(32));\n}\n\n// When displaying the form, send the token as part of a header or meta tag\nheader("X-CSRF-Token: " . $_SESSION['csrf_token']);\n\n// On form submission, retrieve the token from request headers and compare it\nfunction getHeader($key) {\n    foreach ($_SERVER as $name => $value){\n        if (substr($name, 0, 5) == 'HTTP_'){\n            $name = str_replace(' ', '-', ucwords(strtolower(str_replace('_', ' ', substr($name, 5)))));\n            if ($name == $key) {\n                return $value;\n            }\n        }\n    }\n}\n\n$received_token = getHeader("X-CSRF-Token");\n\nif ($_SERVER['REQUEST_METHOD'] === 'POST') {\n    if (!$received_token || $received_token !== $_SESSION['csrf_token']) {\n        die("Invalid form submission");\n    } else {\n        // Process the form data\n    }\n}