<?php\nsession_start();\n\n// Sample users with hashed passwords\n$users = [\n    'user1' => password_hash('password1', PASSWORD_BCRYPT),\n    'user2' => password_hash('password2', PASSWORD_BCRYPT),\n];\n\nfunction authenticate($username, $password) {\n    global $users;\n    if (isset($users[$username]) && password_verify($password, $users[$username])) {\n        $_SESSION['authenticated'] = true;\n        return true;\n    }\n    return false;\n}\n\nif (!isset($_POST['logout'])) {\n    if (isset($_SESSION['authenticated']) && $_SESSION['authenticated']) {\n        echo "Welcome to your protected area, " . htmlspecialchars($_SESSION['user'], ENT_QUOTES, 'UTF-8') . "! <form method='post'><button name='logout'>Logout</button></form>";\n        // Your directory content goes here\n    } else if ($_SERVER['REQUEST_METHOD'] == 'POST' && isset($_POST['username']) && isset($_POST['password'])) {\n        if (authenticate($_POST['username'], $_POST['password'])) {\n            $_SESSION['user'] = $_POST['username'];\n            echo "Login successful!";\n            // Redirect to the same page or another\n            header("Location: " . $_SERVER['PHP_SELF']);\n            exit();\n        } else {\n            echo "Invalid username or password.";\n        }\n    } else {\n        ?>\n        <form method="post">\n            Username: <input type="text" name="username" required><br>\n            Password: <input type="password" name="password" required><br>\n            <button type="submit">Login</button>\n        </form>\n        <?php\n    }\n} else {\n    session_destroy();\n    echo "You have been logged out.";\n}\n?>