$fileName = "../js/ajaxupload/tees/" . $fileName;\n\nlist($width, $height) = getimagesize($fileName);\n\n$newwidth = 257;\n$newheight = 197;\n\n$thumb = imagecreatetruecolor($newwidth, $newheight);\nimagesavealpha($thumb, true); // Enable saving of alpha layer\n\n// Create a transparent background for the thumbnail\n$transparent = imagecolorallocatealpha($thumb, 0, 0, 0, 127);\nimagefill($thumb, 0, 0, $transparent);\n\n$source = imagecreatefrompng($fileName);\n\nimagealphablending($thumb, false); // Disable blending\n\n// Copy the source image to the thumbnail\nimagecopyresampled($thumb, $source, 0, 0, 0, 0, $newwidth, $newheight, $width, $height);\n\nimagepng($thumb, $newFilename);\nimagedestroy($thumb);\nimagedestroy($source); // Free up memory