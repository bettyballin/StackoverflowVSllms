<?php\n\n// Function to generate a temporary URL with token\nfunction generateTempUrl($filename, $validForMinutes = 5) {\n    $secretKey = 'your_secret_key'; // Change this to a secure key\n    $timeLimit = time() + ($validForMinutes * 60);\n    $hash = hash_hmac('sha256', "$filename|$timeLimit", $secretKey);\n\n    return "view.php?file=$filename&time=$timeLimit&token=$hash";\n}\n\n// Function to verify the temporary URL\nfunction isUrlValid($filename, $timeLimit, $providedToken) {\n    $secretKey = 'your_secret_key'; // Change this to a secure key\n    if ($timeLimit < time()) {\n        return false; // URL has expired\n    }\n    $expectedHash = hash_hmac('sha256', "$filename|$timeLimit", $secretKey);\n    return hash_equals($providedToken, $expectedHash); // Compare hashes\n}\n\n// Example usage:\nif (isset($_GET['file'], $_GET['time'], $_GET['token'])) {\n    if (isUrlValid($_GET['file'], $_GET['time'], $_GET['token'])) {\n        readfile('uploads/' . basename($_GET['file'])); // Serve the file\n        exit;\n    } else {\n        header("HTTP/1.0 403 Forbidden");\n        echo "Access denied or URL expired.";\n        exit;\n    }\n}\n\n?>