// define a constant for the maximum upload size\ndefine ('MAX_FILE_SIZE', 1024000);\n\nif (array_key_exists('upload', $_POST)) {\n    // define constant for upload folder\n    define('UPLOAD_DIR', 'C:/Wamp/www/Version-1.4/posters_uploaded/');\n\n    // replace any spaces in original filename with underscores. At the same time, assign to a simpler variable\n    $file = str_replace(' ', '_', $_FILES['image']['name']);\n\n    // check if file is within the permitted size\n    $sizeOK = ($_FILES['image']['size'] > 0 && $_FILES['image']['size'] <= MAX_FILE_SIZE);\n\n    // create an array of permitted MIME types\n    $permittedTypes = ['image/jpeg', 'image/pjpeg'];\n\n    // Use finfo to get mime type more reliably\n    $finfo = finfo_open(FILEINFO_MIME_TYPE);\n    $fileType = finfo_file($finfo, $_FILES['image']['tmp_name']);\n    finfo_close($finfo);\n\n    $typeOK = in_array($fileType, $permittedTypes);\n\n    if (!$sizeOK) {\n        echo "File size exceeds the maximum allowed (1MB).";\n    } elseif (!$typeOK) {\n        echo "Invalid file type. Only JPEG images are allowed.";\n    } else {\n        // proceed with moving and resizing image\n        switch ($_FILES['image']['error']) {\n            case UPLOAD_ERR_OK:\n                if (!move_uploaded_file($_FILES['image']['tmp_name'], UPLOAD_DIR . $file)) {\n                    echo 'An error occurred while uploading the file. Please try again.';\n                }\n                break;\n            case UPLOAD_ERR_NO_FILE:\n                echo 'No file sent.';\n                break;\n            default:\n                echo 'File upload failed with error code: ' . $_FILES['image']['error'];\n        }\n    }\n}