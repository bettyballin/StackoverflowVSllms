<?php\nsession_start();\n\n// Function to check if user has already voted\nfunction hasVoted() {\n    // Check cookie\n    if (isset($_COOKIE['has_voted'])) {\n        return true;\n    }\n    \n    // Check session (optional, for additional layer)\n    if (isset($_SESSION['has_voted'])) {\n        return true;\n    }\n\n    // Check IP address in database\n    $ip = $_SERVER['REMOTE_ADDR'];\n    $db = new PDO('mysql:host=localhost;dbname=poll_db', 'username', 'password');\n    $stmt = $db->prepare("SELECT * FROM votes WHERE ip_address = :ip");\n    $stmt->execute([':ip' => $ip]);\n    if ($stmt->rowCount() > 0) {\n        return true;\n    }\n\n    return false;\n}\n\n// Function to register a vote\nfunction recordVote($option) {\n    // Assume you have options like "option1", "option2"\n    // Here we just increment the count for demonstration purposes\n    $db = new PDO('mysql:host=localhost;dbname=poll_db', 'username', 'password');\n    $stmt = $db->prepare("UPDATE poll_results SET votes = votes + 1 WHERE option = :option");\n    $stmt->execute([':option' => $option]);\n\n    // Set cookie\n    setcookie('has_voted', 'true', time() + (86400 * 30), "/"); // 86400 = 1 day\n\n    // Set session variable (optional, for additional layer)\n    $_SESSION['has_voted'] = true;\n\n    // Record IP address\n    $ip = $_SERVER['REMOTE_ADDR'];\n    $stmt = $db->prepare("INSERT INTO votes (ip_address) VALUES (:ip)");\n    $stmt->execute([':ip' => $ip]);\n}\n\n// Example usage\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    if (!hasVoted()) {\n        recordVote($_POST['vote_option']);\n        echo "Your vote has been recorded!";\n    } else {\n        echo "You have already voted.";\n    }\n}\n?>\n\n<form method="post">\n    <input type="radio" id="option1" name="vote_option" value="option1">\n    <label for="option1">Option 1</label><br>\n    <input type="radio" id="option2" name="vote_option" value="option2">\n    <label for="option2">Option 2</label><br>\n    <input type="submit" value="Submit Vote">\n</form>