// serve_file.php\n\nsession_start();\n\nif (!isset($_SESSION['authenticated']) || $_SESSION['authenticated'] !== true) {\n    header('HTTP/1.0 403 Forbidden');\n    die("Access Denied.");\n}\n\n$filename = basename($_GET['file']);\n$fileDir = '/path/to/files/';\n\n$file = $fileDir . $filename;\n\nif (!file_exists($file)) {\n    header('HTTP/1.0 404 Not Found');\n    die("File not found.");\n}\n\nheader('Content-Description: File Transfer');\nheader('Content-Type: application/octet-stream');\nheader('Content-Disposition: attachment; filename="' . basename($file) . '"');\nheader('Expires: 0');\nheader('Cache-Control: must-revalidate');\nheader('Pragma: public');\nheader('Content-Length: ' . filesize($file));\nreadfile($file);\nexit;