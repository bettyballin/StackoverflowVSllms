// Controller_Auth.php\n\nclass Controller_Auth extends Controller {\n\n    public function action_register() {\n        // Handle registration logic here\n        if ($_POST) {\n            $username = $_POST['username'];\n            $password = password_hash($_POST['password'], PASSWORD_DEFAULT); // Always hash passwords\n\n            // Save user to database\n            $user = ORM::factory('User');\n            $user->username = $username;\n            $user->password = $password;\n            $user->save();\n\n            Session::instance()->set_flash('message', 'Registration successful!');\n            Request::current()->redirect('auth/login'); // Redirect to login page\n        }\n\n        $this->response->body(View::factory('register_form'));\n    }\n\n    public function action_login() {\n        if ($_POST) {\n            $username = $_POST['username'];\n            $password = $_POST['password'];\n\n            // Find user in database\n            $user = ORM::factory('User')->where('username', '=', $username)->find();\n            \n            if ($user->loaded() AND password_verify($password, $user->password)) {\n                // Password matched the stored hash\n                Session::instance()->set('user_id', $user->id);\n                Request::current()->redirect('/dashboard'); // Redirect to dashboard or similar\n            } else {\n                // Login failed\n                Session::instance()->set_flash('error', 'Invalid username or password.');\n            }\n        }\n\n        $this->response->body(View::factory('login_form'));\n    }\n\n    public function action_logout() {\n        Session::instance()->delete('user_id'); // Remove user ID from session\n        Request::current()->redirect('/auth/login');\n    }\n}\n\n// Example User model (Model_User.php)\nclass Model_User extends ORM {\n\n}