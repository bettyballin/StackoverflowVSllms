class FriendsController extends AppController {\n       public function add() {\n           if ($this->request->is('post')) {\n               // Filter out empty pairs\n               $filteredData = [];\n               foreach ($this->request->data['Friend'] as $pair) {\n                   if (!empty($pair['name']) || !empty($pair['email'])) {\n                       $filteredData[] = $pair;\n                   }\n               }\n               $this->Friend->create();\n               if (!empty($filteredData)) {\n                   if ($this->Friend->saveAll($filteredData)) {\n                       $this->Session->setFlash('Friends saved successfully.', 'default', ['class' => 'success']);\n                       return $this->redirect(['action' => 'index']);\n                   } else {\n                       $this->Friend->validationErrors = ['friend_pairs' => ['At least one name/email pair must be provided']];\n                   }\n               } else {\n                   $this->Friend->validationErrors = ['friend_pairs' => ['At least one name/email pair must be provided']];\n               }\n           }\n       }\n   }