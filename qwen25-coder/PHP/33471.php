$im = imagecreatefromgif("bg.gif");\n\n// Set up the container with true color and preservation of alpha channels\n$container = imagecreatetruecolor(400, 160);\nimagesavealpha($container, true); // Enable alphablending saving (important for PNG)\nimagealphablending($container, false); // Disable blending to ensure transparency is handled correctly\n\n// Create a transparent color in the container\n$trans_colour = imagecolorallocatealpha($container, 0, 0, 0, 127);\nimagefill($container, 0, 0, $trans_colour);\n\n// Copy the original image onto the new one with alpha blending off to preserve transparency\nimagecopy($container, $im, 0, 0, 0, 0, imagesx($im), imagesy($im));\n\n// Continue with your original text addition code here...