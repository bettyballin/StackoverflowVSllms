use Drupal\Core\Database\Database;\n\nfunction mymodule_import_and_join_csv($csv_file_path) {\n  // Connect to the default database.\n  $connection = Database::getConnection();\n\n  // Prepare an array to hold email addresses from CSV.\n  $emails = [];\n\n  if (($handle = fopen($csv_file_path, "r")) !== FALSE) {\n    while (($data = fgetcsv($handle, 1000, ",")) !== FALSE) {\n      $email = trim($data[0]); // Adjust the index based on your CSV's structure.\n      if (filter_var($email, FILTER_VALIDATE_EMAIL)) {\n        $emails[] = $email;\n      }\n    }\n    fclose($handle);\n  }\n\n  // Assuming 'users' table has a column 'mail' which holds email addresses.\n  $query = $connection->select('users', 'u');\n  $or_conditions = db_or();\n  foreach ($emails as $email) {\n    $or_conditions->condition('u.mail', $email, '=');\n  }\n  $query->condition($or_conditions);\n\n  // Select the unique emails from the database that match those in CSV.\n  $result = $query\n    ->fields('u')\n    ->groupBy('u.mail')\n    ->execute();\n\n  // Process your results here.\n  foreach ($result as $record) {\n    // Do something with each record, like storing it in an array or outputting it.\n    \Drupal::logger('mymodule')->notice("Found user email: @email", ['@email' => $record->mail]);\n  }\n}