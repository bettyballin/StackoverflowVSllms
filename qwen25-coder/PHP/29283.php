$new_array = array_intersect_key($arr2, $arr1);\n\nforeach ($new_array as $key => &$val) {\n    if (is_array($val) && is_array($arr1[$key])) {\n        // Merge arrays with values from $val taking precedence over $arr1[$key]\n        $new_array[$key] = array_merge($arr1[$key], $val);\n    }\n}\nunset($val); // Unset the reference to prevent side effects\n\n// Now, add non-array elements that are not modified\nforeach ($arr1 as $key => $value) {\n    if (!is_array($value)) {\n        $new_array[$key] = $value;\n    }\n}\n\n$final = array_merge(array_intersect_key($arr1, $arr2), $new_array);\n\n// Reorder to match the desired output order\nksort($final);