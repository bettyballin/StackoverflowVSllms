<?php\nheader('Content-Type: image/png');\n\n// Create the image resource\n$image = imagecreatetruecolor(400, 100);\n\n// Allocate colors\n$bgColor = imagecolorallocate($image, 255, 255, 255); // White background\n$textColor = imagecolorallocate($image, 0, 0, 0);       // Black text\n\n// Fill the background with white color\nimagefill($image, 0, 0, $bgColor);\n\n// Font to use\n$font = __DIR__ . '/arial.ttf'; // Path to your TTF font file\n\n// Text and font size\n$text = 'Underlined Text';\n$fontSize = 16;\n\n// Calculate text box dimensions (bounding box)\n$textBox = imagettfbbox($fontSize, 0, $font, $text);\n\n// Calculate the starting x position for the text and underline (centered)\n$imageWidth = imagesx($image);\n$textWidth = abs($textBox[4] - $textBox[0]);\n$xPosition = ($imageWidth / 2) - ($textWidth / 2);\n\n// Calculate y position for baseline\n$yBaseline = 50; // Height offset\n\n// Print text on image\nimagettftext($image, $fontSize, 0, $xPosition, $yBaseline, $textColor, $font, $text);\n\n// Draw underline (calculate y position for the line)\n$xLineStart = $xPosition;\n$xLineEnd = $xLineStart + $textWidth;\n$yLine = $yBaseline + 5; // Position of the underline relative to baseline\n\nimageline($image, $xLineStart, $yLine, $xLineEnd, $yLine, $textColor);\n\n// Output image\nimagepng($image);\nimagedestroy($image);\n?>