// Generate a unique session token\nfunction generateToken($userId) {\n    return hash_hmac('sha256', $userId . session_id(), 'your_secret_key');\n}\n\n// In your login script, set the user ID in session and generate a token\n$_SESSION['user_id'] = $userId;\n$_SESSION['token'] = generateToken($userId);\n\n// When serving ASX file, embed the token in the media URL\n$asxContent = <<<EOT\n<ASX VERSION="3.0">\n    <ENTRY>\n        <TITLE>Protected Stream</TITLE>\n        <REF HREF="stream.php?token={$_SESSION['token']}"/>\n    </ENTRY>\n</ASX>\nEOT;\n\n// Save or output the ASX content as needed\n\n// In your stream.php, verify the token before serving media\nif (isset($_GET['token']) && $_GET['token'] === generateToken($_SESSION['user_id'])) {\n    // Serve media file here\n    header('Content-Type: video/x-ms-asf');\n    readfile("path/to/your/media.asx");\n} else {\n    http_response_code(403);\n    echo "Access Denied";\n}