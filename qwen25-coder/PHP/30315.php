$data =  Zend_Json::decode(stripslashes($this->_request->getParam('object')));\n\n// Retrieve the variables from the GET vars\nlist($nelat, $nelng) = explode(',', $data['ne']);\nlist($swlat, $swlng) = explode(',',$data['sw']);\n\n// Clean the data\n$nelng  =   (float)$nelng;\n$swlng  =   (float)$swlng;\n$nelat  =   (float)$nelat;\n$swlat  =   (float)$swlat;\n\n// Handle longitude wrapping around the 180-degree meridian\nif ($swlng > $nelng) {\n    // If the south-west longitude is greater than the north-east longitude,\n    // it means we are spanning across the 180-degree line.\n    // Add a condition to select markers in two separate ranges.\n    $sql = "SELECT `a`.* FROM `locations` AS `a` WHERE ((a.`longitude` > $swlng OR a.`longitude` < $nelng) AND (a.`latitude` >= $swlat AND a.`latitude` <= $nelat))";\n} else {\n    // Normal case, no wrap-around\n    $sql = "SELECT `a`.* FROM `locations` AS `a` WHERE ((a.`longitude` > $swlng AND a.`longitude` < $nelng) AND (a.`latitude` >= $swlat AND a.`latitude` <= $nelat))";\n}