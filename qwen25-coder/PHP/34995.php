// Base directory for all user files, e.g., /var/www/html/uploads/\n$baseDir = '/var/www/html/uploads/';\n$username = $this->session->userdata('username'); // Ensure username is obtained from a secure session\n\nif (!empty($username)) {\n    // Create an absolute path to the user's directory\n    $userDirectory = realpath($baseDir . DIRECTORY_SEPARATOR . $username) . DIRECTORY_SEPARATOR;\n\n    if ($userDirectory !== FALSE && strpos(realpath($_POST['destination_dir']), $userDirectory) === 0) {\n        // Ensure the destination is within the user's directory\n        $destination = $userDirectory . basename($_POST['destination_dir']);\n\n        if (is_writable($destination)) {\n            move_uploaded_file($_FILES['upload']['tmp_name'], $destination);\n            echo "File uploaded successfully.";\n        } else {\n            echo "Error: Destination not writable.";\n        }\n    } else {\n        echo "Error: Invalid destination directory.";\n    }\n} else {\n    echo "Error: User not authenticated.";\n}