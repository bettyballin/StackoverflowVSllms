session_start();\nif ($_SERVER['REQUEST_METHOD'] === 'POST') {\n    // Assume $db is a PDO object and already connected to your DB\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n    $stmt = $db->prepare('SELECT id, password FROM users WHERE username = :username');\n    $stmt->execute([':username' => $username]);\n    $user = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    if ($user && password_verify($password, $user['password'])) {\n        // Login successful\n        $_SESSION['user_id'] = $user['id'];\n\n        if (isset($_POST['remember_me'])) {\n            // Generate a token and store it in cookie & database\n            $token = generateSecureToken();\n            setcookie('auth_token', $token, time() + 60 * 60 * 24 * 30, '/', '', true, true); // Secure, HttpOnly\n\n            // Store the token in the database\n            $db->prepare('UPDATE users SET auth_token = :token WHERE id = :id')->execute([':token' => hash('sha256', $token), ':id' => $user['id']]);\n        }\n\n        header('Location: dashboard.php');\n        exit;\n    }\n}