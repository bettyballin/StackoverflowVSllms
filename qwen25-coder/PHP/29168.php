<?php\nsession_start();\nif (isset($_GET["cmd"]))\n    $cmd = $_GET["cmd"];\nelse\n    die("You should have a 'cmd' parameter in your URL");\n$pk = $_GET["pk"];\n$con = mysqli_connect("localhost", "root", "geheim"); // Use mysqli for better security and functionality\nif (!$con) {\n    die('Connection failed because of: ' . mysqli_error($con));\n}\nmysqli_select_db($con, "ebay");\n\nif ($cmd == "GetAuctionData") {\n    $sql = "SELECT * FROM Auctions WHERE ARTICLE_NO='$pk'";\n    $sql2 = "SELECT ARTICLE_DESC FROM Auctions WHERE ARTICLE_NO='$pk'";\n    $htmlset = mysqli_query($con, $sql2);\n    $row2 = mysqli_fetch_array($htmlset);\n\n    // Escape the description to avoid JavaScript syntax errors and XSS\n    $escapedDesc = json_encode($row2["ARTICLE_DESC"]);\n\n    echo "<script> \n        function makewindows(){\n            child1 = window.open('about:blank');\n            child1.document.write(" . $escapedDesc . ");\n            child1.document.close(); \n        }\n    </script>";\n\n    $result = mysqli_query($con, $sql);\n    while ($row = mysqli_fetch_array($result)) {\n        echo "<div id='leftlayer'>\n                    <strong>Article Number</strong>: " . htmlspecialchars($row['ARTICLE_NO']) . "\n                    <p><strong>Article Name</strong></p>: " . htmlspecialchars($row['ARTICLE_NAME']) . "\n                    <p><strong>Subtitle</strong></p>: " . htmlspecialchars($row['SUBTITLE']) . "\n                    <p><strong>Username</strong></p>: " . htmlspecialchars($row['USERNAME']) . "\n                    <p><strong>Total Selling</strong></p>: " . htmlspecialchars($row['QUANT_TOTAL']) . "\n                    <p><strong>Total Sold</strong></p>: " . htmlspecialchars($row['QUANT_SOLD']) . "\n                    <p><strong>Category</strong></p>: " . htmlspecialchars($row['CATEGORY']) . "\n                    <p><strong>Highest Bidder</strong></p>: " . htmlspecialchars($row['BEST_BIDDER_ID']) . "\n              </div>\n              <div class='leftlayer2'>\n                  <strong>Current Bid</strong>: " . htmlspecialchars($row['CURRENT_BID']) . "\n                  <p><strong>Start Price</strong></p>: " . htmlspecialchars($row['START_PRICE']) . "\n                  <p><strong>Buyitnow Price</strong></p>: " . htmlspecialchars($row['BUYITNOW_PRICE']) . "\n                  <p><strong>Bid Count</strong></p>: " . htmlspecialchars($row['BID_COUNT']) . "\n                  <p><strong>Start Date</strong></p>: " . htmlspecialchars($row['ACCESSSTARTS']) . "\n                  <p><strong>End Date</strong></p>: " . htmlspecialchars($row['ACCESSENDS']) . "\n                  <p><strong>Original End</strong></p>: " . htmlspecialchars($row['ACCESSORIGIN_END']) . "\n                  <p><strong>Auction Type</strong></p>: " . htmlspecialchars($row['AUCTION_TYPE']) . "\n              </div>\n              <div class='leftlayer2'>\n                  <strong>Private Auction</strong>: " . htmlspecialchars($row['PRIVATE_AUCTION']) . "\n                  <p><strong>Paypal Accepted</strong></p>: " . htmlspecialchars($row['PAYPAL_ACCEPT']) . "\n                  <p><strong>Auction Watched</strong></p>: " . htmlspecialchars($row['WATCH']) . "\n                  <p><strong>Finished</strong></p>: " . htmlspecialchars($row['FINISHED']) . "\n                  <p><strong>Country</strong></p>: " . htmlspecialchars($row['COUNTRY']) . "\n                  <p><strong>PIC URL:</strong></p>: " . htmlspecialchars($row['PIC_URL']) . "\n                  <p><a href='#' onclick='makewindows(); return false;'>Click for full description </a></p>\n              </div>";\n\n        $lastImg = htmlspecialchars($row['PIC_URL']);\n        echo "<div id='rightlayer'>Picture Picture\n                    <img src='" . $lastImg . "'>\n              </div>";\n    }\n}\nmysqli_close($con);\n?>