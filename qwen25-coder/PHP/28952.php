<?php\n// Disable output buffering\nob_end_clean();\n\n// Ensure no output has been sent yet\nif (headers_sent($filename, $linenum)) {\n    die("Headers already sent in {$filename} on line {$linenum}");\n}\n\n$identifier = filter_input(INPUT_GET, 'buyer_id', FILTER_SANITIZE_STRING); // Validate and sanitize input\n\n$path = WAREHOUSE_PATH . '/products/' . $identifier . '.zip';\n$mm_type = "application/octet-stream";\n\nif (!is_readable($path)) {\n    die("File not found or is not readable.");\n}\n\nheader("Pragma: public");\nheader("Expires: 0");\nheader("Cache-Control: must-revalidate, post-check=0, pre-check=0");\nheader("Cache-Control: public");\nheader("Content-Description: File Transfer");\nheader("Content-Type: " . $mm_type);\nheader('Content-Disposition: attachment; filename="' . basename($path) . '"');\nheader("Content-Length: " . filesize($path));\n\n$fp = fopen($path, 'rb');\nif ($fp === false) {\n    die("Could not open the file.");\n}\n\nwhile (!feof($fp)) {\n    echo fread($fp, 1024 * 8);\n    flush();\n}\nfclose($fp);\nexit;\n?>