<?php\nsession_start();\n\n// Check if a session variable exists (indicates that the user is logged in)\nif (!isset($_SESSION['loggedin']) || $_SESSION['loggedin'] !== true) {\n    header("Location: login.php"); // Redirect to login page or display an error message\n    exit;\n}\n\n// Assuming file names are safe and sanitized elsewhere in your application\n$file = basename($_GET['file']);\n\nif (file_exists($file)) {\n    $headers = get_headers($file, 1);\n    if ($headers && strpos($headers[0], '200') || is_array($headers) && strpos($headers[0][0], '200')) {\n        header('Content-Type: text/html');\n        readfile($file);\n    } else {\n        http_response_code(404);\n        echo "File not found.";\n    }\n} else {\n    http_response_code(404);\n    echo "File does not exist.";\n}\n?>