// Install via Composer\n// composer require league/oauth2-google\n\nuse League\OAuth2\Client\Provider\Google;\n\n$provider = new Google([\n    'clientId'     => '{google-app-id}',\n    'clientSecret' => '{google-app-secret}',\n    'redirectUri'  => 'https://example.com/callback-url',\n]);\n\nif (!isset($_GET['code'])) {\n    $authUrl = $provider->getAuthorizationUrl();\n    $_SESSION['oauth2state'] = $provider->getState();\n    header('Location: ' . $authUrl);\n    exit;\n} elseif (empty($_GET['state']) || ($_GET['state'] !== $_SESSION['oauth2state'])) {\n    unset($_SESSION['oauth2state']);\n    exit('Invalid state');\n}\n\ntry {\n    $accessToken = $provider->getAccessToken('authorization_code', [\n        'code' => $_GET['code']\n    ]);\n} catch (\League\OAuth2\Client\Provider\Exception\IdentityProviderException $e) {\n    exit($e->getMessage());\n}\n\n$ownerDetails = $provider->getResourceOwner($accessToken);