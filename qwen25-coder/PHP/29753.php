<?php\nsession_start();\n\n// Securely authenticate users before allowing access\nif (!isset($_SESSION['user']) || $_SESSION['user'] !== 'admin') {\n    header('Location: login.php');\n    exit;\n}\n\n$domain = $_GET['domain'];\n$file_path = "./domains/{$domain}/" . basename($_GET['file']);\n\nif ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_POST['content'])) {\n    if (file_put_contents($file_path, $_POST['content']) !== false) {\n        echo "File updated successfully.";\n    } else {\n        echo "Failed to update file.";\n    }\n}\n\n$content = file_get_contents($file_path);\n?>\n\n<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <title>Edit <?php echo htmlspecialchars($domain . '/' . basename($_GET['file'])); ?></title>\n</head>\n<body>\n<h1>Edit File: <?php echo htmlspecialchars(basename($_GET['file'])); ?></h1>\n<form action="" method="post">\n    <textarea name="content" style="width: 100%; height: 50vh;"><?php echo htmlspecialchars($content); ?></textarea><br/>\n    <button type="submit">Save</button>\n</form>\n<a href="domains.php">Back to domain list</a>\n</body>\n</html>