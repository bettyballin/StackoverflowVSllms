<?php\nif ($_SERVER["REQUEST_METHOD"] == "POST") {\n    $fields_to_process = [];\n\n    // Check each field and its visibility checkbox\n    foreach ($_POST as $key => $value) {\n        if (strpos($key, '_visible') === false && isset($_POST[$key . '_visible']) && $_POST[$key . '_visible'] == 'on') {\n            array_push($fields_to_process, $key);\n        }\n    }\n\n    // Process visible fields\n    foreach ($fields_to_process as $field_name) {\n        echo "Processing {$field_name}: {$_POST[$field_name]}\n";\n    }\n}\n?>