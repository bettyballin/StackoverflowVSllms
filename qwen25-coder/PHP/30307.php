<?php\nheader("Content-Type: text/html; charset=utf-8");\n\nif (!isset($_GET["cmd"])) {\n    die("You should have a 'cmd' parameter in your URL");\n}\n\n$cmd = $_GET["cmd"];\n$pk = $_GET["pk"];\n\n// Use mysqli or PDO for database interactions\n$con = new mysqli("localhost", "someuser", "notreal", "somedb");\n\nif ($con->connect_error) {\n    die('Connection failed because of ' . $con->connect_error);\n}\n\n$con->set_charset("utf8");\n\nif ($cmd == "GetAuctionData") {\n    $stmt = $con->prepare("SELECT * FROM AUCTIONS WHERE ARTICLE_NO = ?");\n    $stmt->bind_param("s", $pk);\n    $stmt->execute();\n    $result = $stmt->get_result();\n\n    while ($row = $result->fetch_assoc()) {\n        $lastImg = $row['PIC_URL'];\n        savePicture($lastImg, $pk);\n\n        echo "<div id='rightlayer'>";\n        echo "<img src='./{$pk}.jpg' width='outputWidth' height='outputHeight'>"; // Define outputWidth and outputHeight\n        echo "</div>";\n    }\n}\n\n$con->close();\n\nfunction savePicture($imageUrl, $pk) {\n    $ch = curl_init();\n    curl_setopt($ch, CURLOPT_URL, $imageUrl); // Use the function parameter\n    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);\n    curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 0);\n    \n    $fileContents = curl_exec($ch);\n    if ($fileContents === false) {\n        error_log("Curl Error: " . curl_error($ch));\n        return;\n    }\n    curl_close($ch);\n\n    $newImg = imagecreatefromstring($fileContents);\n    if ($newImg !== false) {\n        imagejpeg($newImg, "./{$pk}.jpg", 100);\n        imagedestroy($newImg); // Free up memory\n    } else {\n        error_log("Failed to create an image from string.");\n    }\n}\n?>