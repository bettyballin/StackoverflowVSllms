<?php\n$table_Header = $_GET['tableHeader'];\n$sort_Dir = isset($_GET['sortDir']) ? ($_GET['sortDir'] === 'DESC' ? 'DESC' : 'ASC') : 'ASC';\n\nif ($table_Header == 'From') {\n    $sort_By = 'player_name';\n} else if ($table_Header == 'To') {\n    $sort_By = 'player_name';\n} else if ($table_Header == 'Gr') {\n    $sort_By = 'grp_abr';\n} else {\n    die('Invalid sort header');\n}\n\n// Use prepared statements to prevent SQL injection\n$mysqli = new mysqli("localhost", "username", "password", "database");\nif ($mysqli->connect_error) {\n    die("Connection failed: " . $mysqli->connect_error);\n}\n\n$stmt = $mysqli->prepare("SELECT * FROM messages INNER JOIN Player ON player_id = from_user ORDER BY ? ?");\n$stmt->bind_param('ss', $sort_By, $sort_Dir);\n\n$stmt->execute();\n$result = $stmt->get_result();\n\necho "<thead>\n   <tr>\n   <th style='color:royalblue;'>•</th>\n   <th align='center'>Time</th>\n   <th align='left' onClick=\"sort('From', '" . htmlspecialchars($sort_Dir) . "');\">De:</th>\n   <th align='left'>To:</th>\n   <th align='left'>Gr</th>\n   </tr>\n   </thead> ";\n\nwhile ($row = $result->fetch_assoc()) {\n    echo "<tbody>\n  <tr class='highlight'>\n  <td width='30' align='center' style='color:royalblue'>"."•"."</td>\n  <td width='70' align='left'>".$htmlspecialchars($row["Time_Date"])."</td>\n  <td width='600' align='left'>".$htmlspecialchars($row["player_name"])."</td>\n  <td width='600' align='left'></td>\n  <td width='100' align='left'></td>\n  </tr>";\n    echo "<tr class='highlight'>\n  <td></td>\n  <td colspan='4'>".$htmlspecialchars($row["msg_desc"])."</td></tr>\n </tbody>";\n}\n\n$stmt->close();\n$mysqli->close();\n?>