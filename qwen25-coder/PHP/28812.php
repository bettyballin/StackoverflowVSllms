$maxRuntime = 600; // Maximum runtime in seconds (10 minutes)\n$startTime = time();\n\nwhile ((time() - $startTime) < $maxRuntime) {\n    // Fetch and process feeds\n    $feeds = fetchFeeds();\n    if (!$feeds) break;\n\n    foreach ($feeds as $feed) {\n        makeCurlRequest($feed);\n        updateLastScanTime($feed['id']);\n\n        if ((time() - $startTime) >= $maxRuntime) break;\n    }\n}\n\nfunction fetchFeeds() {\n    return \DB::select("SELECT * FROM table WHERE latest_scan < NOW() - INTERVAL 30 MINUTE ORDER BY latest_scan ASC LIMIT 40");\n}\n\nfunction makeCurlRequest($feed) {\n    // Your cURL request code here\n}\n\nfunction updateLastScanTime($feedId) {\n    \DB::update("UPDATE table SET latest_scan = NOW() WHERE id = ?", [$feedId]);\n}