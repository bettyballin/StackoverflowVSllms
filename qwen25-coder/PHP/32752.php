function buildTree(array &$elements, $parentId = null) {\n    $branch = [];\n\n    foreach ($elements as $elementId => $ancestors) {\n        if (end($ancestors) == $parentId) { // Check if the last ancestor is the current parent\n            $children = buildTree($elements, $elementId);\n            if ($children) {\n                $elements[$elementId][] = ['children' => $children];\n            }\n            $branch[] = $elements[$elementId];\n        }\n    }\n\n    return $branch;\n}\n\n// Convert data to a format suitable for building the tree\n$formattedData = [];\nforeach ($data as $id => $ancestors) {\n    $formattedData[$id] = ['id' => $id, 'ancestors' => array_map('intval', $ancestors)];\n}\n\n$tree = buildTree($formattedData);