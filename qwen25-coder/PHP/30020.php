// application/controllers/Cart.php\n\n   class Cart extends CI_Controller {\n\n       public function __construct() {\n           parent::__construct();\n           $this->load->model('cart_model');\n           $this->load->library('session');\n       }\n\n       public function add_to_cart($product_id) {\n           if (isset($_SESSION['user_id'])) { // If user is logged in\n               // Use database to store cart\n               $user_id = $_SESSION['user_id'];\n               $quantity = 1; // For example, adding one quantity of product\n\n               if ($this->input->post('quantity')) {\n                   $quantity = (int)$this->input->post('quantity');\n               }\n\n               $this->cart_model->add_or_update_cart_item($user_id, $product_id, $quantity);\n           } else { // If user is not logged in\n               // Use session to store cart\n               if (!isset($_SESSION['cart'])) {\n                   $_SESSION['cart'] = [];\n               }\n\n               if (array_key_exists($product_id, $_SESSION['cart'])) {\n                   $_SESSION['cart'][$product_id] += $this->input->post('quantity', true);\n               } else {\n                   $_SESSION['cart'][$product_id] = $this->input->post('quantity', true);\n               }\n           }\n\n           // Redirect to cart page or product page\n           redirect('cart');\n       }\n\n       public function view_cart() {\n           if (isset($_SESSION['user_id'])) {\n               $data['cart_items'] = $this->cart_model->get_cart_by_user($_SESSION['user_id']);\n           } else {\n               $data['cart_items'] = $_SESSION['cart'] ?? [];\n           }\n           \n           // Load the view with cart data\n           $this->load->view('cart_view', $data);\n       }\n   }