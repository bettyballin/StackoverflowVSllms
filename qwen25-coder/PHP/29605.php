<?php\n   require_once __DIR__ . '/vendor/autoload.php';\n\n   use PhpAmqpLib\Connection\AMQPStreamConnection;\n\n   function process_message($msg) {\n       echo " [x] Received ", $msg->body, "\n";\n       sleep(substr_count($msg->body, '.')); // Simulate task processing\n       echo " [x] Done\n";\n       $msg->delivery_info['channel']->basic_ack($msg->delivery_tag);\n   }\n\n   $connection = new AMQPStreamConnection('localhost', 5672, 'guest', 'guest');\n   $channel = $connection->channel();\n\n   $channel->confirm_select();\n   $channel->queue_declare('task_queue', false, true, false, false);\n\n   $channel->basic_qos(null, 1, null);\n   echo " [*] Waiting for messages. To exit press CTRL+C\n";\n\n   $callback = 'process_message';\n   $channel->basic_consume('task_queue', '', false, false, false, false, $callback);\n\n   while(count($channel->callbacks)) {\n       $channel->wait();\n   }\n\n   $channel->close();\n   $connection->close();