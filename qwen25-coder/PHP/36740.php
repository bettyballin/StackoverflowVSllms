$this->db->select('books.*, collections.collectionname, GROUP_CONCAT(tags.tagname SEPARATOR ", ") AS booktags');\n$this->db->from('books');\n$this->db->join('collections', 'collections.collectid = books.collectionid');\n$this->db->join('bookstags', 'books.bookid = bookstags.bookid');\n$this->db->join('tags', 'bookstags.tagid = tags.tagid');\n$this->db->group_by('books.bookid'); // Grouping by bookid to ensure each book is listed once\n$data['query'] = $this->db->get();