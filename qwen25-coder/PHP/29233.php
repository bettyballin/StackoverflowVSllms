<?php session_start();\n\n// Full URL to external site where file resides\n$filename = $_SESSION['$serverURL'] . 'audio/' . $_SESSION['fileName'] . '.mp3';\n// Chosen filename of the file to be downloaded\n$properFilename = $_GET['properFilename'] . '.mp3';\n\n// required for IE, otherwise Content-disposition is ignored\nif (ini_get('zlib.output_compression'))\n    ini_set('zlib.output_compression', 'Off');\n\n$file_extension = strtolower(substr(strrchr($properFilename, "."), 1));\n\nswitch ($file_extension) {\n    case "pdf":\n        $ctype = "application/pdf";\n        break;\n    // Add other cases as necessary\n    default:\n        $ctype = "application/force-download";\n}\n\n// Initialize a cURL session to fetch the remote file\n$ch = curl_init($filename);\ncurl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\n$out = curl_exec($ch);\n\nif ($out === false) {\n    echo "ERROR: File not found or could not be downloaded.";\n    exit;\n}\n\n$info = curl_getinfo($ch, CURLINFO_CONTENT_LENGTH_DOWNLOAD);\n\ncurl_close($ch);\n\nheader("Pragma: public");\nheader("Expires: 0");\nheader("Cache-Control: must-revalidate, post-check=0, pre-check=0");\nheader("Cache-Control: private", false);\nheader("Content-Type: $ctype");\n// change, added quotes to allow spaces in filenames\nheader("Content-Disposition: attachment; filename=\"" . basename($properFilename) . "\";");\nheader("Content-Transfer-Encoding: binary");\nif ($info > 0) {\n    header("Content-Length: " . $info);\n}\n\necho $out;\nexit();\n\n?>