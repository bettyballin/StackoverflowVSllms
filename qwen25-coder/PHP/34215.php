<?php\nif ($_SERVER['HTTP_X_REQUESTED_WITH'] !== 'XMLHttpRequest') {\n    // Not an AJAX request, send 403 Forbidden response\n    http_response_code(403);\n    echo "Access denied.";\n    exit();\n}\n\n// Optional: validate the referer (make sure to handle your application's URLs correctly)\nif (!isset($_SERVER['HTTP_REFERER']) || strpos($_SERVER['HTTP_REFERER'], 'your-app-url.com') === false) {\n    http_response_code(403);\n    echo "Referer check failed.";\n    exit();\n}\n\n// CSRF Token Check: Ensure the token is passed and matches\nsession_start();\nif (!isset($_SESSION['csrf_token'])) {\n    $_SESSION['csrf_token'] = bin2hex(random_bytes(16)); // Regenerate or set a new token if not present\n}\nif (!isset($_POST['csrf_token']) || $_POST['csrf_token'] !== $_SESSION['csrf_token']) {\n    http_response_code(403);\n    echo "Invalid CSRF Token.";\n    exit();\n}\n\n// If all checks pass, proceed with your AJAX processing logic here\n?>