<?php\nrequire_once 'vendor/autoload.php'; // Make sure to have the Facebook SDK installed via Composer\n\n$fb = new \Facebook\Facebook([\n  'app_id' => '{YOUR_APP_ID}',\n  'app_secret' => '{YOUR_APP_SECRET}',\n  'default_graph_version' => 'v7.0',\n]);\n\n$helper = $fb->getRedirectLoginHelper();\n\ntry {\n  $accessToken = $helper->getAccessToken();\n} catch(\Facebook\Exceptions\FacebookResponseException $e) {\n  // When Graph returns an error\n  echo 'Graph returned an error: ' . $e->getMessage();\n  exit;\n} catch(\Facebook\Exceptions\FacebookSDKException $e) {\n  // When validation fails or other local issues\n  echo 'Facebook SDK returned an error: ' . $e->getMessage();\n  exit;\n}\n\nif (! isset($accessToken)) {\n  if ($helper->getError()) {\n    header('HTTP/1.0 403 Forbidden');\n    echo "Error: " . $helper->getError() . "\n";\n    echo "Error Code: " . $helper->getErrorCode() . "\n";\n    echo "Error Reason: " . $helper->getErrorReason() . "\n";\n    echo "Error Description: " . $helper->getErrorDescription() . "\n";\n  } else {\n    header('HTTP/1.0 403 Forbidden');\n    echo 'No OAuth token!';\n  }\n  exit;\n}\n\n// Logged in\necho '<h3>Access Token</h3>';\nvar_dump($accessToken->getValue());\n\n// The OAuth 2.0 client handler helps us manage access tokens\n$oAuth2Client = $fb->getOAuth2Client();\n\n// Get the access token metadata from /debug_token endpoint\n$tokenMetadata = $oAuth2Client->debugToken($accessToken);\n\n// Validation (these will throw FacebookSDKException's when they fail)\n$tokenMetadata->validateAppId('{YOUR_APP_ID}');\n$tokenMetadata->validateExpiration();\n\nif (!$accessToken->isLongLived()) {\n  // Exchanges a short-lived access token for a long-lived one\n  try {\n    $accessToken = $oAuth2Client->getLongLivedAccessToken($accessToken);\n  } catch (\Facebook\Exceptions\FacebookSDKException $e) {\n    echo "<p>Error getting long-lived access token: " . $helper->getMessage() . "</p>\n\n";\n    exit;\n  }\n\n  echo '<h3>Extended Access Token</h3>';\n  var_dump($accessToken->getValue());\n}\n\n// Now you can redirect to a another page and load the data\ntry {\n  // Returns a `Facebook\FacebookResponse` object\n  $response = $fb->get('/me?fields=id,name,email', $accessToken);\n} catch(\Facebook\Exceptions\FacebookResponseException $e) {\n  echo 'Graph returned an error: ' . $e->getMessage();\n  exit;\n} catch(\Facebook\Exceptions\FacebookSDKException $e) {\n  echo 'Facebook SDK returned an error: ' . $e->getMessage();\n  exit;\n}\n\n$user = $response->getGraphUser();\n\necho "Name: " . htmlspecialchars($user['name']) . "<br>";\necho "Email: " . htmlspecialchars($user['email']);\n?>