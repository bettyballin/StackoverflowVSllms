<?php\n$folder = 'images/';\n$orig_w = 500;\n\nif( isset($_POST['submit']) ) {\n    $imageFile = $_FILES['image']['tmp_name'];\n    // Corrected line: use the original filename to get the extension\n    $filenameext = pathinfo($_FILES['image']['name'], PATHINFO_EXTENSION);\n\n    $today = getdate();\n    $uniqueStr = $today['year'];  // Ensure proper array access with quotes\n    $uniqueStr .= $today['mon'];\n    $uniqueStr .= $today['wday'];\n    $uniqueStr .= $today['mday'];\n    $uniqueStr .= $today['hours'];\n    $uniqueStr .= $today['minutes'];\n    $uniqueStr .= $today['seconds'];\n\n    // Concatenate the unique string with the extension\n    $filename = $uniqueStr . "." . $filenameext;\n\n    list($width, $height) = getimagesize($imageFile);\n\n    $src = imagecreatefromjpeg($imageFile);\n    $orig_h = ($height/$width)* $orig_w;\n\n    $tmp = imagecreatetruecolor($orig_w, $orig_h);\n    imagecopyresampled($tmp, $src, 0, 0, 0, 0, $orig_w, $orig_h, $width, $height);\n    imagejpeg($tmp, $folder.$filename,100);\n\n    imagedestroy($tmp);\n    imagedestroy($src);\n\n    // Encode filename for URL\n    $filename = urlencode($filename);\n    header("Location: crop.php?filename=$filename&height=$orig_h");\n}\n?>