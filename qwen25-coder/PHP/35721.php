$query = mysql_query("\n    SELECT CONCAT(fname, ', ', sname) AS name, email.address AS email\n    FROM contacts\n    LEFT JOIN emails ON contacts.contactID = emails.contactID\n");\nwhile ($row = mysql_fetch_array($query)) {\n    $emailLink = isset($row['email']) && !is_null($row['email'])\n        ? "<a href=\"mailto:" . htmlspecialchars($row['email']) . "\">" . htmlspecialchars($row['name']) . "</a>"\n        : htmlspecialchars($row['name']);\n    echo "<li>$emailLink</li>";\n}