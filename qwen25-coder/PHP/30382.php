<?php\nsession_start();\n\n// Generate and store a unique token in the session if not already set\nif (!isset($_SESSION['form_token'])) {\n    $_SESSION['form_token'] = bin2hex(random_bytes(32));\n}\n\n// Function to check and validate the submitted form token\nfunction is_form_submitted($token) {\n    if (isset($_SESSION['form_token']) && hash_equals($_SESSION['form_token'], $token)) {\n        // Remove the token to prevent resubmission\n        unset($_SESSION['form_token']);\n        return true;\n    }\n    return false;\n}\n\nif ($_SERVER['REQUEST_METHOD'] === 'POST') {\n    if (is_form_submitted($_POST['form_token'])) {\n        // Process the form data here\n        echo "Form processed successfully!";\n    } else {\n        echo "Invalid or duplicate submission detected.";\n    }\n}\n?>\n\n<form method="post" action="">\n    <input type="hidden" name="form_token" value="<?php echo htmlspecialchars($_SESSION['form_token']); ?>">\n    <!-- Form fields here -->\n    <input type="submit" value="Submit">\n</form>