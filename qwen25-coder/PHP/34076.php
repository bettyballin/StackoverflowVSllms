function GenerateKey($length = 16) {\n    if ($length < 2 || $length > 1000) {\n        throw new InvalidArgumentException("Length must be between 2 and 1000");\n    }\n    \n    // Generate random bytes and then encode them to a base64 string\n    $bytesLength = ceil($length * 3 / 4); // Base64 encoding output is approximately 3/4 the input length\n    $key = base64_encode(random_bytes($bytesLength));\n    \n    // Ensure the key only includes printable ASCII characters and trim to desired length\n    $key = substr(preg_replace('/[^\x21-\x7E]/', '', $key), 0, $length);\n    \n    return $key;\n}