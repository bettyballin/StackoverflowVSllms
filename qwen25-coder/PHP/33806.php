<?php\nfunction validateEmail($email) {\n    $domain = substr(strrchr($email, "@"), 1);\n    \n    // Get MX records for the domain\n    if(getmxrr($domain, $mxRecords)) {\n        $server = $mxRecords[0];\n    } elseif(function_exists('checkdnsrr')) { \n        $records = dns_get_record($domain, DNS_ANY);\n        foreach ($records as $record) {\n            if($record['type'] == 'MX') {\n                $server = $record['target'];\n                break;\n            }\n        }\n    }\n\n    if(empty($server)) {\n        return false; // No server found\n    }\n\n    $port = 25;\n    $connection = @fsockopen ($server, $port, $errno, $errstr, 30);\n\n    if(!$connection) {\n        return false; // Could not connect to the mail server\n    }\n    \n    stream_set_timeout($connection, 10);\n    \n    if(preg_match("/^220/", $out = fgets($connection))) { \n        fputs ($connection , "HELO ".str_replace('www.','',@$domain)."\r\n"); \n        $out = fgets ($connection); \n\n        @fputs($connection,"MAIL FROM: <>"."\r\n");\n        $fromReply = fgets($connection);\n\n        @fputs($connection,"RCPT TO: <$email>"."\r\n"); \n        $toReply = fgets ($connection, 1024);\n\n        if(preg_match("/^250/", $fromReply) && preg_match("/^250/", $toReply)) {\n            return true; // The email appears to exist\n        }\n    }\n\n    fclose($connection);\n    return false;\n}\n\n$email = "test@example.com";\n$result = validateEmail($email);\nif ($result) {\n    echo "The email address might be valid.";\n} else {\n    echo "The email address is probably invalid or does not exist.";\n}\n?>