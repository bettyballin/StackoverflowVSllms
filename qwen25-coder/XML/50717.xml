<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xmlns:security="http://www.springframework.org/schema/security"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd\n                           http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security.xsd">\n\n    <bean id="securityContextSource" class="org.springframework.security.ldap.DefaultSpringSecurityContextSource">\n        <!-- Use placeholder for externalization -->\n        <constructor-arg value="${ldap.url}"/>\n    </bean>\n\n    <bean id="ldapAuthenticationProvider"\n          class="org.springframework.security.ldap.authentication.LdapAuthenticationProvider">\n        <constructor-arg>\n            <bean class="org.springframework.security.ldap.authentication.BindAuthenticator">\n                <constructor-arg ref="securityContextSource"/>\n                <property name="userDnPatterns" value="${ldap.user.dnpattern}"/>\n            </bean>\n        </constructor-arg>\n    </bean>\n\n    <security:authentication-manager>\n        <security:authentication-provider ref="ldapAuthenticationProvider"/>\n    </security:authentication-manager>\n</beans>