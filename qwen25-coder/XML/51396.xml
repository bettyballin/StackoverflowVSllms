<configuration>\n  <system.serviceModel>\n    <services>\n      <service name="YourNamespace.YourService">\n        <endpoint address=""\n                  binding="ws2007HttpBinding"\n                  bindingConfiguration="SecuredWs2007HttpBinding"\n                  contract="YourNamespace.IYourService" />\n      </service>\n    </services>\n\n    <bindings>\n      <ws2007HttpBinding>\n        <binding name="SecuredWs2007HttpBinding">\n          <security mode="TransportWithMessageCredential">\n            <transport clientCredentialType="Certificate"/>\n            <message clientCredentialType="Certificate"/>\n          </security>\n        </binding>\n      </ws2007HttpBinding>\n    </bindings>\n\n    <behaviors>\n      <serviceBehaviors>\n        <behavior>\n          <serviceCredentials>\n            <clientCertificate>\n              <authentication certificateValidationMode="PeerTrust" />\n            </clientCertificate>\n            <userNameAuthentication userNamePasswordValidationMode="Custom"\n                                   customUserNamePasswordValidatorType=\n                                   "YourNamespace.YourCustomValidator, YourAssemblyName"/>\n            <serviceCertificate findValue="CN=YourServiceCert"\n                                storeLocation="LocalMachine"\n                                storeName="My" x509FindType="FindBySubjectDistinguishedName" />\n          </serviceCredentials>\n        </behavior>\n      </serviceBehaviors>\n    </behaviors>\n\n  </system.serviceModel>\n</configuration>