<Product Id="*" Name="YourProductName" Language="1033" Version="1.0.0.0"\n         Manufacturer="YourManufacturer" UpgradeCode="PUT-GUID-HERE">\n  <MediaTemplate />\n\n  <Feature Id="ProductFeature" Title="Your Product Feature" Level="1">\n    <ComponentGroupRef Id="ProductComponents" />\n  </Feature>\n\n  <InstallExecuteSequence>\n    <!-- Custom action to save existing registry value -->\n    <Custom Action="SaveRegistryValue" Before="InstallFinalize">NOT Installed</Custom>\n    <!-- Custom action to restore registry value during uninstall -->\n    <Custom Action="RestoreRegistryValue" After="RemoveFiles" />\n  </InstallExecuteSequence>\n\n  <ComponentGroup Id="ProductComponents">\n    <Component Id="RegistryEntryContextMenuOdt" Guid="4BA5BA24-4F65-4BDF-99EB-CB4B947F31A9">\n      <RegistryKey Root="HKCR" Key=".odt" Action="createAndRemoveOnUninstall">\n        <RegistryValue Type="string" Name="" Value="openDocument.WriterDocument.1"\n                      KeyPath="yes" />\n      </RegistryKey>\n    </Component>\n  </ComponentGroup>\n\n  <!-- Define custom actions -->\n  <Binary Id="CustomActionDll" SourceFile="YourCustomActions.dll"/>\n\n  <CustomAction Id="SaveRegistryValue"\n                BinaryKey="CustomActionDll"\n                DllEntry="SaveRegistryKeyValue"\n                Execute="deferred"\n                Return="check"/>\n                \n  <CustomAction Id="RestoreRegistryValue"\n                BinaryKey="CustomActionDll"\n                DllEntry="RestoreRegistryKeyValue"\n                Execute="deferred"\n                Return="ignore"/>\n</Product>