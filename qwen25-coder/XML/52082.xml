<!-- Define the binary (PowerShell script) -->\n<Binary Id="CheckWinmgmtService" SourceFile="CheckWinmgmtService.ps1" />\n\n<!-- Define a custom action for the binary -->\n<CustomAction Id="RunPowerShellScript"\n              BinaryKey="CheckWinmgmtService"\n              ExeCommand="/C powershell.exe -ExecutionPolicy Bypass -File \"#[CheckWinmgmtService]\"" \n              Execute="immediate" Return="check"/>\n\n<!-- Schedule the custom action -->\n<InstallExecuteSequence>\n  <Custom Action='RunPowerShellScript' Before='InstallInitialize'/>\n</InstallExecuteSequence>\n\n<!-- PowerShell script: CheckWinmgmtService.ps1 content -->\n# CheckWinmgmtService.ps1\n$status = (Get-Service -Name WinMgmt).Status\nif ($status -ne 'Running') {\n    Write-Host "winmgmt service is not running. Current status is $status."\n    exit 1\n}