<?xml version="1.0" encoding="UTF-8"?>\n<xsl:stylesheet version="1.0"\n                xmlns:xsl="http://www.w3.org/1999/XSL/Transform">\n    <xsl:output method="text" indent="no"/>\n\n    <!-- Match the root element and start processing each User -->\n    <xsl:template match="/Import/Users/User">\n        <!-- Output the CSV line for this user -->\n        <xsl:value-of select="Contact/@FirstName"/>,\n        <xsl:value-of select="Contact/@LastName"/>,\n        <xsl:value-of select="Address/@Street1"/>,\n        <xsl:value-of select="Address/@City"/>,\n        <xsl:value-of select="Address/@State"/>\n        \n        <!-- Add a new line character after each user except the last one -->\n        <xsl:if test="position() != last()">\n            <xsl:text>\n</xsl:text>\n        </xsl:if>\n    </xsl:template>\n</xsl:stylesheet>