<DirectoryRef Id="INSTALLDIR">\n    <Component Guid="PUT-YOUR-GUID-HERE" Win64="$(var.IsWin64)">\n        <File KeyPath="yes" Source="YourComDll.dll"/>\n        <!-- Register the COM DLL -->\n        <RegistryKey Root="HKLM" Key="SOFTWARE\Classes\CLSID\{YOUR-COM-CLASS-GUID}">\n            <RegistryValue Type="string" Value="Your Com Class Name"/>\n            <RegistryKey Key=".InprocServer32">\n                <RegistryValue Type="string" Value="[INSTALLDIR]YourComDll.dll" />\n                <RegistryValue Type="string" Name="ThreadingModel" Value="Both" />\n            </RegistryKey>\n        </RegistryKey>\n    </Component>\n</DirectoryRef>