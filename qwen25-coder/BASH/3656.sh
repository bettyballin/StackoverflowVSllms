#!/bin/bash\n\n# Define output directory and file for the plot\nOUTPUT_DIR="/tmp"\nFILE_NAME="disk_usage_plot.png"\n\n# Set target directory (defaults to home)\nTARGET_DIR="${1:-$HOME}"\n\n# Generate the disk usage data and save to a temporary file\nDISK_USAGE_FILE=$(mktemp --suffix=.txt)\n\n# du -hd 1 $TARGET_DIR | sort -hr > "$DISK_USAGE_FILE"\ndu -h --max-depth=1 "$TARGET_DIR" | tail -n +2 | sort -rh > "$DISK_USAGE_FILE"\n\n# Create a gnuplot script to plot the data\nGNUPLOT_SCRIPT=$(mktemp --suffix=.gp)\n\ncat <<EOF >> "$GNUPLOT_SCRIPT"\nreset\nset terminal png size 1024,768\nset output '${OUTPUT_DIR}/${FILE_NAME}'\nset title 'Disk Usage for ${TARGET_DIR}'\nset boxwidth 0.9 relative\nset style fill solid 1.0 border -1\nset yrange [0:]\nunset key\nset ylabel "Size"\nset xlabel "Directory"\nset format x ""\nset xtics ( \\\nEOF\n\n# Read the disk usage data and prepare it for gnuplot\nlet index=1\nwhile IFS=$'\t' read -r size path; do\n    dir=$(basename "$path")\n    echo "\"$dir\" ${index}," >> "$GNUPLOT_SCRIPT"\n    let index+=1\ndone < "$DISK_USAGE_FILE"\n\n# Finish the gnuplot script file\necho ")" >> "$GNUPLOT_SCRIPT"\necho "plot '${DISK_USAGE_FILE}' with boxes" >> "$GNUPLOT_SCRIPT"\n\n# Execute the gnuplot script\ngnuplot "$GNUPLOT_SCRIPT"\n\n# Clean up temporary files\nrm -f "$DISK_USAGE_FILE"\nrm -f "$GNUPLOT_SCRIPT"\n\necho "Disk usage plot saved to ${OUTPUT_DIR}/${FILE_NAME}"