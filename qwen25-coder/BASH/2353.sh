@echo off\nsetlocal enabledelayedexpansion\n\nREM Query the registry for CLSIDs\nfor /f "tokens=2*" %%A in ('reg query HKEY_CLASSES_ROOT\CLSID ^| findstr /C:"HKEY_CLASSES_ROOT\\CLSID\\"') do (\n    set clsid=%%B\n    set clsid=!clsid:~1,-1!\n    \n    REM Get the ProgID associated with the CLSID\n    for /f "tokens=2*" %%C in ('reg query HKEY_CLASSES_ROOT\CLSID\!clsid!\ProgId ^| findstr /C:"HKEY_CLASSES_ROOT\\CLSID\\%clsid%\\ProgId\\"') do (\n        echo CLSID !clsid! is ProgID %%D\n    )\n)\nendlocal