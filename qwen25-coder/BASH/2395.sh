#!/bin/bash\n\nfor i in /test/emailfile/*; do\n    # Extract the Received date line\n    received_line=$(grep -m 1 'Received: from' "$i")\n    \n    if [ -z "$received_line" ]; then\n        echo "No Received header found for file: $i"\n        continue\n    fi\n\n    # Parse the date from the Received line\n    date=$(echo "$received_line" | sed 's/.*; //')\n    \n    if ! [[ "$date" =~ [0-9]{1,2}\ [A-Za-z]{3}\ [0-9]{4}\ [0-9]{2}:[0-9]{2}:[0-9]{2}\ [-+][0-9]{4} ]]; then\n        echo "Invalid date format in file: $i"\n        continue\n    fi\n\n    # Convert the date to the desired format\n    newdate=$(date -d "$date" +'%Y%m%d%H%M.%S' 2>/dev/null)\n    \n    if [ $? -ne 0 ]; then\n        echo "Failed to convert date for file: $i"\n        continue\n    fi\n\n    # Update the file's modification time\n    touch -t "$newdate" "$i"\ndone