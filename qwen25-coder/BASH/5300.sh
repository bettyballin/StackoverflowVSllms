@echo off\nsetlocal\n\nREM Settings\nset SERVICE_EXE=C:\Program Files\Data Service\YourServiceName.exe\nset INSTALLUTIL=C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\installutil.exe\nset LOG_FILE=C:\Program Files\Data Service\program.log\n\nREM Check if the service is already installed\nsc query "YourServiceName" >nul 2>&1\nif %errorlevel% equ 0 (\n    REM Service is already installed, ask to uninstall\n    set /p CONFIRM=Do you want to uninstall the service? (y/n): \n    if /i "%CONFIRM%"=="y" (\n        echo Uninstalling service...\n        %INSTALLUTIL% /u "%SERVICE_EXE%"\n        if %errorlevel% equ 0 (\n            echo Service uninstalled successfully on %date% at %time% >> "%LOG_FILE%"\n        ) else (\n            echo Failed to uninstall service on %date% at %time% >> "%LOG_FILE%"\n        )\n    ) else (\n        echo Operation cancelled.\n    )\n) else (\n    REM Service is not installed, proceed with installation\n    echo Installing service...\n    %INSTALLUTIL% "%SERVICE_EXE%"\n    if %errorlevel% equ 0 (\n        echo Service installed successfully on %date% at %time% >> "%LOG_FILE%"\n    ) else (\n        echo Failed to install service on %date% at %time% >> "%LOG_FILE%"\n    )\n)\n\nendlocal