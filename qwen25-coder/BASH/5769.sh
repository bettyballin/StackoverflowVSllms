awk '{gsub(/foo/, "foo_" (++count["foo" $1]))} 1' file.txt