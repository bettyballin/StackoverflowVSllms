$SqlServerInstance = "YourServerInstanceName"\n$tcpProtocol = Get-Item -Path "SQLSERVER:\SQL\$SqlServerInstance\MSSQLSERVER\Protocols\tcp"\n\nif ($tcpProtocol.PSObject.Properties["IsEnabled"].Value) {\n    Write-Host "TCP/IP protocol is already enabled."\n} else {\n    Set-ItemProperty -Path $tcpProtocol.IsDisabled -Name Value -Value 0\n    Write-Host "TCP/IP protocol has been enabled. You may need to restart the SQL Server service for changes to take effect."\n\n    # Restart SQL Server Service (Optional)\n    # $service = Get-WmiObject -Query "SELECT * FROM Win32_Service WHERE Name='MSSQLSERVER'"\n    # Invoke-CimMethod -InputObject $service -MethodName RestartService\n}