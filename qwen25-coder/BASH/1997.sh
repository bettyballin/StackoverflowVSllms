# Query SPNs in the domain and check for duplicates\n$spnHash = @{}\n\nGet-ADComputer -Filter * -Properties ServicePrincipalName | ForEach-Object {\n    $_.ServicePrincipalName | Where-Object {$_} | ForEach-Object {\n        if ($spnHash[$_] -eq $null) {\n            $spnHash[$_] = 1\n        } else {\n            Write-Output "Duplicate SPN found: $_"\n            $spnHash[$_]++\n        }\n    }\n}\n\n# Optionally, list all SPNs for further inspection\n$spnHash.Keys | Sort-Object