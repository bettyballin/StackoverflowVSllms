#!/bin/bash\n\n# Ensure only one sync process is running at a time\nlockfile="/tmp/sync_home_directory.lock"\nif ! flock -n $lockfile; then\n  echo "Another sync is already running. Exit."\n  exit 1\nfi\n\n# Define the function to sync directories\nsync() {\n  rsync -azvR --exclude-from=/home/ME/.rsync_excludes --delete -e 'ssh -ax' "$1" "$2"\n}\n\n# Sync from client to server\nsync /home/ME/ server.domain:/home/ME/\n\n# Sync from server to client\nsync server.domain:/home/ME/ /home/ME/\n\n# Release the lock\nrm $lockfile