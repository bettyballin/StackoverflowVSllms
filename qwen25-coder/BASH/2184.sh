# Load the Report Service Web Service proxy DLL\nAdd-Type -Path "C:\Program Files\Microsoft SQL Server\MSRS10.MSSQLSERVER\Reporting Services\ReportManager\bin\ReportService2005.asmx.dll"\n\n# Create a new instance of the web service proxy\n$uri = "http://localhost/ReportServer/ReportService2005.asmx"\n$proxy = New-WebServiceProxy -Uri $uri -UseDefaultCredential\n\n# Define roles and users\n$userName = "<localmachine>\Scott"\n$roleName = "System Administrator"\n\n# Get the current role assignments\n$currentPolicies = @()\ntry {\n    $currentPolicies = $proxy.GetPolicies("/", [ref]$null)\n} catch {\n    Write-Error $_.Exception.Message\n}\n\n# Create a new policy for the user with the specified role\n$newPolicy = New-Object Microsoft.WSMan.ManagementWSMan.Session.PowerShell.AdvancedFunctionAppDomain.ReportingService2005.PolicyBinding()\n$newPolicy.GroupUserName = $userName\n$newPolicy.Roles = @($roleName)\n$currentPolicies += $newPolicy\n\n# Apply the new policy\ntry {\n    $proxy.SetPolicies("/", $currentPolicies)\n    Write-Host "Role assignment succeeded."\n} catch {\n    Write-Error $_.Exception.Message\n}