<%\nDim strNTUser, objConnection, objCommand, objRecordSet\nstrNTUser = Request.ServerVariables("AUTH_USER")\n' Extract just the username (remove domain part if necessary)\nIf InStr(strNTUser, "\") > 0 Then\n    strNTUser = Split(strNTUser, "\")(1)\nEnd If\n\n' Create and open ADO connection to AD\nSet objConnection = Server.CreateObject("ADODB.Connection")\nobjConnection.Provider = "ADsDSOObject"\nobjConnection.Open "Active Directory Provider"\n\n' Prepare LDAP query to find user by sAMAccountName\nDim strQuery\nstrQuery = "<LDAP://DC=yourdomain,DC=com>;" & _\n           "(&(objectClass=user)(sAMAccountName=" & strNTUser & "));" & _\n           "givenName,sn,employeeID;subtree"\n\n' Execute command and retrieve recordset\nSet objCommand = Server.CreateObject("ADODB.Command")\nobjCommand.ActiveConnection = objConnection\nobjCommand.CommandText = strQuery\n\nSet objRecordSet = objCommand.Execute()\n\nIf Not objRecordSet.EOF Then\n    ' Move first to ensure we're at the right row\n    objRecordSet.MoveFirst\n    \n    Dim firstName, lastName, employeeID\n    firstName = objRecordSet("givenName")\n    lastName = objRecordSet("sn")\n    employeeID = objRecordSet("employeeID")\n\n    Response.Write "First Name: " & firstName & "<br>"\n    Response.Write "Last Name: " & lastName & "<br>"\n    Response.Write "Employee ID: " & employeeID\nElse\n    Response.Write "User not found."\nEnd If\n\n' Clean up\nSet objRecordSet = Nothing\nSet objCommand = Nothing\nobjConnection.Close\nSet objConnection = Nothing\n%>