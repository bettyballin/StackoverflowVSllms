Imports Microsoft.Practices.EnterpriseLibrary.Data\nImports System.Data.OracleClient\n\nPublic Function GetNextJobNumber() As Integer\n    Dim db As Database = DatabaseFactory.CreateDatabase()\n    Using cmd As DbCommand = db.GetStoredProcCommand("CORPHIER_PKG.get_job_no")\n        ' Add the return value parameter\n        Dim retval As New OracleParameter("RETURN_VALUE", OracleType.Number)\n        retval.Direction = ParameterDirection.ReturnValue\n        cmd.Parameters.Add(retval)\n\n        ' Execute the command\n        db.ExecuteNonQuery(cmd)\n\n        ' Convert and return the result\n        Return Convert.ToInt32(retval.Value)\n    End Using\nEnd Functio