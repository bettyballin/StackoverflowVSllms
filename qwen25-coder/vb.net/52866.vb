<%\nDim objFile, strExtension, allowedExtensions, blnAllowUpload\n\n' Initialize variables\nSet objFile = Request.Files("uploadedFile")\nblnAllowUpload = False\nallowedExtensions = ".jpg,.jpeg,.png,.gif"\n\n' Get the file extension\nstrExtension = Right(objFile.FileName, InStr(1, StrReverse(objFile.FileName), ".") - 1)\n\n' Check if the file extension is allowed\nIf InStr(1, allowedExtensions, strExtension, vbTextCompare) > 0 Then\n    ' Check file size (e.g., max size of 2MB)\n    If objFile.Size <= 2 * 1024 * 1024 Then\n        blnAllowUpload = True\n    \n        ' Rename the file to prevent execution\n        Dim newFileName, objFSO\n        Set objFSO = Server.CreateObject("Scripting.FileSystemObject")\n        newFileName = objFSO.GetTempName() & strExtension\n        \n        ' Save the file to server's disk with new name\n        objFile.SaveAs(Server.MapPath("~/uploads/") & "\\" & newFileName)\n        \n        Response.Write "File Uploaded Successfully."\n    Else\n        Response.Write "File size is too large."\n    End If\nElse\n    Response.Write "File type not allowed."\nEnd If\n\nSet objFSO = Nothing\nSet objFile = Nothing\n%>