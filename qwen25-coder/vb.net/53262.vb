Imports System.Text\n\nPublic Function EncodeQuotedPrintable(input As String) As String\n    Dim outputBuilder As New StringBuilder()\n    Dim currentLineLength As Integer = 0\n    \n    For Each ch As Char In input\n        If Char.IsLetterOrDigit(ch) OrElse " !#$%&'*+,-./:;<=>?@[\]^_`{|}~".Contains(ch) Then\n            outputBuilder.Append(ch)\n            currentLineLength += 1\n        Else\n            ' Handle escaping for non-alphanumeric characters and some punctuation.\n            Dim escapeString = "=" & Convert.ToString(CInt(ch), 16).ToUpperInvariant()\n            outputBuilder.Append(escapeString)\n            currentLineLength += escapeString.Length\n        End If\n        \n        ' Check if we need to insert a soft line break.\n        If currentLineLength >= 73 Then\n            outputBuilder.AppendLine("=") ' Soft line break\n            currentLineLength = 0\n        End If\n    Next\n    \n    Return outputBuilder.ToString()\nEnd Functio