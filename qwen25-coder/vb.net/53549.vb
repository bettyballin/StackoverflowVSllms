Imports System.Xml.Linq\n\nDim xConnections As New XElement("Connections")\nFor Each connection As Connection In connections.AsList\n    For Each kvp As KeyValuePair(Of String, String) In connection.DecompiledElements\n        ' Create a new XElement dynamically and add it to the parent element\n        Dim element As New XElement(kvp.Key, kvp.Value)\n        xConnections.Add(element)\n    Next\nNext\n\n' xConnections now contains the XML structure you want\nConsole.WriteLine(xConnections.ToString())