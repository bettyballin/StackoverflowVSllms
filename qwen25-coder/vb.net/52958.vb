Imports System.IO\n\nPublic Class PDFConverter\n    Public Sub ConvertToPDF(sourceFile As String, destinationFile As String)\n        Dim PDFFolder As String = Path.GetDirectoryName(destinationFile)\n\n        If Not Directory.Exists(PDFFolder) Then\n            Directory.CreateDirectory(PDFFolder)\n        End If\n\n        ' Initialize Acrobat Distiller objects\n        Dim adApp As Object\n        Dim PDSFileName As String\n\n        Try\n            ' Create a new instance of the AcroExch.Distiller application\n            adApp = CreateObject("AcroExch.Distiller")\n\n            ' Set up the job in the distiller\n            PDSFileName = System.IO.Path.GetTempPath() & Path.GetFileNameWithoutExtension(Path.GetRandomFileName()) & ".job"\n            Using Writer As New StreamWriter(PDSFileName)\n                Writer.WriteLine("[ /Timeout 300 ")\n                Writer.WriteLine("/Update Full")\n                Writer.WriteLine("/JobOptions << /PrinterName (Adobe PDF) >>")\n                Writer.WriteLine(">> setdistillerparams")\n\n                ' Specify input and output files\n                Writer.WriteLine("(" & sourceFile.Replace("\", "\\") & ") (" & destinationFile.Replace("\", "\\") & ") to pdf")\n            End Using\n\n            ' Execute the distillation job\n            If adApp.Start() Then\n                ' This command will read, execute, delete the .job file and convert file to PDF\n                adApp.Convert(PDSFileName)\n                adApp.Stop()\n            Else\n                Throw New Exception("Distiller failed to start.")\n            End If\n\n        Catch ex As Exception\n            MessageBox.Show("Error during conversion: " & ex.Message)\n        Finally\n            ' Clean up the .job file if still exists\n            If File.Exists(PDSFileName) Then\n                File.Delete(PDSFileName)\n            End If\n\n            ' Release COM object\n            System.Runtime.InteropServices.Marshal.ReleaseComObject(adApp)\n            adApp = Nothing\n        End Try\n    End Sub\nEnd Class