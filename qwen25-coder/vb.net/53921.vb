Imports System.Runtime.InteropServices\n\n<Guid("YOUR-GUID-HERE"),\n InterfaceType(ComInterfaceType.InterfaceIsIUnknown)>\nPublic Interface IObjectSafety\n    Sub SetInterfaceSafetyOptions(ByVal riid As Guid, ByVal dwOptionSetMask As Integer, ByVal dwEnabledOptions As Integer)\n    Function GetInterfaceSafetyOptions(ByVal riid As Guid, ByRef pdwSupportedOptions As Integer, ByRef pdwEnabledOptions As Integer) As Integer\nEnd Interface\n\n<Guid("YOUR-GUID-HERE"),\n ClassInterface(ClassInterfaceType.None),\n ComVisible(True)>\nPublic Class ParallelPortControl\n    Implements IObjectSafety\n\n    Private Const INTERFACESAFE_FOR_UNTRUSTED_CALLER = &H1\n    Private Const INTERFACESAFE_FOR_UNTRUSTED_DATA = &H2\n\n    Public Sub New()\n        ' Initialization code.\n    End Sub\n\n    ' IObjectSafety Members\n    <PreserveSig()>\n    Public Sub SetInterfaceSafetyOptions(ByVal riid As Guid, ByVal dwOptionSetMask As Integer, ByVal dwEnabledOptions As Integer) Implements IObjectSafety.SetInterfaceSafetyOptions\n        If Not riid = GetType(IObjectSafety).GUID Then\n            Throw New COMException("Invalid interface", &H80040203)\n        End If\n\n        ' Check for safe options.\n        If (dwOptionSetMask And INTERFACESAFE_FOR_UNTRUSTED_CALLER) <> 0 Then\n            m_safeForScripting = (dwEnabledOptions And INTERFACESAFE_FOR_UNTRUSTED_CALLER) <> 0\n        End If\n        If (dwOptionSetMask And INTERFACESAFE_FOR_UNTRUSTED_DATA) <> 0 Then\n            m_safeForInitializing = (dwEnabledOptions And INTERFACESAFE_FOR_UNTRUSTED_DATA) <> 0\n        End If\n    End Sub\n\n    <PreserveSig()>\n    Public Function GetInterfaceSafetyOptions(ByRef riid As Guid, ByRef pdwSupportedOptions As Integer, ByRef pdwEnabledOptions As Integer) As Integer Implements IObjectSafety.GetInterfaceSafetyOptions\n        If Not riid = GetType(IObjectSafety).GUID Then\n            Return &H80040203 ' E_NOINTERFACE\n        End If\n\n        pdwSupportedOptions = INTERFACESAFE_FOR_UNTRUSTED_CALLER Or INTERFACESAFE_FOR_UNTRUSTED_DATA\n        pdwEnabledOptions = 0\n        If m_safeForScripting Then\n            pdwEnabledOptions = pdwEnabledOptions Or INTERFACESAFE_FOR_UNTRUSTED_CALLER\n        End If\n        If m_safeForInitializing Then\n            pdwEnabledOptions = pdwEnabledOptions Or INTERFACESAFE_FOR_UNTRUSTED_DATA\n        End If\n\n        Return 0 ' S_OK\n    End Function\n\n    Private m_safeForScripting As Boolean = True\n    Private m_safeForInitializing As Boolean = True\n\n    Public Sub YourMethod()\n        ' Method implementation.\n    End Sub\nEnd Class