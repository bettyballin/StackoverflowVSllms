Private Sub AddMessage(username As String, message As String)\n    ' Disable selection and formatting changes while updating content\n    RichTextBox1.SelectionProtected = True\n    RichTextBox1.Select(RichTextBox1.TextLength, 0)\n\n    ' Add username (non-selectable)\n    RichTextBox1.SelectionFont = New System.Drawing.Font(RichTextBox1.Font, FontStyle.Bold)\n    RichTextBox1.SelectedText = $"{username}: "\n\n    ' Make the user part not selectable\n    RichTextBox1.SelectionProtected = True\n\n    ' Add message (selectable)\n    RichTextBox1.SelectionFont = RichTextBox1.Font\n    RichTextBox1.SelectedText = $"{message}{Environment.NewLine}"\n\n    ' Allow selection of new messages only\n    RichTextBox1.Select(RichTextBox1.TextLength, 0)\n    RichTextBox1.SelectionProtected = False\n\n    ' Scroll to the end to see the latest message\n    RichTextBox1.ScrollToCaret()\nEnd Sub