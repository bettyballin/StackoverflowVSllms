Private Async Sub cmbServer_DropDown(sender As Object, e As EventArgs) Handles cmbServer.DropDown\n    If cmbServer.Items.Count > 0 Then Return\n\n    System.Windows.Forms.Cursor.Current = Cursors.WaitCursor\n\n    Try\n        Dim lstServers = Await Task.Run(Function() GetDataSources())\n        lstServers.Sort()\n        cmbServer.Items.AddRange(lstServers.ToArray())\n    Catch ex As Exception\n        ErrHandler("frmRefreshDB", "cmbServer_DropDown", ex.Source, ex.Message, ex.InnerException)\n    Finally\n        System.Windows.Forms.Cursor.Current = Cursors.Default\n    End Try\nEnd Sub\n\nPrivate Function GetDataSources() As List(Of String)\n    Dim oTable As DataTable\n    Dim lstServers As New List(Of String)\n    Dim lstAliases As List(Of String)\n\n    oTable = System.Data.Sql.SqlDataSourceEnumerator.Instance.GetDataSources()\n\n    For Each oRow As DataRow In oTable.Rows\n        If oRow("InstanceName").ToString() = "" Then\n            lstServers.Add(oRow("ServerName").ToString())\n        Else\n            lstServers.Add(oRow("ServerName").ToString() & "\" & oRow("InstanceName").ToString())\n        End If\n    Next\n\n    'Retrieve any server aliases on the client and add them to the server list\n    lstAliases = GetSQLServerAliases()\n    If lstAliases IsNot Nothing Then\n        For Each sAlias As String In lstAliases\n            lstServers.Add(sAlias)\n        Next\n    End If\n\n    Return lstServers\nEnd Functio