Imports System.Data.SqlClient\n\nPublic Class PropertySearch\n    Public Function GetProperties(ByVal country As String, ByVal region As String, ByVal area As String, _\n                                  ByVal minBedrooms As Integer?, ByVal priceMin As Decimal?, ByVal priceMax As Decimal?, _\n                                  ByVal propertyType As String, ByVal propertyOfTheWeek As Boolean?, _\n                                  ByVal featuredOnly As Boolean?, ByVal onOfferOnly As Boolean?) As DataTable\n        Dim connectionString As String = "YourConnectionStringHere"\n        Using connection As New SqlConnection(connectionString)\n            Dim sbQuery As New System.Text.StringBuilder("SELECT * FROM Houses H ")\n            \n            ' Join statements to other tables if needed\n            sbQuery.Append("LEFT JOIN Pictures P ON P.HouseID = H.HouseID ")\n            sbQuery.Append("LEFT JOIN Features F ON F.HouseID = H.HouseID WHERE 1=1 ")\n\n            Dim parameters As New List(Of SqlParameter)()\n            \n            If Not String.IsNullOrEmpty(country) Then\n                sbQuery.Append(" AND H.Country = @Country")\n                parameters.Add(New SqlParameter("@Country", country))\n            End If\n\n            If Not String.IsNullOrEmpty(region) Then\n                sbQuery.Append(" AND H.Region = @Region")\n                parameters.Add(New SqlParameter("@Region", region))\n            End If\n            \n            ' Continue for other fields...\n\n            If minBedrooms.HasValue Then\n                sbQuery.Append(" AND H.Bedrooms >= @MinBedrooms")\n                parameters.Add(New SqlParameter("@MinBedrooms", minBedrooms.Value))\n            End If\n\n            If priceMin.HasValue AndAlso priceMax.HasValue Then\n                sbQuery.Append(" AND H.Price BETWEEN @PriceMin AND @PriceMax")\n                parameters.Add(New SqlParameter("@PriceMin", priceMin.Value))\n                parameters.Add(New SqlParameter("@PriceMax", priceMax.Value))\n            End If\n            \n            ' Add checks for other special search criteria like featured, property of the week, on offer etc.\n            \n            If featuredOnly.HasValue AndAlso featuredOnly.Value Then\n                sbQuery.Append(" AND H.Featured = 1")\n            End If\n\n            Using command As New SqlCommand(sbQuery.ToString(), connection)\n                command.Parameters.AddRange(parameters.ToArray())\n                Dim adapter As New SqlDataAdapter(command)\n                Dim dtResults As New DataTable()\n                adapter.Fill(dtResults)\n                Return dtResults\n            End Using\n        End Using\n    End Function\nEnd Class