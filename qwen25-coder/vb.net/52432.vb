Private Function theThing() As Integer()\n    Dim arIn() As Integer = {0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 1, 0, 0, 1}\n    Dim maxSize As Integer = arIn.Length ' No need for GetUpperBound if using Length\n    Dim positions(maxSize - 1) As Integer ' Pre-allocate max possible size\n    Dim positionCount As Integer = 0\n    \n    For x As Integer = 0 To maxSize - 1 ' Start from 0 to include all elements\n        If arIn(x) = 1 Then\n            positions(positionCount) = x\n            positionCount += 1\n        End If\n    Next\n\n    Dim result(positionCount - 1) As Integer ' Resize to the actual amount found\n    Array.Copy(positions, 0, result, 0, positionCount)\n\n    Return result\nEnd Functio