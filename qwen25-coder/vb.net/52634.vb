Public Sub ProcessRequest(ByVal context As HttpContext) Implements IHttpHandler.ProcessRequest\n    If Not String.IsNullOrEmpty(context.Request.QueryString("Id")) Then\n        Dim imageId = Convert.ToInt64(context.Request.QueryString("Id"))\n        Dim result = repository.FindById(imageId).imageData.ToArray()\n        context.Response.ContentType = "image/jpeg" ' or the appropriate content type for your image\n        context.Response.BinaryWrite(DirectCast(result, Byte()))\n        context.Response.End()\n    End If\nEnd Sub