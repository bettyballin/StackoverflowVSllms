Protected Sub rptTabContent_ItemCommand(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.RepeaterCommandEventArgs)\n    If (e.Item.ItemType = ListItemType.Item) Or (e.Item.ItemType = ListItemType.AlternatingItem) Then\n        Dim filteredProposedDeliveries As New List(Of ProposedDeliverySlotDTO)\n        Dim firstDate, lastDate As Date\n        Dim startDate, endDate As Date\n\n        ' Get stored dates or initialize them to first and last delivery dates from session.\n        If (Session("FirstDeliveryDate") IsNot Nothing) AndAlso (Session("LastDeliveryDate") IsNot Nothing) Then\n            firstDate = CType(Session("FirstDeliveryDate"), Date)\n            lastDate = CType(Session("LastDeliveryDate"), Date)\n\n            ' Assume View state is used to store current start date.\n            If ViewState("CurrentStartDate") Is Nothing Then\n                ViewState("CurrentStartDate") = firstDate.Ticks\n            End If\n\n            startDate = New DateTime(CLng(ViewState("CurrentStartDate")))\n\n            Select Case e.CommandArgument.ToString()\n                Case "Next"\n                    ' Ensure not going past lastDate + 7 days.\n                    If startDate.AddDays(14) <= lastDate Then\n                        startDate = startDate.AddDays(7)\n                    End If\n                Case "Previous"\n                    ' Ensure not going before the firstDate.\n                    If startDate.AddDays(-7) >= firstDate Then\n                        startDate = startDate.AddDays(-7)\n                    End If\n            End Select\n\n            endDate = startDate.AddDays(6)\n\n            ViewState("CurrentStartDate") = startDate.Ticks  ' Store updated start date to viewstate.\n\n            filteredProposedDeliveries = GetFilteredProposedDeliveries(startDate, endDate)  ' Implement this method to retrieve data between given dates.\n        End If\n\n        Dim slots As List(Of SlotType) = PrepareSlotsForBinding(filteredProposedDeliveries)\n        Dim rptTabContent As Repeater = CType(e.Item.BindingContainer, Repeater)\n\n        ' Bind the new data.\n        rptTabContent.DataSource = slots\n        rptTabContent.DataBind()\n\n        ' Update button states after bind.\n        For Each item In rptTabContent.Items\n            If TypeOf item Is RepeaterItem AndAlso (item.ItemType = ListItemType.Item OrElse item.ItemType = ListItemType.AlternatingItem) Then\n                Dim lnkPreviousWeek As LinkButton = CType(item.FindControl("lnkPreviousWeek"), LinkButton)\n                Dim lnkNextWeek As LinkButton = CType(item.FindControl("lnkNextWeek"), LinkButton)\n\n                ' Enable/Disable previous button.\n                lnkPreviousWeek.Enabled = (startDate.AddDays(-7) >= firstDate)\n                If lnkPreviousWeek.Enabled Then\n                    lnkPreviousWeek.CssClass = "active"\n                Else\n                    lnkPreviousWeek.CssClass = "inactive"\n                End If\n\n                ' Enable/Disable next button.\n                lnkNextWeek.Enabled = (startDate.AddDays(14) <= lastDate)\n                If lnkNextWeek.Enabled Then\n                    lnkNextWeek.CssClass = "active"\n                Else\n                    lnkNextWeek.CssClass = "inactive"\n                End If\n            End If\n        Next\n    End If\nEnd Sub\n\nPrivate Function GetFilteredProposedDeliveries(startDate As Date, endDate As Date) As List(Of ProposedDeliverySlotDTO)\n    ' Implement this method to return filtered data based on start and end dates.\n    ' This is a placeholder function and you need to provide the actual implementation.\n    Return New List(Of ProposedDeliverySlotDTO)\nEnd Function\n\nPrivate Function PrepareSlotsForBinding(filteredProposedDeliveries As List(Of ProposedDeliverySlotDTO)) As List(Of SlotType)\n    ' Implement this method to prepare SlotType list for binding based on filteredProposedDeliveries data.\n    ' This is a placeholder function and you need to provide the actual implementation.\n    Return New List(Of SlotType)\nEnd Functio