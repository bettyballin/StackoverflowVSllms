Imports System.IO\n\nModule Module1\n    Sub Main()\n        Try\n            ' Code that uses RightFax component goes here\n            Dim rightFax As Interop.RFCOMAPILib.IRightFax = New Interop.RFCOMAPILib.RightFaxClass()\n        Catch ex As Exception\n            LogError(ex)\n        End Try\n    End Sub\n\n    Private Sub LogError(ByVal ex As Exception)\n        Dim logPath As String = "C:\Logs\MyAppErrorLog.txt"\n        If Not Directory.Exists(Path.GetDirectoryName(logPath)) Then\n            Directory.CreateDirectory(Path.GetDirectoryName(logPath))\n        End If\n\n        Using sw As StreamWriter = New StreamWriter(logPath, True)\n            sw.WriteLine("Date: {0}", DateTime.Now.ToString())\n            sw.WriteLine("Message: {0}", ex.Message)\n            sw.WriteLine("Source: {0}", ex.Source)\n            sw.WriteLine("Stack Trace: {0}", ex.StackTrace)\n            If Not (ex.InnerException Is Nothing) Then\n                sw.WriteLine("Inner Exception: {0}", ex.InnerException.Message)\n            End If\n            sw.WriteLine("------------------------------------------------------------")\n        End Using\n    End Sub\nEnd Module