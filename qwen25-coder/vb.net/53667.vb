Imports System.Xml\n\nSub AppendEmailToXml(from As String, txto As String, subj As String, body As String)\n    Dim doc As New XmlDocument()\n    If IO.File.Exists("C:\xmlmailfile.xml") Then\n        ' Load the existing XML document\n        doc.Load("C:\xmlmailfile.xml")\n    Else\n        ' Create a new root element if the file does not exist\n        doc.AppendChild(doc.CreateElement("Emails"))\n    End If\n\n    Dim emailElement As XmlElement = doc.CreateElement("EMail")\n\n    emailElement.AppendChild(CreateElementWithText(doc, "From", from))\n    emailElement.AppendChild(CreateElementWithText(doc, "To", txto))\n    emailElement.AppendChild(CreateElementWithText(doc, "Subject", subj))\n    emailElement.AppendChild(CreateElementWithText(doc, "Body", body))\n\n    doc.DocumentElement.AppendChild(emailElement)\n\n    ' Save the document\n    Dim settings As New XmlWriterSettings()\n    settings.Indent = True\n    settings.NewLineOnAttributes = True\n    Using writer As XmlWriter = XmlWriter.Create("C:\xmlmailfile.xml", settings)\n        doc.Save(writer)\n    End Using\nEnd Sub\n\nFunction CreateElementWithText(doc As XmlDocument, elementName As String, text As String) As XmlElement\n    Dim element As XmlElement = doc.CreateElement(elementName)\n    element.InnerText = text\n    Return element\nEnd Functio