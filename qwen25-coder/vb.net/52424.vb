Imports System.Windows.Forms\n\nPublic Class Form1\n\n    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click\n        Dim f2 As New Form2()\n\n        ' Subscribe to the ThreadException event\n        AddHandler Application.ThreadException, AddressOf OnThreadException\n\n        Try\n            MessageBox.Show("Opening form 2")\n            f2.ShowDialog()\n        Catch ex As Exception\n            f2.Close()\n            MessageBox.Show("Form 2 closed.")\n        End Try\n    End Sub\n\n    ' Event handler for unhandled exceptions on any threads\n    Private Sub OnThreadException(sender As Object, e As System.Threading.ThreadExceptionEventArgs)\n        MessageBox.Show("An error occurred: " & e.Exception.Message)\n        If TypeOf e.Exception Is ApplicationException Then\n            Dim f2 = DirectCast(ActiveForm, Form2)\n            f2.Close()\n        End If\n    End Sub\n\nEnd Class\n\nPublic Class Form2\n\n    Private Sub Form2_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load\n        Throw New ApplicationException("Test Form_Load")\n    End Sub\nEnd Class