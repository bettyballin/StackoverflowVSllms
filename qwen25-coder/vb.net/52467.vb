Imports System.Text.RegularExpressions\n\nDim editorContent As String = "<your editor content here>"\nDim myInternalDomain As String = "<your internal domain here>"\n\n' Define your regex pattern\nDim regExString As String = "<a\b[^<>]*href\s*=\s*[\""\'](?<domain>https?:\/\/[^\/\s\'\""]*)*\/?(?<path>\/?[^\s\""]+?)?[[>\""\']"\n\n' Use StringBuilder for efficient string manipulation\nDim sb As New StringBuilder()\n\n' Define a match evaluator function\nDim matchEvaluator As MatchEvaluator = Function(m)\n                                            Dim domain As String = m.Groups("domain").Value.ToLower()\n                                            Dim path As String = m.Groups("path").Value\n\n                                            ' Determine if the link is internal or external and PDF check\n                                            Dim isExternal As Boolean = Not String.IsNullOrEmpty(domain) AndAlso domain <> myInternalDomain\n                                            Dim isPdf As Boolean = path.EndsWith(".pdf", StringComparison.OrdinalIgnoreCase)\n\n                                            ' Modify the <a> tag based on conditions\n                                            Dim newTag As String = m.Value\n\n                                            If isExternal Then\n                                                newTag = Regex.Replace(newTag, ">", " onclick='yourJSFunction();'>")\n                                            End If\n\n                                            If isPdf Then\n                                                newTag = Regex.Replace(newTag, ">", " target='_blank'>", RegexOptions.IgnoreCase)\n                                            End If\n\n                                            Return newTag\n                                        End Function\n\n' Replace all matches in editorContent with the modified versions\neditorContent = Regex.Replace(editorContent, regExString, matchEvaluator)\n\n' The resulting editorContent will have all links modified according to your rules.