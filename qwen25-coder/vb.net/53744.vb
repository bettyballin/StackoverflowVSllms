Imports System.Diagnostics\n\n'Clean out the existing data in the validation import table\ncmd.CommandText = "TRUNCATE TABLE HedgeFileBuilders.dbo.HedgeInput_" & strProduct & "_VALIDATOR;"\ncmd.ExecuteNonQuery()\n\n're-import the inforce file to validate it\nTry\n    Dim sqlCommand As String\n    If chkSQLServerSource Then\n        sqlCommand = SQLLOCALDIR & "Prog\bcp.exe HedgeFileBuilders.dbo.Input_" & strProduct & "_VALIDATOR in """ & strFileName & """ -c -t, -r \n -S server -U user -P passkey -F 2 -h TABLOCK"\n    Else\n        sqlCommand = SQLLOCALDIR & "Prog\bcp.exe HedgeFileBuilders.dbo.Input_" & strProduct & "_VALIDATOR in """ & strFileName & """ -c -t, -r \n -S pcname -T -F 2 -h TABLOCK"\n    End If\n\n    Dim processInfo As New ProcessStartInfo("cmd.exe", "/C " & sqlCommand)\n    processInfo.CreateNoWindow = True\n    processInfo.UseShellExecute = False\n    processInfo.RedirectStandardOutput = True\n    processInfo.RedirectStandardError = True\n    \n    Using process As New Process()\n        process.StartInfo = processInfo\n        process.Start()\n\n        Dim output As String = process.StandardOutput.ReadToEnd()\n        Dim errorOutput As String = process.StandardError.ReadToEnd()\n        process.WaitForExit()\n\n        If Not String.IsNullOrEmpty(errorOutput) Then\n            MessageBox.Show("ERROR: An error occurred while re-importing the new business file: " & errorOutput, "Contact System Administrator", MessageBoxButtons.OK, MessageBoxIcon.Error)\n        Else\n            Console.WriteLine("Import successful. Output: " & output)\n        End If\n    End Using\n\nCatch ex As Exception\n    MessageBox.Show("An unexpected error occurred: " & ex.Message, "System Error", MessageBoxButtons.OK, MessageBoxIcon.Error)\nEnd Try