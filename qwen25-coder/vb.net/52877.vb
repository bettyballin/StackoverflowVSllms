<%\nIf Request.ServerVariables("REQUEST_METHOD")="POST" Then\n    Set File = Upload("picturefile")\n    \n    If Len(File.FileName) > 0 Then        \n        Dim sqlStmt, cmd\n        \n        ' Create a new Binary Stream object \n        Set BinStream = Server.CreateObject("ADODB.Stream")\n        BinStream.Type = 1 ' adTypeBinary\n        BinStream.Open\n        BinStream.Write File.FileData\n        BinStream.Position = 0\n\n        ' Insert into database\n        sqlStmt = "INSERT INTO ImageCatalog (ImageName, ImageData) VALUES (?, ?)"\n        \n        Set cmd = Server.CreateObject("ADODB.Command")\n        cmd.ActiveConnection = YourConnectionStringHere\n        cmd.CommandText = sqlStmt\n        \n        cmd.Parameters.Append cmd.CreateParameter("@ImageName", 200, 1, Len(File.FileName), File.FileName)\n        cmd.Parameters.Append cmd.CreateParameter("@ImageData", 205, 1, , BinStream.Read)\n        \n        cmd.Execute\n    End If\nEnd If\n\n' Function to handle uploads\nFunction Upload(byVal fieldName)\n    Set Upload = New clsUploadFile\n    Upload.NameItem = Trim(Request.Form(fieldName))\n    Upload.FileName = Server.MapPath(Trim(Request.Files(fieldName).FileName))\n    \n    Dim adoStream, aspDataBinary\n    \n    Set binData = Request.BinaryRead(Request.TotalBytes)\n    Set adoStream = Server.CreateObject("ADODB.Stream")\n    adoStream.Type = 1 ' adTypeBinary\n    adoStream.Open\n    adoStream.Write binData\n    adoStream.Position = 0\n    \n    Do Until adoStream.EOS\n        Upload.FileData = Split(adoStream.Read(Request.TotalBytes), chrB(32))\n        Exit Do\n    Loop\n    \n    adoStream.Close\n    Set adoStream=nothing\n    \n    Request.Form.Remove fieldName\nEnd Function\n\nClass clsUploadFile\n    Public NameItem, FileData, FileName\nEnd Class\n%>\n\n<!DOCTYPE html>\n<html>\n<body>\n<form method="post" enctype="multipart/form-data">\n   <input type="file" name="picturefile"><br>\n   <input type="submit" value="Upload">\n</form>\n</body>\n</html>