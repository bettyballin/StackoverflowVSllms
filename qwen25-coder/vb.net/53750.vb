Imports System\nImports System.ServiceProcess\nImports System.IO\nImports System.Threading\n\nModule RestartIIS\n    Sub Main()\n        Run()\n    End Sub\n\n    Public Sub Run()\n        Console.WriteLine("Please enter the Server Name: ")\n        Dim ServerName As String = Console.ReadLine()\n\n        Try\n            ' Specify the server name when creating the ServiceController instance\n            Dim sc As New ServiceController("W3SVC", ServerName)\n\n            Console.WriteLine($"Stopping IIS on {ServerName}...")\n            sc.Stop()\n            sc.WaitForStatus(ServiceControllerStatus.Stopped)\n\n            Thread.Sleep(2000) ' Optional delay\n\n            Console.WriteLine($"Starting IIS on {ServerName}...")\n            sc.Start()\n            sc.WaitForStatus(ServiceControllerStatus.Running)\n\n            Console.WriteLine("IIS restart completed successfully.")\n        Catch ex As Exception\n            Console.WriteLine($"An error occurred: {ex.Message}")\n        End Try\n\n        Console.Write("Press Enter to Exit")\n        Console.ReadLine()\n    End Sub\nEnd Module