Imports System.Diagnostics\n\nModule Module1\n    Sub Main()\n        Dim serialPortNumber As String = "COM3"  ' Change this to your target COM port\n        Dim processList As Process() = Process.GetProcesses()\n\n        For Each proc In processList\n            Try\n                Dim openFiles As String = GetOpenFiles(proc.Id)\n                If openFiles.Contains(serialPortNumber) Then\n                    Console.WriteLine($"Process {proc.ProcessName} (ID: {proc.Id}) is using {serialPortNumber}.")\n                End If\n            Catch ex As Exception\n                ' Skip processes that we cannot access\n            End Try\n        Next\n    End Sub\n\n    Function GetOpenFiles(processId As Integer) As String\n        Dim psi As New ProcessStartInfo("Openfiles.exe", $"/query /fo table /nh /pid {processId}")\n        psi.UseShellExecute = False\n        psi.RedirectStandardOutput = True\n        psi.CreateNoWindow = True\n\n        Using p As Process = Process.Start(psi)\n            Return p.StandardOutput.ReadToEnd()\n        End Using\n    End Function\nEnd Module