Imports System.Data.SqlClient\n\nTry\n    Using con As New SqlConnection("YourConnectionStringHere")\n        con.Open()\n\n        ' Execute RESTORE FILELISTONLY\n        Using cmd As New SqlCommand("RESTORE FILELISTONLY FROM DISK='c:\old.bak'", con)\n            cmd.ExecuteNonQuery()\n        End Using\n\n        ' Execute RESTORE DATABASE\n        Using cmd As New SqlCommand("RESTORE DATABASE newdb " & _\n                                    "FROM DISK='c:\old.bak' " & _\n                                    "WITH MOVE 'newdb' TO 'c:\newdb.mdf', " & _\n                                    "MOVE 'newdb_log' TO 'c:\newdb_log.ldf'", con)\n            cmd.ExecuteNonQuery()\n        End Using\n    End Using\n\nCatch ex As SqlException\n    Console.WriteLine("SQL Error: " & ex.Message)\nCatch ex As Exception\n    Console.WriteLine("General Error: " & ex.Message)\nEnd Try