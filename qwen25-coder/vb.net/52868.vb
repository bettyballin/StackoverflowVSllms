Protected Sub Page_Load(ByVal sender As Object, ByVal e As EventArgs) Handles Me.Load\n    If Not IsPostBack Then\n        ' Your existing code to populate DataTable...\n\n        For Each pmDr As DataRow In yourDataTable.Rows\n            Dim lnkbtnPm As New LinkButton()\n            lnkbtnPm.Text = pmDr.Item("Username")\n            lnkbtnPm.CommandArgument = Convert.ToString(pmDr.Item("UserId"))\n            lnkbtnPm.CommandName = "SelectUser"\n            \n            ' Add event handler for Command event\n            AddHandler lnkbtnPm.Command, AddressOf LinkButton_Command\n\n            panelToAddControlTo.Controls.Add(lnkbtnPm)\n        Next\n    End If\nEnd Sub\n\nPrivate Sub LinkButton_Command(ByVal sender As Object, ByVal e As CommandEventArgs)\n    If e.CommandName = "SelectUser" Then\n        ' Set the session variable with the UserId\n        Session("SelectedUserId") = Convert.ToString(e.CommandArgument)\n\n        ' Redirect to the desired page\n        Response.Redirect("TargetPage.aspx")\n    End If\nEnd Sub