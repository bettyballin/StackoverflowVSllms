Imports System.Windows.Forms\n\nModule Module1\n    Sub Main()\n        ' Set the unhandled exception mode to force all Windows Forms errors\n        ' to go through our handler.\n        Application.SetUnhandledExceptionMode(UnhandledExceptionMode.CatchException)\n        AddHandler AppDomain.CurrentDomain.UnhandledException, AddressOf CurrentDomain_UnhandledException\n        AddHandler Application.ThreadException, AddressOf Application_ThreadException\n\n        ' Start the application\n        Application.Run(New YourMainForm())\n    End Sub\n\n    Private Sub CurrentDomain_UnhandledException(ByVal sender As Object, ByVal e As UnhandledExceptionEventArgs)\n        Console.WriteLine("Unhandled exception at appdomain level: " & CType(e.ExceptionObject, Exception).ToString(), "UnhandledException Caught")\n    End Sub\n\n    Private Sub Application_ThreadException(ByVal sender As Object, ByVal e As Threading.ThreadExceptionEventArgs)\n        MessageBox.Show("Error:" & e.Exception.Message, "Thread Exception Caught", MessageBoxButtons.OK, MessageBoxIcon.Error)\n    End Sub\nEnd Module