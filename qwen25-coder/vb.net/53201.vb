Public Module LanguageResources\n    Private _languagePreferenceProvider As ILanguagePreferenceProvider\n\n    Public Property LanguagePreferenceProvider As ILanguagePreferenceProvider\n        Get\n            Return _languagePreferenceProvider\n        End Get\n        Set(value As ILanguagePreferenceProvider)\n            _languagePreferenceProvider = value\n        End Set\n    End Property\n\n    Public Function GetLocalizedText(key As String) As String\n        Dim language As String = LanguagePreferenceProvider.GetUserPreferredLanguage()\n        ' Logic to get resource based on the language and key\n        Return Resources.ResourceManager.GetString(key, New Globalization.CultureInfo(language))\n    End Function\nEnd Module