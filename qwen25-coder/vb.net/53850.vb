Imports CrystalDecisions.CrystalReports.Engine\n\nPublic Sub GenerateCrystalReportsForMultipleHeaders(headerTable As DataTable, detailTable As DataTable)\n    For Each headerRow As DataRow In headerTable.Rows\n        ' Create a new dataset for each header\n        Dim reportDataset As New DataSet()\n        \n        ' Add the current header row to a new DataTable\n        Dim singleHeaderTable As DataTable = headerTable.Clone()  ' Clone structure\n        singleHeaderTable.ImportRow(headerRow)                     ' Import current row\n        reportDataset.Tables.Add(singleHeaderTable)\n        \n        ' Filter detail rows related to this header\n        Dim matchingDetailRows() As DataRow = detailTable.[Select]("HeaderID = " & headerRow("HeaderID"))  ' Adjust column name as needed\n        Dim singleDetailTable As DataTable = detailTable.Clone()\n        For Each row In matchingDetailRows\n            singleDetailTable.ImportRow(row)\n        Next\n        reportDataset.Tables.Add(singleDetailTable)\n\n        ' Load and set up the Crystal Report\n        Using reportDocument As New ReportDocument()\n            reportDocument.Load("YourReport.rpt")  ' Adjust path to your .rpt file\n\n            ' Set the data source\n            reportDocument.SetDataSource(reportDataset)\n            \n            ' Display or export the report as needed\n            ' For example, to display in a CrystalReportViewer:\n            ' yourCrystalReportViewer.ReportSource = reportDocument\n            \n        End Using\n    Next\nEnd Sub