Dim client As New TcpClient()\nclient.Connect(server, port)\n\nTry\n    Dim stream As NetworkStream = client.GetStream()\n    \n    ' Write request to server...\n    stream.Write(request)\n    \n    ' Buffer for receiving data chunks\n    Dim buffer(1024) As Byte\n    Dim totalDataReceived As New System.IO.MemoryStream()\n    \n    ' Read the response from the stream in a loop until we receive all of it\n    While True\n        Dim bytesRead As Integer = stream.Read(buffer, 0, buffer.Length)\n        \n        If bytesRead <= 0 Then\n            Exit While ' No more data available\n        End If\n        \n        totalDataReceived.Write(buffer, 0, bytesRead)\n        \n        ' Optionally handle end condition here (e.g., check if we received a full XML document)\n    End While\n    \n    ' Convert the entire response to a string and process it\n    Dim responseData As String = System.Text.Encoding.UTF8.GetString(totalDataReceived.ToArray())\n    \n    ' Output response data or return results...\nFinally\n    client.Close() ' Ensure connection is closed after use\nEnd Try