Imports System.Globalization\n\nFunction GetIosYearAndWeek(dateValue As DateTime) As String\n    Dim calendar = CultureInfo.InvariantCulture.Calendar\n    Dim weekOfYear = calendar.GetWeekOfYear(dateValue, CalendarWeekRule.FirstFourDayWeek, DayOfWeek.Monday)\n    ' Adjust for ISO week if the week starts on Thursday or later\n    If dateValue.DayOfWeek >= DayOfWeek.Thursday Then\n        weekOfYear += 1\n    End If\n\n    ' Find the Saturday of this week\n    Dim daysUntilSaturday = (7 - (dateValue.DayOfWeek + 2) Mod 7) Mod 7\n    Dim saturdayOfTheWeek = dateValue.AddDays(daysUntilSaturday)\n\n    ' Adjust year if necessary\n    Dim weekYear As Integer\n    If weekOfYear > calendar.GetWeekOfYear(saturdayOfTheWeek, CalendarWeekRule.FirstFourDayWeek, DayOfWeek.Monday) Then\n        weekYear = dateValue.Year - 1\n    ElseIf weekOfYear < calendar.GetWeekOfYear(saturdayOfTheWeek.AddDays(-7), CalendarWeekRule.FirstFourDayWeek, DayOfWeek.Monday) Then\n        weekYear = dateValue.Year + 1\n    Else\n        weekYear = dateValue.Year\n    End If\n\n    Return String.Format("{0:D2}{1:D2}", weekYear Mod 100, weekOfYear)\nEnd Functio