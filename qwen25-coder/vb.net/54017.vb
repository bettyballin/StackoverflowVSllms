Imports System.Data.SqlClient\n\nPublic Function GetList(Of T As New)(commandText As String, Optional parameters As SqlParameter() = Nothing) As List(Of T)\n    Dim list As New List(Of T)()\n    Using connection As New SqlConnection("Your Connection String Here")\n        Using command As New SqlCommand(commandText, connection)\n            If Not parameters Is Nothing Then\n                command.Parameters.AddRange(parameters)\n            End If\n\n            connection.Open()\n            Using reader As SqlDataReader = command.ExecuteReader()\n                While reader.Read()\n                    Dim item As T = Activator.CreateInstance(Of T)()\n\n                    For i As Integer = 0 To reader.FieldCount - 1\n                        Dim propertyInfo = GetType(T).GetProperty(reader.GetName(i))\n                        If Not propertyInfo Is Nothing Then\n                            Dim value = If(reader.IsDBNull(i), Nothing, reader.GetValue(i))\n                            propertyInfo.SetValue(item, Convert.ChangeType(value, propertyInfo.PropertyType), Nothing)\n                        End If\n                    Next\n\n                    list.Add(item)\n                End While\n            End Using\n        End Using\n    End Using\n    Return list\nEnd Functio