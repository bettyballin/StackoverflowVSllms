Option Explicit\n\nSub DeclareDllFunction()\n    Dim dllPath As String\n    dllPath = ThisWorkbook.Path & "\Fcall.dll"\n    \n    ' Use Alias to specify the full path in the Declare statement\n    Call FortranCall(dllPath)\nEnd Sub\n\n' You declare the function using a procedure, not directly with the dynamic path.\nDeclare Sub FortranCall Lib "Fcall.dll" (r1 As Long, ByVal num As String)\n\nSub TestFortranCall()\n    Dim returnValue As Long\n    Dim numberString As String\n    \n    numberString = "42"\n    \n    ' Call the function - update parameters as needed for your use case.\n    FortranCall returnValue, numberString\nEnd Sub