Private Function SerializeData(ByVal data As cData) As String\n    If data IsNot Nothing Then\n        Dim xml_stream As New MemoryStream()\n        Dim sr As StreamReader = Nothing\n        Dim xs As New XmlSerializer(GetType(cData))\n        \n        Dim settings As New XmlWriterSettings()\n        settings.OmitXmlDeclaration = True ' Optional: if you don't want <?xml version="1.0"?>\n        settings.Indent = False\n\n        Try\n            Using writer As XmlWriter = XmlWriter.Create(xml_stream, settings)\n                xs.Serialize(writer, data)\n                xml_stream.Position = 0\n                sr = New StreamReader(xml_stream)\n                Return sr.ReadToEnd()\n            End Using\n        Finally\n            If sr IsNot Nothing Then sr.Close()\n            xml_stream.Close()\n        End Try\n\n    Else\n        Return "No data"\n    End If\nEnd Functio