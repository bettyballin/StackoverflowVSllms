Private Sub AppendWithoutLosingSelection(ByVal newText As String)\n    ' Save current selection\n    Dim selStart As Integer = txtchat.SelectionStart\n    Dim selLength As Integer = txtchat.SelectionLength\n\n    ' Begin updating without blinking or events\n    StopRepaint()\n\n    ' Append new text\n    txtchat.AppendText(newText)\n\n    ' Check if the text was selected normally (not reverse)\n    If selStart >= 0 AndAlso selStart + selLength <= txtchat.Text.Length Then\n        ' Adjust selection start if appending at current selection end\n        If selStart = selStart + selLength Then\n            txtchat.SelectionStart = selStart + newText.Length\n        Else\n            txtchat.SelectionStart = selStart\n        End If\n\n        ' Set the length of the selection\n        txtchat.SelectionLength = selLength\n    End If\n\n    ' Finish updating and refresh control\n    StartRepaint()\nEnd Sub