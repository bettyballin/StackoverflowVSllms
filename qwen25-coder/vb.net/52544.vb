Imports System.Data.SqlClient\n\nPublic Sub ExecuteSqlScript(connectionString As String, sqlScriptPath As String)\n    Dim scriptContent As String = File.ReadAllText(sqlScriptPath)\n    Dim commandTexts As New List(Of String)()\n    Dim currentCommand As StringBuilder = New StringBuilder()\n\n    For Each line In scriptContent.Split(Environment.NewLine.ToCharArray(), StringSplitOptions.RemoveEmptyEntries)\n        If line.TrimStart().ToUpperInvariant() = "GO" Then\n            If currentCommand.Length > 0 Then\n                commandTexts.Add(currentCommand.ToString())\n                currentCommand.Clear()\n            End If\n        Else\n            currentCommand.AppendLine(line)\n        End If\n    Next\n\n    ' Add the last batch if it exists\n    If currentCommand.Length > 0 Then\n        commandTexts.Add(currentCommand.ToString())\n    End If\n\n    Using con As New SqlConnection(connectionString)\n        con.Open()\n        For Each batch In commandTexts\n            Using cmd As New SqlCommand(batch, con)\n                cmd.ExecuteNonQuery()\n            End Using\n        Next\n        con.Close()\n    End Using\nEnd Sub