Protected Sub GridView1_RowDataBound(sender As Object, e As GridViewRowEventArgs) Handles GridView1.RowDataBound\n    If e.Row.RowType = DataControlRowType.DataRow Then\n        Dim deptvalue As String\n        Dim ddlmgr As New DropDownList\n\n        ddlmgr.ID = "DropDownList" & e.Row.RowIndex ' Set a unique ID for each DropDownList\n        ddlmgr.AutoPostBack = True\n        AddHandler ddlmgr.SelectedIndexChanged, AddressOf ddlmgr_SelectedIndexChanged\n\n        ddlmgr.Items.Clear()\n        ddlmgr.Items.Insert(0, "--Select a Manager--")\n        ddlmgr.AppendDataBoundItems = True\n        ddlmgr.DataTextField = "Name"\n        ddlmgr.DataValueField = "number"\n        ddlmgr.DataSource = SqlDataSource2\n        ddlmgr.DataBind()\n\n        deptvalue = DirectCast(e.Row.FindControl("YourDeptLabelID"), Label).Text ' Replace with your actual control type and ID\n        ddlmgr.Attributes.Add("onchange", "setDepart('" & deptvalue & "')")\n\n        e.Row.Cells(2).Controls.Add(ddlmgr)\n    End If\nEnd Sub\n\nProtected Sub ddlmgr_SelectedIndexChanged(sender As Object, e As EventArgs)\n    Dim ddl As DropDownList = DirectCast(sender, DropDownList)\n    Dim row As GridViewRow = DirectCast(ddl.NamingContainer, GridViewRow)\n\n    ' Get the row ID or any other information you need\n    Dim rowId As Integer = Convert.ToInt32(GridView1.DataKeys(row.RowIndex).Value) ' Ensure DataKeyNames is set in your GridView\n\n    ' Use ddl.SelectedItem.Value and rowId as needed\nEnd Sub