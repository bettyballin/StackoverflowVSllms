Sub WriteToCSV(filePath As String, dataTable As DataTable)\n    Using writer As New System.IO.StreamWriter(filePath)\n        ' Write headers (column names)\n        Dim headerLine = String.Join(",", From col In dataTable.Columns Select col.ColumnName)\n        writer.WriteLine(headerLine)\n\n        ' Write data rows\n        For Each row As DataRow In dataTable.Rows\n            Dim fields() = Array.ConvertAll(row.ItemArray, Function(item) item.ToString())\n            writer.WriteLine(String.Join(",", fields))\n        Next\n    End Using\nEnd Sub