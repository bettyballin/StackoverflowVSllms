Function ConvertStringToInteger(sText As String, bThrowErrorIfInvalid As Boolean) As Integer\n    Dim nInteger As Integer = 0\n\n    If sText IsNot Nothing AndAlso Not String.IsNullOrWhiteSpace(sText) Then\n        If Not Integer.TryParse(sText, nInteger) Then\n            If bThrowErrorIfInvalid Then\n                Throw New ArgumentException("The provided string cannot be converted to an integer.")\n            End If\n        End If\n    ElseIf bThrowErrorIfInvalid Then\n        Throw New ArgumentNullException("sText", "The text is null or empty and cannot be converted to an integer.")\n    End If\n\n    Return nInteger\nEnd Functio