Sub CreatePivotTable()\n    Dim db As DAO.Database\n    Dim qdf As DAO.QueryDef\n    Dim rs As DAO.Recordset\n    Dim xlApp As Object 'Excel.Application\n    Dim xlWB As Object 'Excel.Workbook\n    Dim xlWS As Object 'Excel.Worksheet\n    Dim ptCache As Object 'Excel.PivotCache\n    Dim pt As Object 'Excel.PivotTable\n\n    Set db = CurrentDb()\n    Set rs = db.OpenRecordset("SELECT * FROM YourDataTable", dbOpenSnapshot)\n\n    ' Create Excel Application and Workbook\n    Set xlApp = CreateObject("Excel.Application")\n    xlApp.Visible = True ' Make it visible if you want to debug, set to False in production\n    Set xlWB = xlApp.Workbooks.Add()\n    Set xlWS = xlWB.Sheets(1)\n    \n    ' Copy data from Recordset to Excel Worksheet\n    With rs.Fields\n        For i = 0 To .Count - 1\n            xlWS.cells(1, i + 1).Value = .Item(i).Name\n        Next i\n    End With\n    \n    For iRow = 2 To rs.RecordCount + 1\n        xlWS.Range(xlWS.Cells(iRow, 1), xlWS.Cells(iRow, rs.Fields.Count)).value = rs.GetRows(1)\n    Next iRow\n\n    ' Create Pivot Cache and Table\n    Set ptCache = xlWB.PivotCaches.Create(SourceType:=2, SourceData:=xlWS.UsedRange)\n    Set pt = ptCache.CreatePivotTable(TableDestination:=xlWS.Cells(15, 1), TableName:="YourPivotTable")\n\n    ' Add fields to the PivotTable\n    With pt.PivotFields("FieldNameForRows")\n        .Orientation = 1\n        .Position = 1\n    End With\n    \n    With pt.PivotFields("FieldNameForData")\n        .Orientation = 4\n        .Function = -4112 ' xlSum\n    End With\n\n    rs.Close\n    Set rs = Nothing\n    Set db = Nothing\nEnd Sub