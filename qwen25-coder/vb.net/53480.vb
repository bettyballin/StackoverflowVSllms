Imports System.Runtime.CompilerServices\n\n<Extension()>\nPublic Sub SessionSingleton(Of T As New)(ByRef ClassObject As T)\n    Dim objType As Type = GetType(T)\n    Dim sessionName As String = objType.FullName\n\n    If HttpContext.Current.Session(sessionName) IsNot Nothing AndAlso TypeOf HttpContext.Current.Session(sessionName) Is T Then\n        ClassObject = CType(HttpContext.Current.Session(sessionName), T)\n    Else\n        Dim singleton As T = DirectCast(Activator.CreateInstance(objType), T)\n        HttpContext.Current.Session(sessionName) = singleton\n        ClassObject = singleton\n    End If\nEnd Sub