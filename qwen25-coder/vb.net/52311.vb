Public Function GetNextNonDuplicateNumber(NumberToCheck As Long) As Long\n\n    Dim NonDuplicate As Long\n    Dim IsDuplicate As Boolean = True\n        \n    Try\n        While IsDuplicate\n            If CheckForDuplicate(NumberToCheck) Then\n                Throw New DuplicateException()\n            Else\n                NonDuplicate = NumberToCheck\n                IsDuplicate = False\n            End If\n        End While\n    Catch ex As DuplicateException\n        ' Handle the exception by incrementing the number and trying again\n        NumberToCheck = IncrementToNonDuplicateValue(NumberToCheck)\n        ' Repeat the check with the new number value\n        NonDuplicate = GetNextNonDuplicateNumber(NumberToCheck) ' Recursive call\n    End Try\n\n    Return NonDuplicate\nEnd Functio