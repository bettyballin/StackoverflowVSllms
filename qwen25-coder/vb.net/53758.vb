Imports System.DirectoryServices.AccountManagement\n\nPublic Function IsUserInGroup(userDomain As String, userName As String, groupDomain As String, groupName As String) As Boolean\n    Using context As New PrincipalContext(ContextType.Domain, userDomain)\n        Dim userPrincipal As UserPrincipal = UserPrincipal.FindByIdentity(context, IdentityType.SamAccountName, userName)\n        Dim groupPrincipal As GroupPrincipal = GroupPrincipal.FindByIdentity(context, IdentityType.SamAccountName, groupName)\n\n        If userPrincipal IsNot Nothing AndAlso groupPrincipal IsNot Nothing Then\n            Return userPrincipal.IsMemberOf(groupPrincipal)\n        End If\n    End Using\n\n    Return False\nEnd Functio