Imports System.Data.SqlClient\n\nPublic Sub SaveAndRollbackExample()\n    Dim connectionString As String = "YourConnectionStringHere"\n    Using connection As New SqlConnection(connectionString)\n        Try\n            connection.Open()\n            Dim transaction As SqlTransaction = connection.BeginTransaction()\n\n            ' Execute Procedure1 and get the generated ID\n            Dim id As Integer\n            Using command1 As New SqlCommand("Procedure1", connection, transaction)\n                command1.CommandType = CommandType.StoredProcedure\n                ' Add parameters for Procedure1 if any\n                Dim outputIdParam As New SqlParameter("@GeneratedID", SqlDbType.Int) With {\n                    .Direction = ParameterDirection.Output\n                }\n                command1.Parameters.Add(outputIdParam)\n                command1.ExecuteNonQuery()\n                id = CInt(outputIdParam.Value)\n            End Using\n\n            ' Execute Procedure2 using the generated ID\n            Using command2 As New SqlCommand("Procedure2", connection, transaction)\n                command2.CommandType = CommandType.StoredProcedure\n                ' Add parameters for Procedure2\n                command2.Parameters.AddWithValue("@ID", id)\n                command2.ExecuteNonQuery()\n            End Using\n\n            ' Execute Procedure3 using the generated ID\n            Using command3 As New SqlCommand("Procedure3", connection, transaction)\n                command3.CommandType = CommandType.StoredProcedure\n                ' Add parameters for Procedure3\n                command3.Parameters.AddWithValue("@ID", id)\n                command3.ExecuteNonQuery()\n            End Using\n\n            ' Commit the transaction if all operations are successful\n            transaction.Commit()\n\n        Catch ex As SqlException\n            ' Rollback transaction in case of exceptions\n            If connection.State = ConnectionState.Open AndAlso transaction IsNot Nothing Then\n                transaction.Rollback()\n            End If\n            Console.WriteLine("Transaction Failed: " & ex.Message)\n        End Try\n    End Using\nEnd Sub