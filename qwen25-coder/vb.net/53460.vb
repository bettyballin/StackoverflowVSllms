Dim oApp\nSet oApp = CreateObject("hMailServer.Application")\noApp.Authenticate "Administrator", "<YourAdminPassword>"\n\nDim oMessage\nSet oMessage = CreateObject("hMailServer.Message")\n\nDo While oMessage.LoadMessageFromFile(Wscript.Arguments(0))\n    ' Extract the recipient part of the email address.\n    Dim sRecipient, sKey, nStartPos, nEndPos\n    sRecipient = LCase(oMessage.ToAddresses.ItemByIndex(0).Address)\n    \n    nStartPos = InStr(sRecipient, "item-") + 5\n    nEndPos = InStr(nStartPos, sRecipient, "@")\n    sKey = Mid(sRecipient, nStartPos, nEndPos - nStartPos)\n    \n    ' Connect to your database and get the recipients.\n    ' This part depends on your database and its interface.\n    Dim aRecipients\n    aRecipients = GetEmailAddressesFromDB(sKey) ' Implement this function based on your DB access method.\n    \n    ' Resend the email to all intended recipients.\n    For Each sAddr In aRecipients\n        oMessage.AddRecipientByAddress "", sAddr, False, True\n    Next\n    \n    ' Send the message via hMailServer's SMTP service.\n    Call oMessage.SaveAndQueue()\n    Set oMessage = Nothing\nLoop\n\nFunction GetEmailAddressesFromDB(itemKey)\n    ' Implement database access logic here.\n    ' Return an array of email addresses for the specified item key.\nEnd Functio