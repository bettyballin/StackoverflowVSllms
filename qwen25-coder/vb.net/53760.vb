Private Sub UpdateWebBrowser(htmlContent As String)\n    If browser.InvokeRequired Then\n        browser.Invoke(Sub() UpdateWebBrowser(htmlContent))\n    Else\n        ' Ensure the webbrowser control is ready.\n        If browser.ReadyState = WebBrowserReadyState.Complete Then\n            browser.Document.OpenNew(True)\n            browser.Document.Write(htmlContent)\n        End If\n    End If\nEnd Sub