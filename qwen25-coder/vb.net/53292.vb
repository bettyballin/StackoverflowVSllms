public class AdminDatabase\n    Private strAdminConnection As String\n\n    Public Sub New(adminName As String)\n        ' Set up connection string based on user selection\n        Dim conAdminDB = New OleDbConnection()\n        conAdminDB.ConnectionString = "Data Source='" & adminName & "';Provider=Microsoft.ACE.OLEDB.12.0"\n        strAdminConnection = conAdminDB.ConnectionString.ToString()\n        My.Settings.AdminConnectionString = strAdminConnection ' Update the setting if needed\n    End Sub\n\n    Public Function getDataTable(ByVal sqlStatement As String) As DataTable\n        Dim dt As New DataTable()\n\n        Using localCon As New OleDbConnection(strAdminConnection)\n            Using command As New OleDbCommand(sqlStatement, localCon)\n                localCon.Open()\n                Using da As New OleDbDataAdapter(command)\n                    da.Fill(dt)\n                End Using\n            End Using\n        End Using\n\n        Return dt\n    End Function\n\n    Public Sub FillDataSet(dataSet As YourTypedDataSetType, tableName As String)\n        Using con As New OleDbConnection(strAdminConnection)\n            Using da As New OleDbDataAdapter($"SELECT * FROM {tableName}", con)\n                dataSet.Tables(tableName).Clear()\n                da.Fill(dataSet, tableName)\n            End Using\n        End Using\n    End Sub\n\n    Public Function UpdateDataSet(dataSet As YourTypedDataSetType, tableName As String) As Integer\n        Dim adapter As New OleDbDataAdapter($"SELECT * FROM {tableName}", strAdminConnection)\n        Dim builder As New OleDbCommandBuilder(adapter)\n        Return adapter.Update(dataSet.Tables(tableName))\n    End Function\nEnd Class