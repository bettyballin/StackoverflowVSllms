Private Sub Btnundo_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnundo.Click\n    If Not btnredo.Enabled Then btnredo.Enabled = True\n    redo.Push(Image.Clone())\n    Image = undo.Pop()\n\n    ' Recreate the Graphics object for the new Image\n    GraphFun.Dispose() ' Dispose of old graphics object to free resources\n    GraphFun = Graphics.FromImage(Image)\n\n    PictureBox1.Image = Image\n    If undo.Count = 0 Then\n        btnundo.Enabled = False\n    End If\nEnd Sub\n\nPrivate Sub btnredo_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnredo.Click\n    If Not btnundo.Enabled Then btnundo.Enabled = True\n    undo.Push(Image.Clone())\n    Image = redo.Pop()\n\n    ' Recreate the Graphics object for the new Image\n    GraphFun.Dispose() ' Dispose of old graphics object to free resources\n    GraphFun = Graphics.FromImage(Image)\n\n    PictureBox1.Image = Image\n    If redo.Count = 0 Then btnredo.Enabled = False\nEnd Sub