Imports System.Web\n\n   Public Class CommonWebMethodModule\n       Implements IHttpModule\n\n       Public Sub Dispose() Implements IHttpModule.Dispose\n           ' Clean-up code here if needed\n       End Sub\n\n       Public Sub Init(context As HttpApplication) Implements IHttpModule.Init\n           AddHandler context.EndRequest, AddressOf OnEndRequest\n       End Sub\n\n       Private Sub OnEndRequest(sender As Object, e As EventArgs)\n           Dim application = DirectCast(sender, HttpApplication)\n           Dim request = application.Request\n           Dim response = application.Response\n\n          	If DebugFlagEnabled(request) Then\n               System.Threading.Thread.Sleep(2000)\n           End If\n       End Sub\n\n       Private Function DebugFlagEnabled(request As HttpRequest) As Boolean\n           ' Check if the debug flag should be enabled, e.g., conditional compilation symbol or app setting\n          #If DEBUG Then\n              Return True\n          #Else\n              ' You could also use a configuration setting here to control debugging behavior in production\n              Return False\n          #End If\n       End Function\n   End Class