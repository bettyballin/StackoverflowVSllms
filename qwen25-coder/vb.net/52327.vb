Private _includeTime As Boolean\nPrivate Const DTViewStateKey = "DateTimeValue"\n\nPublic Property IncludeTime() As Boolean\n    Get\n        Return _includeTime\n    End Get\n    Set(ByVal value As Boolean)\n        _includeTime = value\n    End Set\nEnd Property\n\nPublic Property SelectedDateTime() As DateTime\n    Get\n        Dim storedValue As Object = ViewState(DTViewStateKey)\n        If storedValue IsNot Nothing Then\n            Try\n                Return DirectCast(storedValue, DateTime)\n            Catch ex As Exception\n                ' Log and handle exception if necessary\n            End Try\n        End If\n\n        ' Fallback parsing logic (useful on initial page load or setting from external source)\n        Dim parsedDateTime As DateTime = Nothing\n        Try\n            parsedDateTime = DateTime.Parse(txtDate.Text)\n            If IncludeTime Then\n                parsedDateTime = parsedDateTime.Date.AddHours(Short.Parse(txtHour.Text))\n                parsedDateTime = parsedDateTime.AddMinutes(Short.Parse(txtMinute.Text))\n                parsedDateTime = parsedDateTime.AddSeconds(Short.Parse(txtSecond.Text))\n            End If\n        Catch ex As Exception\n            ' Log and handle exception if necessary\n        End Try\n\n        Return parsedDateTime\n    End Get\n    Set(ByVal value As DateTime)\n        ViewState(DTViewStateKey) = value\n    End Set\nEnd Property