Sub GetDataFromADO()\n    ' Declare variables\n    Dim objMyConn As ADODB.Connection\n    Dim objMyCmd As ADODB.Command\n    Dim objMyRecordset As ADODB.Recordset\n\n    Set objMyConn = New ADODB.Connection\n    Set objMyCmd = New ADODB.Command\n    Set objMyRecordset = New ADODB.Recordset\n\n    On Error GoTo ErrorHandler\n\n    ' Open Connection\n    objMyConn.ConnectionString = "Provider=SQLOLEDB;Data Source=localhost;User ID=abc;Password=abc;"\n    objMyConn.Open\n\n    ' Set and Execute SQL Command\n    With objMyCmd\n        .ActiveConnection = objMyConn\n        .CommandText = "SELECT * FROM myTable"\n        .CommandType = adCmdText\n    End With\n    \n    ' Open Recordset\n    objMyRecordset.Open objMyCmd, , adOpenForwardOnly, adLockReadOnly\n\n    ' Check if the recordset is not empty and copy data to Excel\n    If Not objMyRecordset.EOF Then\n        ActiveSheet.Range("A1").CopyFromRecordset objMyRecordset\n    Else\n        MsgBox "No records found.", vbInformation\n    End If\n\n    ' Clean up\n    objMyRecordset.Close\n    Set objMyRecordset = Nothing\n    objMyConn.Close\n    Set objMyConn = Nothing\n    Set objMyCmd = Nothing\n\n    Exit Sub\n\nErrorHandler:\n    If Not objMyRecordset Is Nothing Then\n        If objMyRecordset.State = adStateOpen Then objMyRecordset.Close\n        Set objMyRecordset = Nothing\n    End If\n    If Not objMyConn Is Nothing Then\n        If objMyConn.State = adStateOpen Then objMyConn.Close\n        Set objMyConn = Nothing\n    End If\n    MsgBox "An error occurred: " & Err.Description, vbCritical\n    \nEnd Sub