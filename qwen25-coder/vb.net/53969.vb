Imports System.Management\n\nPublic Shared Function GetUniversalName(ByVal sFilePath As String) As String\n    If String.IsNullOrEmpty(sFilePath) OrElse sFilePath.IndexOf(":") < 0 Then\n        Return sFilePath\n    End If\n\n    If sFilePath.StartsWith("\\") Then\n        Return New Uri(sFilePath).ToString()\n    End If\n\n    Try\n        Dim driveLetter = sFilePath.Substring(0, 2)\n        Dim searcher As New ManagementObjectSearcher("SELECT RemoteName FROM Win32_NetworkConnection WHERE LocalName = '" & driveLetter & "'")\n        For Each managementObject As ManagementObject In searcher.Get()\n            Dim remoteName As String = DirectCast(managementObject("RemoteName"), String)\n            Return New Uri(remoteName & sFilePath.Substring(2)).ToString()\n        Next\n    Catch ex As Exception\n        ' Handle exceptions if any occur (e.g., WMI access denied, etc.)\n        Console.WriteLine("An error occurred: " & ex.Message)\n    End Try\n\n    Return sFilePath\nEnd Functio