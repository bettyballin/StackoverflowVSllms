Function GuidToBase64(ByVal guid As Guid) As String\n    ' Convert GUID to Base64 string and replace characters for URL safety\n    Return Convert.ToBase64String(guid.ToByteArray).Replace("/", "-").Replace("+", "_").Replace("=", "")\nEnd Function\n\nFunction Base64ToGuid(ByVal base64 As String) As Guid\n    Try\n        ' Restore Base64 padding and character replacements for URL safety\n        base64 = base64.Replace("-", "/").Replace("_", "+")\n        Select Case base64.Length Mod 4\n            Case 2 : base64 &= "=="\n            Case 3 : base64 &= "="\n        End Select\n\n        ' Convert Base64 string back to GUID\n        Return New Guid(Convert.FromBase64String(base64))\n    Catch ex As FormatException\n        Throw New InvalidOperationException("Invalid Base64 format for GUID conversion.", ex)\n    Catch ex As ArgumentException\n        Throw New InvalidOperationException("Unable to convert Base64 to GUID.", ex)\n    End Try\nEnd Functio