' Create the client once and reuse it for all operations.\nDim client As ProductServiceClient = New ProductServiceClient("WsHttpWithSession")\nclient.ClientCredentials.UserName.UserName = "foo"\nclient.ClientCredentials.UserName.Password = "bar"\n\nTry\n    Dim productList As List(Of Product) = client.GetProducts()\nCatch ex As CommunicationException\n    ' Handle communication errors and close the client gracefully.\nFinally\n    If client IsNot Nothing Then\n        Try\n            client.Close()\n        Catch ex As CommunicationException\n            client.Abort()\n        End Try\n    End If\nEnd Try