Dim _ClientSiteName As String = "sampleclient"\nDim _ManagedPathUrl As String = "/" & _ClientSiteName\n\nUsing _RootWeb As SPSite = New SPSite("http://myintranet")\n    Dim _webApp As SPWebApplication = _RootWeb.WebApplication\n\n    ' Ensure Managed Paths are added with elevated privileges\n    SPSecurity.RunWithElevatedPrivileges(Sub()\n                                              Using ElevatedRootSite As SPSite = New SPSite(_RootWeb.Url)\n                                                  Dim managedPaths As SPPrefixCollection = ElevatedRootSite.WebApplication.Prefixes\n                                                  \n                                                  If Not (managedPaths.Contains(_ManagedPathUrl)) Then\n                                                      managedPaths.Add(_ManagedPathUrl, SPPrefixType.ExplicitInclusion)\n                                                      _webApp.Update() ' Ensure updates are persisted to the DB\n                                                  End If\n                                              End Using\n                                          End Sub)\nEnd Using