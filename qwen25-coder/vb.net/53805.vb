Private Sub HighLightCurrentLine()\n    Dim rm As System.Text.RegularExpressions.MatchCollection\n    Dim m As System.Text.RegularExpressions.Match\n    Dim x As Integer ' Let's remember where the text cursor was before we mess with it\n\n    ' Get the current line number\n    Dim currentLineIndex As Integer = rtbMain.GetFirstCharIndexOfCurrentLine()\n    \n    ' Extract the current line text\n    Dim currentLineText As String = rtbMain.Lines(rtbMain.GetLineFromCharIndex(currentLineIndex))\n\n    ' Remember cursor position\n    x = rtbMain.SelectionStart\n\n    For Each pass In FrmColors.lb1.Items\n        rm = System.Text.RegularExpressions.Regex.Matches(LCase(currentLineText), LCase(pass))\n        For Each m In rm\n            ' Calculate the index of the match in the entire text\n            Dim startIndex As Integer = currentLineIndex + m.Index\n            rtbMain.Select(startIndex, m.Length)\n            rtbMain.SelectionColor = Color.Blue\n        Next\n    Next\n\n    ' Restore cursor position and color\n    rtbMain.Select(x, 0)\n    rtbMain.SelectionColor = Color.Black\nEnd Sub