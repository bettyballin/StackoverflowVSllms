Dim ListHours(23)\nFor i = 0 To 23\n    ListHours(i) = i\nNext\n\nList = ""\ncurrentHour = Hour(Now())\n\nFor h = 0 To 23\n    startTime = DateAdd("h", h - 24, Now())\n    endTime = DateAdd("h", h - 23, Now())\n    \n    SQL = "SELECT COUNT(DISTINCT VISITORIP) AS TOTALVISITS"\n    SQL = SQL & " FROM STATS"\n    SQL = SQL & " WHERE DATEENTERED >= #" & FormatDateTime(startTime, vbShortDate) & " " & FormatNumber(Hour(startTime), 0) & ":00:00# AND DATEENTERED < #" & FormatDateTime(endTime, vbShortDate) & " " & FormatNumber(Hour(endTime), 0) & ":00:00#"\n    \n    Set objVisits = objConn.Execute(SQL)\n    \n    If Not objVisits.EOF Then\n        List = List & "[" & h & "," & objVisits("TOTALVISITS") & "],"\n    End If\n    \n    objVisits.Close\nNext\n\nResponse.Write Left(List, Len(List) - 1) ' Trim the last comma