Function Display(ByVal id As Guid) As FileStreamResult\n    Dim db As New EfrDotOrgEntities\n    Dim Model As ZackFile = (From z As ZackFile In db.ZackFile _\n                            Where z.Id = id _\n                            Select z).First\n\n    Dim ByteArray As Byte() = Model.FileData\n    Dim FileStream As System.IO.MemoryStream = New System.IO.MemoryStream(ByteArray)\n\n    ' Determine the content type using the file extension\n    Dim ContentType As String = System.Web.MimeMapping.GetMimeMapping(Model.FileName)\n    \n    If String.IsNullOrEmpty(ContentType) Then\n        ContentType = "application/octet-stream"  ' Default for unknown types\n    End If\n\n    Dim f As New FileStreamResult(FileStream, ContentType)\n    f.FileDownloadName = Model.FileName\n    Return f\nEnd Functio