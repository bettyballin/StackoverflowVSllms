Public Class App\n    Inherits Application\n\n    Protected Overrides Sub OnStartup(e As StartupEventArgs)\n        AddHandler Application.Current.DispatcherUnhandledException, AddressOf OnDispatcherUnhandledException\n        MyBase.OnStartup(e)\n    End Sub\n\n    Private Sub OnDispatcherUnhandledException(sender As Object, e As DispatcherUnhandledExceptionEventArgs)\n        Dim exception = e.Exception\n        MessageBox.Show("An unhandled exception just occurred: " & exception.Message, _\n                        "Exception Sample", MessageBoxButton.OK, MessageBoxImage.Error)\n        \n        ' Prevent default unhandled exception processing:\n        e.Handled = True\n    End Sub\n\nEnd Class