' Interface for WebPart connection\nPublic Interface IDiaryPartsProvider\n    Function Test() As String\nEnd Interface\n\n' Provider UserControl\nPartial Public Class UsrCtrls_Diary_Diary_Summary\n    Inherits System.Web.UI.UserControl\n    Implements IWebPart, IDiaryPartsProvider\n\n    <ConnectionProvider("Test", "myID")> _\n    Public Function Test() As String Implements IDiaryPartsProvider.Test\n        Return "this is a test"\n    End Function\nEnd Class\n\n' Consumer UserControl\nPartial Public Class UsrCtrls_Diary_ucl_DiaryAwaitingReview\n    Inherits System.Web.UI.UserControl\n\n    <ConnectionConsumer("Test", "myID")> _\n    Public Sub GetTextTransferInterface(ByVal provider As IDiaryPartsProvider)\n        Dim a As String = provider.Test()\n        UserMsgBox(a.ToString, Me.Page) ' Ensure this method exists or replace with appropriate action\n    End Sub\nEnd Class