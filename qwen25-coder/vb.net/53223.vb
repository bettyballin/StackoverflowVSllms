Imports Rhino.Mocks\n\nPublic Class LookUp\n    Public Property PropertyName As String\n    Public Function GetLookUpByName(name As String) As LookUp\n        ' Real implementation would go here\n        Return Nothing\n    End Function\nEnd Class\n\nModule Module1\n    Sub Main()\n        Dim mocks = New MockRepository()\n        Dim _lookup = mocks.DynamicMock(Of LookUp)()\n\n        Expect.Call(Function() _lookup.GetLookUpByName("test")).Return(_lookup).Do(Sub()\n                                                                                      _lookup.PropertyName = "value"\n                                                                                  End Sub)\n\n        mocks.ReplayAll()\n\n        ' Act\n        Dim result = _lookup.GetLookUpByName("test")\n\n        ' Assert\n        Console.WriteLine(result.PropertyName) ' Should output "value"\n\n        mocks.VerifyAll()\n    End Sub\nEnd Module