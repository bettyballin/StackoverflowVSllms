Sub Main()\n    ' Your existing code here\n\n    ' Example of a time-consuming task\n    Call PerformTask()\n\n    ' Ensure the application stays open until the task is completed\n    Do While Not TaskFinished\n        DoEvents ' Allow Windows messages to be processed\n        Sleep 100 ' Wait for 100 milliseconds\n    Loop\n\nEnd Sub\n\nSub PerformTask()\n    ' Simulate a time-consuming task\n    ' Make sure you set TaskFinished = True when the task is actually finished\n    TaskFinished = False\n    ' ... perform your operations here ...\n    TaskFinished = True\nEnd Sub