Public Shared Function GetItems(ByVal itemsList As List(Of OrderItem), ByVal whichForm As ItemsFor, ByVal formID As Integer) As List(Of OrderItem)\n    Dim propertyName As String = ""\n\n    Select Case whichForm\n        Case ItemsFor.MfrCredit : propertyName = "ManufacturerCreditID"\n        Case ItemsFor.CustomerCredit : propertyName = "CustomerCreditID"\n        Case ItemsFor.Invoice : propertyName = "InvoiceID"\n        Case ItemsFor.PurchaseOrder : propertyName = "PurchaseOrderID"\n        Case ItemsFor.Quote : propertyName = "QuoteID"\n        Case ItemsFor.StockingOrder : propertyName = "StockingOrderID"\n    End Select\n\n    If Not String.IsNullOrEmpty(propertyName) Then\n        Dim query = itemsList.Where(Function(oi) oi.GetType().GetProperty(propertyName).GetValue(oi).Equals(formID))\n        Return query.ToList()\n    Else\n        Return New List(Of OrderItem)\n    End If\nEnd Functio