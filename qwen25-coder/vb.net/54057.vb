Public Class MyClass\n    Private WithEvents serviceMonitor As COMOBJECT.ServiceMonitor\n\n    Public Sub New()\n        serviceMonitor = New COMOBJECT.ServiceMonitor()\n        AddHandler CType(DirectCast(serviceMonitor, System.ComponentModel.ISupportInitializeEvents), _\n                         COMOBJECT._IServiceMonitorEvents).ServiceConnectionUp, _ \n                            AddressOf ServiceMonitor_ServiceConnectionUp\n        serviceMonitor.Connect([some ip address])\n    End Sub\n\n    Private Sub ServiceMonitor_ServiceConnectionUp(ByVal MonitorId As Integer, ByVal UserArg As Integer)\n        Debug.WriteLine("connection up!")\n    End Sub\n\n    ' other similar handlers omitted\nEnd Class