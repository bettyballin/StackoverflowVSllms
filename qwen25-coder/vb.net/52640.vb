' Function to count lines based on text content, font, and textbox width.\nPrivate Function GetNumberOfLines(txtBox As TextBox, pobjFont As Font) As Integer\n    Dim totalHeight As Integer = 0\n    Dim maxHeight As Integer = 32767 ' Set an arbitrary large height to measure all lines.\n    Dim formattedSize As SizeF\n\n    Using g As Graphics = txtBox.CreateGraphics()\n        ' Measure the text by limiting width and allowing any height.\n        formattedSize = g.MeasureString(txtBox.Text, pobjFont, New SizeF(txtBox.Width, maxHeight), Nothing)\n\n        ' Calculate number of lines based on the font's single line height\n        Dim lineHeight As Single = g.MeasureString("M", pobjFont).Height\n        Return CInt(Math.Round(formattedSize.Height / lineHeight))\n    End Using\nEnd Function\n\n' Usage in your existing method:\nDim piLines As Integer\npiLines = GetNumberOfLines(Me.Textbox2, pobjFont)