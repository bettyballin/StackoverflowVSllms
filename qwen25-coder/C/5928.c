int main(void)\n{\n    pam_handle_t *pamh = NULL;\n    int retval;\n\n    // Perform PAM authentication only once\n    if (!pamh) pamh = try_login("yourapp", &retval);\n\n    if (!pamh) {\n        fprintf(stderr, "Access denied.\n");\n        return 1;\n    }\n\n    const char *service, *username;\n    pam_get_item(pamh, PAM_SERVICE, (const void **) &service);\n    pam_get_item(pamh, PAM_USER,    (const void **) &username);\n\n    // Determine the role based on the environment variable set by the session module\n    FILE *fp = fopen("/tmp/" + username + "_role.env", "r");\n    char line[128];\n    while (fgets(line, sizeof(line), fp)) {\n        if (strstr(line, "ROLE=")) {\n            printf("Logged into %s as %s with role %s\n", service, username, strchr(line, '=') + 1);\n            break;\n        }\n    }\n    fclose(fp);\n\n    pam_close_session(pamh, 0);\n    pam_end          (pamh, retval);\n\n    return 0;\n}