static void\n   sheet_method_apply_cellarray (Sheet *sheet,\n                                 Cell **array,\n                                 gint size)\n   {\n     ASSERT(sheet != NULL);\n     g_return_if_fail(array != NULL);\n\n     gdk_threads_enter();\n\n     for (gint ii = 0; ii < size; ii++) {\n       const gchar* value_str = array[ii]->value->str;\n       gtk_sheet_set_cell_text(GTK_SHEET(sheet->gtk_sheet),\n                                 array[ii]->row,\n                                 array[ii]->column,\n                                 value_str);\n\n       if (!IS_NULLSTR(array[ii]->attributes.bgcolor->str))\n         sheet->range_set_background(sheet, &array[ii]->range, array[ii]->attributes.bgcolor->str);\n\n       if (!IS_NULLSTR(array[ii]->attributes.fgcolor->str))\n         sheet->range_set_foreground(sheet, &array[ii]->range, array[ii]->attributes.fgcolor->str);\n\n       // Clear all of the strings after GTK has accessed them\n       g_string_assign(array[ii]->value, "");\n       g_string_assign(array[ii]->attributes.bgcolor, "");\n       g_string_assign(array[ii]->attributes.fgcolor, "");\n     }\n\n     gdk_threads_leave();\n   }