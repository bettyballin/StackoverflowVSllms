#include <iostream>\n#include <libnetfilter_queue/libnetfilter_queue.h>\n\nstatic void cb(struct nfq_q_handle *qh, struct nfgenmsg *nfmsg,\n              struct nfq_data *nfa, void *data)\n{\n    // Process the packet here\n    uint32_t id = 0;\n    nfq_get_msg_packet_hdr(nfa, &id);\n\n    // Modify the packet data if necessary\n    // ...\n\n    // Verdict: Accept and reinject the packet\n    nfq_set_verdict(qh, id, NF_ACCEPT, 0, NULL);\n}\n\nint main()\n{\n    struct nfq_handle *h = nfq_open();\n    if (!h) {\n        fprintf(stderr, "error during nfq_open()\n");\n        exit(1);\n    }\n\n    struct nfq_q_handle *qh = nfq_create_queue(h, 1, &cb, NULL);\n    if (!qh) {\n        fprintf(stderr, "error during nfq_create_queue()\n");\n        exit(1);\n    }\n\n    if (nfq_set_mode(qh, NFQNL_COPY_PACKET, 0xffff) < 0) {\n        fprintf(stderr, "failed to set packet_copy mode\n");\n        exit(1);\n    }\n\n    fd_set fd;\n    int rv;\n    char buf[4096];\n\n    while ((rv = recv(nfq_fd(h), buf, sizeof(buf), 0)) && rv >= 0)\n    {\n        nfq_handle_packet(h, buf, rv);\n    }\n\n    nfq_destroy_queue(qh);\n    nfq_close(h);\n\n    return 0;\n}