#include <stdio.h>\n#include <stdlib.h>\n#include <gio/gio.h>\n\nstatic void handle_signal(GDBusConnection *conn, const gchar *sender_name,\n                         const gchar *object_path, const gchar *interface_name,\n                         const gchar *signal_name, GVariant *parameters,\n                         gpointer user_data) {\n    if (strcmp(signal_name, "UserNew") == 0 ||\n        strcmp(signal_name, "UserRemoved") == 0) {\n        printf("User session changed: %s\n", g_variant_get_type_string(parameters));\n    }\n}\n\nint main(int argc, char *argv[]) {\n    GMainLoop *loop;\n    GDBusConnection *conn;\n\n    loop = g_main_loop_new(NULL, FALSE);\n    conn = g_bus_get_sync(G_BUS_TYPE_SYSTEM, NULL, NULL);\n\n    g_dbus_connection_signal_subscribe(conn,\n                                       "org.freedesktop.login1",\n                                       "org.freedesktop.login1.Manager",\n                                       "UserNew",\n                                       "/org/freedesktop/login1",\n                                       NULL,\n                                       G_DBUS_SIGNAL_FLAGS_NONE,\n                                       handle_signal,\n                                       NULL,\n                                       NULL);\n\n    g_dbus_connection_signal_subscribe(conn,\n                                       "org.freedesktop.login1",\n                                       "org.freedesktop.login1.Manager",\n                                       "UserRemoved",\n                                       "/org/freedesktop/login1",\n                                       NULL,\n                                       G_DBUS_SIGNAL_FLAGS_NONE,\n                                       handle_signal,\n                                       NULL,\n                                       NULL);\n\n    printf("Starting to listen for session changes...\n");\n    g_main_loop_run(loop);\n    return 0;\n}