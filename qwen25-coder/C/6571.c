#include <stdlib.h>\n#include <string.h>\n\nunsigned char* add_padding_pkcs7(unsigned char* input, size_t length, size_t block_size) {\n    size_t pad_length = (block_size - (length % block_size)) % block_size;\n    unsigned char *result = malloc(length + pad_length);\n    if (!result) return NULL; // Memory allocation failed\n    memcpy(result, input, length);\n    memset(result + length, pad_length, pad_length);\n    return result;\n}\n\nsize_t remove_padding_pkcs7(unsigned char* data, size_t length) {\n    if (length == 0) return 0; // Edge case: empty data\n    unsigned char last_byte = data[length - 1];\n    if (last_byte > length || last_byte == 0) {\n        return length; // Invalid padding or no padding to remove\n    }\n    for (size_t i = length - last_byte; i < length; ++i) {\n        if (data[i] != last_byte) {\n            return length; // Padding is invalid\n        }\n    }\n    return length - last_byte;\n}