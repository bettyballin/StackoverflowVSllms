#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/sched/signal.h>\n#include <linux/fs_struct.h>\n#include <linux/fdtable.h>\n\nstatic void print_process_files(struct task_struct *task) {\n    struct files_struct *files = task->files;\n    if (!files)\n        return;\n\n    spin_lock(&files->file_lock);\n    for (unsigned int i = 0; i < files_fdtable(files)->max_fds; i++) {\n        struct file *file = fcheck_files(files, i);\n        if (file) {\n            printk(KERN_INFO "Process %d FD: %u File Offset: %lld\n",\n                    task->pid, i, file->f_pos);\n        }\n    }\n    spin_unlock(&files->file_lock);\n}\n\nstatic int __init list_open_files_init(void) {\n    struct task_struct *task;\n    rcu_read_lock();\n    for_each_process(task) {\n        printk(KERN_INFO "Iterating process: %d\n", task->pid);\n        print_process_files(task);\n    }\n    rcu_read_unlock();\n    return 0;\n}\n\nstatic void __exit list_open_files_exit(void) {\n    printk(KERN_INFO "Module unloaded.\n");\n}\n\nmodule_init(list_open_files_init);\nmodule_exit(list_open_files_exit);\n\nMODULE_LICENSE("GPL");\nMODULE_AUTHOR("Your Name");\nMODULE_DESCRIPTION("A simple module to list open files of all processes.");