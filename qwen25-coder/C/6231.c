// Example of a simple spin-lock using atomic operations in C (GCC/Clang)\n#include <stdatomic.h>\n\natomic_flag lock = ATOMIC_FLAG_INIT;\n\nvoid enter_critical_section() {\n    // Atomically set the flag to true, spinning until it succeeds.\n    while(atomic_flag_test_and_set(&lock))\n        ; // Spin-wait\n}\n\nvoid leave_critical_section() {\n    atomic_flag_clear(&lock); // Clear the lock\n}