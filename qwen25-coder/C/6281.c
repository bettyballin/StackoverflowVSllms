#include <windows.h>\n#include <wincrypt.h>\n#include <stdio.h>\n\n#pragma comment(lib, "advapi32.lib")\n\nint main() {\n    HCRYPTPROV hProv;\n    if (!CryptAcquireContext(&hProv, NULL, MS_DEF_DSS_DH_PROV, PROV_DSS_DH, CRYPT_VERIFYCONTEXT)) {\n        printf("CryptAcquireContext failed with error: %d\n", GetLastError());\n        return 1;\n    }\n\n    // Larger prime number for p and generator g\n    const BYTE p[] = {0x8D, 0x74, 0x6B, 0xED, 0x6C, 0xAF, 0xF3, 0xB9, 0xC2, 0xD1, 0x7E, 0xF5, 0xE5,\n                       0x8A, 0xC8, 0x7B, 0x2F, 0xDE, 0x4A, 0xF9, 0xF6, 0xA3, 0x8E, 0xB7, 0x9D, 0xF6,\n                       0x15, 0xED, 0xC6, 0x9C, 0x4E, 0x87}; // Example prime p\n    const BYTE g[] = {0x02}; // Generator g\n\n    CRYPT_DATA_BLOB pblob;\n    pblob.cbData = sizeof(p);\n    pblob.pbData = (BYTE*)p;\n\n    CRYPT_DATA_BLOB gblob;\n    gblob.cbData = sizeof(g);\n    gblob.pbData = (BYTE*)g;\n\n    HCRYPTKEY hKey;\n    if (!CryptGenKey(hProv, CALG_DH_SF, CRYPT_PREGEN, &hKey)) {\n        printf("CryptGenKey failed with error: %d\n", GetLastError());\n        CryptReleaseContext(hProv, 0);\n        return 1;\n    }\n\n    if (!CryptSetKeyParam(hKey, KP_P, (BYTE*)&pblob, 0)) {\n        printf("CryptSetKeyParam for KP_P failed with error: %d\n", GetLastError());\n        CryptDestroyKey(hKey);\n        CryptReleaseContext(hProv, 0);\n        return 1;\n    }\n\n    if (!CryptSetKeyParam(hKey, KP_G, (BYTE*)&gblob, 0)) {\n        printf("CryptSetKeyParam for KP_G failed with error: %d\n", GetLastError());\n        CryptDestroyKey(hKey);\n        CryptReleaseContext(hProv, 0);\n        return 1;\n    }\n\n    // Key generation successful\n    printf("Diffie-Hellman key generated successfully.\n");\n\n    CryptDestroyKey(hKey);\n    CryptReleaseContext(hProv, 0);\n\n    return 0;\n}