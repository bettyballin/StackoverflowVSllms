#include <stdio.h>\n#include <string.h>\n\n#define WINDOW_SIZE 256\n#define LOOK_AHEAD_BUF_SIZE 16\n\ntypedef struct {\n    unsigned short offset;\n    unsigned char length;\n    unsigned char nextChar;\n} Codeword;\n\nvoid lz77_compress(FILE *in, FILE *out) {\n    unsigned char window[WINDOW_SIZE];\n    unsigned char lookAheadBuf[LOOK_AHEAD_BUF_SIZE];\n    memset(window, 0, sizeof(window));\n\n    int winIndex = 0;\n    size_t readIn;\n    \n    while ((readIn = fread(lookAheadBuf, 1, LOOK_AHEAD_BUF_SIZE, in)) > 0) {\n        for (int i = 0; i < readIn; ++i) {\n            Codeword cw = {0, 0, lookAheadBuf[i]};\n            unsigned short bestOffset = 0;\n\n            for (unsigned short offset = 1; offset <= WINDOW_SIZE && winIndex - offset >= 0; ++offset) {\n                unsigned char *substrStart = window + (winIndex - offset);\n                int len;\n                \n                for (len = 0; len < LOOK_AHEAD_BUF_SIZE - i && substrStart[len] == lookAheadBuf[i + len]; ++len);\n\n                if (len > cw.length) {\n                    cw.offset = offset;\n                    cw.length = len;\n                    bestOffset = offset;\n                }\n            }\n\n            if (cw.length >= 3) {\n                fwrite(&cw, sizeof(Codeword), 1, out);\n                i += cw.length - 1;\n            } else {\n                Codeword singleCharCw = {0, 0, lookAheadBuf[i]};\n                fwrite(&singleCharCw, sizeof(Codeword), 1, out);\n            }\n\n            window[winIndex] = lookAheadBuf[i];\n            winIndex = (winIndex + 1) % WINDOW_SIZE;\n        }\n    }\n}\n\nint main() {\n    FILE *inFile = fopen("input.txt", "rb");\n    FILE *outFile = fopen("output.bin", "wb");\n\n    if (!inFile || !outFile) {\n        perror("Error opening files");\n        return 1;\n    }\n\n    lz77_compress(inFile, outFile);\n    fclose(inFile);\n    fclose(outFile);\n\n    return 0;\n}