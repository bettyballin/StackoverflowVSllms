#include <stdint.h>\n#include <stdbool.h>\n\n#define BLOOM_FILTER_SIZE 256\n#define BLOOM_BITS_PER_ID 3\n\nuint8_t bloom_filter[BLOOM_FILTER_SIZE / 8];\n\nvoid bloom_add(uint16_t id) {\n    for (int i = 0; i < BLOOM_BITS_PER_ID; ++i) {\n        uint16_t hash = (id + (i * 257)) % (BLOOM_FILTER_SIZE);\n        bloom_filter[hash / 8] |= (1 << (hash % 8));\n    }\n}\n\nbool bloom_check(uint16_t id) {\n    for (int i = 0; i < BLOOM_BITS_PER_ID; ++i) {\n        uint16_t hash = (id + (i * 257)) % (BLOOM_FILTER_SIZE);\n        if (!(bloom_filter[hash / 8] & (1 << (hash % 8)))) return false;\n    }\n    return true;\n}\n\nbool is_id_used(uint16_t id) {\n    // This function should scan the Flash memory to see if ID is really used\n    // Return true if used, else false\n    return false; \n}\n\nuint16_t generate_unique_id() {\n    uint16_t candidate_id;\n    do {\n        candidate_id = rand(); // Use a better pseudo-random generator in practice\n    } while (bloom_check(candidate_id) && is_id_used(candidate_id));\n    bloom_add(candidate_id);\n    return candidate_id;\n}