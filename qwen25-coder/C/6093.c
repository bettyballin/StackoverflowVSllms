#include <windows.h>\n#include <ras.h>\n\nDWORD GetRasEntries() {\n    DWORD cb = 0;\n    LPRASENTRY pRasEntry = NULL;\n    DWORD dwRet;\n\n    // First call RasEnumEntries to get bytes needed (returned in cb)\n    dwRet = RasEnumEntries(NULL, NULL, pRasEntry, &cb, &cb);\n    if (dwRet == ERROR_BUFFER_TOO_SMALL) {\n        // Allocate memory for the RASENTRY array\n        pRasEntry = (LPRASENTRY)malloc(cb);\n        ZeroMemory(pRasEntry, cb);\n\n        DWORD dwCount;\n        pRasEntry->dwSize = sizeof(RASENTRY);\n\n        // Call RasEnumEntries to populate the RASENTRY array\n        dwRet = RasEnumEntries(NULL, NULL, pRasEntry, &cb, &dwCount);\n        if (dwRet == ERROR_SUCCESS) {\n            for (DWORD i = 0; i < dwCount; i++) {\n                wprintf(L"Entry Name: %s\n", pRasEntry[i].szEntryName);\n            }\n        }\n\n        free(pRasEntry);\n    }\n\n    return dwRet;\n}