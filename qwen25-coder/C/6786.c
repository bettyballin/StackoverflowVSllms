void processIPFragment(IPHeader *ipHeader) {\n    if (isInitialFragment(ipHeader->fragmentOffset)) {\n        // This fragment contains the protocol information\n        uint8_t protocol = ipHeader->protocol;\n        handleProtocol(protocol);  // Process based on TCP/UDP/ICMP/etc.\n    } else {\n        // Non-initial fragments do not have a valid protocol field\n        processFragment(ipHeader);\n    }\n}