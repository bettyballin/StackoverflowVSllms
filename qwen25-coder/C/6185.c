#include <pcap.h>\n#include <stdio.h>\n\nvoid packet_handler(u_char *ptr, const struct pcap_pkthdr *packet_header, const u_char *packet_buffer) {\n    // Process each captured packet here\n}\n\nint main() {\n    char errbuf[PCAP_ERRBUF_SIZE];\n    pcap_t* handle;\n\n    handle = pcap_open_live("eth0", BUFSIZ, 1, 3000, errbuf);\n\n    if (handle == NULL) {\n        fprintf(stderr, "Opening device failed: %s\n", errbuf);\n        return -2;\n    }\n\n    struct bpf_program fp;   // The compiled program \n    char filter_exp[] = "tcp";  // The filter expression\n    int ret;                  // Return code for various functions.\n\n    ret = pcap_compile(handle, &fp, filter_exp, 0, 0);\n    if (ret == -1) {\n        fprintf(stderr, "Couldn't parse filter %s: %s\n", filter_exp, pcap_geterr(handle));\n        return(-2);\n    }\n\n    ret=pcap_setfilter(handle, &fp);\n    if (ret == -1){\n        fprintf(stderr, "Couldn't install filter %s: %s\n", filter_exp, pcap_geterr(handle)); \n        return(2);      \n    }\n\n    pcap_loop(handle, 0, packet_handler, NULL);\n\n    return 0;\n}