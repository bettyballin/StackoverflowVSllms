#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <sys/inotify.h>\n\n#define EVENT_SIZE  ( sizeof(struct inotify_event) )\n#define BUF_LEN     ( 1024 * ( EVENT_SIZE + 16 ) )\n\nint main(int argc, char **argv) {\n    if(argc != 3) {\n        printf("Usage: %s <directory> <filename>\n", argv[0]);\n        return 1;\n    }\n\n    int fd = inotify_init();\n    if(fd == -1) {\n        perror("inotify_init");\n        exit(EXIT_FAILURE);\n    }\n\n    // Watch the directory where the file resides\n    char *dir = argv[1];\n    char *file = argv[2];\n    int wd = inotify_add_watch(fd, dir, IN_MODIFY);\n    if(wd == -1) {\n        perror("inotify_add_watch");\n        close(fd);\n        exit(EXIT_FAILURE);\n    }\n\n    printf("Watching %s for modification of %s.\n", dir, file);\n\n    char buffer[BUF_LEN];\n    while(1) { \n        int length = read(fd, buffer, BUF_LEN);  \n        if(length < 0) {\n            perror("read");\n            break;\n        }      \n\n        int i=0;\n        while(i<length) {\n            struct inotify_event *event = (struct inotify_event *)&buffer[i];\n            if(event->len) {\n                printf("Event on file: %s\n", event->name);\n                if(event->mask & IN_MODIFY && strcmp(event->name, file) == 0) {\n                    printf("%s was modified.\n", file);\n                }\n            }\n            i += EVENT_SIZE + event->len;\n        }\n    }\n\n    inotify_rm_watch(fd, wd);     \n    close(fd);\n\n    return 0;\n}