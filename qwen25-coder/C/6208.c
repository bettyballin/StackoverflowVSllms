#include <stdio.h>\n#include <string.h>\n#include <curl/curl.h>\n\nint main(void) {\n    CURL *curl;\n    CURLcode res;\n\n    struct curl_slist *recipients = NULL;\n\n    curl_global_init(CURL_GLOBAL_DEFAULT);\n    curl = curl_easy_init();\n    if(curl) {\n\n        // Set the URL to your SMTP server\n        curl_easy_setopt(curl, CURLOPT_URL, "smtp://smtp.example.com");\n\n        // The recipients can be specified here\n        recipients = curl_slist_append(recipients, "example@example.com");\n        curl_easy_setopt(curl, CURLOPT_MAIL_RCPT, recipients);\n\n        // Specify the sender email address\n        curl_easy_setopt(curl, CURLOPT_MAIL_FROM, "<sender@example.com>");\n\n        // The message content\n        const char *payload_text[] = {\n            "Date: Mon, 29 Nov 2010 21:54:25 +1100\r\n",\n            "To: example@example.com\r\n",\n            "From: sender@example.com\r\n",\n            "Subject: Test email using libcurl\r\n",\n            "\r\n", /* empty line to end of headers */\n            "This is a test email sent with libcurl by an example program.\r\n",\n            NULL\n        };\n\n        struct curl_slist *headers = NULL;\n        headers = curl_slist_append(headers, "Content-Type: text/plain; charset=utf-8");\n        curl_easy_setopt(curl, CURLOPT_HTTPHEADER, headers);\n\n        // Set the message content to be used for the mail transfer\n        curl_easy_setopt(curl, CURLOPT_READFUNCTION, payload_source);\n        curl_easy_setopt(curl, CURLOPT_READDATA, payload_text);\n\n        // Send the email\n        res = curl_easy_perform(curl);\n\n        // Check for errors and cleanup\n        if(res != CURLE_OK)\n            fprintf(stderr, "curl_easy_perform() failed: %s\n",\n                    curl_easy_strerror(res));\n\n        curl_slist_free_all(recipients);\n        curl_slist_free_all(headers);\n    }\n\n    // Clean up\n    curl_easy_cleanup(curl);\n    curl_global_cleanup();\n\n    return 0;\n}\n\nstatic size_t payload_source(void *ptr, size_t size, size_t nmemb, void *userp) {\n    const char **curlpptr = (const char **)userp;\n\n    if((size == 0) || (nmemb == 0) || ((size*nmemb) < 1)) {\n        return 0;\n    }\n\n    while(*curlpptr != NULL) {\n        size_t len = strlen(*curlpptr);\n        if(len > 0) {\n            /* copy as much as possible from the source to the destination */\n            size_t count = (len < size*nmemb)?len:(size*nmemb)-1;\n            memcpy(ptr, *curlpptr, count + 1);\n            (*curlpptr) += count + 1; /* move read pointer forward */\n            return count;             /* number of bytes copied to dest */\n        }\n    }\n\n    // The payload source has ended\n    return 0;\n}