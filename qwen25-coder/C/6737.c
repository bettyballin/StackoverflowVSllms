#include <openssl/evp.h>\n#include <string.h>\n\nvoid aes_ctr_encrypt(const unsigned char *plaintext, int plaintext_len,\n                     const unsigned char *key, const unsigned char *iv,\n                     unsigned char *ciphertext) {\n    EVP_CIPHER_CTX *ctx;\n\n    ctx = EVP_CIPHER_CTX_new();\n    // iv_len is the length of the counter\n    int iv_len = 16;\n    EVP_EncryptInit_ex(ctx, EVP_aes_256_ctr(), NULL, key, iv);\n    int len;\n    EVP_EncryptUpdate(ctx, ciphertext, &len, plaintext, plaintext_len);\n    EVP_CIPHER_CTX_free(ctx);\n}\n\nvoid aes_ctr_decrypt(const unsigned char *ciphertext, int ciphertext_len,\n                     const unsigned char *key, const unsigned char *iv,\n                     unsigned char *plaintext) {\n    // Decryption context setup is the same as encryption\n    aes_ctr_encrypt(ciphertext, ciphertext_len, key, iv, plaintext);\n}