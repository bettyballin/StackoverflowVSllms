#include <stdint.h>\n\nuint16_t crc16(uint8_t *data, size_t length) {\n    uint16_t crc = 0xFFFF; // Initial value often used in CRC calculations\n\n    for (size_t i = 0; i < length; ++i) {\n        uint8_t byte = data[i];\n        crc ^= byte;\n\n        for (uint8_t j = 0; j < 8; ++j) {\n            if (crc & 1) {\n                crc = (crc >> 1) ^ 0xA001;\n            } else {\n                crc >>= 1;\n            }\n        }\n    }\n\n    return crc;\n}