#include <stdint.h>\n\n#define POLY 0x8005\n\nuint16_t crc16(const uint8_t *data, size_t length) {\n    uint16_t crc = 0xFFFF;\n    \n    while (length--) {\n        crc ^= *data++;\n        \n        for (uint8_t i = 0; i < 8; ++i) {\n            if (crc & 1)\n                crc = (crc >> 1) ^ POLY;\n            else\n                crc >>= 1;\n        }\n    }\n    \n    return ~crc;\n}