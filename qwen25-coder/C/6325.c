// Example of using libzip to create a zip file\n   #include <zip.h>\n   #include <stdio.h>\n\n   int main(void) {\n       struct zip *z;\n       struct zip_source *zs;\n       FILE *fp;\n\n       z = zip_open("archive.zip", ZIP_CREATE, NULL);\n       if (!z) {\n           fprintf(stderr, "Failed to create archive\n");\n           return 1;\n       }\n\n       fp = fopen("file_to_zip.txt", "r");\n       if (fp == NULL) {\n           fprintf(stderr, "Failed to open file\n");\n           zip_discard(z);\n           return 1;\n       }\n       fseek(fp, 0L, SEEK_END);\n       long fsize = ftell(fp);\n       fseek(fp, 0L, SEEK_SET);\n\n       char *string = malloc(fsize + 1);\n       fread(string, fsize, 1, fp);\n       fclose(fp);\n       string[fsize] = '\0';\n\n       zs = zip_source_buffer(z, string, fsize, 0);\n       if (zs == NULL) {\n           printf("%s\n", zip_strerror(z));\n           free(string);\n           zip_discard(z);\n           return 1;\n       }\n       if (zip_file_add(z, "file_in_zip.txt", zs, ZIP_FL_ENC_UTF_8) < 0) {\n           printf("%s\n", zip_strerror(z));\n           zip_source_free(zs);\n           free(string);\n           zip_discard(z);\n           return 1;\n       }\n\n       free(string);\n       if (zip_close(z)) {\n           fprintf(stderr, "%s\n", zip_strerror(z));\n           return 1;\n       }\n       return 0;\n   }