#include <stdint.h>\n#include <stdlib.h>\n\n// Function to add two elements in GF(2^M)\nulong gf2_add(ulong a, ulong b) {\n    return a ^ b; // Addition in GF(2^M) is simply XOR\n}\n\n// Function to multiply an element by 'x' in GF(2^M)\nulong gf2_mul_x(ulong x, int bits, ulong p) {\n    x <<= 1;\n    if (x >= (1UL << bits)) {\n        x ^= p; // Reduce modulo the polynomial p\n    }\n    return x;\n}\n\n// Function to step through the field elements from a given start point\nulong gf2_step(ulong x, int steps, int bits, ulong p) {\n    for (int i = 0; i < steps; ++i) {\n        x = gf2_mul_x(x, bits, p);\n    }\n    return x;\n}\n\n// Function to pick a random element between low and high in GF(2^M)\nulong gf2random(ulong low, ulong high, int bits, ulong p) {\n    if (low == high) return low;\n\n    // Convert bounds to linear index form\n    ulong index_low = 0;\n    ulong current = 1;\n    while (current != low) {\n        current = gf2_step(current, 1, bits, p);\n        index_low++;\n    }\n    \n    ulong index_high = index_low;\n    current = low;\n    while (current != high) {\n        current = gf2_step(current, 1, bits, p);\n        index_high++;\n    }\n\n    // Generate a random index within the range\n    ulong random_index = ((rand() % (index_high - index_low + 1)) + index_low) % index_high;\n\n    // Calculate the element at the random index\n    current = low;\n    for (ulong i = 0; i < random_index - index_low; ++i) {\n        current = gf2_step(current, 1, bits, p);\n    }\n    \n    return current;\n}\n\n// Example usage\nint main() {\n    srand(time(NULL));\n    ulong low = 12, high = 13, p = 19, M = 4; // GF(2^4) with polynomial x^4 + x^1 + 1\n    printf("%lu\n", gf2random(low, high, M, p)); \n    return 0;\n}