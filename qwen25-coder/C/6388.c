#include <stdio.h>\n#include <stdint.h>\n\n#define SECTOR_SIZE 512\n\ntypedef struct {\n    uint8_t jmpBoot[3];\n    char oemName[8];\n    uint16_t bytesPerSec;\n    uint8_t secPerClus;\n    uint16_t rsvdSecCnt;\n    uint8_t numFATs;\n    uint16_t rootEntCnt;\n    uint16_t totSec16;\n    uint8_t media;\n    uint16_t fatSz16;\n    uint16_t secsPerTrk;\n    uint16_t numHeads;\n    uint32_t hidSec;\n    uint32_t totSec32;\n} __attribute__((packed)) BPB;\n\ntypedef struct {\n    char filename[8];\n    char ext[3];\n    uint8_t attributes;\n    uint8_t reservedNT;\n    uint8_t createTimeTenth;\n    uint16_t createTime;\n    uint16_t createDate;\n    uint16_t lastAccessDate;\n    uint16_t clusterHigh16;\n    uint16_t updateTime;\n    uint16_t updateDate;\n    uint16_t firstClusterLow16;\n    uint32_t fileSize;\n} __attribute__((packed)) DirectoryEntry;\n\nvoid readBpb(FILE *fp, BPB *bpb) {\n    fread(bpb, sizeof(BPB), 1, fp);\n}\n\nvoid printDirectoryEntries(FILE *fp, BPB *bpb) {\n    long rootDirStart = (BPB->rsvdSecCnt + BPB->numFATs * BPB->fatSz16) * SECTOR_SIZE;\n    // Root directory contains BPB->rootEntCnt entries\n    fseek(fp, rootDirStart, SEEK_SET);\n\n    DirectoryEntry entry;\n    for (int i = 0; i < bpb->rootEntCnt; i++) {\n        fread(&entry, sizeof(DirectoryEntry), 1, fp);\n        if (entry.filename[0] == 0) break; // End of root directory\n\n        printf("Filename: %.*s.%.*s\n",\n               8, entry.filename,\n               3, entry.ext);\n    }\n}\n\nint main(int argc, char *argv[]) {\n    if (argc != 2) {\n        fprintf(stderr, "Usage: %s <path_to_fat12_image>\n", argv[0]);\n        return 1;\n    }\n\n    FILE *fp = fopen(argv[1], "rb");\n    if (!fp) {\n        perror("Failed to open file");\n        return 1;\n    }\n\n    BPB bpb;\n    readBpb(fp, &bpb);\n\n    printf("Reading Root Directory:\n");\n    printDirectoryEntries(fp, &bpb);\n\n    fclose(fp);\n    return 0;\n}