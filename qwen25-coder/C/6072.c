#include <windows.h>\n#include <aclapi.h>\n\nint main() {\n    HKEY hKey;\n    PSID pExistingSid = NULL; // SID of the security principal (user/group)\n    EXPLICIT_ACCESS ea = {0};\n    PACL pNewDacl = NULL;\n\n    // Open the registry key which needs ACL modification\n    LONG lResult = RegOpenKeyEx(HKEY_LOCAL_MACHINE, TEXT("Software\\YourCompany\\YourApp"), 0, KEY_READ | KEY_WRITE, &hKey);\n    if (lResult != ERROR_SUCCESS) {\n        printf("Failed to open registry key: %ld\n", lResult);\n        return 1;\n    }\n\n    // Initialize ACE\n    if (!ConvertStringSidToSid(TEXT("YourUserOrGroupSID"), &pExistingSid)) {\n        RegCloseKey(hKey);\n        printf("Invalid user or group SID\n");\n        return 1;\n    }\n\n    ea.grfAccessPermissions = KEY_ALL_ACCESS;\n    ea.grfAccessMode = GRANT_ACCESS;\n    ea.grfInheritance = NO_INHERITANCE;\n    ea.Trustee.pMultipleTrustee = NULL;\n    ea.Trustee.MultipleTrusteeOperation = NO_MULTIPLE_TRUSTEE;\n    ea.Trustee.TrusteeForm = TRUSTEE_IS_SID;\n    ea.Trustee.TrusteeType = TRUSTEE_IS_USER;\n    ea.Trustee.ptstrName = (LPTSTR)pExistingSid;\n\n    // Create new ACL\n    if (SetEntriesInAcl(1, &ea, NULL, &pNewDacl) != ERROR_SUCCESS) {\n        RegCloseKey(hKey);\n        LocalFree(pExistingSid);\n        printf("Failed to create ACL\n");\n        return 1;\n    }\n\n    // Set the new DACL on the registry key\n    if (SetSecurityInfo(hKey, SE_REGISTRY_KEY, DACL_SECURITY_INFORMATION,\n                        NULL, NULL, pNewDacl, NULL) != ERROR_SUCCESS) {\n        RegCloseKey(hKey);\n        LocalFree(pExistingSid);\n        LocalFree(pNewDacl);\n        printf("Failed to set security info\n");\n        return 1;\n    }\n\n    // Clean up\n    if (pExistingSid != NULL)\n        LocalFree(pExistingSid);\n\n    if (pNewDacl != NULL)\n        LocalFree(pNewDacl);\n\n    RegCloseKey(hKey);\n\n    printf("ACL modified successfully.\n");\n\n    return 0;\n}