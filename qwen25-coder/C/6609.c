#include <stdio.h>\n#include <stdlib.h>\n#include <ldns/ldns.h>\n\nint main(int argc, char *argv[]) {\n    if (argc != 2) {\n        fprintf(stderr, "Usage: %s domain\n", argv[0]);\n        exit(EXIT_FAILURE);\n    }\n\n    ldns_rr_list *mx_records;\n    ldns_resolver *resolver;\n    ldns_status status;\n    ldns_rdf *domain;\n\n    // Create and initialize a resolver\n    resolver = ldns_resolver_new();\n    if (!resolver) {\n        fprintf(stderr, "Failed to create new resolver\n");\n        exit(EXIT_FAILURE);\n    }\n\n    status = ldns_resolver_init_nameservers_resolv_conf(resolver);\n    if (status != LDNS_STATUS_OK) {\n        fprintf(stderr, "Error initializing resolver: %s\n", ldns_get_errorstr_by_id(status));\n        ldns_resolver_free(resolver);\n        exit(EXIT_FAILURE);\n    }\n\n    // Convert domain from string to rdf\n    domain = ldns_dname_new_frm_str(argv[1]);\n    if (!domain) {\n        fprintf(stderr, "Invalid domain name: %s\n", argv[1]);\n        ldns_resolver_free(resolver);\n        exit(EXIT_FAILURE);\n    }\n\n    // Perform MX lookup\n    status = ldns_get_rr_list_res(&mx_records, domain, LDNS_RR_TYPE_MX, LDNS_RR_CLASS_IN, resolver);\n    if (status != LDNS_STATUS_OK) {\n        fprintf(stderr, "MX lookup failed: %s\n", ldns_get_errorstr_by_id(status));\n        ldns_rdf_deep_free(domain);\n        ldns_resolver_free(resolver);\n        exit(EXIT_FAILURE);\n    }\n\n    // Print MX records\n    size_t mx_count = ldns_rr_list_rr_count(mx_records);\n    printf("MX Records for %.*s:\n", (int)ldns_dname_size(domain), (char *)ldns_rdf_data(domain));\n    for (size_t i = 0; i < mx_count; ++i) {\n        const ldns_rr *mx_record = ldns_rr_list_rr(mx_records, i);\n        ldns_rdf *exchange = ldns_rr_mx_exchange(mx_record);\n        uint16_t preference = ldns_rr_mx_preference(mx_record);\n        printf("  Preference: %u, Exchange: %.*s\n", preference,\n               (int)ldns_dname_size(exchange), (char *)ldns_rdf_data(exchange));\n    }\n\n    // Cleanup\n    ldns_rr_list_deep_free(mx_records);\n    ldns_rdf_deep_free(domain);\n    ldns_resolver_free(resolver);\n\n    return 0;\n}