#include <windows.h>\n#include <wincrypt.h>\n#include <stdio.h>\n\n#pragma comment(lib, "crypt32.lib")\n\nBOOL ImportRootCertificate(PCWSTR pszCertPath, DWORD dwStoreLocation)\n{\n    PCCERT_CONTEXT pCertContext = NULL;\n    HCERTSTORE hStore = NULL;\n    HANDLE hFile;\n    BYTE* pbCertEncoded = NULL;\n    DWORD cbCertEncoded = 0;\n\n    // Open the certificate store.\n    hStore = CertOpenSystemStore(NULL, dwStoreLocation == CERT_SYSTEM_STORE_LOCAL_MACHINE ? L"ROOT" : L"MY");\n    if (!hStore)\n    {\n        printf("CertOpenSystemStore failed with error %x\n", GetLastError());\n        return FALSE;\n    }\n\n    // Open the certificate file.\n    hFile = CreateFile(pszCertPath, GENERIC_READ, 0, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);\n    if (hFile == INVALID_HANDLE_VALUE)\n    {\n        printf("CreateFile failed with error %x\n", GetLastError());\n        goto cleanup;\n    }\n\n    // Read the certificate file.\n    if (!GetFileSizeEx(hFile, (PLARGE_INTEGER)&cbCertEncoded))\n    {\n        printf("GetFileSizeEx failed with error %x\n", GetLastError());\n        CloseHandle(hFile);\n        hFile = INVALID_HANDLE_VALUE;\n        goto cleanup;\n    }\n    pbCertEncoded = (BYTE*)malloc(cbCertEncoded);\n    if (!pbCertEncoded)\n    {\n        printf("Failed to allocate memory for certificate data %d\n", cbCertEncoded);\n        CloseHandle(hFile);\n        hFile = INVALID_HANDLE_VALUE;\n        goto cleanup;\n    }\n    DWORD bytesRead;\n    if (!ReadFile(hFile, pbCertEncoded, cbCertEncoded, &bytesRead, NULL) ||\n        bytesRead != cbCertEncoded)\n    {\n        printf("ReadFile failed with error %x\n", GetLastError());\n        CloseHandle(hFile);\n        hFile = INVALID_HANDLE_VALUE;\n        goto cleanup;\n    }\n    \n    // Initialize the certificate context.\n    pCertContext = CertCreateCertificateContext(X509_ASN_ENCODING | PKCS_7_ASN_ENCODING, pbCertEncoded, cbCertEncoded);\n    if (!pCertContext)\n    {\n        printf("CertCreateCertificateContext failed with error %x\n", GetLastError());\n        goto cleanup;\n    }\n\n    // Add the certificate to the store.\n    if (!CertAddCertificateContextToStore(hStore, pCertContext, CERT_STORE_ADD_REPLACE_EXISTING, NULL))\n    {\n        printf("CertAddCertificateContextToStore failed with error %x\n", GetLastError());\n        goto cleanup;\n    }\n\ncleanup:\n    if (hFile != INVALID_HANDLE_VALUE)\n        CloseHandle(hFile);\n    if (pbCertEncoded)\n        free(pbCertEncoded);\n    if (pCertContext)\n        CertFreeCertificateContext(pCertContext);\n    if (hStore)\n        CertCloseStore(hStore, 0);\n\n    return pCertContext != NULL;\n}\n\nint main() \n{\n    LPCWSTR certPath = L"path\\to\\your\\certificate.cer";\n    DWORD storeLocation = CERT_SYSTEM_STORE_LOCAL_MACHINE; // or CERT_SYSTEM_STORE_CURRENT_USER for current user\n\n    if (ImportRootCertificate(certPath, storeLocation))\n        wprintf(L"Certificate imported successfully.\n");\n    else\n        wprintf(L"Failed to import certificate.\n");\n\n    return 0;\n}