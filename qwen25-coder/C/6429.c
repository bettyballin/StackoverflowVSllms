#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <unistd.h>\n#include <sys/socket.h>\n#include <linux/netlink.h>\n#include <linux/rtnetlink.h>\n\n#define MAX_MSG_SIZE 4096\n\nvoid listen_for_net_changes() {\n    int sock = socket(PF_NETLINK, SOCK_RAW, NETLINK_ROUTE);\n    if (sock < 0) {\n        perror("socket");\n        exit(EXIT_FAILURE);\n    }\n\n    struct sockaddr_nl sa;\n    memset(&sa, 0, sizeof(sa));\n    sa.nl_family = AF_NETLINK;\n\n    bind(sock, (struct sockaddr *)&sa, sizeof(sa));\n\n    char buf[MAX_MSG_SIZE];\n    while (1) {\n        int n_bytes = recvfrom(sock, &buf, MAX_MSG_SIZE, 0, NULL, NULL);\n        if (n_bytes < 0) {\n            perror("recvfrom");\n            continue;\n        }\n\n        struct nlmsghdr *nlh = (struct nlmsghdr *)buf;\n        while (NLMSG_OK(nlh, n_bytes)) {\n            if (nlh->nlmsg_type == RTM_NEWLINK || nlh->nlmsg_type == RTM_DELLINK) {\n                printf("Network interface change detected\n");\n                // Call getifaddrs() or handle the event\n            }\n\n            nlh = NLMSG_NEXT(nlh, n_bytes);\n        }\n    }\n}\n\nint main() {\n    listen_for_net_changes();\n    return 0;\n}