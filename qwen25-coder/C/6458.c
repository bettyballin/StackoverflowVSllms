#include <lua.h>\n#include <lauxlib.h>\n#include <lualib.h>\n\n// Function to store a Lua function in a registry reference\nint store_lua_function(lua_State *L) {\n    // Ensure a function is passed as an argument to this C function\n    luaL_checktype(L, 1, LUA_TFUNCTION);\n\n    // Pop the function from the stack and associate a reference number with it.\n    int ref = luaL_ref(L, LUA_REGISTRYINDEX);\n    \n    // Return the reference number from this C function so you can use it later\n    return ref;\n}\n\n// Function to retrieve and call a Lua function using its registry reference\nvoid call_stored_lua_function(lua_State *L, int ref) {\n    // Push the function (associated with 'ref') onto the stack\n    lua_rawgeti(L, LUA_REGISTRYINDEX, ref);\n\n    // If necessary, push arguments for the function here...\n    \n    // Call the function with 0 arguments and 0 return values expected\n    if (lua_pcall(L, 0, 0, 0)) {\n        fprintf(stderr, "Error running function: %s\n", lua_tostring(L, -1));\n        lua_pop(L, 1); // Remove error message from the stack\n    }\n\n    // Free the reference so Lua can eventually collect it if no other references to the function exist.\n    luaL_unref(L, LUA_REGISTRYINDEX, ref);\n}