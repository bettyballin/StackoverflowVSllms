#include <netinet/tcp.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <stdio.h>\n\nvoid set_md5_signature(int sockfd, const char *key) {\n    struct tcp_md5sig sig;\n    \n    // Set the IP address of the peer you want to authenticate with MD5.\n    memset(&sig.tcpm_addr, 0, sizeof(sig.tcpm_addr));\n    sig.tcpm_addr.s_addr = INADDR_LOOPBACK;  // Example: loopback address\n\n    // Set the MD5 key (up to 80 characters).\n    strlcpy(sig.tcpm_key, key, TCP_MD5SIG_MAXKEYLEN);\n\n    // Specify the length of the key.\n    sig.tcpm_keylen = strlen(key);\n\n    if(setsockopt(sockfd, IPPROTO_TCP, TCP_MD5SIG, &sig, sizeof(struct tcp_md5sig)) < 0) {\n        perror("setsockopt(TCP_MD5SIG)");\n    }\n}\n\nint main() {\n    int sockfd;\n\n    // Create a socket\n    sockfd = socket(AF_INET, SOCK_STREAM, 0);\n\n    if (sockfd < 0) {\n        perror("socket");\n        return -1;\n    }\n\n    const char *key = "your_secret_md5_key_";\n\n    // Set MD5 signature for the connection.\n    set_md5_signature(sockfd, key);\n\n    // Continue with socket operations...\n\n    close(sockfd);\n    return 0;\n}