#define RANDOM_DEVICE "/dev/random"\nint create_shared_secret(unsigned char * secret, int size)\n{\n  FILE * file = NULL;\n  int RetVal;\n\n  file = fopen(RANDOM_DEVICE, "r");\n  if(!file)\n  {\n    printf("Unable to open random device %s\n", RANDOM_DEVICE);\n    exit(-1);\n  }\n  RetVal = fread(secret, 1, size, file); // Corrected here: secret instead of &secret\n  if(RetVal != size)\n  {\n    printf("Problem getting seed value\n");\n    fclose(file); // Make sure to close the file before exiting\n    exit(-1);\n  }\n\n  fclose(file);  // No longer causes a segfault\n  return 0;\n}