#include <stdio.h>\n#include <kstat.h>\n\nint main() {\n    kstat_ctl_t *kc;\n    kstat_t *ksp;\n    kd_tid_t ktid;\n\n    // Open the kernel statistics control structure.\n    if ((kc = kstat_open()) == NULL) {\n        perror("kstat_open");\n        return 1;\n    }\n\n    // Find a kstat\n    if ((ksp = kstat_lookup(kc, "unix", -1, "system_misc")) == NULL || kstat_read(kc, ksp, NULL) == -1) {\n        perror("kstat_lookup or kstat_read");\n        kstat_close(kc);\n        return 1;\n    }\n\n    // Access data\n    ktid = *(kd_tid_t *)KSTAT_DATA_PTR(ksp);\n    printf("Number of threads: %ld\n", (long)ktid);\n\n    kstat_close(kc);\n    return 0;\n}