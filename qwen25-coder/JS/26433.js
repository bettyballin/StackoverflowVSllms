var xpitest = {\n    onFileChosen: function(e) {\n        var fileInput = e.explicitOriginalTarget;\n        if (fileInput.type == "file") {\n            var parentDiv = fileInput.parentNode;\n\n            // Remove the existing button if it exists\n            var existingButton = top.window.content.document.getElementById("Firefox.Now_button_id");\n            if (existingButton && existingButton.parentNode) {\n                existingButton.parentNode.removeChild(existingButton);\n            }\n\n            // Create a new button\n            var newButton = top.window.content.document.createElement("input");\n            newButton.setAttribute("type", "button");\n            newButton.setAttribute("id", "Firefox.Now_button_id");\n            newButton.setAttribute("value", "my button");\n            newButton.setAttribute("name", "Firefox.Now_button_name");\n\n            // Insert the new button before the file input\n            parentDiv.insertBefore(newButton, fileInput);\n        }\n    }\n};\n\nwindow.addEventListener("change", function(e) { xpitest.onFileChosen(e); }, false);