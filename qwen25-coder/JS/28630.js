var xmlHttp;\n\nfunction update(layer, part, pk, query) {\n    var url;\n    \n    if (part == "1") {\n        url = "get_auction.php?cmd=GetAuctionData&pk=" + encodeURIComponent(pk) + "&sid=" + Math.random();\n    } else if (part == "2" && query !== undefined) {\n        url = "get_records.php?cmd=GetRecordSet&query=" + encodeURIComponent(query) + "&sid=" + Math.random();\n    }\n\n    xmlHttp = GetXmlHttpObject();\n    \n    if (xmlHttp === null) {\n        alert("Your browser is not supported.");\n        return;\n    }\n\n    xmlHttp.onreadystatechange = function() {\n        if (xmlHttp.readyState === 4) { // Check as a number\n            if (xmlHttp.status == 200) { // HTTP OK check\n                document.getElementById(layer).innerHTML = xmlHttp.responseText;\n            } else if (xmlHttp.status !== 200) {\n                document.getElementById(layer).innerHTML = "Error: " + xmlHttp.statusText;\n            }\n        } else if (xmlHttp.readyState === 1) { // Check as a number\n            document.getElementById(layer).innerHTML = "Loading...";\n        }\n    };\n\n    xmlHttp.open("GET", url, true);\n    xmlHttp.send(null);\n}\n\nfunction GetXmlHttpObject() {\n    try { return new XMLHttpRequest(); } catch (e) {}\n    try { return new ActiveXObject("Msxml2.XMLHTTP.6.0"); } catch (e) {} \n    try { return new ActiveXObject("Msxml2.XMLHTTP.3.0"); } catch (e) {} \n    try { return new ActiveXObject("Msxml2.XMLHTTP"); } catch (e) {}\n    try { return new ActiveXObject("Microsoft.XMLHTTP"); } catch (e) {}\n\n    return null;\n}\n\nfunction makeWindow(content) {\n    var child1 = window.open("about:blank");\n    child1.document.write(content);\n    child1.document.close();\n}