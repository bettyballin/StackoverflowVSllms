$(document).ready(function(){\n    $('p.validate').hide();\n\n    $.getJSON("readJSON.php",function(data){\n        $.each(data.posts, function(i,post){\n            var content = '<div id="post-'+ post.id +'">' +\n                          '<h3>' + htmlspecialchars(post.author) + '</h3>' +\n                          '<p class="small quiet">' + htmlspecialchars(post.date_added) + '</p>' +\n                          '<p>' + htmlspecialchars(post.post_content) + '</p>' +\n                          '<hr/>' +\n                          '</div>';\n            $("#contents").append(content).fadeIn("slow");      \n        });\n    });\n\n    $(".reload").click(function() { \n        $("#posts").empty();\n        return false; // Prevent default action\n    });\n\n    $("#add_post").submit(function(event) {\n        event.preventDefault(); // Use this instead of return false;\n        $('p.validate').empty();\n\n        var author = $('#author').val(); // Use .val() instead of .attr('value')\n        var post   = $('#post').val();  \n\n        if(!author.trim() || !post.trim()){\n            $("p.validate").fadeIn().append("Both fields are required.");\n            $('#author,#post').addClass("error");\n        } else {\n            $.ajax({\n                type: "POST",\n                url: "ajax.php",\n                data: { author: author, post: post }, // Use object notation\n                dataType: 'html', // Expect HTML in response\n                success: function(result){\n                    $('#contents').append($('<div>').html(result)); // Append as HTML content\n                },\n                error: function(xhr, status, error) {\n                    console.error("An AJAX error occurred: " + status + "\nError: " + error);\n                    $("p.validate").fadeIn().text("An error occurred while submitting your post.");\n                }\n            });\n        }\n    });\n\n});\n\n// Function to escape HTML characters\nfunction htmlspecialchars(str) {\n    return String(str)\n         .replace(/&/g, '&amp;')\n         .replace(/</g, '&lt;')\n         .replace(/>/g, '&gt;')\n         .replace(/"/g, '&quot;');\n}