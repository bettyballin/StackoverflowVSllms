$(document).ready(function() {\n    var popupWindow = null;\n\n    // Assume there's a user interaction like a button click that triggers this\n    $('#myButton').on('click', function() {\n        popupWindow = window.open('', '_blank');\n\n        $.ajax({\n            type: "POST",\n            url: "MyService.aspx/ConstructUrl",\n            data: jsonData,\n            contentType: "application/json; charset=utf-8",\n            dataType: "json",\n            success: function(msg) {\n                // If the popup was blocked, popupWindow will be null\n                if (popupWindow) {\n                    popupWindow.location = msg.d;\n                } else {\n                    alert('Popup was blocked. Please check your browser settings.');\n                }\n            },\n            error: function() {\n                if (popupWindow) {\n                    popupWindow.close();\n                }\n                alert('An error occurred while constructing the URL.');\n            }\n        });\n    });\n});