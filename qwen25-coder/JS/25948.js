function createXMLHttpRequest() {\n    var xhr;\n    if (window.ActiveXObject) { // Check for IE versions that support ActiveX\n        try {\n            // This is the preferred version in many environments\n            xhr = new ActiveXObject('Msxml2.XMLHTTP.6.0');\n        } catch (e) {\n            try {\n                xhr = new ActiveXObject('Msxml2.XMLHTTP.3.0');\n            } catch (e) {\n                try {\n                    xhr = new ActiveXObject('Microsoft.XMLHTTP');\n                } catch (e) {\n                    xhr = null;\n                }\n            }\n        }\n    } else if (window.XMLHttpRequest) { // Fallback for non-IE browsers\n        xhr = new XMLHttpRequest();\n    }\n    return xhr;\n}\n\nfunction jsonAjax(url, data, async, onSuccess, onFailed) {\n    var xhr = createXMLHttpRequest();\n    if (!xhr) {\n        console.error('Your browser does not support XMLHTTP.');\n        return;\n    }\n\n    xhr.open("POST", url, async);\n    xhr.setRequestHeader("Content-Type", "application/json; charset=utf-8");\n    xhr.onreadystatechange = function() {\n        if (xhr.readyState === 4) { // Request is complete\n            if (xhr.status >= 200 && xhr.status < 300) { // Success\n                var result = JSON.parse(xhr.responseText);\n                onSuccess(result);\n            } else { // Failure\n                onFailed(xhr.statusText);\n            }\n        }\n    };\n    xhr.send(data);\n}