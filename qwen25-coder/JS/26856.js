document.addEventListener('DOMContentLoaded', function () {\n    var validators = document.querySelectorAll('.myAsyncValidatorClass');\n    validators.forEach(function (validator) {\n        validator.addEventListener('change', validateUsername);\n    });\n\n    function validateUsername(event) {\n        var textBoxId = event.target.getAttribute('data-username-tb');\n        var url = event.target.getAttribute('data-validation-url');\n        var username = document.getElementById(textBoxId).value;\n\n        fetch(url, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/x-www-form-urlencoded'\n            },\n            body: 'username=' + encodeURIComponent(username)\n        })\n        .then(response => response.json())\n        .then(data => {\n            if (data.isTaken) {\n                ValidatorSetIsValid(event.target, false);\n            } else {\n                ValidatorSetIsValid(event.target, true);\n            }\n            // Trigger re-validation of the page\n            Page_ClientValidate();\n        });\n    }\n});