addEvent(window, "load", UpdateValidationSummary);\n\nfunction addEvent(obj, evType, fn) {\n    if (obj.addEventListener) {\n        obj.addEventListener(evType, fn, false);\n    } else if (obj.attachEvent) {\n        obj.attachEvent("on" + evType, fn);\n    }\n}\n\nfunction removeEvent(obj, evType, fn) {\n    if (obj.removeEventListener) {\n        obj.removeEventListener(evType, fn, false);\n    } else if (obj.detachEvent) {\n        obj.detachEvent("on" + evType, fn);\n    }\n}\n\nfunction UpdateValidationSummary() {\n    if (typeof(Page_Validators) == "undefined") return;\n\n    for (var i = 0; i < Page_Validators.length; i++) {\n        var val = Page_Validators[i];\n        if (val.controltovalidate && val.controltovalidate != "") {\n            var ctrl = document.getElementById(val.controltovalidate);\n            if (ctrl) {\n                // Create a new function that calls both existing and ValidationSummaryOnSubmit\n                (function(ctrl) {\n                    var originalBlurHandler = ctrl.onblur;\n\n                    ctrl.onblur = function() {\n                        if(originalBlurHandler) {\n                            originalBlurHandler.apply(this, arguments);\n                        }\n                        ValidationSummaryOnSubmit();\n                    };\n                })(ctrl);\n            }\n        }\n    }\n}