document.observe('dom:loaded', function() {\n    var form = $('yourFormId');\n    var submitButton = $('submitButtonId');\n    var loadingDiv = $('loadingDivId');\n\n    form.observe('submit', function(event) {\n        event.stop(); // Prevent the default form submission\n\n        if (submitButton.disabled) return; // Do nothing if button is already disabled\n\n        // Disable the submit button\n        submitButton.disable();\n\n        // Show the loading div\n        submitButton.style.display = 'none';\n        loadingDiv.style.display = 'inline';\n\n        new Ajax.Request(form.action, {\n            parameters: form.serialize(),\n            onSuccess: function(response) {\n                // Handle the response here if needed\n\n                // Re-enable the submit button and hide the loading div after a successful response\n                submitButton.enable();\n                submitButton.style.display = 'inline';\n                loadingDiv.style.display = 'none';\n            },\n            onFailure: function() {\n                // Optionally, handle errors here\n\n                // Re-enable the submit button in case of failure too\n                submitButton.enable();\n                submitButton.style.display = 'inline';\n                loadingDiv.style.display = 'none';\n            }\n        });\n    });\n});