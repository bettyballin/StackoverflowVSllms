function GetXmlHttpObject() {\n    var xmlHttp = null;\n    try {\n        xmlHttp = new XMLHttpRequest();\n    } catch (e) {\n        try {\n            xmlHttp = new ActiveXObject("Msxml2.XMLHTTP");\n        } catch (e) {\n            xmlHttp = new ActiveXObject("Microsoft.XMLHTTP");\n        }\n    }\n    return xmlHttp;\n}\n\nfunction login() {\n    alert("Entered Login()");\n    var xmlhttp = GetXmlHttpObject(); // Declare xmlhttp locally\n    if (xmlhttp == null) {\n        alert("Your browser does not support AJAX!");\n        return;\n    }\n\n    var url = "http://server.com/ALUauth.php";\n    xmlhttp.onreadystatechange = function() { statechangedLogin(xmlhttp); }; // Pass xmlhttp as a parameter\n    xmlhttp.open("GET", url, true);\n    xmlhttp.send(null);\n}\n\nfunction statechangedLogin(xmlhttp) {\n    if (xmlhttp.readyState == 4) {\n        alert("Entered State Changed Login");\n        if (xmlhttp.responseText == "Please <a href=http://server.com/ALUauth.php?login>login</a>") {\n            document.getElementById("ALUauth").innerHTML = xmlhttp.responseText;\n        } else {\n            GetEmailId(xmlhttp); // Pass xmlhttp as a parameter\n        }\n    }\n}\n\nfunction GetEmailId(xmlhttp) {\n    alert("Entered GetEmailId()");\n    var url = "http://server.com/GetPostEmail.php";\n    url += "&sid=" + Math.random();\n    xmlhttp.onreadystatechange = function() { statechangedLogin2(xmlhttp); }; // Pass xmlhttp as a parameter\n    xmlhttp.open("GET", url, true);\n    xmlhttp.send(null);\n}\n\nfunction statechangedLogin2(xmlhttp) {\n    if (xmlhttp.readyState == 4) {\n        alert("Enter State Changed Login 2");\n        if (xmlhttp.responseText == "Login again") {\n            window.location = "http://server.com/profile.html";\n        }\n    }\n}