function getSelectedCells() {\n    var $selectedCells = [];\n    if (document.selection) { // For IE\n        var sel = document.selection;\n        if (sel.type === "Control") {\n            for (var i = 0; i < sel.createRange().length; i++) {\n                $selectedCells.push($(sel.createRange().item(i).parentElement));\n            }\n        } else {\n            var range = sel.createRange();\n            while (!range.atEnd) {\n                var node = range.parentElement();\n                if (node.tagName.toLowerCase() === 'td') {\n                    $selectedCells.push($(node));\n                    range.moveNext();\n                }\n            }\n        }\n    } else { // For other browsers\n        var selection = window.getSelection();\n        for (var i = 0; i < selection.rangeCount; ++i) {\n            var nodes = document.querySelectorAll('td');\n            Array.prototype.slice.call(nodes).forEach(function(node) {\n                if (selection.containsNode(node, true)) {\n                    $selectedCells.push($(node));\n                }\n            });\n        }\n    }\n    return $selectedCells;\n}\n\n$(document).on('mouseup', function() {\n    var selectedCells = getSelectedCells();\n    $.each(selectedCells, function() {\n        $(this).css('background-color', '#ffcccb');\n    });\n});