function getParentElementAtOffset(htmlString, offset) {\n    const range = document.createRange();\n    const fragment = document.createDocumentFragment();\n    const wrapper = document.createElement('div');\n    \n    // Append HTML content to a new div element and then append it to the fragment\n    wrapper.innerHTML = htmlString;\n    fragment.appendChild(wrapper);\n\n    // Helper function to get the parent element at a specific offset\n    function getNodeAtOffset(node, offset) {\n        let currentOffset = 0;\n\n        for (let child of node.childNodes) {\n            if (child.nodeType === Node.TEXT_NODE) {\n                if (offset >= currentOffset && offset < currentOffset + child.nodeValue.length) {\n                    return child.parentNode;\n                }\n                currentOffset += child.nodeValue.length;\n            } else {\n                const result = getNodeAtOffset(child, offset);\n                if (result) return result;\n                currentOffset++;\n            }\n        }\n\n        return null;\n    }\n\n    // Get the parent element at the specified offset\n    return getNodeAtOffset(fragment, offset);\n}\n\n// Example usage:\nconst htmlString = '<p>I really <em>like <a href="...">stackoverflow</a></em> a lot.</p>';\nconst offset = 35; // Offset to find within the HTML string\n\nconst element = getParentElementAtOffset(htmlString, offset);\nconsole.log(element); // This should log the <a> element