function replaceSelectedText(replacement) {\n    var textarea = document.getElementById('yourTextareaId'); // Replace with your actual textarea ID\n    if ('selectionStart' in textarea) { // Standard-compliant browsers\n        var start = textarea.selectionStart;\n        var end = textarea.selectionEnd;\n        textarea.value = textarea.value.substring(0, start) + replacement + textarea.value.substring(end);\n        textarea.focus();\n        textarea.setSelectionRange(start + replacement.length, start + replacement.length);\n    } else if (document.selection && document.selection.createRange) { // Internet Explorer\n        var range = document.selection.createRange();\n        range.text = replacement;\n    }\n}