using System;\nusing System.DirectoryServices;\n\nprivate void CheckIfApp(DirectoryEntry de)\n{\n    try\n    {\n        // Ensure the schema class name is as expected\n        if (de.SchemaClassName == "IIsWebDirectory" || de.SchemaClassName == "IIsWebVirtualDir")\n        {\n            // Check for AppFriendlyName property\n            if (de.Properties["AppFriendlyName"].Value != null)\n            {\n                string friendlyName = de.Properties["AppFriendlyName"].ToString();\n                \n                // Application is not the default application\n                if (!friendlyName.Equals("Default Application", StringComparison.OrdinalIgnoreCase))\n                {\n                    Console.WriteLine($"{de.Name} is configured as an ASP.NET application.");\n                    // Do something with this directory...\n                }\n            }\n        }\n    }\n    catch (Exception ex)\n    {\n        Console.WriteLine($"Error checking {de.Name}: {ex.Message}");\n    }\n}