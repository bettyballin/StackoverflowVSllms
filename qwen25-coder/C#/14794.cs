using System;\nusing System.Collections.Generic;\nusing Microsoft.SharePoint.Client;\n\nnamespace SharePointUsersByGroup\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            string siteUrl = "https://yoursiteurl.sharepoint.com";\n            string userName = "yourusername@domain.onmicrosoft.com";\n            string password = "yourpassword";\n\n            using (ClientContext context = new ClientContext(siteUrl))\n            {\n                SecureString passWord = new SecureString();\n                foreach (char c in password) passWord.AppendChar(c);\n\n                context.Credentials = new SharePointOnlineCredentials(userName, passWord);\n\n                List list = context.Web.Lists.GetByTitle("YourListName"); // Replace with your list title\n                CamlQuery query = new CamlQuery();\n                query.ViewXml = "<View><RowLimit>100</RowLimit></View>";\n                ListItemCollection items = list.GetItems(query);\n                context.Load(items, its => its.Include(it => it["Members"])); // Adjust "Members" if different\n                context.ExecuteQuery();\n\n                foreach (ListItem item in items)\n                {\n                    var valueFieldUserValue = item.FieldValues["Members"] as FieldUserValue[];\n                    if (valueFieldUserValue != null)\n                    {\n                        foreach (var user in valueFieldUserValue)\n                        {\n                            Console.WriteLine($"User: {user.LookupValue}");\n                        }\n                    }\n\n                    var valueFieldLookupValue = item.FieldValues["Members"] as FieldLookupValue[];\n                    if (valueFieldLookupValue != null)\n                    {\n                        foreach (var group in valueFieldLookupValue)\n                        {\n                            Group spGroup = context.Web.SiteGroups.GetById(group.LookupId);\n                            context.Load(spGroup, g => g.Users);\n                            context.ExecuteQuery();\n\n                            Console.WriteLine($"Group: {spGroup.Title}");\n                            foreach (User user in spGroup.Users)\n                            {\n                                Console.WriteLine($"  User: {user.LoginName}");\n                            }\n                        }\n                    }\n                }\n            }\n\n            Console.ReadLine();\n        }\n    }\n}