using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Xml.Linq;\n\npublic class Entry\n{\n    public int Words { get; set; }\n    public int Score { get; set; }\n    public string Text { get; set; }\n    public List<string> NMs { get; set; } = new List<string>();\n    public string CF { get; set; }\n    public string IE { get; set; }\n    public List<Entry> SubEntries { get; set; } = new List<Entry>();\n\n    // Method to format NM items into a formatted string\n    public string FormattedNMs => string.Join(", ", NMs);\n}\n\npublic class CodebookIndex\n{\n    public List<Entry> MainEntries { get; set; }\n}\n\npublic class XmlParser\n{\n    public static CodebookIndex ParseCodebookIndex(string xml)\n    {\n        var xdoc = XDocument.Parse(xml);\n        return new CodebookIndex\n        {\n            MainEntries = (from me in xdoc.Root.Elements("ME")\n                           select new Entry\n                           {\n                               Words = int.Parse(me.Attribute("Words").Value),\n                               Score = int.Parse(me.Attribute("Score").Value),\n                               Text = me.Value.Trim(),\n                               NMs = me.Elements("NM").Select(nm => nm.Value.Trim()).ToList(),\n                               CF = me.Element("CF")?.Value,\n                               IE = me.Element("IE")?.Value,\n                               SubEntries = me.Elements().Where(e => e.Name.LocalName.StartsWith("M"))\n                                                     .Select(se => new Entry\n                                                     {\n                                                         Words = int.Parse(se.Attribute("Words").Value),\n                                                         Score = int.Parse(se.Attribute("Score").Value),\n                                                         Text = se.Value.Trim(),\n                                                         NMs = se.Elements("NM").Select(nm => nm.Value.Trim()).ToList(),\n                                                         CF = se.Element("CF")?.Value,\n                                                         IE = se.Element("IE")?.Value\n                                                     }).ToList()\n                           }).ToList()\n        };\n    }\n}