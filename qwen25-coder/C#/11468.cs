public Table BuildTable()\n{\n    Table tButtons = new Table();\n    TableRow tRow = null;\n    TableCell tCell = null;\n    long lColumn = 0;\n    long lPreviousColumn = 0;\n    long lRow = 0;\n    long lPreviousRow = 0;\n    long lLanguage = 0;\n    long lPreviousLanguage = 0;\n    \n    OpenConnection();\n    ButtonData();\n    Int32 lRowOrd = aReader.GetOrdinal("RowNumber");\n    Int32 lColOrd = aReader.GetOrdinal("ColumnNumber");\n    Int32 lLangOrd = aReader.GetOrdinal("Language");\n    Int32 lLabelOrd = aReader.GetOrdinal("Label");\n\n    while (aReader.Read())\n    {\n        lRow = IsDbNull(aReader, lRowOrd) ? 0 : Convert.ToInt64(aReader[lRowOrd]);\n        lColumn = IsDbNull(aReader, lColOrd) ? 0 : Convert.ToInt64(aReader[lColOrd]);\n        lLanguage = IsDbNull(aReader, lLangOrd) ? 0 : Convert.ToInt64(aReader[lLangOrd]);\n\n        if (tRow == null || lPreviousRow != lRow)\n        {\n            // Add the previous row to the table\n            if (tRow != null && tRow.Cells.Count > 0)\n                tButtons.Rows.Add(tRow);\n\n            // Start a new row\n            tRow = new TableRow();\n            lPreviousRow = lRow;\n        }\n\n        if (tCell == null || lPreviousColumn != lColumn)\n        {\n            // Add the previous cell to the row\n            if (tCell != null && !string.IsNullOrEmpty(tCell.Text))\n                tRow.Cells.Add(tCell);\n\n            // Start a new cell\n            tCell = new TableCell();\n            lPreviousColumn = lColumn;\n        }\n\n        if (lPreviousLanguage != lLanguage)\n        {\n            lPreviousLanguage = lLanguage;\n            tCell.Text = IsDbNull(aReader, lLabelOrd) ? "" : Convert.ToString(aReader[lLabelOrd]);\n        }\n    }\n\n    // Add any remaining row and cell\n    if (tRow != null && tRow.Cells.Count > 0)\n        tButtons.Rows.Add(tRow);\n    \n    CloseConnection();\n    return tButtons;\n}