using System.Data;\nusing System.Data.SqlClient;\n\npublic async Task<DataSet> FillDataSetAsync(SqlCommand command)\n{\n    using (var connection = new SqlConnection(command.Connection.ConnectionString))\n    {\n        await connection.OpenAsync();\n        \n        // Execute the command asynchronously and get the SqlDataReader\n        using (var reader = await command.ExecuteReaderAsync())\n        {\n            var dataSet = new DataSet();\n\n            do\n            {\n                // Create a DataTable from the schema of the current result set\n                var dataTable = new DataTable();\n                dataTable.Load(reader);\n                dataSet.Tables.Add(dataTable);\n\n            } while (await reader.NextResultAsync());\n\n            return dataSet;\n        }\n    }\n}