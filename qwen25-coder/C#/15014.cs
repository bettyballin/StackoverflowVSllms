using System;\nusing System.Diagnostics;\n\nclass RegistryTestSetup\n{\n    public static void ImportRegFile(string regFilePath)\n    {\n        var processInfo = new ProcessStartInfo("reg.exe", $"import \"{regFilePath}\"")\n        {\n            RedirectStandardError = true,\n            UseShellExecute = false,\n            CreateNoWindow = true\n        };\n\n        using (var process = Process.Start(processInfo))\n        {\n            process.WaitForExit();\n            if (process.ExitCode != 0)\n            {\n                string error = process.StandardError.ReadToEnd();\n                throw new Exception($"Failed to import reg file. Exit code: {process.ExitCode}, Error: {error}");\n            }\n        }\n    }\n\n    // Example usage\n    public static void Main()\n    {\n        string regFilePath = @"C:\path\to\your\test-registry.reg";\n        try\n        {\n            ImportRegFile(regFilePath);\n            Console.WriteLine("Registry file imported successfully.");\n            // Add your test logic here\n\n            // Don't forget to clean up or remove the registry changes after testing\n        }\n        catch (Exception ex)\n        {\n            Console.Error.WriteLine($"Error: {ex.Message}");\n        }\n    }\n}