using System;\nusing System.Security.Principal;\n\npublic class Impersonator : IDisposable\n{\n    private readonly WindowsImpersonationContext _impersonationContext;\n\n    public Impersonator(string domain, string username, string password)\n    {\n        var tempWindowsIdentity = new WindowsIdentity(username, domain, password);\n        _impersonationContext = tempWindowsIdentity.Impersonate();\n    }\n\n    public void Dispose()\n    {\n        _impersonationContext.Undo();\n    }\n}\n\npublic static void RunProcessAsUser(string processName, string username, string domain, string password)\n{\n    using (new Impersonator(domain, username, password))\n    {\n        System.Diagnostics.Process.Start(processName);\n    }\n}