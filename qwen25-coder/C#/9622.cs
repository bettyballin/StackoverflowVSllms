using System;\nusing Microsoft.Web.Administration;\n\npublic class IISChecker\n{\n    public bool IsIisVersionSupportingApplicationPools()\n    {\n        try\n        {\n            using (ServerManager server = new ServerManager())\n            {\n                // Try to access ApplicationPools which availability indicates support for App Pools.\n                var appPools = server.ApplicationPools;\n                return true; // If we can get this far, it means the instance supports Application Pools.\n            }\n        }\n        catch (NotImplementedException)\n        {\n            // Thrown if ServerManager is not available on pre-Vista or pre-2008 versions of Windows\n            return false;\n        }\n        catch (PlatformNotSupportedException)\n        {\n            // Thrown if IIS is not installed\n            return false;\n        }\n    }\n}