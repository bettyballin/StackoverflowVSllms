public class IocControllerFactory : DefaultControllerFactory\n{\n    protected override IController GetControllerInstance(Type controllerType)\n    {\n        // Check if the controller type is null and return null as well.\n        if (controllerType == null) return null;\n\n        try\n        {\n            // Use StructureMap's ObjectFactory to get an instance of the controller.\n            return ObjectFactory.GetInstance(controllerType) as IController;\n        }\n        catch (StructureMapException smex)\n        {\n            // Log detailed information about the exception and registered types.\n            System.Diagnostics.Debug.WriteLine(ObjectFactory.WhatDoIHave());\n            throw new InvalidOperationException($"Could not instantiate the controller type '{controllerType.Name}'", smex);\n        }\n    }\n}