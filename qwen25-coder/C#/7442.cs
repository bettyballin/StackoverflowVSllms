using System;\nusing System.Collections.Generic;\nusing System.DirectoryServices;\n\npublic class IIS6AppPoolRetriever\n{\n    public static string GetApplicationPoolForSite(string serverName, int siteId)\n    {\n        using (DirectoryEntry entry = new DirectoryEntry($"IIS://{serverName}/W3SVC/{siteId}"))\n        {\n            // Look for the root virtual directory which typically has the Application pool setting if not inherited\n            foreach (DirectoryEntry child in entry.Children)\n            {\n                if (child.Name.Equals("Root", StringComparison.OrdinalIgnoreCase))\n                {\n                    return (string)child.Properties["AppPoolId"].Value;\n                }\n            }\n        }\n\n        throw new Exception("Could not find application pool for the specified site.");\n    }\n\n    public static void Main(string[] args)\n    {\n        const string serverName = "localhost"; // or specify your server name\n        int siteId = 1; // Set this to your site-id\n\n        try\n        {\n            string appPoolName = GetApplicationPoolForSite(serverName, siteId);\n            Console.WriteLine($"Application Pool Name: {appPoolName}");\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine($"Error: {ex.Message}");\n        }\n    }\n}