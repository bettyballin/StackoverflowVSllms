protected void Application_AuthenticateRequest(Object sender, EventArgs e)\n   {\n       HttpApplication app = (HttpApplication)sender;\n       HttpContext context = app.Context;\n       \n       // Check if cookie-less authentication info exists\n       var authCookie = context.Request.Cookies[FormsAuthentication.FormsCookieName];\n       FormsAuthenticationTicket ticket = authCookie != null ? FormsAuthentication.Decrypt(authCookie.Value) : null;\n       \n       if (ticket == null || !ticket.Expired)\n           return;\n\n       // If we reach here, it means the ticket is expired.\n       var url = FormsAuthentication.GetRedirectUrl(ticket.Name, false);\n       context.Response.Redirect FormsAuthentication.LoginUrl + "?ReturnUrl=" + System.Web.HttpUtility.UrlEncode(url));\n   }