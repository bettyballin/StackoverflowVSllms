using Confluent.Kafka;\nusing MongoDB.Driver;\n\npublic class DataHandler\n{\n    private readonly MongoClient _mongoClient;\n    private readonly IMongoDatabase _database;\n    public DataHandler(string mongoConnectionString, string db)\n    {\n        _mongoClient = new MongoClient(mongoConnectionString);\n        _database = _mongoClient.GetDatabase(db);\n    }\n\n    // Method to send data to Kafka\n    public void SendDataToKafka(string topicName, byte[] dataBytes)\n    {\n        var config = new ProducerConfig { BootstrapServers = "localhost:9092" };\n        \n        using (var producer = new ProducerBuilder<Null, byte[]>(config).Build())\n        {\n            producer.Produce(topicName, new Message<Null, byte[]> { Value = dataBytes });\n        }\n    }\n\n    // Method to save processed data to MongoDB\n    public void SaveProcessedData<T>(string collectionName, T document)\n    {\n        var collection = _database.GetCollection<T>(collectionName);\n        collection.InsertOne(document);\n    }\n}