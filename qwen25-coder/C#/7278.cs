using System;\nusing System.Management;\n\npublic class IisHelper\n{\n    public static void CreateWebsite(string webSiteName, string path, int port)\n    {\n        ManagementClass mc = new ManagementClass("IIsWebVirtualDirSetting");\n        ManagementObject siteObj = null;\n\n        // Obtain in-parameters for the method\n        ManagementBaseObject inParams =\n            mc.GetMethodParameters("CreateNewSite");\n\n        inParams["ServerBinding"] = ":" + port.ToString() + ":";\n        inParams["PathOfRootVirtualDir"] = path;\n        inParams["ServerComment"] = webSiteName;\n\n        // Get WMI namespace\n        ManagementScope scope = new ManagementScope("root\\MicrosoftIISV2");\n\n        // Get object on which the method will be called\n        ManagementObject objWebHostingManager =\n            new ManagementObject(scope, new ManagementPath("IIsWebService='W3SVC'"), null);\n\n        // Call method and receive return values in outParams\n        ManagementBaseObject outParams = objWebHostingManager.InvokeMethod("CreateNewSite", inParams, null);\n    }\n}\n\nclass Program\n{\n    static void Main()\n    {\n        IisHelper.CreateWebsite("MyNewSite", @"C:\inetpub\wwwroot\MyApp", 8080);\n    }\n}