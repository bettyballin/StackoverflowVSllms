public class UnitOfWork : IUnitOfWork, IDisposable\n{\n    public ISession Session { get; private set; }\n\n    public UnitOfWork(ISession session)\n    {\n        this.Session = session;\n    }\n\n    public void Commit()\n    {\n        if (Session.Transaction.IsActive)\n            Session.Transaction.Commit();\n    }\n\n    public void Dispose()\n    {\n        if (Session == null) return;\n\n        try\n        {\n            if (!Session.Transaction.WasCommitted && !Session.Transaction.WasRolledBack)\n                Session.Transaction.Rollback();\n        }\n        finally\n        {\n            Session.Close();\n            Session.Dispose();\n        }\n    }\n}