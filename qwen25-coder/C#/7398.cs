using System.Windows.Automation;\n\nAutomationElement app = AutomationElement.RootElement.FindFirst(TreeScope.Children,\n    new PropertyCondition(AutomationElement.NameProperty, "Your Application Name"));\n\n// Find the element you want to right-click on\nAutomationElement targetControl = app.FindFirst(TreeScope.Descendants, \n    new PropertyCondition(AutomationElement.ControlTypeProperty, ControlType.Button));\n\nif (targetControl != null)\n{\n    MousePattern mousePattern = (MousePattern)targetControl.GetCurrentPattern(MousePattern.Pattern);\n    \n    // Perform a right click\n    mousePattern.Move(targetControl.GetClickablePoint());\n    mousePattern.RightClick();\n\n    // Find the context menu and select an item\n    AutomationElement contextMenu = targetControl.FindFirst(TreeScope.Children, \n        new PropertyCondition(AutomationElement.ControlTypeProperty, ControlType.ContextMenu));\n\n    if (contextMenu != null)\n    {\n        AutomationElement menuItem = contextMenu.FindFirst(TreeScope.Descendants,\n            new PropertyCondition(AutomationElement.NameProperty, "Your Menu Item Name"));\n\n        InvokePattern invokePattern = (InvokePattern)menuItem.GetCurrentPattern(InvokePattern.Pattern);\n        invokePattern.Invoke();\n    }\n}