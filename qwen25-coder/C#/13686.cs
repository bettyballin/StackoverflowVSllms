using System;\nusing System.Net.Sockets;\nusing System.Text;\n\npublic class ConditionalSocketServer\n{\n    private readonly Socket _listener;\n    private static readonly string AllowedIPAddress = "127.0.0.1";\n\n    public ConditionalSocketServer(int port)\n    {\n        _listener = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);\n        var endPoint = System.Net.IPEndPoint.Parse($"0.0.0.0:{port}");\n        _listener.Bind(endPoint);\n        _listener.Listen(5);\n    }\n\n    public void StartListening()\n    {\n        Console.WriteLine("Server started. Waiting for connections...");\n\n        while (true)\n        {\n            // Begin an asynchronous accept operation\n            _listener.BeginAccept(new AsyncCallback(AcceptCallback), null);\n        }\n    }\n\n    private void AcceptCallback(IAsyncResult result)\n    {\n        Socket listener = (Socket)result.AsyncState;\n\n        try\n        {\n            // End the asynchronous accept operation\n            Socket handler = listener.EndAccept(result);\n\n            if (IsAllowed(handler.RemoteEndPoint))\n            {\n                Console.WriteLine($"Accepting connection from {handler.RemoteEndPoint}.");\n                // Handle data transmission here or start a new thread for handling.\n            }\n            else\n            {\n                Console.WriteLine($"Rejecting connection from {handler.RemoteEndPoint}.");\n                handler.Close();\n            }\n\n            // Continue listening for more connections\n            listener.BeginAccept(new AsyncCallback(AcceptCallback), listener);\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine("Error accepting connection: " + ex.Message);\n        }\n    }\n\n    private bool IsAllowed(System.Net.EndPoint endPoint)\n    {\n        var ipEndPoint = (System.Net.IPEndPoint)endPoint;\n        return ipEndPoint.Address.ToString() == AllowedIPAddress;\n    }\n}\n\n// Usage\nclass Program\n{\n    static void Main()\n    {\n        ConditionalSocketServer server = new ConditionalSocketServer(5000);\n        server.StartListening();\n    }\n}