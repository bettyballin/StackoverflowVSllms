using System.Security.Principal;\nusing System.Runtime.InteropServices;\n\npublic static ArrayList GetEthernetMacAddresses()\n{\n    WindowsIdentity wi = WindowsIdentity.GetCurrent();\n    using (WindowsImpersonationContext wic = wi.Impersonate())\n    {\n        ArrayList addresses = new ArrayList();\n        ManagementClass mc = new ManagementClass("Win32_NetworkAdapter");\n        EnumerationOptions options = new EnumerationOptions();\n        options.EnumerateDeep = true;\n\n        foreach (ManagementObject mo in mc.GetInstances(options))\n        {\n            string macAddr = mo["MACAddress"] as string;\n            string adapterType = mo["AdapterType"] as string;\n\n            if (!string.IsNullOrEmpty(macAddr) && !string.IsNullOrEmpty(adapterType))\n            {\n                if (adapterType.StartsWith("Ethernet"))\n                {\n                    addresses.Add(macAddr);\n                }\n            }\n        }\n        return addresses;\n    }\n}