int numApprovals = 0;\nstring sql = "SELECT COUNT(Type) AS OpenforApproval " +\n             "FROM dbo.LeaveRequest " +\n             "WHERE Type IN (2, 3, 4, 5, 6, 8, 13, 14, 16, 22) " +\n             "GROUP BY MgtApproval " +\n             "HAVING MgtApproval IS NULL";\n\nusing (cn = new SqlConnection(ConnectionString()))\n{\n    cn.Open();\n    using (cmd = new SqlCommand(sql, cn))\n    {\n        cmd.CommandType = CommandType.Text;\n        object result = cmd.ExecuteScalar();\n        numApprovals = result == DBNull.Value ? 0 : (int)result;\n    }\n}\n\nreturn numApprovals;