using System;\nusing System.Linq;\nusing Microsoft.Office.Interop.Excel;\n\npublic void ExportToExcel()\n{\n    // Assuming 'db' is your data context and MyTable contains the data you're querying.\n    var data = from d in db.MyTable\n               where d.Name == "Test"\n               select new { Name = d.Name, OtherColumn = d.OtherColumn };\n\n    // Create a new Excel application instance.\n    Application excelApp = new Application();\n    \n    if (excelApp == null)\n    {\n        Console.WriteLine("Excel is not properly installed!");\n        return;\n    }\n\n    // Add a Workbook and Worksheet\n    Workbook workBook = excelApp.Workbooks.Add(XlWBATemplate.xlWBATWorksheet);\n    Worksheet worksheet = (Worksheet)workBook.Sheets[1];\n\n    // Header Row\n    worksheet.Cells[1, 1] = "Name";\n    worksheet.Cells[1, 2] = "Other Column";\n\n    int row = 2; // Start from the second row for data\n\n    foreach (var item in data)\n    {\n        worksheet.Cells[row, 1] = item.Name;\n        worksheet.Cells[row, 2] = item.OtherColumn;\n        row++;\n    }\n\n    // Auto fit columns\n    Range usedRange = worksheet.UsedRange;\n    usedRange.Columns.AutoFit();\n\n    // Save the workbook and quit Excel\n    workBook.SaveAs(Filename: @"C:\path\to\your\file.xls");\n    excelApp.Quit();\n\n    // Release COM objects to fully kill Excel process from running in the background.\n    System.Runtime.InteropServices.Marshal.ReleaseComObject(worksheet);\n    System.Runtime.InteropServices.Marshal.ReleaseComObject(workBook);\n    System.Runtime.InteropServices.Marshal.ReleaseComObject(excelApp);\n\n    worksheet = null;\n    workBook = null;\n    excelApp = null;\n\n    GC.Collect();\n}