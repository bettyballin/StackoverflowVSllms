using System;\nusing System.Runtime.InteropServices;\n\npublic class ExcelHelper\n{\n    private dynamic excelApp = null;\n\n    public ExcelHelper()\n    {\n        try\n        {\n            // Try to create an instance of Excel 2007 or later\n            excelApp = Activator.CreateObject("Excel.Application", Type.Missing);\n        }\n        catch (COMException)\n        {\n            try\n            {\n                // If that fails, attempt to create an instance of Excel 2003 or earlier\n                excelApp = Marshal.GetActiveObject("Excel.Application");\n            }\n            catch (Exception ex)\n            {\n                Console.WriteLine("Could not access Excel. " + ex.Message);\n                throw;\n            }\n        }\n\n        if (excelApp == null) throw new InvalidOperationException("Unable to create or connect to an Excel instance.");\n    }\n\n    public void OpenWorkbook(string filePath)\n    {\n        // Late binding example for opening a workbook\n        excelApp.Workbooks.Open(filePath, Type.Missing, false,\n                                Type.Missing, Type.Missing, Type.Missing, Type.Missing,\n                                Type.Missing, Type.Missing, Type.Missing, Type.Missing,\n                                Type.Missing, false, Type.Missing, Type.Missing, Type.Missing);\n    }\n\n    public void Quit()\n    {\n        if (excelApp != null)\n        {\n            excelApp.Quit();\n            System.Runtime.InteropServices.Marshal.ReleaseComObject(excelApp);\n            excelApp = null;\n        }\n    }\n}