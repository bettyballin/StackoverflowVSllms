using System;\nusing System.Linq;\n\nvar query = from forum in db.Forums\n            join thread in db.ForumThreads on forum.ForumId equals thread.ForumId into threadsGroup\n            from thread in threadsGroup.DefaultIfEmpty()\n            group new { forum, thread } by forum.ForumId into forumsGroup\n            let lastPost = forumsGroup.SelectMany(g => g.thread != null \n                                                        ? db.ForumPosts.Where(p => p.ThreadId == g.thread.ThreadId) \n                                                                                  .OrderByDescending(p => p.CreateDate).FirstOrDefault() \n                                                        : null)\n                                    .FirstOrDefault()\n            select new \n            {\n                ForumTitle = forumsGroup.Key,\n                TopicsCount = forumsGroup.Count(g => g.thread != null),\n                PostsCount = forumsGroup.Sum(g => g.thread != null ? db.ForumPosts.Count(p => p.ThreadId == g.thread.ThreadId) : 0),\n                LastPostUserId = lastPost?.UserId,\n                LastPostTime = lastPost?.CreateDate\n            };\n\nforeach(var forum in query)\n{\n    Console.WriteLine($"Forum: {forum.ForumTitle} --- Topics: {forum.TopicsCount} --- Posts: {forum.PostsCount} --- Last Post UserId: {forum.LastPostUserId} --- Last Post Time: {forum.LastPostTime}");\n}