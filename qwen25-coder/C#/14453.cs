using System.Collections.ObjectModel;\nusing System.ComponentModel.Composition;\nusing System.ComponentModel.Composition.Hosting;\n\nnamespace MyAddIn\n{\n    public class TreeNodeManager\n    {\n        [ImportMany(typeof(ITreeNodeType))]\n        private ObservableCollection<Lazy<ITreeNodeType, ITreeNodeMetadata>> _nodes { get; set; }\n\n        private CompositionContainer _container;\n\n        public TreeNodeManager()\n        {\n            var catalog = new AggregateCatalog();\n            catalog.Catalogs.Add(new DirectoryCatalog(".")); // Add path to your plugins\n            _container = new CompositionContainer(catalog);\n            _container.ComposeParts(this);\n        }\n\n        public ObservableCollection<Lazy<ITreeNodeType, ITreeNodeMetadata>> GetNodes()\n        {\n            return _nodes;\n        }\n    }\n}