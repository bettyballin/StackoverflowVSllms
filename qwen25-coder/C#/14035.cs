using System;\nusing System.Runtime.InteropServices;\n\npublic class ExcelManager : IDisposable\n{\n    private Microsoft.Office.Interop.Excel.Application excelApp;\n    private Microsoft.Office.Interop.Excel.Workbook workbook;\n    private Microsoft.Office.Interop.Excel.Worksheet worksheet;\n\n    public void OpenExcel(string filePath)\n    {\n        excelApp = new Microsoft.Office.Interop.Excel.Application();\n        workbook = excelApp.Workbooks.Open(filePath);\n        worksheet = workbook.Sheets[1];\n    }\n\n    public void CloseExcel()\n    {\n        if (worksheet != null) { Marshal.ReleaseComObject(worksheet); worksheet = null; }\n        if (workbook != null) { workbook.Close(false, Type.Missing, Type.Missing); Marshal.ReleaseComObject(workbook); workbook = null; }\n        if (excelApp != null) { excelApp.Quit(); Marshal.ReleaseComObject(excelApp); excelApp = null; }\n\n        GC.Collect();\n        GC.WaitForPendingFinalizers();\n    }\n\n    public void Dispose()\n    {\n        CloseExcel();\n    }\n}