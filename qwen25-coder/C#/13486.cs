using System.Windows.Controls;\nusing System.Windows.Media;\n\nprivate bool IsVerticalScrollbarVisible(ListBox listBox)\n{\n    // Get the ScrollViewer from the ListBox\n    ScrollViewer scrollViewer = null;\n    for (int i = 0; i < VisualTreeHelper.GetChildrenCount(listBox); i++)\n    {\n        var element = VisualTreeHelper.GetChild(listBox, i);\n        if (element is Border border)\n        {\n            scrollViewer = border.Child as ScrollViewer;\n        }\n    }\n\n    // Check the visibility of the vertical scrollbar\n    return scrollViewer != null && \n           scrollViewer.ComputeVerticalScrollBarVisibility() == System.Windows.Visibility.Visible;\n}\n\n// Usage\nbool isVisible = IsVerticalScrollbarVisible(listOfItems);