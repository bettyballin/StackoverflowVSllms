using System;\nusing System.DirectoryServices;\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        string serverName = Environment.MachineName;\n        try\n        {\n            DirectoryEntry dir = new DirectoryEntry("IIS://" + serverName + "/W3SVC/1/ROOT", @"adminusername", @"password");\n            dir.AuthenticationType = AuthenticationTypes.ServerBind; // Use ServerBind for local connections or Secure for remote\n            PrintChildren(dir, 0);\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine("Error accessing IIS: " + ex.Message);\n        }\n    }\n\n    private static void PrintChildren(DirectoryEntry entry, int level)\n    {\n        try\n        {\n            foreach (DirectoryEntry child in entry.Children)\n            {\n                Console.Write("\n");\n                Console.Write("|");\n                for (int i = 0; i < level; i++)\n                {\n                    Console.Write("----");\n                }\n                Console.Write(child.Name);\n\n                if (child.Children != null && child.SchemaClassName.Contains("VirtualDir"))\n                {\n                    PrintChildren(child, level + 1);\n                }\n            }\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine("\nError accessing children: " + ex.Message);\n        }\n    }\n}