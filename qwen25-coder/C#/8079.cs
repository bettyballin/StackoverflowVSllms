using (var db = new cdsDBDataContext())\n{\n    var query = from items in db.cdsItems\n                select new \n                {\n                    ItemNumber = items.ItemNumber,\n                    NewQuantity = \n                        items.itempromoflag != "N" ? 100000 :\n                        new HashSet<string> { "1", "2", "31" }.Contains(items.itemcat1) && items.itemsalestatus == "S" ? 100000 :\n                        items.itemsalestatus == "O" ? 0 :\n                        items.cds_oeinvitem.itemqtyonhand - items.cds_oeinvitem.itemqtycommitted\n                };\n\n    // Optionally, filter based on your where conditions\n    query = query.Where(x => x.ItemHandHeldFlag == "Y" && x.NewQuantity > 0);\n\n    // Execute the query and process results, e.g. update database\n    foreach (var item in query)\n    {\n        var product = db.osc_products.FirstOrDefault(p => p.ProductId == item.ItemNumber);\n        if (product != null)\n        {\n            product.products_quantity = item.NewQuantity;\n        }\n    }\n\n    // Submit changes to the database\n    db.SubmitChanges();\n}