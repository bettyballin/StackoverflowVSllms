// For Rows 1-3 which are index 0-2 in RowDefinitions collection (since we skip the first and last row)\nfor (int elementRow = 1; elementRow <= 3; elementRow++)\n{\n    TextBlock textblock = GetTextBlockFromGrid(grid, elementRow); // Assume you have a method to retrieve TextBlock\n\n    if (!string.IsNullOrEmpty(textblock.Text))\n    {\n        grid.RowDefinitions[elementRow].Height = new GridLength(20, GridUnitType.Pixel);\n    }\n    else\n    {\n        grid.RowDefinitions[elementRow].Height = new GridLength(0, GridUnitType.Auto);\n    }\n}