using System.Data;\nusing System.Text;\nusing System.Data.SqlClient;\n\npublic static DataTable GetHistory(DateTime from, DateTime to, bool paramedics, bool police, bool firefighters)\n{\n    StringBuilder select = new StringBuilder("SELECT call_time, location, emergency_type FROM call WHERE call_time BETWEEN @from AND @to");\n\n    List<string> conditions = new List<string>();\n    if (paramedics) conditions.Add("emergency_type = 'paramedics'");\n    if (police) conditions.Add("emergency_type = 'police'");\n    if (firefighters) conditions.Add("emergency_type = 'firefighters'");\n\n    if (conditions.Count > 0)\n    {\n        select.Append(" AND ");\n        select.Append(string.Join(" OR ", conditions));\n    }\n\n    using (SqlConnection connection = new SqlConnection(YourConnectionString))\n    {\n        using (SqlCommand command = new SqlCommand(select.ToString(), connection))\n        {\n            command.Parameters.AddWithValue("@from", from);\n            command.Parameters.AddWithValue("@to", to);\n\n            SqlDataAdapter adapter = new SqlDataAdapter(command);\n            DataTable dataTable = new DataTable();\n            adapter.Fill(dataTable);\n\n            return dataTable;\n        }\n    }\n}