using System;\nusing Microsoft.Web.Administration;\n\npublic class SetupIIS\n{\n    public static void CreateVirtualDirectory(string siteName, string vDirPath, string physicalPath)\n    {\n        using (ServerManager serverManager = new ServerManager())\n        {\n            Site site = serverManager.Sites[siteName];\n            if (site == null) throw new ArgumentException($"Site {siteName} does not exist.");\n\n            bool virtualDirectoryExists = false;\n            \n            foreach (Application application in site.Applications)\n            {\n                foreach (VirtualDirectory vdir in application.VirtualDirectories)\n                {\n                    if (vdir.Path.Equals(vDirPath, StringComparison.OrdinalIgnoreCase))\n                    {\n                        virtualDirectoryExists = true;\n                        break;\n                    }\n                }\n            }\n\n            if (!virtualDirectoryExists)\n            {\n                Site defaultSite = serverManager.Sites[siteName];\n                Application app = defaultSite.Applications["/"];\n\n                app.VirtualDirectories.Add(vDirPath, physicalPath);\n                serverManager.CommitChanges();\n            }\n        }\n    }\n\n    public static void Main()\n    {\n        try\n        {\n            CreateVirtualDirectory("Default Web Site", "/MedicatiebeheerFittests", @"C:\path\to\your\webapp");\n            Console.WriteLine("Virtual directory created successfully.");\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine($"Failed to create virtual directory: {ex.Message}");\n        }\n    }\n}