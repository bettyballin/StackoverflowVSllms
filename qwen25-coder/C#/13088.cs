private void saveBtn_Click(object sender, EventArgs e)\n{\n    try\n    {\n        string attachment = attachTxtBox.Text;\n\n        if (string.IsNullOrEmpty(configFileName))\n        {\n            throw new InvalidOperationException("Configuration file name is not specified.");\n        }\n\n        var configMap = new ExeConfigurationFileMap { ExeConfigFilename = configFileName };\n        Configuration externalConfig = ConfigurationManager.OpenMappedExeConfiguration(configMap, ConfigurationUserLevel.None);\n\n        if (externalConfig == null)\n        {\n            throw new InvalidOperationException("Failed to open the configuration file.");\n        }\n        \n        if (externalConfig.AppSettings.Settings == null)\n        {\n            throw new InvalidOperationException("AppSettings in the configuration file are null.");\n        }\n\n        externalConfig.AppSettings.Settings["ServerAddress"].Value = serverAddr;\n        externalConfig.AppSettings.Settings["Port"].Value = port;\n        externalConfig.AppSettings.Settings["SSL"].Value = ssl.ToString();\n        externalConfig.AppSettings.Settings["Sender"].Value = senderAddr;\n        externalConfig.AppSettings.Settings["SenderPassword"].Value = password;\n        externalConfig.AppSettings.Settings["Subject"].Value = subject;\n        externalConfig.AppSettings.Settings["AttachmentPath"].Value = attachment;\n        externalConfig.AppSettings.Settings["Body"].Value = messageBody;\n\n        // Save values in config\n        externalConfig.Save(ConfigurationSaveMode.Full);\n        Application.Exit();\n    }\n    catch (System.Exception ex)\n    {\n        MessageBox.Show("Error: " + ex.Message, "Exception Details", MessageBoxButtons.OK, MessageBoxIcon.Error);\n        // Optionally log the stack trace for further debugging\n        Console.WriteLine(ex.StackTrace);\n        Application.Exit();\n    }\n}