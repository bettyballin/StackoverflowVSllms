public class AuthenticationModule : IHttpModule\n{\n    public void Init(HttpApplication context)\n    {\n        context.PostAuthenticateRequest += Context_PostAuthenticateRequest;\n    }\n\n    private void Context_PostAuthenticateRequest(object sender, EventArgs e)\n    {\n        var app = (HttpApplication)sender;\n        var user = app.Context.User?.Identity;\n\n        if (user is not null && !user.IsAuthenticated)\n            return;\n\n        // Simulate authentication and role assignment\n        var roles = new[] { "domain\\group", "admin" };\n        var principal = new CustomPrincipal(user);\n        principal.SetRoles(roles);\n\n        app.Context.User = principal;\n    }\n\n    public void Dispose() {}\n}