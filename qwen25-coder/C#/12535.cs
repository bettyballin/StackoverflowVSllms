public static Broker GetBroker(List<Broker> brokers, int totalWeight)\n{\n    int randomNumber = _rnd.Next(0, totalWeight);\n    int cumulativeWeight = 0;\n\n    foreach (Broker broker in brokers)\n    {\n        cumulativeWeight += broker.Weight;\n        if (randomNumber < cumulativeWeight)\n        {\n            return broker;\n        }\n    }\n\n    // Fallback return statement, should never be reached if totalWeight is accurate.\n    throw new InvalidOperationException("No broker selected.");\n}