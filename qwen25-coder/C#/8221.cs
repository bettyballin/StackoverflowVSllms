using System;\nusing System.IO;\n\npublic class FileChecker\n{\n    public static bool IsFileReady(string filePath, int maxAttempts = 5, int delayInMilliseconds = 100)\n    {\n        for (int attempts = 0; attempts < maxAttempts; attempts++)\n        {\n            try\n            {\n                using (FileStream inputStream = new FileStream(filePath, FileMode.Open, FileAccess.Read, FileShare.None))\n                {\n                    // If the file is successfully opened, it is not being written to.\n                    return true;\n                }\n            }\n            catch (IOException)\n            {\n                // The file could be in use by another process.\n                System.Threading.Thread.Sleep(delayInMilliseconds);\n            }\n        }\n\n        // If we've reached here, then the file was in use for too long or an error occurred.\n        return false;\n    }\n}