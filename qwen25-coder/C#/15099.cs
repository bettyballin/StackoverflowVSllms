using System;\nusing System.Collections.Generic;\nusing System.DirectoryServices.Protocols;\n\nnamespace LDAPExample\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            // Connect to the LDAP server\n            LdapConnection connection = new LdapConnection("ldap://your-ldap-server");\n            NetworkCredential credentials = new NetworkCredential("username", "password");\n            connection.Bind(credentials);\n\n            // User DN\n            string userDN = "uid=DaffyD,OU=Ducks,OU=People,O=A";\n\n            // Search for parent OU entries of the user\n            SearchRequest searchRequest = new SearchRequest(\n                "",\n                $"(member={userDN})",\n                SearchScope.Subtree,\n                new string[] { "distinguishedName" }\n            );\n\n            // Execute the search request\n            using (SearchResponse searchResponse = (SearchResponse)connection.SendRequest(searchRequest))\n            {\n                if (searchResponse.Entries.Count > 0)\n                {\n                    Console.WriteLine("Parent OU entries containing this user:");\n                    foreach (SearchResultEntry result in searchResponse.Entries)\n                    {\n                        Console.WriteLine(result.DistinguishedName);\n                    }\n                }\n                else\n                {\n                    Console.WriteLine("No parent OUs found containing this user directly by membership.");\n                }\n            }\n\n            // If you want to trace the OU structure upwards from the user DN\n            string currentDn = userDN;\n            while (currentDn != "")\n            {\n                int lastCommaIndex = currentDn.LastIndexOf(',');\n                if (lastCommaIndex == -1) break;\n\n                string ouDn = currentDn.Substring(lastCommaIndex + 1);\n                Console.WriteLine($"Parent OU: {ouDn}");\n\n                // Move to the next level up\n                currentDn = currentDn.Substring(0, lastCommaIndex);\n            }\n\n            connection.Dispose();\n        }\n    }\n}