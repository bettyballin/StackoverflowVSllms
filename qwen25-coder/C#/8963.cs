using System;\nusing System.Data.SqlClient;\n\nclass Program\n{\n    private static int RetryCount = 5;\n    private const string ConnectionString = "your_connection_string_here";\n    private const string TableName = "[YourTableName]";\n    \n    static void Main(string[] args)\n    {\n        InsertNewRecordWithRetry();\n    }\n\n    private static void InsertNewRecordWithRetry()\n    {\n        int attempt = 0;\n        while (attempt < RetryCount)\n        {\n            try\n            {\n                InsertNewRecord();\n                return; // Exit the loop if insert succeeds\n            }\n            catch (SqlException ex) when ((SqlErrorCode)ex.Number == SqlErrorCode.DuplicateKeyViolation) \n            {\n                Console.WriteLine("Race condition detected. Retrying...");\n                attempt++;\n            }\n        }\n        throw new Exception("Could not insert record after several attempts.");\n    }\n\n    private static void InsertNewRecord()\n    {\n        using (SqlConnection connection = new SqlConnection(ConnectionString))\n        {\n            connection.Open();\n            \n            // Get the next ID\n            int nextId = GetNextId(connection);\n\n            const string sqlInsertQuery =\n                "INSERT INTO " + TableName + "(id, [OtherColumn1], [OtherColumn2]) VALUES (@id, @value1, @value2)";\n            using (SqlCommand cmd = new SqlCommand(sqlInsertQuery, connection))\n            {\n                cmd.Parameters.AddWithValue("@id", nextId);\n                cmd.Parameters.AddWithValue("@value1", "something");\n                cmd.Parameters.AddWithValue("@value2", "else");\n\n                int rows = cmd.ExecuteNonQuery();\n                Console.WriteLine($"{rows} row(s) inserted with ID {nextId}");\n            }\n        }\n    }\n\n    private static int GetNextId(SqlConnection connection)\n    {\n        const string sqlSelectMaxQuery = \n            "SELECT ISNULL(MAX(id), 0) + 1 AS NextId FROM " + TableName;\n        \n        using (SqlCommand cmd = new SqlCommand(sqlSelectMaxQuery, connection))\n        {\n            return (int)cmd.ExecuteScalar();\n        }\n    }\n}\n\nenum SqlErrorCode\n{\n    DuplicateKeyViolation = 2627 // SQL Server error code for duplicate key constraint violation\n}