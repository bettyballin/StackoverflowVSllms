using System;\nusing System.Collections.Generic;\nusing Microsoft.Office.Interop.PowerPoint;\nusing System.Runtime.InteropServices;\n\ntry\n{\n    Application ppApp = new Application();\n    Presentation ppPres = null;\n    List<Company> companies = new List<Company>();\n\n    ppApp.Visible = MsoTriState.msoTrue;\n    ppApp.WindowState = PpWindowState.ppWindowMinimized;\n\n    ppPres = ppApp.Presentations.Open(fileTxtBox.Text,\n                                      MsoTriState.msoFalse,\n                                      MsoTriState.msoFalse,\n                                      MsoTriState.msoTrue);\n\n    int slides = ppPres.Slides.Count;\n\n    for (int slide = 1; slide <= slides; slide++)\n    {\n        PowerPoint.Shape shape;\n        for (int s = 1; s <= ppPres.Slides[slide].Shapes.Count; s++)\n        {\n            shape = ppPres.Slides[slide].Shapes[s];\n            if (shape.HasTable == MsoTriState.msoTrue)\n            {\n                Cell cell = shape.Table.Cell(1, 1);\n                if (cell.Shape.TextFrame.TextRange.Text.Trim().ToLower().Contains("realized"))\n                {\n                    int rows = shape.Table.Rows.Count;\n                    Company comp = new Company(rows);\n                    InitializeCompany(ref comp, ppPres.Slides[slide]);\n                    companies.Add(comp);\n                    break; // Exit the shape loop once table is processed\n                }\n            }\n        }\n    }\n\n    SaveInExcel(companies);\n\n    ppPres.Close();\n    System.Runtime.InteropServices.Marshal.ReleaseComObject(ppPres);\n    ppPres = null;\n\n    ppApp.Quit();\n    System.Runtime.InteropServices.Marshal.ReleaseComObject(ppApp);\n    ppApp = null;\n}\ncatch (Exception ex)\n{\n    MessageBox.Show(ex.Message);\n}\nfinally\n{\n    GC.Collect();\n    GC.WaitForPendingFinalizers();\n}