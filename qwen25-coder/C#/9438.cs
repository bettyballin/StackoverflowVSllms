using System;\nusing System.Net;\nusing System.Text.RegularExpressions;\n\npublic bool IsValidReferrer(HttpRequest request)\n{\n    if (request.UrlReferrer == null || !request.UrlReferrer.IsWellFormedOriginalString())\n        return false;\n\n    var referrerUri = new Uri(request.UrlReferrer.AbsoluteUri);\n    var currentHost = request.Url.Host;\n\n    // Decode and normalize the referrer host\n    string decodedReferrerHost = WebUtility.HtmlDecode(referrerUri.Host);\n\n    // Validate that the domain matches. Consider using a whitelist for trusted domains.\n    if (!decodedReferrerHost.Equals(currentHost, StringComparison.OrdinalIgnoreCase))\n        return false;\n\n    // Optional: Additional checks or whitelisting logic can be added here\n\n    return true;\n}