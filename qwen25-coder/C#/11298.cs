private void CallAddHistoryPoint(MyStateObject state)\n{\n    // Convert MyStateObject to a Dictionary<string, object>\n    var stateDict = new Dictionary<string, object>\n    {\n        { "property1", state.Property1 },\n        { "property2", state.Property2 }\n        // Add other properties as needed\n    };\n\n    // ScriptObject is part of the System.Windows.Browser namespace\n    var scriptState = Hosting.Current.ScriptObject.CreateObject();\n    foreach (var kvp in stateDict)\n    {\n        scriptState.SetProperty(kvp.Key, kvp.Value);\n    }\n\n    HtmlPage.Window.Invoke("Sys.Application.addHistoryPoint", scriptState);\n}