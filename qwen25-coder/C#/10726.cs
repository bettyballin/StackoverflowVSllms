try {\n    _application.Session.RemoveStore(_personalFolder);\n    \n    // Releasing the COM object\n    while (System.Runtime.InteropServices.Marshal.ReleaseComObject(_personalFolder) > 0);\n    _personalFolder = null;\n\n    // Force garbage collection to clean up any references\n    GC.Collect();\n    GC.WaitForPendingFinalizers();\n\n    // Now try to delete the file\n    System.IO.File.Delete(pathToPSTFile);\n} catch (System.Runtime.InteropServices.COMException ex) {\n    // Log or handle COM exceptions here\n    Console.WriteLine("COM Exception: " + ex.Message);\n} catch (System.IO.IOException ioEx) {\n    // Handle IO exceptions, which might be due to file locks\n    Console.WriteLine("IO Exception: " + ioEx.Message);\n} finally {\n    if (_application != null) {\n        System.Runtime.InteropServices.Marshal.ReleaseComObject(_application);\n        _application = null;\n    }\n}