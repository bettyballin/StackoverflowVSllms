using System;\nusing System.Runtime.InteropServices;\n\npublic class ForegroundWindowMonitor {\n    [DllImport("user32.dll")]\n    private static extern IntPtr SetWinEventHook(uint eventMin, uint eventMax, IntPtr hmodWinEventProc,\n        WinEventDelegate lpfnWinEventProc, uint idProcess, uint idThread, uint dwFlags);\n\n    private delegate void WinEventDelegate(IntPtr hWinEventHook, uint eventType, IntPtr hwnd, int idObject, int idChild,\n        uint dwEventThread, uint dwmsEventTime);\n\n    private static WinEventDelegate _procDelegate;\n\n    public static void StartMonitoring(uint eventId) {\n        _procDelegate = new WinEventDelegate(WinEventProc);\n        IntPtr hhook = SetWinEventHook(eventId, eventId, IntPtr.Zero, _procDelegate,\n            0, 0, (uint)Constants.WINEVENT_OUTOFCONTEXT | Constants.WINEVENT_SKIPOWNPROCESS | Constants.WINEVENT_SKIPOWNTHREAD);\n    }\n\n    private static void WinEventProc(IntPtr hWinEventHook, uint eventType, IntPtr hwnd, int idObject, int idChild,\n        uint dwEventThread, uint dwmsEventTime) {\n        if (idObject == 0 && idChild == 0) {\n            Console.WriteLine("Foreground window changed to: " + GetWindowText(hwnd));\n        }\n    }\n\n    [DllImport("user32.dll", SetLastError = true)]\n    private static extern int GetWindowText(IntPtr hWnd, StringBuilder lpString, int nMaxCount);\n\n    private static string GetWindowText(IntPtr hwnd) {\n        int length = GetWindowTextLength(hwnd);\n        StringBuilder sb = new StringBuilder(length + 1);\n        GetWindowText(hwnd, sb, sb.Capacity);\n        return sb.ToString();\n    }\n\n    [DllImport("user32.dll", SetLastError = true)]\n    [return: MarshalAs(UnmanagedType.Bool)]\n    private static extern bool IsWindowVisible(IntPtr hWnd);\n\n    [DllImport("user32.dll", CharSet=CharSet.Auto)]\n    public static extern int GetWindowTextLength(IntPtr hWnd);\n}\n\npublic class Constants {\n    // Event IDs\n    public const uint EVENT_SYSTEM_FOREGROUND = 0x0003;\n\n    public const uint WINEVENT_OUTOFCONTEXT = 0x0000;\n    public const uint WINEVENT_SKIPOWNPROCESS = 0x0002;\n    public const uint WINEVENT_SKIPOWNTHREAD = 0x0004;\n}