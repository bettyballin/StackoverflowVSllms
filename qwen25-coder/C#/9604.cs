using System;\nusing System.Configuration;\nusing System.Configuration.Provider;\nusing System.Web.Security;\n\npublic static class ConfigHelper\n{\n    public static void ProtectConfigurationValues()\n    {\n        Configuration config = WebConfigurationManager.OpenWebConfiguration("~");\n        if (config.HasFile)\n        {\n            ConnectionStringsSection section = (ConnectionStringsSection)config.GetSection("connectionStrings");\n            if (!section.SectionInformation.IsProtected && !section.ElementInformation.IsLocked)\n            {\n                section.SectionInformation.ProtectSection("DataProtectionConfigurationProvider");\n                config.Save();\n            }\n            \n            AppSettingsSection appSetting = (AppSettingsSection)config.GetSection("appSettings");\n            if (!appSetting.SectionInformation.IsProtected && !appSetting.ElementInformation.IsLocked)\n            {\n                appSetting.SectionInformation.ProtectSection("DataProtectionConfigurationProvider");\n                config.Save();\n            }\n        }\n    }\n\n    public static void UnprotectConfigurationValues()\n    {\n        Configuration config = WebConfigurationManager.OpenWebConfiguration("~");\n        if (config.HasFile)\n        {\n            ConnectionStringsSection section = (ConnectionStringsSection)config.GetSection("connectionStrings");\n            if (section.SectionInformation.IsProtected && !section.ElementInformation.IsLocked)\n            {\n                section.SectionInformation.UnprotectSection();\n                config.Save();\n            }\n            \n            AppSettingsSection appSetting = (AppSettingsSection)config.GetSection("appSettings");\n            if (appSetting.SectionInformation.IsProtected && !appSetting.ElementInformation.IsLocked)\n            {\n                appSetting.SectionInformation.UnprotectSection();\n                config.Save();\n            }\n        }\n    }\n}