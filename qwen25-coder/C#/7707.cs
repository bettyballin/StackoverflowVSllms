using System;\nusing System.Configuration;\nusing System.Data.SqlClient;\nusing System.Data.Odbc;\n\nclass DataTransfer\n{\n    static void Main()\n    {\n        string sqlServerConnectionString = ConfigurationManager.ConnectionStrings["SQLServer"].ToString();\n        string oldServerConnectionString = ConfigurationManager.ConnectionStrings["Server"].ToString();\n\n        using (SqlConnection sqlConn = new SqlConnection(sqlServerConnectionString))\n        {\n            sqlConn.Open();\n            \n            // Delete existing data in SQL Server table\n            using (SqlCommand deleteCmd = new SqlCommand("DELETE FROM Data", sqlConn))\n            {\n                deleteCmd.ExecuteNonQuery();\n            }\n\n            using (OdbcConnection conn = new OdbcConnection(oldServerConnectionString))\n            {\n                string query = "SELECT * FROM BILL.TRANSACTIONS WHERE TRANSACTION='NEW'";\n                \n                conn.Open();\n\n                // Select data from the old server\n                using (OdbcCommand comm = new OdbcCommand(query, conn))\n                {\n                    using (OdbcDataReader reader = comm.ExecuteReader())\n                    {\n                        // Insert transferred data into SQL Server table\n                        if (reader.HasRows)\n                        {\n                            string insertQuery = "INSERT INTO Data (Column1, Column2) VALUES (@Value1, @Value2)";\n\n                            using (SqlCommand insertCmd = new SqlCommand(insertQuery, sqlConn))\n                            {\n                                // Define parameters and add them to command object\n                                insertCmd.Parameters.Add("@Value1", System.Data.SqlDbType.VarChar);\n                                insertCmd.Parameters.Add("@Value2", System.Data.SqlDbType.Int);\n\n                                while (reader.Read())\n                                {\n                                    // Assign each data column to parameter placeholders\n                                    insertCmd.Parameters["@Value1"].Value = reader["Column1"];\n                                    insertCmd.Parameters["@Value2"].Value = reader["Column2"];\n\n                                    insertCmd.ExecuteNonQuery();\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n\n        }\n    }\n}