using System;\nusing System.Management;\n\nclass Program\n{\n    static void Main()\n    {\n        if (!HasAdministrativePrivileges())\n        {\n            Console.WriteLine("This application must be run as an administrator.");\n            return;\n        }\n\n        const string query = "SELECT HotFixID FROM Win32_QuickFixEngineering";\n        var search = new ManagementObjectSearcher(query);\n        var collection = search.Get();\n\n        foreach (ManagementObject quickFix in collection)\n        {\n            Console.WriteLine(quickFix["HotFixID"].ToString());\n        }\n    }\n\n    static bool HasAdministrativePrivileges()\n    {\n        var identity = System.Security.Principal.WindowsIdentity.GetCurrent();\n        var principal = new System.Security.Principal.WindowsPrincipal(identity);\n        return principal.IsInRole(System.Security.Principal.WindowsBuiltInRole.Administrator);\n    }\n}