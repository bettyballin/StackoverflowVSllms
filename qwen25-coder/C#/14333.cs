private ActivityController GetActivityControllerWithViewResult()\n{\n    IActivityRepository repository = GetPopulatedRepository();\n    ActivityController activityController = GetActivityController(repository);\n    var result = activityController.Index() as ViewResult;\n    Assert.IsNotNull(result, "Expected a view result.");\n    return new { Controller = activityController, Result = result };\n}\n\n[TestMethod]\npublic void IndexReturnsAView()\n{\n    var setup = GetActivityControllerWithViewResult();\n    Assert.IsInstanceOfType(setup.Result, typeof(ViewResult));\n}\n\n[TestMethod]\npublic void IndexReturnsAViewWithAListOfActivitiesInModelData()\n{\n    var setup = GetActivityControllerWithViewResult();\n    Assert.IsInstanceOfType(setup.Result.ViewData.Model, typeof(List<Activity>));\n}