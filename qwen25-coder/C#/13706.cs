using Microsoft.Win32;\nusing System;\n\nclass DllManager {\n    const string RegistryKeyPath = @"SOFTWARE\MyCompany\SharedDlls";\n    const string CounterValueName = "UseCount";\n\n    public static void RegisterDll(string dllPath) {\n        using (RegistryKey key = Registry.LocalMachine.CreateSubKey(RegistryKeyPath)) {\n            if (key != null) {\n                int count = (int)(key.GetValue(CounterValueName, 0));\n                key.SetValue(CounterValueName, count + 1);\n            }\n        }\n    }\n\n    public static void UnregisterDll(string dllPath) {\n        using (RegistryKey key = Registry.LocalMachine.OpenSubKey(RegistryKeyPath, true)) {\n            if (key != null) {\n                int count = (int)(key.GetValue(CounterValueName, 0));\n                if (count > 1) {\n                    key.SetValue(CounterValueName, count - 1);\n                } else {\n                    // Optionally unregister and delete the DLL\n                    key.DeleteSubKeyTree(RegistryKeyPath);\n                    System.IO.File.Delete(dllPath);\n                }\n            }\n        }\n    }\n}