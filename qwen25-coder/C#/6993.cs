using System;\nusing MailKit;\nusing MailKit.Net.Imap;\nusing MimeKit;\n\nclass Program\n{\n    static void Main()\n    {\n        using (var client = new ImapClient())\n        {\n            try\n            {\n                // For demo purposes, accept all SSL certificates (In production, validate!)\n                client.ServerCertificateValidationCallback = (s, c, h, e) => true;\n\n                Console.WriteLine("Connecting to gmail...");\n                client.Connect("imap.gmail.com", 993, true);\n\n                // Login to your account\n                Console.WriteLine("Authenticating...");\n                client.Authenticate("your-email@gmail.com", "your-app-password");\n\n                // Select the Inbox folder\n                var inbox = client.Inbox;\n                inbox.Open(FolderAccess.ReadWrite);\n\n                // Fetch the latest messages in the folder, up to 10 messages\n                int count = inbox.Count < 10 ? inbox.Count : 10;\n                for (int i = 0; i < count; i++)\n                {\n                    var message = inbox.GetMessage(inbox.Count - 1 - i);\n                    Console.WriteLine("Subject: " + message.Subject);\n                }\n            }\n            catch (Exception ex)\n            {\n                Console.WriteLine(ex.ToString());\n            }\n        }\n    }\n}