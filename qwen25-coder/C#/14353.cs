using System;\nusing System.Data;\nusing Microsoft.Office.Interop.Excel;\n\npublic class DataSetToExcelExporter\n{\n    public void Export(DataSet dataSet, string filePath)\n    {\n        Application excelApp = new Application();\n        Workbooks workBooks = excelApp.Workbooks;\n        Workbook workBook = workBooks.Add(Type.Missing);\n        Sheets sheets = workBook.Sheets;\n\n        // Loop through the tables in DataSet\n        for (int i = 0; i < dataSet.Tables.Count; i++)\n        {\n            DataTable dataTable = dataSet.Tables[i];\n            \n            Worksheet worksheet = (Worksheet)sheets.Add(sheets[1], Type.Missing, Type.Missing, XlSheetType.xlWorksheet);\n\n            // Set the name of the sheet to the table name\n            worksheet.Name = dataTable.TableName;\n\n            // Write column headers\n            for (int j = 0; j < dataTable.Columns.Count; j++)\n            {\n                excelApp.Cells[1, 1 + j] = dataTable.Columns[j].ColumnName;\n            }\n\n            // Write rows with data\n            for (int k = 0; k < dataTable.Rows.Count; k++)\n            {\n                DataRow row = dataTable.Rows[k];\n                for (int l = 0; l < dataTable.Columns.Count; l++)\n                {\n                    excelApp.Cells[2 + k, 1 + l] = row[l].ToString();\n                }\n            }\n\n            // Auto fit columns\n            worksheet.Columns.AutoFit();\n        }\n\n        // Save the Excel file\n        workBook.SaveAs(filePath, XlFileFormat.xlWorkbookNormal);\n        workBook.Close(true);\n        excelApp.Quit();\n\n        System.Runtime.InteropServices.Marshal.ReleaseComObject(workbook);\n        System.Runtime.InteropServices.Marshal.ReleaseComObject(excelApp);\n\n        Console.WriteLine("Excel file created successfully.");\n    }\n}