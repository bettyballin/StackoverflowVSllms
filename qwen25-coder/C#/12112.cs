using System;\nusing Microsoft.Win32;\n\npublic class RegistryManager\n{\n    public static object ReadKeyValue(string keyPath, string valueName)\n    {\n        try\n        {\n            using (RegistryKey key = Registry.LocalMachine.OpenSubKey(keyPath))\n            {\n                if (key != null)\n                    return key.GetValue(valueName);\n            }\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine($"Error reading registry: {ex.Message}");\n        }\n\n        return null;\n    }\n\n    public static void WriteKeyValue(string keyPath, string valueName, object value)\n    {\n        try\n        {\n            using (RegistryKey key = Registry.LocalMachine.OpenSubKey(keyPath, true))\n            {\n                if (key != null)\n                    key.SetValue(valueName, value);\n            }\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine($"Error writing to registry: {ex.Message}");\n        }\n    }\n\n    public static void EnumerateKeys(string keyPath)\n    {\n        try\n        {\n            using (RegistryKey key = Registry.LocalMachine.OpenSubKey(keyPath))\n            {\n                if (key != null)\n                {\n                    foreach (string subKeyName in key.GetSubKeyNames())\n                    {\n                        Console.WriteLine(subKeyName);\n                    }\n                }\n            }\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine($"Error enumerating registry keys: {ex.Message}");\n        }\n    }\n\n    public static void EnumerateValues(string keyPath)\n    {\n        try\n        {\n            using (RegistryKey key = Registry.LocalMachine.OpenSubKey(keyPath))\n            {\n                if (key != null)\n                {\n                    foreach (string valueName in key.GetValueNames())\n                    {\n                        Console.WriteLine($"{valueName} = {key.GetValue(valueName)}");\n                    }\n                }\n            }\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine($"Error enumerating registry values: {ex.Message}");\n        }\n    }\n}\n\n// Example usage:\nclass Program\n{\n    static void Main()\n    {\n        string keyPath = @"SOFTWARE\ODBC\ODBC.INI\ODBC Data Sources";\n\n        // Enumerate values in the specified path\n        RegistryManager.EnumerateValues(keyPath);\n\n        // Read a specific value\n        var value = RegistryManager.ReadKeyValue(keyPath, "YourDataSourceName");\n        Console.WriteLine($"Value: {value}");\n\n        // Write a new value\n        RegistryManager.WriteKeyValue(keyPath, "NewDataSource", "YourConnectionString");\n\n        // Enumerate values again to see the changes\n        RegistryManager.EnumerateValues(keyPath);\n    }\n}