using System.IO;\nusing System.Web.Mvc;\n\npublic class MediaController : Controller\n{\n    private bool HasAccessToMedia(int userId, string mediaPath)\n    {\n        // Implement your logic to check if user has access to the media\n        // This is just a placeholder; replace with actual implementation\n        return true; // or false based on user_id and media_path\n    }\n\n    public ActionResult ServeFile(int userId, string fileName)\n    {\n        var basePath = Server.MapPath("~/App_Data/SecureMedia/");\n        var filePath = Path.Combine(basePath, fileName);\n\n        if (!System.IO.File.Exists(filePath))\n        {\n            return HttpNotFound();\n        }\n\n        if (!HasAccessToMedia(userId, filePath))\n        {\n            Response.StatusCode = (int)System.Net.HttpStatusCode.Forbidden;\n            return new EmptyResult();\n        }\n\n        // Stream the file\n        byte[] fileBytes = System.IO.File.ReadAllBytes(filePath);\n        string fileNameWithoutPath = Path.GetFileName(fileName);\n\n        return File(fileBytes, "application/octet-stream", fileNameWithoutPath);\n    }\n}