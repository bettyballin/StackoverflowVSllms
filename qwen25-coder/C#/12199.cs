private static int CalculateHeight(string text, Font font, int width, bool hasLinks)\n{\n    using (Bitmap b = new Bitmap(1, 1))\n    {\n        using (Graphics g = Graphics.FromImage(b))\n        {\n            StringFormat format = new StringFormat();\n            format.FormatFlags = StringFormatFlags.NoClipping | StringFormatFlags.WordBreak;\n            SizeF size = g.MeasureString(text, font, width, format);\n            int height = (int)Math.Ceiling(size.Height);\n            // Add extra padding if links are present\n            int extraPaddingForLinks = 5; // Adjust this value based on your observations\n            return hasLinks ? height + extraPaddingForLinks : height;\n        }\n    }\n}