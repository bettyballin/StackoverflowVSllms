using System;\nusing System.Web.Services;\n\n[WebService(Namespace = "http://example.org/")]\npublic class StatefulComService : WebService\n{\n    private static readonly string ComObjectKey = "ComObject";\n\n    [WebMethod]\n    public void Start()\n    {\n        if (Application[ComObjectKey] == null)\n        {\n            // Create COM object and store it in Application.\n            var comObject = new YourComComponent();\n            Application.Lock(); // Ensure thread safety.\n            Application[ComObjectKey] = comObject;\n            Application.UnLock();\n        }\n    }\n\n    [WebMethod]\n    public void Shutdown()\n    {\n        if (Application[ComObjectKey] != null)\n        {\n            var comObject = (YourComComponent)Application[ComObjectKey];\n            // Release COM object.\n            Marshal.ReleaseComObject(comObject);\n            Application.Lock(); // Ensure thread safety.\n            Application.Remove(ComObjectKey);\n            Application.UnLock();\n        }\n    }\n\n    [WebMethod]\n    public string GetCurrentState()\n    {\n        if (Application[ComObjectKey] != null)\n        {\n            var comObject = (YourComComponent)Application[ComObjectKey];\n            // Call method on COM object to get current state.\n            return comObject.GetCurrentState();\n        }\n        else\n        {\n            throw new Exception("COM component has not been started.");\n        }\n    }\n}