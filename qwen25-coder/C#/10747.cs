using (SqlConnection conn = new SqlConnection(connectionString))\n{\n    conn.Open();\n    using (SqlCommand cmd = new SqlCommand())\n    {\n        cmd.Connection = conn;\n        cmd.CommandText = "INSERT INTO MyTable (id, name, salary) VALUES (@id, @name, @salary)";\n\n        // Using SqlTransaction for better performance and atomicity\n        using (SqlTransaction transaction = conn.BeginTransaction("SampleTransaction"))\n        {\n            cmd.Transaction = transaction;\n\n            try\n            {\n                foreach (Employee item in employees)\n                {\n                    cmd.Parameters.Clear();  // Clear previous parameters before adding new ones\n                    cmd.Parameters.AddWithValue("@id", item.ID);\n                    cmd.Parameters.AddWithValue("@name", item.Name);\n                    cmd.Parameters.AddWithValue("@salary", item.Salary);\n\n                    cmd.ExecuteNonQuery();\n                }\n                transaction.Commit();\n            }\n            catch (Exception ex)\n            {\n                transaction.Rollback();  // Rollback in case of error\n                Console.WriteLine(ex.Message);\n            }\n        }\n    }\n}