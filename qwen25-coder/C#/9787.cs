string sql = @"SELECT \n  ComposeMail.ID,\n  ComposeMail.DateTime, \n  ComposeMail.Subject, \n  ComposeMail.CreatedBy, \n  ComposeMail.ReceiverStatus,\n  Users.Name,\n  ROW_NUMBER() OVER(ORDER BY @p_SortExpression) AS Indexing\nFROM \n  ComposeMail \nINNER JOIN\n  Users ON ComposeMail.CreatedBy = Users.ID\nWHERE \n  ToReceipientID = @p\n  AND (ReceiverStatus=3 OR ReceiverStatus=4)\n  AND (\n    Subject LIKE @SearchTerm \n    OR Body LIKE @SearchTerm \n    OR Name LIKE @SearchTerm\n  )";\n\nusing (SqlConnection conn = new SqlConnection(connectionString))\n{\n    using (SqlCommand cmd = new SqlCommand(sql, conn))\n    {\n        // Add the parameters with appropriate values\n        cmd.Parameters.AddWithValue("@p_SortExpression", sortExpression);\n        cmd.Parameters.AddWithValue("@p", toRecipientId); // Assuming you have this value from a secure source\n        string searchTerm = $"%{searchTermValue}%"; // Append wildcards here safely\n        cmd.Parameters.Add("@SearchTerm", SqlDbType.NVarChar).Value = searchTerm;\n\n        conn.Open();\n        using (SqlDataReader reader = cmd.ExecuteReader())\n        {\n            while (reader.Read())\n            {\n                // Process the results\n            }\n        }\n    }\n}