using System;\nusing System.IO;\nusing System.Text;\nusing System.Web.Mvc;\nusing System.Xml.Serialization;\n\npublic class XmlResult : ActionResult\n{\n    public object Data { get; private set; }\n    \n    public XmlResult(object data)\n    {\n        if (data == null)\n            throw new ArgumentNullException("data");\n        \n        this.Data = data;\n    }\n\n    public override void ExecuteResult(ControllerContext context)\n    {\n        if (context == null)\n            throw new ArgumentNullException("context");\n\n        if (!string.IsNullOrEmpty(context.HttpContext.Request.ContentType)) return;\n\n        var response = context.HttpContext.Response;\n        \n        response.ContentType = "application/xml";\n\n        var xmlSerializer = new XmlSerializer(Data.GetType());\n        using (var stringWriter = new StringWriter())\n        using (var writer = new XmlTextWriter(stringWriter))\n        {\n            xmlSerializer.Serialize(writer, Data);\n            response.Write(stringWriter.ToString());\n        }\n    }\n}