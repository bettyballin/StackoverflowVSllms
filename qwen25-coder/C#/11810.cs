using (var doc = new Document())\n{\n    using (MemoryStream memoryStream = new MemoryStream())\n    {\n        PdfWriter writer = PdfWriter.GetInstance(doc, memoryStream);\n\n        doc.Open();\n        doc.Add(new Paragraph("First Paragraph"));\n        doc.Add(new Paragraph("Second Paragraph"));\n\n        writer.CloseStream = false;\n        doc.Close();\n\n        // Reset the stream position to the beginning before attaching it\n        memoryStream.Position = 0;\n\n        MailMessage mm = new MailMessage("username@gmail.com", "recipient@example.com")\n        {\n            Subject = "subject",\n            IsBodyHtml = true,\n            Body = "body"\n        };\n\n        mm.Attachments.Add(new Attachment(memoryStream, "filename.pdf"));\n\n        SmtpClient smtp = new SmtpClient\n        {\n            Host = "smtp.gmail.com",\n            Port = 587,\n            EnableSsl = true,\n            Credentials = new NetworkCredential("username@gmail.com", "password")\n        };\n\n        smtp.Send(mm);\n\n        // The memory stream will be closed and disposed after the MailMessage object is sent.\n    }\n}