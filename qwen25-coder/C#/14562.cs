[RunInstaller(true)]\n   public class CustomActions : Installer\n   {\n       public override void Install(IDictionary stateSaver)\n       {\n           base.Install(stateSaver);\n           \n           // Retrieve parameters passed from setup project\n           string virtualPath = Context.Parameters["VirtualPath"];\n\n           try\n           {\n               // Connect to IIS and get the Virtual Directory object\n               using (DirectoryEntry webSite = new DirectoryEntry("IIS://localhost/W3SVC/1/Root/" + virtualPath))\n               {\n                   // Disable Anonymous Authentication\n                   webSite.Properties["AuthFlags"].Value = 5; // Remove the decimal value for anonymous access, which is 1. 4 stands for Basic Auth.\n                   webSite.CommitChanges();\n               }\n           }\n           catch (Exception ex)\n           {\n               throw new InstallException("Failed to configure IIS settings: " + ex.Message);\n           }\n       }\n   }