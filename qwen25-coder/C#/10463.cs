using System;\nusing System.ComponentModel.DataAnnotations;\n\npublic class NotEmptyIfRequiredAttribute : RequiredAttribute\n{\n    protected override ValidationResult IsValid(object value, ValidationContext validationContext)\n    {\n        if (value == null) return new ValidationResult(FormatErrorMessage(validationContext.DisplayName));\n\n        string stringValue = value as string;\n        if (string.IsNullOrEmpty(stringValue))\n            return new ValidationResult(FormatErrorMessage(validationContext.DisplayName));\n\n        return ValidationResult.Success;\n    }\n}