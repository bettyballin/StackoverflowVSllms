private string GetExpressPath()\n{\n    using (RegistryKey sqlServerKey = RegistryKey.OpenBaseKey(RegistryHive.LocalMachine, RegistryView.Registry64)\n        .OpenSubKey(@"SOFTWARE\Microsoft\Microsoft SQL Server\Instance Names\SQL"))\n    {\n        if (sqlServerKey != null)\n        {\n            string sqlExpressKeyName = sqlServerKey.GetValue("SQLEXPRESS") as string;\n            using (RegistryKey sqlInstanceSetupKey = sqlServerKey.OpenSubKey(sqlExpressKeyName + @"\Setup"))\n            {\n                if (sqlInstanceSetupKey != null)\n                {\n                    return sqlInstanceSetupKey.GetValue("SQLDataRoot").ToString();\n                }\n            }\n        }\n    }\n    throw new Exception("SQL Express path not found in the registry.");\n}