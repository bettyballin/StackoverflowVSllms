private static int CalculateHeight(string text, Font font, int width, bool hasLinks)\n{\n    Size size = TextRenderer.MeasureText(text, font, new Size(width, Int32.MaxValue), TextFormatFlags.NoClipping | TextFormatFlags.WordBreak);\n    // Add extra padding if links are present to account for spacing issues\n    int extraPaddingForLinks = 5; // Adjust this value based on your observations\n    return hasLinks ? size.Height + extraPaddingForLinks : size.Height;\n}