using System;\nusing System.IO;\nusing System.IO.Compression;\nusing System.Web;\n\npublic void GenerateAndSendZip()\n{\n    // Create a memory stream to hold the ZIP file in memory.\n    var ms = new MemoryStream();\n\n    // Use ZipArchive to create the zip file inside the memory stream.\n    using (var archive = new ZipArchive(ms, ZipArchiveMode.Create))\n    {\n        // Add files you want to include in the zip. Here we add a text file.\n        var demoFileContent = "This is some sample content.";\n        var demoEntry = archive.CreateEntry("Sample.txt");\n        using (var entryStream = demoEntry.Open())\n        using (var streamWriter = new StreamWriter(entryStream))\n        {\n            streamWriter.Write(demoFileContent);\n        }\n    }\n\n    // Reset the memory stream so it can be read from the beginning.\n    ms.Seek(0, SeekOrigin.Begin);\n\n    // Set up the response to send a file attachment.\n    HttpResponse response = HttpContext.Current.Response;\n    response.Clear();\n    response.ContentType = "application/zip";\n    response.AppendHeader("Content-Disposition", $"attachment; filename=\"YourFileName.zip\"");\n    response.BufferOutput = false;\n\n    // Write the contents of the memory stream to the HTTP response output stream.\n    ms.CopyTo(response.OutputStream);\n\n    // End the response.\n    response.End();\n}