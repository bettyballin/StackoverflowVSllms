using System;\nusing System.DirectoryServices;\n\npublic class NovellAuthenticator {\n    public static string GetUsername(string ldapPath, string userId, string password) {\n        try {\n            using (DirectoryEntry de = new DirectoryEntry(ldapPath, userId, password)) {\n                using (DirectorySearcher ds = new DirectorySearcher(de)) {\n                    ds.PageSize = int.MaxValue;\n                    ds.Filter = "(objectClass=user)";\n                    ds.PropertiesToLoad.Add("sAMAccountName");\n\n                    SearchResultCollection results = ds.FindAll();\n                    if (results != null) {\n                        foreach (SearchResult result in results) {\n                            if (result.Properties.Contains("sAMAccountName")) {\n                                return result.GetDirectoryEntry().Properties["sAMAccountName"].Value.ToString();\n                            }\n                        }\n                    }\n                }\n            }\n        } catch (Exception e) {\n            Console.WriteLine("Error: " + e.Message);\n        }\n\n        return null;\n    }\n}