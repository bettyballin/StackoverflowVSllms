using System.DirectoryServices;\nusing System.Security.Principal;\n\nstring userDistinguishedName = "CN=John Doe,CN=Users,DC=example,DC=com";\nDirectoryEntry entry = new DirectoryEntry("LDAP://" + userDistinguishedName);\nSecurityIdentifier sid = new SecurityIdentifier((byte[])entry.Properties["objectSid"][0], 0);\nstring fullSid = sid.ToString();\n\n// This should include the complete SID with the RID