using System;\nusing System.Text;\n\npublic class HtmlBuilder\n{\n    public static string BuildHtml(string panelLink, string panelImage, string imageStyle, string captionText)\n    {\n        var sb = new StringBuilder();\n        \n        // Start of the document\n        sb.Append(@"<!DOCTYPE HTML PUBLIC ""-//W3C//DTD HTML 4.01//EN""")\n          .Append @" http://www.w3.org/TR/html4/strict.dtd">\n          .AppendLine("<HTML>")\n          .AppendLine("<HEAD>")\n          .AppendLine("  <TITLE>New Document</TITLE>")\n          .AppendLine(@"  <META http-equiv=""X-UA-Compatible"" content=""IE=edge"">")\n          .AppendLine(@"  <META http-equiv=""Content-Type"" content=""text/html; charset=UTF-8"">")\n          .AppendLine("</HEAD>")\n          .AppendLine("<BODY style=\"margin: 0 auto\">")\n          .AppendLine("  <DIV style=\"text-align:center;\">");\n          \n        // Conditional anchor tag\n        if (!string.IsNullOrWhiteSpace(panelLink))\n        {\n            sb.AppendFormat(@"      <A href=""{0}"" target=""_blank"">", panelLink);\n        }\n\n        // Image always present\n        sb.AppendFormat(@"<IMG border=""0"" src=""{0}"" style=""{1}""></A>", panelImage, imageStyle);\n\n        // Conditional line break and caption text\n        if (!string.IsNullOrWhiteSpace(captionText))\n        {\n            sb.AppendFormat("<BR>{0}", captionText);\n        }\n\n        // End of the document\n        sb.AppendLine("</DIV>")\n          .AppendLine("</BODY>")\n          .AppendLine("</HTML>");\n\n        return sb.ToString();\n    }\n}\n\n// Usage example:\npublic class Program\n{\n    public static void Main()\n    {\n        string htmlContent = HtmlBuilder.BuildHtml("http://example.com", "logo.png", "max-width: 100px;", "Example Caption");\n        Console.WriteLine(htmlContent);\n    }\n}