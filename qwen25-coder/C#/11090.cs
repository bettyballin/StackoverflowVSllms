private byte[] PadByteArray(byte[] content, int blockSize)\n{\n    int remainder = content.Length % blockSize;\n    if (remainder == 0) return content; // Already aligned\n\n    int paddingSize = blockSize - remainder;\n    var paddedArray = new byte[content.Length + paddingSize];\n\n    Buffer.BlockCopy(content, 0, paddedArray, 0, content.Length);\n\n    for (int i = 0; i < paddingSize; i++)\n    {\n        paddedArray[paddedArray.Length - 1 - i] = (byte)paddingSize;\n    }\n\n    return paddedArray;\n}