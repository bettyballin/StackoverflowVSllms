using System;\nusing System.Net.Mail;\n\n// Configure SMTP client\nvar smtpClient = new SmtpClient\n{\n    Host = ConfigurationManager.AppSettings["smtpServer"],\n    Port = Convert.ToInt32(ConfigurationManager.AppSettings["smtpPort"])\n};\n\n// Create a new MailMessage object and set properties\nMailMessage mailMessage = new MailMessage();\nmailMessage.From = new MailAddress("your-email@example.com");\nmailMessage.To.Add(new MailAddress("recipient-email@example.com"));\nmailMessage.Subject = "Your CSV File";\nmailMessage.Body = "Please find the attached CSV file.";\n\n// Set content type to correct format for CSV files\nstring contentType = "text/csv";\n\ntry\n{\n    // Attach the file ensuring it exists and using correct encoding\n    Attachment attachment = new Attachment(attachmentPath, contentType);\n    mailMessage.Attachments.Add(attachment);\n\n    // Send the email\n    smtpClient.Send(mailMessage);\n}\ncatch (Exception ex)\n{\n    Console.WriteLine("Failed to send email with error: " + ex.Message);\n}\nfinally\n{\n    // Clean up resources\n    mailMessage.Dispose();\n}