using System.IO.Compression;\n\n// Clear the response and set the appropriate headers\nResponse.Clear();\nResponse.ContentType = "application/vnd.ms-excel";\nResponse.AddHeader("Content-Disposition", "attachment; filename=download.xlsx");\nResponse.Cache.SetCacheability(HttpCacheability.NoCache);\n\nusing (var memoryStream = new MemoryStream())\n{\n    using (var gzipStream = new GZipStream(memoryStream, CompressionLevel.Optimal))\n    {\n        // Write your binary data to gzip stream instead of the Response.OutputStream directly\n        // example: gzipStream.Write(binaryData, 0, binaryData.Length);\n    }\n\n    // Now the memory stream contains the compressed data\n    memoryStream.Position = 0;\n    Response.AddHeader("Content-Encoding", "gzip");\n    memoryStream.CopyTo(Response.OutputStream);\n}\n\nResponse.End();