internal class DiscoveryCallback : ICallback\n{\n    protected VixLibClass lib;\n\n    public DiscoveryCallback(VixLibClass lib)\n    {\n        this.lib = lib;\n    }\n\n    #region ICallback Members\n\n    public void OnVixEvent(IJob job, int eventType, IVixHandle moreEventInfo)\n    {\n        switch (eventType)\n        {\n            case Constants.VIX_EVENTTYPE_FIND_ITEM:\n                var guest = moreEventInfo.OpenVirtualMachine(guestPath);\n                // Handle the found item\n                Console.WriteLine("Found VM: " + guest.GetConfigStringProperty(Constants.VIX_VMPOWEROP_NORMAL_OPTIONS, out var path));\n                break;\n            case Constants.VIX_EVENTTYPE_JOB_COMPLETED:\n                if (lib.ErrorIndicatesFailure(job.Wait(new int[] { }, ref moreEventInfo)))\n                {\n                    // Handle job completion error\n                    Console.WriteLine("Job completed with an error.");\n                }\n                break;\n            default:\n                break;\n        }\n    }\n\n    #endregion\n}