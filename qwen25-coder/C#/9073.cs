using System;\nusing Microsoft.SqlServer.Management.Smo;\nusing Microsoft.SqlServer.Management.Common;\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        // Define the server connection\n        ServerConnection conn = new ServerConnection("(local)"); // or your server name\n\n        try\n        {\n            // Connect to the SQL Server instance\n            Server server = new Server(conn);\n\n            // Create a new login\n            Login newLogin = new Login(server, "NewUser");\n            newLogin.LoginType = LoginType.SqlLogin;\n            newLogin.PasswordPolicyEnforced = false; // Important for SQL logins on older versions\n            newLogin.Create("SecurePassword123");\n\n            // Select the database you want to work with\n            Database db = server.Databases["YourDatabaseName"];\n\n            // Add user to database and map it to the login\n            User newUserInDb = new User(db, "NewUser");\n            newUserInDb.Login = newLogin.Name;\n            newUserInDb.Create();\n\n            // Grant permissions - for example, granting SELECT permission on a specific table\n            Table table = db.Tables["YourTableName"];\n            Grant grant = new Grant(newUserInDb, new[] { "SELECT" });\n            grant.GrantOn(grant.EnumObjectScope.Object, table.ID);\n            grant.Execute();\n\n            Console.WriteLine("User created and permissions granted.");\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine($"An error occurred: {ex.Message}");\n        }\n        finally\n        {\n            conn.Disconnect();\n        }\n    }\n}