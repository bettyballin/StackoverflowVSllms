using System;\nusing System.Linq;\nusing System.Net.NetworkInformation;\nusing System.Text;\n\npublic partial class NetworkScan : System.Web.UI.Page\n{\n    protected void Page_Load(object sender, EventArgs e)\n    {\n        // Prevent execution on page load\n    }\n\n    protected void btnScan_Click(object sender, EventArgs e)\n    {\n        string subnet = "192.168.1"; // Change this to your subnet\n        StringBuilder activeComputers = new StringBuilder();\n\n        for (int i = 1; i <= 254; i++)\n        {\n            string ipAddress = $"{subnet}.{i}";\n\n            try\n            {\n                Ping pingSender = new Ping();\n                PingOptions options = new PingOptions(128, true);\n\n                // Use the default Ttl value which is 128,\n                // but change the fragmentation behavior.\n                options.DontFragment = true;\n\n                // Create a buffer of 32 bytes of data to be transmitted.\n                string data = "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa";\n                byte[] buffer = System.Text.Encoding.ASCII.GetBytes(data);\n                int timeout = 120;\n                PingReply reply = pingSender.Send(ipAddress, timeout, buffer, options);\n\n                if (reply.Status == IPStatus.Success)\n                {\n                    activeComputers.AppendLine($"Alive: {ipAddress}");\n                }\n            }\n            catch (PingException ex)\n            {\n                // Do nothing or log the exception\n            }\n        }\n\n        lblResults.Text = activeComputers.ToString();\n    }\n}