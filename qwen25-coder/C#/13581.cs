protected void Page_Load(object sender, EventArgs e)\n{\n    // Check if newstyle parameter exists in QueryString\n    bool useNewStyle = Request.QueryString["newstyle"] == "true";\n\n    // Override querystring with cookie value if found\n    HttpCookie styleCookie = Request.Cookies["site-style"];\n    if (styleCookie != null)\n    {\n        useNewStyle = styleCookie.Value == "true";\n    }\n\n    // Set the appropriate css root based on the flag\n    string cssRoot = useNewStyle ? "newstyle" : "oldstyle";\n\n    // Function to return CSS root for different browsers\n    RegisterStartupScript("SetCSS", $@"\n        <link href='Style/{cssRoot}.css' rel='stylesheet' type='text/css' />\n        <!--[if lte IE 8]>\n            <link type='text/css' href='Style/{cssRoot}-ie8.css' rel='stylesheet' />\n        <![endif]-->\n        <!--[if lte IE 7]>\n            <link type='text/css' href='Style/{cssRoot}-ie7.css' rel='stylesheet' />\n        <![endif]-->\n        <!--[if lte IE 6]>\n            <link type='text/css' href='Style/{cssRoot}-ie6.css' rel='stylesheet' />\n        <![endif]-->");\n\n    // Set cookie if needed\n    if (!useNewStyle && !Request.RawUrl.Contains("newstyle=true"))\n    {\n        Response.Cookies["site-style"].Value = "false";\n    }\n    else\n    {\n        HttpCookie cookie = new HttpCookie("site-style", useNewStyle.ToString());\n        cookie.Expires = DateTime.Now.AddYears(1);\n        Response.SetCookie(cookie);\n    }\n}