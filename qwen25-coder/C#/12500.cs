using Microsoft.Win32;\nusing System;\n\npublic class TimeZoneUtility\n{\n    public static string GetCurrentTimeZoneId()\n    {\n        using (RegistryKey timeZoneKey = Registry.LocalMachine.OpenSubKey(@"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Time Zones"))\n        {\n            if (timeZoneKey != null)\n            {\n                string currentTimeZoneName = (string)Registry.GetValue(@"HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\TimeZoneInformation", "StandardName", null);\n                if (!string.IsNullOrEmpty(currentTimeZoneName))\n                {\n                    foreach (string timeZoneId in timeZoneKey.GetSubKeyNames())\n                    {\n                        using (RegistryKey subKey = timeZoneKey.OpenSubKey(timeZoneId))\n                        {\n                            string standardName = (string)subKey.GetValue("Std");\n                            if (standardName == currentTimeZoneName)\n                            {\n                                return timeZoneId;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        throw new Exception("Unable to determine the current time zone ID.");\n    }\n\n    public static void Main()\n    {\n        string timeZoneId = GetCurrentTimeZoneId();\n        Console.WriteLine($"The current time zone ID is: {timeZoneId}");\n    }\n}