using System;\nusing System.IO.Ports;\n\nclass Program\n{\n    static SerialPort gprsPort;\n\n    static void Main(string[] args)\n    {\n        gprsPort = new SerialPort("COM1", 9600, Parity.None, 8, StopBits.One);\n        gprsPort.Open();\n\n        // Turn GPRS on\n        SendATCommand("AT+QIACT=1\r");\n\n        Console.WriteLine("GPRS turned on. Press any key to turn off...");\n        Console.ReadKey();\n\n        // Turn GPRS off\n        SendATCommand("AT+QIDEACT=1\r");\n\n        gprsPort.Close();\n    }\n\n    static void SendATCommand(string command)\n    {\n        if (gprsPort.IsOpen)\n        {\n            gprsPort.WriteLine(command);\n            string response = "";\n            do\n            {\n                while (gprsPort.BytesToRead > 0)\n                {\n                    response += gprsPort.ReadExisting();\n                }\n                System.Threading.Thread.Sleep(100); // wait for more data to come in or timeout\n            } while (gprsPort.BytesToRead > 0);\n            \n            Console.WriteLine(response);\n        }\n    }\n}