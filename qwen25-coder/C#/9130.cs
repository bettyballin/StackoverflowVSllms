using System.Linq;\n\nvar targetVideoId = 1;\nvar targetVideoTags = db.Videos\n    .Where(v => v.VideoID == targetVideoId && v.isActive)\n    .SelectMany(v => v.Tags.Split(','))\n    .Distinct()\n    .ToList();\n\nvar relatedVideos = db.Videos\n    .Where(v => v.VideoID != targetVideoId && v.isActive)\n    .Select(v => new \n    {\n        Video = v,\n        MatchingTagsCount = v.Tags.Split(',')\n            .Count(tag1 => targetVideoTags.Any(tag2 => tag1.Trim().Equals(tag2, StringComparison.OrdinalIgnoreCase)))\n    })\n    .Where(x => x.MatchingTagsCount > 0) // Filter out videos with no matching tags\n    .OrderByDescending(x => x.MatchingTagsCount)\n    .Select(x => x.Video);