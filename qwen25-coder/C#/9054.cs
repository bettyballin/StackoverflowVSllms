var text = @"DECLARE\n    cnt NUMBER;\nBEGIN\n    SELECT COUNT(*) INTO cnt FROM all_tables WHERE table_name = 'TABLE_A';\n\n    IF cnt = 1 THEN\n        EXECUTE IMMEDIATE 'TRUNCATE TABLE TABLE_A';\n        EXECUTE IMMEDIATE 'DROP TABLE TABLE_A';\n    END IF;\n\n    EXECUTE IMMEDIATE 'CREATE TABLE TABLE_A AS \n        SELECT DISTINCT v.ID, g.ext_id \n        FROM VIEW_A v \n        JOIN TABLE_B B ON v.id = B.Id \n        WHERE YEAR1 = ''2008''';\nEND;";\n\nvar createTempTable = new OracleCommand(text, conn);\ncreateTempTable.CommandType = CommandType.Text;\nconn.Open();\n\ntry\n{\n    createTempTable.ExecuteNonQuery();\n}\ncatch (Exception ex)\n{\n    throw;\n}\nfinally\n{\n    conn.Close();    \n}