// Step 1: Save the photo object to get the photoid\nPhoto photo = rep.NewPhoto();\nphoto.Title = "Some Title";\nrep.InsertPhoto(photo);\nrep.SaveAll(); // This will generate and assign a photoid\n\n// Step 2: Use the generated photoid for naming the file\nstring tempFileName = Guid.NewGuid().ToString(); // Temporary filename using GUID\nstring finalFileName = photo.photoid + Path.GetExtension(uploadedPhoto.FileName);\n\n// Save the uploaded file with a temporary name\nstring tempPath = Path.Combine("path_to_your_image_folder", tempFileName);\nusing (FileStream fs = new FileStream(tempPath, FileMode.Create))\n{\n    uploadedPhoto.InputStream.CopyTo(fs);\n}\n\n// Step 3: Rename the file to use photoid and save the filename with photo record\nFile.Move(tempPath, Path.Combine("path_to_your_image_folder", finalFileName));\nphoto.FileName = finalFileName;\nrep.UpdatePhoto(photo); // Implement this method if necessary\nrep.SaveAll(); // Save changes back to the database