using System;\n   using OtpNet;\n\n   public static bool ValidateTwoFactorPIN(long secretKey, int token)\n   {\n       // Convert the shared secret to a byte array\n       var keyBytes = new byte[8];\n       for (var i=0; i<8; i++)\n       {\n           keyBytes[i] = (byte) (secretKey >> ((7-i)*8));\n       }\n\n       // Create a Steam TOTP code generator using the shared secret\n       INotificationService service = new Totp(keyBytes);\n       \n       // Validate the user-provided code against the expected value\n       return service.VerifyTotp(token, out var timeStepMatched,\n           new VerificationWindow(2, 2));\n   }