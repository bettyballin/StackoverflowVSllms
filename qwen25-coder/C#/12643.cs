using System;\nusing System.Threading;\nusing System.Diagnostics;\n\nclass Program\n{\n    static void Main()\n    {\n        // Define a unique name for your event object\n        string eventName = "Global\\MyOpenVPNCleanupEvent";\n\n        // Create or open the named event object with manual reset and initial non-signaled state\n        using (EventWaitHandle exitEvent = new EventWaitHandle(false, EventResetMode.ManualReset, eventName))\n        {\n            // Start OpenVPN process with --service exit-event option\n            ProcessStartInfo startInfo = new ProcessStartInfo();\n            startInfo.FileName = "openvpn.exe";\n            startInfo.Arguments = "--config your-config.ovpn --service exit-event " + eventName;\n            startInfo.UseShellExecute = false;\n\n            using (Process openVpnProcess = Process.Start(startInfo))\n            {\n                Console.WriteLine("OpenVPN started. Press any key to shut it down cleanly...");\n                Console.ReadKey();\n\n                // Set the event, causing OpenVPN to exit\n                exitEvent.Set();\n\n                // Optionally wait for the process to finish exiting\n                openVpnProcess.WaitForExit();\n                Console.WriteLine("OpenVPN has exited.");\n            }\n        }\n    }\n}