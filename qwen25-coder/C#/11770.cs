using System.Data;\nusing System.Data.SqlClient;\n\n// Assuming ds and clientDS are populated DataSets and you have a SqlConnection called connection.\nSqlCommand command = new SqlCommand();\ncommand.Connection = connection; // Make sure to set up your SqlConnection properly\n\nforeach (DataRow row in ds.Tables[0].Rows)\n{\n    int id = Convert.ToInt32(row["Id"]);\n    \n    // Check if the ID exists in clientDS\n    bool existsInClientDS = clientDS.Tables[0].AsEnumerable().Any(r => r.Field<int>("Id") == id);\n\n    if (existsInClientDS)\n    {\n        // Update statement with parameters\n        command.CommandText = "UPDATE customers SET Name=@Name, ContactPerson=@ContactPerson, Address=@Address, TinNo=@TinNo, ContactNo=@ContactNo, Report=@Report, Sync=0 WHERE Id=@Id";\n        command.Parameters.Clear();\n        command.Parameters.AddWithValue("@Id", id);\n        command.Parameters.AddWithValue("@Name", row["Name"].ToString());\n        command.Parameters.AddWithValue("@ContactPerson", row["ContactPerson"].ToString());\n        command.Parameters.AddWithValue("@Address", row["Address"].ToString());\n        command.Parameters.AddWithValue("@TinNo", row["TinNo"].ToString());\n        command.Parameters.AddWithValue("@ContactNo", row["Contactno"].ToString());\n        command.Parameters.AddWithValue("@Report", row["Report"].ToString());\n\n        connection.Open();\n        command.ExecuteNonQuery();\n        connection.Close();\n    }\n    else\n    {\n        // Insert statement with parameters\n        command.CommandText = "INSERT INTO customers (Id, Name, ContactPerson, Address, TinNo, ContactNo, Report, Sync) VALUES (@Id, @Name, @ContactPerson, @Address, @TinNo, @ContactNo, @Report, 0)";\n        command.Parameters.Clear();\n        command.Parameters.AddWithValue("@Id", id);\n        command.Parameters.AddWithValue("@Name", row["Name"].ToString());\n        command.Parameters.AddWithValue("@ContactPerson", row["ContactPerson"].ToString());\n        command.Parameters.AddWithValue("@Address", row["Address"].ToString());\n        command.Parameters.AddWithValue("@TinNo", row["TinNo"].ToString());\n        command.Parameters.AddWithValue("@ContactNo", row["Contactno"].ToString());\n        command.Parameters.AddWithValue("@Report", row["Report"].ToString());\n\n        connection.Open();\n        command.ExecuteNonQuery();\n        connection.Close();\n    }\n}