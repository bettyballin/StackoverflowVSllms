<%@ Page Language="C#" %>\n<script runat="server">\n    protected void ValidateEmail(object source, System.Web.UI.WebControls.ServerValidateEventArgs args)\n    {\n        // Regular expression to validate email address\n        string pattern = @"^\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$";\n        args.IsValid = Regex.IsMatch(args.Value, pattern);\n        \n        // Check for XSS by encoding the output if necessary\n        string safeOutput = Server.HtmlEncode(args.Value);\n        // Use safeOutput when rendering in your page to prevent XSS\n    }\n</script>\n\n<form id="form1" runat="server">\n    <asp:TextBox ID="emailTextBox" runat="server"></asp:TextBox>\n    <asp:RequiredFieldValidator ControlToValidate="emailTextBox"\n                                    Display="Dynamic"\n                                    ErrorMessage="Email is required."\n                                    runat="server">*</asp:RequiredFieldValidator>\n    <asp:CustomValidator ID="emailValidator"\n                           ControlToValidate="emailTextBox"\n                           Display="Dynamic"\n                           ErrorMessage="Invalid email format."\n                           OnServerValidate="ValidateEmail"\n                           runat="server">*</asp:CustomValidator>\n    <asp:Button Text="Submit" runat="server" />\n</form>