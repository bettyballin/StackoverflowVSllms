using System;\nusing System.Runtime.InteropServices;\n\nclass Program\n{\n    [DllImport("oleaut32.dll", CharSet = CharSet.Unicode)]\n    public static extern IntPtr SysAllocString(string str);\n\n    [DllImport("oleaut32.dll")]\n    public static extern void SysFreeString(IntPtr bstr);\n\n    [DllImport("oleaut32.dll")]\n    public static extern IntPtr SafeArrayCreateVector(VARTYPE vt, int lLbound, uint cElements);\n\n    [DllImport("oleaut32.dll")]\n    public static extern uint SafeArrayPutElement(IntPtr psa, ref int rgIndices, IntPtr pvData);\n\n    [DllImport("oleaut32.dll")]\n    public static extern uint SafeArrayDestroy(IntPtr hGlobal);\n\n    public const ushort VT_BSTR = 8;\n\n    [StructLayout(LayoutKind.Sequential)]\n    public enum VARTYPE : ushort\n    {\n        VT_EMPTY = 0,\n        VT_NULL = 1,\n        // ... other types ...\n        VT_BSTR = 8\n    }\n\n    static void Main(string[] args)\n    {\n        IntPtr psa = SafeArrayCreateVector(VARTYPE.VT_BSTR, 0, 1);\n        if (psa == IntPtr.Zero)\n            throw new Exception("Failed to create SAFEARRAY.");\n\n        try\n        {\n            string html = "<html><body>Hello, world!</body></html>";\n            \n            // Allocate BSTR and put it in the SAFEARRAY.\n            IntPtr bstr = SysAllocString(html);\n            if (bstr == IntPtr.Zero)\n                throw new Exception("Failed to allocate BSTR.");\n\n            try\n            {\n                int index = 0;\n                uint hr = SafeArrayPutElement(psa, ref index, bstr);\n                if (hr != 0)\n                    throw new COMException("SafeArrayPutElement failed.", (int)hr);\n\n                mshtml.HTMLDocumentClass doc = new mshtml.HTMLDocumentClass();\n                object[] parameters = { psa };\n                ((mshtml.IHTMLDocument2)doc).write(parameters);\n            }\n            finally\n            {\n                SysFreeString(bstr); // Free the BSTR\n            }\n        }\n        finally\n        {\n            SafeArrayDestroy(psa); // Destroy the SAFEARRAY\n        }\n    }\n}