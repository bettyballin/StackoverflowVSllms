using System;\nusing System.IO;\nusing System.Security.AccessControl;\nusing System.Security.Principal;\n\npublic void CreateSecureFolder(string path)\n{\n    // Ensure the folder does not already exist\n    if (!Directory.Exists(path))\n    {\n        // Create the directory\n        Directory.CreateDirectory(path);\n\n        // Get current user identity\n        WindowsIdentity wi = WindowsIdentity.GetCurrent();\n        NTAccount account = new NTAccount(wi.Name);\n\n        // Get a DirectoryInfo object and modify its security settings\n        DirectoryInfo dirInfo = new DirectoryInfo(path);\n        DirectorySecurity dSecurity = dirInfo.GetAccessControl();\n\n        FileSystemRights rights = FileSystemRights.Modify;\n\n        // Create a FileSecurity object with the current security settings\n        dSecurity.AddAccessRule(new FileSystemAccessRule(account, rights,\n            InheritanceFlags.ObjectInherit | InheritanceFlags.ContainerInherit,\n            PropagationFlags.NoPropagateInherit, AccessControlType.Allow));\n\n        // Apply the new access rules to the directory\n        dirInfo.SetAccessControl(dSecurity);\n    }\n}