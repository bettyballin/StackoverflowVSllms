using System;\nusing System.Net;\nusing System.Numerics;\n\npublic class IPv6Converter\n{\n    public static (long, long) ConvertIPv6ToBigInt(string ipv6)\n    {\n        if (!IPAddress.TryParse(ipv6, out IPAddress ipAddress))\n            throw new ArgumentException("Invalid IP address");\n\n        var ipv6Address = ipAddress.GetAddressBytes();\n        \n        long high = BitConverter.ToInt64(ipv6Address, 0);\n        long low = BitConverter.ToInt64(ipv6Address, 8);\n\n        // Ensure the byte order is correct for SQL Server (big-endian)\n        if (BitConverter.IsLittleEndian)\n        {\n            high = IPAddress.NetworkToHostOrder(high);\n            low = IPAddress.NetworkToHostOrder(low);\n        }\n\n        return (high, low);\n    }\n}