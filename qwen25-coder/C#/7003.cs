using System;\nusing System.IO;\nusing System.Net.Mail;\n\npublic void SaveMailMessageToFile(MailMessage mailMessage, string filePath)\n{\n    using (var stream = new FileStream(filePath, FileMode.Create))\n    {\n        // Convert MailMessage to a byte array and write it to the file as an EML.\n        var assembly = typeof(SmtpClient).Assembly;\n        var type = assembly.GetType("System.Net.Mail.Rfc822Writer");\n        using (var writer = Activator.CreateInstance(type, stream) as IDisposable)\n        {\n            if (writer == null) throw new InvalidOperationException();\n            type.InvokeMember("WriteHeaders", System.Reflection.BindingFlags.Instance | System.Reflection.BindingFlags.InvokeMethod | System.Reflection.BindingFlags.NonPublic, null, writer, new object[] { mailMessage });\n            type.InvokeMember("Flush", System.Reflection.BindingFlags.Instance | System.Reflection.BindingFlags.InvokeMethod | System.Reflection.BindingFlags.Public, null, writer, new object[0]);\n        }\n    }\n}\n\n// Usage\nvar message = new MailMessage {\n    From = new MailAddress("from@example.com"),\n    Subject = "This is a test",\n    Body = "Hello, this is a sample email."\n};\nmessage.To.Add(new MailAddress("to@example.com"));\nmessage.Attachments.Add(new Attachment("C:\\path\\to\\your\\attachment.txt"));\n\nSaveMailMessageToFile(message, @"C:\path\to\your\email.eml");