using System;\nusing System.IO;\nusing System.Windows.Forms;\n\npublic void ExportListViewToCSV(ListView listView, string filePath)\n{\n    // Check if ListView has columns\n    if (listView.Columns.Count == 0) return;\n\n    using (StreamWriter writer = new StreamWriter(filePath))\n    {\n        // Write column headers\n        for (int i = 0; i < listView.Columns.Count - 1; i++)\n        {\n            writer.Write("\"" + listView.Columns[i].Text + "\",");\n        }\n        // Last column header without comma at the end\n        writer.WriteLine("\"" + listView.Columns[listView.Columns.Count - 1].Text + "\"");\n\n        // Write item rows\n        foreach (ListViewItemViewItem lvw in listView.Items)\n        {\n            for (int i = 0; i < lvw.SubItems.Count - 1; i++)\n            {\n                writer.Write("\"" + lvw.SubItems[i].Text + "\",");\n            }\n            // Last subitem of the row without comma at the end\n            writer.WriteLine("\"" + lvw.SubItems[lvw.SubItems.Count - 1].Text + "\"");\n        }\n    }\n}\n\n// Usage example:\n// ExportListViewToCSV(myListView, "C:\\path\\to\\export.csv");