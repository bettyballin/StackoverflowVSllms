using Microsoft.Win32;\nusing System.IO;\n\npublic void ExportRegistryKey(string keyName, string filePath)\n{\n    using (var registryKey = Registry.CurrentUser.OpenSubKey(keyName))\n    {\n        if (registryKey == null) throw new ArgumentException("Key does not exist", nameof(keyName));\n\n        using (var sw = new StreamWriter(filePath, false))\n        {\n            WriteRegistryKey(sw, keyName, registryKey);\n        }\n    }\n}\n\nprivate void WriteRegistryKey(StreamWriter sw, string path, RegistryKey regkey)\n{\n    foreach (string valueName in regkey.GetValueNames())\n    {\n        var objValue = regkey.GetValue(valueName);\n        if (objValue != null)\n        {\n            sw.WriteLine($"{path}\\{valueName}={objValue}");\n        }\n    }\n\n    foreach (string subKeyName in regkey.GetSubKeyNames())\n    {\n        using (RegistryKey subkey = regkey.OpenSubKey(subKeyName))\n        {\n            WriteRegistryKey(sw, $"{path}\\{subKeyName}", subkey);\n        }\n    }\n}