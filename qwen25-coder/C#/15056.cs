using System;\nusing System.DirectoryServices;\n\nclass Program\n{\n    static void Main()\n    {\n        string domainPath = "LDAP://OU=Users,DC=example,DC=com";\n        using (DirectoryEntry container = new DirectoryEntry(domainPath))\n        {\n            try\n            {\n                DirectoryEntry user = container.Children.Add("CN=John Doe", "user");\n                user.Properties["sAMAccountName"].Value = "jdoe";\n                user.Properties["userPrincipalName"].Value = "jdoe@example.com";\n                user.Properties["mail"].Value = "john.doe@example.com";\n                user.Properties["givenName"].Value = "John";\n                user.Properties["sn"].Value = "Doe";\n\n                // Set user password\n                user.Invoke("SetPassword", new object[] { "P@ssw0rd!" });\n                \n                // Enable the account\n                int aceFlags = (int)user.Properties["userAccountControl"].Value;\n                user.Properties["userAccountControl"].Value = aceFlags & ~512; // 512 is ADS_UF_ACCOUNT_DISABLE\n                \n                // Commit the changes\n                user.CommitChanges();\n                \n                Console.WriteLine("User has been created.");\n            }\n            catch (Exception ex)\n            {\n                Console.WriteLine("An error occurred: " + ex.Message);\n            }\n        }\n    }\n}