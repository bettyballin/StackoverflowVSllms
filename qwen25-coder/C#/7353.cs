using System;\nusing System.Drawing;\nusing System.IO;\nusing System.Text;\nusing System.Windows.Forms;\n\npublic class RichTextBoxExtensions : Form\n{\n    private RichTextBox richTextBox1 = new RichTextBox { Dock = DockStyle.Fill };\n\n    public RichTextBoxExtensions()\n    {\n        Controls.Add(richTextBox1);\n        Button button = new Button { Text = "Insert Image" };\n        button.Click += (s, e) => InsertImage(richTextBox1, @"C:\path\to\your\image.jpg");\n        Controls.Add(button);\n        button.Dock = DockStyle.Bottom;\n    }\n\n    private void InsertImage(RichTextBox richText, string imagePath)\n    {\n        using (var image = Image.FromFile(imagePath))\n        {\n            byte[] imageData;\n            using (MemoryStream stream = new MemoryStream())\n            {\n                image.Save(stream, System.Drawing.Imaging.ImageFormat.Jpeg);\n                imageData = stream.ToArray();\n            }\n\n            // Using Base64 to embed image\n            string base64Image = Convert.ToBase64String(imageData);\n\n            // RTF header for JPEG\n            string rtfHeader = @"{\rtf1\ansi\ansicpg1252\deff0\nouicompat\deflang1033{\fonttbl{\f0\fnil\fcharset0 Arial;}}\n                            {\*\generator Riched20 10.0.17134}\viewkind4\uc1\b0\fs20";\n\n            // Image RTF content\n            string rtfImage = @"\pict\jpegblip\bliptag-1155794688" + @"\picw" + image.Width + @"\pich" + image.Height +\n                              @"\picwgoal" + (image.Width * 20) + @"\pichgoal" + (image.Height * 20) + @"\n                              " + base64Image;\n\n            // Insert image at current caret position\n            int selectionStart = richText.SelectionStart;\n            richText.SelectedRtf = rtfHeader + rtfImage + @"}";\n            richText.Select(selectionStart, richText.Rtf.Length - selectionStart);\n        }\n    }\n\n    [STAThread]\n    static void Main()\n    {\n        Application.EnableVisualStyles();\n        Application.Run(new RichTextBoxExtensions());\n    }\n}