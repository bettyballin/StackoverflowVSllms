using System;\nusing System.Collections.Genericï¼›\nusing System.DirectoryServices.Protocols;\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        List<string> userEmails = new List<string> { "user1@example.com", "user2@anotherdomain.com" };\n        \n        foreach (var email in userEmails)\n        {\n            var credentials = new NetworkCredential("yourUsername", "yourPassword", "yourDomain");\n            using (var connection = new LdapConnection(new LdapDirectoryIdentifier("YourADServer"), credentials))\n            {\n                // Optional: Set the connection properties\n                connection.SessionOptions.ProtocolVersion = 3;\n                connection.AuthType = AuthType.Negotiate;\n\n                // Bind to AD server\n                connection.Bind();\n\n                string searchFilter = $"(mail={email})";\n                SearchRequest request = new SearchRequest(\n                    "DC=yourdomain,DC=com", // Replace with your domain base DN\n                    searchFilter,\n                    System.DirectoryServices.Protocols.SearchScope.Subtree,\n                    new[] { "sAMAccountName", "userPrincipalName" });\n\n                var response = (SearchResponse)connection.SendRequest(request);\n\n                foreach (var entry in response.Entries)\n                {\n                    string userName = entry.Attributes["sAMAccountName"][0].ToString();\n                    string upn = entry.Attributes["userPrincipalName"][0].ToString();\n\n                    string[] parts = upn.Split('@');\n                    string userDomain = parts[1];\n\n                    Console.WriteLine($"Email: {email}");\n                    Console.WriteLine($"Username: {userName}");\n                    Console.WriteLine($"Domain: {userDomain}");\n                }\n            }\n        }\n    }\n}