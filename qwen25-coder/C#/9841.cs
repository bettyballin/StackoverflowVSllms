[DllImport("advapi32.dll", SetLastError = true)]\n   public static extern bool LogonUser(\n       string lpszUsername,\n       string lpszDomain,\n       string lpszPassword,\n       int dwLogonType,\n       int dwLogonProvider,\n       out IntPtr phToken);\n\n   // Usage\n   IntPtr token;\n   if (LogonUser(username, domain, password, 2, 0, out token))\n   {\n       WindowsIdentity identity = new WindowsIdentity(token);\n       impersonationContext = identity.Impersonate();\n       \n       // Your code here\n\n       CloseHandle(token); // Don't forget to close the token handle\n   }\n\n   [DllImport("kernel32.dll", SetLastError = true)]\n   public static extern bool CloseHandle(IntPtr hObject);