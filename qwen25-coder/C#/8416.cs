using RabbitMQ.Client;\nusing System.Text;\n\npublic class ReportRequestPublisher {\n    public void RequestReport(string userId, string reportType) {\n        var factory = new ConnectionFactory() { HostName = "reportserver" };\n        using (var connection = factory.CreateConnection())\n        using (var channel = connection.CreateModel()) {\n            channel.QueueDeclare(queue: "generate_reports", durable: false,\n                                 exclusive: false, autoDelete: false, arguments: null);\n\n            string message = $"{userId}|{reportType}";\n            var body = Encoding.UTF8.GetBytes(message);\n            \n            channel.BasicPublish(exchange: "",\n                                 routingKey: "generate_reports",\n                                 basicProperties: null,\n                                 body: body);\n        }\n    }\n}