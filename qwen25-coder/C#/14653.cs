static class Program\n{\n    /// <summary>\n    /// The main entry point for the application.\n    /// </summary>\n    static void Main(string[] args)\n    {\n        ServiceBase[] servicesToRun;\n        servicesToRun = new ServiceBase[]\n        {\n            new Service1()\n        };\n\n        if (Environment.UserInteractive)\n        {\n            foreach (ServiceBase service in servicesToRun)\n            {\n                service.OnStart(args); //Call OnStart directly\n            }\n\n            Console.WriteLine("Press any key to exit");\n            Console.Read();\n\n            foreach (ServiceBase service in servicesToRun)\n            {\n                service.OnStop(); //Directly call OnStop\n            }\n        }\n        else\n        {\n            ServiceBase.Run(servicesToRun);\n        }\n    }\n}