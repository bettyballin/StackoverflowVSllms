using System;\nusing System.Diagnostics;\nusing System.Management;\n\nclass Program\n{\n    static void Main()\n    {\n        foreach (Process process in Process.GetProcessesByName("java"))\n        {\n            try\n            {\n                string query = "SELECT * FROM Win32_Process WHERE ProcessId=" + process.Id;\n                using (ManagementObjectSearcher searcher = new ManagementObjectSearcher(query))\n                {\n                    foreach (ManagementObject mo in searcher.Get())\n                    {\n                        Console.WriteLine($"Process ID: {process.Id}");\n                        Console.WriteLine($"Name: {process.ProcessName}");\n                        Console.WriteLine($"Command Line: {mo["CommandLine"]}");\n                        Console.WriteLine($"Working Directory: Not directly available via ManagementObject, use other means.");\n                        \n                        // Note: Working directory is not directly available from Win32_Process.\n                        // You might need to look into other APIs or methods if strictly necessary.\n                    }\n                }\n            }\n            catch (Exception ex)\n            {\n                Console.WriteLine($"Error accessing process information for PID {process.Id}: {ex.Message}");\n            }\n        }\n    }\n}