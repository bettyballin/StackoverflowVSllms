public DataSet RetrieveDiagnosisCodes()\n{\n    string tableName = "tblDiagnosisCues";\n    string strSQL = \n        "select tblDiagnosisCues.*, " +\n        "tblDiagnosisCategory.Description as CategoryDesc, " +  \n        "tblDiagnosisSubCategory.Description as SubCategoryDesc " + \n        "FROM dbo.tblDiagnosisCategory " +\n        "INNER JOIN dbo.tblDiagnosisSubCategory " +\n        "ON dbo.tblDiagnosisCategory.Category = dbo.tblDiagnosisSubCategory.Category " +\n        "INNER JOIN dbo.tblDiagnosisCues ON dbo.tblDiagnosisSubCategory.SubCategory = dbo.tblDiagnosisCues.SubCategoryID " +\n        "where effectivedate <= getdate() and (termdate >= getdate() or termdate is null) order by tblDiagnosisCues.Description";\n    DataSet ds = new DataSet(tableName);\n    using (SqlConnection cnn = new SqlConnection(Settings.Default.CMOSQLConn))\n    {\n        SqlCommand cmd = new SqlCommand(strSQL, cnn) { CommandType = CommandType.Text };\n        SqlDataAdapter da = new SqlDataAdapter(cmd);\n        try\n        {\n            Debug.WriteLine("Command Text: " + cmd.CommandText); // Log the command text for debugging\n            cnn.Open();\n            int rowsAffected = da.Fill(ds);\n            Debug.WriteLine($"{rowsAffected} rows affected."); // Log number of rows filled into DataSet\n        }\n        catch (Exception ex)\n        {\n            Debug.WriteLine("Exception caught: " + ex.Message); // Log caught exceptions\n            throw;\n        }\n    } // No need to explicitly call dispose on SqlConnection, cmd, and da with 'using'\n    return ds;\n}