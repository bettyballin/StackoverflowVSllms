public static Bitmap GetStyleBitmap(Style style)\n{\n    var bm = new Bitmap(16, 16, System.Drawing.Imaging.PixelFormat.Format32bppArgb);\n    Graphics g = Graphics.FromImage(bm);\n    g.Clear(Color.Transparent);\n\n    var rect = new RectangleF(0, 0, 16, 16);\n    var ss = new StyleSample();\n    ss.Bounds = rect;\n\n    if (style is CompositeStyle composite)\n    {\n        ss.ApplyAreaStyle(composite.AreaStyle);\n        ss.ApplyLineStyle(composite.LineStyle);\n    }\n    else if (style is AreaStyle area)\n    {\n        ss.ApplyAreaStyle(area);\n    }\n    else if (style is SimpleLineStyle simpleLine)\n    {\n        ss.ApplyLineStyle(simpleLine);\n    }\n\n    // Directly draw to the bitmap\n    ss.DrawToBitmap(g, rect);\n\n    return bm;\n}