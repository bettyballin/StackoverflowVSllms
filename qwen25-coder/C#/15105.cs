using System;\nusing System.IO;\nusing System.Security.Cryptography;\n\npublic class AesGcmExample {\n    public static byte[] Encrypt(string plainText, byte[] key) {\n        using (Aes aes = Aes.Create()) {\n            aes.Key = key;\n            aes.GenerateIV();\n\n            ICryptoTransform encryptor = aes.CreateEncryptor(aes.Key, aes.IV);\n\n            byte[] cipherText;\n            using (MemoryStream msEncrypt = new MemoryStream()) {\n                using (CryptoStream csEncrypt = new CryptoStream(msEncrypt, encryptor, CryptoStreamMode.Write)) {\n                    using (StreamWriter swEncrypt = new StreamWriter(csEncrypt)) {\n                        swEncrypt.Write(plainText);\n                    }\n                    cipherText = msEncrypt.ToArray();\n                }\n\n                var output = new byte[aes.IV.Length + cipherText.Length];\n                aes.IV.CopyTo(output, 0);\n                cipherText.CopyTo(output, aes.IV.Length);\n\n                return output;\n            }\n        }\n    }\n\n    public static string Decrypt(byte[] cipherBytes, byte[] key) {\n        using (Aes aes = Aes.Create()) {\n            aes.Key = key;\n            aes.IV = cipherBytes.Take(aes.BlockSize / 8).ToArray();\n            var text = cipherBytes.Skip(aes.BlockSize / 8);\n\n            ICryptoTransform decryptor = aes.CreateDecryptor(aes.Key, aes.IV);\n\n            using (MemoryStream msEncrypt = new MemoryStream(text.ToArray())) {\n                using (CryptoStream csEncrypt = new CryptoStream(msEncrypt, decryptor, CryptoStreamMode.Read)) {\n                    using (StreamReader srText = new StreamReader(csEncrypt)) {\n                        return srText.ReadToEnd();\n                    }\n                }\n            }\n        }\n    }\n}