using System;\nusing System.Management;\n\nclass Program\n{\n    static void Main()\n    {\n        string query = "SELECT * FROM __InstanceModificationEvent WITHIN 2 WHERE Targetinstance isa \"Win32_Service\" AND Targetinstance.DisplayName LIKE \"%IIS%\"";\n        ManagementEventWatcher watcher = new ManagementEventWatcher(query);\n        \n        watcher.EventArrived += (sender, e) => \n            Console.WriteLine($"Service Changed: {e.NewEvent.Properties["TargetInstance"]}");\n        \n        watcher.Start();\n        \n        Console.WriteLine("Press any key to exit...");\n        Console.ReadKey();\n\n        watcher.Stop();\n    }\n}