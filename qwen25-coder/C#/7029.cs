using System;\nusing System.IO.Pipes;\n\npublic class PipeServer\n{\n    public static void Main(string[] args)\n    {\n        using (NamedPipeServerStream pipeServer = new NamedPipeServerStream("testpipe", PipeDirection.Out))\n        {\n            Console.WriteLine("Waiting for connection...");\n            pipeServer.WaitForConnection();\n\n            Console.WriteLine("Connected.");\n\n            try\n            {\n                const int message = 123; // The integer to send\n                using (StreamWriter sw = new StreamWriter(pipeServer))\n                {\n                    sw.WriteLine(message);\n                    sw.Flush();\n                }\n\n                Console.WriteLine("Message sent.");\n            }\n            catch (Exception ex)\n            {\n                Console.WriteLine($"Error: {ex.Message}");\n            }\n        }\n    }\n}