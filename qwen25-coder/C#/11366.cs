static void Main()\n{\n    System.ServiceProcess.ServiceBase[] ServicesToRun;\n    \n    if (Environment.UserInteractive)\n    {\n        ListenerSVC service = new ListenerSVC();\n        Console.WriteLine("Running in user-interactive mode");\n        service.OnStart(null);\n        Console.WriteLine("Press any key to stop program");\n        Console.Read();\n        service.OnStop();\n    }\n    else\n    {\n        try\n        {\n            Logger.Info("Starting the service as Windows Service");\n            ServicesToRun = new System.ServiceProcess.ServiceBase[] { new ListenerSVC() };\n            ServiceBase.Run(ServicesToRun);\n        }\n        catch (Exception ex)\n        {\n            Logger.Error("Error running the service", ex);\n            using (EventLog eventLog = new EventLog("Application"))\n            {\n                eventLog.Source = "ListenerSVC";\n                eventLog.WriteEntry($"Failed to start the service: {ex.Message}", EventLogEntryType.Error);\n            }\n        }\n    }\n}