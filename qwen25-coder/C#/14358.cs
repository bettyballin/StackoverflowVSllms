using Microsoft.Win32;\nusing System;\n\nclass FileAssociation\n{\n    public static void AddFileAssociation(string extension, string appName, string appPath)\n    {\n        // Create a root key for the file extension\n        using (RegistryKey root = Registry.ClassesRoot.CreateSubKey(extension))\n        {\n            if (root != null)\n            {\n                // Set the default value to the application name\n                root.SetValue("", appName);\n\n                // Create an open command entry\n                using (RegistryKey shell = root.CreateSubKey(@"shell\open\command"))\n                {\n                    if (shell != null)\n                    {\n                        // Set the path to the executable\n                        string execPath = "\"" + appPath + "\" \"%1\"";\n                        shell.SetValue("", execPath);\n                    }\n                }\n            }\n        }\n\n        // Optionally, set an icon for files of this type\n        using (RegistryKey root = Registry.ClassesRoot.CreateSubKey(appName))\n        {\n            if (root != null)\n            {\n                using (RegistryKey defaultIcon = root.CreateSubKey("DefaultIcon"))\n                {\n                    if (defaultIcon != null)\n                    {\n                        // Set the path to an icon file\n                        defaultIcon.SetValue("", appPath + ",0");\n                    }\n                }\n            }\n        }\n\n        Console.WriteLine("Associations set!");\n    }\n\n    static void Main()\n    {\n        string extension = ".smc";\n        string appName = "YourAppName";\n        string appPath = @"C:\Path\To\YourApp.exe";\n\n        AddFileAssociation(extension, appName, appPath);\n    }\n}