protected void Page_Load(object sender, EventArgs e)\n{\n    // Assume UserID is retrieved from session after a successful login process\n    int userId = (int)Session["UserID"];\n    \n    if (!IsUserAuthorized(userId))\n    {\n        Response.StatusCode = 403; // Forbidden Access\n        return;\n    }\n\n    // Assume GetFileFromDatabase returns the file as bytes and its MIME type\n    var fileData = GetFileFromDatabase(Request.QueryString["fileid"]);\n    if (fileData == null)\n    {\n        Response.StatusCode = 404; // Not Found\n        return;\n    }\n    \n    // Set response headers\n    Response.Clear();\n    Response.ContentType = fileData.Item2; // MIME type\n    Response.AddHeader("Content-Disposition", "attachment; filename=" + fileData.Item1); // File name\n    \n    // Write the file content to the HTTP response output stream\n    Response.BinaryWrite(fileData.Item3);\n}\n\nprivate bool IsUserAuthorized(int userId)\n{\n    // Check user authentication against your database logic here\n    return GetUserAccessPermissionsFromDatabase(userId);\n}\n\nprivate Tuple<string, string, byte[]> GetFileFromDatabase(string fileId)\n{\n    // Logic to retrieve file metadata and bytes from the database\n    // Return file name, MIME type, and file contents as a tuple or null if not found\n}