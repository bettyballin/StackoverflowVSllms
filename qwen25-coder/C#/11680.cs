public class SessionTracker : IHttpModule\n{\n    public void Init(HttpApplication context)\n    {\n        context.BeginRequest += (s, e) => OnBeginRequest(s as HttpApplication);\n        context.EndRequest += (s, e) => OnEndRequest(s as HttpApplication);\n        context.SessionState.End += new EventHandler(Session_End);\n    }\n\n    private void OnBeginRequest(HttpApplication ctx)\n    {\n        // Perform actions when a request starts\n        if (ctx != null && ctx.Session != null)\n        {\n            TrackSessionStart(ctx.Session.SessionID);\n        }\n    }\n\n    private void OnEndRequest(HttpApplication ctx)\n    {\n        // Perform actions when a request ends\n    }\n\n    public void Session_End(object source, EventArgs e)\n    {\n        HttpApplication app = (HttpApplication)source;\n        HttpContext context = app.Context;\n\n        TrackSessionEnd(context.Session.SessionID);\n    }\n\n    private void TrackSessionStart(string sessionId)\n    {\n        // Insert session start record into the database\n    }\n\n    private void TrackSessionEnd(string sessionId)\n    {\n        // Update or delete session end record in the database\n    }\n\n    public void Dispose() { }\n}