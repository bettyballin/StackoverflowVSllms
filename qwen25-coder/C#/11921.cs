using System;\nusing System.IO;\n\npublic void RegisterDllsFromDirectory(string pathToDlls)\n{\n    string[] dllFiles = Directory.GetFiles(pathToDlls, "*.dll");\n    foreach (string dllFile in dllFiles)\n    {\n        try\n        {\n            RegisterServer(dllFile);\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine($"Failed to register {dllFile}: {ex.Message}");\n        }\n    }\n}\n\nprivate void RegisterServer(string dllPath)\n{\n    System.Type t = System.Type.GetTypeFromCLSID(new Guid("{e5ca69af-3747-11d2-a9e4-00c04fa372a7}"));\n    using (System.Runtime.InteropServices.MarshalByRefObject comType = System.Activator.CreateInstance<t>())\n    {\n        if (comType is Microsoft.Win32.IRegistrar registrar)\n        {\n            string registrationScript = $"FileRegister({dllPath})";\n            registrar.ResourceRegister(registrationScript);\n        }\n    }\n}