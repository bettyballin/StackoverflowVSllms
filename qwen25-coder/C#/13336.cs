using System;\nusing System.IO;\nusing Microsoft.AspNetCore.Http;\n\npublic class FileUploader\n{\n    public void UploadFile(IFormFile file, string pathToSave)\n    {\n        if (file == null || file.Length == 0)\n            throw new Exception("No file uploaded.");\n\n        // Ensure the directory exists.\n        var fullPath = Path.Combine(pathToSave, file.FileName);\n        var directory = Path.GetDirectoryName(fullPath);\n\n        if (!Directory.Exists(directory))\n        {\n            Directory.CreateDirectory(directory);\n        }\n\n        using (var stream = new FileStream(fullPath, FileMode.Create))\n        {\n            file.CopyTo(stream); // This will automatically dispose the stream when done.\n        }\n    }\n}