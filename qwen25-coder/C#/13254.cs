using System;\nusing System.Net.Http;\nusing System.Threading.Tasks;\n\nclass Program\n{\n    static async Task Main()\n    {\n        HttpClient client = new HttpClient();\n\n        // Optionally, you can set headers similar to what Excel sends\n        client.DefaultRequestHeaders.Add("User-Agent", "Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; Trident/6.0)");\n        client.DefaultRequestHeaders.Add("Accept-Language", "en-US,en;q=0.8");\n        \n        try\n        {\n            HttpResponseMessage response = await client.GetAsync("http://somesite/foo.jsp");\n            \n            // Throw an exception if the request failed.\n            response.EnsureSuccessStatusCode();\n            \n            string responseBody = await response.Content.ReadAsStringAsync();\n            Console.WriteLine(responseBody);\n        }\n        catch (HttpRequestException e)\n        {\n            Console.WriteLine("\nException Caught!");\n            Console.WriteLine("Message :{0} ", e.Message);\n        }\n    }\n}