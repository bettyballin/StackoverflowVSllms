void Application_Error(object sender, EventArgs e)\n{\n    //get reference to the source of the exception chain\n    Exception ex = Server.GetLastError().GetBaseException();\n\n    //log the details of the exception and page state to the\n    //Windows 2000 Event Log\n    GUI.MailClass objMail = new GUI.MailClass();\n    string strError = "MESSAGE: " + ex.Message + "<br><br><br>" + \n                     "SOURCE: " + ex.Source + "<br>FORM: " + Request.Form.ToString() + \n                     "<br>QUERYSTRING: " + Request.QueryString.ToString() + \n                     "<br>TARGETSITE: " + ex.TargetSite + \n                     "<br>STACKTRACE: " + ex.StackTrace;\n\n    // Check if HttpContext.Current.Session is available\n    if (HttpContext.Current != null && HttpContext.Current.Session != null)\n    {\n        if (HttpContext.Current.Session["trCustomerEmail"] != null)\n        {\n            strError = "Customer Email : " + HttpContext.Current.Session["trCustomerEmail"].ToString() + "<br />" + strError;\n        }\n    }\n\n    //Call a method to send the error details as an Email\n    objMail.sendMail("test@gmail.com", "myid@gmail.com", "Error in " + Request.Form.ToString(), strError, 2);   \n}