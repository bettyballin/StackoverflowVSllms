MailMessage msg = new MailMessage();\nmsg.From = new MailAddress(from);\n\nforeach (string strTo in to.Split(';'))\n{\n  if (!string.IsNullOrWhiteSpace(strTo))\n    msg.To.Add(new MailAddress(strTo.Trim()));\n}\nmsg.Subject = subject;\nmsg.Body = body;\n\nSmtpClient sm = new SmtpClient();\nsm.DeliveryMethod = SmtpDeliveryMethod.Network; // Change to Network for SmartHost\nsm.Credentials = new NetworkCredential(tbUsername.Text, tbPassword.Text);\nsm.Host = host; // This should be your SmartHost address\nsm.Port = port; // Typically 25 or 587\n\ntry\n{\n    sm.Send(msg);\n}\ncatch (Exception ex)\n{\n    Console.WriteLine($"Error sending email: {ex.Message}");\n}