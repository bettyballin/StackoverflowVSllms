using System;\nusing System.Diagnostics;\nusing System.Management;\n\nclass Program\n{\n    static void Main()\n    {\n        string currentUserName = Environment.UserName;\n        KillAndRestartProcessForUser("rdpclip", currentUserName);\n    }\n\n    private static void KillAndRestartProcessForUser(string processName, string userName)\n    {\n        ManagementObjectSearcher searcher = new ManagementObjectSearcher($"SELECT * FROM Win32_Process WHERE Name='{processName}.exe'");\n\n        foreach (ManagementObject process in searcher.Get())\n        {\n            // Get the owner of the process\n            string query = $"SELECT * FROM Win32_ProcessOwner WHERE ProcessId={process["ProcessId"]}";\n            ManagementObjectSearcher ownerSearcher = new ManagementObjectSearcher(query);\n\n            foreach (ManagementBaseObject owner in ownerSearcher.Get())\n            {\n                string domainName = owner["Domain"].ToString();\n                string processUserName = owner["User"].ToString();\n\n                // Check if the process is owned by the current user\n                if (processUserName.Equals(userName, StringComparison.OrdinalIgnoreCase))\n                {\n                    try\n                    {\n                        uint processId = (uint)process["ProcessId"];\n                        Process proc = Process.GetProcessById((int)processId);\n                        proc.Kill();\n                        \n                        Console.WriteLine($"Killed {processName} for user {userName}");\n                    }\n                    catch (Exception ex)\n                    {\n                        Console.WriteLine($"Error killing process: {ex.Message}");\n                    }\n\n                    // Restart rdpclip\n                    try\n                    {\n                        Process.Start(processName + ".exe");\n                        Console.WriteLine($"Restarted {processName} for user {userName}");\n                    }\n                    catch (Exception ex)\n                    {\n                        Console.WriteLine($"Error starting {processName}: {ex.Message}");\n                    }\n                }\n            }\n        }\n    }\n}