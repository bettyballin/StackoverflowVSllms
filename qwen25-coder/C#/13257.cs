public void ProcessRequest(HttpContext context)\n{\n    string requestpath;\n    if (!string.IsNullOrEmpty(context.Request.ServerVariables["REQUEST_URI"]))\n    {\n        requestpath = context.Request.ServerVariables["REQUEST_URI"];\n    }\n    else if (context.Request.QueryString.AllKeys.Contains("aspxerrorpath"))\n    {\n        requestpath = context.Request.QueryString["aspxerrorpath"];\n    }\n    else\n    {\n        requestpath = context.Request.Path;\n    }\n\n    // more code not really relevant here\n}