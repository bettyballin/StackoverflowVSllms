using System;\nusing System.Collections;\nusing System.ComponentModel;\nusing System.Configuration.Install;\nusing System.ServiceProcess;\n\n[RunInstaller(true)]\npublic class MyServiceInstaller : Installer\n{\n    private ServiceInstaller serviceInstaller;\n    private ServiceProcessInstaller processInstaller;\n\n    public MyServiceInstaller()\n    {\n        // Create the service installer with service name and display name\n        serviceInstaller = new ServiceInstaller();\n        serviceInstaller.ServiceName = "MyService";\n        serviceInstaller.DisplayName = "My Service";\n        serviceInstaller.StartType = ServiceStartMode.Automatic; // Set to automatic start\n\n        // Create the process installer for the local system account\n        processInstaller = new ServiceProcessInstaller();\n        processInstaller.Account = ServiceAccount.LocalSystem;\n\n        // Add installers to collection\n        Installers.Add(serviceInstaller);\n        Installers.Add(processInstaller);\n    }\n\n    protected override void OnAfterInstall(IDictionary savedState)\n    {\n        base.OnAfterInstall(savedState);\n\n        // Start the service after installation\n        using (ServiceController sc = new ServiceController(serviceInstaller.ServiceName))\n        {\n            sc.Start();\n        }\n    }\n}