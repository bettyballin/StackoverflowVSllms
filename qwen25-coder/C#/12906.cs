using System;\nusing System.Globalization;\nusing System.IO;\nusing System.Runtime.InteropServices;\nusing Microsoft.Office.Interop.Excel;\n\npublic void ExecuteExcelAutomation()\n{\n    Thread.CurrentThread.CurrentCulture = new CultureInfo("en-US");\n    \n    Application excelApp = null;\n    Workbook workbook = null;\n\n    try\n    {\n        // Create and save a new Excel file\n        excelApp = new Application();\n        string filename = @"c:\temp\test.xls";\n        \n        if (File.Exists(filename)) File.Delete(filename);\n\n        workbook = excelApp.Workbooks.Add(Missing.Value);\n        workbook.SaveAs(filename, XlFileFormat.xlWorkbookNormal);\n        workbook.Close(false, Missing.Value, Missing.Value);\n        workbook = null;\n        excelApp.Quit();\n        Marshal.ReleaseComObject(excelApp);\n        excelApp = null;\n\n        // Open the newly created Excel file\n        excelApp = new Application();\n        workbook = excelApp.Workbooks.Open(filename,\n                                        Missing.Value, \n                                        false,             // ReadOnly\n                                        Missing.Value,\n                                        Missing.Value,\n                                        Missing.Value,\n                                        true,              // Notify\n                                        Missing.Value,\n                                        Missing.Value,\n                                        false,\n                                        false,\n                                        Missing.Value,\n                                        false,\n                                        false,\n                                        false);\n        workbook.Close(false, Missing.Value, Missing.Value);\n        Marshal.ReleaseComObject(workbook);\n        workbook = null;\n    }\n    catch (Exception ex)\n    {\n        // Log the exception here\n        Console.WriteLine("An error occurred: " + ex.Message);\n    }\n    finally\n    {\n        // Ensure everything is cleaned up properly\n        if (workbook != null)\n        {\n            Marshal.ReleaseComObject(workbook);\n            workbook = null;\n        }\n        \n        if (excelApp != null)\n        {\n            excelApp.Quit();\n            Marshal.ReleaseComObject(excelApp);\n            excelApp = null;\n        }\n\n        // Force garbage collection.\n        GC.Collect();\n        GC.WaitForPendingFinalizers();\n        GC.Collect();\n        GC.WaitForPendingFinalizers();\n    }\n}