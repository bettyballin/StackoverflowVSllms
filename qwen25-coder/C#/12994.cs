// Assuming 'shapeToAdd' is the shape with compartments that need updating\nparentShape.FixupChildShapes(modelElement);\nforeach (var compartment in parentShape.GetNestedChildShapes().OfType<ElementListCompartment>())\n{\n    // Ensure each item in the compartment is visible and refreshes its visual representation\n    foreach (var item in compartment.GetNestedChildShapes())\n    {\n        item.EnsureVisible();\n        item.InvalidateVisual();\n    }\n}\n// Optionally, invalidate the parent shape as well\nparentShape.InvalidateVisual();