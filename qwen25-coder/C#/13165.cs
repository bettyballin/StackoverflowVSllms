using (var pdfStream = new MemoryStream())\n{\n    pdfStream.Write(pdfData, 0, pdfData.Length);\n    \n    // Ensure we are reading from the start of the stream\n    pdfStream.Position = 0;\n\n    var attachment = new Attachment(pdfStream, string.Format("Receipt_{0}_{1}.pdf", jobId, DateTime.UtcNow.ToString("yyyyMMddHHmm")));\n    msg.Attachments.Add(attachment);\n\n    using (var smtp = new SmtpClient(serverName, port))\n    {\n        smtp.Credentials = new NetworkCredential(fromEmailName, fromEmailPassword);\n        smtp.Send(msg);\n    }\n}