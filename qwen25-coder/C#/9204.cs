using System;\nusing System.Diagnostics;\n\npublic class PinvokeCounter\n{\n    private PerformanceCounter _counter;\n\n    public PinvokeCounter()\n    {\n        // Setup the counter if it doesn't exist\n        var category = "MyAppPerformance";\n        var counterName = "P/Invoke Rate";\n        if (!PerformanceCounterCategory.Exists(category))\n        {\n            PerformanceCounterCategory.Create(\n                category,\n                $"Custom counters for {category}",\n                PerformanceCounterCategoryType.SingleInstance,\n                new CounterCreationDataCollection(new[]\n                {\n                    new CounterCreationData(counterName, \n                                            "Rate of P/Invoke calls", \n                                            PerformanceCounterType.RawFraction)\n                }));\n        }\n\n        _counter = new PerformanceCounter(category, counterName, false);\n    }\n\n    public void PinvokeCallMade()\n    {\n        _counter.Increment();\n    }\n\n    public void Dispose()\n    {\n        _counter.Dispose();\n    }\n}