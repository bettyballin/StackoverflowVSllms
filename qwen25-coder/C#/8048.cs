using System;\nusing MailKit;\nusing MailKit.Net.Imap;\nusing MimeKit;\n\nclass Program\n{\n    static void Main()\n    {\n        using (var client = new ImapClient())\n        {\n            // For demonstration purposes, accept all SSL certificates\n            // (In production, this should be more strict!)\n            client.ServerCertificateValidationCallback = (s,c,h,e) => true;\n\n            try\n            {\n                // Connect to Gmail's IMAP server.\n                client.Connect("imap.gmail.com", 993, MailKit.Security.SecureSocketOptions.SslOnConnect);\n\n                // Authenticate\n                client.Authenticate("your-email@gmail.com", "your-password");\n\n                // Get the Inbox folder\n                var inbox = client.Inbox;\n                inbox.Open(FolderAccess.ReadWrite);\n\n                // For each message, print out its summary information.\n                foreach (var uid in inbox.Search(SearchQuery.SubjectContains("Your Search String")))\n                {\n                    var message = inbox.GetMessage(uid);\n                    Console.WriteLine("Subject: {0}", message.Subject);\n                }\n            }\n            catch (Exception e)\n            {\n                Console.WriteLine(e.Message);\n            }\n            finally\n            {\n                // Disconnect from the server.\n                client.Disconnect(true);\n            }\n        }\n    }\n}