using System;\nusing System.Windows;\nusing System.Windows.Markup;\n\npublic static string GetXamlFromControl(DependencyObject control)\n{\n    try\n    {\n        return XamlWriter.Save(control);\n    }\n    catch (Exception ex)\n    {\n        // Handle exception, possibly log the error or notify user in production code.\n        MessageBox.Show("Failed to serialize control to XAML: " + ex.Message);\n        return null;\n    }\n}\n\n// Usage example:\nvar xamlString = GetXamlFromControl(fooBox);\nif (!string.IsNullOrEmpty(xamlString))\n{\n    Console.WriteLine("Generated XAML:\n" + xamlString);\n}