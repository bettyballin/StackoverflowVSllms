foreach(string command in S) // command is something like "c:\a.exe"\n{\n    Process p = null;\n    try\n    {\n        p = Process.Start(command);\n        // Optionally wait for the process to exit if needed.\n        // p.WaitForExit(); \n    }\n    catch (Exception e)\n    {\n        // notify of process failure\n        Console.WriteLine($"Failed to start process {command}: {e.Message}");\n    }\n    finally\n    {\n        if (p != null)\n        {\n            try\n            {\n                p.Close();\n            }\n            catch (InvalidOperationException) // Handle the case where the process has already exited.\n            {\n                // Process already closed or terminated, no action required.\n            }\n            catch (Exception e)\n            {\n                Console.WriteLine($"Failed to close process {command}: {e.Message}");\n            }\n        }\n    }\n}