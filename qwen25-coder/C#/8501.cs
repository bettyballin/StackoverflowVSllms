public class AuthenticationModule : IHttpModule\n{\n    public void Init(HttpApplication context)\n    {\n        context.BeginRequest += OnBeginRequest;\n    }\n\n    private void OnBeginRequest(object sender, EventArgs e)\n    {\n        HttpApplication application = (HttpApplication)sender;\n        HttpContext context = application.Context;\n\n        // Check if the user is authenticated\n        if (context.Application["username"] == null)\n        {\n            context.Response.Redirect("login.aspx");\n        }\n    }\n\n    public void Dispose() { }\n}