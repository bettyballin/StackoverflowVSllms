public void SetPermission(string user, FileSystemRights rights)\n{\n    DirectoryInfo dInfo = new DirectoryInfo(folderPath);\n    DirectorySecurity oDirectorySecurity = dInfo.GetAccessControl(AccessControlSections.Access);\n\n    // Remove existing access rules for the given user\n    AuthorizationRuleCollection rules = oDirectorySecurity.GetAccessRules(true, false, typeof(System.Security.Principal.NTAccount));\n    foreach (FileSystemAccessRule rule in rules)\n    {\n        if (rule.IdentityReference.Value.Equals(user))\n        {\n            oDirectorySecurity.RemoveAccessRule(rule);\n        }\n    }\n\n    // Add the new access rule\n    oDirectorySecurity.AddAccessRule(new FileSystemAccessRule(user, rights, AccessControlType.Allow));\n    \n    // Apply the updated security settings to the directory\n    dInfo.SetAccessControl(oDirectorySecurity);\n}