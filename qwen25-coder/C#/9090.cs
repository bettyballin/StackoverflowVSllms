public class WcfClient<T> : IDisposable where T : class\n{\n    private ChannelFactory<T> factory;\n    public T Client { get; private set; }\n\n    public WcfClient(string endpointConfigurationName)\n    {\n        factory = new ChannelFactory<T>(endpointConfigurationName);\n        Client = factory.CreateChannel();\n    }\n\n    public void Dispose()\n    {\n        try\n        {\n            if (((IClientChannel)Client).State == CommunicationState.Faulted)\n                ((IClientChannel)Client).Abort();\n            else\n                ((IClientChannel)Client).Close();\n\n        }\n        catch (Exception ex)\n        {\n            // handle exception and log it\n            ((IClientChannel)Client).Abort();\n        }\n        finally\n        {\n            factory.Close();\n        }\n    }\n}