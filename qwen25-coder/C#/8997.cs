using System;\nusing System.IO;\nusing System.Net.Security;\nusing System.Net.Sockets;\nusing Novell.Directory.Ldap;\n\npublic class SecureLdapClient\n{\n    public void ConnectToSecureLdap(string ldapHost, int ldapPort, string userDN, string userPasswd)\n    {\n        using (var socket = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp))\n        {\n            socket.Connect(ldapHost, ldapPort);\n\n            // Wrap the socket in an SslStream\n            var sslStream = new SslStream(\n                new NetworkStream(socket), false,\n                new RemoteCertificateValidationCallback(ValidateServerCertificate),\n                null);\n\n            try\n            {\n                // Authenticate as a client to an SSL server.\n                sslStream.AuthenticateAsClient("serverName");  // Replace "serverName" with your LDAP server's name\n\n                // Now you can use the Novell.Directory.Ldap library over the secure stream\n                var ldapInputStream = new NetworkStream(sslStream);\n                var ldapOutputStream = new NetworkStream(sslStream);\n\n                using (var ldapConnection = new LdapConnection())\n                {\n                    ldapConnection.Rebind(userDN, userPasswd, ldapInputStream, ldapOutputStream);\n                }\n            }\n            catch (AuthenticationException e)\n            {\n                Console.WriteLine("Exception: {0}", e.Message);\n                if (e.InnerException != null)\n                {\n                    Console.WriteLine("Inner exception: {0}", e.InnerException.Message);\n                }\n                return;\n            }\n        }\n    }\n\n    public static bool ValidateServerCertificate(\n          object sender,\n          X509Certificate certificate,\n          X509Chain chain,\n          SslPolicyErrors sslPolicyErrors)\n    {\n        if (sslPolicyErrors == SslPolicyErrors.None)\n        {\n            return true;\n        }\n\n        Console.WriteLine("Certificate error: {0}", sslPolicyErrors);\n\n        // Optionally, write code here to check the certificate and decide whether to accept it.\n        /*\n        Do not allow this client to communicate with unauthenticated servers. \n        Change the following line of code to return true only if the server is authenticated.\n        */\n        return false;\n    }\n}