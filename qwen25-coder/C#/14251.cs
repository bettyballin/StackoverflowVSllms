using System;\nusing System.Collections;\nusing System.DirectoryServices;\n\npublic void GetLargeGroupMembers(DirectoryEntry group)\n{\n    int rangeSize = 1500; // Adjust based on server capacity and performance needs\n    string attribute = "member";\n    string filter = $"{attribute};range=0-{rangeSize - 1}";\n    ArrayList members = new ArrayList();\n\n    while (true)\n    {\n        group.RefreshCache(new[] { filter });\n        \n        if (group.Properties[attribute].Count == 0)\n            break;\n\n        foreach (var member in group.Properties[attribute])\n        {\n            members.Add(member);\n        }\n\n        // Get the next range\n        string[] range = ((string)group.Properties[attribute][0]).Split(new[] { ';' }, 3)[1].Split('-');\n        int lowerBound = int.Parse(range[0]);\n        int upperBound = int.Parse(range[1]);\n\n        if (upperBound - lowerBound < rangeSize - 1)\n            break; // No more ranges to request\n\n        filter = $"{attribute};range={upperBound + 1}-{upperBound + rangeSize}";\n    }\n\n    Console.WriteLine($"Total members: {members.Count}");\n}