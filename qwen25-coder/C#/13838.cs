using System;\nusing ADODB;\n\npublic class QueryValidator\n{\n    public bool IsValidInsertUpdateDeleteQuery(string connectionString, string query)\n    {\n        Connection conn = new Connection();\n        try\n        {\n            // Open the connection.\n            conn.Open(connectionString, String.Empty, String.Empty, -1);\n\n            // Check if the query is an INSERT, UPDATE, or DELETE statement.\n            string trimmedQuery = query.Trim().ToLower();\n            bool isWriteOperation = trimmedQuery.StartsWith("insert") ||\n                                   trimmedQuery.StartsWith("update") ||\n                                   trimmedQuery.StartsWith("delete");\n\n            if (!isWriteOperation)\n            {\n                return false;\n            }\n\n            // Create a new command to test the syntax of the query.\n            Command cmd = new Command();\n            cmd.ActiveConnection = conn;\n            cmd.CommandText = query;\n\n            try\n            {\n                // Prepare the statement without executing it. This can validate syntax.\n                cmd.Prepare();\n                return true; // Syntax is valid.\n            }\n            catch (Exception ex)\n            {\n                Console.WriteLine("Syntax error in SQL query: " + ex.Message);\n                return false; // Syntax is not valid.\n            }\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine("Error connecting to the database: " + ex.Message);\n            return false;\n        }\n        finally\n        {\n            // Ensure the connection is closed.\n            if (conn.State == 1) conn.Close();\n        }\n    }\n}