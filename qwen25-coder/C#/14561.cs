using System;\nusing System.Collections.Generic;\nusing System.IO;\nusing System.IO.Compression;\nusing System.Windows.Documents;\nusing System.Xml;\n\npublic class Question\n{\n    public TextRange RichText1 { get; set; }\n    public TextRange RichText2 { get; set; }\n\n    // Other properties of the Question class...\n}\n\npublic class RichTextFileManager\n{\n    private readonly FlowDocument _dummyDocument = new FlowDocument();\n\n    public void SaveQuestions(List<Question> questions, string filePath)\n    {\n        using (var fileStream = File.Create(filePath))\n        using (var gzipStream = new GZipStream(fileStream, CompressionLevel.Optimal))\n        using (var xmlWriter = XmlWriter.Create(gzipStream))\n        {\n            xmlWriter.WriteStartElement("Questions");\n\n            foreach (var question in questions)\n            {\n                SaveRichText(question.RichText1, xmlWriter);\n                // Optionally save RichText2 here\n                // SaveRichText(question.RichText2, xmlWriter);\n            }\n\n            xmlWriter.WriteEndElement();\n        }\n    }\n\n    private void SaveRichText(TextRange textRange, XmlWriter writer)\n    {\n        using (var memoryStream = new MemoryStream())\n        {\n            textRange.Save(memoryStream, DataFormats.Xaml);\n            WriteBase64EncodedBinaryData(writer, memoryStream.GetBuffer(), 0, (int)memoryStream.Length);\n        }\n    }\n\n    private void WriteBase64EncodedBinaryData(XmlWriter writer, byte[] buffer, int start, int count)\n    {\n        var base64 = Convert.ToBase64String(buffer, start, count);\n        writer.WriteString(base64);\n    }\n\n    public List<Question> LoadQuestions(string filePath)\n    {\n        var questions = new List<Question>();\n        using (var fileStream = File.OpenRead(filePath))\n        using (var gzipStream = new GZipStream(fileStream, CompressionMode.Decompress))\n        using (var xmlReader = XmlReader.Create(gzipStream))\n        {\n            while (xmlReader.Read())\n            {\n                if (xmlReader.IsStartElement("TextRange"))\n                {\n                    questions.Add(new Question\n                    {\n                        RichText1 = LoadRichText(xmlReader),\n                        // Optionally load RichText2 here\n                        // RichText2 = LoadRichText(xmlReader)\n                    });\n                }\n            }\n        }\n\n        return questions;\n    }\n\n    private TextRange LoadRichText(XmlReader reader)\n    {\n        var dummyRange = new TextRange(_dummyDocument.ContentStart, _dummyDocument.ContentEnd);\n        var xmlData = reader.ReadElementContentAsString();\n        using (var memoryStream = new MemoryStream(Convert.FromBase64String(xmlData)))\n        {\n            dummyRange.Load(memoryStream, DataFormats.Xaml);\n        }\n\n        return dummyRange;\n    }\n}