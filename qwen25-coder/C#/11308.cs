using Microsoft.VisualStudio.TestTools.UnitTesting;\n\n[TestClass]\npublic class HttpProxyTests\n{\n    private const string ProxyPrefix = "http://localhost:8081/";\n    private HttpProxyServer _proxyServer;\n\n    [TestInitialize]\n    public void Setup()\n    {\n        // Start the proxy server.\n        _proxyServer = new HttpProxyServer(ProxyPrefix);\n        _proxyServer.Start();\n    }\n\n    [TestMethod]\n    public async Task TestHttpRequestThroughProxy()\n    {\n        var httpClient = new HttpClient { Proxy = new WebProxy(new Uri(ProxyPrefix)) };\n        HttpResponseMessage response = await httpClient.GetAsync("http://example.com");\n\n        Assert.AreEqual(HttpStatusCode.OK, response.StatusCode);\n    }\n\n    [TestCleanup]\n    public void Cleanup()\n    {\n        // Stop the proxy server.\n        _proxyServer.Stop();\n    }\n}