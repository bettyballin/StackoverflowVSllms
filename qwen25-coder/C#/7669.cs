using System;\nusing System.Web;\n\npublic class LogAuthenticationModule : IHttpModule\n{\n    public void Init(HttpApplication context)\n    {\n        context.EndRequest += new EventHandler(OnEndRequest);\n    }\n\n    private void OnEndRequest(object sender, EventArgs e)\n    {\n        HttpContext ctx = ((HttpApplication)sender).Context;\n        if (ctx.User != null && ctx.User.Identity.IsAuthenticated)\n        {\n            string username = ctx.User.Identity.Name;\n            // Set the "X-Authenticated-User" header to pass the username\n            ctx.Response.Headers["X-Authenticated-User"] = username;\n        }\n    }\n\n    public void Dispose() { }\n}