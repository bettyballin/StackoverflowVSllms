SPSecurity.RunWithElevatedPrivileges(\n    delegate\n    {\n        int currentUserId = SPContext.Current.Web.CurrentUser.ID;\n        \n        using (SPSite elevatedSite = new SPSite(SPContext.Current.Site.Url))\n        using (SPWeb targetWeb = elevatedSite.OpenWeb(webUrl, false)) // Open the web without impersonation context\n        {\n            SPUser currentUser = targetWeb.AllUsers.GetByID(currentUserId);\n            \n            targetWeb.AllowUnsafeUpdates = true;\n            SPFile newFile = files.Add(filename, file);\n            SPListItem item = newFile.Item;\n            \n            // Set Author and Editor fields to the current user\n            item["Author"] = new SPFieldUserValue(targetWeb, currentUser.ID, currentUser.Name);\n            item["Editor"] = new SPFieldUserValue(targetWeb, currentUser.ID, currentUser.Name);\n            \n            item.SystemUpdate(false); // False parameter to prevent updating of Modified or Modified By fields\n        }\n    }\n);