using System.DirectoryServices.AccountManagement;\nusing System.Security.Principal;\n\npublic List<string> GetAllUsers()\n{\n    var userList = new List<string>();\n    \n    // Get Windows Identity for the logged-in user\n    var wi = (WindowsIdentity)HttpContext.Current.User.Identity;\n    \n    using (var impersonatedUser = wi.Impersonate())\n    {\n        try\n        {\n            using (PrincipalContext context = new PrincipalContext(ContextType.Domain))\n            {\n                using (UserPrincipal qbeUser = new UserPrincipal(context))\n                {\n                    using (PrincipalSearcher srch = new PrincipalSearcher(qbeUser))\n                    {\n                        foreach (var found in srch.FindAll())\n                        {\n                            userList.Add(((UserPrincipal)found).SamAccountName);\n                        }\n                    }\n                }\n            }\n        }\n        catch (Exception ex)\n        {\n            // Handle exceptions (e.g., logging)\n        }\n    }\n\n    return userList;\n}