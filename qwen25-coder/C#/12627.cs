public static SizeF GetAvgCharSizeF(Graphics g, Font font)\n{\n    String s = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";\n    StringFormat format = new StringFormat();\n\n    CharacterRange[] ranges = new CharacterRange[s.Length];\n    for (int i = 0; i < s.Length; i++)\n        ranges[i] = new CharacterRange(i, 1);\n\n    Region[] regions = g.MeasureCharacterRanges(s, font, new RectangleF(0, 0, 1000, 1000), format);\n\n    float totalWidth = 0;\n    float maxHeight = 0;\n\n    foreach (Region region in regions)\n    {\n        RectangleF rect = region.GetBounds(g);\n        totalWidth += rect.Width;\n        if (rect.Height > maxHeight) maxHeight = rect.Height;\n    }\n\n    float baseUnitX = totalWidth / s.Length;\n    float baseUnitY = maxHeight;\n\n    return new SizeF(baseUnitX, baseUnitY);\n}