using System;\nusing Microsoft.Office.Interop.Outlook;\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        Application outlookApplication = new Application();\n        NameSpace mapiNamespace = outlookApplication.GetNamespace("MAPI");\n        \n        // Logon to the default Outlook profile.\n        MAPIFolder rootFolder = mapiNamespace.Folders[1]; // Get the first user's mailbox\n        \n        // Call the recursive method to print all folder names\n        PrintFolders(rootFolder);\n    }\n\n    static void PrintFolders(MAPIFolder folder)\n    {\n        try\n        {\n            Console.WriteLine(folder.Name);\n\n            if (folder.Folders.Count > 0)\n            {\n                foreach (MAPIFolder subFolder in folder.Folders)\n                {\n                    PrintFolders(subFolder);\n                }\n            }\n        }\n        catch (System.Runtime.InteropServices.COMException ex)\n        {\n            // Handle errors, such as permission denied\n            Console.WriteLine($"Error accessing folder '{folder.Name}': {ex.Message}");\n        }\n    }\n}