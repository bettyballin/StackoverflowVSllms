using System;\nusing EnvDTE;\nusing Extensibility;\n\nnamespace MyFirstAddIn\n{\n    public class Connect : IDTExtensibility2, IDTCommandTarget\n    {\n        private DTE2 _applicationObject;\n        \n        public void OnConnection(object application, ext_ConnectMode connectMode, object addInInst, ref Array custom)\n        {\n            _applicationObject = (DTE2)application;\n\n            if (connectMode == Extensibility.ext_ConnectMode.ext_cm_UISetup)\n                SetupCommands();\n        }\n\n        private void SetupCommands()\n        {\n            // Command setup code here\n        }\n\n        public void OnDisconnection(ext_DisconnectMode removeMode, ref Array custom) { }\n        public void OnAddInsUpdate(ref Array custom) { }\n        public void OnStartupComplete(ref Array custom) { }\n        public void OnQuit(ref Array custom) { }\n        public void Exec(string commandName, vsCommandExecOption executeOption, ref object varIn, ref object varOut, ref bool handled)\n        {\n            if (commandName == "MyFirstAddIn.Connect.MyFirstCommand")\n                ShowMessage();\n        }\n\n        private void ShowMessage()\n        {\n            _applicationObject.StatusBar.Text = "Hello from My First Add-In!";\n        }\n    }\n}