using System;\nusing System.Collections.Generic;\nusing System.DirectoryServices.AccountManagement;\n\nclass Program\n{\n    static void Main()\n    {\n        HashSet<string> departments = new HashSet<string>(); // Use HashSet to avoid duplicates\n\n        using (PrincipalContext context = new PrincipalContext(ContextType.Domain))\n        {\n            UserPrincipal user = new UserPrincipal(context);\n            var searcher = new PrincipalSearcher(user);\n\n            foreach (var result in searcher.FindAll())\n            {\n                if (result is UserPrincipal foundUser)\n                {\n                    string department = foundUser.Department;\n                    if (!string.IsNullOrEmpty(department) && !departments.Contains(department))\n                    {\n                        departments.Add(department);\n                    }\n                }\n            }\n        }\n\n        Console.WriteLine("List of Departments:");\n        foreach (var dept in departments)\n        {\n            Console.WriteLine(dept);\n        }\n    }\n}