int retries = 5;\n   while (retries > 0)\n   {\n       try\n       {\n           System.IO.TextWriter writer = new System.IO.StreamWriter("file.txt");\n           i++;\n           Console.Out.WriteLine(i);\n           writer.Write(i);\n           writer.Close();\n           System.IO.File.Delete("file.txt");\n           break;\n       }\n       catch (System.UnauthorizedAccessException ex)\n       {\n           retries--;\n           if (retries == 0) throw;\n           System.Threading.Thread.Sleep(100); // delay for a bit before retry\n       }\n   }