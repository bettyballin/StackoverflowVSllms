using EnvDTE;\nusing Microsoft.TeamFoundation.Client;\nusing Microsoft.TeamFoundation.VersionControl.Client;\n\npublic void GetCurrentWorkspace()\n{\n    // Get the active DTE instance\n    var dte = (DTE)System.Runtime.InteropServices.Marshal.GetActiveObject("VisualStudio.DTE");\n\n    string solutionPath = null;\n    if (dte.Solution.IsOpen)\n    {\n        solutionPath = dte.Solution.FullName;\n    }\n    else\n    {\n        // Handle the case where no solution is open, or use another project file path\n        return;\n    }\n\n    // Connect to TFS\n    var tpc = new TfsTeamProjectCollection(new Uri("http://tfsserver:8080/tfs/DefaultCollection"));\n    tpc.Authenticate();\n    \n    var workspaceInfo = VersionControlExplorer.Instance.WorkspaceInfoFromAnySolutionFile(solutionPath);\n    if (workspaceInfo != null)\n    {\n        var workspace = workspaceInfo.Workspace;\n\n        // Output the current workspace name\n        System.Diagnostics.Debug.WriteLine($"Current Workspace: {workspace.Name}");\n    }\n    else\n    {\n        System.Diagnostics.Debug.WriteLine("No workspace found for this solution.");\n    }\n}