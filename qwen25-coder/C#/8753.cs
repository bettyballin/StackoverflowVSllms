using System;\nusing System.IO;\nusing System.Timers;\n\nclass Program\n{\n    private static Timer timer;\n\n    static void Main()\n    {\n        string directoryPath = @"C:\wallpapers";\n\n        // Set up a timer to trigger every 15 minutes (900,000 milliseconds)\n        timer = new Timer(900000);\n        timer.Elapsed += OnTimedEvent;\n        timer.AutoReset = true;\n        timer.Enabled = true;\n\n        Console.WriteLine("Press Enter to exit the sample.");\n        Console.ReadLine();\n    }\n\n    private static void OnTimedEvent(Object source, ElapsedEventArgs e)\n    {\n        string directoryPath = @"C:\wallpapers";\n        \n        // Get all files in the directory\n        string[] files = Directory.GetFiles(directoryPath);\n\n        if (files.Length == 0)\n        {\n            Console.WriteLine("No files found.");\n            return;\n        }\n\n        Random random = new Random();\n        int index = random.Next(files.Length);\n        string selectedFile = files[index];\n\n        Console.WriteLine($"Selected wallpaper at {e.SignalTime}: {selectedFile}");\n\n        // Here you can add code to set the wallpaper\n    }\n}