using System;\nusing System.ServiceProcess;\nusing CredentialManagement;\n\npublic class MyWindowsService : ServiceBase\n{\n    protected override void OnStart(string[] args)\n    {\n        var cm = new Credential() { Target = "YourAppTarget", PersistanceType = PersistanceType.Enterprise };\n        bool found = cm.Load();\n\n        if (found && !string.IsNullOrEmpty(cm.Username) && !string.IsNullOrEmpty(cm.Password))\n        {\n            // Use cm.Username and cm.Password to connect your database\n            ConnectToDatabase(cm.Username, cm.Password);\n        }\n        else\n        {\n            throw new Exception("Credentials not found.");\n        }\n    }\n\n    private void ConnectToDatabase(string username, string password)\n    {\n        // Your code to connect to the MS SQL Server database\n    }\n}