using System.Configuration;\n\n   public class RecipientElement : ConfigurationElement\n   {\n       [ConfigurationProperty("name", IsRequired = true)]\n       public string Name { get; set; }\n\n       [ConfigurationProperty("email", IsRequired = true)]\n       public string Email { get; set; }\n   }\n\n   public class RecipientsSection : ConfigurationSection\n   {\n       [ConfigurationProperty("", IsDefaultCollection = true)]\n       [ConfigurationCollection(typeof(RecipientElement), AddItemName = "recipient")]\n       public RecipientElementCollection Recipients => (RecipientElementCollection)base[""];\n   }\n\n   [ConfigurationCollection(typeof(RecipientElement))]\n   public class RecipientElementCollection : ConfigurationElementCollection\n   {\n       protected override ConfigurationElement CreateNewElement()\n       {\n           return new RecipientElement();\n       }\n\n       protected override object GetElementKey(ConfigurationElement element)\n       {\n           var recipient = (RecipientElement)element;\n           return recipient.Name;\n       }\n   }