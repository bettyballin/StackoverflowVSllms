using System;\nusing System.Xml;\nusing System.Xml.Linq;\nusing System.Xml.XPath;\n\nclass Program\n{\n    static void Main()\n    {\n        // Sample XDocument with namespaces\n        XDocument document = XDocument.Parse(@"\n            <root xmlns:xx='http://example.com/ns1'>\n                <xx:Name>Example</xx:Name>\n            </root>");\n\n        var namespaceManager = new XmlNamespaceManager(new NameTable());\n\n        // Extracting namespaces and adding them to the XmlNamespaceManager\n        foreach (var xAttribute in document.Descendants().Attributes(XNamespace.Xmlns + "*"))\n        {\n            string prefix = xAttribute.Name.LocalName;\n            string uri = xAttribute.Value;\n            namespaceManager.AddNamespace(prefix, uri);\n        }\n\n        // Using XPathSelectElements with namespaces\n        var elements = document.XPathSelectElements("//xx:Name", namespaceManager);\n\n        foreach (var element in elements)\n        {\n            Console.WriteLine(element);\n        }\n    }\n}