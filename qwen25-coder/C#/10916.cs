using System;\nusing System.IO;\nusing System.Windows.Media.Imaging;\n\npublic class ImageRecord\n{\n    public ImageRecord(string file)\n    {\n        try\n        {\n            using (FileStream stream = new FileStream(file, FileMode.Open, FileAccess.Read))\n            {\n                JpegBitmapDecoder decoder = new JpegBitmapDecoder(stream, BitmapCreateOptions.None, BitmapCacheOption.Default);\n                BitmapFrame frame = decoder.Frames[0];\n                BitmapMetadata metadata = frame.Metadata as BitmapMetadata;\n\n                if (metadata != null)\n                {\n                    // Attempt to read IPTC metadata\n                    var iptcData = metadata.GetQuery("/app13/irb/8bimiptc/iptc");\n                    // Process iptcData as needed...\n                }\n            }\n        }\n        catch (Exception ex) when (ex is System.OverflowException || ex is COMException)\n        {\n            // Log the exception details or handle it according to your application's requirements\n            Console.WriteLine($"Error reading metadata for {file}: {ex.Message}");\n        }\n    }\n}