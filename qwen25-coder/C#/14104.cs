using System;\nusing System.Linq;\n\npublic class TimesheetReportData\n{\n    public string TaskName { get; set; }\n    public int Sunday { get; set; }\n    public int Monday { get; set; }\n    public int Tuesday { get; set; }\n    public int Wednesday { get; set; }\n    public int Thursday { get; set; }\n    public int Friday { get; set; }\n    public int Saturday { get; set; }\n}\n\npublic IQueryable<TimesheetReportData> GetTimesheetForWeekById(int timesheetId, DateTime beginDate, DateTime endDate)\n{\n    var query = from task in Context.Tasks\n                join timeEntry in Context.TimeEntries on task.TaskID equals timeEntry.TaskID\n                where timeEntry.TimesheetID == timesheetId &&\n                      timeEntry.StartTime >= beginDate &&\n                      timeEntry.StartTime <= endDate\n                group timeEntry by new { TaskName = task.TaskName } into groupedData\n                select new TimesheetReportData\n                {\n                    TaskName = groupedData.Key.TaskName,\n                    Sunday    = groupedData.Sum(te => te.StartTime.DayOfWeek == DayOfWeek.Sunday    ? (int)te.EndTime.Subtract(te.StartTime).TotalMinutes : 0),\n                    Monday   = groupedData.Sum(te => te.StartTime.DayOfWeek == DayOfWeek.Monday   ? (int)te.EndTime.Subtract(te.StartTime).TotalMinutes : 0),\n                    Tuesday  = groupedData.Sum(te => te.StartTime.DayOfWeek == DayOfWeek.Tuesday  ? (int)te.EndTime.Subtract(te.StartTime).TotalMinutes : 0),\n                    Wednesday= groupedData.Sum(te => te.StartTime.DayOfWeek == DayOfWeek.Wednesday? (int)te.EndTime.Subtract(te.StartTime).TotalMinutes : 0),\n                    Thursday = groupedData.Sum(te => te.StartTime.DayOfWeek == DayOfWeek.Thursday ? (int)te.EndTime.Subtract(te.StartTime).TotalMinutes : 0),\n                    Friday   = groupedData.Sum(te => te.StartTime.DayOfWeek == DayOfWeek.Friday   ? (int)te.EndTime.Subtract(te.StartTime).TotalMinutes : 0),\n                    Saturday = groupedData.Sum(te => te.StartTime.DayOfWeek == DayOfWeek.Saturday ? (int)te.EndTime.Subtract(te.StartTime).TotalMinutes : 0)\n                };\n\n    return query;\n}