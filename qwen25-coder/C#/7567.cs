public class MedianCalculator\n{\n    private readonly int[] _histogram;\n    private int _total = 0;\n\n    // Define the range and increment of your data.\n    private const double MinValue = -25;\n    private const double MaxValue = -0.5;\n    private const double Increment = 0.5;\n\n    public MedianCalculator()\n    {\n        int numberOfBins = (int)((MaxValue - MinValue) / Increment) + 1;\n        _histogram = new int[numberOfBins];\n    }\n\n    public void Add(double value)\n    {\n        if (value < MinValue || value > MaxValue)\n            throw new ArgumentOutOfRangeException(nameof(value), "Value is out of the defined range.");\n\n        int binIndex = (int)((value - MinValue) / Increment);\n        _histogram[binIndex]++;\n        _total++;\n    }\n\n    public double Median\n    {\n        get\n        {\n            if (_total == 0)\n                throw new InvalidOperationException("No values have been added to the calculator.");\n\n            int count = 0;\n            for (int i = 0; i < _histogram.Length; i++)\n            {\n                count += _histogram[i];\n                if ((double)count * 2 >= _total)\n                    return MinValue + i * Increment;\n            }\n\n            throw new InvalidOperationException("Failed to calculate the median.");\n        }\n    }\n}