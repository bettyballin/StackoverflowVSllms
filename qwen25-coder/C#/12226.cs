class TripleDESEncryption\n{\n    private readonly TripleDESCryptoServiceProvider engine;\n\n    public TripleDESEncryption() : this(256) { }\n\n    public TripleDESEncryption(int keySizeInBits)\n    {\n        engine = new TripleDESCryptoServiceProvider \n        { \n            KeySize = keySizeInBits,\n            Padding = PaddingMode.PKCS7\n        };\n        engine.GenerateKey();\n    }\n\n    public byte[] Encrypt(byte[] plain)\n    {\n        return engine.CreateEncryptor().TransformFinalBlock(plain, 0, plain.Length);\n    }\n\n    public byte[] Decrypt(byte[] encrypted)\n    {\n        return engine.CreateDecryptor().TransformFinalBlock(encrypted, 0, encrypted.Length);\n    }\n}