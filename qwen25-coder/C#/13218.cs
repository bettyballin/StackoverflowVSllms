private void button1_Click(object sender, EventArgs e)\n{\n    Layer1();\n    MessageBox.Show("OK");\n}\n\nprivate void Layer1()\n{\n    try\n    {\n        Layer2(); // Deny frame is active here\n    }\n    catch (SecurityException)\n    {\n        MessageBox.Show("Caught");\n    }\n    Layer2b(); // No deny frame here\n}\n\nprivate void Layer2()\n{\n    new System.Security.Permissions.FileIOPermission(PermissionState.Unrestricted).Deny();\n    Layer3(); // Access denied due to Deny Frame\n}\n\nprivate void Layer2b()\n{\n    Layer3(); // Access allowed, no Deny Frame in this path\n}\n\n[FileIOPermission(SecurityAction.LinkDemand, Write = @"C:\temp")]\nprivate void Layer3()\n{\n    using (FileStream stream = new FileStream(@"C:\temp\test.txt", FileMode.Create))\n    {\n    }\n}