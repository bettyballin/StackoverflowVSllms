using (SqlConnection connection = new SqlConnection(connectionString))\n{\n    string insertQuery = "INSERT INTO upload_history (field1, field2, field3) VALUES (@field1, @field2, @field3)";\n\n    using (SqlCommand command = new SqlCommand(insertQuery, connection))\n    {\n        // Add parameters with proper handling of NULL values\n        command.Parameters.AddWithValue("@field1", varField1 ?? (object)DBNull.Value);\n        command.Parameters.AddWithValue("@field2", varField2 ?? (object)DBNull.Value);\n        command.Parameters.AddWithValue("@field3", varField3 ?? (object)DBNull.Value);\n\n        connection.Open();\n        command.ExecuteNonQuery();\n    }\n}