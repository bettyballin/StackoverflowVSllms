using System;\nusing System.Windows.Automation;\n\npublic class MessageBoxClicker\n{\n    public void ClickButtonOnMessageBox(string windowTitle, string buttonName)\n    {\n        // Find the message box by its title\n        AutomationElement messageBox = AutomationElement.RootElement.FindFirst(TreeScope.Children,\n            new PropertyCondition(AutomationElement.NameProperty, windowTitle));\n\n        if (messageBox == null)\n        {\n            throw new Exception("Message box not found.");\n        }\n\n        // Get the OK button from the dialog.\n        AutomationElement okButton = messageBox.FindFirst(TreeScope.Descendants,\n            new PropertyCondition(AutomationElement.NameProperty, buttonName));\n\n        if (okButton == null)\n        {\n            throw new Exception("OK button not found on message box.");\n        }\n\n        // Invoke a click action against the OK button\n        InvokePattern invokePattern = okButton.GetCurrentPattern(InvokePattern.Pattern) as InvokePattern;\n        invokePattern.Invoke();\n    }\n}\n\n// Example usage:\n// MessageBoxClicker clicker = new MessageBoxClicker();\n// clicker.ClickButtonOnMessageBox("Message Box Title", "OK");