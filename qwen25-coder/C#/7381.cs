using System;\nusing System.Management;\n\nclass ServiceStartupChanger\n{\n    public static void SetServiceStartupType(string serviceName, int startType)\n    {\n        ManagementClass process = new ManagementClass("Win32_Service");\n        ManagementObjectCollection services = process.GetInstances();\n\n        foreach (ManagementObject service in services)\n        {\n            if ((string)service["Name"] == serviceName)\n            {\n                try\n                {\n                    // Change the startup type\n                    var outParams = service.InvokeMethod("ChangeStartMode",\n                        new object[] { startType.ToString() }, null);\n                    Console.WriteLine($"Startup type changed to {startType}. Result: {outParams.Properties["ReturnValue"].Value}");\n                }\n                catch (Exception ex)\n                {\n                    Console.WriteLine("Failed to change the startup type of the service. Error: " + ex.Message);\n                }\n            }\n        }\n    }\n\n    static void Main(string[] args)\n    {\n        // Change the startup type of a service named 'YourServiceName'\n        SetServiceStartupType("YourServiceName", 2); // 2 = Automatic, 3 = Manual, 4 = Disabled\n    }\n}