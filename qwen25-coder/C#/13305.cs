using System;\nusing System.Collections.Generic;\nusing System.IO;\n\nclass Program\n{\n    static void Main()\n    {\n        string directoryPath = @"C:\Your\Directory\Path";\n        List<string> lockedFiles = GetLockedFiles(directoryPath);\n\n        Console.WriteLine("Locked files:");\n        foreach (string file in lockedFiles)\n        {\n            Console.WriteLine(file);\n        }\n    }\n\n    public static List<string> GetLockedFiles(string dirPath)\n    {\n        List<string> lockedFilesList = new List<string>();\n\n        try\n        {\n            foreach (string filePath in Directory.GetFiles(dirPath, "*.*", SearchOption.AllDirectories))\n            {\n                if (IsFileLocked(filePath))\n                {\n                    lockedFilesList.Add(filePath);\n                }\n            }\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine("An error occurred: " + ex.Message);\n        }\n\n        return lockedFilesList;\n    }\n\n    public static bool IsFileLocked(string filePath)\n    {\n        try\n        {\n            using (FileStream inputStream = File.Open(filePath, FileMode.Open, FileAccess.Read, FileShare.None))\n            {\n                // If no exception is thrown, the file is not locked.\n            }\n        }\n        catch (IOException e)\n        {\n            // The exception is thrown if the specified file is in use.\n            int errorCode = Marshal.GetHRForException(e) & ((1 << 16) - 1);\n            return errorCode == 32 || errorCode == 33;\n        }\n\n        return false;\n    }\n}