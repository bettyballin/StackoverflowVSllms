using System;\nusing System.Collections.Generic;\nusing Microsoft.Office.Interop.Excel;\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        List<Application> excelInstances = new List<Application>();\n        \n        try\n        {\n            // Start two instances of Excel\n            for (int i = 0; i < 2; i++)\n            {\n                Application excelApp = new Application();\n                excelApp.Visible = true;\n                Workbooks workbooks = excelApp.Workbooks;\n                Workbook workbook = workbooks.Add(Type.Missing);\n                _Worksheet worksheet = (_Worksheet)workbook.Sheets[1];\n\n                // Example: Write some data to the Excel sheet\n                ((Microsoft.Office.Interop.Excel.Range)worksheet.Cells[1, 1]).Value2 = "Hello from instance " + i;\n\n                excelInstances.Add(excelApp);\n            }\n\n            // Wait for user input before closing Excel instances\n            Console.WriteLine("Press any key to exit...");\n            Console.ReadKey();\n\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine("An error occurred: " + ex.Message);\n        }\n        finally\n        {\n            // Properly release the COM objects\n            foreach (var excelApp in excelInstances)\n            {\n                if (excelApp != null)\n                {\n                    excelApp.Quit();\n                    System.Runtime.InteropServices.Marshal.ReleaseComObject(excelApp.Workbooks);\n                    System.Runtime.InteropServices.Marshal.ReleaseComObject(excelApp);\n                }\n            }\n\n            // Force a garbage collection to release the COM objects\n            GC.WaitForPendingFinalizers();\n            GC.Collect();\n        }\n    }\n}