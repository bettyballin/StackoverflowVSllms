using System;\nusing System.Collections;\nusing System.DirectoryServices;\n\nnamespace ActiveDirectoryQuery\n{\n    public class AdQuery\n    {\n        public void RenderGroups(HtmlTextWriter output)\n        {\n            string domainPath = "LDAP://DC=MyDomain,DC=com"; // Replace with your actual domain controller or domain path\n\n            try\n            {\n                DirectoryEntry domain = new DirectoryEntry(domainPath);\n                DirectorySearcher searcher = new DirectorySearcher(domain)\n                {\n                    Filter = "(cn=Administrators)"\n                };\n\n                SearchResult result = searcher.FindOne();\n                if (result != null)\n                {\n                    string groupDN = result.Properties["distinguishedName"][0].ToString();\n                    DirectoryEntry admGroup = new DirectoryEntry("LDAP://" + groupDN);\n\n                    object members = admGroup.Invoke("Members", null);\n                    foreach (object member in (IEnumerable)members)\n                    {\n                        DirectoryEntry user = new DirectoryEntry(member);\n                        output.RenderBeginTag("p");\n                        output.Write(user.Properties["name"][0].ToString());\n                        output.RenderEndTag();\n                    }\n                }\n                else\n                {\n                    output.RenderBeginTag("p");\n                    output.Write("Administrators group not found.");\n                    output.RenderEndTag();\n                }\n\n            }\n            catch (Exception ex)\n            {\n                output.RenderBeginTag("p");\n                output.Write("Error: " + ex.Message);\n                output.RenderEndTag();\n            }\n\n            base.Render(output);\n        }\n    }\n}