using System;\nusing iTunesLib;\n\nclass Program\n{\n    private static ITunesApp iTunes;\n\n    static void Main(string[] args)\n    {\n        // Initialize iTunes application.\n        iTunes = new ITunesApp();\n\n        // Subscribe to the event handler\n        ((iTunesEvents)iTunes).OnPlayerPlayingTrackChangedEvent += \n            new _IiTunesEvents_OnPlayerPlayingTrackChangedEventHandler(iTunes_OnPlayerPlayingTrackChangedEvent);\n\n        Console.WriteLine("Listening for iTunes track changes...");\n        Console.ReadLine();\n    }\n\n    private static void iTunes_OnPlayerPlayingTrackChangedEvent(object iTrack)\n    {\n        try\n        {\n            IITTrack currentTrack = (IITTrack)iTunes.CurrentTrack;\n            if (currentTrack != null)\n            {\n                string artist = currentTrack.Artist ?? "Unknown Artist";\n                string album = currentTrack.Album ?? "Unknown Album";\n                string title = currentTrack.Name ?? "Unknown Title";\n\n                Console.WriteLine($"Now playing: {artist} - {album} - {title}");\n\n                // Run background worker for NowPlaying if needed\n                //if (!NowPlaying.IsBusy)\n                //{\n                //    NowPlaying.RunWorkerAsync();\n                //}\n            }\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine("Error handling track change event: " + ex.Message);\n        }\n    }\n}