using System;\nusing System.IO;\nusing System.Security.Cryptography;\n\npublic class CryptoHelper {\n    public static byte[] Encrypt(byte[] data, byte[] key, byte[] iv) {\n        using (AesCryptoServiceProvider aes = new AesCryptoServiceProvider()) {\n            aes.Key = key;\n            aes.IV = iv;\n\n            ICryptoTransform encryptor = aes.CreateEncryptor(aes.Key, aes.IV);\n\n            using (MemoryStream ms = new MemoryStream()) {\n                using (CryptoStream cs = new CryptoStream(ms, encryptor, CryptoStreamMode.Write)) {\n                    cs.Write(data, 0, data.Length);\n                    cs.FlushFinalBlock();\n                    return ms.ToArray();\n                }\n            }\n        }\n    }\n\n    public static byte[] Decrypt(byte[] encryptedData, byte[] key, byte[] iv) {\n        using (AesCryptoServiceProvider aes = new AesCryptoServiceProvider()) {\n            aes.Key = key;\n            aes.IV = iv;\n\n            ICryptoTransform decryptor = aes.CreateDecryptor(aes.Key, aes.IV);\n\n            using (MemoryStream ms = new MemoryStream(encryptedData)) {\n                using (CryptoStream cs = new CryptoStream(ms, decryptor, CryptoStreamMode.Read)) {\n                    byte[] buffer = new byte[16];\n                    using (MemoryStream output = new MemoryStream()) {\n                        int read;\n                        while ((read = cs.Read(buffer, 0, buffer.Length)) > 0) {\n                            output.Write(buffer, 0, read);\n                        }\n                        return output.ToArray();\n                    }\n                }\n            }\n        }\n    }\n}