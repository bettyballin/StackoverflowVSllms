using System;\nusing System.IO.Pipes;\nusing System.Text;\nusing System.Threading.Tasks;\n\nnamespace AddInCommunication\n{\n    public class NamedPipeClient\n    {\n        private readonly string _pipeName = "MyNamedPipe";\n\n        public async Task ConnectAsync()\n        {\n            try\n            {\n                using (var pipeClient = new NamedPipeClientStream(".", _pipeName, PipeDirection.In))\n                {\n                    await pipeClient.ConnectAsync();\n\n                    var reader = new StreamReader(pipeClient);\n                    string message = await reader.ReadLineAsync();\n                    Console.WriteLine("Received from server: " + message);\n\n                    // Close the connection when done\n                    pipeClient.Close();\n                }\n            }\n            catch (Exception ex)\n            {\n                Console.WriteLine("Failed to connect: " + ex.Message);\n            }\n        }\n    }\n}