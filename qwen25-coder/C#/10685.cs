using System;\nusing System.IO;\nusing System.Net;\nusing System.ServiceProcess;\nusing System.Timers;\n\npublic class FileImporterService : ServiceBase\n{\n    private Timer _timer;\n\n    public FileImporterService()\n    {\n        this.ServiceName = "FileImporterService";\n    }\n\n    protected override void OnStart(string[] args)\n    {\n        // Setup a timer that triggers the Import method at midnight every day.\n        _timer = new Timer(86400000); // 24 hours\n        _timer.Elapsed += (s, e) => ImportFile();\n        _timer.Start();\n\n        // Optionally log start information\n        EventLog.WriteEntry("FileImporterService started successfully.");\n    }\n\n    protected override void OnStop()\n    {\n        // Stop the timer\n        _timer.Stop();\n        _timer.Dispose();\n\n        // Log stop information\n        EventLog.WriteEntry("FileImporterService stopped.");\n    }\n\n    public void ImportFile()\n    {\n        try\n        {\n            // Example FTP download code\n            using (FtpWebRequest request = (FtpWebRequest)WebRequest.Create("ftp://example.com/file.txt"))\n            {\n                request.Credentials = new NetworkCredential("user", "password");\n                request.Method = WebRequestMethods.Ftp.DownloadFile;\n\n                using (Stream response = request.GetResponse().GetResponseStream())\n                using (StreamReader reader = new StreamReader(response))\n                {\n                    string fileContent = reader.ReadToEnd();\n\n                    // Send content to your SQL server here, perhaps via a web service call\n                    SendToSqlServer(fileContent);\n                }\n            }\n        }\n        catch (Exception ex)\n        {\n            EventLog.WriteEntry($"Error during import: {ex.Message}", EventLogEntryType.Error);\n        }\n    }\n\n    private void SendToSqlServer(string fileContent)\n    {\n        // Web service call to send the data to SQL server\n        // This function should be implemented based on your web service API\n    }\n\n    public static void StartImportNow()\n    {\n        using (var controller = new ServiceController("FileImporterService"))\n        {\n            if (controller.Status == ServiceControllerStatus.Running)\n            {\n                var methodInfo = typeof(ServiceBase).GetMethod("OnCustomCommand", BindingFlags.Instance | BindingFlags.NonPublic);\n                if (methodInfo != null)\n                    methodInfo.Invoke(new FileImporterService(), new object[] { 128 });\n            }\n        }\n    }\n\n    protected override void OnCustomCommand(int command)\n    {\n        if (command == 128) // Custom command to initiate import immediately\n        {\n            ImportFile();\n            EventLog.WriteEntry("Manual import triggered successfully.");\n        }\n        base.OnCustomCommand(command);\n    }\n}\n\n// To manually start the import process, call FileImporterService.StartImportNow() from a separate application or script.