using System;\nusing System.DirectoryServices;\n\nprivate static void UpdateAppPoolIdentity(string serverName, string appPoolName, string username, string password)\n{\n    // metabasePath is of the form "IIS://<servername>/W3SVC/AppPools"\n    // for example "IIS://localhost/W3SVC/AppPools" \n    // appPoolName is of the form "<name>", for example, "MyAppPool"\n    string metabasePath = string.Format("IIS://{0}/W3SVC/AppPools/{1}", serverName, appPoolName);\n    Console.WriteLine("\nUpdating application pool {0} with new identity:", appPoolName);\n\n    try\n    {\n        DirectoryEntry appPool = new DirectoryEntry(metabasePath);\n\n        // Set the ProcessModel to use a specific user account\n        appPool.Properties["WDUserName"].Value = username;\n        appPool.Properties["WDPassWord"].Value = password;\n\n        // Optionally set other properties like identityType\n        appPool.Properties["IdentityType"].Value = 3; // IdentityType SpecificUser\n\n        appPool.CommitChanges();\n        Console.WriteLine("AppPool identity updated.");\n    }\n    catch (Exception ex)\n    {\n        Console.WriteLine("Failed in UpdateAppPoolIdentity with the following exception: \n{0}", ex.Message);\n    }\n}