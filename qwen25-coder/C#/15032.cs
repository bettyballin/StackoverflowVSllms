using System;\nusing System.IO.Ports;\n\nclass Program\n{\n    static void Main()\n    {\n        // Setup the serial port\n        SerialPort mySerialPort = new SerialPort("COM1");\n        \n        // Configure the serial port settings as required by your hardware\n        mySerialPort.BaudRate = 9600;\n        mySerialPort.Parity = Parity.None;\n        mySerialPort.StopBits = StopBits.One;\n        mySerialPort.DataBits = 8;\n\n        // Specify a read timeout (optional)\n        mySerialPort.ReadTimeout = 500;\n        \n        try\n        {\n            mySerialPort.Open();\n            \n            // Read data from the serial port and display it to the console\n            string message;\n            while ((message = mySerialPort.ReadLine()) != null)\n            {\n                Console.WriteLine("Message received: " + message);\n            }\n        }\n        catch (TimeoutException) when (!mySerialPort.IsOpen)\n        {\n            Console.WriteLine("Error opening the port. Check if it's in use or try another port.");\n        }\n        catch (InvalidOperationException)\n        {\n            Console.WriteLine("The serial port is already closed or has been disposed.");\n        }\n        finally\n        {\n            // Close and dispose of the serial port\n            mySerialPort.Close();\n            mySerialPort.Dispose();\n        }\n    }\n}