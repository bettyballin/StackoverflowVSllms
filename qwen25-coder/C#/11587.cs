using System.Security.Cryptography;\nusing System.Reflection;\n\npublic byte[] SignAssembly(string assemblyPath, RSACryptoServiceProvider publicKey)\n{\n    using (var assembly = Assembly.LoadFrom(assemblyPath))\n    {\n        var assemblyName = assembly.GetName();\n        var nameBytes = assemblyName.GetPublicKeyToken();\n\n        using (var sha256 = SHA256.Create())\n        {\n            byte[] hash = sha256.ComputeHash(File.ReadAllBytes(assemblyPath));\n            return publicKey.SignData(hash, HashAlgorithmName.SHA256, RSASignaturePadding.Pkcs1);\n        }\n    }\n}