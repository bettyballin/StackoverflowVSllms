using System;\nusing System.Net.Sockets;\nusing System.Text;\nusing System.Threading;\n\nclass Program\n{\n    static TcpClient client;\n    static NetworkStream stream;\n    static bool isRunning = true;\n    \n    static void Main(string[] args)\n    {\n        // Connect to server, setup TCP connection.\n        // Replace "serverIp" and "portNumber" with your actual values.\n        client = new TcpClient("serverIp", portNumber);\n        stream = client.GetStream();\n\n        Thread thread = new Thread(ListenForMessages);\n        thread.Start();\n\n        while (isRunning)\n        {\n            string messageToSend = Console.ReadLine();\n            byte[] data = Encoding.ASCII.GetBytes(messageToSend + Environment.NewLine);\n            stream.Write(data, 0, data.Length);\n\n            // Optionally handle the "exit" command\n            if (messageToSend.ToLower() == "exit")\n                isRunning = false;\n        }\n\n        client.Close();\n    }\n\n    static void ListenForMessages()\n    {\n        while (isRunning)\n        {\n            byte[] buffer = new byte[1024];\n            int bytes = stream.Read(buffer, 0, buffer.Length);\n            string receivedMessage = Encoding.ASCII.GetString(buffer, 0, bytes);\n\n            // Get current cursor position to return there after writing the message\n            int currentCursorTop = Console.CursorTop;\n            int currentCursorLeft = Console.CursorLeft;\n\n            // Move to a new line and print the server's message\n            Console.WriteLine(receivedMessage.TrimEnd());\n\n            // Return cursor to previous position\n            Console.SetCursorPosition(currentCursorLeft, currentCursorTop);\n\n            // Clear the current cursor line from its last position (in case it was longer)\n            Console.Write(new string(' ', Console.WindowWidth - Console.CursorLeft));\n\n            // Return cursor to end of input line\n            Console.SetCursorPosition(Console.CursorLeft + receivedMessage.Length, Console.CursorTop);\n        }\n    }\n}