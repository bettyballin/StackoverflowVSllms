using System;\nusing System.Linq;\nusing System.Net.Dns;\nusing System.Net.Sockets;\n\npublic class DNSServiceRecordManager\n{\n    public static List<IPAddress> GetServiceEndpoints(string serviceName)\n    {\n        var records = Dns.GetTxtRecords(serviceName);\n        List<IPAddress> endpoints = new List<IPAddress>();\n\n        foreach (var record in records.OrderBy(rec => rec.Preference))\n        {\n            try\n            {\n                var ipAddresses = Dns.GetHostEntry(record.Exchange).AddressList;\n                endpoints.AddRange(ipAddresses);\n            }\n            catch (Exception ex)\n            {\n                Console.WriteLine($"Failed to resolve {record.Exchange}. Reason: {ex.Message}");\n            }\n        }\n\n        return endpoints.Distinct().ToList();\n    }\n}