foreach (SearchResult subOU in results)\n{\n   ResultPropertyValueCollection subColl = subOU.Properties["distinguishedname"];\n   string subPath = subColl[0].ToString();\n   DirectoryEntry subEntry = new DirectoryEntry("LDAP://" + subPath);\n   \n   // Access the streetaddress of the OU with null check\n   string ouStreetAddress = subEntry.Properties["streetaddress"].Value != null ?\n       subEntry.Properties["streetaddress"].Value.ToString() : string.Empty;\n\n   DirectorySearcher userSearcher = new DirectorySearcher(subEntry);\n   userSearcher.SearchScope = SearchScope.OneLevel;\n   userSearcher.Filter = "(objectClass=user)";\n   \n   foreach (SearchResult user in userSearcher.FindAll())\n   {\n      ResultPropertyValueCollection userColl = user.Properties["distinguishedname"];\n      string userPath = userColl[0].ToString();\n      DirectoryEntry userEntry = new DirectoryEntry("LDAP://" + userPath);\n      PropertyCollection associateProperties = userEntry.Properties;\n\n      string streetAddress = string.Empty;\n      if (associateProperties["streetaddress"].Count > 0 && associateProperties["streetaddress"][0] != null)\n      {\n         streetAddress = associateProperties["streetaddress"][0].ToString();\n      }\n      else\n      {\n         streetAddress = ouStreetAddress; // Use the address from the OU if user's is not set\n      }\n\n      // Continue processing with the streetAddress variable...\n   }\n}