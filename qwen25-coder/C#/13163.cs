using System;\nusing OpenQA.Selenium;\nusing OpenQA.Selenium.Chrome;\nusing System.Drawing.Imaging;\nusing System.IO;\nusing System.Net.Mail;\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        // Set up Chrome driver (Make sure to have the correct version of chromedriver executable in your path)\n        var options = new ChromeOptions();\n        options.AddArgument("--headless");  // Run in headless mode if you don't need GUI rendering\n\n        using (var driver = new ChromeDriver(options))\n        {\n            try\n            {\n                // Go to the specified URL\n                string url = "https://example.com";  // Replace with your target URL\n                driver.Navigate().GoToUrl(url);\n\n                // Perform any action you need, e.g., clicking a button by its name or ID\n                IWebElement element = driver.FindElement(By.Id("buttonId"));  // Adjust selector as needed\n                element.Click();\n\n                // Take screenshot\n                string fileName = "screenshot.png";\n                var screenshot = ((ITakesScreenshot)driver).GetScreenshot();\n                screenshot.SaveAsFile(fileName, ImageFormat.Png);\n\n                // Send email with the screenshot attached\n                SendEmailWithAttachment("your-email@example.com", "recipient@example.com", "Screenshot Attached", "Please find attached the requested screenshot.", fileName);\n            }\n            catch (Exception ex)\n            {\n                Console.WriteLine($"An error occurred: {ex.Message}");\n            }\n        }\n    }\n\n    static void SendEmailWithAttachment(string fromAddress, string toAddress, string subject, string body, string attachmentPath)\n    {\n        using (var smtpClient = new SmtpClient("smtp.example.com"))\n        {\n            smtpClient.Port = 587;\n            smtpClient.Credentials = new System.Net.NetworkCredential("your-email@example.com", "password");  // Replace with your email and password\n            smtpClient.EnableSsl = true;\n\n            using (var mailMessage = new MailMessage(fromAddress, toAddress))\n            {\n                mailMessage.Subject = subject;\n                mailMessage.Body = body;\n                mailMessage.Attachments.Add(new Attachment(attachmentPath));\n\n                smtpClient.Send(mailMessage);\n            }\n        }\n\n        Console.WriteLine("Email sent successfully.");\n    }\n}