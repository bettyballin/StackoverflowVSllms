using System.Data;\nusing System.Data.SqlClient;\n\npublic DataTable GetResultColumnsFromStoredProcedure(string connectionString, string spName)\n{\n    using (SqlConnection conn = new SqlConnection(connectionString))\n    {\n        conn.Open();\n        \n        using SqlCommand cmd = new SqlCommand("sp_describe_first_result_set", conn);\n        cmd.CommandType = CommandType.StoredProcedure;\n        cmd.Parameters.AddWithValue("@tsql", "EXEC " + spName);\n\n        SqlDataAdapter da = new SqlDataAdapter(cmd);\n        DataTable dtColumns = new DataTable();\n        da.Fill(dtColumns);\n\n        return dtColumns;\n    }\n}