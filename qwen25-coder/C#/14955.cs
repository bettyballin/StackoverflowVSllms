using OpenQA.Selenium;\nusing OpenQA.Selenium.Appium.Windows;\n\nnamespace LegacyAppAutoTest\n{\n    class Program\n    {\n        static WindowsDriver<WindowsElement> session;\n\n        static void Main(string[] args)\n        {\n            // Setup the application path or use AppID for installed applications.\n            var appCapabilities = new DesiredCapabilities();\n            appCapabilities.SetCapability("app", @"C:\Path\To\YourApp.exe");\n            \n            // Start the WinAppDriver session\n            session = new WindowsDriver<WindowsElement>(new Uri("http://127.0.0.1:4723"), appCapabilities);\n            \n            // Wait for main window to load, you may want to use WebDriverWait here for production tests.\n            System.Threading.Thread.Sleep(5000);\n\n            try\n            {\n                // Example action (assuming an element with AutomationID "Button1" exists).\n                var button = session.FindElementByAccessibilityId("Button1");\n                button.Click();\n\n                // Add more actions here, like asserting page titles or validating text.\n            }\n            finally\n            {\n                session.Close();\n                session.Quit();\n            }\n        }\n    }\n}