public class SecureSiteMapProvider : StaticSiteMapProvider\n{\n    public override bool IsAccessibleToUser(HttpContext context, SiteMapNode node)\n    {\n        if (node == null)\n            throw new ArgumentNullException("node");\n\n        // Check roles to see if the user has access.\n        string[] roles = node["roles"];\n\n        if (string.IsNullOrEmpty(roles))\n            return true;  // No role restriction.\n\n        if ((context.User != null) && context.User.Identity.IsAuthenticated)\n        {\n            foreach (string roleName in SplitString(roles, ','))\n                if (context.User.IsInRole(roleName))\n                    return true;\n        }\n\n        return false;\n    }\n}