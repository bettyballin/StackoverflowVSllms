using System;\nusing System.Runtime.InteropServices;\nusing System.Text;\n\npublic class DelphiInterop\n{\n    [DllImport(@"C:\\Test\\DelphiTest.dll", CharSet = CharSet.Ansi, CallingConvention = CallingConvention.StdCall)]\n    public static extern bool StringTest(out IntPtr stringOut);\n\n    public static string CallStringTest()\n    {\n        IntPtr pStr = IntPtr.Zero;\n        try\n        {\n            if (!StringTest(out pStr))\n                return null;\n\n            // Convert the pointer to a managed string.\n            string result = Marshal.PtrToStringAnsi(pStr);\n            return result;\n        }\n        finally\n        {\n            // Free the memory allocated by the Delphi code.\n            if (pStr != IntPtr.Zero)\n            {\n                Marshal.FreeHGlobal(pStr);\n            }\n        }\n    }\n}