// Example of an event handler in C# that you might use in an VSTO Add-In for testing sent mail properties\n   private void ThisAddIn_Senders_Inspection_Mail(object item)\n   {\n       Outlook.MailItem mail = null;\n       try\n       {\n           if (item is Outlook.MailItem)\n           {\n               mail = item as Outlook.MailItem;\n\n               // Check simple mail properties here\n               Debug.WriteLine("Subject: " + mail.Subject);\n               Debug.WriteLine("Recipients: " + mail.Recipients.Count);\n\n               if (!mail.Subject.Contains("Test"))\n               {\n                   throw new Exception("Email subject must contain 'Test'");\n               }\n           }\n       }\n       catch (Exception ex)\n       {\n           // Handle exceptions or log here\n           Console.WriteLine(ex.Message);\n       }\n       finally\n       {\n           if (mail != null) { Marshal.ReleaseComObject(mail); }\n       }\n   }