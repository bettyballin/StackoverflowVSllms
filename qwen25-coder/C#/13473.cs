using System;\nusing System.IO;\nusing System.Xml;\nusing System.Xml.Xsl;\n\npublic void Save() {\n    // Create a new XML file if there's no root element\n    if(xDocument.DocumentElement == null) {\n        xDocument = new XmlDocument();\n        xDocument.LoadXml("<?xml version=\"1.0\" encoding=\"utf-8\" ?>" +\n            "<" + XmlRootElement + "></" + XmlRootElement + ">");\n    }\n\n    // Define retry logic.\n    int maxRetries = 5;\n    int delayInMilliseconds = 100;\n\n    for (int attempt = 0; attempt < maxRetries; attempt++) {\n        try {\n            // Open the file stream with exclusive access\n            using (FileStream fs = new FileStream(XmlFilePath, FileMode.Create, FileAccess.Write, FileShare.None)) {\n                XmlWriter xWriter = XmlWriter.Create(fs, new XmlWriterSettings() {\n                    Indent = true,\n                    IndentChars = "\t"\n                });\n\n                // Sort the XML file using the XSL stylesheet and save it\n                xslTransform.Transform(xDocument, xWriter);\n\n                // Close the writer, flushing and releasing buffers\n                xWriter.Flush();\n                xWriter.Close();\n            }\n\n            // Success: exit retry loop\n            break;\n        } catch (IOException ex) {\n            if (attempt == maxRetries - 1) throw; // Re-throw after last attempt\n            System.Threading.Thread.Sleep(delayInMilliseconds);\n        }\n    }\n}