using System;\nusing System.Net.Sockets;\n\npublic class Program\n{\n    public static void Main()\n    {\n        int openPort = GetNextOpenPort();\n        Console.WriteLine($"Next open TCP port: {openPort}");\n    }\n\n    private static int GetNextOpenPort()\n    {\n        using (var socket = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp))\n        {\n            // Bind to 0 means let the system choose an available port\n            socket.Bind(new System.Net.IPEndPoint(System.Net.IPAddress.Any, 0));\n            return ((System.Net.IPEndPoint)socket.LocalEndPoint).Port;\n        }\n    }\n}