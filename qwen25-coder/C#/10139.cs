using System;\nusing System.IO.Ports;\n\nclass SerialPortExample\n{\n    static void Main()\n    {\n        using (SerialPort serialPort = new SerialPort("COM3"))\n        {\n            serialPort.BaudRate = 9600;\n            serialPort.Parity = Parity.None;\n            serialPort.StopBits = StopBits.One;\n            serialPort.DataBits = 8;\n            serialPort.Handshake = Handshake.None;\n\n            // Event handler for receiving data\n            serialPort.DataReceived += new SerialDataReceivedEventHandler(SerialPort_DataReceived);\n\n            try\n            {\n                serialPort.Open();\n                Console.WriteLine("Serial port opened.");\n\n                // Send data to the serial port\n                string messageToSend = "Hello";\n                serialPort.Write(messageToSend);\n                Console.WriteLine($"Sent: {messageToSend}");\n\n                // Keep the application running until a key is pressed\n                Console.ReadLine();\n\n            }\n            catch (UnauthorizedAccessException) when (!serialPort.IsOpen)\n            {\n                Console.WriteLine("The port is in use or you do not have the required permissions.");\n            }\n        }\n    }\n\n    static void SerialPort_DataReceived(object sender, SerialDataReceivedEventArgs e)\n    {\n        SerialPort serialPort = (SerialPort)sender;\n        string dataRead = serialPort.ReadExisting();\n        Console.WriteLine($"Received: {dataRead}");\n    }\n}