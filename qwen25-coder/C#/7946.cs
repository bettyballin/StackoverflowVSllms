using System;\nusing HtmlAgilityPack;\n\npublic class HtmlCleaner\n{\n    public static string CleanMicrosoftWordHtml(string html)\n    {\n        var document = new HtmlDocument();\n        document.LoadHtml(html);\n\n        // Remove all Microsoft Word specific namespaces and tags\n        foreach (var node in document.DocumentNode.SelectNodes("//*"))\n        {\n            if (node.HasAttributes)\n            {\n                for (int i = node.Attributes.Count - 1; i >= 0; i--)\n                {\n                    HtmlAttribute attr = node.Attributes[i];\n                    // Remove all attributes with namespaces\n                    if (!string.IsNullOrEmpty(attr.Name) && attr.Name.Contains(':'))\n                    {\n                        node.Attributes.Remove(attr);\n                    }\n                }\n            }\n\n            switch (node.Name)\n            {\n                case "o:p":\n                case "v:shapetype":\n                case "v:imagedata":\n                case "v:shape":\n                case "w:*": // Remove all w:namespace elements\n                    node.Remove();\n                    break;\n            }\n        }\n\n        return document.DocumentNode.OuterHtml;\n    }\n\n    public static void Main()\n    {\n        string wordHtml = @"<p class=MsoNormal>This is a <b style='mso-bidi-font-weight:normal'>test</b> document.<o:p></o:p></p>";\n        string cleanHtml = CleanMicrosoftWordHtml(wordHtml);\n        Console.WriteLine(cleanHtml);\n    }\n}