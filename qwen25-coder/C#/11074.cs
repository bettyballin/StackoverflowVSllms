using System;\nusing System.Data;\nusing System.IO;\nusing OfficeOpenXml;\nusing System.Web.UI;\n\npublic partial class FileUploadPage : Page\n{\n    protected void Page_Load(object sender, EventArgs e)\n    {\n        // Ensure the file upload control allows multiple files to be selected\n        FileUploadControl.Attributes.Add("multiple", "multiple");\n    }\n\n    protected void UploadButton_Click(object sender, EventArgs e)\n    {\n        if (FileUploadControl.HasFiles && ExcelFileUpload.HasFile)\n        {\n            var excelFilePath = Server.MapPath(ExcelFileUpload.FileName);\n            ExcelFileUpload.SaveAs(excelFilePath);\n\n            using (var package = new ExcelPackage(new FileInfo(excelFilePath)))\n            {\n                var worksheet = package.Workbook.Worksheets[0];\n                int rowCount = worksheet.Dimension.Rows;\n\n                for (int i = 1; i <= rowCount; i++)\n                {\n                    if (FileUploadControl.PostedFiles.Count > 0)\n                    {\n                        HttpPostedFile postedFile = FileUploadControl.PostedFiles[i - 1];\n\n                        // Read new file name from Excel\n                        string newFileName = worksheet.Cells[i, 1].Value?.ToString();\n                        string savePath = Server.MapPath("~/UploadedFiles/" + newFileName);\n\n                        // Save the uploaded file with the new file name\n                        postedFile.SaveAs(savePath);\n                    }\n                }\n            }\n\n            Response.Write("All files have been uploaded successfully.");\n        }\n        else\n        {\n            Response.Write("No files selected or Excel file not provided.");\n        }\n    }\n}