using System;\nusing System.Web;\n\npublic class RewriteModule : IHttpModule\n{\n    public void Init(HttpApplication context)\n    {\n        context.BeginRequest += new EventHandler(OnBeginRequest);\n    }\n\n    public void Dispose() { }\n\n    private void OnBeginRequest(object sender, EventArgs e)\n    {\n        HttpApplication app = (HttpApplication)sender;\n        HttpContext ctx = app.Context;\n        string path = ctx.Request.AppRelativeCurrentExecutionFilePath;\n\n        // Check if it matches the pattern and is not a file or another .aspx page\n        if (!Path.HasExtension(path) && path != "/" && !path.EndsWith(".aspx", StringComparison.OrdinalIgnoreCase))\n        {\n            string nick = path.TrimStart('~', '/');\n            \n            ctx.Items["originalPath"] = path;\n            ctx.RewritePath("profile.aspx", null, $"nick={nick}", false);\n        }\n    }\n}