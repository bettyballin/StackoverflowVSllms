using EzAPI;\n\nnamespace SsisPackageGenerator\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            // Create a new Package object\n            Package pkg = new Package();\n\n            // Add an OLEDB connection manager\n            ConnectionManagerCM connMgr = new ConnectionManagerCM(\n                "Data Source=myServerAddress;Initial Catalog=myDataBase;User Id=myUsername;Password=myPassword;", \n                false);\n\n            // Add a Data Flow Task to the package\n            Executable dataFlowTask = pkg.Executables.Add("STOCK:PipelineTask");\n            TaskHost taskHostDataFlow = dataFlowTask as TaskHost;\n\n            // Create the OLEDB source component in the Data Flow\n            MainPipe mainPipe = taskHostDataFlow.InnerObject as MainPipe;\n            IDTSComponentMetaData100 oleDbSource = mainPipe.ComponentMetaDataCollection.New();\n            CManagedComponentWrapper.Instantiate("DTSAdapter.OleDbSource", oleDbSource);\n\n            // Set properties on the OLEDB source, such as the connection manager and SQL command\n\n            // Save the package to disk\n            pkg.SaveToXml("MyGeneratedPackage.dtsx", null);\n        }\n    }\n}