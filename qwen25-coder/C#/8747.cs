using System;\nusing System.Linq;\nusing System.Runtime.InteropServices;\n\nclass ClipboardHelper\n{\n    [DllImport("user32.dll", SetLastError = true)]\n    private static extern uint OpenClipboard(IntPtr hWndNewOwner);\n\n    [DllImport("user32.dll")]\n    private static extern bool CloseClipboard();\n\n    [DllImport("user32.dll", SetLastError = true)]\n    private static extern IntPtr SetClipboardData(uint uFormat, IntPtr data);\n\n    [DllImport("kernel32.dll", SetLastError = true)]\n    private static extern IntPtr GlobalAlloc(uint flags, UIntPtr dwBytes);\n\n    [DllImport("kernel32.dll", SetLastError = true)]\n    private static extern IntPtr GlobalLock(IntPtr hMem);\n\n    [DllImport("kernel32.dll")]\n    private static extern bool GlobalUnlock(IntPtr hMem);\n\n    const uint CF_EMBEDSOURCE = 14; // Clipboard format for Embed Source\n    const uint GMEM_MOVEABLE = 0x0002;\n    \n    public static void SetEmbedSourceData(byte[] data)\n    {\n        try\n        {\n            if (OpenClipboard(IntPtr.Zero) == 0)\n                throw new System.ComponentModel.Win32Exception(Marshal.GetLastWin32Error());\n\n            IntPtr memHandle = GlobalAlloc(GMEM_MOVEABLE, (UIntPtr)data.Length);\n            if (memHandle == IntPtr.Zero)\n                throw new System.ComponentModel.Win32Exception(Marshal.GetLastWin32Error());\n\n            IntPtr lockedData = GlobalLock(memHandle);\n            if (lockedData == IntPtr.Zero)\n                throw new System.ComponentModel.Win32Exception(Marshal.GetLastWin32Error());\n            \n            Marshal.Copy(data, 0, lockedData, data.Length);\n            GlobalUnlock(memHandle);\n\n            if (SetClipboardData(CF_EMBEDSOURCE, memHandle) == IntPtr.Zero)\n                throw new System.ComponentModel.Win32Exception(Marshal.GetLastWin32Error());\n\n        }\n        finally\n        {\n            CloseClipboard();\n        }\n    }\n\n    static void Main(string[] args)\n    {\n        // Example usage:\n        byte[] embedSourceData = File.ReadAllBytes("path_to_your_clipboard_data_file.bin");\n        SetEmbedSourceData(embedSourceData);\n        Console.WriteLine("Embedded source data set to clipboard.");\n    }\n}