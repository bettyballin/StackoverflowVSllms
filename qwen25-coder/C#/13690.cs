using System;\nusing System.Runtime.InteropServices;\n\nclass Program\n{\n    [DllImport("wininet.dll", SetLastError = true)]\n    private static extern bool InternetSetOption(IntPtr hInternet, int dwOption, IntPtr lpBuffer, int dwBufferLength);\n\n    private const int INTERNET_OPTION_SETTINGS_CHANGED = 39;\n    private const int INTERNET_OPTION_REFRESH = 37;\n\n    public static void SetProxy(string proxy)\n    {\n        // Set the proxy server\n        Environment.SetEnvironmentVariable("HTTP_PROXY", proxy, EnvironmentVariableTarget.User);\n        Environment.SetEnvironmentVariable("HTTPS_PROXY", proxy, EnvironmentVariableTarget.User);\n\n        // Notify system of settings change\n        InternetSetOption(IntPtr.Zero, INTERNET_OPTION_SETTINGS_CHANGED, IntPtr.Zero, 0);\n        InternetSetOption(IntPtr.Zero, INTERNET_OPTION_REFRESH, IntPtr.Zero, 0);\n    }\n\n    static void Main()\n    {\n        string proxyAddress = "127.0.0.1:8888";\n        SetProxy(proxyAddress);\n        Console.WriteLine("Proxy set to: " + proxyAddress);\n    }\n}