using System;\nusing System.DirectoryServices;\n\nclass Program\n{\n    static void Main()\n    {\n        DirectoryEntry user = new DirectoryEntry("LDAP://cn=myuser,cn=Users,dc=example,dc=com");\n        \n        foreach (string path in user.Properties["memberOf"])\n        {\n            string cn = GetCommonName(path);\n            Console.WriteLine(cn);\n        }\n    }\n\n    static string GetCommonName(string distinguishedName)\n    {\n        // Split the DN by commas\n        string[] parts = distinguishedName.Split(',');\n        // Find the part that starts with "CN="\n        foreach (string part in parts)\n        {\n            if (part.Trim().StartsWith("CN="))\n            {\n                // Return just the value after "CN="\n                return part.Substring(3);\n            }\n        }\n        return null; // Or throw an exception, or handle as appropriate\n    }\n}