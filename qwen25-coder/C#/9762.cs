using System;\nusing System.Management.Automation;\nusing System.Management.Automation.Runspaces;\n\nclass Program\n{\n    static void Main()\n    {\n        // Create a runspace configuration\n        RunspaceConfiguration rsConfig = RunspaceConfiguration.Create();\n\n        // Add the PowerShell snap-in for WebAdministration (IIS)\n        PSSnapInException ex;\n        rsConfig.AddPSSnapIn("WebAdministration", out ex);\n\n        if (ex != null)\n        {\n            Console.WriteLine($"Failed to add WebAdministration snap-in: {ex.Message}");\n            return;\n        }\n\n        // Create a runspace\n        Runspace myRunSpace = RunspaceFactory.CreateRunspace(rsConfig);\n        myRunSpace.Open();\n\n        // Prepare the PowerShell command\n        Pipeline pipeline = myRunSpace.CreatePipeline();\n        string scriptText = "Get-Item 'IIS:\\' | Select-Object VersionInformation";\n        Command myCommand = new Command(scriptText);\n\n        pipeline.Commands.Add(myCommand);\n\n        // Execute the command and obtain the results\n        ICollection<PSObject> commandResults = pipeline.Invoke();\n\n        foreach (var item in commandResults)\n        {\n            Console.WriteLine("IIS Version: " + item.Members["VersionInformation"].Value);\n        }\n\n        myRunSpace.Close();\n    }\n}