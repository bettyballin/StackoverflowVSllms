using System;\nusing System.Security.Cryptography;\nusing System.Text;\n\npublic class TokenEncryptor\n{\n    public byte[] Encrypt(string plainText)\n    {\n        if (string.IsNullOrEmpty(plainText))\n            throw new ArgumentNullException(nameof(plainText));\n\n        var data = Encoding.UTF8.GetBytes(plainText);\n        // Using DataProtectionScope.CurrentUser to encrypt with the current user's key\n        var encryptedData = ProtectedData.Protect(data, null, DataProtectionScope.CurrentUser);\n\n        return encryptedData;\n    }\n\n    public string Decrypt(byte[] encryptedData)\n    {\n        if (encryptedData == null || encryptedData.Length <= 0)\n            throw new ArgumentNullException(nameof(encryptedData));\n\n        try\n        {\n            // Using the same scope as used for encryption to decrypt with the current user's key\n            var decryptedData = ProtectedData.Unprotect(encryptedData, null, DataProtectionScope.CurrentUser);\n            return Encoding.UTF8.GetString(decryptedData);\n        }\n        catch (CryptographicException)\n        {\n            throw new InvalidOperationException("The decryption failed. Ensure you are using the same account as used for encryption.");\n        }\n    }\n}