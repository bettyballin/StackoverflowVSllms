using System;\nusing System.IO;\n\npublic class ImageStorageService {\n    private string BasePath { get; } = @"C:\images";\n\n    public void SaveImage(Stream fileStream, string fileName, int userId) {\n        // Create a unique name using GUID or hash function\n        var uniqueFileName = $"{Guid.NewGuid()}{Path.GetExtension(fileName)}";\n        var directory = Path.Combine(BasePath, userId.ToString());\n        \n        if (!Directory.Exists(directory)) {\n            Directory.CreateDirectory(directory);\n        }\n\n        var filePath = Path.Combine(directory, uniqueFileName);\n\n        using (var fileStreamDest = new FileStream(filePath, FileMode.Create)) {\n            fileStream.CopyTo(fileStreamDest);\n        }\n    }\n}