using System;\nusing System.Data.SqlClient;\n\nclass Program\n{\n    static void Main()\n    {\n        string connectionString = "YourConnectionStringHere";\n        int batchSize = 1000; // Adjust this based on your performance testing\n\n        using (SqlConnection connection = new SqlConnection(connectionString))\n        {\n            connection.Open();\n\n            using (SqlCommand command = new SqlCommand())\n            {\n                command.Connection = connection;\n                command.CommandType = System.Data.CommandType.Text;\n\n                for (int startRow = 0; true; startRow += batchSize)\n                {\n                    command.CommandText =\n                        $"INSERT INTO TableName (Field1, Field2, Field3) " +\n                        $"SELECT TOP {batchSize} Field1, Field2, Field3 FROM TableName2 " +\n                        $"ORDER BY SomeColumn OFFSET {startRow} ROW FETCH NEXT {batchSize} ROWS ONLY";\n\n                    int rowsAffected = command.ExecuteNonQuery();\n\n                    if (rowsAffected < batchSize)\n                    {\n                        break; // Exit loop when no more rows are returned\n                    }\n                }\n            }\n\n            connection.Close();\n        }\n    }\n}