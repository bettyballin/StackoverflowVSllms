using System;\nusing MsgKit;\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        string msgFilePath = @"path\to\your\file.msg";\n        \n        try\n        {\n            var message = new Storage.Message(msgFilePath);\n            \n            Console.WriteLine("From: " + message.Sender.EmailAddress);\n            foreach (var recipient in message.Recipients)\n            {\n                switch (recipient.Type)\n                {\n                    case RecipientType.To:\n                        Console.Write("To: ");\n                        break;\n                    case RecipientType.CC:\n                        Console.Write("CC: ");\n                        break;\n                    case RecipientType.BCC:\n                        Console.Write("BCC: ");\n                        break;\n                }\n                Console.WriteLine(recipient.EmailAddress);\n            }\n\n            Console.WriteLine("Sender Name: " + message.Sender.Name);\n            Console.WriteLine("Sent On: " + message.DateSent);\n            Console.WriteLine("Received On: " + message.DateReceived);\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine($"Error reading .msg file: {ex.Message}");\n        }\n    }\n}