using System.Windows.Forms.Integration;\nusing System.Windows.Controls;\nusing System.Runtime.InteropServices;\n\npublic void PrintWebBrowser(Window parent)\n{\n    var webBrowser = new WebBrowser();\n    // Assuming webBrowser is already navigated to the desired content\n\n    IOleCommandTarget commandTarget = (IOleCommandTarget)webBrowser.Document;\n    Guid CGID_MSHTML = new Guid("D30C1F75-D92B-4AED-8DB5-CC6F8F2E95AF");\n    object o = true;\n\n    // Show print dialog before printing to ensure it's modal\n    var printDialog = new PrintDialog();\n    if (printDialog.ShowDialog() == true)\n    {\n        commandTarget.Exec(ref CGID_MSHTML, 6, 0, ref o, IntPtr.Zero);\n    }\n}\n\n[ComImport,\n Guid("b722bcc5-4e68-101b-a2bc-00aa00404770"),\n InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]\npublic interface IOleCommandTarget\n{\n    [PreserveSig]\n    int QueryStatus(ref Guid pguidCmdGroup, uint cCmds, OLECMD prgCmds,\n        IntPtr pCmdText);\n\n    [PreserveSig]\n    int Exec(ref Guid pguidCmdGroup, uint nCmdID, uint nCmdexecopt,\n        ref object pvaIn, IntPtr pvaOut);\n}\n\n[StructLayout(LayoutKind.Sequential)]\npublic struct OLECMD\n{\n    public uint cmdID;\n    public uint cmdf;\n}