using System;\nusing System.Management;\n\nclass Program\n{\n    static void Main()\n    {\n        string remoteComputer = "remote_computer_name";\n        string adminUsername = "admin_username";\n        string adminPassword = "admin_password";\n        string sharePath = @"C:\path\to\folder"; // Path of the folder to be shared\n        string shareName = "NewShare";             // Name of the new network share\n\n        try\n        {\n            ConnectionOptions connection = new ConnectionOptions\n            {\n                Username = adminUsername,\n                Password = adminPassword,\n                Authentication = AuthenticationLevel.PacketPrivacy\n            };\n\n            ManagementScope scope = new ManagementScope($"\\\\{remoteComputer}\\root\\cimv2", connection);\n            scope.Connect();\n\n            ManagementClass classInstance = new ManagementClass(scope, new ManagementPath("Win32_Share"), null);\n\n            ManagementBaseObject inParams = classInstance.GetMethodParameters("Create");\n            inParams["Description"] = "Share created via WMI";\n            inParams["Name"] = shareName;\n            inParams["Path"] = sharePath;\n            inParams["Type"] = 0x0; // Disk Drive\n\n            ManagementBaseObject outParams = classInstance.InvokeMethod("Create", inParams, null);\n\n            Console.WriteLine($"Return code: {outParams["ReturnValue"]}");\n        }\n        catch (Exception e)\n        {\n            Console.WriteLine($"An error occurred: {e.Message}");\n        }\n    }\n}