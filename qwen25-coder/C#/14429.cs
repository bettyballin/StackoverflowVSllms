using System;\nusing System.IO.Ports;\nusing System.ServiceProcess;\n\npublic class DeviceControlService : ServiceBase\n{\n    SerialPort _deviceSerialPort;\n\n    public DeviceControlService()\n    {\n        this.ServiceName = "DeviceControlService";\n        CanStop = true;\n        CanPauseAndContinue = false;\n        AutoLog = true;\n    }\n\n    protected override void OnStart(string[] args)\n    {\n        // Initialize and open the serial port to communicate with your device\n        _deviceSerialPort = new SerialPort("COM1", 9600);\n        _deviceSerialPort.Open();\n        \n        // Additional setup can go here, such as initializing other components or starting timers/task schedulers.\n    }\n\n    protected override void OnStop()\n    {\n        // Close and dispose the serial port\n        if (_deviceSerialPort.IsOpen)\n            _deviceSerialPort.Close();\n\n        _deviceSerialPort.Dispose();\n    }\n\n    public static void Main(string[] args)\n    {\n        ServiceBase.Run(new DeviceControlService());\n    }\n}