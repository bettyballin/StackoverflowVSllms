using System;\nusing System.DirectoryServices;\n\npublic bool ValidateAndHandleExpiredPassword(string userName, string oldPassword)\n{\n    DirectoryEntry de = new DirectoryEntry($"LDAP://{yourDomainController}", $"{userName}@{yourDomain}", oldPassword);\n    try\n    {\n        object obj = de.NativeObject; // Attempt to bind with the provided password.\n        if (obj != null) return false; // If bind succeeds, the password is not expired.\n    }\n    catch (DirectoryServicesCOMException ex)\n    {\n        int errorCode = ex.ExtendedErrorCode;\n        switch (errorCode)\n        {\n            case -2147016685: // 0x8009030A - ERROR_PASSWORD_MUST_CHANGE\n                return true; // The password needs to be changed.\n            default:\n                throw; // Re-throw other errors.\n        }\n    }\n    catch (Exception e)\n    {\n        // Handle any other exceptions not related to authentication errors.\n        throw;\n    }\n\n    return false;\n}