using System.Collections.ObjectModel;\nusing System.Linq;\nusing System.Windows.Media;\n\npublic ObservableCollection<FontFamily> ValidFontFamilies { get; set; }\n\npublic MainWindow()\n{\n    InitializeComponent();\n    \n    LoadValidFonts();\n\n    fontComboFast.ItemsSource = ValidFontFamilies;\n}\n\nprivate void LoadValidFonts()\n{\n    ValidFontFamilies = new ObservableCollection<FontFamily>();\n    \n    foreach (var fontFamily in Fonts.SystemFontFamilies)\n    {\n        try\n        {\n            // Attempt to create a Typeface from the FontFamily to check its validity.\n            var typeface = new Typeface(fontFamily, FontStyles.Normal, FontWeights.Normal, FontStretches.Normal);\n\n            if (typeface.FamilyCollection != FontFamily.GenericFontFamilies.Unknown)\n                ValidFontFamilies.Add(fontFamily);\n        }\n        catch\n        {\n            // If there is an exception it means the font is not valid and will be skipped.\n        }\n    }\n}