public override bool ValidateUser(string username, string password)\n{\n    MembershipUser user = GetUser(username, false);\n    if (user == null) return false;\n\n    // Decrypt the stored password\n    string decryptedPassword = DecryptPassword(user.Password);\n\n    // Compare decrypted password with the provided one\n    return FormsAuthentication.HashPasswordForStoringInConfigFile(password, "SHA1") == decryptedPassword;\n}