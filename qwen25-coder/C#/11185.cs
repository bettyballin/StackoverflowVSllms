using System;\nusing System.Management;\n\npublic class ExcelVersionChecker\n{\n    public static void CheckExcelVersion()\n    {\n        string query = "SELECT * FROM Win32_Product WHERE Name LIKE 'Microsoft Excel%'";\n        ManagementObjectSearcher searcher = new ManagementObjectSearcher(query);\n\n        foreach (ManagementObject product in searcher.Get())\n        {\n            Console.WriteLine("Name: {0}", product["Name"]);\n            Console.WriteLine("Version: {0}", product["Version"]);\n            // This will give you the full version including service packs and updates.\n        }\n    }\n\n    static void Main(string[] args)\n    {\n        CheckExcelVersion();\n    }\n}