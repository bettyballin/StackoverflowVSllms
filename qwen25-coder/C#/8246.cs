using System;\nusing System.IO;\n\nclass Program\n{\n    static void Main()\n    {\n        string directoryPath = @"C:\myfolder";\n        \n        if (CanWriteToDirectory(directoryPath))\n        {\n            Console.WriteLine("You can create a file in the directory.");\n        }\n        else\n        {\n            Console.WriteLine("You cannot create a file in the directory.");\n        }\n    }\n\n    static bool CanWriteToDirectory(string path)\n    {\n        try\n        {\n            // Attempt to get a DirectoryInfo object with Write权限 check.\n            var directoryInfo = new DirectoryInfo(path);\n                \n            // Check if the directory exists and we have write access.\n            return directoryInfo.Exists && directoryInfo.GetAccessControl().GetRules(true, true, typeof(System.Security.Principal.NTAccount))\n                .Cast<System.Security.AccessControl.FileSystemAccessRule>()\n                .Any(rule => rule.FileSystemRights.HasFlag(System.Security.AccessControl.FileSystemRights.WriteData) \n                             && rule.AccessControlType == System.Security.AccessControl.AccessControlType.Allow);\n        }\n        catch\n        {\n            // If an error occurs, we assume no write access.\n            return false;\n        }\n    }\n}