using System;\nusing System.Net.Sockets;\n\nclass P2PNetworkListener {\n    private TcpListener server = null;\n\n    public void StartListening(String ipAddress, int port) {\n\n        try {\n            // Set the TcpListener on the local IP address and port.\n            IPAddress localAddr = IPAddress.Parse(ipAddress);\n            server = new TcpListener(localAddr, port);\n\n            // Start listening for client requests.\n            server.Start();\n\n            // Buffer for reading data\n            Byte[] bytes = new Byte[256];\n            String data = null;\n\n            // Enter the listening loop.\n            while (true) {\n                Console.Write("Waiting for a connection... ");\n\n                // Perform a blocking call to accept requests.\n                TcpClient client = server.AcceptTcpClient();\n                Console.WriteLine("Connected!");\n\n                data = null;\n\n                // Get a stream object for reading and writing\n                NetworkStream stream = client.GetStream();\n\n                int i;\n\n                // Loop to receive all the data sent by the client.\n                while ((i = stream.Read(bytes, 0, bytes.Length)) != 0) {\n                    // Translate data bytes to a UTF8 string\n                    data = System.Text.Encoding.UTF8.GetString(bytes, 0, i);\n                    Console.WriteLine("Received: {0}", data);\n\n                    // Process received data and send response (example only)\n                    byte[] msg = System.Text.Encoding.UTF8.GetBytes(data);\n                    stream.Write(msg, 0, msg.Length);\n                }\n\n                // Shutdown and end connection\n                client.Close();\n            }\n        } catch (SocketException e) {\n            Console.WriteLine("SocketException: {0}", e);\n        } finally {\n            // Stop listening for new clients.\n            server.Stop();\n        }\n\n        Console.WriteLine("\nHit enter to continue...");\n        Console.Read();\n    }\n}\n\nclass Program {\n    static void Main(String[] args) {\n        P2PNetworkListener listener = new P2PNetworkListener();\n        listener.StartListening("127.0.0.1", 5000);\n    }\n}