using System;\nusing System.IO;\nusing System.Security.Cryptography;\nusing Org.BouncyCastle.Crypto;\nusing Org.BouncyCastle.Crypto.Parameters;\nusing Org.BouncyCastle.OpenSsl;\n\npublic class RsaKeyStorage\n{\n    public void StorePrivateKey(RSAParameters privateKey)\n    {\n        using (var rsa = new RSACryptoServiceProvider())\n        {\n            rsa.ImportParameters(privateKey);\n            var keyInfo = DotNetUtilities.ConvertRsaKey(rsa);\n\n            using (TextWriter writer = File.CreateText("private.pem"))\n            {\n                var pemWriter = new PemWriter(writer);\n                pemWriter.WriteObject(keyInfo);\n            }\n        }\n    }\n\n    public void StorePublicKey(RSAParameters publicKey)\n    {\n        using (var rsa = new RSACryptoServiceProvider())\n        {\n            rsa.ImportParameters(publicKey);\n            var keyInfo = DotNetUtilities.ConvertRsaKey(rsa).GetPublicKey();\n\n            using (TextWriter writer = File.CreateText("public.pem"))\n            {\n                var pemWriter = new PemWriter(writer);\n                pemWriter.WriteObject(keyInfo);\n            }\n        }\n    }\n}