using System;\nusing System.Runtime.InteropServices;\nusing System.Drawing;\n\npublic class MyComClassWrapper\n{\n    private readonly IMyComClass _comObject;\n\n    public MyComClassWrapper()\n    {\n        // Initialize and create the COM object instance here\n        this._comObject = new MyComClass();\n    }\n\n    public Bitmap GetBitmap()\n    {\n        byte[] dibData;\n        int bufferSize = 256; // Start with an arbitrary size, possibly growing this based on actual needs\n\n        while (true)\n        {\n            dibData = new byte[bufferSize];\n            try\n            {\n                uint written;\n                _comObject.GetDIB(dibData, (uint)dibData.Length, out written);\n                Array.Resize(ref dibData, (int)written);\n                break;\n            }\n            catch (SEHException ex)\n            {\n                if (ex.NativeErrorCode == unchecked((int)0x80070057)) // E_INVALIDARG, indicating buffer is too small\n                {\n                    bufferSize *= 2; // Double the buffer size and try again\n                }\n                else\n                {\n                    throw;\n                }\n            }\n        }\n\n        using (var ms = new System.IO.MemoryStream(dibData))\n        {\n            return new Bitmap(ms);\n        }\n    }\n}