using System;\nusing System.Reflection;\nusing System.Windows.Controls;\n\npublic class PageFactory\n{\n    public static Page CreatePageInstance(string pagePath, params object[] constructorArgs)\n    {\n        // Extract the class name from the file path\n        string className = System.IO.Path.GetFileNameWithoutExtension(pagePath);\n        \n        // Assuming all pages are in a namespace called "YourNamespace.Pages"\n        string fullClassName = $"YourNamespace.Pages.{className}";\n\n        try\n        {\n            // Load the assembly and get the type of the page\n            Type pageType = Type.GetType(fullClassName, true);\n\n            // Create an instance of the page using reflection\n            return (Page)Activator.CreateInstance(pageType, constructorArgs);\n        }\n        catch (Exception ex)\n        {\n            throw new InvalidOperationException($"Could not create an instance of {fullClassName}.", ex);\n        }\n    }\n}