using System;\nusing System.Web.Mvc;\n\npublic class RequireHttpsAttribute : ActionFilterAttribute\n{\n    public override void OnActionExecuting(ActionExecutingContext filterContext)\n    {\n        if (!filterContext.HttpContext.Request.IsSecureConnection && \n            !string.Equals(filterContext.HttpContext.Request.Headers["X-Forwarded-Proto"], "https", StringComparison.OrdinalIgnoreCase))\n        {\n            var url = new UriBuilder(Request.Url) { Scheme = Uri.UriSchemeHttps, Port = 443 };\n            filterContext.Result = new RedirectResult(url.ToString());\n        }\n    }\n}