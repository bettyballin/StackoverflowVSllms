// Example of simple SQL polling loop (for demonstration purposes)\nusing System.Data.SqlClient;\n\nstring connectionString = "your_connection_string";\nstring sql = "SELECT * FROM BookingRecords WHERE Status = 'Pending'";\n\nwhile (true) {\n    using (SqlConnection connection = new SqlConnection(connectionString)) {\n        connection.Open();\n        SqlCommand command = new SqlCommand(sql, connection);\n        SqlDataReader reader = command.ExecuteReader();\n\n        while (reader.Read()) {\n            // Process record\n            int bookingId = reader.GetInt32(0);\n            // Perform operations including calling third-party services\n\n            // Update status in the database\n            string updateSql = "UPDATE BookingRecords SET Status = 'Processed' WHERE Id = @BookingId";\n            using (SqlCommand updateCommand = new SqlCommand(updateSql, connection)) {\n                updateCommand.Parameters.AddWithValue("@BookingId", bookingId);\n                updateCommand.ExecuteNonQuery();\n            }\n        }\n        reader.Close();\n    }\n\n    // Avoid busy-waiting by sleeping\n    System.Threading.Thread.Sleep(5000); // Wait for 5 seconds\n}