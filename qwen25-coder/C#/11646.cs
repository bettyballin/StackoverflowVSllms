using Microsoft.Win32;\nusing System;\n\nclass Program\n{\n    static void Main()\n    {\n        string installPath = GetVisioInstallPath();\n        if (!string.IsNullOrEmpty(installPath))\n        {\n            Console.WriteLine("Visio is installed at: " + installPath);\n        }\n        else\n        {\n            Console.WriteLine("Visio is not installed.");\n        }\n    }\n\n    static string GetVisioInstallPath()\n    {\n        // Check both 32-bit and 64-bit registry if necessary\n        var rootKeys = new[]\n        {\n            RegistryKey.OpenBaseKey(RegistryHive.LocalMachine, RegistryView.Registry32),\n            RegistryKey.OpenBaseKey(RegistryHive.LocalMachine, RegistryView.Registry64)\n        };\n\n        const string visioPath = @"SOFTWARE\Microsoft\Office\ClickToRun\Configuration";\n        const string visioInstallPath60 = @"SOFTWARE\Microsoft\Office\16.0\Visio\InstallRoot";\n\n        foreach (var rootKey in rootKeys)\n        {\n            using (RegistryKey key32bit = rootKey.OpenSubKey(visioPath))\n            {\n                if (key32bit != null && key32bit.GetValue("ProductReleaseIDs")?.ToString().Contains("Visio") == true)\n                {\n                    return Environment.GetFolderPath(Environment.SpecialFolder.ProgramFilesX86) + @"\Microsoft Office\root\Office16";\n                }\n            }\n\n            using (RegistryKey key = rootKey.OpenSubKey(visioInstallPath60))\n            {\n                if (key != null && key.GetValue("Path") is string path)\n                {\n                    return path;\n                }\n            }\n        }\n\n        // Check other versions if needed\n        for (int i = 14; i < 25; i++) // Example range, adjust as necessary\n        {\n            var visioInstallPath = $@"SOFTWARE\Microsoft\Office\{i}.0\Visio\InstallRoot";\n            foreach (var rootKey in rootKeys)\n            {\n                using (RegistryKey key = rootKey.OpenSubKey(visioInstallPath))\n                {\n                    if (key != null && key.GetValue("Path") is string path)\n                    {\n                        return path;\n                    }\n                }\n            }\n        }\n\n        return null;\n    }\n}