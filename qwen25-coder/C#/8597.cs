using System;\nusing System.Text;\nusing System.Windows.Forms;\n\npublic class MainForm : Form {\n    private TextBox textBox;\n\n    public MainForm() {\n        InitializeComponent();\n    }\n\n    private void InitializeComponent() {\n        textBox = new TextBox { Dock = DockStyle.Fill, Multiline = true };\n        textBox.PreviewKeyDown += TextBox_PreviewKeyDown;\n        textBox.MouseDown += TextBox_MouseDown;\n        Controls.Add(textBox);\n\n        this.Text = "ANSI Paste Example";\n    }\n\n    private void TextBox_MouseDown(object sender, MouseEventArgs e) {\n        if (e.Button == MouseButtons.Right && textBox.CanFocus) {\n            // Optionally, handle right-click for context menu paste\n        }\n    }\n\n    private void TextBox_PreviewKeyDown(object sender, PreviewKeyDownEventArgs e) {\n        if (e.Control && e.KeyCode == Keys.V) {\n            HandlePaste();\n        }\n    }\n\n    private void HandlePaste() {\n        IDataObject data = Clipboard.GetDataObject();\n\n        // Check if the clipboard contains text\n        if (data.GetDataPresent(DataFormats.Text)) {\n            string ansiText = (string)data.GetData(DataFormats.Text);\n\n            byte[] bytes = Encoding.Default.GetBytes(ansiText);\n            string decodedText = Encoding.GetEncoding(1252).GetString(bytes);\n\n            textBox.SelectedText = decodedText;\n        }\n    }\n\n    [STAThread]\n    static void Main() {\n        Application.EnableVisualStyles();\n        Application.Run(new MainForm());\n    }\n}