using System;\nusing System.Collections.Generic;\nusing System.Runtime.InteropServices;\n\nnamespace TestCOM\n{\n    [ComVisible(true)]\n    [Guid("YOUR-GUID-HERE-FOR-INTERFACE1")]\n    public interface IClass1\n    {\n        IClass2[] getList();\n    }\n\n    [ComVisible(true)]\n    [Guid("YOUR-GUID-HERE-FOR-CLASS1")]\n    public class Class1 : IClass1\n    {\n        private List<IClass2> myList;\n\n        public Class1()\n        {\n            myList = new List<IClass2>();\n            myList.Add(new Class2());\n            myList.Add(new Class2());\n        }\n\n        public IClass2[] getList()\n        {\n            try\n            {\n                IClass2[] a = new IClass2[myList.Count];\n                for (int i = 0; i < myList.Count; i++)\n                {\n                    a[i] = myList[i];\n                }\n                return a;\n            }\n            catch (Exception e)\n            {\n                System.IO.File.WriteAllText(@"C:\COMLog.txt", string.Format("Error:\n{0}", e.Message));\n            }\n            return null;\n        }\n    }\n\n    [ComVisible(true)]\n    [Guid("YOUR-GUID-HERE-FOR-INTERFACE2")]\n    public interface IClass2\n    {\n        int Value { get; }\n    }\n\n    [ComVisible(true)]\n    [Guid("YOUR-GUID-HERE-FOR-CLASS2")]\n    public class Class2 : IClass2\n    {\n        private static Random random = new Random();\n        \n        public int Value { get; private set; }\n\n        public Class2()\n        {\n            this.Value = random.Next();\n        }\n    }\n}