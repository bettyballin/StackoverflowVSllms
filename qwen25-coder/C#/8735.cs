using System;\nusing System.Drawing;\nusing System.IO;\n\npublic class Program\n{\n    public static void Main()\n    {\n        string filePath = @"C:\Path\To\File.dll"; // Change to EXE path if needed\n        int iconIndex = 0; // For extracting a specific icon by index, use negative values like -203 for DLLs\n\n        IntPtr hIcon = IconExtractor.ExtractIcon(IntPtr.Zero, filePath, (uint)iconIndex);\n        \n        if (!hIcon.Equals(IntPtr.Zero))\n        {\n            try\n            {\n                using (System.Drawing.Icon icon = System.Drawing.Icon.FromHandle(hIcon).Clone() as System.Drawing.Icon)\n                {\n                    // Save the icon to a file\n                    string outputFilePath = @"C:\Path\To\Output.ico";\n                    icon.Save(outputFilePath);\n\n                    Console.WriteLine("Icon saved successfully.");\n                }\n            }\n            finally\n            {\n                IconExtractor.DestroyIcon(hIcon); // Clean up\n            }\n        }\n        else\n        {\n            Console.WriteLine("Failed to extract the icon.");\n        }\n    }\n}