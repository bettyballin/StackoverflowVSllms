using System;\nusing System.Runtime.InteropServices;\nusing System.Windows.Forms;\n\npublic class MonitorUtils\n{\n    [DllImport("user32.dll", CharSet = CharSet.Auto)]\n    public static extern IntPtr GetMonitorInfo(IntPtr hmonitor, ref MONITORINFO lpmi);\n\n    [DllImport("user32.dll")]\n    public static extern bool GetMonitorInfo(IntPtr hmon, MONITORINFO mi);\n\n    [DllImport("user32.dll")]\n    private static extern IntPtr MonitorFromWindow(IntPtr handle, int flags);\n\n    // Constants for MonitorFromWindow\n    private const int MONITOR_DEFAULTTONEAREST = 0x00000002;\n    \n    public static Screen GetPrimaryMonitor()\n    {\n        foreach (Screen screen in Screen.AllScreens)\n        {\n            if (screen.Primary)\n                return screen;\n        }\n        // Default to the first one if no primary is found\n        return Screen.AllScreens[0];\n    }\n}