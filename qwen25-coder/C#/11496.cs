// Ensure correct CLSID and ProgID setup\n[ComVisible(true)]\n[ClassInterface(ClassInterfaceType.None)]\n[Guid("C3ED53DA-EC0E-4625-AB0C-9837D0D0D59D")]\npublic class MimeFilter : _MimeFilter, IClassFactory\n{\n    #region [ IClassFactory ]\n    public void CreateInstance([MarshalAs(UnmanagedType.IUnknown)] object pUnkOuter, ref Guid riid, out IntPtr ppvObject)\n    {\n        if (pUnkOuter != null)\n            throw new COMException("Aggregation is not supported", HRESULT.E_NOINTERFACE);\n\n        if (riid == typeof(IInternetProtocol).GUID ||\n            riid == typeof(IUnknown).GUID ||\n            riid == typeof(IClassFactory).GUID)\n        {\n            ppvObject = Marshal.GetComInterfaceForObject(this, riid);\n        }\n        else\n        {\n            throw new COMException("Interface not implemented", HRESULT.E_NOINTERFACE);\n        }\n    }\n\n    public void LockServer(bool fLock)\n    {\n    }\n\n    // Implement other required interfaces here...\n    #endregion\n}