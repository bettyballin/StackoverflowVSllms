using System;\nusing System.Data.SqlClient;\nusing System.Net.Mail;\n\npublic class AppointmentReminderService\n{\n    private static string connectionString = "your_connection_string_here";\n\n    public static void SendReminders()\n    {\n        using (SqlConnection conn = new SqlConnection(connectionString))\n        {\n            conn.Open();\n            SqlCommand command = new SqlCommand("SELECT Email, Name FROM Appointments WHERE CAST(AppointmentDate AS DATE) = @Tomorrow AND ReminderSent = 0", conn);\n            command.Parameters.AddWithValue("@Tomorrow", DateTime.Today.AddDays(1));\n\n            SqlDataReader reader = command.ExecuteReader();\n\n            while (reader.Read())\n            {\n                SendEmail(reader["Email"].ToString(), reader["Name"].ToString());\n                UpdateAppointmentSentStatus(reader["Email"].ToString());\n            }\n        }\n    }\n\n    private static void SendEmail(string recipient, string name)\n    {\n        using (MailMessage mail = new MailMessage())\n        {\n            SmtpClient client = new SmtpClient(); // Configure your SMTP settings\n            mail.From = new MailAddress("noreply@example.com");\n            mail.To.Add(recipient);\n            mail.Subject = "Appointment Reminder";\n            mail.Body = $"Hello {name}, this is a reminder about your appointment tomorrow.";\n\n            try\n            {\n                client.Send(mail);\n            }\n            catch (Exception ex)\n            {\n                // Log error here\n            }\n        }\n    }\n\n    private static void UpdateAppointmentSentStatus(string email)\n    {\n        using (SqlConnection conn = new SqlConnection(connectionString))\n        {\n            conn.Open();\n            SqlCommand commandUpdate = new SqlCommand("UPDATE Appointments SET ReminderSent = 1 WHERE Email = @Email", conn);\n            commandUpdate.Parameters.AddWithValue("@Email", email);\n            commandUpdate.ExecuteNonQuery();\n        }\n    }\n}