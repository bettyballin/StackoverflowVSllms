using System;\nusing System.Net.Mail;\nusing System.IO;\n\npublic class MailSender\n{\n    private static void SendEmailWithAttachment(string mailServer, string myAttachment)\n    {\n        using (SmtpClient smtp = new SmtpClient(mailServer))\n        using (MailMessage mailMsg = new MailMessage())\n        using (Attachment attachment = new Attachment(myAttachment))\n        {\n            try\n            {\n                // Configure your mail message and SMTP client...\n                mailMsg.Attachments.Add(attachment);\n\n                // Set SendCompleted event handler, passing the attachment file name as user token\n                smtp.SendCompleted += (sender, e) =>\n                {\n                    if (!e.Cancelled && e.Error == null)\n                    {\n                        try\n                        {\n                            File.Delete(myAttachment);\n                        }\n                        catch (IOException ex)\n                        {\n                            Console.WriteLine($"Failed to delete the file: {ex.Message}");\n                        }\n                    }\n                    else\n                    {\n                        Console.WriteLine("An error occurred while sending email.");\n                    }\n\n                    // Optionally, unsubscribe the event handler if needed\n                };\n\n                // Send the mail asynchronously\n                smtp.SendAsync(mailMsg, null);\n            }\n            catch (Exception ex)\n            {\n                Console.WriteLine($"An error occurred: {ex.Message}");\n            }\n        }\n    }\n\n    private static void Main(string[] args)\n    {\n        string mailServer = "your_mail_server";\n        string myAttachment = @"path_to_your_attachment";\n\n        SendEmailWithAttachment(mailServer, myAttachment);\n    }\n}