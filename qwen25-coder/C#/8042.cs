public class AudioFactory\n{\n    private short[] buffer;\n    private int index = -1;\n    private int stepSize;\n\n    public AudioFactory(short[] buffer, int stepSize)\n    {\n        this.buffer = buffer;\n        this.stepSize = stepSize;\n    }\n\n    public bool MoveNext(int stepSize)\n    {\n        if (index == -1)\n        {\n            index = 0;\n            return true;\n        }\n        else\n        {\n            index += stepSize;\n            if (index >= buffer.Length - stepSize)\n                return false;\n            else\n                return true;\n        }\n    }\n\n    public DecodedProxyExcerpt Current(int stepSize)\n    {\n        var currentExcerpt = new DecodedProxyExcerpt(stepSize);\n        Array.Copy(buffer, index, currentExcerpt.data, 0, stepSize);\n        return currentExcerpt;\n    }\n}