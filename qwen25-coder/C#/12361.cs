private static bool IsValidDomainNameForHostsFile(string domain)\n{\n    if (string.IsNullOrEmpty(domain) || domain.Length > 255)\n    {\n        return false;\n    }\n\n    // Allow leading hyphen by trimming it for the hostname check\n    string trimmedDomain = domain.TrimStart('-');\n    \n    switch (Uri.CheckHostName(trimmedDomain))\n    {\n        case UriHostNameType.Dns:\n            // Further validate each label's length as per DNS rules\n            foreach (string part in domain.Split('.'))\n            {\n                if (part.Length > 63)\n                {\n                    return false;\n                }\n            }\n            return true;\n        case UriHostNameType.Unknown:\n            return false;\n    }\n\n    return false;\n}