using System.Collections.ObjectModel;\nusing System.ComponentModel.Composition;\n\npublic class DiagramViewModel {\n    [ImportMany]\n    public ObservableCollection<IShapeViewModel> ShapeViewModels { get; set; }\n\n    // Method to load DataTemplates into the ResourceDictionary\n    public void LoadShapeTemplates() {\n        var catalog = new AggregateCatalog();\n        catalog.Catalogs.Add(new AssemblyCatalog(Assembly.GetExecutingAssembly()));\n        var container = new CompositionContainer(catalog);\n\n        // Import all DataTemplates\n        var templates = container.GetExportedValues<DataTemplate>();\n        foreach (var template in templates) {\n            Application.Current.Resources.MergedDictionaries.Add(template);\n        }\n    }\n}