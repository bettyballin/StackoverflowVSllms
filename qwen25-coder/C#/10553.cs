public string GuidToBase64(Guid guid)\n{\n    // Convert GUID to Base64 string and replace characters for URL safety\n    return Convert.ToBase64String(guid.ToByteArray()).Replace("/", "-").Replace("+", "_").Replace("=", "");\n}\n\npublic Guid Base64ToGuid(string base64)\n{\n    try\n    {\n        // Restore Base64 padding and character replacements for URL safety\n        base64 = base64.Replace("-", "/").Replace("_", "+");\n        switch (base64.Length % 4)\n        {\n            case 2:\n                base64 += "==";\n                break;\n            case 3:\n                base64 += "=";\n                break;\n        }\n\n        // Convert Base64 string back to GUID\n        return new Guid(Convert.FromBase64String(base64));\n    }\n    catch (FormatException ex)\n    {\n        throw new InvalidOperationException("Invalid Base64 format for GUID conversion.", ex);\n    }\n    catch (ArgumentException ex)\n    {\n        throw new InvalidOperationException("Unable to convert Base64 to GUID.", ex);\n    }\n}