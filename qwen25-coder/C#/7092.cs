using System.Security.Cryptography.X509Certificates;\n\npublic bool IsValidAndNotRevoked(X509Certificate2 certificate)\n{\n    X509Chain chain = new X509Chain();\n    chain.ChainPolicy.RevocationMode = X509RevocationMode.Online;\n    chain.Build(certificate);\n\n    foreach (X509ChainStatus status in chain.ChainStatus)\n    {\n        if (status.Status != X509ChainStatusFlags.NoError)\n        {\n            return false; // Certificate is not valid or revoked\n        }\n    }\n    return true; // Certificate is valid and not revoked\n}