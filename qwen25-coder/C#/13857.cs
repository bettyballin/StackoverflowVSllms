public void InactiveCustomers(IEnumerable<Guid> customerIDs)\n{\n    using (var myAdoConnection = new SqlConnection(connectionString))\n    {\n        var myAdoCommand = new SqlCommand("UPDATE Customer SET Active = 0 WHERE CustomerID IN (SELECT CustomerID FROM @CustomerIDs)", myAdoConnection);\n        \n        // Create a DataTable that matches the TVP structure\n        var dataTable = new DataTable();\n        dataTable.Columns.Add("CustomerID", typeof(Guid));\n        \n        foreach (var id in customerIDs)\n        {\n            dataTable.Rows.Add(id);\n        }\n        \n        // Add the parameter using SqlDbType.Structured\n        myAdoCommand.Parameters.AddWithValue("@CustomerIDs", dataTable).SqlDbType = SqlDbType.Structured;\n\n        myAdoConnection.Open();\n        myAdoCommand.ExecuteNonQuery();\n    }\n}