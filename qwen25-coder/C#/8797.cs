using System;\n   using System.Data.SqlClient;\n\n   public class AutoIncrementManager\n   {\n       private readonly string _connectionString;\n\n       public AutoIncrementManager(string connectionString)\n       {\n           _connectionString = connectionString;\n       }\n\n       public int GetNextValue(string tableName, string columnName)\n       {\n           using (SqlConnection conn = new SqlConnection(_connectionString))\n           {\n               using (SqlCommand cmd = new SqlCommand("GetNextAutoIncValue", conn))\n               {\n                   cmd.CommandType = System.Data.CommandType.StoredProcedure;\n\n                   cmd.Parameters.AddWithValue("@TableName", tableName);\n                   cmd.Parameters.AddWithValue("@ColumnName", columnName);\n\n                   SqlParameter outParam = new SqlParameter("@NewValue", 0);\n                   outParam.Direction = System.Data.ParameterDirection.Output;\n                   cmd.Parameters.Add(outParam);\n\n                   conn.Open();\n                   cmd.ExecuteNonQuery();\n\n                   return (int)outParam.Value;\n               }\n           }\n       }\n   }