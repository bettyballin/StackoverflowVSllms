using System;\nusing System.Net;\nusing System.ServiceModel;\nusing System.ServiceModel.Channels;\nusing System.ServiceModel.Description;\n\npublic class CookieAddingBehavior : IEndpointBehavior\n{\n    private CookieContainer _cookies;\n\n    public CookieAddingBehavior(CookieContainer cookies)\n    {\n        _cookies = cookies ?? new CookieContainer();\n    }\n\n    public void AddBindingParameters(ServiceEndpoint endpoint, BindingParameterCollection bindingParameters) { }\n\n    public void ApplyClientBehavior(ServiceEndpoint endpoint, ClientRuntime clientRuntime)\n    {\n        clientRuntime.ClientMessageInspectors.Add(new CookieInspector(_cookies));\n    }\n\n    public void ApplyDispatchBehavior(ServiceEndpoint endpoint, EndpointDispatcher endpointDispatcher) { }\n\n    public void Validate(ServiceEndpoint endpoint) { }\n}\n\npublic class CookieInspector : IClientMessageInspector\n{\n    private CookieContainer _cookieContainer;\n\n    public CookieInspector(CookieContainer cookieContainer)\n    {\n        _cookieContainer = cookieContainer;\n    }\n\n    public object BeforeSendRequest(ref Message request, IClientChannel channel)\n    {\n        var httpRequestProperty = (HttpRequestMessageProperty)request.Properties[HttpRequestMessageProperty.Name];\n        if (httpRequestProperty == null)\n        {\n            httpRequestProperty = new HttpRequestMessageProperty();\n            request.Properties.Add(HttpRequestMessageProperty.Name, httpRequestProperty);\n        }\n\n        // Get the cookies for the Uri\n        var uri = channel.Via;\n        string cookieHeader = _cookieContainer.GetCookieHeader(uri);\n        if (!string.IsNullOrEmpty(cookieHeader))\n        {\n            httpRequestProperty.Headers[System.Net.HttpRequestHeader.Cookie] = cookieHeader;\n        }\n        return null;\n    }\n\n    public void AfterReceiveReply(ref Message reply, object correlationState) { }\n}\n\n// Usage example\npublic static void Main()\n{\n    CookieContainer cookies = new CookieContainer();\n    Cookie cookie = new Cookie("name", "value", "/", "domain");\n    cookies.Add(uri, cookie);\n\n    YourServiceClient service = new YourServiceClient();\n    service.Endpoint.Behaviors.Add(new CookieAddingBehavior(cookies));\n\n    // Call your service methods\n    service.Test();\n}