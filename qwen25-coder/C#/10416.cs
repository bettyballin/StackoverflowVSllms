protected void Application_BeginRequest(object sender, EventArgs e)\n{\n    if (Context.Session != null)\n    {\n        // Check if the session is new and is not a default ID\n        if (Session.IsNewSession && HttpContext.Current.Request.Cookies["ASP.NET_SessionId"] != null)\n        {\n            HttpCookie cookie = HttpContext.Current.Request.Cookies["ASP.NET_SessionId"];\n            if (Request.UrlReferrer == null || SessionManager.SessionExists(cookie.Value) == false)\n            {\n                // Session expired\n                FormsAuthentication.SignOut();\n                Session.Abandon();\n\n                // Clear authentication cookie\n                var authCookie = new HttpCookie(FormsAuthentication.FormsCookieName, "")\n                {\n                    Expires = DateTime.Now.AddYears(-1),\n                    Path = "/"\n                };\n                Response.Cookies.Add(authCookie);\n\n                // Redirect to the session expired page\n                Response.Redirect("~/SessionExpired.aspx", true);\n            }\n        }\n    }\n}