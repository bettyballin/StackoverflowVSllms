using ICSharpCode.SharpZipLib.Zip;\nusing System.IO;\n\npublic static void CreateEncryptedZip(string zipPath, string password, params string[] fileNames)\n{\n    using (ZipOutputStream s = new ZipOutputStream(File.Create(zipPath)))\n    {\n        s.SetLevel(3); // 0-9, 9 being the highest compression\n        byte[] buffer = new byte[4096];\n\n        foreach (string file in fileNames)\n        {\n            ZipEntry entry = new ZipEntry(Path.GetFileName(file))\n            {\n                DateTime = DateTime.Now\n            };\n\n            s.PutNextEntry(entry);\n\n            using (FileStream fs = File.OpenRead(file))\n            {\n                int sourceBytes;\n                do\n                {\n                    sourceBytes = fs.Read(buffer, 0, buffer.Length);\n                    s.Write(buffer, 0, sourceBytes);\n                } while (sourceBytes > 0);\n            }\n\n            // Set password after adding each file\n            s.Password = password;\n        }\n\n        s.Finish();\n        s.Close();\n    }\n}