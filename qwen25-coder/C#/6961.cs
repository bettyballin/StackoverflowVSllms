using System;\nusing System.Windows.Forms;\n\npublic class UserPresenceDetector : Form\n{\n    private bool _userActive;\n\n    public UserPresenceDetector()\n    {\n        Application.Idle += new EventHandler(Application_Idle);\n        SystemEvents.SessionSwitch += new SessionSwitchEventHandler(SystemEvents_SessionSwitch);\n\n        // Assume user is active initially\n        _userActive = true;\n    }\n\n    [STAThread]\n    static void Main()\n    {\n        Application.EnableVisualStyles();\n        Application.SetCompatibleTextRenderingDefault(false);\n        Application.Run(new UserPresenceDetector());\n    }\n\n    private void Application_Idle(object sender, EventArgs e)\n    {\n        // Check if the application is idle for more than a certain period\n        if (Environment.TickCount64 - IdleTime.GetLastInputTime() > 5000) // More than 5 seconds of inactivity\n        {\n            _userActive = false;\n            Console.WriteLine("User inactive.");\n            // Here you can toggle the user's availability in your system.\n        }\n    }\n\n    private void SystemEvents_SessionSwitch(object sender, SessionSwitchEventArgs e)\n    {\n        switch (e.Reason)\n        {\n            case SessionSwitchReason.SessionLock:\n                _userActive = false;\n                Console.WriteLine("User locked session.");\n                break;\n            case SessionSwitchReason.SessionUnlock:\n                _userActive = true;\n                Console.WriteLine("User unlocked session.");\n                break;\n        }\n    }\n\n    public static class IdleTime\n    {\n        private const int MAXINT = 0x7FFFFFFF;\n\n        [System.Runtime.InteropServices.DllImport("user32.dll")]\n        private static extern bool GetLastInputInfo(ref LASTINPUTINFO plii);\n\n        private struct LASTINPUTINFO\n        {\n            public uint cbSize;\n            public uint dwTime;\n        }\n\n        public static double GetLastInputTime()\n        {\n            LASTINPUTINFO lastInputInfo = new LASTINPUTINFO();\n            lastInputInfo.cbSize = (uint)System.Runtime.InteropServices.Marshal.SizeOf(lastInputInfo);\n            GetLastInputInfo(ref lastInputInfo);\n\n            return Environment.TickCount64 - lastInputInfo.dwTime;\n        }\n    }\n}