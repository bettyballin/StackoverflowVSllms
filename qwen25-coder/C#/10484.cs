bool success = WinApi.CreateProcessWithLogonW(\n    "Alex",          // Username\n    null,            // Domain (use null if local account)\n    "password",      // Password\n    LogonFlags.WithProfile,\n    null,            // Application name (use null and specify full path in command line)\n    this.CommandLine,// Command line with full path to executable\n    CreationFlags.CREATE_NEW_CONSOLE | CreationFlags.CREATE_UNICODE_ENVIRONMENT,\n    IntPtr.Zero,     // Environment block (use IntPtr.Zero for default environment)\n    @"C:\",          // Current directory (specify a valid directory)\n    ref startupInfo, \n    out _processInfo);\n\nif (!success)\n{\n    int errorCode = Marshal.GetLastWin32Error();\n    throw new Win32Exception(errorCode);\n}