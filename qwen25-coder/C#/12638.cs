using System;\nusing Microsoft.Web.Administration;\n\nclass Program\n{\n    static void Main()\n    {\n        string siteName = "Default Web Site";\n        string vDirPath = "MyVirtualDir"; // Path of the new virtual folder, e.g., http://localhost/MyVirtualDir/\n        string physicalPath = @"C:\inetpub\wwwroot\MyPhysicalFolder"; // Physical path on disk\n\n        using (ServerManager serverManager = new ServerManager())\n        {\n            Site site = serverManager.Sites[siteName];\n            if (site != null)\n            {\n                bool vdirExists = false;\n                foreach (VirtualDirectory existingVDir in site.RootWeb.VirtualDirectories)\n                {\n                    if (existingVDir.Path == "/" + vDirPath)\n                        vdirExists = true;\n                }\n\n                if (!vdirExists)\n                {\n                    site.RootWeb.VirtualDirectories.Add("/" + vDirPath, physicalPath);\n                    serverManager.CommitChanges();\n                    Console.WriteLine("Virtual directory created successfully.");\n                }\n                else\n                {\n                    Console.WriteLine("Virtual Directory already exists.");\n                }\n            }\n            else\n            {\n                Console.WriteLine($"Site {siteName} not found.");\n            }\n        }\n    }\n}