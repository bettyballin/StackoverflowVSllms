try\n{\n    // Your existing code...\n\n    var certificateSubject = "email@subject.test";\n    X509Certificate2 cert = null;\n    using (X509Store store = new X509Store(StoreName.My, StoreLocation.LocalMachine))\n    {\n        store.Open(OpenFlags.ReadOnly);\n        X509Certificate2Collection certs = store.Certificates.Find(X509FindType.FindBySubjectName, certificateSubject, false);\n\n        if (certs.Count == 0)\n        {\n            throw new Exception($"No certificate found with subject {certificateSubject}.");\n        }\n\n        cert = certs[0];\n    }\n\n    // Validate private key access\n    RSA privateKey = cert.PrivateKey;\n    if (privateKey == null)\n    {\n        throw new InvalidOperationException("The certificate does not have a private key or the key is inaccessible.");\n    }\n\n    securityToken = new X509SecurityToken(cert);\n\n    // Your existing code...\n}\ncatch (Exception exc)\n{\n    Label1.Text = User.Identity.Name + " exception: " + exc.ToString();\n}