private static void _SetAcl(string path, string identity, FileSystemRights rights)\n{\n    var info = new DirectoryInfo(path);\n    var acl = info.GetAccessControl();\n\n    var rule1 = new FileSystemAccessRule(identity, rights, AccessControlType.Allow);\n    bool modified;\n    acl.ModifyAccessRule(AccessControlModification.Reset, rule1, out modified);\n\n    var inheritanceFlags = InheritanceFlags.ContainerInherit | InheritanceFlags.ObjectInherit;\n    var rule2 = new FileSystemAccessRule(identity, rights, inheritanceFlags,\n                                        PropagationFlags.InheritOnly, AccessControlType.Allow);\n    acl.ModifyAccessRule(AccessControlModification.Add, rule2, out modified);\n\n    // Apply the changes to the directory\n    info.SetAccessControl(acl);\n}