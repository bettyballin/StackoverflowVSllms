private void CheckAndLoadRibbon()\n{\n    try\n    {\n        // Get the major version number of Excel\n        int excelVersion = (int)Application.Version;\n\n        if (excelVersion >= 12)\n        {\n            // Load Ribbon for Office 2007 or later\n            IRibbonExtensibility ribbon = new MyRibbon();\n            ((Excel.IAddIn)ThisAddIn.Instance).RequestComAddInAutomationService(typeof(MyRibbon).FullName);\n        }\n    }\n    catch (Exception ex)\n    {\n        MessageBox.Show("Error loading Ribbon: " + ex.Message);\n    }\n}