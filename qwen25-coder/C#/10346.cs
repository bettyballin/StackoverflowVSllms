using System;\nusing System.Data;\n\npublic static class DataTableExtensions\n{\n    public static void MergeColumns(string format, string mergedColumn, DataTable dt, params string[] columnsToMerge)\n    {\n        if (dt == null) throw new ArgumentNullException(nameof(dt));\n        if (columnsToMerge == null || columnsToMerge.Length < 2) throw new ArgumentException("At least two columns to merge must be specified.", nameof(columnsToMerge));\n\n        // Check that all specified columns exist\n        foreach (var column in columnsToMerge)\n        {\n            if (!dt.Columns.Contains(column))\n                throw new InvalidOperationException($"Column {column} does not exist in the DataTable.");\n        }\n\n        // Avoid adding a duplicate column name if it already exists\n        if (dt.Columns.Contains(mergedColumn) && dt.Columns[mergedColumn].Expression == null)\n        {\n            throw new InvalidOperationException($"Column {mergedColumn} already exists and is not computed.");\n        }\n\n        // Create a DataColumn with an expression based on the format provided\n        var mergedDataColumn = new DataColumn(mergedColumn, typeof(string), string.Format(format, columnsToMerge));\n        \n        // Add the column to the DataTable\n        dt.Columns.Add(mergedDataColumn);\n    }\n}