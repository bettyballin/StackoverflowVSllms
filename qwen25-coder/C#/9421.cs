public static string FormatInts(int[] ints)\n{\n    if (ints == null) throw new ArgumentNullException(nameof(ints));\n    if (ints.Length == 0) return "";\n\n    Array.Sort(ints);\n\n    StringBuilder result = new StringBuilder();\n    int start = ints[0], end = ints[0];\n\n    for (int i = 1; i < ints.Length; i++)\n    {\n        if (ints[i] != end + 1)\n        {\n            AppendRange(result, start, end);\n            start = ints[i];\n        }\n        end = ints[i];\n    }\n\n    AppendRange(result, start, end);\n\n    return result.ToString().Trim();\n}\n\nprivate static void AppendRange(StringBuilder sb, int start, int end)\n{\n    if (start == end)\n        sb.Append($"{start}, ");\n    else\n        sb.Append($"{start}-{end}, ");\n\n    // Remove the trailing comma and space for the last element\n    if (sb[sb.Length - 2] == ',')\n        sb.Remove(sb.Length - 2, 2);\n}