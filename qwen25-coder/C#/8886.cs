using System;\nusing System.Data;\n\npublic class DataSetCopier\n{\n    public static void CopyData(DataSet sourceDataSet, DataSet destinationDataSet, string filterColumn, string filterValue)\n    {\n        // Assuming the sourceDataSet has two tables: Master and Details\n        DataTable masterSourceTable = sourceDataSet.Tables["Master"];\n        DataTable detailsSourceTable = sourceDataSet.Tables["Details"];\n\n        // Create new tables for the destination DataSet if they don't exist\n        DataTable masterDestTable = destinationDataSet.Tables["Master"] ?? \n            destinationDataSet.Tables.Add(masterSourceTable.TableName, masterSourceTable.Columns[0].ColumnName);\n        DataTable detailsDestTable = destinationDataSet.Tables["Details"] ?? \n            destinationDataSet.Tables.Add(detailsSourceTable.TableName, detailsSourceTable.Columns[0].ColumnName);\n\n        // Use a DataView to filter the master rows\n        DataView masterView = new DataView(masterSourceTable);\n        masterView.RowFilter = $"{filterColumn} = '{filterValue}'";\n\n        foreach (DataRowView rowView in masterView)\n        {\n            DataRow sourceRow = rowView.Row;\n            \n            // Create a new row in the destination master table and copy data\n            DataRow destMasterRow = masterDestTable.NewRow();\n            destMasterRow.ItemArray = sourceRow.ItemArray;\n            masterDestTable.Rows.Add(destMasterRow);\n\n            // Get related details rows\n            var detailsRows = detailsSourceTable.Select($"{detailsSourceTable.Columns[0].ColumnName} = {sourceRow[detailsSourceTable.ParentRelations["DetailRelation"].ParentColumns[0]]}");\n            \n            foreach (DataRow detail in detailsRows)\n            {\n                // Create a new row in the destination details table and copy data\n                DataRow destDetailRow = detailsDestTable.NewRow();\n                destDetailRow.ItemArray = detail.ItemArray;\n                detailsDestTable.Rows.Add(destDetailRow);\n            }\n        }\n\n        masterDestTable.AcceptChanges();\n        detailsDestTable.AcceptChanges();\n    }\n}