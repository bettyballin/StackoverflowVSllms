using System;\nusing System.DirectoryServices;\n\npublic class VirtualDirectoryConfigurator\n{\n    public static void ChangeAspNetVersion(string metabasePath, string version)\n    {\n        DirectoryEntry app = new DirectoryEntry(metabasePath);\n        app.Properties["ScriptMaps"].Clear();\n        app.Properties["ScriptMaps"].Add("*.aspx," + GetAspNetVersionPath(version) + "\\aspnet_isapi.dll,1");\n        app.CommitChanges();\n    }\n\n    private static string GetAspNetVersionPath(string version)\n    {\n        switch (version)\n        {\n            case "2.0":\n                return @"C:\Windows\Microsoft.NET\Framework\v2.0.50727";\n            case "3.5":\n                return @"C:\Windows\Microsoft.NET\Framework\v2.0.50727"; // Note: Both 2.0 and 3.5 use the same CLR\n            default:\n                throw new ArgumentException("Unsupported version");\n        }\n    }\n\n    public static void Main()\n    {\n        ChangeAspNetVersion("IIS://localhost/W3SVC/1/ROOT/Reports", "3.5");\n        Console.WriteLine("ASP.NET version changed to 3.5 for the Reports virtual directory.");\n    }\n}