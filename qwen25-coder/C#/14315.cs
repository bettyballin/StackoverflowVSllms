using (SqlConnection connection = new SqlConnection(connectionString))\n{\n    connection.Open();\n    using (SqlCommand command = new SqlCommand(query, connection))\n    {\n        using (SqlDataReader reader = command.ExecuteReader())\n        {\n            while (reader.Read())\n            {\n                // Process the data here.\n            }\n        } // SqlDataReader is closed here\n    } // SqlCommand is disposed of here\n} // SqlConnection is closed and disposed of here