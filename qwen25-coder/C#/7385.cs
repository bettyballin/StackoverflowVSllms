using System;\nusing System.DirectoryServices;\n\nprivate enum IISVersion\n{\n    IIS5,\n    IIS6\n}\n\nprivate void ReadVirtualDirectory(string server, string directory, IISVersion version)\n{\n    string path = string.Empty;\n\n    switch (version)\n    {\n        case IISVersion.IIS5:\n            path = string.Format("IIS://{0}/W3SVC/1/Root", server);\n\n            if (!string.IsNullOrEmpty(directory))\n            {\n                path = string.Concat(path, "/", directory);\n            }\n\n            break;\n\n        case IISVersion.IIS6:\n            path = string.Format("IIS://{0}/W3SVC/1/Root", server); // Assuming default site ID 1 for simplicity\n\n            if (!string.IsNullOrEmpty(directory))\n            {\n                path = string.Concat(path, "/", directory);\n            }\n\n            break;\n    }\n\n    try\n    {\n        using (DirectoryEntry iis = new DirectoryEntry(path))\n        {\n            foreach (PropertyValueCollection property in iis.Properties)\n            {\n                if (property.PropertyName == "ScriptMaps")\n                {\n                    foreach (string scriptMap in property.Value as string[])\n                    {\n                        if (scriptMap.Contains("aspnet_isapi.dll"))\n                        {\n                            Console.WriteLine("Script Map: {0}", scriptMap);\n                            // Example for determining .NET version based on the path\n                            if (scriptMap.ToLower().Contains("v2.0"))\n                            {\n                                Console.WriteLine(".NET Framework Version: 2.0");\n                            }\n                            else if (scriptMap.ToLower().Contains("v1.1"))\n                            {\n                                Console.WriteLine(".NET Framework Version: 1.1");\n                            }\n                            // Add more conditions for other .NET versions as needed\n                        }\n                    }\n                }\n            }\n        }\n    }\n    catch (Exception ex)\n    {\n        Console.WriteLine("An error occurred: {0}", ex.Message);\n    }\n}