public class SettingsRepository\n    {\n        private string _connectionString;\n\n        public SettingsRepository(string connectionString)\n        {\n            _connectionString = connectionString;\n        }\n\n        public string GetSetting(string settingName)\n        {\n            using (var connection = new SqlConnection(_connectionString))\n            {\n                var command = new SqlCommand("SELECT SettingValue FROM ApplicationSettings WHERE SettingName = @SettingName", connection);\n                command.Parameters.AddWithValue("@SettingName", settingName);\n                connection.Open();\n                return command.ExecuteScalar() as string;\n            }\n        }\n    }