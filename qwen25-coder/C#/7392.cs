using System;\nusing System.Data;\nusing Microsoft.SqlServer.Dts.Runtime;\nusing System.Collections.Generic;\nusing System.Data.SqlClient;\n\npublic void Main()\n{\n    string connectionString = Dts.Variables["User::VarB"].Value.ToString();\n    string serverName = string.Empty;\n\n    using (SqlConnection connection = new SqlConnection(connectionString))\n    {\n        try\n        {\n            connection.Open();\n            SqlCommand command = new SqlCommand("SELECT SERVERPROPERTY('ServerName')", connection);\n            serverName = command.ExecuteScalar().ToString();\n        }\n        catch (Exception ex)\n        {\n            Dts.Events.FireInformation(0, "Script Task Example", $"Error: {ex.Message}", string.Empty, 0, ref fireAgain);\n            return;\n        }\n    }\n\n    Dts.Variables["User::VarA"].Value = serverName;\n    Dts.TaskResult = (int)ScriptResults.Success;\n}\n\nenum ScriptResults\n{\n    Success = Microsoft.SqlServer.Dts.Runtime.DTSExecResult.Success,\n    Failure = Microsoft.SqlServer.Dts.Runtime.DTSExecResult.Failure,\n}