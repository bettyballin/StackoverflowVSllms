using System;\nusing Microsoft.Win32;\n\nclass Program\n{\n    private static void Main()\n    {\n        PowerModeChangedEventHandler pmHandler = new PowerModeChangedEventHandler(OnPowerChange);\n        SystemEvents.PowerModeChanged += pmHandler;\n\n        Console.WriteLine("Press Enter to exit...");\n        Console.ReadLine();\n\n        // Unsubscribe before exiting to prevent resource leakage.\n        SystemEvents.PowerModeChanged -= pmHandler;\n    }\n\n    private static void OnPowerChange(object s, PowerModeChangedEventArgs e)\n    {\n        switch (e.Mode)\n        {\n            case PowerModes.ConsoleConnect:\n                // Handle console connect\n                break;\n\n            case PowerModes.ConsoleDisconnect:\n                // Handle console disconnect\n                break;\n\n            case PowerModes.EnterSuspend:\n                // Handle enter suspend\n                break;\n\n            case PowerModes.Resume:\n                // Handle resume\n                break;\n\n            case PowerModes.StatusChange:\n                // Handle status change\n                break;\n        }\n    }\n}