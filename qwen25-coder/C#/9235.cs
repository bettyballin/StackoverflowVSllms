using System;\nusing System.Data;\nusing OfficeOpenXml; // Make sure to install the EPPlus package via NuGet\n\npublic DataTable ReadExcelFromStream(byte[] excelBytes)\n{\n    using (var memoryStream = new System.IO.MemoryStream(excelBytes))\n    {\n        using (var excelPackage = new ExcelPackage(memoryStream))\n        {\n            DataTable dataTable = new DataTable();\n            var worksheet = excelPackage.Workbook.Worksheets[0];\n\n            foreach (var firstRowCell in worksheet.Cells[1, 1, 1, worksheet.Dimension.End.Column])\n            {\n                dataTable.Columns.Add(firstRowCell.Text);\n            }\n\n            for (int rowNum = 2; rowNum <= worksheet.Dimension.End.Row; rowNum++)\n            {\n                var row = worksheet.Cells[rowNum, 1, rowNum, worksheet.Dimension.End.Column];\n                DataRow dataRow = dataTable.NewRow();\n\n                foreach (var cell in row)\n                {\n                    dataRow[cell.Start.Column - 1] = cell.Text;\n                }\n\n                dataTable.Rows.Add(dataRow);\n            }\n\n            return dataTable;\n        }\n    }\n}