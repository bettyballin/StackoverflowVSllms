<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <style>\n        table {\n            width: 100%;\n            border-collapse: collapse;\n        }\n        td, th {\n            border: 1px solid black;\n            padding: 8px;\n        }\n        .error-tooltip {\n            display: none;\n            position: absolute;\n            background-color: red;\n            color: white;\n            padding: 4px;\n            z-index: 1000;\n            font-size: 12px;\n            border-radius: 3px;\n        }\n    </style>\n</head>\n<body>\n<table id="dataGrid">\n    <thead>\n        <tr>\n            <th>Free Text</th>\n            <th>Numeric</th>\n            <th>Enum</th>\n        </tr>\n    </thead>\n    <tbody>\n        <tr>\n            <td><input type="text"></td>\n            <td><input type="text" onblur="validateNumeric(this)" data-error-id="numError1"><span id="numError1" class="error-tooltip">Please enter a valid number</span></td>\n            <td><div contenteditable="true" onclick="showEnumSelect(event)" data-enum-index="0">High</div><select style="display:none;" onchange="updateEnum(this)">\n                    <option>High</option>\n                    <option>Medium</option>\n                    <option>Low</option>\n                </select></td>\n        </tr>\n    </tbody>\n</table>\n\n<script>\nfunction validateNumeric(input) {\n    const value = input.value;\n    if (!(/^\d+$/.test(value))) {\n        document.getElementById(input.dataset.errorId).style.display = 'inline';\n    } else {\n        document.getElementById(input.dataset.errorId).style.display = 'none';\n    }\n}\n\nfunction showEnumSelect(event) {\n    const clickedDiv = event.target;\n    const selectElement = clickedDiv.nextElementSibling;\n\n    // Set the select value based on the current text\n    selectElement.value = clickedDiv.textContent;\n\n    // Show the select element where the div was and hide the div\n    selectElement.style.display = 'inline';\n    clickedDiv.style.display = 'none';\n\n    // Focus the new select box to enable keyboard entry\n    selectElement.focus();\n}\n\nfunction updateEnum(select) {\n    const selectedOption = select.value;\n    const prevSiblingDiv = select.previousElementSibling;\n\n    // Update the div text with the selected option and toggle visibility with the select element\n    prevSiblingDiv.textContent = selectedOption;\n    select.style.display = 'none';\n    prevSiblingDiv.style.display = 'inline';\n\n    // Move focus back to the edited cell for continued editing\n    prevSiblingDiv.focus();\n}\n\ndocument.querySelectorAll("[data-enum-index]").forEach(div => {\n    div.addEventListener('blur', (event) => {\n        const selectElement = event.target.nextElementSibling;\n        if (selectElement.style.display === 'inline') {\n            updateEnum(selectElement);\n        }\n    }, true);\n\n    div.addEventListener('keydown', (e) => {\n        if (e.key === 'Enter' || e.key === 'Escape') {\n            showEnumSelect(e);\n        }\n    });\n});\n</script>\n</body>\n</html>