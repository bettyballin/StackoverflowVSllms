#include <windows.h>\n#include <tlhelp32.h>\n#include <tchar.h>\n\nTCHAR* GetParentProcessName() {\n    static TCHAR buffer[MAX_PATH] = TEXT("");\n    HANDLE hSnapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);\n    if (hSnapshot != INVALID_HANDLE_VALUE) {\n        PROCESSENTRY32 pe;\n        pe.dwSize = sizeof(PROCESSENTRY32);\n        if (Process32First(hSnapshot, &pe)) {\n            do {\n                if (pe.th32ProcessID == GetCurrentProcessId()) {\n                    HANDLE hParent = OpenProcess(PROCESS_QUERY_INFORMATION, FALSE, pe.th32ParentProcessID);\n                    if (hParent) {\n                        HMODULE hMod;\n                        DWORD cbNeeded;\n\n                        if (EnumProcessModules(hParent, &hMod, sizeof(hMod), &cbNeeded)) {\n                            GetModuleBaseName(hParent, hMod, buffer, MAX_PATH);\n                        }\n                        CloseHandle(hParent);\n                        break;\n                    }\n                }\n            } while (Process32Next(hSnapshot, &pe));\n        }\n        CloseHandle(hSnapshot);\n    }\n    return buffer;\n}