ISmth* pSmth = NULL; \nHRESULT hr = pObj->GetSmth(&pSmth); // Capture the HRESULT to check for errors\n\nif (SUCCEEDED(hr) && pSmth)\n{ \n    pSmth->Foo();\n    pSmth->Release();\n}\nelse if (pSmth)  // This block is generally unnecessary due to how COM works\n{\n    pSmth->Release();  // Only execute if you are sure this code path can be reached with a non-NULL pointer on failure\n}