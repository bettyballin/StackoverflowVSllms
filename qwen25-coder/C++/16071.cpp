#include <windows.h>\n#include <gdiplus.h>\nusing namespace Gdiplus;\n\nvoid CaptureWindow(HWND hWnd) {\n    HDC hdcScreen = GetDC(NULL);\n    HDC hdcMem = CreateCompatibleDC(hdcScreen);\n\n    RECT rect;\n    GetWindowRect(hWnd, &rect);\n    int width = rect.right - rect.left;\n    int height = rect.bottom - rect.top;\n\n    HBITMAP hbmScreen = CreateCompatibleBitmap(hdcScreen, width, height);\n    BITMAPINFOHEADER bi = {0};\n    bi.biSize        = sizeof(BITMAPINFOHEADER);\n    bi.biWidth       = width;\n    bi.biHeight      = -height; // Minus here is important.\n    bi.biPlanes      = 1;\n    bi.biBitCount    = 32;\n    bi.biCompression = BI_RGB;\n\n    SelectObject(hdcMem, hbmScreen);\n\n    BitBlt(hdcMem, 0, 0, width, height, hdcScreen, rect.left, rect.top, SRCCOPY);\n\n    Image* pBitmap = new Bitmap(hbmScreen, NULL);\n    pBitmap->Save(L"window_capture.png", &CLSID_EncoderPng, NULL);\n\n    delete pBitmap;\n    DeleteObject(hbmScreen);\n    DeleteDC(hdcMem);\n    ReleaseDC(NULL, hdcScreen);\n}