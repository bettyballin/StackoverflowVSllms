#include <windows.h>\n\nint main() {\n    HMODULE hModule = LoadLibrary(TEXT("foo.dll")); // Step 1\n    if (hModule == NULL) return -1;\n\n    typedef void* (*CreateObjectFunc)();\n    CreateObjectFunc createObject = reinterpret_cast<CreateObjectFunc>(GetProcAddress(hModule, "CreateObject")); // Step 2\n    if (!createObject) {\n        FreeLibrary(hModule);\n        return -1;\n    }\n\n    IUnknown* pObject = static_cast<IUnknown*>(createObject()); // Step 3: Assume CreateObject returns a COM object\n    if (!pObject) {\n        FreeLibrary(hModule);\n        return -1;\n    }\n\n    FreeLibrary(hModule); // Step 4\n\n    // Step 5: This may cause an AV or undefined behavior\n    HRESULT hr = pObject->QueryInterface(IID_IUnknown, reinterpret_cast<void**>(&pObject));\n    if (FAILED(hr)) {\n        pObject->Release();\n        return -1;\n    }\n\n    pObject->Release(); // Clean up\n\n    return 0;\n}