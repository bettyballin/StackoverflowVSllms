#include <windows.h>\n#include <tchar.h>\n\nint main() {\n    SC_HANDLE schManager = OpenSCManager(NULL, NULL, SC_MANAGER_CREATE_SERVICE);\n    if (schManager == NULL) {\n        _tprintf(_T("OpenSCManager failed (%d)\n"), GetLastError());\n        return 1;\n    }\n\n    SC_HANDLE schService = CreateService(\n        schManager,\n        _T("YourServiceName"),\n        _T("Display Name of Service"),\n        SERVICE_QUERY_STATUS | DELETE,\n        SERVICE_WIN32_OWN_PROCESS, // service type\n        SERVICE_AUTO_START,\n        SERVICE_ERROR_NORMAL,\n        _T("Path\\To\\ExeName.exe"), // full path to the .exe file\n        NULL,\n        NULL,\n        NULL,\n        NULL,\n        NULL);\n\n    if (schService == NULL && GetLastError() != ERROR_SERVICE_EXISTS) {\n        CloseServiceHandle(schManager);\n        _tprintf(_T("CreateService failed (%d)\n"), GetLastError());\n        return 1;\n    } else if (schService != NULL) {\n        CloseServiceHandle(schService);\n    }\n\n    CloseServiceHandle(schManager);\n\n    _tprintf(_T("Created service\n"));\n    return 0;\n}