#include <windows.h>\n#include <mmdeviceapi.h>\n#include <Audioclient.h>\n#include <functiondiscoverykeys_devpkey.h>\n#include <comdef.h>\n\nclass CSessionListener : public IAudioSessionNotification {\npublic:\n    ULONG STDMETHODCALLTYPE AddRef() { return 1; }\n    ULONG STDMETHODCALLTYPE Release() { return 1; }\n    HRESULT STDMETHODCALLTYPE QueryInterface(REFIID riid, void **ppvObject) {\n        if (__uuidof(IUnknown) == riid || __uuidof(IAudioSessionNotification) == riid) {\n            *ppvObject = static_cast<IAudioSessionNotification*>(this);\n            AddRef();\n            return S_OK;\n        }\n        *ppvObject = NULL;\n        return E_NOINTERFACE;\n    }\n\n    HRESULT STDMETHODCALLTYPE OnSessionCreated(IAudioSessionControl *NewSession) {\n        // Handle new session creation\n        return S_OK;\n    }\n};\n\nint main() {\n    BOOL success = false;\n    HRESULT hr;\n    IMMDeviceEnumerator* pEnumerator = NULL;\n    IMMDevice* pDevice = NULL;\n    IAudioSessionManager2* pManager = NULL;\n\n    CoInitialize(NULL);\n\n    hr = CoCreateInstance(__uuidof(MMDeviceEnumerator), NULL, CLSCTX_ALL, __uuidof(IMMDeviceEnumerator), (void**)&pEnumerator);\n    if (FAILED(hr)) goto cleanup;\n\n    hr = pEnumerator->GetDefaultAudioEndpoint(eRender, eConsole, &pDevice);\n    if (FAILED(hr)) goto cleanup;\n\n    hr = pDevice->Activate(__uuidof(IAudioSessionManager2), CLSCTX_ALL, NULL, (void**)&pManager);\n    if (FAILED(hr)) goto cleanup;\n\n    CSessionListener* listener = new CSessionListener();\n    hr = pManager->RegisterSessionNotification(listener);\n    if (FAILED(hr)) {\n        delete listener;\n        goto cleanup;\n    }\n\n    // Your monitoring code here...\n    // Unregister session notification when done\n    pManager->UnregisterSessionNotification(listener);\n\n    success = true;\n\ncleanup:\n    SAFE_RELEASE(pEnumerator);\n    SAFE_RELEASE(pDevice);\n    SAFE_RELEASE(pManager);\n    if (!success) {\n        printf("An error occurred: 0x%lx\n", hr);\n    }\n    CoUninitialize();\n\n    return 0;\n}