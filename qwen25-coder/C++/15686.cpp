#include <windows.h>\n#include <comdef.h>\n\nint main() {\n    CoInitialize(NULL);\n\n    try {\n        // Create an instance of Excel application.\n        _ApplicationPtr excelApp("Excel.Application");\n        excelApp->Visible = TRUE;\n\n        // Get Workbooks collection.\n        WorkbooksPtr workbooks = excelApp->Workbooks;\n\n        // Add a new Workbook.\n        _WorkbookPtr workbook = workbooks->Add();\n\n        // Get the Sheets collection of the active workbook.\n        SheetsPtr sheets = workbook->Sheets;\n\n        // Add a new sheet.\n        _WorksheetPtr newSheet;\n        newSheet = sheets->Add();\n        \n        // Optionally, you can set some value to see which is active.\n        _variant_t index1((short)1);\n        _WorkbookPtr workbookRef = newSheet->Parent;\n        WorksheetPtr firstSheet = workbookRef->Worksheets->Item[index1];\n        firstSheet->Cells->Item[1][1] = "First Sheet";\n\n        // Get the currently active sheet by using ActiveSheet property.\n        _WorksheetPtr activeSheet = excelApp->ActiveSheet;\n\n        // Get the Index of the active sheet.\n        long activeSheetIndex = activeSheet->Index;\n        \n        // Output to verify\n        wprintf(L"The index of the active worksheet is: %d\n", activeSheetIndex);\n\n        // Clean up and close Excel application.\n        workbook->Close();\n        excelApp->Quit();\n    }\n    catch (_com_error& e) {\n        std::wcout << L"Error: " << (const wchar_t*)e.Description() << std::endl;\n    }\n\n    CoUninitialize();\n\n    return 0;\n}