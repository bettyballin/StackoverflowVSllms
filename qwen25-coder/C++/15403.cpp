#include <windows.h>\n#include <gdiplus.h>\nusing namespace Gdiplus;\n\nBOOL LoadGDIPlus() {\n    OSVERSIONINFO osvi;\n    ZeroMemory(&osvi, sizeof(OSVERSIONINFO));\n    osvi.dwOSVersionInfoSize = sizeof(OSVERSIONINFO);\n\n    if (!GetVersionEx(&osvi)) {\n        return FALSE; // Failed to determine the version of Windows\n    }\n\n    // Check if the OS is older than Windows XP (Windows 2000 or earlier)\n    if (osvi.dwMajorVersion < 5 || (osvi.dwMajorVersion == 5 && osvi.dwMinorVersion == 0)) {\n        // Load GDIPlus from the application directory\n        return LoadLibrary(TEXT("gdiplus.dll")) != NULL;\n    }\n\n    // For Windows XP and later, rely on the system's GDIPlus version\n    return TRUE;\n}\n\nint main() {\n    GdiplusStartupInput gdiplusStartupInput;\n    ULONG_PTR             gdiplusToken;\n\n    if (!LoadGDIPlus()) {\n        MessageBox(NULL, TEXT("Failed to load GDI+"), NULL, MB_ICONERROR);\n        return 1; // Return an error code\n    }\n\n    // Initialize GDI+\n    GdiplusStartup(&gdiplusToken, &gdiplusStartupInput, NULL);\n\n    // Your application logic goes here\n\n    // Shutdown GDI+\n    GdiplusShutdown(gdiplusToken);\n    return 0;\n}