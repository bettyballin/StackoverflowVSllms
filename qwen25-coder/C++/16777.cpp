STDAPI DllGetClassObject(REFCLSID rclsid, REFIID riid, void **ppv)\n{\n    HRESULT hr = E_FAIL;\n\n    if (IsEqual CLSID_YourComObjectClass, rclsid))\n    {\n        CComObject<CYourComObjectClass> *pObj;\n        pObj = new CComObject<CYourComObjectClass>;\n        if (pObj == NULL) return E_OUTOFMEMORY;\n\n        hr = pObj->QueryInterface(riid, ppv);\n        // Since each object holds its own session state,\n        // no need to lock or manage across instances.\n    }\n\n    return hr;\n}