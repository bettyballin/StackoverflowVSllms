#include <windows.h>\n#include <aclapi.h>\n\nvoid RestoreSecurityAttributes(LPCWSTR pszSourceFile, LPCWSTR pszTargetFile) {\n    PSECURITY_DESCRIPTOR pSD = NULL;\n    DWORD dwSizeNeeded;\n\n    // Get the security descriptor from the source file.\n    if (!GetNamedSecurityInfo(\n        pszSourceFile,\n        SE_FILE_OBJECT,\n        DACL_SECURITY_INFORMATION | OWNER_SECURITY_INFORMATION | GROUP_SECURITY_INFORMATION,\n        NULL,                                   // no owner info\n        NULL,                                   // no group info\n        (PACL*)&pSD,                            // Dacl info from the source file\n        NULL,\n        &dwSizeNeeded)) {\n        \n        if (GetLastError() == ERROR_INSUFFICIENT_BUFFER) {\n            delete[] pSD;\n            pSD = new BYTE[dwSizeNeeded];\n            if (!GetNamedSecurityInfo(\n                pszSourceFile,\n                SE_FILE_OBJECT,\n                DACL_SECURITY_INFORMATION | OWNER_SECURITY_INFORMATION | GROUP_SECURITY_INFORMATION,\n                NULL,                          // no owner info\n                NULL,                          // no group info\n                (PACL*)&pSD,                   // Dacl info from the source file\n                NULL,\n                &dwSizeNeeded)) {\n                // Failed again. Handle the error.\n            }\n        } else {\n            // Handle other errors getting the security info.\n        }\n    }\n\n    if (pSD) {\n        // Set the security descriptor on the target file.\n        if (!SetNamedSecurityInfo(\n            pszTargetFile,\n            SE_FILE_OBJECT,\n            DACL_SECURITY_INFORMATION | OWNER_SECURITY_INFORMATION | GROUP_SECURITY_INFORMATION,\n            NULL,                  // no owner info\n            NULL,                  // no group info\n            (PACL)pSD,             // use dacl info from the source file.\n            NULL)) {\n            // Failed to set security descriptor. Handle the error.\n        }\n\n        LocalFree(pSD);\n    }\n}