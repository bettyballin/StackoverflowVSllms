unsigned int column_index(unsigned int i, unsigned int M) {\n       // Find the row index first\n       unsigned int r = (static_cast<int>(sqrt(1 + 8 * i)) - 1) / 2;\n       \n       // Calculate how many elements are in all rows up to but not including row r\n       unsigned int cumulative_previous_elements = r * (r + 1) / 2;\n       \n       // Subtract the number of elements in previous rows from i to get column index within the row\n       return i - cumulative_previous_elements;\n   }