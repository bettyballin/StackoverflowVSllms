#include <windows.h>\n#include <tchar.h>\n#include <stdio.h>\n\nint main() {\n    HKEY hKey;\n    // Use TEXT macro for Unicode compatibility\n    LPTSTR sk = TEXT("SOFTWARE\\TestSoftware");\n    LPSECURITY_ATTRIBUTES lpSecurityAttributes = NULL;\n\n    LONG openRes = RegOpenKeyEx(HKEY_LOCAL_MACHINE, sk, 0, KEY_ALL_ACCESS, &hKey);\n\n    if (openRes != ERROR_SUCCESS) {\n        // Try creating the key if it doesn't exist\n        openRes = RegCreateKeyEx(HKEY_LOCAL_MACHINE, sk, 0, NULL, REG_OPTION_NON_VOLATILE,\n                                 KEY_ALL_ACCESS, lpSecurityAttributes, &hKey, NULL);\n    }\n\n    if (openRes == ERROR_SUCCESS) {\n        _tprintf(_T("Success opening/creating key.\n"));\n    } else {\n        _tprintf(_T("Error opening/creating key: %ld\n"), openRes);\n        return 1;\n    }\n\n    LPTSTR value = TEXT("TestSoftwareKey");\n    LPTSTR data = TEXT("TestData");\n\n    // Use _tcslen for Unicode compatibility\n    LONG setRes = RegSetValueEx(hKey, value, 0, REG_SZ, (LPBYTE)data, (_tcslen(data) + 1) * sizeof(TCHAR));\n\n    if (setRes == ERROR_SUCCESS) {\n        _tprintf(_T("Success writing to Registry.\n"));\n    } else {\n        _tprintf(_T("Error writing to Registry: %ld\n"), setRes);\n    }\n\n    LONG closeOut = RegCloseKey(hKey);\n\n    if (closeOut == ERROR_SUCCESS) {\n        _tprintf(_T("Success closing key.\n"));\n    } else {\n        _tprintf(_T("Error closing key: %ld\n"), closeOut);\n    }\n\n    return 0;\n}