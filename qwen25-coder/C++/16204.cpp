bool g_bMessageLoopRunning = false;\n\nvoid StartLibraryMessageLoop()\n{\n    if (!g_bMessageLoopRunning)\n    {\n        // Set flag before starting loop.\n        g_bMessageLoopRunning = true;\n        \n        // Your event filtering logic here, possibly calling a custom message loop.\n        \n        // Clear flag after loop ends.\n        g_bMessageLoopRunning = false;\n    }\n}\n\nvoid AttachToExistingMessageLoop()\n{\n    if (g_bMessageLoopRunning)\n    {\n        // Attach your event filtering to the existing message loop.\n    }\n}