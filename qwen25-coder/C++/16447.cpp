// Allocate a BSTR directly\nBSTR bstr = ::SysAllocString(someString.c_str());\n\n// Initialize VARIANT with the BSTR and indicate that COM should manage it\nVARIANT varProperty;\n::VariantInit(&varProperty);\nvarProperty.vt = VT_BSTR;\nvarProperty.bstrVal = bstr;\n\n// Add the property to the bag\npPrintPropertyBag->AddProperty(L"SOME_PROPERTY", &varProperty);\n\n// No need to free the BSTR here because VARIANT manages it when passed to COM.