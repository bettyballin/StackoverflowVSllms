#include <vcl.h>\n#pragma hdrstop\n#include <registry.hpp>\n\nvoid WriteToRegistry(const UnicodeString& path, const UnicodeString& valueName, const UnicodeString& data)\n{\n    TRegistry *Reg = new TRegistry;\n    try\n    {\n        Reg->RootKey = HKEY_CURRENT_USER; // Change this to another root key if necessary\n        if (Reg->OpenKey(path, true)) // Use false here if you don't want to create the key\n        {\n            Reg->WriteString(valueName, data);\n        }\n    }\n    __finally\n    {\n        delete Reg;\n    }\n}\n\n// Example usage:\n// WriteToRegistry("Software\\MyApp", "LastDirectory", "C:\\Users\\Example");