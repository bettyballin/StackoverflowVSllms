#include <atlbase.h>\n\n// Assuming this is a free function adapter for IDispatch::GetTypeInfoCount\nHRESULT GetComUintGetter(IDispatch* pDispatch, UINT* pu) {\n    return pDispatch->GetTypeInfoCount(pu);\n}\n\nvoid update(HRESULT(*com_uint_getter)(IDispatch*, UINT*), IDispatch* pDispatch, UINT& u) {\n    UINT tmp;\n    if (S_OK == com_uint_getter(pDispatch, &tmp)) {\n        u = tmp;\n    }\n}\n\n// only for compile purpose, it will not work at runtime\nint main(int, char*[]) {\n    CComPtr<IDispatch> ptr;\n    UINT u;\n\n    // Use the adapter function that wraps the IDispatch::GetTypeInfoCount method\n    update(GetComUintGetter, ptr, u);\n\n    return 0;\n}