#include "stdafx.h"\n#include "resource.h"\n#include "MainFrm.h"\n\n// ...\n\nBEGIN_COM_MAP(CMainFrame)\n    COM_INTERFACE_ENTRY(IRtdServer)\nEND_COM_MAP()\n\nULONG STDMETHODCALLTYPE CMainFrame::AddRef()\n{\n    return InterlockedIncrement(&m_lObjectCount);\n}\n\nULONG STDMETHODCALLTYPE CMainFrame::Release()\n{\n    ULONG lCount = InterlockedDecrement(&m_lObjectCount);\n    if (lCount == 0) delete this;\n    \n    return lCount;\n}\n\nHRESULT STDMETHODCALLTYPE CMainFrame::QueryInterface(REFIID riid, void** ppv)\n{\n    HRESULT hr = E_NOINTERFACE;\n\n    if (ppv != NULL)\n    {\n        if (!memcmp(&riid, &IID_IUnknown, sizeof(GUID)) ||\n            !memcmp(&riid, &IID_IRtdServer, sizeof(GUID)))\n        {\n            *ppv = static_cast<IRtdServer*>(this);\n            AddRef();\n\n            hr = S_OK;\n        }\n    }\n\n    return hr;\n}\n\nHRESULT STDMETHODCALLTYPE CMainFrame::OnWizardOpen()\n{\n    // ...\n    return S_OK;\n}\n\n// Implement other IRtdServer methods