for (long i = min; i <= max; i++) {\n    IMyInterface* l = nullptr;\n    HRESULT hr = SafeArrayGetElement(array, &i, reinterpret_cast<void*>(&l));\n    if (SUCCEEDED(hr) && l != nullptr) {\n        // Use l here.\n\n        // Release the COM object when done.\n        l->Release();\n    }\n}\n// Don't forget to destroy the SafeArray when you're done with it.\nSafeArrayDestroy(array);