// MyObject.cpp\n#include <windows.h>\n#include "resource.h"\n#include "MyObject_i.c"\n\nclass ATL_NO_VTABLE CMyObject :\n    public CComObjectRootEx<CComSingleThreadModel>,\n    public IDispatchImpl<IMyObject, &IID_IMyObject, &LIBID_MyObjectLib>\n{\npublic:\n    STDMETHOD(DoSomething)(BSTR* pResult)\n    {\n        if(!pResult) return E_POINTER;\n        *pResult = SysAllocString(L"Hello from MyObject!");\n        return S_OK;\n    }\n};\n\n// Object map\nBEGIN_COM_MAP(CMyObject)\n    COM_INTERFACE_ENTRY(IMyObject)\n    COM_INTERFACE_ENTRY(IDispatch)\nEND_COM_MAP()\n\nOBJECT_ENTRY_NON_CREATEABLE_EX_AUTO(__uuidof(MyObject), CMyObject)\n\n// Main Server Registration Code\nCComModule _Module;\n\nBEGIN_OBJECT_MAP(ObjectMap)\n    OBJECT_ENTRY(__uuidof(MyObject), CMyObject)\nEND_OBJECT_MAP()\n\nextern "C" BOOL WINAPI DllMain(HINSTANCE hInstance, DWORD dwReason, LPVOID lpReserved)\n{\n    _Module.Init(ObjectMap, hInstance);\n    return TRUE;\n}