#include <windows.h>\n#include <iostream>\n\nbool CanWriteToRegistry(HKEY hKey, const std::wstring& subKeyPath) {\n    HKEY hSubKey;\n    LONG result = RegOpenKeyEx(hKey, subKeyPath.c_str(), 0, KEY_WRITE, &hSubKey);\n    \n    if (result == ERROR_SUCCESS) {\n        // Successfully opened with write access\n        RegCloseKey(hSubKey); // Clean up\n        return true;\n    }\n    \n    return false;\n}\n\nint main() {\n    std::wstring localMachinePath = L"SOFTWARE\\TestKey";\n    std::wstring currentUserPolicyPath = L"Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer";\n\n    if (CanWriteToRegistry(HKEY_LOCAL_MACHINE, localMachinePath)) {\n        std::wcout << L"The current user can write to HKEY_LOCAL_MACHINE\\" << localMachinePath << std::endl;\n    } else {\n        std::wcerr << L"The current user cannot write to HKEY_LOCAL_MACHINE\\" << localMachinePath << std::endl;\n    }\n\n    if (CanWriteToRegistry(HKEY_CURRENT_USER, currentUserPolicyPath)) {\n        std::wcout << L"The current user can write to HKEY_CURRENT_USER\\" << currentUserPolicyPath << std::endl;\n    } else {\n        std::wcerr << L"The current user cannot write to HKEY_CURRENT_USER\\" << currentUserPolicyPath << std::endl;\n    }\n\n    return 0;\n}