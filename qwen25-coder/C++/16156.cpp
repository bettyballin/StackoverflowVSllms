#include <objbase.h>\nIUnknown* pUnk = nullptr;\nhr = CLSIDFromProgID(L"MyApplication.MyObject", &clsid);\nif (FAILED(hr)) {\n    CoUninitialize();\n    return -1; // Failed to get CLSID.\n}\n\nIClassFactory* pClassFactory;\nhr = CoGetClassObject(clsid, CLSCTX_INPROC_SERVER | CLSCTX_LOCAL_SERVER,\n                      NULL, IID_IClassFactory, (void**)&pClassFactory);\nif (FAILED(hr)) {\n    CoUninitialize();\n    return -1; // Failed to obtain class factory.\n}\n\nIDispatch* pDisp;\nhr = pClassFactory->CreateInstance(NULL, IID_IDispatch, (void**)&pDisp);\npClassFactory->Release(); /// Release class factory