// This is an aggregated object (inner)\nclass CInnerObject : public IUnknown {\npublic:\n    // Implement IUnknown methods and other interfaces\n};\n\n// This is the outer, aggregateable object\nclass CAggregator : public IOuterUnknown {\nprivate:\n    CInnerObject* pInner;\n\npublic:\n    CAggregator() { \n        pInner = new CInnerObject(); \n        // Initialize\n    }\n\n    virtual ~CAggregator() { \n        delete pInner; \n    }\n\n    // IUnknown methods on outer object\n    STDMETHOD_(HRESULT, QueryInterface)(REFIID riid, void** ppvObject) {\n        if (riid == IID_IOuterUnknown) {\n            *ppvObject = static_cast<IOuterUnknown*>(this);\n            AddRef();\n            return S_OK;\n        }\n        // Delegate to the inner object\n        return pInner->QueryInterface(riid, ppvObject);\n    }\n\n    STDMETHOD_(ULONG, AddRef)();\n    STDMETHOD_(ULONG, Release)();\n\n    // Other interfaces of CAggregator...\n};