using namespace System;\nusing namespace msclr::interop;\n\npublic ref class ManagedDatabaseConnection : public IDisposable\n{\nprivate:\n    CDatabaseConnection* _comObj;\n    bool _disposed;\n\npublic:\n    ManagedDatabaseConnection(CDatabaseConnection* comObj)\n        : _comObj(comObj), _disposed(false) {}\n\n    ~ManagedDatabaseConnection()\n    {\n        if (!_disposed)\n        {\n            Dispose(true);\n        }\n    }\n\nprotected:\n    virtual void Dispose(bool disposing)\n    {\n        if (_disposed)\n            return;\n\n        if (disposing)\n        {\n            // Free managed resources here, if any.\n        }\n\n        _comObj->CloseConnection();\n        delete _comObj;\n        _disposed = true;\n    }\n\npublic:\n    !ManagedDatabaseConnection()\n    {\n        Dispose(false);\n        GC::SuppressFinalize(this);\n    }\n};