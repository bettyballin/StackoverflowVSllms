STDMETHODIMP MyComClass::GetDIB(BYTE* pBytes, ULONG bufferSize, ULONG* pWritten)\n{\n    // Assume 'dibData' is your byte array containing the DIB and 'dibSize' its size.\n    const BYTE* dibData = ...; // Your DIB data\n    ULONG dibSize = ...;       // Size of the dibData\n\n    if (!pBytes || !bufferSize || !pWritten)\n        return E_POINTER;\n\n    if (bufferSize < dibSize)\n        return S_FALSE; // Buffer too small\n\n    memcpy(pBytes, dibData, dibSize);\n    *pWritten = dibSize;\n    return S_OK;\n}