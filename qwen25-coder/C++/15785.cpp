input: pInputDC\noutput: pOutputMemDC\n\n{\n    pOutputMemDC = new CDC();\n    VERIFY(pOutputMemDC->CreateCompatibleDC(pInputDC));\n\n    CRect rect(0, 0, nDCWidth, nDCHeight);\n    BITMAPINFO bmi;\n    memset(&bmi.bmiHeader, 0, sizeof(BITMAPINFOHEADER));\n    bmi.bmiHeader.biSize = sizeof(BITMAPINFOHEADER);\n    bmi.bmiHeader.biWidth = rect.Width();\n    bmi.bmiHeader.biHeight = -rect.Height(); // Negative for top-down DIB\n    bmi.bmiHeader.biPlanes = 1;\n    bmi.bmiHeader.biBitCount = 32; // Use 32-bit ARGB format\n\n    void* pBits = NULL;\n    HBITMAP bitmap = CreateDIBSection(pInputDC, &bmi, DIB_RGB_COLORS, (void**)&pBits, 0, 0);\n    if (!bitmap) {\n        // Handle error: failed to create DIB section\n    } else {\n        m_pOldBitmap = pOutputMemDC->SelectObject(&CBitmap::FromHandle(bitmap));\n        CBrush brush;\n        VERIFY(brush.CreateSolidBrush(RGB(255, 0, 0)));\n        brush.UnrealizeObject();\n        pOutputMemDC->FillRect(rect, &brush);\n    }\n}