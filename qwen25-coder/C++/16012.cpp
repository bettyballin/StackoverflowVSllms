#include <windows.h>\n#include <objbase.h>\n\n// Assume MyObject is a class you have defined or imported via headers.\nIUnknown* pMyObject = nullptr;\n\nHRESULT CreateAndCacheCOMObject() {\n    HRESULT hr = CoCreateInstance(\n        CLSID_MyObject, \n        nullptr,\n        CLSCTX_INPROC_SERVER | CLSCTX_LOCAL_SERVER,\n        IID_PPV_ARGS(&pMyObject)\n    );\n\n    if (FAILED(hr)) {\n        // Handle error\n        return hr;\n    }\n\n    // Now pMyObject holds the reference to your COM object.\n    // You can call methods on pMyObject directly.\n\n    // Ensure you Release() the interface pointer when done.\n    // For example, in a cleanup or destructor:\n    // if (pMyObject) { pMyObject->Release(); pMyObject = nullptr; }\n\n    return hr;\n}\n\nint main() {\n    CoInitialize(nullptr);\n\n    HRESULT hr = CreateAndCacheCOMObject();\n    if (FAILED(hr)) {\n        wprintf(L"Failed to create COM object. Error code: 0x%X\n", hr);\n        return -1;\n    }\n\n    // Perform operations using pMyObject\n    // ...\n\n    CoUninitialize();\n\n    return 0;\n}