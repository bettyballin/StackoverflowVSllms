STDMETHODIMP YourDispatchHandler::Invoke(DISPID dispIdMember,\n                                        REFIID riid,\n                                        LCID lcid,\n                                        WORD wFlags,\n                                        DISPPARAMS* pDispParams,\n                                        VARIANT* pVarResult,\n                                        EXCEPINFO* pExcepInfo,\n                                        UINT* puArgErr)\n{\n    // Handle the onmouseup event\n    if (dispIdMember == DISPID_DOCUMENTEVENT_ONMOUSEUP) {\n        if (pDispParams && pDispParams->cArgs > 0) {\n            VARIANTARG& arg = pDispParams->rgvarg[pDispParams->cArgs - 1];\n            if (arg.vt == VT_DISPATCH) {\n                IHTMLEventObj* pEventObj;\n                HRESULT hr = arg.pdispVal->QueryInterface(IID_IHTMLEventObj, (void**)&pEventObj);\n                if (SUCCEEDED(hr)) {\n                    // Successfully obtained the event object\n                    // Use pEventObj to get mouse details\n\n                    // Remember to release the interface when done\n                    pEventObj->Release();\n                }\n            }\n        } else {\n            // No arguments received, which might be an issue\n        }\n    }\n\n    return S_OK;\n}