STDMETHODIMP CMyDispatch::Invoke(DISPID dispIdMember, REFIID riid, LCID lcid, WORD wFlags,\n                                 DISPPARAMS* pDispParams, VARIANT* pVarResult,\n                                 EXCEPINFO* pExcepInfo, UINT* puArgErr)\n{\n    if (wFlags & DISPATCH_PROPERTYPUT) {\n        ASSERT(pDispParams->cArgs == 1);\n        ASSERT(pDispParams->rgvarg[0].vt == VT_DISPATCH);\n\n        IDispatch* pDispatch = pDispParams->rgvarg[0].pdispVal;\n        CMyDispatch* pMyDispatch = nullptr;\n\n        // Safely query for the CMyDispatch interface\n        HRESULT hr = pDispatch->QueryInterface(IID_PPV_ARGS(&pMyDispatch));\n        if (SUCCEEDED(hr)) {\n            // Now you can use pMyDispatch as a pointer to your CMyDispatch object\n            // Remember to release the interface when done!\n            pMyDispatch->Release();\n        }\n    }\n\n    return S_OK;\n}