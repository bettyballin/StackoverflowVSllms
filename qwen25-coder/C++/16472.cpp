#include <windows.h>\n#include <iostream>\n\nbool SetProtectedAttribute(const std::wstring& path, bool isProtected) {\n    DWORD attributes = GetFileAttributes(path.c_str());\n    if (attributes == INVALID_FILE_ATTRIBUTES) {\n        std::wcerr << L"Failed to get file attributes: " << GetLastError() << std::endl;\n        return false;\n    }\n\n    if (isProtected) {\n        attributes |= FILE_ATTRIBUTE_SYSTEM; // Mark as protected\n    } else {\n        attributes &= ~FILE_ATTRIBUTE_SYSTEM; // Unmark as protected\n    }\n\n    if (!SetFileAttributes(path.c_str(), attributes)) {\n        std::wcerr << L"Failed to set file attributes: " << GetLastError() << std::endl;\n        return false;\n    }\n    return true;\n}