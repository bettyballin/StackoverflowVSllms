#include <windows.h>\n#include <iostream>\n\nint main()\n{\n    HMODULE hMod = nullptr;\n\n    // Conditionally load the DLL at runtime\n    if (someCondition) {\n        hMod = LoadLibrary(TEXT("YourComDll.dll"));\n        if (!hMod) {\n            std::cerr << "Failed to load DLL\n";\n            return 1;\n        }\n        \n        // Create an instance of a COM object\n        CLSID clsid;\n        HRESULT hr = CLSIDFromProgID(L"YourComObjectProgId", &clsid);\n        if (FAILED(hr)) {\n            std::cerr << "CLSIDFromProgID failed\n";\n            FreeLibrary(hMod);\n            return 1;\n        }\n\n        IUnknown* pUnk = nullptr;\n        hr = CoCreateInstance(clsid, NULL, CLSCTX_INPROC_SERVER, IID_PPV_ARGS(&pUnk));\n        if (FAILED(hr)) {\n            std::cerr << "CoCreateInstance failed\n";\n            FreeLibrary(hMod);\n            return 1;\n        }\n\n        // Use the COM object here...\n\n        // Release the COM object\n        pUnk->Release();\n    }\n\n    // Unload the DLL when done\n    if (hMod) {\n        FreeLibrary(hMod);\n    }\n\n    return 0;\n}