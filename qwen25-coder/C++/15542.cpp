#include "stdafx.h"\n#include "resource.h"\n#include "MyComObject_i.c"\n#include "MyComObject.h"\n\nSTDMETHODIMP CMyComObject::getByteArray(SAFEARRAY** ppsaData)\n{\n    // Prepare the SAFEARRAY of BYTE\n    SAFEARRAYBOUND sab = {1024, 0}; // Array size of 1024 bytes\n    SAFEARRAY* psa = SafeArrayCreate(VT_UI1, 1, &sab);\n\n    if (psa == NULL) {\n        return E_OUTOFMEMORY;\n    }\n\n    BYTE* pbData;\n    HRESULT hr = SafeArrayAccessData(psa, (void**)&pbData);\n    if (SUCCEEDED(hr)) {\n        // Fill the array with data. Example: fill with a pattern or actual data\n        for (ULONG i = 0; i < sab.cElements; i++) {\n            pbData[i] = static_cast<BYTE>(i % 256); // Example data\n        }\n        SafeArrayUnaccessData(psa);\n    } else {\n        SafeArrayDestroy(psa);\n        return hr;\n    }\n\n    *ppsaData = psa;\n    return S_OK;\n}