#include <comdef.h>\n#include <iostream>\n\nbool AreSameComInstance(IUnknown* p1, IUnknown* p2) {\n    if (!p1 || !p2) return false;\n\n    IUnknown* pUnk1 = nullptr;\n    IUnknown* pUnk2 = nullptr;\n\n    HRESULT hr1 = p1->QueryInterface(__uuidof(IUnknown), reinterpret_cast<void**>(&pUnk1));\n    HRESULT hr2 = p2->QueryInterface(__uuidof(IUnknown), reinterpret_cast<void**>(&pUnk2));\n\n    if (SUCCEEDED(hr1) && SUCCEEDED(hr2)) {\n        bool areSame = (pUnk1 == pUnk2);\n        pUnk1->Release();\n        pUnk2->Release();\n        return areSame;\n    }\n\n    if (pUnk1) pUnk1->Release();\n    if (pUnk2) pUnk2->Release();\n    return false;\n}\n\nint main() {\n    // Example usage:\n    // IUnknown* ptr1 and ptr2 obtained from somewhere\n    // bool result = AreSameComInstance(ptr1, ptr2);\n}