static const wchar_t* Text = L"Sample";\nSTDMETHODIMP CImpl::GetText( ULONG* bufferLength, WCHAR* buffer )\n{\n    int length = wcslen(Text) + 1; // Include space for the null terminator\n    if (*bufferLength < length)\n        return E_INVALIDARG; // Buffer not large enough\n\n    *bufferLength = length;\n    wcscpy(buffer, Text); // Use wcscpy to copy with null termination\n    return S_OK;\n}