#include <windows.h>\n#include <devguid.h>\n#include <setupapi.h>\n\n#pragma comment(lib, "SetupAPI.lib")\n\nBOOL DisableDevice(GUID *interfaceClassGuid, PWSTR psz Enumerator) {\n    HDEVINFO hDevInfo;\n    SP_DEVINFO_DATA DeviceInfoData = {sizeof(SP_DEVINFO_DATA)};\n    BOOL res;\n\n    // Get information about all devices belonging to a specific hardware\n    hDevInfo = SetupDiGetClassDevs(interfaceClassGuid, pszEnumerator, NULL, DIGCF_PRESENT);\n    if (hDevInfo == INVALID_HANDLE_VALUE) return FALSE;\n\n    for (DWORD i = 0; ; i++) {\n        res = SetupDiEnumDeviceInfo(hDevInfo, i, &DeviceInfoData);\n        if (!res) break;\n\n        // Disable the device\n        DWORD disableCode = DICS_DISABLE;\n        DWORD disableType = DICS_FLAG_GLOBAL;\n        SP_PROPCHANGE_PARAMS params = {sizeof(SP_DEVINFO_DATA), DICS_ENABLE|DICS_DISABLE, 0};\n        if (FALSE == SetupDiSetClassInstallParams(hDevInfo, &DeviceInfoData, &params, sizeof(params))\n            || FALSE == SetupDiCallClassInstaller(DIF_PROPERTYCHANGE, hDevInfo, &DeviceInfoData)) {\n            // Handle error\n        }\n    }\n\n    SetupDiDestroyDeviceInfoList(hDevInfo);\n    return TRUE;\n}\n\nBOOL EnableDevice(GUID *interfaceClassGuid, PWSTR pszEnumerator) {\n    HDEVINFO hDevInfo;\n    SP_DEVINFO_DATA DeviceInfoData = {sizeof(SP_DEVINFO_DATA)};\n    BOOL res;\n\n    // Get information about all devices belonging to a specific hardware\n    hDevInfo = SetupDiGetClassDevs(interfaceClassGuid, pszEnumerator, NULL, DIGCF_PRESENT);\n    if (hDevInfo == INVALID_HANDLE_VALUE) return FALSE;\n\n    for (DWORD i = 0;;i++) {\n        res = SetupDiEnumDeviceInfo(hDevInfo, i, &DeviceInfoData);\n        if (!res) break;\n\n        // Enable the device\n        DWORD disableCode = DICS_ENABLE;\n        DWORD disableType = DICS_FLAG_GLOBAL;\n        SP_PROPCHANGE_PARAMS params = {sizeof(SP_DEVINFO_DATA), DICS_ENABLE|DICS_DISABLE, 0};\n        if (FALSE == SetupDiSetClassInstallParams(hDevInfo, &DeviceInfoData, &params, sizeof(params))\n            || FALSE == SetupDiCallClassInstaller(DIF_PROPERTYCHANGE , hDevInfo, &DeviceInfoData)) {\n            // Handle error\n        }\n    }\n\n    SetupDiDestroyDeviceInfoList(hDevInfo);\n    return TRUE;\n}\n\n// Usage example:\n// DisableDevice(&GUID_DEVCLASS_MULTIFUNCTION, L"PCI");\n// EnableDevice(&GUID_DEVCLASS_MULTIFUNCTION, L"PCI");