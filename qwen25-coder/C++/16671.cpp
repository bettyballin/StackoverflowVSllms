#include <iomanip>  // For std::setw and std::setfill\n\nvoid WriteHexToFile(std::ofstream &stream, void *ptr, int buflen, const char *prefix) {\n    unsigned char *buf = static_cast<unsigned char*>(ptr);\n\n    for (int i = 0; i < buflen; ++i) {\n        if (i % 16 == 0) {\n            stream << prefix;\n        }\n\n        // Set the width to 2, fill with '0' and output in hexadecimal\n        stream << std::hex << std::setw(2) << std::setfill('0') \n               << static_cast<int>(buf[i]);\n\n        if ((i + 1) % 16 != 0) {\n            stream << ' ';\n        } else {\n            stream << '\n';\n        }\n    }\n\n    // Handle the case where the last line is not full (does not have 16 elements)\n    if (buflen % 16 != 0) {\n        stream << '\n';\n    }\n}