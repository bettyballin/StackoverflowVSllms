#include <vector>\n#include <comdef.h>\n\nclass BufferedBSTR {\npublic:\n    void Append(const wchar_t* sz) {\n        const auto length = wcslen(sz);\n        buffer.insert(end(buffer), sz, sz + length);\n    }\n\n    CComBSTR ToCComBSTR() const {\n        return CComBSTR(length(), buffer.data());\n    }\n\nprivate:\n    std::vector<wchar_t> buffer;\n};\n\n// Usage\nint main() {\n    BufferedBSTR bstrBuilder;\n    bstrBuilder.Append(L"SELECT * FROM ");\n    bstrBuilder.Append(L"MyTable WHERE ");\n    bstrBuilder.Append(L"Column = 1");\n\n    CComBSTR result = bstrBuilder.ToCComBSTR();\n    // Use the BSTR\n}