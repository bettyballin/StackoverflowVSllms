STDMETHODIMP YourComObject::GetFoo(SAFEARRAY* buffer)\n{\n    try {\n        if (buffer == nullptr) {\n            return E_POINTER;\n        }\n\n        VARTYPE vartype;\n        HRESULT hr = SafeArrayGetVartype(buffer, &vartype);\n        if (FAILED(hr)) {\n            return hr;\n        }\n        if (vartype != VT_I4) {\n            return E_INVALIDARG;\n        }\n\n        // Lock the SAFEARRAY.\n        LONG* ptr = static_cast<LONG*>(SafeArrayAccessData(buffer));\n        if (ptr == nullptr) {\n            return E_POINTER;\n        }\n\n        // Get dimensions of array\n        ULONG length = SafeArrayGetDim(buffer);\n        LONG lBound, uBound;\n\n        hr = SafeArrayGetLBound(buffer, 1, &lBound);\n        if (FAILED(hr)) {\n            SafeArrayUnaccessData(buffer);\n            return hr;\n        }\n\n        hr = SafeArrayGetUBound(buffer, 1, &uBound);\n        if (FAILED(hr)) {\n            SafeArrayUnaccessData(buffer);\n            return hr;\n        }\n\n        // Example: Modify the array\n        for (LONG i = lBound; i <= uBound; i++) {\n            ptr[i] = i * 2; // or any operation you want to perform\n        }\n\n        // Unlock the SAFEARRAY.\n        SafeArrayUnaccessData(buffer);\n\n    } catch (...) {\n        return E_UNEXPECTED;\n    }\n    return S_OK;\n}