UnicodeString ReadFromRegistry(const UnicodeString& path, const UnicodeString& valueName)\n{\n    TRegistry *Reg = new TRegistry;\n    UnicodeString result;\n    try\n    {\n        Reg->RootKey = HKEY_CURRENT_USER; // Change this to another root key if necessary\n        if (Reg->OpenKeyReadOnly(path))\n        {\n            result = Reg->ReadString(valueName);\n        }\n    }\n    __finally\n    {\n        delete Reg;\n    }\n    return result;\n}\n\n// Example usage:\n// UnicodeString lastDir = ReadFromRegistry("Software\\MyApp", "LastDirectory");