#include <windows.h>\n#include <comutil.h> // Ensure you link against comsuppw.lib\n\nvoid SafeBSTRCopy(BSTR source, BSTR &dest) {\n    if (source == NULL) {\n        dest = SysAllocString(L""); // Treat null as an empty string\n    } else {\n        dest = SysAllocString(source);\n    }\n}\n\nint main() {\n    BSTR bstrSource = NULL;\n    BSTR bstrDestination;\n\n    SafeBSTRCopy(bstrSource, bstrDestination);\n\n    if (bstrDestination != NULL) {\n        printf("BSTR is: %ls\n", bstrDestination);\n        SysFreeString(bstrDestination); // Free the allocated BSTR\n    }\n\n    return 0;\n}