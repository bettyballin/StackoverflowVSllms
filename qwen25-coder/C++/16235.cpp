#include <windows.h>\n#include <aclapi.h>\n#include <stdio.h>\n\nvoid set_DACL_for_object(const char *object, SE_OBJECT_TYPE object_type) {\n    PACL pDACL = NULL;\n    PSECURITY_DESCRIPTOR pSD = NULL;\n    EXPLICIT_ACCESS ea[2];\n\n    GetNamedSecurityInfo((LPCTSTR)object, object_type,\n                          DACL_SECURITY_INFORMATION, NULL, NULL,\n                          &pDACL, NULL, &pSD);\n\n    ZeroMemory(ea, sizeof(EXPLICIT_ACCESS) * 2);\n\n    // Grant Access\n    ea[0].grfAccessPermissions = GENERIC_READ | GENERIC_EXECUTE;\n    ea[0].grfAccessMode = SET_ACCESS;\n    ea[0].grfInheritance = NO_INHERITANCE;\n    ea[0].Trustee.TrusteeForm = TRUSTEE_IS_NAME;\n    ea[0].Trustee.TrusteeType = TRUSTEE_IS_GROUP;\n    ea[0].Trustee.ptstrName = _T("ADMINISTRATORS");\n\n    // Deny Write Access\n    ea[1].grfAccessPermissions = GENERIC_WRITE;\n    ea[1].grfAccessMode = DENY_ACCESS;\n    ea[1].grfInheritance = NO_INHERITANCE;\n    ea[1].Trustee.TrusteeForm = TRUSTEE_IS_NAME;\n    ea[1].Trustee.TrustreeType = TRUSTEE_IS_GROUP;\n    ea[1].Trustee.ptstrName = _T("ADMINISTRATORS");\n\n    SetEntriesInAcl(2, ea, pDACL, &pDACL);\n\n    DWORD dwRes = SetNamedSecurityInfo((LPCTSTR)object, object_type,\n                                        DACL_SECURITY_INFORMATION, NULL, NULL, pDACL, NULL);\n    if (dwRes != ERROR_SUCCESS) {\n        printf("SetNamedSecurityInfo failed: %lu\n", dwRes);\n    }\n\n    LocalFree(pSD);\n    LocalFree(pDACL);\n}\n\nint main() {\n    set_DACL_for_object("C:\\file.txt", SE_FILE_OBJECT);\n    return 0;\n}