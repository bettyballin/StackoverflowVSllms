class ATL_NO_VTABLE CHelloWorldBHO :\n    public CComObjectRootEx<CComSingleThreadModel>,\n    public CComCoClass<CHelloWorldBHO, &CLSID_HelloWorldBHO>,\n    public IObjectWithSiteImpl<CHelloWorldBHO>,\n    public IDispatchImpl<IHelloWorldBHO, &IID_IHelloWorldBHO, &LIBID_HelloWorldLib, /*wMajor =*/ 1, /*wMinor =*/ 0>,\n    public IDispEventImpl<1, CHelloWorldBHO, &DIID_DWebBrowserEvents2, &LIBID_SHDocVw, 1, 1>, // DWebBrowserEvents2 sink\n    public IDispEventImpl<2, CHelloWorldBHO, &DIID_HTMLElementEvents2, &LIBID_MSHTML, 4, 0> // HTMLElementEvents2 sink\n\n{\npublic:\n    BEGIN_COM_MAP(CHelloWorldBHO)\n        COM_INTERFACE_ENTRY(IHelloWorldBHO)\n        COM_INTERFACE_ENTRY(IDispatch)\n    END_COM_MAP()\n\n    BEGIN_SINK_MAP(CHelloWorldBHO)\n        SINK_ENTRY_EX(1, DIID_DWebBrowserEvents2, DISPID_DOCUMENTCOMPLETE, OnDocumentComplete)\n        SINK_ENTRY_EX(1, DIID_DWebBrowserEvents2, DISPID_BEFORENAVIGATE2, BeforeNavigate2) // Handle BeforeNavigate2\n        SINK_ENTRY_EX(2, DIID_HTMLElementEvents2, DISPID_ONCLICK, HTMLElementOnClick) // HTMLElementEvents2 events\n    END_SINK_MAP()\n\n    STDMETHOD(BeforeNavigate2)(IDispatch* pDisp,VARIANT* URL,VARIANT Flags,VARIANT TargetFrameName,VARIANT PostData,VARIANT Headers,VARIANT_BOOL* Cancel);\n    STDMETHOD(OnDocumentComplete)(IDispatch* pDisp,VARIANT URL);\n    STDMETHOD(HTMLElementOnClick)();\n};