#include <windows.h>\n#include <mmdeviceapi.h>\n#include <endpointvolume.h>\n\nfloat GetAudioSessionVolume(IAudioSessionControl2* pSession) {\n    IAudioEndpointVolume* pAudioEndpointVolume = NULL;\n    if (FAILED(pSession->QueryInterface(__uuidof(IAudioEndpointVolume), (LPVOID*)&pAudioEndpointVolume))) {\n        return -1.0f; // Error\n    }\n\n    ISimpleAudioVolume* pSimpleAudioVolume = NULL;\n    if (FAILED(pSession->GetSimpleAudioVolume(&pSimpleAudioVolume))) {\n        pAudioEndpointVolume->Release();\n        return -1.0f; // Error\n    }\n\n    float volume = 0.0f;\n    if (SUCCEEDED(pSimpleAudioVolume->GetMasterVolume(&volume))) {\n        pSimpleAudioVolume->Release();\n        pAudioEndpointVolume->Release();\n        return volume; // Success, return the volume level\n    } else {\n        pSimpleAudioVolume->Release();\n        pAudioEndpointVolume->Release();\n        return -1.0f; // Error\n    }\n}