require 'openssl'\n\n# Define the OID for sha512WithRSAEncryption\nSHA512_WITH_RSA_ENCRYPTION_OID = '1.2.840.113549.1.1.13'\n\n# Create an OpenSSL::ASN1::Sequence to represent the Algorithm structure\nalgorithm = OpenSSL::ASN1::Sequence.new(\n  [\n    OpenSSL::ASN1::ObjectId.new(SHA512_WITH_RSA_ENCRYPTION_OID, 0, :EXPLICIT),\n    OpenSSL::ASN1::Null.new(nil, 0, :EXPLICIT)\n  ]\n)\n\n# Create an OpenSSL::ASN1::Sequence to represent the Signature structure\nsignature = OpenSSL::ASN1::Sequence.new(\n  [\n    algorithm,\n    OpenSSL::ASN1::BitString.new($body, 0, :EXPLICIT)\n  ]\n)\n\n# Encode the Signature structure using DER encoding\nder_encoded_signature = OpenSSL::ASN1.encode(signature, 0, :DER)\n\n# Use the der_encoded_signature as needed