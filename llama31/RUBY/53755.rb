# Load libraries\nlibrary(dplyr)\nlibrary(tidyr)\n\n# Load data\ndata <- read.csv("cupcake_data.csv")\n\n# Prepare data\ndata <- data %>%\n  pivot_longer(cols = c(flavor, moistness, presentation, goodness),\n               names_to = "attribute",\n               values_to = "rating")\n\n# Calculate average ratings for each bakery and attribute\navg_ratings <- data %>%\n  group_by(bakery, attribute) %>%\n  summarise(avg_rating = mean(rating))\n\n# Perform statistical tests and ranking for each attribute\nresults <- list()\nfor (attribute in unique(avg_ratings$attribute)) {\n  # Filter data for current attribute\n  attr_data <- avg_ratings %>% filter(attribute == !!attribute)\n  \n  # Perform ANOVA\n  anova_result <- aov(avg_rating ~ bakery, data = attr_data)\n  \n  # Perform post-hoc test (Tukey's HSD)\n  post_hoc_result <- TukeyHSD(anova_result, "bakery")\n  \n  # Rank bakeries based on post-hoc test results\n  ranking <- post_hoc_result[["bakery"]] %>%\n    arrange(desc(avg_rating))\n  \n  # Store results\n  results[[attribute]] <- ranking\n}\n\n# Print results\nfor (attribute in names(results)) {\n  cat("Ranking for", attribute, ":\n")\n  print(results[[attribute]])\n}