#!/usr/bin/env ruby\n\nrequire 'cgi'\nrequire 'net/smtp'\n\n# Parse CGI parameters\ncgi = CGI.new\nparams = cgi.params\n\n# Send email\nfrom = params['from'][0]\nto = params['to'][0]\nsubject = params['subject'][0]\nbody = params['body'][0]\n\nmsg = <<END_OF_MESSAGE\nFrom: #{from}\nTo: #{to}\nSubject: #{subject}\nDate: #{DateTime::now().to_s}\n\n#{body}\nEND_OF_MESSAGE\n\nNet::SMTP.start('localhost', 25) do |smtp|\n  smtp.send_message msg, from, to\nend\n\n# Redirect to confirmation page\nprint "Status: 302 Found\r\n"\nprint "Location: #{params['redirect'][0]}\r\n"\nprint "\r\n"