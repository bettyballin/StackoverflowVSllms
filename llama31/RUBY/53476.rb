# Order model\nclass Order < ActiveRecord::Base\n  attr_accessible :billing_address, :shipping_address # attributes that can be mass-assigned by anyone\nend\n\n# Ability class (using CanCan)\nclass Ability\n  include CanCan::Ability\n\n  def initialize(user)\n    if user.admin?\n      can :update, Order, :all # admins can update all order attributes\n    else\n      can :update, Order, [:billing_address, :shipping_address] # users can only update specific attributes\n    end\n  end\nend\n\n# OrdersController\nclass OrdersController < ApplicationController\n  def update\n    @order = Order.find(params[:id])\n    authorize! :update, @order # check user's role and permissions\n\n    if params[:order].present?\n      @order.update_attributes(params[:order]) # mass assignment for users and admins\n    else\n      # admin-only attributes\n      @order.update_attribute(:origination_ip_address, params[:order][:origination_ip_address])\n    end\n  end\nend