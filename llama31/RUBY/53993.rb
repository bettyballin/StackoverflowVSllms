def aggregate(feeds, time_limit)\n  return [] if feeds.blank?\n\n  feeds.sort_by! { |f| -f.created_at.to_i }\n  result = []\n  bin = [feeds.first]\n  bin_time = feeds.first.created_at\n\n  feeds[1..-1].each do |feed|\n    if (bin_time - feed.created_at) < time_limit\n      bin << feed\n    else\n      result << [bin_time, bin]\n      bin_time = feed.created_at\n      bin = [feed]\n    end\n  end\n\n  result << [bin_time, bin]\nend