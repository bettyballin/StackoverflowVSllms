// MyActiveXCtrl.cpp\n#include "MyActiveXCtrl.h"\n\nCMyActiveXCtrl::CMyActiveXCtrl()\n{\n    m_pTypeInfo = NULL;\n}\n\nSTDMETHODIMP CMyActiveXCtrl::GetTypeInfoCount(UINT* pctinfo)\n{\n    *pctinfo = 1;\n    return S_OK;\n}\n\nSTDMETHODIMP CMyActiveXCtrl::GetTypeInfo(UINT itinfo, LCID lcid, ITypeInfo** pptinfo)\n{\n    if (itinfo != 0) return E_INVALIDARG;\n    if (m_pTypeInfo == NULL) return E_NOTIMPL;\n    *pptinfo = m_pTypeInfo;\n    (*pptinfo)->AddRef();\n    return S_OK;\n}\n\nSTDMETHODIMP CMyActiveXCtrl::GetIDsOfNames(REFIID riid, LPOLESTR* rgszNames, UINT cNames, LCID lcid, DISPID* rgDispId)\n{\n    if (riid != IID_NULL) return E_INVALIDARG;\n    if (cNames != 1) return E_INVALIDARG;\n\n    // Map names to DISPIDs\n    if (wcscmp(rgszNames[0], L"MyMethod") == 0)\n    {\n        *rgDispId = 1;\n        return S_OK;\n    }\n\n    return E_FAIL;\n}\n\nSTDMETHODIMP CMyActiveXCtrl::Invoke(DISPID dispIdMember, REFIID riid, LCID lcid, WORD wFlags, DISPPARAMS* pDispParams, VARIANT* pVarResult, EXCEPINFO* pExcepInfo, UINT* puArgErr)\n{\n    if (dispIdMember == 1) // MyMethod\n    {\n        if (wFlags & DISPATCH_METHOD)\n        {\n            BSTR input = SysAllocString(pDispParams->rgvarg[0].bstrVal);\n            BSTR output = NULL;\n            HRESULT hr = MyMethod(input, &output);\n            SysFreeString(input);\n            if (SUCCEEDED(hr))\n            {\n                pVarResult->vt = VT_BSTR;\n                pVarResult->bstrVal = output;\n            }\n            return hr;\n        }\n    }\n\n    return E_FAIL;\n}\n\nSTDMETHODIMP CMyActiveXCtrl::MyMethod(BSTR input, BSTR* output)\n{\n    // Implement your custom method here\n    *output = SysAllocString(L"Hello, World!");\n    return S_OK;\n}