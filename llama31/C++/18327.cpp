// COM object method\nHRESULT GetDIBAsByteArray(BYTE** ppBytes, DWORD* pdwSize)\n{\n    // Assume you have a DIB handle (hDIB)\n    HDC hDC = GetDC(NULL);\n    int nWidth = GetDeviceCaps(hDC, HORZRES);\n    int nHeight = GetDeviceCaps(hDC, VERTRES);\n    int nBPP = GetDeviceCaps(hDC, BITSPIXEL);\n    ReleaseDC(NULL, hDC);\n\n    DWORD dwSize = nWidth * nHeight * (nBPP / 8);\n    *ppBytes = new BYTE[dwSize];\n\n    GetDIBits(hDC, hDIB, 0, nHeight, *ppBytes, NULL, DIB_RGB_COLORS);\n\n    *pdwSize = dwSize;\n    return S_OK;\n}