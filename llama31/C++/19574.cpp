HRESULT IValue1::GetValue(VARIANT* pValue)\n{\n    // Initialize the VARIANT\n    VariantInit(pValue);\n\n    // Determine the type of value to return based on the current type\n    switch (GetType())\n    {\n        case TypeEnum_Long:\n            pValue->vt = VT_I4;\n            pValue->lVal = m_longValue;\n            break;\n        case TypeEnum_Bstr:\n            pValue->vt = VT_BSTR;\n            pValue->bstrVal = SysAllocString(m_bstrValue);\n            break;\n        case TypeEnum_Bool:\n            pValue->vt = VT_BOOL;\n            pValue->boolVal = m_boolValue;\n            break;\n        case TypeEnum_Interface:\n            pValue->vt = VT_DISPATCH;\n            pValue->pdispVal = m_interfaceValue;\n            break;\n        default:\n            return E_INVALIDARG;\n    }\n\n    return S_OK;\n}