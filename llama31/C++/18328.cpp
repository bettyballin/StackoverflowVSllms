#include <Windows.h>\n#include <Security.h>\n\nint main()\n{\n    HANDLE hToken;\n    OpenProcessToken(GetCurrentProcess(), TOKEN_DUPLICATE, &hToken);\n\n    // Get the SID for Network Service\n    PSID pSid = NULL;\n    ConvertStringSidToSid(L"S-1-5-20", &pSid);\n\n    // Create a new token with the Network Service SID\n    HANDLE hNewToken;\n    DuplicateTokenEx(hToken, MAXIMUM_ALLOWED, NULL, SecurityImpersonation, TokenPrimary, &hNewToken);\n    SetTokenInformation(hNewToken, TokenUser, pSid, sizeof(TOKEN_USER));\n\n    // Create a new process under the Network Service account\n    STARTUPINFO si;\n    ZeroMemory(&si, sizeof(si));\n    si.cb = sizeof(si);\n    PROCESS_INFORMATION pi;\n    ZeroMemory(&pi, sizeof(pi));\n    CreateProcessWithTokenW(hNewToken, LOGON_WITH_PROFILE, L"C:\\Path\\To\\Your\\ConsoleApplication.exe", NULL, 0, NULL, NULL, &si, &pi);\n\n    // Clean up\n    CloseHandle(hNewToken);\n    CloseHandle(hToken);\n    LocalFree(pSid);\n\n    return 0;\n}