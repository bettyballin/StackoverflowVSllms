try {\n    ISomeObject pObj(__uuidof(SomeClass));\n    ISomeObject pObj2(__uuidof(SomeOtherClass));\n} catch ( _com_error& e ) {\n    IErrorInfo* pInfo = NULL;\n    if (SUCCEEDED(GetErrorInfo(0, &pInfo))) {\n        BSTR bstrSource = NULL;\n        if (SUCCEEDED(pInfo->GetSource(&bstrSource))) {\n            // bstrSource will contain the GUID of the class that failed to register\n            // You can use this to determine which class failed\n            SysFreeString(bstrSource);\n        }\n        pInfo->Release();\n    }\n}