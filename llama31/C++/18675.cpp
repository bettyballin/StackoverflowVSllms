#include <aygshell.h>\n\nint listFiles(const TCHAR* folderPath) {\n    IShellFolder* pFolder;\n    HRESULT hr = SHGetFolder(folderPath, &pFolder);\n    if (FAILED(hr)) {\n        return 0;\n    }\n\n    IEnumIDList* pEnum;\n    hr = pFolder->EnumObjects(NULL, SHCONTF_FOLDERS | SHCONTF_NONFOLDERS, &pEnum);\n    if (FAILED(hr)) {\n        pFolder->Release();\n        return 0;\n    }\n\n    while (pEnum->Next(1, &pidl, NULL) == S_OK) {\n        // Process the file information\n        // ...\n        CoTaskMemFree(pidl);\n    }\n\n    pEnum->Release();\n    pFolder->Release();\n    return 1;\n}