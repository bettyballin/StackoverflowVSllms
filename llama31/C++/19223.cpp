// HelloRTD.cpp\n#include <afxwin.h>\n#include <atlbase.h>\n#include <atlcom.h>\n\nclass CHelloRTDApp : public CWinApp\n{\npublic:\n    CHelloRTDApp();\n    ~CHelloRTDApp();\n\n    virtual BOOL InitInstance();\n};\n\nCHelloRTDApp::CHelloRTDApp()\n{\n}\n\nCHelloRTDApp::~CHelloRTDApp()\n{\n}\n\nBOOL CHelloRTDApp::InitInstance()\n{\n    // Create an RTD server\n    HRESULT hr = CoCreateInstance(\n        CLSID_IRTDServer,\n        NULL,\n        CLSCTX_SERVER,\n        IID_IRTDServer,\n        (LPVOID*)&m_pRTDServer\n    );\n\n    if (SUCCEEDED(hr))\n    {\n        hr = CoRegisterClassObject(\n            CLSID_IRTDServer,\n            m_pRTDServer,\n            CLSCTX_SERVER,\n            REGCLS_MULTIPLEUSE\n        );\n    }\n\n    // Create a dialog-based app\n    CDialog dlg(IDD_HELLOMFC_DIALOG);\n    dlg.DoModal();\n\n    return TRUE;\n}