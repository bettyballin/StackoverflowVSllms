HRESULT hr;\nULARGE_INTEGER uliSize;\n\n// Move the stream pointer to the end of the stream\nhr = pStream->Seek(0, STREAM_SEEK_END, NULL);\nif (SUCCEEDED(hr))\n{\n    // Get the current position of the stream pointer\n    hr = pStream->Seek(0, STREAM_SEEK_CUR, &uliSize);\n    if (SUCCEEDED(hr))\n    {\n        // uliSize.QuadPart now holds the size of the JPEG data in bytes\n    }\n}