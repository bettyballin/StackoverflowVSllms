DLL_EXPORT(void) doCalc(double *calcIn, int numIn, double *calcOut)\n{\n    // Initialize COM.\n    HRESULT hr = CoInitialize(NULL);\n\n    // Create the interface pointer.\n    IUnitModelPtr pIUnit(__uuidof(UnitModel));\n\n    // Create a SAFEARRAY to pass the input array to the C# method.\n    SAFEARRAY* psaInput = SafeArrayCreateVector(VT_R8, 0, numIn);\n    for (int i = 0; i < numIn; i++)\n    {\n        SafeArrayPutElement(psaInput, &i, &calcIn[i]);\n    }\n\n    // Call the DoCalc method.\n    SAFEARRAY* psaOutput = NULL;\n    hr = pIUnit->DoCalc(psaInput, &psaOutput);\n\n    // Check the HRESULT for any errors.\n    if (FAILED(hr))\n    {\n        // Handle the error.\n    }\n\n    // Retrieve the output array from the SAFEARRAY.\n    double* outputArray = NULL;\n    SafeArrayAccessData(psaOutput, (void**)&outputArray);\n\n    // Copy the output array to the calcOut array.\n    for (int i = 0; i < numIn; i++)\n    {\n        calcOut[i] = outputArray[i];\n    }\n\n    // Release the SAFEARRAYs.\n    SafeArrayDestroy(psaInput);\n    SafeArrayDestroy(psaOutput);\n\n    // Uninitialize COM.\n    CoUninitialize();\n}