// Instead of calling SetDllDirectory() in DllMain()\nBOOL WINAPI DllMain(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpReserved)\n{\n    // ...\n    return TRUE;\n}\n\n// Create a separate function to modify the DLL search path\nvoid SetDllDirectoryExplicit()\n{\n    WCHAR szPath[MAX_PATH];\n    GetModuleFileName(hinstDLL, szPath, MAX_PATH);\n    WCHAR* szDir = wcsrchr(szPath, L'\\');\n    if (szDir != NULL)\n    {\n        *szDir = L'\0';\n        SetDllDirectory(szPath);\n    }\n}