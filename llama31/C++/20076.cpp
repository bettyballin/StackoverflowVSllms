// Import the necessary libraries\n#import "msowc.dll" no_namespace\n\n// Create a dialog class that will host the Spreadsheet control\nclass CImportDialog : public CDialog\n{\npublic:\n    CImportDialog(CWnd* pParent = NULL);\n\n    // ...\n\n    // Create a Spreadsheet control\n    Spreadsheet _spreadsheet;\n\n    // ...\n\n    // Handle the selection change event\n    void OnSelectionChange()\n    {\n        // Get the selected range\n        Range selectedRange = _spreadsheet.GetSelection();\n\n        // Do something with the selected range\n        // ...\n    }\n};\n\n// Create the dialog and initialize the Spreadsheet control\nCImportDialog::CImportDialog(CWnd* pParent /*=NULL*/)\n    : CDialog(CImportDialog::IDD, pParent)\n{\n    // Initialize the Spreadsheet control\n    _spreadsheet.Create(NULL, NULL, WS_VISIBLE | WS_CHILD, CRect(0, 0, 500, 500), this, IDC_SPREADSHEET);\n}\n\n// Handle the selection change event\nBEGIN_DISPATCH_MAP(CImportDialog, CDialog)\n    ON_DISPATCH(ID_SPREADSHEET, DISPID_SELECTIONCHANGE, &CImportDialog::OnSelectionChange)\nEND_DISPATCH_MAP()