#include <Windows.h>\n\nint main()\n{\n    SC_HANDLE schSCManager = NULL;\n    SC_HANDLE schService = NULL;\n\n    // Open the Service Control Manager\n    schSCManager = OpenSCManager(NULL, NULL, SC_MANAGER_CONNECT);\n\n    if (schSCManager == NULL)\n    {\n        // Handle error\n        return 1;\n    }\n\n    // Open the service\n    schService = OpenService(schSCManager, TEXT("Sample_Srv"), SERVICE_CHANGE_CONFIG);\n\n    if (schService == NULL)\n    {\n        // Handle error\n        CloseServiceHandle(schSCManager);\n        return 1;\n    }\n\n    // Define the recovery actions\n    SERVICE_FAILURE_ACTIONS sfa;\n    sfa.dwResetPeriod = 0; // Reset failure count after this many seconds\n    sfa.lpRebootMsg = NULL; // No reboot message\n    sfa.lpCommand = NULL; // No command to run on failure\n    sfa.cActions = 1; // Number of actions\n    sfa.lpsaActions = new SC_ACTION[1];\n    sfa.lpsaActions[0].Type = SC_ACTION_RESTART; // Restart the service on failure\n    sfa.lpsaActions[0].Delay = 0; // No delay before restarting\n\n    // Change the service configuration\n    if (!ChangeServiceConfig2(schService, SERVICE_CONFIG_FAILURE_ACTIONS, &sfa))\n    {\n        // Handle error\n        delete[] sfa.lpsaActions;\n        CloseServiceHandle(schService);\n        CloseServiceHandle(schSCManager);\n        return 1;\n    }\n\n    delete[] sfa.lpsaActions;\n    CloseServiceHandle(schService);\n    CloseServiceHandle(schSCManager);\n\n    return 0;\n}