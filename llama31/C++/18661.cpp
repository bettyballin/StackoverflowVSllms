HANDLE hProcess = ...; // process handle returned by ShellExecuteEx\n\n// Obtain a new handle with the required access rights\nHANDLE hProcessWithAccess = OpenProcess(PROCESS_SET_QUOTA | PROCESS_TERMINATE, FALSE, GetProcessId(hProcess));\n\nif (hProcessWithAccess != NULL) {\n    // Assign the process to the job object\n    if (!AssignProcessToJobObject(hJob, hProcessWithAccess)) {\n        // error handling\n    }\n    CloseHandle(hProcessWithAccess);\n}