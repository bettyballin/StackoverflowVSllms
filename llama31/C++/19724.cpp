#include <SetupAPI.h>\n\n// ...\n\nHDEVINFO hDevInfo = SetupDiGetClassDevs(NULL, NULL, NULL, DIGCF_ALLCLASSES);\nif (hDevInfo == INVALID_HANDLE_VALUE) {\n    // Handle error\n}\n\nSP_DEVINFO_DATA* pInfo = (SP_DEVINFO_DATA*)HeapAlloc(GetProcessHeap(), 0, sizeof(SP_DEVINFO_DATA));\nif (!pInfo) {\n    // Handle error\n}\n\npInfo->cbSize = sizeof(SP_DEVINFO_DATA);\nif (SetupDiEnumDeviceInfo(hDevInfo, 0, pInfo)) {\n    // Get device property (friendly name)\n    DWORD dwPropertyType = 0;\n    DWORD dwBufSize = 0;\n    SetupDiGetDeviceProperty(hDevInfo, pInfo, SPDRP_FRIENDLYNAME, &dwPropertyType, NULL, 0, &dwBufSize);\n\n    if (dwBufSize > 0) {\n        WCHAR* pFriendlyName = (WCHAR*)HeapAlloc(GetProcessHeap(), 0, dwBufSize);\n        if (pFriendlyName) {\n            SetupDiGetDeviceProperty(hDevInfo, pInfo, SPDRP_FRIENDLYNAME, &dwPropertyType, pFriendlyName, dwBufSize, &dwBufSize);\n            // Use pFriendlyName\n            HeapFree(GetProcessHeap(), 0, pFriendlyName);\n        }\n    }\n}\n\nHeapFree(GetProcessHeap(), 0, pInfo);\nSetupDiDestroyDeviceInfoList(hDevInfo);