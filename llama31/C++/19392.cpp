#include <tlhelp32.h>\n\nDWORD getParentProcessId(DWORD processId) {\n    HANDLE hSnapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);\n    if (hSnapshot == INVALID_HANDLE_VALUE) {\n        return 0;\n    }\n\n    PROCESSENTRY32 pe;\n    pe.dwSize = sizeof(PROCESSENTRY32);\n\n    if (Process32First(hSnapshot, &pe)) {\n        do {\n            if (pe.th32ProcessID == processId) {\n                CloseHandle(hSnapshot);\n                return pe.th32ParentProcessID;\n            }\n        } while (Process32Next(hSnapshot, &pe));\n    }\n\n    CloseHandle(hSnapshot);\n    return 0;\n}