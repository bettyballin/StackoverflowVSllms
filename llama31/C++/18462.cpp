// Assume 'pWebBrowser2' is the IID_IWebBrowser2 pointer\n// and 'elementId' is the ID of the element you want to attach the handler to\n\n// Create a script to attach the event handler\nBSTR script = SysAllocString(L"document.getElementById('elementId').addEventListener('click', function(){ /* handler code */ }, false);");\n\n// Execute the script on the main thread\npWebBrowser2->Exec(&CGID_DocHostCmd Priv_Doc, OLECMDEXECOPT_DODEFAULT, script, NULL, NULL);\n\n// Release the script BSTR\nSysFreeString(script);