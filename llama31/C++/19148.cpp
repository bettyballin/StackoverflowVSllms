// IChatServer.h\n#pragma once\n\n#include <atlbase.h>\n#include <atlcom.h>\n\ninterface IChatServer : IUnknown\n{\n    HRESULT Send(const char* message);\n    HRESULT Receive(char** message);\n};\n\n// ChatServer.h\n#pragma once\n\n#include "IChatServer.h"\n\nclass CChatServer :\n    public CComObjectRootEx<CComSingleThreadModel>,\n    public CComCoClass<CChatServer, &CLSID_ChatServer>,\n    public IChatServer\n{\npublic:\n    CChatServer();\n    ~CChatServer();\n\n    DECLARE_REGISTRY_RESOURCEID(IDR_CHATSERVER)\n\n    BEGIN_COM_MAP(CChatServer)\n        COM_INTERFACE_ENTRY(IChatServer)\n    END_COM_MAP()\n\n    HRESULT Send(const char* message);\n    HRESULT Receive(char** message);\n};