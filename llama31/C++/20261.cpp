#include <Windows.h>\n#include <TlHelp32.h>\n\nbool isLaunchedFromExplorer() {\n    HANDLE hProcess = GetCurrentProcess();\n    HANDLE hParentProcess = NULL;\n    HANDLE hSnapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);\n    PROCESSENTRY32 pe32 = { sizeof(PROCESSENTRY32) };\n\n    if (Process32First(hSnapshot, &pe32)) {\n        do {\n            if (pe32.th32ProcessID == GetParentProcessId(hProcess)) {\n                hParentProcess = OpenProcess(PROCESS_QUERY_INFORMATION, FALSE, pe32.th32ProcessID);\n                break;\n            }\n        } while (Process32Next(hSnapshot, &pe32));\n    }\n\n    CloseHandle(hSnapshot);\n\n    if (hParentProcess) {\n        DWORD dwParentProcessNameLen = 260;\n        WCHAR szParentProcessName[260];\n        QueryFullProcessImageNameW(hParentProcess, 0, szParentProcessName, &dwParentProcessNameLen);\n        CloseHandle(hParentProcess);\n\n        // Explorer.exe is the parent process when launched from Explorer\n        return wcscmp(szParentProcessName, L"C:\\Windows\\explorer.exe") == 0;\n    }\n\n    return false;\n}\n\nint main() {\n    if (isLaunchedFromExplorer()) {\n        // Wait for keypress or handle accordingly\n    }\n    // ...\n}