#include <mshtml.h>\n#include <mshtmdid.h>\n\n// Your event handler implementation\nHRESULT MyEventHandler::Invoke(DISPID dispidMember, REFIID riid, LCID lcid, WORD wFlags, DISPPARAMS* pDispParams, VARIANT* pVarResult, EXCEPINFO* pExcepInfo, UINT* puArgErr)\n{\n    if (dispidMember == DISPID_EVMOUSEUP)\n    {\n        // Get the MouseEvent object from the DISPPARAMS\n        VARIANT* pMouseEvent = pDispParams->rgvarg[0].pvarVal;\n        if (pMouseEvent && (pMouseEvent->vt & VT_DISPATCH))\n        {\n            // Use the MouseEvent object...\n            IMouseEvent* pMouseEventInterface = NULL;\n            HRESULT hr = pMouseEvent->pdispVal->QueryInterface(IID_IMouseEvent, (void**)&pMouseEventInterface);\n            if (SUCCEEDED(hr))\n            {\n                // ...\n                pMouseEventInterface->Release();\n            }\n        }\n    }\n    return S_OK;\n}