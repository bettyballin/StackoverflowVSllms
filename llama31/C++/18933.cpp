#include <tapi.h>\n\nILine* pLine = NULL;\n\n// Initialize the line interface\nHRESULT hr = CoCreateInstance(CLSID_Line, NULL, CLSCTX_INPROC_SERVER, IID_ILine, (LPVOID*)&pLine);\n\nif (SUCCEEDED(hr))\n{\n    DWORD dwGPRSUsage = 0;\n    hr = pLine->GetGPRSUsage(&dwGPRSUsage);\n\n    if (SUCCEEDED(hr))\n    {\n        // dwGPRSUsage contains the total GPRS usage in KBs\n    }\n\n    // Release the line interface\n    pLine->Release();\n}