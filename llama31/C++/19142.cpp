#include <Windows.h>\n#include <Security.h>\n\nPSID GetCurrentSid() {\n    HANDLE hToken = NULL;\n    PSID pSid = NULL;\n    DWORD dwLength = 0;\n\n    // Open the current process token\n    if (!OpenProcessToken(GetCurrentProcess(), TOKEN_QUERY, &hToken)) {\n        goto Cleanup;\n    }\n\n    // Get the SID of the current user\n    if (!GetTokenInformation(hToken, TokenUser, NULL, 0, &dwLength)) {\n        if (GetLastError() != ERROR_INSUFFICIENT_BUFFER) {\n            goto Cleanup;\n        }\n    }\n\n    pSid = (PSID)LocalAlloc(LPTR, dwLength);\n    if (!GetTokenInformation(hToken, TokenUser, pSid, dwLength, &dwLength)) {\n        goto Cleanup;\n    }\n\nCleanup:\n    if (hToken) {\n        CloseHandle(hToken);\n    }\n    if (pSid && GetLastError() != 0) {\n        LocalFree(pSid);\n        pSid = NULL;\n    }\n    return pSid;\n}