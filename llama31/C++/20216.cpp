#include <SHDOCLC.H>\n\nint GetIEZone()\n{\n    IInternetZoneManager* pZoneManager = NULL;\n    HRESULT hr = CoCreateInstance(CLSID_InternetZoneManager, NULL, \n                                  CLSCTX_ALL, IID_IInternetZoneManager, \n                                  (void**)&pZoneManager);\n    if (SUCCEEDED(hr))\n    {\n        DWORD dwZone = 0;\n        hr = pZoneManager->GetZoneMappings(URLZONE_LOCAL_MACHINE, &dwZone);\n        if (SUCCEEDED(hr))\n        {\n            return dwZone;\n        }\n        pZoneManager->Release();\n    }\n    return -1; // error\n}