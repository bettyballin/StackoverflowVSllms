// assuming you have already opened the workbook and set the application to visible\n\n// get the active worksheet\n_WorksheetPtr worksheet = application->ActiveSheet;\n\n// define the range of cells to copy\nRangePtr range = worksheet->Range["A4:C4"];\n\n// create a variant to store the cell values\nVARIANT variant;\nVariantInit(&variant);\n\n// copy the cell values into the variant\nrange->Value2->Get(&variant);\n\n// the variant now contains an array of cell values\n// you can access the values like this:\nSAFEARRAY* array = V_ARRAY(&variant);\nLONG lBound, uBound;\nSafeArrayGetLBound(array, 1, &lBound);\nSafeArrayGetUBound(array, 1, &uBound);\n\nint rows = uBound - lBound + 1;\nint cols = 3; // since we copied 3 columns (A, B, C)\n\nfor (int row = 0; row < rows; row++) {\n    for (int col = 0; col < cols; col++) {\n        BSTR cellValue;\n        SafeArrayGetElement(array, &row, &col, &cellValue);\n        // do something with the cell value\n        SysFreeString(cellValue);\n    }\n}\n\n// clean up\nVariantClear(&variant);