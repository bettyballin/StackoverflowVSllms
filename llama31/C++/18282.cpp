STDMETHODIMP CYourObject::GetImage(SAFEARRAY** image)\n{\n    // Create a SAFEARRAY to hold the image data\n    SAFEARRAY* psa = SafeArrayCreateVector(VT_UI1, 0, imageLength);\n\n    // Copy the image data into the SAFEARRAY\n    BYTE* imageData;\n    SafeArrayAccessData(psa, (void**)&imageData);\n    // Copy the image data from your internal buffer to the SAFEARRAY\n    // ...\n    SafeArrayUnaccessData(psa);\n\n    // Return the SAFEARRAY to the caller\n    *image = psa;\n    return S_OK;\n}