IShellFolder* pShellFolder;\nSHCreateDirectoryEx(NULL, "C:\\Path\\To\\Directory", &pShellFolder);\nif (pShellFolder) {\n    IEnumIDList* pEnum;\n    SHEnumDirectory(pShellFolder, &pEnum);\n    if (pEnum) {\n        PITEMID_CHILD pidl;\n        while (pEnum->Next(1, &pidl, NULL) == S_OK) {\n            // Process the file information in pidl\n            ILFree(pidl);\n        }\n        pEnum->Release();\n    }\n    pShellFolder->Release();\n}