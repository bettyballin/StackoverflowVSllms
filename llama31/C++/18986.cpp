#include <Windows.h>\n#include <Aclapi.h>\n\nint main() {\n    HKEY hKey;\n    LONG lRes = RegOpenKeyEx(HKEY_LOCAL_MACHINE, L"SOFTWARE\\Your\\Key", 0, KEY_WRITE, &hKey);\n    if (lRes != ERROR_SUCCESS) {\n        // Handle error\n    }\n\n    // Get the current ACL\n    PSECURITY_DESCRIPTOR pSD;\n    lRes = RegGetKeySecurity(hKey, DACL_SECURITY_INFORMATION, &pSD);\n    if (lRes != ERROR_SUCCESS) {\n        // Handle error\n    }\n\n    // Create a new ACL with the desired permissions\n    PACL pNewACL = NULL;\n    lRes = InitializeFromAcl(pSD->Dacl, &pNewACL);\n    if (lRes != ERROR_SUCCESS) {\n        // Handle error\n    }\n\n    // Allow Set Value permission for the current user\n    EXPLICIT_ACCESS ea;\n    ea.grfAccessPermissions = KEY_SET_VALUE;\n    ea.grfAccessMode = GRANT_ACCESS;\n    ea.grfInheritance = NO_INHERITANCE;\n    ea.Trustee.pMultipleTrustee = NULL;\n    ea.Trustee.MultipleTrusteeOperation = NO_MULTIPLE_TRUSTEE;\n    ea.Trustee.TrusteeForm = TRUSTEE_IS_NAME;\n    ea.Trustee.ptstrName = L"CURRENT_USER";\n\n    lRes = AddAccessAllowedAceEx(pNewACL, ACL_REVISION_DS, CONTAINER_INHERIT_ACE | OBJECT_INHERIT_ACE, &ea);\n    if (lRes != ERROR_SUCCESS) {\n        // Handle error\n    }\n\n    // Set the new ACL\n    lRes = RegSetKeySecurity(hKey, DACL_SECURITY_INFORMATION, &pNewACL);\n    if (lRes != ERROR_SUCCESS) {\n        // Handle error\n    }\n\n    // Clean up\n    LocalFree(pNewACL);\n    LocalFree(pSD);\n    RegCloseKey(hKey);\n\n    return 0;\n}