HANDLE hThread = CreateThread(NULL, 0, WaitThreadProc, this, 0, NULL);\n\n// ...\n\nDWORD WINAPI WaitThreadProc(LPVOID lpParameter)\n{\n    CYourApp* pApp = (CYourApp*)lpParameter;\n    HANDLE hProcess = pApp->GetProcessHandle();\n\n    while (true)\n    {\n        DWORD dwExitCode;\n        if (!GetExitCodeProcess(hProcess, &dwExitCode))\n        {\n            // Handle error\n            break;\n        }\n\n        if (dwExitCode != STILL_ACTIVE)\n        {\n            break;\n        }\n\n        // Sleep for a short period to avoid busy-waiting\n        Sleep(100);\n    }\n\n    // Post a message to the main thread to indicate that the process has finished\n    PostMessage(pApp->GetMainWnd()->GetSafeHwnd(), WM_PROCESS_FINISHED, 0, 0);\n\n    return 0;\n}