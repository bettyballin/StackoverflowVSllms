HRESULT GetStrList(VARIANT *pVal)\n{\n    USES_CONVERSION;\n\n    if (!pVal)\n        return E_FAIL;\n\n    SAFEARRAYBOUND bound[1]; //single dimension array\n    bound[0].lLbound = 0;\n    bound[0].cElements = 10;\n\n    SAFEARRAY * A = SafeArrayCreate(VT_BSTR, 1, bound);\n\n    BSTR * str = NULL;\n    SafeArrayAccessData(A, (void**)&str);\n\n    //user wants the NT view OPC drivers list.\n    for (int i = 0; i < 10; i++)\n    {\n        str[i] = SysAllocString(T2W(mystrings[i]));\n    }\n\n    SafeArrayUnaccessData(A); // Decrement the lock count\n\n    VariantInit(pVal);\n    pVal->vt        = VT_ARRAY | VT_BSTR;\n    pVal->parray    = A;\n\n    return S_OK;\n}