// Assuming you have an IUnknown* pointer to the DOM object\nIUnknown* pDOM = ...;\n\n// Create a stream to marshal the interface pointer\nIStream* pStream = NULL;\nHRESULT hr = CoMarshalInterThreadInterfaceInStream(\n    IID_IUnknown,  // IID of the interface\n    pDOM,          // Interface pointer to marshal\n    &pStream       // Output stream\n);\n\nif (SUCCEEDED(hr)) {\n    // Now, you can pass the stream to the main BHO thread\n    // and unmarshal the interface pointer using CoUnmarshalInterface\n    PostMessage(m_hwnd, WM_UNMARSHAL_INTERFACE, (WPARAM)pStream, 0);\n}\n\n// In the main BHO thread, handle the WM_UNMARSHAL_INTERFACE message\nLRESULT CALLBACK BHOWndProc(HWND hwnd, UINT msg, WPARAM wParam, LPARAM lParam)\n{\n    switch (msg) {\n        case WM_UNMARSHAL_INTERFACE:\n            IStream* pStream = (IStream*)wParam;\n            IUnknown* pDOM = NULL;\n            HRESULT hr = CoUnmarshalInterface(pStream, IID_IUnknown, (void**)&pDOM);\n            if (SUCCEEDED(hr)) {\n                // Now, you can access the DOM object safely\n                // ...\n                pDOM->Release();\n            }\n            break;\n    }\n    return 0;\n}