#include <atlbase.h>\n#include <atlcom.h>\n\n// ...\n\n_variant_t resultsDataString;\n_bstr_t simObjectNames;\nsimObjectNames = SysAllocString(L"TEST example 3");\nresultsDataString = pis8->GetSimObject(simObjectNames);\n\n// Get the IDispatch pointer from the VARIANT\nIDispatch* pDispatch = resultsDataString.punkVal;\n\n// Use the IDispatch interface to retrieve the value\nCComVariant var;\nHRESULT hr = pDispatch->Invoke(DISPID_VALUE, IID_NULL, LOCALE_USER_DEFAULT, DISPATCH_PROPERTYGET, &var, NULL, NULL, NULL);\nif (SUCCEEDED(hr))\n{\n    // Convert the VARIANT to a string\n    CComBSTR bstr;\n    hr = var.ChangeType(VT_BSTR, &bstr);\n    if (SUCCEEDED(hr))\n    {\n        // Use the string value\n        printf("%S\n", bstr.m_str);\n    }\n}