SECURITY_DESCRIPTOR sd;\nInitializeSecurityDescriptor(&sd, SECURITY_DESCRIPTOR_REVISION);\n\n// Add an ACE for the "NT AUTHORITY\\Authenticated Users" group\nEXPLICIT_ACCESS ea;\nZeroMemory(&ea, sizeof(ea));\nea.grfAccessPermissions = SERVICE_START;\nea.grfAccessMode = SET_ACCESS;\nea.grfInheritance = NO_INHERITANCE;\nea.Trustee.pMultipleTrustee = NULL;\nea.Trustee.MultipleTrusteeOperation = NO_MULTIPLE_TRUSTEE;\nea.Trustee.TrusteeForm = TRUSTEE_IS_NAME;\nea.Trustee.TrusteeType = TRUSTEE_IS_GROUP;\nea.Trustee.ptstrName = L"NT AUTHORITY\\Authenticated Users";\n\nSetEntriesInAcl(1, &ea, NULL, &sd);\n\n// Set the service permissions\nSetServiceObjectSecurity(hService, DACL_SECURITY_INFORMATION, &sd);