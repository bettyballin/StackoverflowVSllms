void AddFiles(AnsiString path)\n{\n    TSearchRec sr;\n    int f;\n    f = FindFirst(path + "\\*.*", faAnyFile, sr);\n    while (!f)\n    {\n        if (sr.Attr & faDirectory)\n        {\n            if (sr.Name != "." && sr.Name != "..")\n            {\n                AnsiString subPath = path + "\\" + sr.Name;\n                AddFiles(subPath);\n            }\n        }\n        else\n        {\n            Form1->ListBox1->Items->Add(path + "\\" + sr.Name);\n        }\n        f = FindNext(sr);\n    }\n    FindClose(sr);\n}