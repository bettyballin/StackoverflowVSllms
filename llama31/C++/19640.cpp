STDMETHODIMP CMyDispatch::Invoke(DISPID dispIdMember, REFIID, LCID, WORD wFlags,\n                                 DISPPARAMS* pDispParams, VARIANT* pVarResult,\n                                 EXCEPINFO*, UINT*)\n{\n    ASSERT(pDispParams->cArgs == 1);\n    ASSERT(VT_DISPATCH == pDispParams->rgvarg[0].vt);\n\n    VARIANTARG* pArg = &pDispParams->rgvarg[0];\n    IDispatch* pDisp = NULL;\n    HRESULT hr = pArg->pdispVal->QueryInterface(IID_IDispatch, (LPVOID*)&pDisp);\n    if (FAILED(hr))\n    {\n        // Handle error\n    }\n\n    CMyDispatch* pMyDispatch = (CMyDispatch*)pDisp;\n    // Use pMyDispatch as needed\n\n    return S_OK;\n}