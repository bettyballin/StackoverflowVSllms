STARTUPINFO info={sizeof(info)};\nPROCESS_INFORMATION processInfo;\nHANDLE hToken = NULL;\n\n// Get the token of the user account under which the service is running\nif (!OpenProcessToken(GetCurrentProcess(), TOKEN_DUPLICATE, &hToken)) {\n    // Handle error\n}\n\n// Create a new process as the user\nif (CreateProcessAsUser(hToken, PATH, ARGS, NULL, NULL, FALSE, 0, NULL, NULL, &info, &processInfo)) {\n    // Wait for the process to finish\n    WaitForSingleObject(processInfo.hProcess, INFINITE);\n\n    // Get the exit code\n    DWORD exit = 100;\n    GetExitCodeProcess(processInfo.hProcess, &exit);\n\n    // Close handles\n    CloseHandle(processInfo.hProcess);\n    CloseHandle(processInfo.hThread);\n    CloseHandle(hToken);\n\n    return exit;\n}