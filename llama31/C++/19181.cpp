HKEY hKey;\nDWORD dwData = 120;\n\nif (enabled) {\n    dwData = 120;\n}\n\nif (RegOpenKeyEx(HKEY_LOCAL_MACHINE, _T("System\\CurrentControlSet\\Control\\Power\\Timeouts"), 0, KEY_SET_VALUE, &hKey) != ERROR_SUCCESS) {\n    return FALSE;\n}\n\nif (RegSetValueEx(hKey, _T("BattSuspendTimeout"), 0, REG_DWORD, (LPBYTE)&dwData, sizeof(DWORD)) != ERROR_SUCCESS) {\n    RegCloseKey(hKey);\n    return FALSE;\n}\n\nRegCloseKey(hKey);\nreturn TRUE;