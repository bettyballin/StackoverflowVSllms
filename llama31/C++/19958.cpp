#include <Windows.h>\n#include <Security.h>\n#include <ShlObj.h>\n\n// ...\n\nSID g_sid = /* your SID here */;\n\nint main() {\n    HANDLE hToken = NULL;\n    HANDLE hProcess = NULL;\n\n    // Get the process handle for the system process (which has the desired user's token)\n    if (OpenProcessToken(GetCurrentProcess(), TOKEN_QUERY | TOKEN_DUPLICATE, &hProcess) == 0) {\n        // error handling\n    }\n\n    // Duplicate the token to get an impersonation token\n    if (DuplicateToken(hProcess, SecurityImpersonation, &hToken) == 0) {\n        // error handling\n    }\n\n    // Impersonate the user using the duplicated token\n    if (ImpersonateLoggedOnUser(hToken) == 0) {\n        // error handling\n    }\n\n    // Now you can use the ShGetFolderPath function to get the CSIDL_LOCAL_APPDATA\n    PWSTR path = NULL;\n    HRESULT hr = SHGetFolderPath(NULL, CSIDL_LOCAL_APPDATA, NULL, 0, &path);\n\n    // ...\n\n    // Don't forget to revert the impersonation\n    RevertToSelf();\n\n    return 0;\n}