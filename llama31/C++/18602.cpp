#include <windows.h>\n#include <fwpmu.h>\n\nint IsIpBlocked(const char* ip_address) {\n    // Initialize the Windows Filtering Platform\n    FWPM_SESSION0 session;\n    FWPM_PROVIDER0 provider;\n    DWORD result = FwpmEngineOpen0(NULL, RPC_C_AUTHN_WINNT, NULL, &session, &provider);\n    if (result != ERROR_SUCCESS) {\n        return -1; // Error initializing WFP\n    }\n\n    // Create a filter condition to check if the IP address is blocked\n    FWPM_FILTER_CONDITION0 condition;\n    condition.fieldKey = FWPM_CONDITION_IP_REMOTE_ADDRESS;\n    condition.matchType = FWP_MATCH_EQUAL;\n    condition.conditionValue.type = FWP_UINT32;\n    condition.conditionValue.uint32 = inet_addr(ip_address);\n\n    // Enumerate the filters and check if the IP address is blocked\n    FWPM_FILTER_ENUM_TEMPLATE0 enum_template;\n    enum_template.providerKey = &provider.providerKey;\n    enum_template.layerKey = FWPM_LAYER_INBOUND_TRANSPORT_V4;\n    enum_template.enumFlags = FWPM_ENUM_FLAG_FILTER;\n    FWPM_FILTER0* filters;\n    DWORD num_filters;\n    result = FwpmFilterEnum0(session, &enum_template, &filters, &num_filters);\n    if (result != ERROR_SUCCESS) {\n        FwpmEngineClose0(session, NULL, NULL);\n        return -1; // Error enumerating filters\n    }\n\n    for (DWORD i = 0; i < num_filters; i++) {\n        FWPM_FILTER0* filter = &filters[i];\n        if (filter->action.type == FWP_ACTION_BLOCK && filter->condition.numConditions > 0) {\n            FWPM_FILTER_CONDITION0* cond = &filter->condition.conditions[0];\n            if (cond->fieldKey == FWPM_CONDITION_IP_REMOTE_ADDRESS && cond->matchType == FWP_MATCH_EQUAL) {\n                if (cond->conditionValue.uint32 == inet_addr(ip_address)) {\n                    FwpmFreeMemory0((void**)&filters);\n                    FwpmEngineClose0(session, NULL, NULL);\n                    return 1; // IP address is blocked\n                }\n            }\n        }\n    }\n\n    FwpmFreeMemory0((void**)&filters);\n    FwpmEngineClose0(session, NULL, NULL);\n    return 0; // IP address is not blocked\n}