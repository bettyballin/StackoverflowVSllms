class CDBArchive : public CArchive\n{\npublic:\n    CDBArchive(CDatabase* pDB) : m_pDB(pDB) {}\n\n    void Write(const void* lpBuf, UINT nSize)\n    {\n        // Use the database object to write the data\n        // For example, using ADO (ActiveX Data Objects)\n        _variant_t vData;\n        vData.vt = VT_BSTR;\n        vData.bstrVal = SysAllocStringByteLen((LPCSTR)lpBuf, nSize);\n        m_pDB->ExecuteSQL("INSERT INTO table_name (data) VALUES (?)", &vData);\n        SysFreeString(vData.bstrVal);\n    }\n\n    void Read(void* lpBuf, UINT nSize)\n    {\n        // Use the database object to read the data\n        // For example, using ADO (ActiveX Data Objects)\n        _variant_t vData;\n        m_pDB->ExecuteSQL("SELECT data FROM table_name WHERE id = ?", &vData);\n        memcpy(lpBuf, vData.bstrVal, nSize);\n        SysFreeString(vData.bstrVal);\n    }\n\nprivate:\n    CDatabase* m_pDB;\n};