// Define a COM interface\ninterface IMyObject : IUnknown\n{\n    HRESULT MyMethod();\n};\n\n// Define a COM class that implements IMyObject and IDispatch\nclass CMyObject : public IMyObject, public IDispatch\n{\npublic:\n    // Implement IMyObject methods\n    HRESULT MyMethod() { return S_OK; }\n\n    // Implement IDispatch methods\n    HRESULT GetTypeInfoCount(UINT* pctinfo) { return S_OK; }\n    HRESULT GetTypeInfo(UINT itinfo, LCID lcid, ITypeInfo** pptinfo) { return S_OK; }\n    HRESULT GetIDsOfNames(REFIID riid, LPOLESTR* rgszNames, UINT cNames, LCID lcid, DISPID* rgDispId) { return S_OK; }\n    HRESULT Invoke(DISPID dispIdMember, REFIID riid, LCID lcid, WORD wFlags, DISPPARAMS* pDispParams, VARIANT* pVarResult, EXCEPINFO* pExcepInfo, UINT* puArgErr) { return S_OK; }\n};