#include <Windows.h>\n#include <Aclapi.h>\n\nbool CheckDirectoryWritePermission(const WCHAR* directoryPath)\n{\n    HANDLE hDir = CreateFileW(directoryPath, GENERIC_READ, FILE_SHARE_READ, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);\n    if (hDir == INVALID_HANDLE_VALUE)\n    {\n        return false;\n    }\n\n    PACL pDacl = NULL;\n    PSECURITY_DESCRIPTOR pSD = NULL;\n    if (!GetSecurityDescriptorDacl(GetFileSecurityW(directoryPath, OWNER_SECURITY_INFORMATION | DACL_SECURITY_INFORMATION, &pSD), &pDacl, &pDacl))\n    {\n        CloseHandle(hDir);\n        return false;\n    }\n\n    TRUSTEE_W trustee = { 0 };\n    trustee.TrusteeForm = TRUSTEE_IS_NAME;\n    trustee.TrusteeType = TRUSTEE_IS_USER;\n    trustee.ptstrName = (LPWSTR)_T("CURRENT_USER");\n\n    TRUSTEE_W trustees[1];\n    trustees[0] = trustee;\n\n    ACCESS_MASK desiredAccess = FILE_GENERIC_WRITE;\n\n    DWORD grantedAccess;\n    if (AccessCheck(pSD, &trustee, 1, &desiredAccess, &grantedAccess, NULL, NULL, NULL, NULL))\n    {\n        CloseHandle(hDir);\n        return (grantedAccess & desiredAccess) == desiredAccess;\n    }\n\n    CloseHandle(hDir);\n    return false;\n}