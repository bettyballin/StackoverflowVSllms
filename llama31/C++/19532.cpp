#include <windows.h>\n\nint main()\n{\n    // Get the window rectangle\n    RECT rect;\n    GetWindowRect(GetForegroundWindow(), &rect);\n\n    // Create a bitmap\n    HDC hdc = GetDC(NULL);\n    HBITMAP hbm = CreateCompatibleBitmap(hdc, rect.right - rect.left, rect.bottom - rect.top);\n    ReleaseDC(NULL, hdc);\n\n    // Create a memory DC\n    HDC hdcMem = CreateCompatibleDC(NULL);\n\n    // Select the bitmap into the memory DC\n    HGDIOBJ hOld = SelectObject(hdcMem, hbm);\n\n    // Copy the screenshot into the bitmap\n    BitBlt(hdcMem, 0, 0, rect.right - rect.left, rect.bottom - rect.top, GetDC(NULL), 0, 0, SRCCOPY);\n\n    // Save the bitmap to a file\n    PICTDESC pictdesc = { sizeof(PICTDESC) };\n    pictdesc.pictureType = PICTYPE_BITMAP;\n    pictdesc.bmp.hBitmap = hbm;\n    HRESULT hr = OleCreatePictureIndirect(&pictdesc, IID_IPicture, false, (void **)&pPicture);\n\n    // Shutdown\n    DeleteObject(hbm);\n    DeleteDC(hdcMem);\n\n    return 0;\n}