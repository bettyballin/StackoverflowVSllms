IS8Simulation *pis8 = NULL;\n\n// ...\n\nCoCreateInstance(\n    clsid,\n    NULL,\n    CLSCTX_LOCAL_SERVER,\n    __uuidof(IS8Simulation),\n    (void **) &pis8);\n\n// ...\n\nIS8Simulation *pis8Copy = NULL;\nCoAddRef(pis8);\npis8Copy = pis8;\n\nhThread = CreateThread(\n    NULL,\n    0,\n    SecondaryThread,\n    (LPVOID) pis8Copy, // pass copy of interface pointer\n    0,\n    &dwGenericThreadID);\n\n// ...\n\nDWORD WINAPI SecondaryThread(LPVOID lpParameter)\n{\n    IS8Simulation *pis8 = (IS8Simulation *) lpParameter;\n    pis8->Open();\n    CoRelease(pis8); // release copy of interface pointer\n    // ...\n}