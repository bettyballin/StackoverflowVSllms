bool isProcess64Bit(DWORD processId) {\n    HANDLE hProcess = OpenProcess(PROCESS_QUERY_INFORMATION, FALSE, processId);\n    if (hProcess == NULL) {\n        return false;\n    }\n\n    TCHAR szExePath[MAX_PATH];\n    DWORD dwSize = MAX_PATH;\n    QueryFullProcessImageName(hProcess, 0, szExePath, &dwSize);\n\n    CloseHandle(hProcess);\n\n    DWORD dwBinaryType;\n    if (GetBinaryType(szExePath, &dwBinaryType)) {\n        return dwBinaryType == SCS_64BIT_BINARY;\n    }\n\n    return false;\n}