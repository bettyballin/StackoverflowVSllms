const ULONG p = 139;\nconst ULONG g = 5;\n\nCRYPT_DATA_BLOB pblob;\npblob.cbData = sizeof(p);\npblob.pbData = (LPBYTE)&p;\n\nCRYPT_DATA_BLOB gblob;\ngblob.cbData = sizeof(g);\ngblob.pbData = (LPBYTE)&g;\n\nHCRYPTKEY hKey;\nif (::CryptGenKey(m_hCryptoProvider, CALG_DH_SF, CRYPT_PREGEN, &hKey)) {\n    DWORD dwP[1];\n    dwP[0] = p;\n    ::CryptSetKeyParam(hKey, KP_P, (LPBYTE)dwP, 4);\n\n    DWORD dwG[1];\n    dwG[0] = g;\n    ::CryptSetKeyParam(hKey, KP_G, (LPBYTE)dwG, 4);\n}