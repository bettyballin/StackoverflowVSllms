typedef struct {\n    SOCKET socket;\n    RangePtr pRange;\n} ThreadArgs;\n\n// ...\n\nThreadArgs args;\nargs.socket = mySocket;\nargs.pRange = pRange;\n\n// Marshal the interface pointer\nCoMarshalInterThreadInterfaceInStream(__uuidof(Range), pRange, &args.pRangeStream);\n\n// Create the thread\nCreateThread(NULL, 0, MyThreadProc, &args, 0, NULL);\n\n// ...\n\n// In the thread proc:\nDWORD WINAPI MyThreadProc(LPVOID lpParameter)\n{\n    ThreadArgs* args = (ThreadArgs*)lpParameter;\n    SOCKET socket = args->socket;\n    RangePtr pRange;\n    CoUnmarshalInterface(args->pRangeStream, __uuidof(Range), (void**)&pRange);\n\n    // Use the socket and pRange\n    // ...\n}