#include <Windows.h>\n\nstd::wstring GetRegistryKeyPath(HKEY hKey)\n{\n    DWORD dwSize = 0;\n    RegQueryInfoKey(hKey, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, &dwSize);\n    wchar_t* pName = new wchar_t[dwSize + 1];\n    RegQueryInfoKey(hKey, pName, &dwSize, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL);\n\n    // Get the security descriptor of the key\n    PSECURITY_DESCRIPTOR pSD;\n    DWORD dwSDSize = 0;\n    if (ERROR_SUCCESS == RegGetKeySecurity(hKey, DACL_SECURITY_INFORMATION, NULL, &dwSDSize))\n    {\n        pSD = (PSECURITY_DESCRIPTOR)new BYTE[dwSDSize];\n        if (ERROR_SUCCESS == RegGetKeySecurity(hKey, DACL_SECURITY_INFORMATION, pSD, &dwSDSize))\n        {\n            // Get the key's name and path from the security descriptor\n            LPWSTR pKeyName = NULL;\n            if (ERROR_SUCCESS == GetSecurityDescriptorObjectNameW(pSD, &pKeyName, NULL))\n            {\n                // pKeyName now contains the full path to the registry key\n                std::wstring fullPath = pKeyName;\n                LocalFree(pKeyName);\n                delete[] pName;\n                delete[] pSD;\n                return fullPath;\n            }\n        }\n    }\n\n    delete[] pName;\n    return L"";\n}