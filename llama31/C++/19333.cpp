#include <windows.h>\n#include <setupapi.h>\n#include <hidclass.h>\n\n// ...\n\nHANDLE hDevice = CreateFile(devicePath, 0, FILE_SHARE_READ | FILE_SHARE_WRITE, NULL, OPEN_EXISTING, 0, NULL);\n\nif (hDevice != INVALID_HANDLE_VALUE) {\n    WCHAR serialNumber[256];\n    ULONG serialNumberLen = 256;\n\n    if (HidD_GetSerialNumberString(hDevice, serialNumber, &serialNumberLen)) {\n        wprintf(L"Serial Number: %s\n", serialNumber);\n    } else {\n        wprintf(L"Failed to get serial number\n");\n    }\n\n    CloseHandle(hDevice);\n} else {\n    wprintf(L"Failed to open device\n");\n}