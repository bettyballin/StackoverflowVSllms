#include <Windows.h>\n#include <objbase.h>\n\n// ...\n\n// Define the user credentials\nWCHAR szUsername[] = L"privilegeduser";\nWCHAR szPassword[] = L"privilegedpassword";\nWCHAR szDomain[] = L"yourdomain";\n\n// Initialize COM security\nCoInitializeSecurity(NULL, -1, NULL, NULL,\n    RPC_C_AUTHN_LEVEL_PKT_PRIVACY, RPC_C_IMP_LEVEL_IMPERSONATE,\n    NULL, EOAC_NONE, NULL);\n\n// Impersonate the user\nHANDLE hToken;\nLogonUserW(szUsername, szDomain, szPassword, LOGON32_LOGON_INTERACTIVE,\n    LOGON32_PROVIDER_DEFAULT, &hToken);\n\n// Create the COM object under the impersonated user\nCoCreateInstance(CLSID_YourComObject, NULL, CLSCTX_SERVER,\n    IID_IYourComInterface, (LPVOID*)&pYourComObject);\n\n// Revert to self\nRevertToSelf();\n\n// Release the COM object\npYourComObject->Release();\n\n// ...