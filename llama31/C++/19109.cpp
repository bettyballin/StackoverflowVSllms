#include <Windows.h>\n#include <Wtsapi32.h>\n\n// ...\n\nDWORD sessionId = 0;\nHANDLE hSession = NULL;\n\n// Enumerate sessions\nPWTS_SESSION_INFO pSessionInfo;\nDWORD count;\nif (WTSEnumerateSessions(WTS_CURRENT_SERVER_HANDLE, 0, 1, &pSessionInfo, &count)) {\n    for (DWORD i = 0; i < count; i++) {\n        if (pSessionInfo[i].SessionId == WTSGetActiveConsoleSessionId()) {\n            sessionId = pSessionInfo[i].SessionId;\n            break;\n        }\n    }\n    WTSFreeMemory(pSessionInfo);\n}\n\n// ...\n\nif (sessionId != 0) {\n    hSession = WTSOpenSession(WTS_CURRENT_SERVER_HANDLE, sessionId, TRUE, NULL);\n    if (hSession != NULL) {\n        HWND hWnd = FindWindowEx(NULL, NULL, NULL, NULL, WS_EX_SESSIONID, sessionId);\n        // ...\n        WTSCloseSession(hSession);\n    }\n}