#include <upnp.h>\n\nint main() {\n    // Create a service description\n    IUPnPService* service;\n    CoCreateInstance(CLSID_UPnPService, NULL, CLSCTX_INPROC_SERVER, IID_IUPnPService, (LPVOID*)&service);\n\n    // Set the service properties\n    service->put_ServiceType(L"_my_service");\n    service->put_ServiceName(L"My Service");\n\n    // Register the service\n    IUPnPRegistrar* registrar;\n    CoCreateInstance(CLSID_UPnPRegistrar, NULL, CLSCTX_INPROC_SERVER, IID_IUPnPRegistrar, (LPVOID*)&registrar);\n    registrar->RegisterService(service);\n\n    // ...\n}