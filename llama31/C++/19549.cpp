HRESULT CMyInterface::Request()\n{\n    // ...\n    if (!connected)\n    {\n        ICreateErrorInfo* pErrorInfo;\n        HRESULT hr = CreateErrorInfo(&pErrorInfo);\n        if (SUCCEEDED(hr))\n        {\n            pErrorInfo->SetDescription(_T("Not connected"));\n            pErrorInfo->SetGUID(__uuidof(IMyInterface));\n            pErrorInfo->SetHRESULT(HRESULT_FROM_WIN32(ERROR_CONNECTION_INVALID));\n            hr = SetErrorInfo(0, pErrorInfo);\n        }\n        return hr;\n    }\n    // ...\n}