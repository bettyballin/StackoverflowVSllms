// Create a DIB section\nHBITMAP hBitmap;\nHRESULT hr = CreateDIBSection(NULL, \n                              &bmi,  // BITMAPINFO for the DIB\n                              DIB_RGB_COLORS, \n                              &hBitmap, \n                              NULL,  // handle to file mapping object\n                              0);\n\nif (FAILED(hr)) {\n    // handle error\n}\n\n// Create a CDC object to draw on the DIB\nCDC* pDC = CDC::FromHandle(CreateCompatibleDC(NULL));\nHGDIOBJ hObjectOld = pDC->SelectObject(hBitmap);\n\n// Draw on the DIB using the CDC object\n// ...\n\n// Clean up\npDC->SelectObject(hObjectOld);\nDeleteDC(pDC->m_hDC);\nDeleteObject(hBitmap);