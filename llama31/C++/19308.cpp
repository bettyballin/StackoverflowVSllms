#include <windows.h>\n#include <winsta.h>\n\nint main() {\n    // ...\n\n    HANDLE hToken = NULL;\n    HANDLE hProcess = NULL;\n\n    // Get the SYSTEM token\n    OpenProcessToken(GetCurrentProcess(), TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, &hToken);\n    LookupPrivilegeValue(NULL, SE_DEBUG_NAME, &luid);\n    TokenAdjustPrivileges(hToken, FALSE, &tokenPrivileges, sizeof(TOKEN_PRIVILEGES), NULL, NULL);\n\n    // Create a new process under the SYSTEM account\n    STARTUPINFO si = {0};\n    si.cb = sizeof(STARTUPINFO);\n    si.lpDesktop = "WinSta0\\Default";\n\n    PROCESS_INFORMATION pi = {0};\n    CreateProcessAsUser(hToken, NULL, "yourprogram.exe /savekey", NULL, NULL, FALSE, CREATE_UNICODE_ENVIRONMENT, NULL, NULL, &si, &pi);\n\n    // ...\n}