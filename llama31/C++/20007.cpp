#include <mshtml.h>\n#include <exdisp.h>\n\n// Assume you have a pointer to the IWebBrowser2 interface\nIWebBrowser2* pBrowser = ...;\n\n// Get the current URL\nBSTR bstrURL;\nHRESULT hr = pBrowser->get_LocationURL(&bstrURL);\nif (SUCCEEDED(hr)) {\n    // Convert the BSTR to a CString\n    CString strURL(bstrURL);\n    SysFreeString(bstrURL);\n\n    // Use the URL as needed\n    // ...\n}