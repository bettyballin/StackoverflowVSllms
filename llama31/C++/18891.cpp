#include <windows.h>\n#include <imapi2.h>\n\nint main() {\n    IMAPI_MEDIA_PHYSICAL_TYPE mediaType;\n    IMAPI_FEATURE_PAGE_TYPE featurePageType;\n    HRESULT hr = S_OK;\n\n    hr = CoInitialize(NULL);\n    if (FAILED(hr)) {\n        // Handle error\n    }\n\n    IMAPI2Ptr imapi2Interface = NULL;\n    hr = CoCreateInstance(CLSID_MsftDiscFormat2Data, NULL, CLSCTX_INPROC_SERVER, IID_PPV_ARGS(&imapi2Interface));\n    if (FAILED(hr)) {\n        // Handle error\n    }\n\n    IDiscRecorder2Ptr discRecorder = NULL;\n    hr = imapi2Interface->CreateDiscRecorder(&discRecorder);\n    if (FAILED(hr)) {\n        // Handle error\n    }\n\n    BSTR drivePath = SysAllocString(L"E:\\"); // Replace with your CD-ROM drive path\n    hr = discRecorder->InitializeDiscRecorder(drivePath);\n    if (FAILED(hr)) {\n        // Handle error\n    }\n\n    IMAPI_MEDIA_STATUS status;\n    hr = discRecorder->GetMediaStatus(&status);\n    if (FAILED(hr)) {\n        // Handle error\n    }\n\n    if (status == IMAPI_MEDIA_BLANK) {\n        IMAPI_FORMAT2_DATA_WRITE_ptr df2;\n        hr = imapi2Interface->CreateDiscFormatData(&df2);\n        if (FAILED(hr)) {\n            // Handle error\n        }\n\n        hr = df2->GetTotalDiscCapacity(&mediaType);\n        if (FAILED(hr)) {\n            // Handle error\n        }\n\n        hr = df2->GetAvailableDiscCapacity(&mediaType);\n        if (FAILED(hr)) {\n            // Handle error\n        }\n    }\n\n    CoUninitialize();\n    return 0;\n}