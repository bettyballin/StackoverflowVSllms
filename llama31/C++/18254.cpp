#include <Windows.h>\n\nunsigned long GetTargetThreadIdFromWindow(char* className, char* windowName)\n{\n    HWND targetWnd;\n    HANDLE hProcess;\n    unsigned long processID = 0;\n\n    targetWnd = FindWindow(className, windowName);\n    return GetWindowThreadProcessId(targetWnd, &processID);\n}\n\nint _tmain(int argc, _TCHAR* argv[]) {\n    unsigned long threadID = GetTargetThreadIdFromWindow("Notepad", "Untitled - Notepad");\n    printf("TID: %i", threadID);\n\n    HINSTANCE hinst = LoadLibrary(_T("MyDLL.dll"));\n\n    if (hinst) {\n        typedef void (*Install)(unsigned long);\n        typedef void (*Uninstall)();\n\n        Install install = (Install)GetProcAddress(hinst, "install");\n        Uninstall uninstall = (Uninstall)GetProcAddress(hinst, "uninstall");\n\n        install(threadID);\n\n        Sleep(20000);\n\n        uninstall();\n    }\n\n    return 0;\n}