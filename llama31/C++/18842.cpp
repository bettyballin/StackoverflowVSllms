#include <filesystem>\n\n// Assume 'rootDir' is the directory you want to restrict access to\nstd::filesystem::path rootDir = "/path/to/your/ftp/root";\n\n// Client's requested file path\nstd::filesystem::path requestedPath = "../../../../../etc/passwd";\n\n// Canonicalize the requested path to remove any redundant separators and parent directory references\nstd::filesystem::path canonicalPath = std::filesystem::canonical(requestedPath);\n\n// Check if the canonical path is within the root directory\nif (std::filesystem::equivalent(canonicalPath, rootDir) || canonicalPath.lexically_normal().string().find(rootDir.string()) == 0) {\n    // The requested path is within the root directory or its subdirectories\n    // Process the request...\n} else {\n    // The requested path is outside the root directory, reject the request\n    // Handle error...\n}