CWinThread* pThread = AfxGetThread();\nif (pThread->GetMessageLoop() != NULL)\n{\n    // Message loop is already running\n}\nelse\n{\n    // No message loop is running, create a new one\n}