class CustomAudioNotifications : public IAudioSessionNotification\n{\npublic:\n    // Constructors\n    CustomAudioNotifications() { InterlockedIncrement(&g_notifyCount); m_listener = NULL; }\n    ~CustomAudioNotifications() { InterlockedDecrement(&g_notifyCount); SAFE_RELEASE(m_listener); }\n\n    // IUnknown interface\n    HRESULT __stdcall QueryInterface(REFIID riid, void** ppObj)\n    {\n        if (riid == IID_IUnknown)\n        {\n            *ppObj = this;\n            AddRef();\n            return S_OK;\n        }\n        else if (riid == IID_IAudioSessionNotification)\n        {\n            *ppObj = this;\n            AddRef();\n            return S_OK;\n        }\n        else\n        {\n            *ppObj = NULL;\n            return E_NOINTERFACE;\n        }\n    }\n\n    ULONG __stdcall AddRef()\n    {\n        InterlockedIncrement(&m_nRefCount);\n        return m_nRefCount;\n    }\n\n    ULONG __stdcall Release()\n    {\n        InterlockedDecrement(&m_nRefCount);\n        if (m_nRefCount == 0)\n        {\n            delete this;\n        }\n        return m_nRefCount;\n    }\n\n    // Notification\n    HRESULT __stdcall OnSessionCreated(IAudioSessionControl* NewSession)\n    {\n        // Post a message to a window or handle the notification as needed\n        return S_OK;\n    }\n\nprivate:\n    LONG m_nRefCount;\n};