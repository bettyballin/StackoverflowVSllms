#include <outlook.h>\n\nclass MyAddin : public IDispatchImpl<IRibbonExtensibility>\n{\npublic:\n    // IRibbonExtensibility methods\n    STDMETHODIMP GetCustomUI(BSTR RibbonID, BSTR* CustomUI);\n\n    // IRibbonUI methods\n    STDMETHODIMP CreateRibbonUI(IRibbonUI** ppRibbonUI);\n\nprivate:\n    CComPtr<IRibbonUI> m_pRibbonUI;\n};\n\nSTDMETHODIMP MyAddin::GetCustomUI(BSTR RibbonID, BSTR* CustomUI)\n{\n    // Return the custom UI XML for the new button\n    *CustomUI = SysAllocString(L"<customUI xmlns=\"http://schemas.microsoft.com/office/2006/01/customui\"><ribbon><tabs><tab id=\"MyTab\" label=\"My Tab\"><group id=\"MyGroup\" label=\"My Group\"><button id=\"MyButton\" label=\"My Button\" image=\"myimage\" onAction=\"MyButton_Click\"/></group></tab></tabs></ribbon></customUI>");\n    return S_OK;\n}\n\nSTDMETHODIMP MyAddin::CreateRibbonUI(IRibbonUI** ppRibbonUI)\n{\n    // Create the ribbon UI\n    m_pRibbonUI = new IRibbonUI();\n    m_pRibbonUI->AddRef();\n    return S_OK;\n}