// HelloWorld.cpp\n#include "IHelloWorld.h"\n\nclass CHelloWorld : public IHelloWorld\n{\npublic:\n    CHelloWorld() { mRefCount = 1; }\n    ~CHelloWorld() { }\n\n    HRESULT QueryInterface(REFIID riid, void** ppv)\n    {\n        if (riid == IID_IUnknown || riid == IID_IHelloWorld)\n        {\n            *ppv = this;\n            AddRef();\n            return S_OK;\n        }\n        *ppv = NULL;\n        return E_NOINTERFACE;\n    }\n\n    ULONG AddRef()\n    {\n        return InterlockedIncrement(&mRefCount);\n    }\n\n    ULONG Release()\n    {\n        ULONG count = InterlockedDecrement(&mRefCount);\n        if (count == 0)\n        {\n            delete this;\n        }\n        return count;\n    }\n\n    HRESULT SayHello()\n    {\n        printf("Hello, World!\n");\n        return S_OK;\n    }\n\nprivate:\n    LONG mRefCount;\n};\n\n// Factory function\nHRESULT CreateHelloWorld(IHelloWorld** ppHelloWorld)\n{\n    CHelloWorld* pHelloWorld = new CHelloWorld();\n    if (pHelloWorld == NULL)\n    {\n        return E_OUTOFMEMORY;\n    }\n    *ppHelloWorld = pHelloWorld;\n    return S_OK;\n}