SELECT \n  Col1, Col2, Col3, Col4, Col5\nFROM \n  (SELECT \n    Value, \n    ColumnName = CASE \n      WHEN Col1 IS NOT NULL THEN 'Col1'\n      WHEN Col2 IS NOT NULL THEN 'Col2'\n      WHEN Col3 IS NOT NULL THEN 'Col3'\n      WHEN Col4 IS NOT NULL THEN 'Col4'\n      WHEN Col5 IS NOT NULL THEN 'Col5'\n    END\n  FROM \n    (SELECT \n      Col1, Col2, Col3, Col4, Col5\n    FROM YourTable) AS T\n  UNPIVOT \n    (Value FOR ColumnName IN (Col1, Col2, Col3, Col4, Col5)) AS U\n) AS T\nPIVOT \n  (MAX(Value) FOR ColumnName IN (Col1, Col2, Col3, Col4, Col5)) AS P\nORDER BY NEWID()