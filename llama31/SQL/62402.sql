CREATE FUNCTION dbo.SplitCSV (@csv text)\nRETURNS @ids TABLE (id int)\nAS\nBEGIN\n    DECLARE @id int, @pos int\n    SET @pos = 1\n    WHILE @pos <= LEN(@csv)\n    BEGIN\n        SET @id = CONVERT(int, SUBSTRING(@csv, @pos, CHARINDEX(',', @csv, @pos) - @pos))\n        INSERT INTO @ids (id) VALUES (@id)\n        SET @pos = CHARINDEX(',', @csv, @pos) + 1\n    END\n    RETURN\nEND\nGO\n\nCREATE PROCEDURE GetGroupMembers\nAS\nBEGIN\n    CREATE TABLE #GroupMembers (GroupID int, UserID int)\n    \n    INSERT INTO #GroupMembers (GroupID, UserID)\n    SELECT u.ID, s.id\n    FROM UserTable u\n    CROSS APPLY dbo.SplitCSV(u.Members) s\n    WHERE u.IsGroup = 1\n    \n    SELECT * FROM #GroupMembers\n    DROP TABLE #GroupMembers\nEND\nGO