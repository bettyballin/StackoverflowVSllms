DECLARE @temp TABLE\n(\n    id INT IDENTITY(1,1),\n    Name VARCHAR(150),\n    Address VARCHAR(25),\n    Date DATETIME\n)\n\nWHILE (@count >= @daysBack)\nBEGIN\n    SET @date = DATEADD(dd, @count, GETDATE())\n\n    INSERT INTO @temp (Name, Address, Date)\n    SELECT Name, Address, @date\n    FROM OPENROWSET('SQLNCLI', 'Server=(local);Trusted_Connection=yes;', 'EXEC [dbo].StoredProc @date')\n\n    SET @count = @count - 1\nEND