DECLARE @source_principal sysname = 'public';\nDECLARE @target_principal sysname = 'newRole';\n\nDECLARE @sql NVARCHAR(MAX) = '';\n\nSELECT @sql += 'GRANT ' + permission_name + ' ON ' + \n               QUOTENAME(s.name) + '.' + QUOTENAME(o.name) + ' TO ' + \n               QUOTENAME(@target_principal) + ';'\nFROM sys.database_permissions p\nJOIN sys.database_principals pr ON p.grantee_principal_id = pr.principal_id\nJOIN sys.objects o ON p.major_id = o.object_id\nJOIN sys.schemas s ON o.schema_id = s.schema_id\nWHERE pr.name = @source_principal;\n\nEXEC sp_executesql @sql;