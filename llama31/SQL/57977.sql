SELECT \n  T1.PersonCode,\n  T1.Name,\n  T2.Location,\n  T2.ServiceDate\nFROM \n  Table1 T1\n  INNER JOIN (\n    SELECT \n      Table1ID,\n      Location,\n      MAX(ServiceDate) AS LatestServiceDate\n    FROM \n      Table2\n    GROUP BY \n      Table1ID, Location\n  ) LATEST ON T1.ID = LATEST.Table1ID\n  INNER JOIN Table2 T2 ON T2.Table1ID = LATEST.Table1ID AND T2.Location = LATEST.Location AND T2.ServiceDate = LATEST.LatestServiceDate\nWHERE \n  T1.PersonCode = 'XYZ';