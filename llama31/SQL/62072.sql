SELECT DISTINCT \n    pat.PublicationID\nFROM \n    dbo.PubAdvTransData AS pat \nINNER JOIN \n    dbo.PubAdvertiser AS pa ON pat.AdvTransID = pa.AdvTransID\nWHERE \n    (pa.AdvertiserID = 31331) AND (pat.LastAdDate > '2009-07-01')\n\nUNION ALL\n\nSELECT DISTINCT \n    AreaBuy.AreaBuyID AS PublicationID\nFROM \n    AreaBuy \nINNER JOIN \n    PublicationAreaBuy ON AreaBuy.AreaBuyID = PublicationAreaBuy.AreaBuyID\nINNER JOIN \n    dbo.PubAdvertiser AS PubAdvertiser_1 ON PubAdvertiser_1.PublicationID = PublicationAreaBuy.PublicationID\nINNER JOIN \n    dbo.PubAdvTransData AS pat ON pat.PublicationID = PublicationAreaBuy.PublicationID\nWHERE \n    (PubAdvertiser_1.AdvertiserID = 31331) AND (pat.LastAdDate > '2009-07-01')