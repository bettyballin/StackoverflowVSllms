ALTER FUNCTION [dbo].[fnSplit2]\n(\n    @OLDSTRING AS VARCHAR(100),\n    @DELIMETER AS VARCHAR(1)\n)\nRETURNS @MYTABLE TABLE(COUNTER INT, STRINGVAL VARCHAR(100))\nAS\nBEGIN\n    WITH RecursiveCTE AS (\n        SELECT 1 AS COUNTER, \n               LEFT(@OLDSTRING, CHARINDEX(@DELIMETER, @OLDSTRING) - 1) AS STRINGVAL,\n               RIGHT(@OLDSTRING, LEN(@OLDSTRING) - CHARINDEX(@DELIMETER, @OLDSTRING)) AS REMAINING_STRING\n        WHERE CHARINDEX(@DELIMETER, @OLDSTRING) > 0\n        UNION ALL\n        SELECT COUNTER + 1, \n               LEFT(REMAINING_STRING, CHARINDEX(@DELIMETER, REMAINING_STRING) - 1),\n               RIGHT(REMAINING_STRING, LEN(REMAINING_STRING) - CHARINDEX(@DELIMETER, REMAINING_STRING))\n        FROM RecursiveCTE\n        WHERE CHARINDEX(@DELIMETER, REMAINING_STRING) > 0\n    )\n    INSERT INTO @MYTABLE (COUNTER, STRINGVAL)\n    SELECT COUNTER, STRINGVAL\n    FROM RecursiveCTE\n    UNION ALL\n    SELECT COUNTER + 1, REMAINING_STRING\n    FROM RecursiveCTE\n    WHERE REMAINING_STRING <> '';\n\n    RETURN;\nEND;