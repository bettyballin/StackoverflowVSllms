CREATE TABLE check_minus\n(\n  name_id NUMBER(4),\n  trans NUMBER(4),\n  val NUMBER(2)\n);\n\nINSERT INTO check_minus VALUES (1, 1, 5);\nINSERT INTO check_minus VALUES (1, 2, 5);\nINSERT INTO check_minus VALUES (1, 3, -5);\nINSERT INTO check_minus VALUES (1, 4, 10);\nINSERT INTO check_minus VALUES (1, 5, -10);\nINSERT INTO check_minus VALUES (1, 6, 15);\nINSERT INTO check_minus VALUES (1, 7, 15);\nINSERT INTO check_minus VALUES (1, 8, 15);\nINSERT INTO check_minus VALUES (1, 9, -15);\nINSERT INTO check_minus VALUES (1, 10, 20);\nCOMMIT;\n\nSELECT val\nFROM (\n  WITH reversed AS (\n    SELECT val, COUNT(*) AS cnt\n    FROM check_minus\n    WHERE val < 0\n    GROUP BY val\n  )\n  SELECT val\n  FROM check_minus\n  WHERE val > 0\n  AND val NOT IN (SELECT -val FROM reversed WHERE cnt > 0)\n  OR val IN (\n    SELECT val\n    FROM check_minus\n    WHERE val > 0\n    GROUP BY val\n    HAVING COUNT(*) > (\n      SELECT COUNT(*)\n      FROM reversed\n      WHERE val = -val\n    )\n  )\n)