SELECT \n  DATE_FORMAT(CURDATE(), '%Y-%m-01') AS start_date,\n  DATE_FORMAT(CURDATE(), '%Y-%m-%d') AS end_date,\n  rs.*,\n  sv.*,\n  COUNT(e.id) AS event_count\nFROM \n  regular_schedule rs\n  LEFT JOIN schedule_variations sv ON rs.day_of_week = sv.day_of_week AND sv.date BETWEEN start_date AND end_date\n  LEFT JOIN events e ON rs.day_of_week = DAYOFWEEK(e.date) AND e.date BETWEEN start_date AND end_date\nGROUP BY \n  rs.day_of_week,\n  sv.date