WITH RankedValueSets AS (\n    SELECT \n        OriginatingObjectID, \n        ID, \n        ROW_NUMBER() OVER (PARTITION BY OriginatingObjectID ORDER BY DateStamp DESC) AS Rank\n    FROM \n        ValueSet\n)\nSELECT \n    o.ID, \n    rvs.ID AS LatestValueSetID\nFROM \n    OriginatingObject o\nINNER JOIN \n    RankedValueSets rvs ON o.ID = rvs.OriginatingObjectID AND rvs.Rank = 1