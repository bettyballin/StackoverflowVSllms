WITH RECURSIVE category_hierarchy AS (\n  SELECT \n    id, \n    name, \n    0 AS level,\n    CAST(name AS CHAR(100)) AS path\n  FROM \n    categories\n  UNION ALL\n  SELECT \n    sc.id, \n    sc.name, \n    level + 1,\n    CONCAT(path, ' > ', sc.name)\n  FROM \n    subcategories sc\n  JOIN \n    category_hierarchy ch ON sc.category_id = ch.id\n  UNION ALL\n  SELECT \n    ssc.id, \n    ssc.name, \n    level + 1,\n    CONCAT(path, ' > ', ssc.name)\n  FROM \n    subsubcategories ssc\n  JOIN \n    category_hierarchy ch ON ssc.subcategory_id = ch.id\n)\nSELECT \n  path\nFROM \n  category_hierarchy\nORDER BY \n  path;