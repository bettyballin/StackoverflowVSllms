SELECT BalanceStatus, COUNT(*) AS Count\nFROM (\n  SELECT T1.AccountNo, T1.Balance, T2.Balance, \n         CASE \n           WHEN T2.Balance = 0 THEN 'Zero balance in Temp2'\n           WHEN T1.Balance / T2.Balance > 1.1 THEN 'Mismatch'\n           WHEN T1.Balance / T2.Balance < 0.9 THEN 'Mismatch'\n           ELSE 'Match'\n         END AS BalanceStatus\n  FROM Temp1 T1, Temp2 T2\n  WHERE \n    T1.AccountNo = T2.AccountNo\n) AS Subquery\nGROUP BY BalanceStatus