SELECT string_agg(CASE\n                     WHEN ascii(c) BETWEEN 48 AND 57 OR \n                          ascii(c) BETWEEN 65 AND 90 OR \n                          ascii(c) BETWEEN 97 AND 122 THEN \n                       c\n                     ELSE \n                       '%' || to_hex(ascii(c))\n                   END, '')\nFROM regexp_split_to_table('h√©llo there', '') AS c;