CREATE PROCEDURE sp_myDuplicateCheck\n    @userId int,\n    @noteType char(1),\n    @aCode char(3),\n    @bCode char(3),\n    @cCode char(3),\n    @outDuplicateFound int OUT\nAS\nBEGIN\n    SET @outDuplicateFound = (\n        SELECT Top 1 id \n        FROM codeTable \n        WHERE (userId = @userId OR (@userId IS NULL AND userId IS NULL))\n        AND (noteType = @noteType OR (@noteType IS NULL AND noteType IS NULL))\n        AND (aCode = @aCode OR (@aCode IS NULL AND aCode IS NULL))\n        AND (bCode = @bCode OR (@bCode IS NULL AND bCode IS NULL))\n        AND (cCode = @cCode OR (@cCode IS NULL AND cCode IS NULL))\n    )\n\n    -- Now set the duplicate output flag to a 1 or a 0\n    IF (@outDuplicateFound IS NULL) OR (@outDuplicateFound = '') OR (@outDuplicateFound = 0)\n        SET @outDuplicateFound = 0\n    ELSE \n        SET @outDuplicateFound = 1\nEND