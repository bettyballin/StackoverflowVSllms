WITH\n  x AS (SELECT 1 id FROM dual UNION SELECT 2 FROM dual UNION SELECT 3 FROM dual),\n  y AS (\n    SELECT id, nr, code,\n           ROW_NUMBER() OVER (PARTITION BY id ORDER BY nr) AS row_num\n    FROM (\n      SELECT 1 id, 1 nr, 'B' code FROM dual\n      UNION SELECT 1, 2, 'A'  FROM dual\n      UNION SELECT 2, 2, 'A' FROM dual\n    )\n  )\nSELECT x.id, y.nr, y.code\nFROM x\nLEFT OUTER JOIN y ON (y.id = x.id AND y.row_num = 1)