SELECT \n  CONCAT(c.name, \n         IF(sc.name IS NOT NULL, ' > ' + sc.name, ''),\n         IF(ssc.name IS NOT NULL, ' > ' + ssc.name, '')) AS full_name\nFROM \n  categories c\n  LEFT JOIN subcategories sc ON c.id = sc.category_id\n  LEFT JOIN subsubcategories ssc ON sc.id = ssc.subcategory_id\nWHERE \n  sc.name IS NOT NULL OR ssc.name IS NOT NULL OR c.id NOT IN (SELECT category_id FROM subcategories)\nUNION ALL\nSELECT \n  c.name AS full_name\nFROM \n  categories c\nWHERE \n  c.id IN (SELECT category_id FROM subcategories)