-- Create a CHECK constraint to ensure that at least one of the columns is not null\nALTER TABLE Node\nADD CONSTRAINT CK_Node_AtLeastOneColumnNotNull\nCHECK (\n    (LinkNode_Title IS NOT NULL AND LinkNode_Url IS NOT NULL)\n    OR (HtmlPageNode_Html IS NOT NULL)\n    OR (CodePageNode_Code IS NOT NULL)\n);\n\n-- Create a trigger to enforce the rules based on the node type\nCREATE TRIGGER TR_Node_EnforceRules\nON Node\nFOR INSERT, UPDATE\nAS\nBEGIN\n    IF UPDATE(NodeType)\n    BEGIN\n        IF EXISTS (\n            SELECT 1\n            FROM inserted\n            WHERE NodeType = 'LinkNode'\n            AND (LinkNode_Title IS NULL OR LinkNode_Url IS NULL)\n        )\n        BEGIN\n            RAISERROR ('LinkNode requires both Title and Url to be not null', 16, 1);\n            ROLLBACK TRANSACTION;\n        END\n\n        IF EXISTS (\n            SELECT 1\n            FROM inserted\n            WHERE NodeType = 'HtmlPageNode'\n            AND HtmlPageNode_Html IS NULL\n        )\n        BEGIN\n            RAISERROR ('HtmlPageNode requires Html to be not null', 16, 1);\n            ROLLBACK TRANSACTION;\n        END\n\n        IF EXISTS (\n            SELECT 1\n            FROM inserted\n            WHERE NodeType = 'CodePageNode'\n            AND CodePageNode_Code IS NULL\n        )\n        BEGIN\n            RAISERROR ('CodePageNode requires Code to be not null', 16, 1);\n            ROLLBACK TRANSACTION;\n        END\n    END\nEND;