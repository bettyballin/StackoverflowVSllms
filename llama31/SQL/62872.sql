-- Create a CDC capture instance\nEXEC sys.sp_cdc_add_job @job_type = N'capture';\n\n-- Create a CDC capture table\nEXEC sys.sp_cdc_add_table @source_schema = N'dbo', @source_name = N'mytable', @role_name = N'myrole';\n\n-- Create a stored procedure to notify an external application\nCREATE PROCEDURE sp_notify_external_app\nAS\nBEGIN\n    DECLARE @changes TABLE (id INT, data VARCHAR(50));\n    INSERT INTO @changes (id, data)\n    SELECT id, data FROM cdc.fn_cdc_get_all_changes_dbo_mytable (@from_lsn = NULL, @to_lsn = NULL, @row_filter = N'all');\n\n    -- Notify external application\n    EXEC msdb.dbo.sp_send_dbmail @recipients = N'external_app@example.com', @subject = N'Database changes', @body = N'See attached file for changes.';\nEND;\n\n-- Create a CDC capture job to execute the stored procedure\nEXEC sys.sp_cdc_add_job @job_type = N'capture', @enabled = 1, @schedule = N'every 1 minute', @command = N'EXEC sp_notify_external_app';