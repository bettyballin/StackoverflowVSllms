BEGIN TRANSACTION;\n\nUPDATE MailingListSubscription\nSET PersonID = @DestPerson\nWHERE PersonID = @SourcePerson;\n\nINSERT INTO MailingListSubscription (ListID, PersonID)\nSELECT ListID, @DestPerson\nFROM MailingListSubscription\nWHERE PersonID = @SourcePerson\nAND NOT EXISTS (\n  SELECT 1\n  FROM MailingListSubscription\n  WHERE ListID = MailingListSubscription.ListID\n  AND PersonID = @DestPerson\n);\n\nCOMMIT TRANSACTION;