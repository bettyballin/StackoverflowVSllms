WITH VideoTags AS (\n  SELECT VideoID, value AS Tag\n  FROM Videos\n  CROSS APPLY dbo.Split(Tags, ',') AS Tags(value)\n),\nRelatedVideos AS (\n  SELECT v2.VideoID, COUNT(*) AS MatchCount\n  FROM VideoTags vt1\n  INNER JOIN VideoTags vt2 ON vt1.Tag = vt2.Tag AND vt1.VideoID <> vt2.VideoID\n  WHERE vt1.VideoID = 1  -- Change to the current video ID\n  GROUP BY v2.VideoID\n)\nSELECT TOP 10 v.* \nFROM RelatedVideos rv\nINNER JOIN Videos v ON rv.VideoID = v.VideoID\nORDER BY rv.MatchCount DESC;