CREATE PROCEDURE get_ancestors(IN node_id INT)\nBEGIN\n  WITH RECURSIVE ancestors AS (\n    SELECT parent_node_id, child_node_id, 0 AS level\n    FROM hierarchy\n    WHERE child_node_id = node_id\n    UNION ALL\n    SELECT h.parent_node_id, h.child_node_id, level + 1\n    FROM hierarchy h\n    JOIN ancestors a ON h.child_node_id = a.parent_node_id\n  )\n  SELECT * FROM ancestors;\nEND;