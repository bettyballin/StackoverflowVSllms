-- Get top 10 longest-running queries\nSELECT TOP 10 qs.execution_count, qs.total_logical_reads, qs.total_logical_writes, \n       qs.total_cpu_time, qs.total_elapsed_time, \n       SUBSTRING(st.text, qs.statement_start_offset/2 + 1, \n                 (CASE WHEN qs.statement_end_offset = -1 THEN LEN(st.text) \n                      ELSE qs.statement_end_offset/2 - qs.statement_start_offset/2 + 1 END)) AS statement\nFROM sys.dm_exec_query_stats qs\nCROSS APPLY sys.dm_exec_sql_text(qs.sql_handle) st\nORDER BY qs.total_elapsed_time DESC;\n\n-- Get top 10 resource-intensive sessions\nSELECT TOP 10 s.session_id, s.login_name, s.program_name, \n       s.cpu_usage * 100 / SUM(s.cpu_usage) OVER () AS cpu_usage_percent, \n       s.memory_usage * 100 / SUM(s.memory_usage) OVER () AS memory_usage_percent\nFROM sys.dm_exec_sessions s\nORDER BY s.cpu_usage DESC;