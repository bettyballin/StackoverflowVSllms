SELECT Date, COUNT(DISTINCT U.UserID)\nFROM UsageLog AS L\nCROSS APPLY (\n  SELECT DISTINCT UserID\n  FROM UsageLog AS U\n  WHERE U.Date = L.Date AND U.UserID = L.UserID\n) AS U\nWHERE L.Date BETWEEN 200901 AND 200902\nGROUP BY L.Date