SELECT \n    col1,\n    col2,\n    col3,\n    CASE \n        WHEN condition THEN intermediateResult1\n        ELSE intermediateResult2\n    END AS calculatedcol1,\n    col4,\n    col5\nFROM (\n    SELECT \n        col1,\n        col2,\n        col3,\n        CASE \n            WHEN condition THEN \n                CASE \n                    WHEN condition1 THEN calculation1\n                    ELSE calculation3\n                END\n            ELSE \n                CASE \n                    WHEN condition1 THEN calculation5\n                    ELSE calculation7\n                END\n        END AS intermediateResult1,\n        CASE \n            WHEN condition THEN \n                CASE \n                    WHEN condition2 THEN calculation2\n                    ELSE calculation4\n                END\n            ELSE \n                CASE \n                    WHEN condition2 THEN calculation6\n                    ELSE calculation8\n                END\n        END AS intermediateResult2\n    FROM (\n        SELECT \n            col1,\n            col2,\n            col3,\n            condition,\n            condition1,\n            condition2,\n            calculation1,\n            calculation2,\n            calculation3,\n            calculation4,\n            calculation5,\n            calculation6,\n            calculation7,\n            calculation8\n        FROM \n            table\n    ) AS derivedTable\n) AS outerDerivedTable;