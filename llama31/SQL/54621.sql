SELECT \n    pv.Path AS EntryPage, \n    COUNT(DISTINCT pv.Path) AS [Count]\nFROM \n    PageViews pv\n    INNER JOIN (\n        SELECT \n            s.SessionID, \n            FIRST_VALUE(pv.Created) OVER (PARTITION BY s.SessionID ORDER BY pv.Created) AS Created\n        FROM \n            Sessions s\n            INNER JOIN Visitors v ON s.VisitorID = v.VisitorID\n            INNER JOIN PageViews pv ON s.SessionID = pv.SessionID\n        WHERE \n            pv.Domain = ISNULL(@Domain, pv.Domain) \n            AND v.Campaign = @Campaign\n    ) t1 ON pv.SessionID = t1.SessionID AND pv.Created = t1.Created\nGROUP BY \n    pv.Path;