DECLARE @recipients VARCHAR(MAX);\nDECLARE @recipient TABLE (email VARCHAR(255));\n\n-- populate @recipients\nSET @recipients = 'person1@yahoo.com;person2@hotmail.com;person1@yahoo.com;';\n\n-- split the string into a table\nDECLARE @pos INT;\nDECLARE @email VARCHAR(255);\n\nSET @pos = CHARINDEX(';', @recipients);\nWHILE @pos > 0\nBEGIN\n    SET @email = LEFT(@recipients, @pos - 1);\n    INSERT INTO @recipient (email) VALUES (@email);\n    SET @recipients = SUBSTRING(@recipients, @pos + 1, LEN(@recipients));\n    SET @pos = CHARINDEX(';', @recipients);\nEND\n\n-- get the distinct recipients\nSELECT DISTINCT email FROM @recipient;