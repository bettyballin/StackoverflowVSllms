ALTER PROCEDURE [dbo].[test] \n    @p_SortExpression NVARCHAR(100),\n    @p_StartIndex INT,\n    @p_MaxRows INT,\n    @p_SearchKeyword NVARCHAR(100)\nAS\nSET NOCOUNT ON;\n\nIF LEN(@p_SortExpression) = 0 \n    SET @p_SortExpression = 'DateTime DESC'\n\nDECLARE @Sql NVARCHAR(4000)\nSET @Sql = '\n    SELECT ID, DateTime, Subject, CreatedBy, ToReceipientID , ReceiverStatus\n    FROM (\n        SELECT ID, DateTime, Subject, CreatedBy, ToReceipientID, ReceiverStatus,\n        ROW_NUMBER() OVER(ORDER BY ' + @p_SortExpression + ') AS Indexing\n        FROM ComposeMail\n        WHERE (Subject LIKE ''%'' + @p_SearchKeyword + ''%'')\n    ) AS NewDataTable\n    WHERE Indexing > @p_StartIndex AND Indexing <= (@p_StartIndex + @p_MaxRows)\n'\n\nEXEC sp_executesql @sql, N'@p_SearchKeyword nvarchar(100), @p_StartIndex int, @p_MaxRows int', \n                   @p_SearchKeyword = @p_SearchKeyword, \n                   @p_StartIndex = @p_StartIndex, \n                   @p_MaxRows = @p_MaxRows