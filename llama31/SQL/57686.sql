SELECT \n  deptno, \n  empno, \n  hiredate, \n  COUNT(*) OVER (PARTITION BY deptno \n                 ORDER BY hiredate \n                 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_hired_before1,\n  COUNT(*) OVER (PARTITION BY deptno \n                 ORDER BY hiredate \n                 RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_hired_before2\nFROM emp\nWHERE deptno = 30\nORDER BY deptno, hiredate;