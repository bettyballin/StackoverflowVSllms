CREATE TABLE phone_numbers (\n  number VARCHAR(20),\n  type VARCHAR(10),\n  person_id INT\n);\n\nINSERT INTO phone_numbers (number, type, person_id)\nVALUES\n  ('17182225465', 'home', 1),\n  ('19172225465', 'cell', 1),\n  ('12129876543', 'home', 2),\n  ('13049876543', 'cell', 2),\n  ('15064223454', 'home', 3),\n  ('15064223454', 'cell', 3),\n  ('18724356798', 'home', 4),\n  ('19174335465', 'cell', 5);\n\n-- Query 1\nSELECT h.*\nFROM phone_numbers h\nLEFT JOIN phone_numbers c\n  ON h.person_id = c.person_id AND c.type = 'cell'\nWHERE h.type = 'home' AND c.number IS NULL;\n\n-- Query 2\nSELECT h.*\nFROM phone_numbers h\nLEFT JOIN phone_numbers c\n  ON h.person_id = c.person_id AND h.type = 'home' AND c.type = 'cell'\nWHERE c.number IS NULL;