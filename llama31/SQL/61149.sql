SELECT \n    t.name AS table_name,\n    c.name AS column_name,\n    CASE \n        WHEN pk.column_id IS NOT NULL THEN 'PK'\n        WHEN fk.column_id IS NOT NULL THEN 'FK'\n        ELSE ''\n    END AS column_type\nINTO #columns\nFROM \n    sys.tables t\nJOIN \n    sys.columns c ON t.object_id = c.object_id\nLEFT JOIN \n    sys.index_columns pk ON c.object_id = pk.object_id AND c.column_id = pk.column_id\nLEFT JOIN \n    sys.foreign_key_columns fk ON c.object_id = fk.parent_object_id AND c.column_id = fk.parent_column_id\n\n-- Generate view creation script\nSELECT \n    'CREATE VIEW ' + table_name + '_view AS' AS view_creation,\n    'SELECT ' + STRING_AGG(column_name, ', ') + ' FROM ' + table_name AS view_select\nFROM \n    #columns\nGROUP BY \n    table_name