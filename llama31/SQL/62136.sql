CREATE PROCEDURE web.getRandomCharities (@tmp_ID bigint --members ID)\nAS\nBEGIN\n    WITH q AS\n    (\n        SELECT TOP 5 *\n        FROM TBL_CHARITIES\n        WHERE cha_Active = 'TRUE'\n            AND cha_Key != '1'\n        ORDER BY NEWID()\n    )\n    SELECT * FROM q\n    UNION ALL\n    SELECT TOP 1 * FROM (\n        SELECT * FROM TBL_CHARITIES\n        WHERE TBL_CHARITIES.cha_Key IN \n            (SELECT members_Favourite FROM TBL_MEMBERS WHERE members_Id = @tmp_ID)\n            OR (cha_Key = '1' AND cha_Key NOT IN (SELECT members_Favourite FROM TBL_MEMBERS WHERE members_Id = @tmp_ID))\n        EXCEPT SELECT * FROM q\n    ) tc\nEND