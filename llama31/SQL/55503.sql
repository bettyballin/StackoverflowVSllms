DECLARE @db1 sysname = 'Database1'\nDECLARE @db2 sysname = 'Database2'\n\nDECLARE @sql nvarchar(max) = ''\n\nSELECT @sql += '\n    SELECT ''' + TABLE_NAME + ''' AS table_name, \n           CHECKSUM_AGG(BINARY_CHECKSUM(*)) AS checksum\n    FROM ' + QUOTENAME(@db1) + '.' + QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME) + '\n    UNION ALL\n    SELECT ''' + TABLE_NAME + ''' AS table_name, \n           CHECKSUM_AGG(BINARY_CHECKSUM(*)) AS checksum\n    FROM ' + QUOTENAME(@db2) + '.' + QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME) + '\n'\nFROM INFORMATION_SCHEMA.TABLES\nWHERE TABLE_TYPE = 'BASE TABLE'\n\nEXEC sp_executesql @sql