WITH minutes AS (\n  SELECT DISTINCT \n    strftime('%Y-%m-%d %H:%M', start_ts) AS minute\n  FROM sessions\n  WHERE start_ts >= DATETIME('now', 'start of day')  -- Adjust the range as needed\n  AND start_ts < DATETIME('now', 'start of day', '+1 day')\n  UNION ALL\n  SELECT DISTINCT \n    strftime('%Y-%m-%d %H:%M', end_ts) AS minute\n  FROM sessions\n  WHERE end_ts >= DATETIME('now', 'start of day')  -- Adjust the range as needed\n  AND end_ts < DATETIME('now', 'start of day', '+1 day')\n)\nSELECT \n  minute AS TIME_INTERVAL,\n  COUNT(DISTINCT session_id) AS ACTIVE_SESSIONS\nFROM minutes\nLEFT JOIN sessions ON\n  strftime('%Y-%m-%d %H:%M', sessions.start_ts) <= minutes.minute\n  AND strftime('%Y-%m-%d %H:%M', sessions.end_ts) >= minutes.minute\nGROUP BY minute\nORDER BY minute;