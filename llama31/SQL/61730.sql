with foo(parent_id, child_id, row_num) as (\n  -- anchor member\n  select parent_id, child_id, ROW_NUMBER() OVER (ORDER BY parent_id, child_id) as row_num\n  from #bar \n  where parent_id in (1, 3)\n  union all\n  -- recursive member\n  select #bar.parent_id, #bar.child_id, foo.row_num + 1\n  from #bar \n  join foo on #bar.parent_id = foo.child_id\n)\nselect parent_id, child_id from foo\nwhere row_num = 1