SELECT \n  L.L_VTDID,\n  (MAX(W.WP_ODOMETER) - MIN(W.WP_ODOMETER)) / DATEDIFF(DAY, MIN(W.WP_DATETIME), MAX(W.WP_DATETIME)) AS MAXD,\n  MAX(W.WP_ODOMETER) AS MD\nFROM \n  LOCOMOTIVES L\n  INNER JOIN WAYPOINTS W ON L.L_VTDID = W.WP_VTDID\nWHERE \n  W.WP_DATETIME BETWEEN DATEADD(DAY, -14, GETDATE()) AND GETDATE()\nGROUP BY \n  L.L_VTDID