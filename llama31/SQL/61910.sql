WITH indexCTE AS\n(\n    SELECT Table_Name, Column_Name, Collation_Name \n    FROM information_schema.columns \n    WHERE Collation_Name IS NOT NULL AND Collation_Name = 'Modern_Spanish_CI_AS'\n),\nindexCTE2 AS\n(\n    SELECT i.Name [Index Name], OBJECT_NAME(i.object_ID) [Table Name], c.Name [Column Name]\n    FROM sys.indexes i \n    INNER JOIN sys.index_columns ic ON i.index_id = ic.index_id AND i.object_id = ic.object_id\n    INNER JOIN sys.columns c ON ic.column_id = c.column_id AND ic.object_id = c.OBJECT_ID\n    WHERE EXISTS (SELECT 1 FROM indexCTE t1 WHERE t1.Table_Name = OBJECT_NAME(i.object_ID) AND t1.Column_Name = c.Name)\n)\nSELECT \n    'CREATE INDEX ' + QUOTENAME([Index Name]) + ' ON ' + QUOTENAME([Table Name]) + ' (' + QUOTENAME([Column Name]) + ');'\nFROM indexCTE2