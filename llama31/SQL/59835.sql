SELECT \n  s.session_id, \n  MIN(s.created) AS session_start, \n  MAX(p.page_id) AS last_page_viewed\nFROM \n  (SELECT session_id, MIN(created) AS created FROM page_views GROUP BY session_id) s\n  JOIN page_views p ON s.session_id = p.session_id\nGROUP BY \n  s.session_id