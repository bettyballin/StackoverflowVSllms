CREATE TABLE InvoiceNumbers (\n    InvoiceNumber nvarchar(12) PRIMARY KEY\n);\n\nCREATE PROCEDURE GenerateInvoiceNumber\nAS\nBEGIN\n    DECLARE @randomNumber nvarchar(12);\n    SET @randomNumber = CONVERT(nvarchar(12), NEWID());\n    WHILE EXISTS (SELECT 1 FROM InvoiceNumbers WHERE InvoiceNumber = @randomNumber)\n    BEGIN\n        SET @randomNumber = CONVERT(nvarchar(12), NEWID());\n    END\n    INSERT INTO InvoiceNumbers (InvoiceNumber) VALUES (@randomNumber);\n    RETURN @randomNumber;\nEND;