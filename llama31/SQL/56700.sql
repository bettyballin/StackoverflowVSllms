CREATE TABLE #PageIndexForUsers (\n    UserId INT\n);\n\nINSERT INTO #PageIndexForUsers (UserId)\nSELECT u.UserId\nFROM dbo.aspnet_Users u\nWHERE u.ApplicationId = @ApplicationId AND u.LoweredUserName LIKE LOWER(@UserNameToMatch);\n\n-- Join with primary table for further processing\nSELECT u.UserName, m.Email, -- ... other columns ...\nFROM dbo.aspnet_Users u\nJOIN dbo.aspnet_Membership m ON u.UserId = m.UserId\nJOIN #PageIndexForUsers p ON u.UserId = p.UserId\nWHERE p.IndexId >= @PageLowerBound AND p.IndexId <= @PageUpperBound;