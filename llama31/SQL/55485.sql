SELECT a.user, pp.courriel\nFROM acces a\nINNER JOIN acces_profil_sport ap ON ap.id = a.id\nINNER JOIN profil_perso pp ON pp.id = a.id\nWHERE EXISTS (\n  SELECT 1\n  FROM activite_sport ac\n  INNER JOIN activite a2 ON a2.activite_id = ac.activite_id\n  WHERE a2.is_cron = 1 AND a2.cron_processed = 0 AND ac.sport_id = ap.sport_id\n)\nAND EXISTS (\n  SELECT 1\n  FROM activite_region ar\n  INNER JOIN activite a2 ON a2.activite_id = ar.activite_id\n  WHERE a2.is_cron = 1 AND a2.cron_processed = 0 AND ar.region_id = pp.region_id\n)\nGROUP BY a.id;