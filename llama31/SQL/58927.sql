WITH dates AS (\n  SELECT TOP 7 \n    DATEADD(DAY, -ROW_NUMBER() OVER (ORDER BY object_id), GETDATE()) AS date\n  FROM sys.all_columns\n)\nSELECT \n  d.date, \n  COALESCE(COUNT(i.incident_id), 0) AS "Calls", \n  MAX(i.open_time) AS max_open_time\nFROM dates d\nLEFT JOIN (\n  SELECT \n    incident_id, \n    open_time - (9.0/24) AS open_time, \n    DATEPART(dd, (open_time-(9.0/24))) AS open_day\n  FROM incidentsm1 \n  WHERE DATEDIFF(DAY, open_time-(9.0/24), GETDATE()) < 7\n) i ON d.date = i.open_time\nGROUP BY d.date\nORDER BY d.date;