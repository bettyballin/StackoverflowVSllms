WITH RecursiveReplace AS (\n    SELECT textlong1, \n           0 AS level,\n           CASE \n               WHEN CHARINDEX(';', textlong1) > 10 \n               THEN SUBSTRING(textlong1, CHARINDEX('fcharset', textlong1) + 10, CHARINDEX(';', textlong1) - CHARINDEX('fcharset', textlong1) - 10) \n               ELSE '' \n           END AS font_name\n    FROM exampletable\n\n    UNION ALL\n\n    SELECT REPLACE(textlong1, font_name, 'Times New Roman'), \n           level + 1,\n           CASE \n               WHEN CHARINDEX(';', textlong1, CHARINDEX('fcharset', textlong1) + 10) > 0 \n               THEN SUBSTRING(textlong1, CHARINDEX('fcharset', textlong1, CHARINDEX('fcharset', textlong1) + 10) + 10, CHARINDEX(';', textlong1, CHARINDEX('fcharset', textlong1) + 10) - CHARINDEX('fcharset', textlong1, CHARINDEX('fcharset', textlong1) + 10) - 10) \n               ELSE '' \n           END AS font_name\n    FROM RecursiveReplace\n    WHERE font_name <> ''\n)\nSELECT TOP 1 textlong1\nFROM RecursiveReplace\nORDER BY level DESC