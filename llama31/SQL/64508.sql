SELECT a.name, \n       LTRIM(MAX(SYS_CONNECT_BY_PATH(b.name, ', ')), ', ') AS brands\nFROM (\n  SELECT a.name, b.name, ROW_NUMBER() OVER (PARTITION BY a.name ORDER BY b.name) AS rn\n  FROM alert a\n  JOIN alert_brand_xref ab ON a.id = ab.alert_id\n  JOIN brand b ON ab.brand_id = b.id\n) t\nSTART WITH rn = 1\nCONNECT BY PRIOR name = name AND PRIOR rn = rn - 1\nGROUP BY a.name\nORDER BY a.name;