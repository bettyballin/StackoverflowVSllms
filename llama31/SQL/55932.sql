CREATE PROCEDURE sp_CalculateVariance\nAS\nBEGIN\n    DECLARE @CurrentMonth INT = MONTH(GETDATE())\n    DECLARE @PreviousMonth INT = @CurrentMonth - 1\n    DECLARE @Year INT = YEAR(GETDATE())\n\n    SELECT \n        Field1, \n        Field2, \n        ...,\n        (CurrentMonthValue - PreviousMonthValue) AS Variance\n    INTO \n        #VarianceTable\n    FROM \n        YourTable\n    WHERE \n        DateField >= DATEFROMPARTS(@Year, @PreviousMonth, 1) \n        AND DateField < DATEFROMPARTS(@Year, @CurrentMonth, 1)\n\n    INSERT INTO VarianceReport (Field1, Field2, ..., Variance)\n    SELECT \n        Field1, \n        Field2, \n        ...,\n        Variance\n    FROM \n        #VarianceTable\nEND