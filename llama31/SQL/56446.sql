DECLARE @hostname sysname = 'stackoverflow.com'\nDECLARE @ipaddress sysname\n\nCREATE TABLE #temp (output nvarchar(255))\n\nINSERT INTO #temp\nEXEC master..xp_cmdshell 'ping -n 1 ' + @hostname\n\nSELECT @ipaddress = SUBSTRING(output, CHARINDEX('[', output) + 1, CHARINDEX(']', output) - CHARINDEX('[', output) - 1)\nFROM #temp\nWHERE output LIKE '%[%]'\n\nDROP TABLE #temp\n\nSELECT @ipaddress AS ipaddress