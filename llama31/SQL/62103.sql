CREATE TABLE #HashValues (\n    AccountNum INT,\n    HashValue VARBINARY(20)\n)\n\nINSERT #HashValues (AccountNum, HashValue)\nSELECT AccountNum, HASHBYTES('MD5', CONVERT(VARCHAR(50), AccountNum) + Name)\nFROM AccountsNew\n\nINSERT AccountsAdded(AccountNum, Name)\nSELECT n.AccountNum, n.Name\nFROM AccountsNew n\nLEFT JOIN #HashValues h ON n.AccountNum = h.AccountNum\nWHERE h.HashValue NOT IN (SELECT HashValue FROM #HashValues WHERE AccountNum IN (SELECT AccountNum FROM AccountsCurrent))\n\nINSERT AccountsRemoved(AccountNum, Name)\nSELECT c.AccountNum, c.Name\nFROM AccountsCurrent c\nLEFT JOIN #HashValues h ON c.AccountNum = h.AccountNum\nWHERE h.HashValue NOT IN (SELECT HashValue FROM #HashValues WHERE AccountNum IN (SELECT AccountNum FROM AccountsNew))