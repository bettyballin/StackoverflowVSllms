WITH \n  -- Get the total number of apps\n  total_apps AS (\n    SELECT COUNT(*) AS total\n    FROM APP\n  ),\n  \n  -- Get the number of apps covered by at least two people with skill level 2 or higher\n  covered_apps AS (\n    SELECT COUNT(DISTINCT id_app) AS covered\n    FROM SKILL\n    WHERE lvl >= 2\n    GROUP BY id_app\n    HAVING COUNT(DISTINCT id_profile) >= 2\n  )\n\nSELECT \n  (covered / total) * 100 AS coverage_percentage\nFROM \n  total_apps,\n  covered_apps;