CREATE PROCEDURE sp_ForwardDemoDataDates\nAS\nBEGIN\n    DECLARE @tableName nvarchar(128)\n    DECLARE @columnName nvarchar(128)\n    DECLARE @columnType nvarchar(128)\n    DECLARE @sql nvarchar(max)\n    DECLARE @lastForwardedDate datetime\n\n    -- Get the last forwarded date\n    SELECT @lastForwardedDate = LastForwardedDate FROM DemoDataForwardingHistory\n\n    -- Loop through all tables\n    DECLARE table_cursor CURSOR FOR\n        SELECT table_name\n        FROM Information_Schema.Tables\n        WHERE TABLE_TYPE = 'BASE TABLE'\n            AND table_name NOT LIKE 'Report_%'\n            AND table_name NOT IN ('Accounts', 'Manifest', 'System', 'Users')\n\n    OPEN table_cursor\n\n    FETCH NEXT FROM table_cursor INTO @tableName\n\n    WHILE @@FETCH_STATUS = 0\n    BEGIN\n        -- Loop through all columns in the current table\n        DECLARE column_cursor CURSOR FOR\n            SELECT COLUMN_NAME, DATA_TYPE\n            FROM Information_Schema.Columns\n            WHERE TABLE_NAME = @tableName\n\n        OPEN column_cursor\n\n        FETCH NEXT FROM column_cursor INTO @columnName, @columnType\n\n        WHILE @@FETCH_STATUS = 0\n        BEGIN\n            -- Check if the column is of type datetime\n            IF @columnType = 'datetime'\n            BEGIN\n                -- Build the update statement\n                SET @sql = 'UPDATE ' + @tableName + ' SET ' + @columnName + ' = DATEADD(day, 30, ' + @columnName + ') WHERE DemoUserId = ''DemoUser'' AND ' + @columnName + ' < GETDATE()'\n\n                -- Execute the update statement\n                EXEC sp_executesql @sql\n            END\n\n            FETCH NEXT FROM column_cursor INTO @columnName, @columnType\n        END\n\n        CLOSE column_cursor\n        DEALLOCATE column_cursor\n\n        FETCH NEXT FROM table_cursor INTO @tableName\n    END\n\n    CLOSE table_cursor\n    DEALLOCATE table_cursor\n\n    -- Update the last forwarded date\n    UPDATE DemoDataForwardingHistory SET LastForwardedDate = GETDATE()\nEND