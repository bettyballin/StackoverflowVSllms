WITH numbered_rows AS (\n  SELECT\n    ROW_NUMBER() OVER (ORDER BY date) AS row_num,\n    date,\n    product\n  FROM\n    your_table\n)\nSELECT\n  row_num,\n  MIN(date) AS start_date,\n  MAX(date) AS end_date,\n  product\nFROM (\n  SELECT\n    row_num,\n    date,\n    product,\n    CASE\n      WHEN row_num % 2 = 1 THEN date\n      ELSE LAG(date) OVER (ORDER BY row_num)\n    END AS start_date\n  FROM\n    numbered_rows\n) AS subquery\nGROUP BY\n  row_num, product\nORDER BY\n  row_num;