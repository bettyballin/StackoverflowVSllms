SELECT *\nFROM (\n  SELECT Name, Value,\n         CASE\n           WHEN Value > :param THEN Value\n           ELSE NULL\n         END AS filtered_value\n  FROM your_table\n)\nWHERE filtered_value = (SELECT MIN(filtered_value)\n                        FROM (\n                          SELECT CASE\n                                   WHEN Value > :param THEN Value\n                                   ELSE NULL\n                                 END AS filtered_value\n                          FROM your_table\n                        )\n                        WHERE filtered_value IS NOT NULL)\nOR (filtered_value IS NULL AND Value = (SELECT MAX(Value) FROM your_table));