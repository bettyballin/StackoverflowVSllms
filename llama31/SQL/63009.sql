SELECT \n  object_id,\n  SUM(score) AS total_score,\n  SUM(CASE WHEN score = 1 THEN 1 ELSE 0 END) AS upvotes,\n  SUM(CASE WHEN score = -1 THEN 1 ELSE 0 END) AS downvotes\nFROM \n  ratings\nGROUP BY \n  object_id;