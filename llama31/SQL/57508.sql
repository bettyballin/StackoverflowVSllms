BEGIN TRANSACTION\nBEGIN TRY\n    UPDATE mytable WITH (ROWLOCK, XLOCK) SET counter = counter + 1\n    COMMIT TRANSACTION\nEND TRY\nBEGIN CATCH\n    ROLLBACK TRANSACTION\nEND CATCH