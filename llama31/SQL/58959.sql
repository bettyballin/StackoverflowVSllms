DELIMITER //\nCREATE PROCEDURE get_log_references()\nBEGIN\n  DECLARE table_name VARCHAR(255);\n  DECLARE done INT DEFAULT FALSE;\n  DECLARE cur CURSOR FOR SELECT reference_table_name FROM log;\n  DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = TRUE;\n\n  OPEN cur;\n\n  read_loop: LOOP\n    FETCH cur INTO table_name;\n    IF done THEN\n      LEAVE read_loop;\n    END IF;\n\n    SET @sql = CONCAT('SELECT * FROM log l JOIN ', table_name, ' r ON l.reference_id = r.id');\n    PREPARE stmt FROM @sql;\n    EXECUTE stmt;\n    DEALLOCATE PREPARE stmt;\n  END LOOP;\n\n  CLOSE cur;\nEND//\nDELIMITER ;