CREATE PROCEDURE GetDocument\n    @UserId INT,\n    @DocId INT\nAS\nBEGIN\n    IF EXISTS (\n        SELECT 1\n        FROM UserDocumentPermissions\n        WHERE UserId = @UserId AND DocId = @DocId\n    )\n    BEGIN\n        SELECT DocumentData\n        FROM Documents\n        WHERE DocId = @DocId;\n    END\n    ELSE\n    BEGIN\n        RAISERROR ('Access denied', 16, 1);\n    END\nEND;