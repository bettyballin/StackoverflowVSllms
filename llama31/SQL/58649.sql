DECLARE @sql nvarchar(max)\nDECLARE @pivotList nvarchar(max)\n\nSELECT @pivotList = COALESCE(@pivotList + ',', '') + QUOTENAME(AssignmentName)\nFROM (SELECT DISTINCT AssignmentName FROM YourTable) AS AssignmentList\n\nSET @sql = N'\n    SELECT StudentName, ' + @pivotList + ', Total\n    FROM (\n        SELECT StudentName, AssignmentName, Grade\n        FROM YourTable\n    ) AS SourceTable\n    PIVOT (\n        SUM(Grade)\n        FOR AssignmentName IN (' + @pivotList + ')\n    ) AS PivotTable\n'\n\nEXEC sp_executesql @sql