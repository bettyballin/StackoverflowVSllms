WITH RankedRows AS (\n  SELECT DocNum, DocEntry,\n         ROW_NUMBER() OVER (PARTITION BY DocNum ORDER BY DocEntry) AS RowNum\n  FROM Temp5\n)\nSELECT DocNum, \n       STUFF((SELECT ', ' + CONVERT(VARCHAR(10), DocEntry)\n              FROM RankedRows r2\n              WHERE r2.DocNum = r1.DocNum\n              ORDER BY r2.RowNum\n              FOR XML PATH('')), 1, 2, '') AS DocEntryList\nFROM RankedRows r1\nGROUP BY DocNum\nORDER BY DocNum;