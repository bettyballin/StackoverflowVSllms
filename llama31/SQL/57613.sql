CREATE INDEX name_gin_idx ON your_table USING GIN (name gin_trgm_ops);\n\nSELECT * FROM your_table\nWHERE name ILIKE ANY (ARRAY['%' || REGEXP_SPLIT_TO_ARRAY('search_string', '') || '%'])\nORDER BY (\n  SELECT SUM(\n    CASE\n      WHEN POSITION(REGEXP_SPLIT_TO_ARRAY('search_string', '')[i] IN name) = 0 THEN 0\n      ELSE 1\n    END\n  )\n  FROM generate_series(1, array_length(REGEXP_SPLIT_TO_ARRAY('search_string', ''), 1)) i\n) DESC;