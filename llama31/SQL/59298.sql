CREATE FUNCTION dbo.CRC32 (@input varchar(max))\nRETURNS int\nAS\nBEGIN\n    DECLARE @crc int = 0xFFFFFFFF\n    DECLARE @len int = LEN(@input)\n    DECLARE @i int = 0\n\n    WHILE @i < @len\n    BEGIN\n        DECLARE @char int = ASCII(SUBSTRING(@input, @i + 1, 1))\n        SET @crc = (@crc ^ @char) AND 0xFFFFFFFF\n        SET @crc = (@crc * 16777219) AND 0xFFFFFFFF\n        SET @i += 1\n    END\n\n    RETURN ~@crc AND 0xFFFFFFFF\nEND\nGO