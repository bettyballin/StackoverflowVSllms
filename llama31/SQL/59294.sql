CREATE FUNCTION dbo.CalculateNextPayDateFrom (@fromDate datetime)\nRETURNS datetime\nAS\nBEGIN\n    DECLARE @firstEverPayment datetime\n    SET @firstEverPayment = '2009-06-01'\n\n    DECLARE @daysSinceFirstPayment int\n    SET @daysSinceFirstPayment = DATEDIFF(day, @firstEverPayment, @fromDate)\n\n    DECLARE @nextPayment datetime\n    SET @nextPayment = DATEADD(day, ((@daysSinceFirstPayment / 14) + 1) * 14, @firstEverPayment)\n\n    RETURN @nextPayment\nEND