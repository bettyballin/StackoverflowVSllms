DECLARE\n  batch_size NUMBER := 10000;  -- adjust batch size as needed\n  min_rowid ROWID;\n  max_rowid ROWID;\n\nBEGIN\n  LOOP\n    SELECT MIN(ROWID), MAX(ROWID)\n    INTO min_rowid, max_rowid\n    FROM vr_location\n    WHERE usps_address IS NULL  -- or any other condition to filter rows\n    AND ROWNUM <= batch_size;\n\n    EXIT WHEN min_rowid IS NULL;\n\n    UPDATE vr_location l\n    SET l.usps_address = (\n      SELECT mylib.string_utils.remove_duplicate_whitespace(\n        house_number || ' ' || pre_street_direction || ' ' || street_name || ' ' ||\n        street_description || ' ' || post_street_direction)\n      FROM vr_address a\n      WHERE a.address_pk = l.address_pk\n    )\n    WHERE ROWID BETWEEN min_rowid AND max_rowid;\n\n    COMMIT;\n\n    UPDATE vr_location\n    SET usps_address = mylib.usaddress_utils.parse_address(usps_address)\n    WHERE ROWID BETWEEN min_rowid AND max_rowid;\n\n    COMMIT;\n  END LOOP;\nEND;