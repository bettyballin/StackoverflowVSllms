WITH AbsenceSequences AS (\n  SELECT EmployeeNumber, EntryDate, Status,\n         ROW_NUMBER() OVER (PARTITION BY EmployeeNumber ORDER BY EntryDate) AS RowNumber,\n         CASE WHEN Status = 'A' AND LAG(Status) OVER (PARTITION BY EmployeeNumber ORDER BY EntryDate) = 'A' \n              THEN 1 ELSE 0 END AS IsConsecutiveAbsence\n  FROM Attendance\n)\nSELECT EmployeeNumber, EntryDate, Status, RowNumber\nFROM AbsenceSequences\nWHERE IsConsecutiveAbsence = 1 AND RowNumber >= n;