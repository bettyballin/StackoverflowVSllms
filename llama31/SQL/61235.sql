DECLARE\n  -- List of tables to export\n  TYPE table_list IS TABLE OF VARCHAR2(30);\n  tables_to_export table_list := table_list('TABLE1', 'TABLE2', 'TABLE3'); -- Add or remove tables as needed\n\n  -- File handle\n  v_file UTL_FILE.FILE_TYPE;\n\n  -- Dynamic SQL variables\n  v_sql VARCHAR2(32767);\n  v_ref SYS_REFCURSOR;\n\n  -- Column names\n  TYPE column_list IS TABLE OF VARCHAR2(30);\n  v_columns column_list;\n\n  -- Data variables\n  v_value VARCHAR2(32767);\nBEGIN\n  FOR i IN 1..tables_to_export.COUNT LOOP\n    -- Get column names\n    v_sql := 'SELECT column_name FROM all_tab_columns WHERE table_name = ''' || tables_to_export(i) || ''' ORDER BY column_id';\n    EXECUTE IMMEDIATE v_sql BULK COLLECT INTO v_columns;\n\n    -- Open file for writing\n    v_file := UTL_FILE.FOPEN(tables_to_export(i) || '.csv', 'W');\n\n    -- Write column headings\n    FOR j IN 1..v_columns.COUNT LOOP\n      UTL_FILE.PUT(v_file, '"' || v_columns(j) || '"|');\n    END LOOP;\n    UTL_FILE.PUT_LINE(v_file, '');\n\n    -- Fetch data and write to file\n    v_sql := 'SELECT * FROM ' || tables_to_export(i);\n    OPEN v_ref FOR v_sql;\n    LOOP\n      FETCH v_ref INTO v_value;\n      EXIT WHEN v_ref%NOTFOUND;\n      FOR j IN 1..v_columns.COUNT LOOP\n        UTL_FILE.PUT(v_file, '"' || v_value || '"|');\n      END LOOP;\n      UTL_FILE.PUT_LINE(v_file, '');\n    END LOOP;\n    CLOSE v_ref;\n\n    -- Close file\n    UTL_FILE.FCLOSE(v_file);\n  END LOOP;\nEND;