MERGE INTO KeyMap km\nUSING (\n  SELECT trunc(ID/100) AS batchID, \n         LISTAGG(KEY, ',') WITHIN GROUP (ORDER BY ID) AS key_values\n  FROM Source\n  GROUP BY trunc(ID/100)\n) src\nON (km.batchID = src.batchID)\nWHEN MATCHED THEN\n  UPDATE SET km.key1 = REGEXP_SUBSTR(src.key_values, '[^,]+', 1, 1),\n             km.key2 = REGEXP_SUBSTR(src.key_values, '[^,]+', 1, 2),\n             km.key3 = REGEXP_SUBSTR(src.key_values, '[^,]+', 1, 3),\n             ...\n             km.key99 = REGEXP_SUBSTR(src.key_values, '[^,]+', 1, 99);