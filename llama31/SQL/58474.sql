WITH availability AS (\n  SELECT \n    split_part(availability_string, ' ', 2) AS start_date,\n    split_part(availability_string, 'to ', 2) AS end_date,\n    split_part(availability_string, 'exclude ', 2) AS exclusions\n  FROM your_table\n)\nINSERT INTO exclusions (availability_id, exclusion)\nSELECT \n  availability_id,\n  unnest(string_to_array(exclusions, ', ')) AS exclusion\nFROM availability\nWHERE exclusions IS NOT NULL;\n\nUPDATE your_table\nSET start_date = split_part(availability_string, ' ', 2),\n    end_date = split_part(availability_string, 'to ', 2)\nFROM availability;