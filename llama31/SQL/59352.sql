SELECT \n  d.date, \n  COALESCE(COUNT(i.incident_id), 0) AS "Calls", \n  MAX(i.open_time) AS max_open_time\nFROM (\n  SELECT CURDATE() - INTERVAL (a.a + (10 * b.a) + (100 * c.a)) DAY AS date\n  FROM (SELECT 0 AS a UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3 UNION ALL SELECT 4 UNION ALL SELECT 5 UNION ALL SELECT 6 UNION ALL SELECT 7 UNION ALL SELECT 8 UNION ALL SELECT 9) AS a\n  CROSS JOIN (SELECT 0 AS a UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3 UNION ALL SELECT 4 UNION ALL SELECT 5 UNION ALL SELECT 6 UNION ALL SELECT 7 UNION ALL SELECT 8 UNION ALL SELECT 9) AS b\n  CROSS JOIN (SELECT 0 AS a UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3 UNION ALL SELECT 4 UNION ALL SELECT 5 UNION ALL SELECT 6 UNION ALL SELECT 7 UNION ALL SELECT 8 UNION ALL SELECT 9) AS c\n) d\nLEFT JOIN (\n  SELECT \n    incident_id, \n    open_time - INTERVAL 9 HOUR AS open_time, \n    DAY(open_time - INTERVAL 9 HOUR) AS open_day\n  FROM incidentsm1 \n  WHERE open_time - INTERVAL 9 HOUR > CURDATE() - INTERVAL 7 DAY\n) i ON d.date = i.open_time\nGROUP BY d.date\nORDER BY d.date;