BEGIN TRANSACTION;\n\n-- Truncate the inactive table and update the data\nTRUNCATE TABLE inactive_table;\nINSERT INTO inactive_table (...) SELECT ... FROM source_data;\n\n-- Update the view to point to the new table\nALTER VIEW my_view AS SELECT * FROM inactive_table;\n\n-- Brief delay to allow pending queries to complete\nWAITFOR DELAY '00:00:02';\n\n-- Commit the transaction\nCOMMIT TRANSACTION;