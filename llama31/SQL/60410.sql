CREATE FUNCTION dbo.Split (@string nvarchar(max), @delimiter nvarchar(10))\nRETURNS @array TABLE (value nvarchar(max))\nAS\nBEGIN\n    DECLARE @pos int, @piece nvarchar(max)\n    SET @pos = 1\n    WHILE @pos <= LEN(@string)\n    BEGIN\n        SET @piece = LEFT(@string, CHARINDEX(@delimiter, @string + @delimiter, @pos) - @pos)\n        INSERT @array (value) VALUES (@piece)\n        SET @pos = CHARINDEX(@delimiter, @string + @delimiter, @pos) + 1\n    END\n    RETURN\nEND\nGO\n\nDECLARE @LIST nvarchar(max) = 'Bob|Mary|Joe'\n\nSELECT u.*\nFROM Users u\nWHERE u.FirstName IN (SELECT value FROM dbo.Split(@LIST, '|'))