SELECT \n  a.QuestionID, \n  a.Answer, \n  t.ShopID\nFROM \n  tblAnswer a\n  INNER JOIN tblTransaction t ON a.TransactionID = t.TransactionID\n  INNER JOIN (\n    SELECT \n      q.QuestionID, \n      s.ShopID, \n      MAX(t.Created) AS LatestTransactionDate\n    FROM \n      tblQuestion q\n      INNER JOIN tblAnswer a ON q.QuestionID = a.QuestionID\n      INNER JOIN tblTransaction t ON a.TransactionID = t.TransactionID\n      INNER JOIN tblShop s ON t.ShopID = s.ShopID\n    GROUP BY \n      q.QuestionID, \n      s.ShopID\n  ) AS latest_answers ON a.QuestionID = latest_answers.QuestionID \n                        AND t.ShopID = latest_answers.ShopID \n                        AND t.Created = latest_answers.LatestTransactionDate