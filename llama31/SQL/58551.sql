CREATE FUNCTION dbo.WordFrequency (@tableName nvarchar(255), @columnName nvarchar(255))\nRETURNS @wordFrequency TABLE (word nvarchar(255), frequency int)\nAS\nBEGIN\n    INSERT INTO @wordFrequency (word, frequency)\n    SELECT \n        value, \n        COUNT(*) as frequency\n    FROM \n        @tableName t\n    CROSS APPLY \n        STRING_SPLIT(t.@columnName, ' ') s\n    WHERE \n        value <> ''\n    GROUP BY \n        value\n    ORDER BY \n        frequency DESC\n\n    RETURN\nEND\nGO