SELECT \n  s.story_id, \n  s.story_title, \n  COUNT(CASE WHEN v.vote_code = 1 AND v.vote_date >= $start_date THEN 1 END) AS num_yes,\n  COUNT(CASE WHEN v.vote_code = 0 AND v.vote_date >= $start_date THEN 1 END) AS num_no\nFROM \n  stories s\n  LEFT JOIN votes v ON s.story_id = v.vote_storyid\nWHERE \n  v.vote_date >= $start_date\nGROUP BY \n  s.story_id, s.story_title\nORDER BY \n  num_yes DESC;  // or num_no DESC for worst articles