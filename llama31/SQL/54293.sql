WITH Revisions AS (\n  SELECT c.CreatedAt AS RevisionId, c.LocalId\n  FROM Countries c\n  WHERE c.LocalId = @Country\n  UNION ALL\n  SELECT p.CreatedAt AS RevisionId, c.LocalId\n  FROM Provinces p\n  INNER JOIN Countries c ON p.CountryId = c.LocalId\n  WHERE c.LocalId = @Country\n  UNION ALL\n  SELECT c.RemovedAt AS RevisionId, c.LocalId\n  FROM Countries c\n  WHERE c.LocalId = @Country\n  UNION ALL\n  SELECT p.RemovedAt AS RevisionId, c.LocalId\n  FROM Provinces p\n  INNER JOIN Countries c ON p.CountryId = c.LocalId\n  WHERE c.LocalId = @Country\n)\nSELECT DISTINCT RevisionId\nFROM Revisions