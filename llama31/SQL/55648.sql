SELECT \n  COMPANY_NAME,\n  PRODUCT_NAME,\n  SALE_COUNT\nFROM (\n  SELECT \n    C.COMPANY_NAME,\n    P.PRODUCT_NAME,\n    PS.SALE_COUNT\n  FROM \n    COMPANY C\n    INNER JOIN PRODUCT_SALE PS ON C.ID_COMPANY = PS.ID_COMPANY\n    INNER JOIN PRODUCT P ON PS.ID_PRODUCT = P.ID_PRODUCT\n)\nPIVOT (\n  SUM(SALE_COUNT)\n  FOR PRODUCT_NAME IN (SELECT DISTINCT PRODUCT_NAME FROM PRODUCT)\n)