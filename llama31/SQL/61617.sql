ALTER FUNCTION [dbo].[IP4toBIGINT](\n    @ip4 varchar(15)\n) \nRETURNS bigint\nWITH SCHEMABINDING\nAS\nBEGIN\n    DECLARE @oct0 bigint, @oct1 bigint, @oct2 bigint, @oct3 bigint;\n    DECLARE @Result bigint;\n\n    DECLARE @dot1 int, @dot2 int, @dot3 int;\n    SET @dot1 = CHARINDEX('.', @ip4);\n    SET @dot2 = CHARINDEX('.', @ip4, @dot1 + 1);\n    SET @dot3 = CHARINDEX('.', @ip4, @dot2 + 1);\n\n    SET @oct3 = CAST(SUBSTRING(@ip4, 1, @dot1 - 1) as tinyint);\n    SET @oct2 = CAST(SUBSTRING(@ip4, @dot1 + 1, @dot2 - @dot1 - 1) as tinyint);\n    SET @oct1 = CAST(SUBSTRING(@ip4, @dot2 + 1, @dot3 - @dot2 - 1) as tinyint);\n    SET @oct0 = CAST(SUBSTRING(@ip4, @dot3 + 1, LEN(@ip4) - @dot3) as tinyint);\n\n    SET @Result = @oct3 * 16777216 + @oct2 * 65536 + @oct1 * 256 + @oct0;\n    RETURN @Result;\nEND