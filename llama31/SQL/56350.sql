SELECT \n  m.id, \n  m.uri, \n  GROUP_CONCAT(CASE WHEN p.role = 1 THEN p.name END, ', ') AS actor,\n  GROUP_CONCAT(CASE WHEN p.role = 2 THEN p.name END, ', ') AS artist,\n  GROUP_CONCAT(CASE WHEN p.role = 3 THEN p.name END, ', ') AS publisher,\n  -- add more roles as needed\nFROM \n  media m\n  LEFT JOIN media_to_people mtp ON m.id = mtp.media_id\n  LEFT JOIN people p ON mtp.people_id = p.id\nGROUP BY \n  m.id, \n  m.uri;