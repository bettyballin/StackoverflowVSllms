SELECT CUSTOMER,\n       CUSTOMER_ID,\n       RTRIM(SYS_CONNECT_BY_PATH(PRODUCT, ', '), ', ') AS PRODUCTS\nFROM (\n  SELECT CUSTOMER,\n         CUSTOMER_ID,\n         PRODUCT,\n         ROW_NUMBER() OVER (PARTITION BY CUSTOMER, CUSTOMER_ID ORDER BY PRODUCT) AS RN\n  FROM MAGIC_TABLE\n)\nWHERE RN = 1\nCONNECT BY CUSTOMER = PRIOR CUSTOMER AND CUSTOMER_ID = PRIOR CUSTOMER_ID