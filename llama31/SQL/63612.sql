CREATE TABLE amoreAgentTST01_overflow (\n  id INT PRIMARY KEY,\n  data VARCHAR(255),\n  update_time TIMESTAMP\n);\n\nCREATE TRIGGER test\nAFTER INSERT ON amoreAgentTST01\nFOR EACH ROW\nBEGIN\n  DECLARE table_size INTEGER;\n  DECLARE new_row_size INTEGER;\n  DECLARE threshold INTEGER;\n\n  SELECT SUM(OCTET_LENGTH(data)) INTO table_size FROM amoreAgentTST01;\n  SELECT OCTET_LENGTH(NEW.data) INTO new_row_size;\n  SELECT 500000 INTO threshold;\n\n  IF (table_size + new_row_size) > threshold THEN\n    INSERT INTO amoreAgentTST01_overflow (id, data, update_time)\n    SELECT id, data, update_time\n    FROM amoreAgentTST01\n    ORDER BY update_time ASC\n    LIMIT 1;\n  END IF;\nEND$$\ndelimiter ;