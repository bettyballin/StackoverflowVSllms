CREATE TABLE huge_table_new (\n    id INT,\n    -- other columns...\n);\n\nDECLARE @batchSize INT = 10000;\nDECLARE @minId INT = 1;\nDECLARE @maxId INT = (SELECT MAX(id) FROM huge_table);\n\nWHILE @minId <= @maxId\nBEGIN\n    INSERT INTO huge_table_new (id, -- other columns...)\n    SELECT TOP (@batchSize) id, -- other columns...\n    FROM huge_table\n    WHERE id >= @minId\n    ORDER BY id;\n\n    SET @minId += @batchSize;\n    CHECKPOINT;\nEND;