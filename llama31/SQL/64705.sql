BEGIN TRANSACTION;\n\n-- Detect duplicate data\nSELECT * INTO #duplicates\nFROM mytable\nWHERE column_name IN (\n  SELECT column_name\n  FROM mytable\n  GROUP BY column_name\n  HAVING COUNT(*) > 1\n);\n\n-- Handle duplicates (e.g., archive or merge data)\nIF EXISTS (SELECT 1 FROM #duplicates) BEGIN\n  -- Archive duplicates\n  INSERT INTO archive_table (column_name, ...)\n  SELECT column_name, ...\n  FROM #duplicates;\n\n  -- Remove duplicates from original table\n  DELETE FROM mytable\n  WHERE column_name IN (SELECT column_name FROM #duplicates);\nEND;\n\n-- Create unique index\nCREATE UNIQUE INDEX myindex ON mytable (column_name);\n\nCOMMIT TRANSACTION;