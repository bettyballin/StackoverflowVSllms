CREATE TRIGGER trg_ForUpdateOnBookIssuedDetails\non BOOKISSUEDDETAILS\nFor update\nas\nbegin\n    declare @Rows1 int, @Rows2 int\n    if update(ReturnedOn)\n    begin\n        IF EXISTS(SELECT 1 FROM INSERTED)\n        begin\n            update nur\n            set nur.NumberOfBooksIssued = nur.NumberOfBooksIssued -1\n            from NewUserRegister nur inner join INSERTED i\n            on i.IssuedTo=nur.UserName\n\n            set @Rows1 = @@RowCount\n\n            update lbd set Inventory = Inventory +1\n            from LIBRARYBOOKDETAILS lbd inner join inserted i\n            on lbd.BookID = i.BookId\n\n            set @Rows2 = @@rowcount\n\n            if @Rows1 * @rows2 > 0\n                commit tran\n            else\n                begin\n                    raiserror('Error Updating the Database',16,-1)\n                    rollback tran\n                end\n        end\n    end\nend