CREATE PROCEDURE Get_Checksum\n    @DatabaseName      varchar(100),\n    @TableName         varchar(100),\n    @Checksum         float OUTPUT\nAS\nBEGIN\n    -- your code here...\n    DECLARE @SQL nvarchar(4000)\n    DECLARE @ColumnName varchar(100)\n    DECLARE @i int\n    DECLARE @intColumns table (idRecord int identity(1,1), ColumnName varchar(255))\n    DECLARE @CS table (MyCheckSum bigint)\n\n    SET @SQL = 'Insert Into @IntColumns(ColumnName)' + Char(13) + \n               'Select Column_Name' + Char(13) + \n               'From   ' + @DatabaseName + '.Information_Schema.Columns (NOLOCK)' + Char(13) + \n               'Where  Table_Name = ''' + @TableName + '''' + Char(13) + \n               '       and Data_Type = ''int''' \n\n    EXEC sp_executeSql @SQL\n\n    SET @SQL = 'Insert Into @CS(MyChecksum)' + Char(13) + \n               'Select '\n\n    SET @i = 1\n\n    WHILE EXISTS(\n        SELECT 1\n        FROM   @IntColumns\n        WHERE  IdRecord = @i\n    )\n    BEGIN\n        SELECT @ColumnName = ColumnName\n        FROM   @IntColumns\n        WHERE  IdRecord = @i\n\n        SET @SQL = @SQL + Char(13) + \n                  CASE WHEN @i = 1 THEN \n                       '    Sum(Cast(IsNull(' + @ColumnName + ',0) as bigint))'\n                       ELSE\n                       '    + Sum(Cast(IsNull(' + @ColumnName + ',0) as bigint))'\n                  END\n\n        SET @i = @i + 1\n    END\n\n    SET @SQL = @SQL + Char(13) + \n               'From ' + @DatabaseName + '..' + @TableName + ' (NOLOCK)'\n\n    EXEC sp_executeSql @SQL\n\n    SET @Checksum = (SELECT TOP 1 MyChecksum FROM @CS)\n\n    RETURN\nEND\nGO