SELECT productID\nFROM products_tree\nGROUP BY productID\nHAVING SUM(CASE WHEN categoryID IN (1040, 1050, 1168) THEN 1 ELSE 0 END) > 0\nAND SUM(CASE WHEN categoryID NOT IN (1040, 1050, 1168) THEN 1 ELSE 0 END) = 0;