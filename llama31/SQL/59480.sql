SELECT \n  p.*,\n  i.type,\n  i.width,\n  i.height,\n  ls.name AS state,\n  lr.name AS region,\n  pm.start_date AS promotion_start_date,\n  pm.end_date AS promotion_end_date\nFROM \n  (SELECT parts_id FROM Parts_Category WHERE category_id = '40' UNION SELECT parts_id FROM Parts_Category WHERE main_category_id = '40') cid\n  JOIN Parts p ON p.id = cid.parts_id AND p.status = 'A'\n  LEFT JOIN Image i ON p.image_id = i.id\n  LEFT JOIN Location_State ls ON p.state_id = ls.id\n  LEFT JOIN Location_Region lr ON p.region_id = lr.id\n  LEFT JOIN Promotion pm ON p.promotion_id = pm.id\nORDER BY \n  p.level DESC, \n  p.warehouse DESC, \n  p.updated DESC \nLIMIT 0, 15;