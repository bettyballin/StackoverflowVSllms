CREATE TABLE #LongRunningQueries (\n    query_hash VARBINARY(8),\n    query_text NVARCHAR(MAX),\n    execution_time_ms BIGINT\n);\n\nINSERT INTO #LongRunningQueries\nSELECT \n    qs.query_hash,\n    qt.text AS query_text,\n    qs.total_worker_time / 1000 AS execution_time_ms\nFROM \n    sys.dm_exec_query_stats qs\nCROSS APPLY \n    sys.dm_exec_sql_text(qs.sql_handle) qt\nWHERE \n    qs.total_worker_time / 1000 >= 1000; -- 1 second\n\nIF EXISTS (SELECT 1 FROM #LongRunningQueries)\nBEGIN\n    -- Send notification (e.g., via Database Mail)\n    EXEC msdb.dbo.sp_send_dbmail \n        @recipients = 'your_email@example.com',\n        @subject = 'Long Running Query Alert',\n        @body = 'Query has been running for 1 second or longer. Please investigate.';\nEND\n\nDROP TABLE #LongRunningQueries;