SELECT \n  orderid,\n  REPLACE(SYS_CONNECT_BY_PATH(itemName, ','), ',') AS items,\n  SUM(price) OVER (PARTITION BY orderid) AS total_price\nFROM (\n  SELECT \n    orderid,\n    itemName,\n    price,\n    ROW_NUMBER() OVER (PARTITION BY orderid ORDER BY itemName) AS row_num\n  FROM order_details\n) AS subquery\nSTART WITH row_num = 1\nCONNECT BY PRIOR orderid = orderid AND PRIOR row_num + 1 = row_num\nGROUP BY orderid\nORDER BY orderid;