DECLARE @sql nvarchar(max) = ''\nDECLARE @pivotList nvarchar(max) = ''\n\nSELECT @pivotList += '[' + QuestionText + '],' \nFROM Question\nORDER BY QuestionID\n\nSET @pivotList = LEFT(@pivotList, LEN(@pivotList) - 1) -- remove trailing comma\n\nSET @sql = '\n    SELECT ' + @pivotList + '\n    FROM (\n        SELECT ResponseText, QuestionText \n        FROM Response \n        INNER JOIN Question ON Response.QuestionID = Question.QuestionID\n    ) AS SourceTable\n    PIVOT (\n        MAX(ResponseText) \n        FOR QuestionText IN (' + @pivotList + ')\n    ) AS PivotTable\n'\n\nEXEC sp_executesql @sql