WITH Months AS (\n  SELECT \n    StartDate, \n    EndDate, \n    MonthNum = MONTH(DATEADD(month, x, StartDate))\n  FROM \n    YourTable\n  CROSS JOIN \n    (VALUES (0), (1), (2), ..., (11)) AS x(x)\n  WHERE \n    DATEADD(month, x, StartDate) <= EndDate\n)\nSELECT \n  *\nFROM \n  (\n    SELECT \n      MonthNum, \n      Value = 1\n    FROM \n      Months\n  ) AS SourceTable\nPIVOT \n  (\n    MAX(Value)\n    FOR MonthNum IN ([1], [2], [3], ..., [12])\n  ) AS PivotTable;