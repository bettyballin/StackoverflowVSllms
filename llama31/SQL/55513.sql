CREATE PROCEDURE dbo.ConcatField\n    @qry nvarchar(1000),\n    @fld nvarchar(100),\n    @separator nvarchar(15) = '; '\nAS\nBEGIN\n    DECLARE @sql nvarchar(2000)\n    SET @sql = 'SELECT @rslt = COALESCE(@rslt, '''') + ''' + @separator + ''' + CONVERT(nvarchar(160), ' + @fld + ') FROM (' + @qry + ') AS qry'\n\n    DECLARE @rslt nvarchar(1000)\n    EXEC sp_executesql @sql, N'@rslt nvarchar(1000) OUTPUT', @rslt OUTPUT\n\n    SELECT @rslt\nEND