CREATE FUNCTION YearFrac\n(\n    @StartDate datetime,\n    @EndDate datetime,\n    @Basis int = 0\n)\nRETURNS decimal(18, 10)\nAS\nBEGIN\n    DECLARE @YearFrac decimal(18, 10)\n\n    IF @Basis = 0  -- US (NASD) 30/360\n    BEGIN\n        @YearFrac = DATEDIFF(day, @StartDate, @EndDate) / 360.0\n    END\n    ELSE IF @Basis = 1  -- Actual/actual\n    BEGIN\n        @YearFrac = DATEDIFF(day, @StartDate, @EndDate) / 365.0\n    END\n    ELSE IF @Basis = 2  -- Actual/360\n    BEGIN\n        @YearFrac = DATEDIFF(day, @StartDate, @EndDate) / 360.0\n    END\n    ELSE IF @Basis = 3  -- Actual/365\n    BEGIN\n        @YearFrac = DATEDIFF(day, @StartDate, @EndDate) / 365.0\n    END\n    ELSE IF @Basis = 4  -- European 30/360\n    BEGIN\n        @YearFrac = DATEDIFF(day, @StartDate, @EndDate) / 360.0\n    END\n    ELSE\n    BEGIN\n        RAISERROR ('Invalid basis. Supported bases are 0 (US 30/360), 1 (Actual/actual), 2 (Actual/360), 3 (Actual/365), and 4 (European 30/360).', 16, 1)\n        RETURN NULL\n    END\n\n    RETURN @YearFrac\nEND