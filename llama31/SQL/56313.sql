-- Create a message queue\nCREATE TYPE msg_type AS OBJECT (table_name VARCHAR2(30), operation VARCHAR2(10), row_id ROWID);\nCREATE TYPE msg_table AS TABLE OF msg_type;\nCREATE QUEUE sync_queue FOR msg_table;\n\n-- Create a procedure to process the messages\nCREATE OR REPLACE PROCEDURE process_sync_queue\nBEGIN\n    LOOP\n        DECLARE\n            msg msg_type;\n        BEGIN\n            DBMS_AQADM.DEQUEUE (\n                queue_name => 'sync_queue',\n                dequeue_options => DBMS_AQADM.DEQUEUE_OPTIONS_WAIT,\n                message_properties => msg,\n                payload => msg);\n            \n            IF msg.table_name = 'A' THEN\n                IF msg.operation = 'INSERT' THEN\n                    INSERT INTO B SELECT * FROM A WHERE ROWID = msg.row_id;\n                ELSIF msg.operation = 'UPDATE' THEN\n                    UPDATE B SET (column1, column2, ...) = (SELECT column1, column2, ... FROM A WHERE ROWID = msg.row_id) WHERE ROWID = msg.row_id;\n                ELSIF msg.operation = 'DELETE' THEN\n                    DELETE FROM B WHERE ROWID = msg.row_id;\n                END IF;\n            ELSIF msg.table_name = 'B' THEN\n                IF msg.operation = 'INSERT' THEN\n                    INSERT INTO A SELECT * FROM B WHERE ROWID = msg.row_id;\n                ELSIF msg.operation = 'UPDATE' THEN\n                    UPDATE A SET (column1, column2, ...) = (SELECT column1, column2, ... FROM B WHERE ROWID = msg.row_id) WHERE ROWID = msg.row_id;\n                ELSIF msg.operation = 'DELETE' THEN\n                    DELETE FROM A WHERE ROWID = msg.row_id;\n                END IF;\n            END IF;\n        END;\n    END LOOP;\nEND;\n\n-- Create triggers to enqueue messages\nCREATE OR REPLACE TRIGGER a_trigger\nAFTER INSERT OR UPDATE OR DELETE ON A\nFOR EACH ROW\nBEGIN\n    DBMS_AQADM.ENQUEUE (\n        queue_name => 'sync_queue',\n        enqueue_options => DBMS_AQADM.ENQUEUE_OPTIONS,\n        message_properties => msg_type('A', CASE WHEN INSERTING THEN 'INSERT' WHEN UPDATING THEN 'UPDATE' WHEN DELETING THEN 'DELETE' END, :NEW.ROWID));\nEND;\n\nCREATE OR REPLACE TRIGGER b_trigger\nAFTER INSERT OR UPDATE OR DELETE ON B\nFOR EACH ROW\nBEGIN\n    DBMS_AQADM.ENQUEUE (\n        queue_name => 'sync_queue',\n        enqueue_options => DBMS_AQADM.ENQUEUE_OPTIONS,\n        message_properties => msg_type('B', CASE WHEN INSERTING THEN 'INSERT' WHEN UPDATING THEN 'UPDATE' WHEN DELETING THEN 'DELETE' END, :NEW.ROWID));\nEND;\n\n-- Start the message processing job\nCREATE OR REPLACE JOB sync_job\nBEGIN\n    process_sync_queue;\nEND;