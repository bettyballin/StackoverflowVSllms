SELECT \n  d.ID, \n  d.NAME, \n  h.USER_ID AS LAST_USER_ID\nFROM \n  DOCUMENTS d\n  LEFT JOIN (\n    SELECT \n      DOC_ID, \n      USER_ID, \n      ROW_NUMBER() OVER (PARTITION BY DOC_ID ORDER BY TIMESTAMP DESC) AS RN\n    FROM \n      HISTORY\n  ) h ON d.ID = h.DOC_ID AND h.RN = 1