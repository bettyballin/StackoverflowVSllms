DECLARE\n  v_file UTL_FILE.FILE_TYPE;\n  v_file_name VARCHAR2(30);\n  v_counter NUMBER := 1;\n  v_max_rows NUMBER := 100000;  -- adjust this to control the number of rows per file\n  v_total_rows NUMBER := 0;\n\nBEGIN\n  FOR c IN (SELECT * FROM your_query) LOOP\n    IF MOD(v_total_rows, v_max_rows) = 0 THEN\n      -- close the current file and open a new one\n      IF v_file IS OPEN THEN\n        UTL_FILE.FCLOSE(v_file);\n      END IF;\n      v_file_name := 'out' || v_counter || '.csv';\n      v_file := UTL_FILE.FOPEN(v_file_name, 'w');\n      v_counter := v_counter + 1;\n    END IF;\n\n    -- write the data to the file\n    UTL_FILE.PUT_LINE(v_file, c.column1 || ',' || c.column2 || ',' || c.column3);\n\n    v_total_rows := v_total_rows + 1;\n  END LOOP;\n\n  -- close the last file\n  IF v_file IS OPEN THEN\n    UTL_FILE.FCLOSE(v_file);\n  END IF;\nEND;