WITH combined_dates AS (\n  SELECT \n    StudentID,\n    Field1,\n    Field2,\n    MIN(StartDate) AS StartDate,\n    MAX(EndDate) AS EndDate\n  FROM (\n    SELECT \n      StudentID,\n      Field1,\n      Field2,\n      StartDate,\n      EndDate,\n      SUM(gap) OVER (PARTITION BY StudentID, Field1, Field2 ORDER BY StartDate) AS group_id\n    FROM (\n      SELECT \n        StudentID,\n        Field1,\n        Field2,\n        StartDate,\n        EndDate,\n        CASE \n          WHEN LAG(EndDate) OVER (PARTITION BY StudentID, Field1, Field2 ORDER BY StartDate) = StartDate - INTERVAL 1 DAY \n          THEN 0 ELSE 1 END AS gap\n      FROM your_table\n    ) t\n  ) t\n  GROUP BY StudentID, Field1, Field2, group_id\n)\nSELECT * FROM combined_dates\nORDER BY StudentID, StartDate;