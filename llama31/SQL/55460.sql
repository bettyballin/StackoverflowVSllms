INSERT INTO Contacts (UserID, FirstName, LastName, EmailAddress)\nOUTPUT inserted.ID, inserted.UserID, [t1].GroupID\nINTO #TempTable (ContactID, UserID, GroupID)\nSELECT DISTINCT [t1].UserID, [t1].EmailAddress, [t1].FirstName, [t1].LastName \nFROM ContactImportStaging as [t1]\nWHERE NOT EXISTS \n(\n    SELECT UserID, EmailAddress, FirstName, LastName FROM Contacts\n    WHERE UserID = [t1].UserID AND EmailAddress = [t1].EmailAddress AND FirstName = [t1].FirstName AND LastName = [t1].LastName\n)\n\nINSERT INTO ContactGroupMapping (ContactID, GroupID)\nSELECT ContactID, GroupID\nFROM #TempTable\n\nDROP TABLE #TempTable