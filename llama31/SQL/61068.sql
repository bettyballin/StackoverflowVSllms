SELECT \n  c.count, \n  s.name as strip, \n  ch.name as character\nFROM \n  strips s\nJOIN \n  appearances a ON s.id = a.strip_id\nJOIN \n  characters ch ON a.character_id = ch.id\nJOIN \n  (SELECT \n     ch.id, \n     COUNT(*) as count\n   FROM \n     appearances a\n   JOIN \n     characters ch ON a.character_id = ch.id\n   WHERE \n     a.date IN (...)\n   GROUP BY \n     ch.id) c ON ch.id = c.id\nWHERE \n  a.date IN (...);