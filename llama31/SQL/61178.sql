DECLARE @sql AS NVARCHAR(MAX)\nDECLARE @pivotList AS NVARCHAR(MAX)\n\nSELECT @pivotList = COALESCE(@pivotList + ',', '') + QUOTENAME(TYPE + '_' + SUBTYPE)\nFROM (SELECT DISTINCT TYPE, SUBTYPE FROM YourTable) AS sub\n\nSET @sql = N'\n    SELECT ID, ' + @pivotList + ', MONTH\n    FROM (SELECT ID, TYPE + ''_'' + SUBTYPE AS ColName, COUNT, MONTH\n          FROM YourTable) AS SourceTable\n    PIVOT (SUM(COUNT) FOR ColName IN (' + @pivotList + ')) AS PivotTable\n'\n\nEXEC sp_executesql @sql