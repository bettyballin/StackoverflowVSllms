WITH RECURSIVE valid_grp AS (\n  SELECT grp1, grp2, ..., grpn, 1 AS valid\n  FROM your_table\n  WHERE grp1 = 1\n  UNION ALL\n  SELECT grp1, grp2, ..., grpn, valid + 1\n  FROM valid_grp\n  WHERE grp2 = 1 AND valid = 1\n  UNION ALL\n  ...\n  UNION ALL\n  SELECT grp1, grp2, ..., grpn, valid + 1\n  FROM valid_grp\n  WHERE grpn = 1 AND valid = n-1\n)\nSELECT * FROM valid_grp WHERE valid = n;