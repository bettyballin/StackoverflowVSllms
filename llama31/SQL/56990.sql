WITH numberedSchedule AS (\n  SELECT \n    EmployeeID, \n    ProjectID, \n    DayID, \n    ROW_NUMBER() OVER (PARTITION BY EmployeeID, ProjectID ORDER BY DayID) - DayID AS dateGroup\n  FROM \n    EmployeeSchedule\n)\nSELECT \n  EmployeeID, \n  ProjectID, \n  MIN(DayID) AS startDate, \n  MAX(DayID) AS endDate\nFROM \n  numberedSchedule\nGROUP BY \n  EmployeeID, \n  ProjectID, \n  dateGroup\nORDER BY \n  EmployeeID, \n  ProjectID, \n  startDate;