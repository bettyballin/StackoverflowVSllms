WITH RECURSIVE tree AS (\n  SELECT id, parentid, data1, ..., dataN, 0 AS level\n  FROM your_table\n  WHERE parentid IS NULL  -- anchor query: select the root node(s)\n  UNION ALL\n  SELECT t.id, t.parentid, t.data1, ..., t.dataN, level + 1\n  FROM your_table t\n  JOIN tree p ON t.parentid = p.id  -- recursive join\n)\nSELECT \n  SUM(data1) AS total_data1,\n  SUM(data2) AS total_data2,\n  ...\n  SUM(dataN) AS total_dataN\nFROM tree\nWHERE level >= ?  -- filter by level, e.g., 0 for root, 1 for first-level children, etc.