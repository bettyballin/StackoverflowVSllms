CREATE TABLE #TempCrossJoin (\n    CA_JCCAC varchar(16),\n    CA_COSTCENT int,\n    CA_GLACCOUNT int,\n    CA_LNTM int,\n    CA_UNIT varchar(6)\n);\n\nINSERT INTO #TempCrossJoin (\n    CA_JCCAC,\n    CA_COSTCENT,\n    CA_GLACCOUNT,\n    CA_LNTM,\n    CA_UNIT\n)\nSELECT \n    Util.PADLEFT(CONVERT(varchar, CC.COST_CTR_NUM), '0', 7)\n    + Util.PADLEFT(CONVERT(varchar, GL.ACCOUNT_NO), '0', 9) AS CC_JCCAC,\n    CC.COST_CTR_NUM AS CA_COSTCENT,\n    GL.ACCOUNT_NO % 900000000 AS CA_GLACCOUNT,\n    GL.LI_LNTM AS CA_LNTM,\n    NULL AS CA_UNIT  -- We'll apply the UDF later\nFROM \n    JOINGLAC AS GL\nCROSS JOIN \n    COSTCENT AS CC;\n\nUPDATE #TempCrossJoin\nSET \n    CA_UNIT = udf_BUPDEF(CA_GLACCOUNT, CA_COSTCENT, CA_LNTM, 'N');\n\nINSERT INTO JOINCCAC (\n    CA_JCCAC,\n    CA_COSTCENT,\n    CA_GLACCOUNT,\n    CA_LNTM,\n    CA_UNIT\n)\nSELECT \n    CA_JCCAC,\n    CA_COSTCENT,\n    CA_GLACCOUNT,\n    CA_LNTM,\n    CA_UNIT\nFROM \n    #TempCrossJoin;\n\nDROP TABLE #TempCrossJoin;