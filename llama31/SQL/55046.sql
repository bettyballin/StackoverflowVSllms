WITH data AS (\n  SELECT x, \n         PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY x) AS Q1,\n         PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY x) AS Q3\n  FROM y\n)\nSELECT AVG(x) \nFROM data \nWHERE x BETWEEN Q1 - 1.5 * (Q3 - Q1) AND Q3 + 1.5 * (Q3 - Q1);