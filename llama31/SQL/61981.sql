SELECT \n  CampaignID,\n  SourceID,\n  ContentRowID_ValueA,\n  ContentRowID_ValueB\nFROM \n  (\n    SELECT \n      c.CampaignID,\n      s.SourceID,\n      cr.Content_Row_ID,\n      cr.Content_Value\n    FROM \n      Campaign c\n      JOIN Source s ON c.CampaignID = s.CampaignID\n      JOIN Content cr ON c.CampaignID = cr.CampaignID\n  )\n  PIVOT \n  (\n    MAX(Content_Value)\n    FOR Content_Row_ID IN ('A' AS ContentRowID_ValueA, 'B' AS ContentRowID_ValueB)\n  )