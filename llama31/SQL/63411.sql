declare @date1 smalldatetime, @date2 smalldatetime, @page nvarchar(100) ,@sum int\n\nselect @date1='2009-06-06',@date2='2009-06-13',@page='Tüm Sayfalar'\n\nset @sum = (select Sum(t.[VISITINGCOUNT]) from\n(\n    select count(page) as [VISITINGCOUNT], \n    cast(DATENAME (year ,DATE)+'-'+DATENAME (month ,DATE)+'-'+DATENAME (day ,DATE) as smalldatetime)  as [DATE]\n    from scr_StatisticaLog\n    where Date between @date1 and  @date2  \n    and (Page=@page or  @page='Tüm Sayfalar')  and ProcessType='PageView'\n    GROUP BY \n    cast(DATENAME (year ,DATE)+'-'+DATENAME (month ,DATE)+'-'+DATENAME (day ,DATE) as smalldatetime)\n) as t)\n\nselect 100*(t.[VISITINGCOUNT]/@sum),t.[DATE] from        \n(\n    select count(page) as [VISITINGCOUNT], \n    cast(DATENAME (year ,DATE)+'-'+DATENAME (month ,DATE)+'-'+DATENAME (day ,DATE) as smalldatetime)  as [DATE]\n    from scr_StatisticaLog\n    where Date between @date1 and  @date2  \n    and (Page=@page or  @page='Tüm Sayfalar')  and ProcessType='PageView'\n    GROUP BY \n    cast(DATENAME (year ,DATE)+'-'+DATENAME (month ,DATE)+'-'+DATENAME (day ,DATE) as smalldatetime)\n) as t