DECLARE @listCol VARCHAR(2000)\nDECLARE @query VARCHAR(4000)\n\nSELECT  @listCol = STUFF(( SELECT distinct  '], [' + [size]\n                           FROM     #t\n                           ORDER BY BucketNum\n                         FOR\n                           XML PATH('')\n                         ), 1, 2, '') + ']'\n\nSET @query = 'SELECT * FROM\n      (SELECT OID,  [size], [quantity]\n            FROM #t \n            ) src\nPIVOT (SUM(quantity) FOR Size\nIN (' + @listCol + ')) AS pvt'\n\nEXECUTE ( @query )