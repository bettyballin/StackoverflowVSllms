SELECT \n  f1.ItemName AS ItemDescription,\n  f1.ItemPrice AS LatestPrice\nFROM \n  FunTable f1\n  INNER JOIN (\n    SELECT \n      ItemName, \n      MAX(ItemPriceEffectiveDate) AS LatestEffectiveDate\n    FROM \n      FunTable\n    WHERE \n      ItemPriceEffectiveDate <= CURRENT_DATE\n    GROUP BY \n      ItemName\n  ) f2\n  ON f1.ItemName = f2.ItemName AND f1.ItemPriceEffectiveDate = f2.LatestEffectiveDate