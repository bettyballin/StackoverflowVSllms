DECLARE @Hour INT\nDECLARE @TimeFrame NVARCHAR(2)\nDECLARE @TimeSpan INT\n\nSET @TimeSpan = 24\nSET @TimeFrame = 'AM'\nSET @Hour = 8\n\nDECLARE @dateStart DATETIME\nDECLARE @dateEnd DATETIME\n\n-- Calculate the end date based on the current date and provided hour\nDECLARE @endDate DATETIME = CONVERT(DATETIME, CONVERT(VARCHAR(10), GETDATE(), 120) + ' ' + CONVERT(VARCHAR(2), @Hour) + ':00:00 ' + @TimeFrame)\n\n-- If the current time is past the end date, subtract one day from the end date\nIF GETDATE() > @endDate\n    SET @endDate = DATEADD(D, -1, @endDate)\n\n-- Calculate the start date based on the end date and time span\nSET @dateStart = DATEADD(HH, -@TimeSpan, @endDate)\nSET @dateEnd = @endDate\n\n-- Use the calculated dates for your query\nSELECT * FROM YourTable WHERE YourDateColumn BETWEEN @dateStart AND @dateEnd