WITH Temp1 AS (\n  SELECT \n    YEAR(StartDate) AS Year,\n    MONTH(StartDate) AS MonthNumber,\n    DATENAME(MONTH, StartDate) AS MonthName,\n    Value / NumberOfMonth AS Value\n  FROM \n    Table1\n  UNION ALL\n  SELECT \n    Year,\n    MonthNumber + 1,\n    DATENAME(MONTH, DATEADD(MONTH, MonthNumber + 1, StartDate)),\n    Value\n  FROM \n    Temp1\n  WHERE \n    MonthNumber < 12\n)\nSELECT \n  Year,\n  MonthNumber,\n  MonthName,\n  SUM(Value) AS TotalValue,\n  SUM(SUM(Value)) OVER (PARTITION BY Year ORDER BY MonthNumber) AS RunningTotal\nFROM \n  Temp1\nGROUP BY \n  Year,\n  MonthNumber,\n  MonthName\nORDER BY \n  Year,\n  MonthNumber