DECLARE \n    @BillNo int,\n    @column_name varchar(500),\n    @sql nvarchar(max),\n    @OldValue varchar(500),\n    @NewValue varchar(500)\n\nSELECT @BillNo = BillNo FROM INSERTED\n\nDECLARE HistoryMonitorLoop CURSOR FOR\n    SELECT    \n        column_name \n    FROM \n        information_schema.columns\n    WHERE \n        table_name = 'Shipment';\n\nOPEN HistoryMonitorLoop\nFETCH next FROM HistoryMonitorLoop INTO @column_name\nWHILE @@Fetch_status = 0\nBEGIN\n    SET @sql = N'SELECT @OldValue = ' + QUOTENAME(@column_name) + N' FROM Deleted'\n    EXEC sp_executesql @sql, N'@OldValue varchar(500) OUTPUT', @OldValue OUTPUT\n\n    SET @sql = N'SELECT @NewValue = ' + QUOTENAME(@column_name) + N' FROM Inserted'\n    EXEC sp_executesql @sql, N'@NewValue varchar(500) OUTPUT', @NewValue OUTPUT\n\n    IF(@OldValue != @NewValue)\n    BEGIN\n        DECLARE @Comment varchar(5000)\n        SELECT @Comment = @column_name + ' Changed from ' + @OldValue + ' to ' + @NewValue\n        EXEC ShipmentNote_Insert @BillNo=@BillNo,@CoordinatorID=1,@Comment=@Comment\n    END\n    FETCH next FROM HistoryMonitorLoop INTO @column_name\nEND\nCLOSE HistoryMonitorLoop\nDEALLOCATE HistoryMonitorLoop