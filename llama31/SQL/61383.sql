SELECT \n    s.Sale_ID,\n    s.Product_ID,\n    s.Sale_Date,\n    p.Price\nFROM \n    Sales s\nINNER JOIN \n    (SELECT \n         Product_ID, \n         Sale_Date, \n         Price,\n         (SELECT MAX(Sale_Date) \n          FROM Prices p2 \n          WHERE p2.Product_ID = p1.Product_ID \n            AND p2.Sale_Date <= p1.Sale_Date) AS LatestPriceDate\n     FROM \n         Prices p1) p\nON \n    s.Product_ID = p.Product_ID \n    AND s.Sale_Date >= p.LatestPriceDate\n    AND s.Sale_Date < (SELECT MIN(Sale_Date) \n                       FROM Prices p3 \n                       WHERE p3.Product_ID = p.Product_ID \n                         AND p3.Sale_Date > p.Sale_Date)