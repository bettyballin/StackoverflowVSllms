WITH unique_elements AS (\n  SELECT \n    prodtree_element_name_l,\n    prodtree_element_name_l_rk,\n    ROW_NUMBER() OVER (PARTITION BY prodtree_element_name_l ORDER BY prodtree_element_name_l_rk) AS row_num\n  FROM \n    prodtree_element\n  WHERE \n    prodtree_element_name_l <> ''\n)\nSELECT \n  ue.prodtree_element_name_l,\n  rs.resource_value,\n  ue.prodtree_element_name_l_rk\nFROM \n  unique_elements ue\n  LEFT JOIN resource_shortstrings rs\n    ON ue.prodtree_element_name_l_rk = rs.resource_key\n    AND rs.language_id = '5'\nWHERE \n  ue.row_num = 1