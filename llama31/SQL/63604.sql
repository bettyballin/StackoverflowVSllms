WITH UniqueUsers AS (\n  SELECT UserID, Date, ROW_NUMBER() OVER (PARTITION BY UserID, Date ORDER BY UserID) AS RowNum\n  FROM UsageLog\n  WHERE Date BETWEEN 200901 AND 200902\n)\nSELECT COUNT(DISTINCT UserID), Date\nFROM UniqueUsers\nGROUP BY Date