SELECT \n  p.ProdName, \n  i1.PublishDate AS CurrentIssue, \n  i2.PublishDate AS PreviousIssue\nFROM \n  Issues i1\n  INNER JOIN Products p ON i1.ProdID = p.ProdID\n  LEFT JOIN Issues i2 ON i1.ProdID = i2.ProdID \n    AND DATENAME(dw, i1.PublishDate) = DATENAME(dw, i2.PublishDate)\n    AND i2.PublishDate = (\n      SELECT MAX(PublishDate) \n      FROM Issues \n      WHERE ProdID = i1.ProdID \n        AND DATENAME(dw, PublishDate) = DATENAME(dw, i1.PublishDate) \n        AND PublishDate < i1.PublishDate\n    )\nORDER BY \n  i1.PublishDate DESC;