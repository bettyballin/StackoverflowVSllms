CREATE OR REPLACE VIEW v_test AS\nSELECT DISTINCT u.bo_id, UPPER(d.dept_id)\nFROM cust_bo_users u\nJOIN cust_dept_roll_up_tbl d ON u.role_name = d.role_name\nJOIN cust_bo_roles r ON u.role_name = r.role_name\n  AND (r.region IS NULL OR TRIM(r.region) = TRIM(d.chrgback_reg))\n  AND (r.prod_id IS NULL OR TRIM(r.prod_id) = TRIM(d.prod_id))\n  AND (r.div_id IS NULL OR TRIM(r.div_id) = TRIM(d.div_id))\n  AND (r.clus_id IS NULL OR TRIM(r.clus_id) = TRIM(d.clus_id))\n  AND (r.prod_ln_id IS NULL OR TRIM(r.prod_ln_id) = TRIM(d.prod_ln_id))\n  AND (r.dept_id IS NULL OR TRIM(r.dept_id) = TRIM(d.dept_id));