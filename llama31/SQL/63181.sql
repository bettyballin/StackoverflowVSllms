DECLARE @sql AS NVARCHAR(MAX);\nDECLARE @pivotList AS NVARCHAR(MAX);\n\nSELECT @pivotList = COALESCE(@pivotList + ',', '') + QUOTENAME(QuestionID)\nFROM (SELECT DISTINCT QuestionID FROM ExamAnswers) AS questions;\n\nSET @sql = N'\n    SELECT StudentID, ' + @pivotList + '\n    FROM \n    (\n        SELECT StudentID, QuestionID, Answer\n        FROM ExamAnswers\n    ) AS SourceTable\n    PIVOT \n    (\n        MAX(Answer)\n        FOR QuestionID IN (' + @pivotList + ')\n    ) AS PivotTable;\n';\n\nEXEC sp_executesql @sql;