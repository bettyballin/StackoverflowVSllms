CREATE TABLE tags (\n  id INT PRIMARY KEY,\n  name VARCHAR(255),\n  parent_id INT,\n  FOREIGN KEY (parent_id) REFERENCES tags(id)\n);\n\nCREATE INDEX idx_tags_parent_id ON tags (parent_id);\n\nWITH RECURSIVE tag_hierarchy AS (\n  SELECT id, name, parent_id, 0 AS level\n  FROM tags\n  WHERE parent_id IS NULL  -- anchor query: top-level tags\n  UNION ALL\n  SELECT t.id, t.name, t.parent_id, level + 1\n  FROM tags t\n  JOIN tag_hierarchy p ON t.parent_id = p.id\n)\nSELECT * FROM tag_hierarchy;