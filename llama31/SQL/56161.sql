CREATE PROCEDURE GetPageHierarchy\nAS\nBEGIN\n    DECLARE @HTML nvarchar(max)\n    SET @HTML = ''\n\n    WITH RecursivePage AS (\n        SELECT PageID, ParentID, Title, 0 AS Level\n        FROM Pages\n        WHERE ParentID IS NULL\n        UNION ALL\n        SELECT p.PageID, p.ParentID, p.Title, Level + 1\n        FROM Pages p\n        INNER JOIN RecursivePage rp ON p.ParentID = rp.PageID\n    )\n    SELECT \n        @HTML += \n        CASE \n            WHEN Level = 0 THEN '<ul><li>' + Title + '</li>'\n            ELSE REPLICATE('    ', Level) + '<li>' + Title + '</li>'\n        END\n    FROM RecursivePage\n    ORDER BY Level, Title\n\n    SELECT @HTML\nEND