SELECT \n  t.location, \n  l.city, \n  f.year, \n  f.customer, \n  SUM(CASE WHEN t.code = 'C' THEN nvl(t.sale_quantity, 0) ELSE 0 END) AS sale_quantity\nFROM \n  loc t, \n  location l, \n  father_table f\nWHERE \n  f.number = t.number(+) \n  AND f.code = '0001' \n  AND f.c_code = '01' \n  AND t.location = l.code(+) \n  AND t.code IN ('C', 'S') \n  AND t.co_code IN ('G', 'V', 'A', 'D') \n  AND t.year = '2008'\nGROUP BY \n  t.location, \n  l.city, \n  f.year, \n  f.customer\nORDER BY \n  l.city, \n  f.year