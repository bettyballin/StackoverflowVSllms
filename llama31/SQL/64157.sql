SELECT \n    ROW_NUMBER() OVER (PARTITION BY Category ORDER BY Value DESC) AS Rank,\n    User,\n    Category\nFROM \n    YourTable\nORDER BY \n    Category, Rank;