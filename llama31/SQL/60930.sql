SELECT node.name, (COUNT(parent.name) - (sub_tree.depth + 1)) AS depth\nFROM line_items AS node\nJOIN line_items AS parent ON node.lft BETWEEN parent.lft AND parent.rgt\nJOIN (\n  SELECT node.name, (COUNT(parent.name) - 1) AS depth\n  FROM line_items AS node\n  JOIN line_items AS parent ON node.lft BETWEEN parent.lft AND parent.rgt\n  WHERE node.name = 'Power Up'\n  GROUP BY node.name\n) AS sub_tree ON sub_tree.name = parent.name\nGROUP BY node.name\nHAVING depth <= 1\nORDER BY node.lft;