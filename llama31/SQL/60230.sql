CREATE PROCEDURE sp_SymmetricDifference\n    @tableName nvarchar(128)\nAS\nBEGIN\n    DECLARE @sql nvarchar(max)\n    DECLARE @columnList nvarchar(max)\n\n    -- Get the column list for the table\n    SELECT @columnList = COALESCE(@columnList + ',', '') + QUOTENAME(c.name)\n    FROM sys.columns c\n    WHERE c.object_id = OBJECT_ID(@tableName)\n\n    -- Generate the symmetric difference query\n    SET @sql = '\n        SELECT * FROM (\n            SELECT ' + @columnList + ' FROM ' + @tableName + ' WHERE NOT EXISTS (\n                SELECT ' + @columnList + ' FROM ' + @tableName + '_other WHERE ' + @columnList + ' = ' + @columnList + '\n            )\n            UNION ALL\n            SELECT ' + @columnList + ' FROM ' + @tableName + '_other WHERE NOT EXISTS (\n                SELECT ' + @columnList + ' FROM ' + @tableName + ' WHERE ' + @columnList + ' = ' + @columnList + '\n            )\n        ) AS symmetric_diff\n    '\n\n    -- Execute the query\n    EXEC sp_executesql @sql\nEND\nGO