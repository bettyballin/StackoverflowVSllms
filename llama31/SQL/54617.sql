SELECT \n    pv.Path AS EntryPage, \n    COUNT(pv.Path) AS [Count]\nFROM \n    PageViews pv\n    INNER JOIN (\n        SELECT \n            s.SessionID, \n            MIN(pv.Created) AS Created\n        FROM \n            Sessions s\n            INNER JOIN Visitors v ON s.VisitorID = v.VisitorID\n            INNER JOIN PageViews pv ON s.SessionID = pv.SessionID\n        WHERE \n            pv.Domain = ISNULL(@Domain, pv.Domain) \n            AND v.Campaign = @Campaign\n        GROUP BY \n            s.SessionID\n    ) t1 ON pv.SessionID = t1.SessionID AND pv.Created = t1.Created\nGROUP BY \n    pv.Path;