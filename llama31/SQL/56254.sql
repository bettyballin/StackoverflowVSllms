WITH ranked_children AS (\n    SELECT \n        ParentID, \n        CountPropertys, \n        DateTimeStamp, \n        ROW_NUMBER() OVER (PARTITION BY ParentID ORDER BY DateTimeStamp DESC) AS rn\n    FROM \n        dbo_ChildEntry\n)\nSELECT \n    p.ParentName, \n    rc.CountPropertys, \n    rc.DateTimeStamp\nFROM \n    dbo_Parents p\nINNER JOIN \n    ranked_children rc ON p.ParentID = rc.ParentID AND rc.rn = 1