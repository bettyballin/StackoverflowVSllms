SELECT \n  DATEADD(month, DATEDIFF(month, 0, a.OpenedDate), 0) AS 'Date',\n  c.AddressState AS 'State',\n  SUM(p.Amount) AS 'Total'\nFROM \n  Account a\n  INNER JOIN Customer c ON c.CustomerID = a.CustomerID\n  INNER JOIN Payment p ON p.AccountID = a.AccountID\nWHERE \n  *** -- your conditions here\nGROUP BY \n  DATEADD(month, DATEDIFF(month, 0, a.OpenedDate), 0),\n  c.AddressState