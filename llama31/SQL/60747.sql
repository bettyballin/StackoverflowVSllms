WITH ranked_submitters AS (\n  SELECT \n    p.person_name,\n    i.item_type,\n    COUNT(i.item_id) AS item_count,\n    ROW_NUMBER() OVER (PARTITION BY i.item_type ORDER BY COUNT(i.item_id) DESC) AS rank\n  FROM \n    items i\n  JOIN \n    person p ON i.person_id = p.person_id\n  WHERE \n    i.item_date BETWEEN '2022-01-01' AND '2022-12-31'  -- adjust the date range as needed\n  GROUP BY \n    p.person_name, i.item_type\n)\nSELECT \n  person_name, item_type, item_count\nFROM \n  ranked_submitters\nWHERE \n  rank <= 2;