SELECT p.ID, p.PRODUCT_NAME, p.COLOR, p.SALE_COUNT\nFROM products p\nJOIN (\n  SELECT PRODUCT_NAME, COLOR, ROW_NUMBER() OVER (PARTITION BY PRODUCT_NAME ORDER BY TOTAL_SALES DESC) AS RANK\n  FROM product_sales\n) s ON p.PRODUCT_NAME = s.PRODUCT_NAME AND p.COLOR = s.COLOR\nWHERE s.RANK = 1 AND p.PRODUCT_NAME LIKE '%:searchTerm%';