WITH ranked_intervals AS (\n  SELECT id, startdate, enddate,\n         LAG(enddate) OVER (PARTITION BY id ORDER BY startdate) AS prev_enddate,\n         CASE\n           WHEN LAG(enddate) OVER (PARTITION BY id ORDER BY startdate) = startdate - 1\n           THEN 0\n           ELSE 1\n         END AS is_new_group\n  FROM your_table\n)\nSELECT id, MIN(startdate) AS startdate, MAX(enddate) AS enddate\nFROM (\n  SELECT id, startdate, enddate,\n         SUM(is_new_group) OVER (PARTITION BY id ORDER BY startdate) AS group_id\n  FROM ranked_intervals\n)\nGROUP BY id, group_id\nORDER BY id, startdate;