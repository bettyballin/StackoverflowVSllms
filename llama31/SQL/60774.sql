SELECT \n  r.Description, \n  arq.DateReferred, \n  arq.AssessmentResourceID\nFROM \n  (\n    SELECT \n      Resource.Description, \n      MAX(arq.DateReferred) AS MaxDateReferred\n    FROM \n      AssessmentXResource AS arq \n      INNER JOIN Resource ON arq.ResourceID = Resource.ResourceID \n      INNER JOIN Assessment AS aq \n      INNER JOIN [Case] AS cq ON aq.CaseID = cq.CaseID \n      INNER JOIN [Plan] AS pq ON cq.CaseID = pq.CaseID ON arq.AssessmentID = aq.AssessmentID\n    WHERE \n      (pq.PlanID = 22)\n    GROUP BY \n      Resource.Description\n  ) AS subquery\n  INNER JOIN AssessmentXResource AS arq ON subquery.Description = arq.ResourceID\n  INNER JOIN Resource AS r ON arq.ResourceID = r.ResourceID\nWHERE \n  arq.DateReferred = subquery.MaxDateReferred\nORDER BY \n  r.Descriptio