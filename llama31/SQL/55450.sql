MERGE INTO Contacts AS target\nUSING ContactImportStaging AS source\nON target.UserID = source.UserID AND target.EmailAddress = source.EmailAddress AND target.FirstName = source.FirstName AND target.LastName = source.LastName\nWHEN NOT MATCHED THEN\n    INSERT (UserID, FirstName, LastName, EmailAddress)\n    VALUES (source.UserID, source.FirstName, source.LastName, source.EmailAddress)\n    OUTPUT inserted.ID, source.GroupID\n    INTO ContactGroupMapping (ContactID, GroupID);