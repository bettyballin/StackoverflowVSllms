WITH \n  EmployeeMoney AS (\n    SELECT E.EmployeeID, SUM(M.Amount) AS TotalAmount\n    FROM Employees E\n    INNER JOIN MoneyTransactions M ON E.EmployeeID = M.EmployeeID\n    GROUP BY E.EmployeeID\n  ),\n  EmployeeBudget AS (\n    SELECT E.EmployeeID, SUM(B.Amount) AS BudgetAmount\n    FROM Employees E\n    INNER JOIN BudgetTransactions B ON E.EmployeeID = B.EmployeeID\n    GROUP BY E.EmployeeID\n  ),\n  EmployeeTime AS (\n    SELECT E.EmployeeID, \n           SUM(T.Hours) AS TotalHours,\n           SUM(CASE WHEN T.Type = 'Waste' THEN T.Hours ELSE 0 END) AS WastedHours\n    FROM Employees E\n    INNER JOIN TimeTransactions T ON E.EmployeeID = T.EmployeeID\n    GROUP BY E.EmployeeID\n  ),\n  EmployeeTimeBudget AS (\n    SELECT E.EmployeeID, SUM(TB.Hours) AS BudgetHours\n    FROM Employees E\n    INNER JOIN TimeBudgetTransactions TB ON E.EmployeeID = TB.EmployeeID\n    GROUP BY E.EmployeeID\n  )\nSELECT \n  E.EmployeeName,\n  COALESCE(EM.TotalAmount, 0) AS TotalAmount,\n  COALESCE(EB.BudgetAmount, 0) AS BudgetAmount,\n  COALESCE(ET.TotalHours, 0) AS TotalHours,\n  COALESCE(ET.WastedHours, 0) AS WastedHours,\n  COALESCE(ETB.BudgetHours, 0) AS BudgetHours\nFROM Employees E\nLEFT JOIN EmployeeMoney EM ON E.EmployeeID = EM.EmployeeID\nLEFT JOIN EmployeeBudget EB ON E.EmployeeID = EB.EmployeeID\nLEFT JOIN EmployeeTime ET ON E.EmployeeID = ET.EmployeeID\nLEFT JOIN EmployeeTimeBudget ETB ON E.EmployeeID = ETB.EmployeeID;