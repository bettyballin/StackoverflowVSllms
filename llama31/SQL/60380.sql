SELECT DISTINCT \n   r.RequesterID,\n   sr.ModifiedDate,\n   p.FirstName + ' ' + p.LastName AS RequesterName,\n   MAX(CASE WHEN sa.Attribute = 'Urgent' THEN sa.AttributeValue END) AS Urgent,\n   MAX(CASE WHEN sa.Attribute = 'Closed' THEN sa.AttributeValue END) AS Closed\nFROM \n   Requester AS r \n   INNER JOIN SubRequester AS sr \n     ON r.RequesterID = sr.RequesterID\n   INNER JOIN SubRequesterAttribute AS sa\n     ON sr.SubRequesterID = sa.SubRequesterID\n   CROSS JOIN Personnel AS p\nWHERE \n     (r.UserID = p.ContractorID\n     OR r.UserID = p.EmployeeID)\n   AND \n     (sa.Attribute IN ('Urgent', 'Closed'))\nGROUP BY r.RequesterID, sr.ModifiedDate, p.FirstName, p.LastName