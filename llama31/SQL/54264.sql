DECLARE @batchSize INT = 1000;\n\nWHILE EXISTS (SELECT 1 FROM TableName2 WHERE /* condition to select remaining rows */)\nBEGIN\n    INSERT INTO TableName (Field1, Field2, Field3)\n    SELECT TOP (@batchSize) Field1, Field2, Field3\n    FROM TableName2\n    WHERE /* condition to select remaining rows */;\n\n    CHECKPOINT; -- periodically checkpoint to reduce transaction log usage\n\n    WAITFOR DELAY '00:00:01'; -- add a brief delay to avoid dominating resources\nEND;