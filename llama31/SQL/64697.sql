CREATE VIEW client_info AS\nSELECT \n  c.id,\n  p.firstname,\n  p.address,\n  p.zipcode,\n  e.email AS primary_email,\n  ph.phone AS primary_phone\nFROM \n  client c\n  JOIN profile p ON c.profile_id = p.id\n  LEFT JOIN (\n    SELECT \n      client_id, \n      email\n    FROM \n      email\n    WHERE \n      primary = TRUE\n  ) e ON c.id = e.client_id\n  LEFT JOIN (\n    SELECT \n      client_id, \n      phone\n    FROM \n      phone\n    WHERE \n      primary = TRUE\n  ) ph ON c.id = ph.client_id;