WITH ranked_data AS (\n  SELECT *, \n         LAG(datetime) OVER (PARTITION BY param_id ORDER BY datetime) AS prev_datetime,\n         LEAD(datetime) OVER (PARTITION BY param_id ORDER BY datetime) AS next_datetime\n  FROM data_bahf\n  WHERE param_id = 135321\n)\nSELECT * \nFROM ranked_data \nWHERE datetime BETWEEN '20090311 10:30:00' AND '20090311 12:00:00'\n   OR (prev_datetime <= '20090311 10:30:00' AND datetime > '20090311 10:30:00')\n   OR (next_datetime >= '20090311 12:00:00' AND datetime < '20090311 12:00:00')\nORDER BY datetime;