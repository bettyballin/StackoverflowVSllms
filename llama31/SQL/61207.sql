CREATE OR REPLACE PACKAGE test_set_shift_times_to_null AS\n  PROCEDURE test_update_records;\n  PROCEDURE test_records_updated;\n  PROCEDURE test_retval_success;\n  PROCEDURE test_errbuf_error;\n  PROCEDURE test_rollback;\nEND test_set_shift_times_to_null;\n\nCREATE OR REPLACE PACKAGE BODY test_set_shift_times_to_null AS\n  PROCEDURE test_update_records IS\n    v_retval  VARCHAR2(1);\n    v_errbuf  VARCHAR2(100);\n    v_records_updated  NUMBER;\n  BEGIN\n    -- Arrange\n    INSERT INTO employees (employee, SHIFT) VALUES ('emp1', 'EVENING');\n    INSERT INTO employees (employee, SHIFT) VALUES ('emp2', 'EVENING');\n    INSERT INTO NIGHT_SHIFT (SOME_DUMB_FIELD) VALUES ('old_value');\n\n    -- Act\n    set_shift_times_to_null(v_retval, v_errbuf, v_records_updated);\n\n    -- Assert\n    utplsql.assert_equal(2, v_records_updated);\n    utplsql.assert_equal('emp1', SOME_DUMB_FIELD);\n    utplsql.assert_equal('emp2', SOME_DUMB_FIELD);\n  END test_update_records;\n\n  PROCEDURE test_records_updated IS\n    v_retval  VARCHAR2(1);\n    v_errbuf  VARCHAR2(100);\n    v_records_updated  NUMBER;\n  BEGIN\n    -- Arrange\n    INSERT INTO employees (employee, SHIFT) VALUES ('emp1', 'EVENING');\n    INSERT INTO employees (employee, SHIFT) VALUES ('emp2', 'EVENING');\n\n    -- Act\n    set_shift_times_to_null(v_retval, v_errbuf, v_records_updated);\n\n    -- Assert\n    utplsql.assert_equal(2, v_records_updated);\n  END test_records_updated;\n\n  PROCEDURE test_retval_success IS\n    v_retval  VARCHAR2(1);\n    v_errbuf  VARCHAR2(100);\n    v_records_updated  NUMBER;\n  BEGIN\n    -- Arrange\n    INSERT INTO employees (employee, SHIFT) VALUES ('emp1', 'EVENING');\n\n    -- Act\n    set_shift_times_to_null(v_retval, v_errbuf, v_records_updated);\n\n    -- Assert\n    utplsql.assert_equal('0', v_retval);\n  END test_retval_success;\n\n  PROCEDURE test_errbuf_error IS\n    v_retval  VARCHAR2(1);\n    v_errbuf  VARCHAR2(100);\n    v_records_updated  NUMBER;\n  BEGIN\n    -- Arrange\n    INSERT INTO employees (employee, SHIFT) VALUES ('emp1', 'EVENING');\n    -- Simulate an error\n    RAISE_APPLICATION_ERROR(-20001, 'Test error');\n\n    -- Act\n    set_shift_times_to_null(v_retval, v_errbuf, v_records_updated);\n\n    -- Assert\n    utplsql.assert_not_null(v_errbuf);\n  END test_errbuf_error;\n\n  PROCEDURE test_rollback IS\n    v_retval  VARCHAR2(1);\n    v_errbuf  VARCHAR2(100);\n    v_records_updated  NUMBER;\n  BEGIN\n    -- Arrange\n    INSERT INTO employees (employee, SHIFT) VALUES ('emp1', 'EVENING');\n    INSERT INTO NIGHT_SHIFT (SOME_DUMB_FIELD) VALUES ('old_value');\n\n    -- Act\n    set_shift_times_to_null(v_retval, v_errbuf, v_records_updated);\n    RAISE_APPLICATION_ERROR(-20001, 'Test error');\n\n    -- Assert\n    utplsql.assert_equal('old_value', SOME_DUMB_FIELD);\n  END test_rollback;\nEND test_set_shift_times_to_null;