-- Create a calendar table\nDECLARE @StartDate datetime = '2009-06-01'\nDECLARE @EndDate datetime = '2009-06-30'\n\nCREATE TABLE #Calendar (Date datetime)\nWHILE @StartDate <= @EndDate\nBEGIN\n    INSERT INTO #Calendar (Date) VALUES (@StartDate)\n    SET @StartDate = @StartDate + 1\nEND\n\n-- Pivot query\nSELECT \n    o.object_name,\n    [6/1/09] = COALESCE([6/1/09], 'free'),\n    [6/2/09] = COALESCE([6/2/09], 'free'),\n    [6/3/09] = COALESCE([6/3/09], 'free'),\n    [6/4/09] = COALESCE([6/4/09], 'free'),\n    ...\nFROM \n    (SELECT \n         o.object_name,\n         c.Date,\n         CASE \n             WHEN r.ID IS NOT NULL THEN 'busy'\n             ELSE 'free'\n         END AS Status\n     FROM \n         Objects o\n     JOIN \n         #Calendar c ON 1 = 1\n     LEFT JOIN \n         Reservations r ON o.object_id = r.reservation_object \n                         AND c.Date >= r.arrival \n                         AND c.Date < r.departure) AS SourceTable\nPIVOT \n    (MAX(Status) FOR Date IN ([6/1/09], [6/2/09], [6/3/09], [6/4/09], ...)) AS PivotTable\n\nDROP TABLE #Calendar