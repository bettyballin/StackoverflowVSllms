WITH Months AS (\n  SELECT \n    DATEADD(month, number, '2009-01-01') AS MonthDate\n  FROM \n    master..spt_values\n  WHERE \n    type = 'P' AND number < 12\n),\nTransactionValues AS (\n  SELECT \n    t.TransactionDate, \n    t.TransactionValue, \n    ROW_NUMBER() OVER (ORDER BY t.TransactionDate) AS RowNumber\n  FROM \n    Transactions t\n)\nSELECT \n  m.MonthDate, \n  COALESCE(tv.TransactionValue, tvPrev.TransactionValue) AS Value\nFROM \n  Months m\n  LEFT JOIN TransactionValues tv ON m.MonthDate = tv.TransactionDate\n  LEFT JOIN TransactionValues tvPrev ON tvPrev.RowNumber = tv.RowNumber - 1\nORDER BY \n  m.MonthDate;