SELECT TOP 1 apps.isavailable\nFROM dbo.Applications apps\nINNER JOIN dbo.HoursOfOperations hoo ON apps.applicationid = hoo.applicationid\nWHERE apps.applicationname = @appname\nAND NOT EXISTS (\n    SELECT 1\n    FROM dbo.Holidays hol\n    WHERE hol.applicationid = apps.applicationid\n    AND CONVERT(VARCHAR, GETDATE(), 101) = CONVERT(VARCHAR, hol.holidaydate, 101)\n)\nAND (\n    (DATENAME(dw, GETDATE()) = 'Monday' AND GETDATE() BETWEEN hoo.mondayopen AND hoo.mondayclose)\n    OR (DATENAME(dw, GETDATE()) = 'Tuesday' AND GETDATE() BETWEEN hoo.tuesdayopen AND hoo.tuesdayclose)\n    -- repeat for all 7 days of the week\n)