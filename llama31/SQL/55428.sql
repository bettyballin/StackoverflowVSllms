SELECT \n    astats.AQTORStatsID, \n    astats.ServerName, \n    astats.Remarks, \n    astats.StatsBeginDateTime, \n    astats.StatsEndDateTime,\n    MAX(CASE WHEN asi.AQTORStatName = 'QtCPU_Average' THEN asi.AQTORStatValue END) AS QtCPU_Average,\n    MAX(CASE WHEN asi.AQTORStatName = 'QtCPU_TopQuintile' THEN asi.AQTORStatValue END) AS QtCPU_TopQuintile,\n    MAX(CASE WHEN asi.AQTORStatName = 'QtCPU_TopOnePercent' THEN asi.AQTORStatValue END) AS QtCPU_TopOnePercent,\n    MAX(CASE WHEN asi.AQTORStatName = 'QtCl_Average' THEN asi.AQTORStatValue END) AS QtCl_Average,\n    MAX(CASE WHEN asi.AQTORStatName = 'QtCl_TopQuintile' THEN asi.AQTORStatValue END) AS QtCl_TopQuintile,\n    MAX(CASE WHEN asi.AQTORStatName = 'QtCl_TopOnePercent' THEN asi.AQTORStatValue END) AS QtCl_TopOnePercent,\n    MAX(CASE WHEN asi.AQTORStatName = 'UpdPrcStd_Average' THEN asi.AQTORStatValue END) AS UpdPrcStd_Average,\n    MAX(CASE WHEN asi.AQTORStatName = 'UpdPrcStd_TopQuintile' THEN asi.AQTORStatValue END) AS UpdPrcStd_TopQuintile,\n    MAX(CASE WHEN asi.AQTORStatName = 'UpdPrcStd_TopOnePercent' THEN asi.AQTORStatValue END) AS UpdPrcStd_TopOnePercent,\n    MAX(CASE WHEN asi.AQTORStatName = 'RcRsUPr_Average' THEN asi.AQTORStatValue END) AS RcRsUPr_Average,\n    MAX(CASE WHEN asi.AQTORStatName = 'RcRsUPr_TopQuintile' THEN asi.AQTORStatValue END) AS RcRsUPr_TopQuintile,\n    MAX(CASE WHEN asi.AQTORStatName = 'RcRsUPr_TopOnePercent' THEN asi.AQTORStatValue END) AS RcRsUPr_TopOnePercent\nFROM \n    tb_dAQTORStats astats\n    LEFT JOIN tb_rAQTORStatsItem asi ON astats.AQTORStatsID = asi.AQTORStatsID\nGROUP BY \n    astats.AQTORStatsID, \n    astats.ServerName, \n    astats.Remarks, \n    astats.StatsBeginDateTime, \n    astats.StatsEndDateTime