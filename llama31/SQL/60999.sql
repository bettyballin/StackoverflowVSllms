SELECT m.material_id, \n       m.content_id,\n       (SELECT MAX(file_location) KEEP (DENSE_RANK FIRST ORDER BY resolution DESC) \n        FROM mat\n        WHERE mat.content_id = m.content_id\n          /* AND ...\n           AND ...\n           AND ... */) AS special_mat_file_location,\n       (SELECT MAX(file_size) KEEP (DENSE_RANK FIRST ORDER BY resolution DESC) \n        FROM mat\n        WHERE mat.content_id = m.content_id\n          /* AND ...\n           AND ...\n           AND ... */) AS special_mat_file_size\nFROM mat m\nWHERE m.material_id IN (SELECT material_id\n                        FROM mat\n                        INNER JOIN con ON con.content_id = mat.content_id\n                        INNER JOIN con_groups ON con_groups.content_id = con.content_id\n                        WHERE con_groups.content_group_id = 10);