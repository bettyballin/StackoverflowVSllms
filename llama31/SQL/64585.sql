CREATE TABLE users (\n  userid UNIQUEIDENTIFIER PRIMARY KEY,\n  username VARCHAR(20),\n  password_hash VARCHAR(255)\n);\n\nCREATE PROCEDURE register_user\n  @username VARCHAR(20),\n  @password VARCHAR(255)\nAS\nBEGIN\n  DECLARE @salt VARBINARY(16) = CONVERT(VARBINARY(16), NEWID());\n  DECLARE @password_hash VARBINARY(255) = HASHBYTES('SHA2_256', @salt + CONVERT(VARBINARY(255), @password));\n\n  INSERT INTO users (userid, username, password_hash)\n  VALUES (NEWID(), @username, CONVERT(VARCHAR(255), @password_hash, 2));\nEND;\n\nCREATE PROCEDURE login_user\n  @username VARCHAR(20),\n  @password VARCHAR(255)\nAS\nBEGIN\n  DECLARE @userid UNIQUEIDENTIFIER;\n  DECLARE @password_hash VARBINARY(255);\n\n  SELECT @userid = userid, @password_hash = CONVERT(VARBINARY(255), password_hash, 2)\n  FROM users\n  WHERE username = @username;\n\n  IF @userid IS NULL\n    RETURN 0; -- User not found\n\n  DECLARE @salt VARBINARY(16) = CONVERT(VARBINARY(16), NEWID());\n  DECLARE @input_hash VARBINARY(255) = HASHBYTES('SHA2_256', @salt + CONVERT(VARBINARY(255), @password));\n\n  IF @input_hash = @password_hash\n    RETURN 1; -- Login successful\n  ELSE\n    RETURN 0; -- Login failed\nEND;