SELECT * \nFROM user_info \nLEFT OUTER JOIN addresses \n    ON addresses.user_id = user_info.user_id \n    AND (addresses.app_id = CASE WHEN dbo.fnGetAppId(addresses.user_id) = 'is null' THEN NULL ELSE CONVERT(INT, dbo.fnGetAppId(addresses.user_id)) END)