CREATE VIEW OpeningClosingBalances AS\nWITH RankedAmounts AS (\n  SELECT \n    account_id,\n    date,\n    amount,\n    ROW_NUMBER() OVER (PARTITION BY account_id, date ORDER BY id) AS OpeningBalanceRank,\n    ROW_NUMBER() OVER (PARTITION BY account_id, date ORDER BY id DESC) AS ClosingBalanceRank\n  FROM \n    YourTable\n)\nSELECT \n  account_id,\n  date,\n  MAX(CASE WHEN OpeningBalanceRank = 1 THEN amount END) AS OpeningBalance,\n  MAX(CASE WHEN ClosingBalanceRank = 1 THEN amount END) AS ClosingBalance\nFROM \n  RankedAmounts\nGROUP BY \n  account_id,\n  date