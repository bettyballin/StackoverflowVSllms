SELECT \n  d.ID, \n  d.NAME, \n  h.USER_ID AS LAST_USER_ID\nFROM \n  DOCUMENTS d\n  LEFT JOIN HISTORY h ON d.ID = h.DOC_ID\n  AND h.TIMESTAMP = (SELECT MAX(TIMESTAMP) FROM HISTORY WHERE DOC_ID = d.ID)