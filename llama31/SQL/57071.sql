DECLARE @sql nvarchar(max)\nDECLARE @wantsSportscar bit, @wantsFamilycar bit, @wantsBusinesscar bit\n\nSELECT @wantsSportscar = wantsSportscar, \n       @wantsFamilycar = wantsFamilycar, \n       @wantsBusinesscar = wantsBusinesscar\nFROM people\nWHERE id = 1\n\nSET @sql = 'SELECT name'\n\nIF @wantsSportscar = 1\n    SET @sql = @sql + ', (SELECT COUNT(*) FROM cars WHERE type = ''sports'') AS sportscars'\n\nIF @wantsFamilycar = 1\n    SET @sql = @sql + ', (SELECT COUNT(*) FROM cars WHERE type = ''family'') AS familycars'\n\nIF @wantsBusinesscar = 1\n    SET @sql = @sql + ', (SELECT COUNT(*) FROM cars WHERE type = ''business'') AS businesscars'\n\nSET @sql = @sql + ' FROM people WHERE id = 1'\n\nEXEC sp_executesql @sql