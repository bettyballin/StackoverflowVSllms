WHERE DATEDIFF(day, dateadd(hh, tz.Offset + \n    CASE WHEN ds.LocalTimeZone IS NOT NULL \n    THEN 1 ELSE 0 END, t.TheDateINeedToCheck), @ActivityDate) = 0