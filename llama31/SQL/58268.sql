CREATE VIEW LatestDealComments AS\nSELECT \n  d.DealID, \n  d.Dealname, \n  d.DealDetails, \n  dc.CommentTime, \n  dc.CommentPerson, \n  dc.Comment\nFROM \n  Deals d\n  LEFT JOIN (\n    SELECT \n      DealID, \n      MAX(CommentTime) as LatestCommentTime\n    FROM \n      DealComments\n    GROUP BY \n      DealID\n  ) latest_dc ON d.DealID = latest_dc.DealID\n  LEFT JOIN DealComments dc ON latest_dc.DealID = dc.DealID AND latest_dc.LatestCommentTime = dc.CommentTime;