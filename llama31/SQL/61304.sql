CREATE FUNCTION PivotMonths\n(\n    @DateField datetime,\n    @ValueField decimal(18, 2)\n)\nRETURNS TABLE\nAS\nRETURN\n(\n    SELECT \n        YEAR(@DateField) AS [Year],\n        [Jan] = SUM(CASE WHEN MONTH(@DateField) = 1 THEN @ValueField ELSE 0 END),\n        [Feb] = SUM(CASE WHEN MONTH(@DateField) = 2 THEN @ValueField ELSE 0 END),\n        [Mar] = SUM(CASE WHEN MONTH(@DateField) = 3 THEN @ValueField ELSE 0 END),\n        [Apr] = SUM(CASE WHEN MONTH(@DateField) = 4 THEN @ValueField ELSE 0 END),\n        [May] = SUM(CASE WHEN MONTH(@DateField) = 5 THEN @ValueField ELSE 0 END),\n        [Jun] = SUM(CASE WHEN MONTH(@DateField) = 6 THEN @ValueField ELSE 0 END),\n        [Jul] = SUM(CASE WHEN MONTH(@DateField) = 7 THEN @ValueField ELSE 0 END),\n        [Aug] = SUM(CASE WHEN MONTH(@DateField) = 8 THEN @ValueField ELSE 0 END),\n        [Sep] = SUM(CASE WHEN MONTH(@DateField) = 9 THEN @ValueField ELSE 0 END),\n        [Oct] = SUM(CASE WHEN MONTH(@DateField) = 10 THEN @ValueField ELSE 0 END),\n        [Nov] = SUM(CASE WHEN MONTH(@DateField) = 11 THEN @ValueField ELSE 0 END),\n        [Dec] = SUM(CASE WHEN MONTH(@DateField) = 12 THEN @ValueField ELSE 0 END),\n        [Total] = SUM(@ValueField)\n    FROM \n        (SELECT @DateField, @ValueField) AS SourceTable\n)