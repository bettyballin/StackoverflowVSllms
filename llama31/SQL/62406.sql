-- Create a temporary table to store the mapping\nCREATE TABLE #Mapping (\n    TableA_ID INT,\n    TableB_Identity INT\n);\n\n-- Insert data into TableB and store the mapping in #Mapping\nINSERT INTO TableB (ColumnX)\nOUTPUT inserted.Identity, TableA.ID INTO #Mapping (TableB_Identity, TableA_ID)\nSELECT CONCAT(ColumnA, ', ', ColumnB, ', ', ColumnC)\nFROM TableA;\n\n-- Update TableC using the mapping\nUPDATE TableC\nSET TableB_Identity = m.TableB_Identity\nFROM TableC\nINNER JOIN #Mapping m ON TableC.TableA_ID = m.TableA_ID;\n\n-- Drop the temporary table\nDROP TABLE #Mapping;