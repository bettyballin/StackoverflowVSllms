SELECT \n  b.boardname, \n  COUNT(DISTINCT t.topicid) AS topics, \n  COUNT(m.messageid) AS messages, \n  lm.author AS last_author, \n  lm.date AS last_date, \n  t.topicname AS last_topic\nFROM \n  boards b\n  INNER JOIN topics t ON b.boardid = t.boardid\n  INNER JOIN messages m ON t.topicid = m.topicid\n  INNER JOIN (\n    SELECT \n      topicid, \n      MAX(date) AS maxdate\n    FROM \n      messages\n    GROUP BY \n      topicid\n  ) test ON m.topicid = test.topicid AND m.date = test.maxdate\n  INNER JOIN messages lm ON test.topicid = lm.topicid AND lm.date = test.maxdate\nGROUP BY \n  b.boardname\nORDER BY \n  b.boardname;