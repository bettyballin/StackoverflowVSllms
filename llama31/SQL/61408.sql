-- Add the linked server\nEXEC sp_addlinkedserver \n    @server = 'RemoteServer', \n    @provider = 'SQLNCLI',\n    @catalog = 'RemoteDatabase',\n    @srvproduct = '',\n    @provstr = 'DRIVER={SQL Server};SERVER=my.remote.server.com;UID=my_user_name;PWD=my_pass_word;'\n\n-- Add the linked server login\nEXEC sp_addlinkedsrvlogin \n    @rmtsrvname = 'RemoteServer', \n    @useself = 'FALSE', \n    @locallogin = NULL, \n    @rmtuser = 'my_user_name', \n    @rmtpassword = 'my_pass_word'\n\n-- Query the table\nSELECT * FROM OPENQUERY([RemoteServer], 'SELECT * FROM RemoteTable')