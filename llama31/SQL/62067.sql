BEGIN TRANSACTION;\n\nBEGIN TRY\n    IF EXISTS (SELECT * FROM sys.procedures WHERE name = 'X')\n        DROP PROCEDURE X;\n\n    CREATE PROCEDURE X\n    AS\n    BEGIN\n        -- New procedure code here\n    END;\n\n    COMMIT TRANSACTION;\nEND TRY\nBEGIN CATCH\n    ROLLBACK TRANSACTION;\n    -- You could try to restore the previous version from source control or a backup here\n    PRINT 'Deployment failed. Restoring previous version...';\n    -- INSERT restore logic here\nEND CATCH;