SELECT \n  s.day AS splits_day, \n  s.ratio AS splits_ratio, \n  s.ticker AS splits_ticker, \n  d.day AS dividends_day, \n  d.amount AS dividends_amount, \n  d.ticker AS dividends_ticker\nFROM \n  splits s\n  LEFT JOIN dividends d ON s.ticker = d.ticker AND s.day = d.day\nUNION ALL\nSELECT \n  s.day AS splits_day, \n  s.ratio AS splits_ratio, \n  s.ticker AS splits_ticker, \n  d.day AS dividends_day, \n  d.amount AS dividends_amount, \n  d.ticker AS dividends_ticker\nFROM \n  dividends d\n  LEFT JOIN splits s ON d.ticker = s.ticker AND d.day = s.day\nWHERE \n  s.ticker IS NULL\nORDER BY \n  COALESCE(splits_day, dividends_day) ASC, \n  COALESCE(splits_ticker, dividends_ticker) ASC;