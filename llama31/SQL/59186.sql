DECLARE @Origin nvarchar(50) = 'ALL'; -- replace with your actual value\nDECLARE @StartDate datetime = '2022-01-01'; -- replace with your actual start date\nDECLARE @EndDate datetime = '2022-01-31'; -- replace with your actual end date\nDECLARE @Contract nvarchar(50) = 'YourContract'; -- replace with your actual contract\n\nSELECT \n    SUM(CASE WHEN DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) <= 60 THEN 1 ELSE 0 END) AS OneHour,\n    SUM(CASE WHEN DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 61 AND 120 THEN 1 ELSE 0 END) AS TwoHour,\n    SUM(CASE WHEN DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 121 AND 180 THEN 1 ELSE 0 END) AS ThreeHour,\n    SUM(CASE WHEN DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 181 AND 240 THEN 1 ELSE 0 END) AS FourHour,\n    SUM(CASE WHEN DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 241 AND 480 THEN 1 ELSE 0 END) AS EightHour,\n    SUM(CASE WHEN DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 481 AND 1440 THEN 1 ELSE 0 END) AS TwentyFourHour,\n    SUM(CASE WHEN DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 1441 AND 2880 THEN 1 ELSE 0 END) AS FortyEightHour,\n    SUM(CASE WHEN DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) >= 2881 THEN 1 ELSE 0 END) AS PlusFortyEightHour\nFROM TBL_PARTORDER\nINNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID\nINNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF\nWHERE TBL_PARTORDER.RAISED IS NOT NULL\n    AND TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME, @StartDate, 103) AND DATEADD(hh, 23, CONVERT(DATETIME, @EndDate, 103))\n    AND TBL_PROPERTY.CONTRACT = @Contract\n    AND (@Origin = 'ALL' OR TBL_REPAIR_ORDER.ORIGIN = @Origin);