CREATE INDEX idx_DrawerName ON TabDrawer (DrawerName);\nCREATE INDEX idx_DrawerSortCode ON TabDrawer (DrawerSortCode);\nCREATE INDEX idx_DrawerAccountNo ON TabDrawer (DrawerAccountNo);\nCREATE INDEX idx_TPCChequeNumber ON QryAllTransactons (TPCChequeNumber);\nCREATE INDEX idx_CustomerID ON TabCustomers (CustomerID);\n\nSELECT \n  TabDrawer.DrawerName, \n  TabDrawer.DrawerSortCode, \n  TabDrawer.DrawerAccountNo, \n  TabDrawer.DrawerPostCode, \n  QryAllTransactons.TPCChequeNumber, \n  tabdrawer.drawerref\nFROM \n  TabDrawer \n  LEFT JOIN (\n    SELECT \n      "TPC" AS Type, \n      TabTPC.TPCRef, \n      TabTPC.TPCBranch, \n      TabTPC.TPCDate, \n      TabTPC.TPCChequeNumber, \n      TabTPC.TPCChequeValue, \n      TabTPC.TPCFee, \n      TabTPC.TPCAction,\n      TabTPC.TPCMember, \n      tabtpc.tpcdrawer,\n      TabTPC.TPCUser,\n      TabTPC.TPCDiscount,\n      tabcustomers.*\n    FROM \n      TabTPC \n      INNER JOIN TabCustomers ON TabTPC.TPCMember = TabCustomers.CustomerID\n    UNION ALL \n    SELECT \n      "CTP" AS Type, \n      TabCTP.CTPRef, \n      TabCTP.CTPBranch, \n      TabCTP.CTPDate, \n      TabCTP.CTPChequeNumb, \n      TabCTP.CTPAmount, \n      TabCTP.CTPFee, \n      TabCTP.CTPAction,\n      TabCTP.CTPMember,\n      0 as CTPXXX,\n      TabCTP.CTPUser,\n      TabCTP.CTPDiscount, \n      TABCUSTOMERS.*\n    FROM \n      TabCTP  \n      INNER JOIN TabCustomers ON Tabctp.ctpMember = TabCustomers.CustomerID\n  ) AS QryAllTransactons ON TabDrawer.DrawerRef = QryAllTransactons.tpcdrawer\nWHERE \n  (Forms!FrmSearchCompany!SearchName Is Null \n   Or [drawername] = Forms!FrmSearchCompany!SearchName) \n  And (Forms!FrmSearchCompany.SearchPostcode Is Null \n   Or [Drawerpostcode] = Forms!FrmSearchCompany!Searchpostcode) \n  And (Forms!FrmSearchCompany!SearchSortCode Is Null \n   Or [drawersortcode] = Forms!FrmSearchCompany!Searchsortcode) \n  And (Forms!FrmSearchCompany!Searchaccount Is Null \n   Or [draweraccountno] = Forms!FrmSearchCompany!Searchaccount) \n  And (Forms!FrmSearchCompany!Searchcheque Is Null \n   Or [tpcchequenumber] = Forms!FrmSearchCompany!Searchcheque);