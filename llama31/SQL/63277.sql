SELECT Items.Name, tblBooks.AuthorLastName, tblBooks.AuthorFirstName,\n       Rec.ProductCode, Rec.SKU\nFROM Items\nJOIN (\n  SELECT TOP 10 ProductCode, SKU\n  FROM Recommended\n  INNER JOIN Stock ON Recommended.ProductCode = Stock.ProductCode\n  AND Stock.StatusCode = 1\n  WHERE Recommended.Type = 'TOPICAL'\n  ORDER BY CHECKSUM(NEWID())\n) AS Rec ON Items.ProductCode = Rec.ProductCode;