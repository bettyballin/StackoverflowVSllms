CREATE OR REPLACE PROCEDURE pop_records_from_queue(\n  p_queue_table  IN  VARCHAR2,\n  p_record_set  OUT SYS_REFCURSOR\n) AS\n  v_records queue_table%ROWTYPE;\nBEGIN\n  OPEN p_record_set FOR\n    SELECT *\n    FROM queue_table\n    WHERE ...;  -- your condition to select records from the queue\n\n  FETCH p_record_set BULK COLLECT INTO v_records;\n\n  FORALL i IN v_records.FIRST..v_records.LAST\n    DELETE FROM queue_table\n    WHERE ...;  -- same condition as above, using v_records(i) to access each record\nEND;\n/