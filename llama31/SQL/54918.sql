-- Create a certificate\nCREATE CERTIFICATE [BlockedProcessCert]\n   ENCRYPTION BY PASSWORD = 'password123';\n\n-- Create a login from the certificate\nCREATE LOGIN [BlockedProcessLogin] FROM CERTIFICATE [BlockedProcessCert];\n\n-- Grant the necessary permissions to the login\nGRANT VIEW SERVER STATE TO [BlockedProcessLogin];\n\n-- Create a stored procedure to execute the original procedure\nCREATE PROCEDURE [dbo].[bsp_GetBlockedProcessCount_Exec]\nWITH EXECUTE AS 'BlockedProcessLogin'\nAS\nBEGIN\n    EXEC [dbo].[bsp_GetBlockedProcessCount]\nEND\n\n-- Grant execute permissions on the new procedure to the webserver user\nGRANT EXECUTE ON [dbo].[bsp_GetBlockedProcessCount_Exec] TO [Webserver]