SELECT \n  t.name, \n  COUNT(DISTINCT bp.id) AS blog_post_count\nFROM \n  Tags t\n  LEFT JOIN Taggings tg ON t.id = tg.tag_id\n  LEFT JOIN BlogPosts bp ON tg.blog_post_id = bp.id OR bp.id IN (\n    SELECT blog_post_id FROM BlogComments WHERE id IN (\n      SELECT blog_comment_id FROM Taggings WHERE tag_id = t.id\n    )\n  )\nGROUP BY \n  t.name\nORDER BY \n  blog_post_count DESC\nLIMIT 10;