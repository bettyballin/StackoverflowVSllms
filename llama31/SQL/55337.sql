SELECT \n  user_id,\n  user_type,\n  CASE \n    WHEN user_type = 'people' THEN CONCAT(user_profiles.profile_first_name, ' ', user_profiles.profile_last_name)\n    WHEN user_type = 'companies' THEN company_profiles.profile_company_name\n  END AS user_fullname\nFROM users\nLEFT JOIN user_profiles ON ...\nLEFT JOIN company_profiles ON ...