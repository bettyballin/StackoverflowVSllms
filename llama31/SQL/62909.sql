SELECT \n    TransactionCode,\n    TenantID,\n    SUM(CASE WHEN Amount > 0 THEN Amount END) AS Paid,\n    SUM(CASE WHEN Amount < 0 AND TransactionDate > DATEADD("dd", -30, GETDATE()) THEN Amount END) AS ChargedCurrent,\n    SUM(CASE WHEN Amount < 0 AND TransactionDate > DATEADD("dd", -60, GETDATE()) AND TransactionDate <= DATEADD("dd", -30, GETDATE()) THEN Amount END) AS ChargedOver30,\n    SUM(CASE WHEN Amount < 0 AND TransactionDate > DATEADD("dd", -90, GETDATE()) AND TransactionDate <= DATEADD("dd", -60, GETDATE()) THEN Amount END) AS ChargedOver60,\n    SUM(CASE WHEN Amount < 0 AND TransactionDate <= DATEADD("dd", -90, GETDATE()) THEN Amount END) AS ChargedOver90\nFROM \n    tblTransaction\nGROUP BY \n    TransactionCode, TenantID