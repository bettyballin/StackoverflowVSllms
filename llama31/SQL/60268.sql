Create Proc Balance_Report (@AsOfDate datetime)\nAS\nBEGIN\n    IF @AsOfDate IS NULL OR @AsOfDate = GetDate()\n    BEGIN\n        SELECT GetDate() AS AsOfDate, Column1 FROM Current.Balance;\n    END\n    ELSE\n    BEGIN\n        IF ISDATE(@AsOfDate) = 1\n        BEGIN\n            SELECT AsOfDate, Column1 FROM MonthEnd.Balance WHERE AsOfDate = @AsOfDate;\n        END\n        ELSE\n        BEGIN\n            RAISERROR ('Invalid date parameter', 16, 1);\n        END\n    END\nEND