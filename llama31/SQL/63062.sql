CREATE VIEW UserProperties AS\nSELECT \n  u.UserID,\n  u.Name,\n  u.Age,\n  MAX(CASE WHEN pc.PropertyCodeID = 1 THEN pcv.PropertValue END) AS FavColour,\n  MAX(CASE WHEN pc.PropertyCodeID = 2 THEN pcv.PropertValue END) AS CarMake\nFROM \n  Users u\n  INNER JOIN UserPropertyValues upv ON u.UserID = upv.UserID\n  INNER JOIN PropertyCodeValues pcv ON upv.PropertyCodeValueID = pcv.PropertyCodeValueID\n  INNER JOIN PropertyCodes pc ON pcv.PropertyCodeID = pc.PropertyCodeID\nGROUP BY \n  u.UserID, u.Name, u.Age