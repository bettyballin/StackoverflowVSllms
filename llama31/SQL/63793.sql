SELECT TOP 1 *\nFROM MessageLookup ml\nWHERE ml.[Key] = @Key\nAND ml.CampaignTypeID = @CampaignTypeID\nAND ml.ServiceProviderID = COALESCE(@ServiceProviderID, ml.ServiceProviderID)\nAND ml.DistributorID = COALESCE(@DistributorID, ml.DistributorID)\nAND ml.CampaignID = COALESCE(@CampaignID, ml.CampaignID)\nORDER BY \n    CampaignID DESC, \n    DistributorID DESC, \n    ServiceProviderID DESC;