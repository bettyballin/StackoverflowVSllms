WITH city_counts AS (\n  SELECT city, COUNT(*) as cityCount\n  FROM tREaltyTrac\n  GROUP BY city\n  HAVING COUNT(*) > 10\n)\nDELETE FROM tREaltyTrac\nWHERE (city, creation) IN (\n  SELECT city, creation\n  FROM (\n    SELECT city, creation,\n      ROW_NUMBER() OVER (PARTITION BY city ORDER BY creation DESC) as row_num\n    FROM tREaltyTrac\n    WHERE city IN (SELECT city FROM city_counts)\n  ) subquery\n  WHERE row_num > 10\n)