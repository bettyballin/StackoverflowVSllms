SELECT p.ProjectID, p.Name, u.UserID\nFROM Projects p\nINNER JOIN Workplans w ON p.WorkplanID = w.WorkplanID\nINNER JOIN (\n  SELECT UserID, MAX(DateCreated) as MaxDate\n  FROM Workplans\n  WHERE UserID IN (@userids)  -- pass the list of userids as a parameter\n  GROUP BY UserID\n) mw ON w.UserID = mw.UserID AND w.DateCreated = mw.MaxDate\nINNER JOIN Users u ON mw.UserID = u.UserID