WITH RECURSIVE category_hierarchy AS (\n  SELECT category_id, parent_id, 0 AS level\n  FROM categories\n  WHERE category_id = ?  -- start with the given category id\n  UNION ALL\n  SELECT c.category_id, c.parent_id, level + 1\n  FROM categories c\n  JOIN category_hierarchy p ON c.parent_id = p.category_id\n)\nSELECT DISTINCT o.organization_id, o.organization_name\nFROM organizations o\nJOIN organizations_categories oc ON o.organization_id = oc.organization_id\nJOIN category_hierarchy ch ON oc.category_id = ch.category_id;