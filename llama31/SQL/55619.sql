CREATE PROCEDURE CreateDynamicSP\n    @Name nvarchar(50),\n    @Group nvarchar(50),\n    @StartDate datetime,\n    @EndDate datetime\nAS\nBEGIN\n    DECLARE @sql nvarchar(max)\n    SET @sql = '\n        SELECT ' + @Group + ' AS GroupField,\n               Sum([Project].[NumProject]) AS TotalProject,\n               Sum([Project].[Title]) AS SumTitle,\n               Sum([Project].[Duration]) AS SumDuration,\n               Sum([Project].[Info]) AS SumInfo,\n               Sum([Customer].[NumCustomer]) AS TotalNumCustomer,\n               Sum([Orders].[NumOrders]) AS TotalNumOrders,\n               Sum([OrderInspection].[NumInspects]) AS TotalNumInspects,\n               Sum([OrderInspection].[NumFails]) AS TotalNumFails,\n               Sum([CustomerInspection].[NumInspects]) AS TotalNumCustomerInspectionInspects,\n               Sum([CustomerInspection].[NumFails]) AS TotalNumCustomerInspectionFails,\n               Sum([Measurements].[NumMeasurements]) AS TotalNumMeasurementss\n        FROM ((((((sale LEFT JOIN Project ON [sale].[saleId]=[Project].[saleId])\n                 LEFT JOIN Customer ON [Project].[PrintId]=[Customer].[PrintId])\n                 LEFT JOIN Orders ON [Project].[PrintId]=[Orders].[PrintId])\n                 LEFT JOIN OrderInspection ON [Project].[PrintId]=[OrderInspection].[PrintId])\n                 LEFT JOIN CustomerInspection ON [Project].[PrintId]=[CustomerInspection].[PrintId])\n                 LEFT JOIN Measurements ON [Project].[PrintId]=[Measurements].[PrintId])\n        WHERE [sale].[DateTime] BETWEEN @StartDate AND @EndDate\n        GROUP BY ' + @Group + '\n        ORDER BY ' + @Group\n\n    EXEC sp_executesql @sql, N'@StartDate datetime, @EndDate datetime', @StartDate = @StartDate, @EndDate = @EndDate\nEND