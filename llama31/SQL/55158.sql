CREATE TABLE hashed_data (\n  id INT PRIMARY KEY,\n  hashed_lastname VARBINARY(256)\n);\n\nINSERT INTO hashed_data (id, hashed_lastname)\nSELECT id, HASHBYTES('SHA2_256', lastname)\nFROM table;\n\nCREATE TABLE fake_data (\n  id INT PRIMARY KEY,\n  fake_lastname VARCHAR(50)\n);\n\nINSERT INTO fake_data (id, fake_lastname)\nSELECT id, (SELECT name FROM samplenames ORDER BY NEWID() LIMIT 1)\nFROM hashed_data;\n\nUPDATE table\nSET lastname = (SELECT fake_lastname FROM fake_data WHERE id = table.id);