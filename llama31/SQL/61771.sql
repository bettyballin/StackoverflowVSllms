SELECT \n    name, \n    CASE \n        WHEN password_hash IS NULL THEN 'No Password' \n        WHEN PWDCOMPARE('', password_hash) = 1 THEN 'Blank Password' \n        WHEN PWDCOMPARE(name, password_hash) = 1 THEN 'Weak Password' \n        ELSE 'Strong Password' \n    END AS PasswordStrength\nFROM \n    master.dbo.syslogins\nWHERE \n    isntname = 0  -- exclude NT logins\n    AND isntgroup = 0  -- exclude groups