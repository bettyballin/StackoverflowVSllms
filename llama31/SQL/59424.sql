DECLARE @sql AS NVARCHAR(MAX)\nDECLARE @pivotList AS NVARCHAR(MAX)\n\nSELECT @pivotList = COALESCE(@pivotList + ',', '') + QUOTENAME(GivenTo)\nFROM (SELECT DISTINCT GivenTo FROM FeedbackSummary) AS DistinctGivenTo\n\nSET @sql = N'\n    SELECT GivenBy, ' + @pivotList + '\n    FROM \n    (\n        SELECT GivenBy, GivenTo, Points\n        FROM FeedbackSummary\n    ) AS SourceTable\n    PIVOT \n    (\n        SUM(Points)\n        FOR GivenTo IN (' + @pivotList + ')\n    ) AS PivotTable\n'\n\nEXEC sp_executesql @sql