SELECT \n  u.userId, \n  u.name, \n  o1.orderId AS orderId1, \n  o1.orderType AS orderType1, \n  o1.createDate AS createDate1,\n  o2.orderId AS orderId2, \n  o2.orderType AS orderType2, \n  o2.createDate AS createDate2\nFROM \n  userData u\n  LEFT JOIN (\n    SELECT \n      userId, \n      orderId, \n      orderType, \n      createDate,\n      ROW_NUMBER() OVER (PARTITION BY userId ORDER BY createDate DESC) AS rn\n    FROM \n      orderData\n    WHERE \n      orderType = '1'\n  ) o1 ON u.userId = o1.userId AND o1.rn = 1\n  LEFT JOIN (\n    SELECT \n      userId, \n      orderId, \n      orderType, \n      createDate,\n      ROW_NUMBER() OVER (PARTITION BY userId ORDER BY createDate DESC) AS rn\n    FROM \n      orderData\n    WHERE \n      orderType = '2'\n  ) o2 ON u.userId = o2.userId AND o2.rn = 1