WITH payments AS (\n  SELECT \n    SchedID,\n    1 AS PaymentNum,\n    StartDate AS DueDate,\n    PaymentAmt AS ExpectedTotal\n  FROM payment_schedule\n  UNION ALL\n  SELECT \n    p.SchedID,\n    p.PaymentNum + 1,\n    ADD_MONTHS(p.DueDate, ps.Frequency),\n    p.ExpectedTotal + ps.PaymentAmt\n  FROM payments p\n  JOIN payment_schedule ps ON p.SchedID = ps.SchedID\n  WHERE p.PaymentNum < (ps.Term / ps.Frequency) + 1\n)\nSELECT * FROM payments\nORDER BY SchedID, PaymentNum;