CREATE PROCEDURE DynamicPivot\n    @TableName nvarchar(128),\n    @PivotColumn nvarchar(128),\n    @ValueColumn nvarchar(128)\nAS\nBEGIN\n    DECLARE @sql nvarchar(max);\n    DECLARE @pivotList nvarchar(max);\n\n    SET @pivotList = STUFF((SELECT DISTINCT ',' + QUOTENAME(CONVERT(nvarchar(128), [employee_id]))\n                            FROM @TableName\n                            FOR XML PATH(''), TYPE).value('.', 'nvarchar(max)'), 1, 1, '');\n\n    SET @sql = N'\n        SELECT *\n        FROM \n            (SELECT [employee_id], [value]\n             FROM ' + QUOTENAME(@TableName) + ') AS SourceTable\n        PIVOT \n            (SUM([value])\n             FOR [employee_id] IN (' + @pivotList + ')\n            ) AS PivotTable\n    ';\n\n    EXEC sp_executesql @sql;\nEND;