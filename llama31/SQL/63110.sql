SELECT \n  t1.`Transaction Date`, \n  t1.`Transaction Qty`, \n  t1.`Transaction Value`, \n  COUNT(*) as Count\nFROM \n  transactions t1\nWHERE \n  t1.Reversal = 'N'\n  AND NOT EXISTS (\n    SELECT 1 \n    FROM transactions t2 \n    WHERE t2.`Transaction Date` = t1.`Transaction Date` \n    AND t2.`Transaction Qty` = -t1.`Transaction Qty` \n    AND t2.`Transaction Value` = -t1.`Transaction Value` \n    AND t2.Reversal = 'Y'\n  )\nGROUP BY \n  t1.`Transaction Date`, \n  t1.`Transaction Qty`, \n  t1.`Transaction Value`\nHAVING \n  COUNT(*) > 1