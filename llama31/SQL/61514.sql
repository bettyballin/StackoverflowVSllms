CREATE PROCEDURE GetNextIdentifier\nAS\nBEGIN\n    DECLARE @lastId CHAR(5)\n    DECLARE @nextId CHAR(5)\n    SET @lastId = (SELECT MAX(Id) FROM YourTable)\n\n    IF @lastId = 'ZZZZZ'\n        SET @nextId = 'AAAAA'\n    ELSE\n        SET @nextId = dbo.IncrementId(@lastId)\n\n    WHILE EXISTS (SELECT 1 FROM YourTable WHERE Id = @nextId)\n    BEGIN\n        SET @nextId = dbo.IncrementId(@nextId)\n    END\n\n    SELECT @nextId AS NextIdentifier\nEND\n\nCREATE FUNCTION IncrementId (@id CHAR(5))\nRETURNS CHAR(5)\nAS\nBEGIN\n    DECLARE @nextId CHAR(5)\n    DECLARE @i INT\n\n    SET @i = LEN(@id)\n    WHILE @i > 0\n    BEGIN\n        IF SUBSTRING(@id, @i, 1) = 'Z'\n        BEGIN\n            SET @nextId = LEFT(@id, @i - 1) + 'A' + RIGHT(@id, LEN(@id) - @i)\n        END\n        ELSE\n        BEGIN\n            SET @nextId = LEFT(@id, @i - 1) + CHAR(ASCII(SUBSTRING(@id, @i, 1)) + 1) + RIGHT(@id, LEN(@id) - @i)\n            BREAK\n        END\n        SET @i = @i - 1\n    END\n\n    RETURN @nextId\nEND