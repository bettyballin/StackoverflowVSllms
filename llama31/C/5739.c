#include <ntifs.h>\n\n// Define the callback function\nVOID CALLBACK RegistryCallback(\n    _In_ PLARGE_INTEGER Cookie,\n    _In_ PVOID Context,\n    _In_ ULONG Notification,\n    _In_opt_ PVOID Argument1,\n    _In_opt_ PVOID Argument2\n)\n{\n    UNREFERENCED_PARAMETER(Cookie);\n    UNREFERENCED_PARAMETER(Context);\n    UNREFERENCED_PARAMETER(Notification);\n    UNREFERENCED_PARAMETER(Argument1);\n    UNREFERENCED_PARAMETER(Argument2);\n\n    // Check if the \Registry\Machine\Software key is loaded\n    HANDLE hKey;\n    NTSTATUS status = ZwOpenKey(&hKey, KEY_READ, &RegistryMachineSoftware);\n    if (NT_SUCCESS(status)) {\n        // The key is loaded, you can now access it\n        ZwClose(hKey);\n    }\n}\n\n// Register the callback\nVOID DriverEntry(PDRIVER_OBJECT DriverObject, PUNICODE_STRING RegistryPath)\n{\n    // ...\n    LARGE_INTEGER Cookie;\n    NTSTATUS status = CmRegisterCallbackEx(RegistryCallback, &Cookie, NULL, NULL, NULL);\n    if (!NT_SUCCESS(status)) {\n        // Handle the error\n    }\n    // ...\n}