uint32_t current = 0x04;  // 00000100\nuint32_t request_mask = 0x60;  // 01100000\nuint32_t n = 8;  // number of slaves\n\n// shift current to the left, wrapping around to the right if necessary\nuint32_t next = (current << 1) | (current >> (n - 1));\n\n// mask out slaves that don't want to be scheduled\nnext = next & request_mask;\n\n// find the first set bit in the result\nnext = next & -next;\n\nprintf("%02x\n", next);  // 00100000