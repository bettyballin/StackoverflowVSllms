#include <X11/Xlib.h>\n#include <X11/Xutil.h>\n\nint main() {\n    Display *display = XOpenDisplay(NULL);\n    if (!display) {\n        return 1;\n    }\n\n    Window root = RootWindow(display, DefaultScreen(display));\n    XImage *image = XGetImage(display, root, 0, 0, 800, 600, AllPlanes, ZPixmap);\n    if (!image) {\n        XCloseDisplay(display);\n        return 1;\n    }\n\n    // Save the image to a file\n    FILE *file = fopen("screenshot.png", "wb");\n    if (!file) {\n        XDestroyImage(image);\n        XCloseDisplay(display);\n        return 1;\n    }\n\n    png_structp png_ptr = png_create_write_struct(PNG_LIBPNG_VER_STRING, NULL, NULL, NULL);\n    if (!png_ptr) {\n        fclose(file);\n        XDestroyImage(image);\n        XCloseDisplay(display);\n        return 1;\n    }\n\n    png_infop info_ptr = png_create_info_struct(png_ptr);\n    if (!info_ptr) {\n        png_destroy_write_struct(&png_ptr, NULL);\n        fclose(file);\n        XDestroyImage(image);\n        XCloseDisplay(display);\n        return 1;\n    }\n\n    png_init_io(png_ptr, file);\n    png_set_IHDR(png_ptr, info_ptr, image->width, image->height, 8, PNG_COLOR_TYPE_RGB, PNG_INTERLACE_NONE, PNG_COMPRESSION_TYPE_DEFAULT, PNG_FILTER_TYPE_DEFAULT);\n    png_write_info(png_ptr, info_ptr);\n    png_write_image(png_ptr, (png_bytep*)image->data);\n    png_write_end(png_ptr, NULL);\n\n    png_destroy_write_struct(&png_ptr, &info_ptr);\n    fclose(file);\n    XDestroyImage(image);\n    XCloseDisplay(display);\n\n    return 0;\n}