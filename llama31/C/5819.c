HANDLE hFile = /* your file handle */;\nFILE_INFO_BY_HANDLE_CLASS fileInfoClass = FileNameInfo;\nLPVOID lpFileInformation = NULL;\nDWORD dwBufferSize = 0;\n\n// Get the required buffer size\nGetFileInformationByHandle(hFile, fileInfoClass, lpFileInformation, dwBufferSize, &dwBufferSize);\n\n// Allocate the buffer and retrieve the file information\nlpFileInformation = HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, dwBufferSize);\nif (lpFileInformation) {\n    GetFileInformationByHandle(hFile, fileInfoClass, lpFileInformation, dwBufferSize, &dwBufferSize);\n\n    // Extract the process ID from the file information\n    FILE_NAME_INFO *fileNameInfo = (FILE_NAME_INFO *)lpFileInformation;\n    DWORD dwProcessId = fileNameInfo->dwProcessId;\n\n    // Use the process ID to get the process name\n    HANDLE hProcess = OpenProcess(PROCESS_QUERY_INFORMATION, FALSE, dwProcessId);\n    if (hProcess) {\n        HMODULE hModule;\n        EnumProcessModules(hProcess, &hModule, sizeof(hModule), &dwBufferSize);\n        GetModuleBaseName(hProcess, hModule, lpFileInformation, dwBufferSize);\n        printf("Process name: %s\n", lpFileInformation);\n        CloseHandle(hProcess);\n    }\n\n    HeapFree(GetProcessHeap(), 0, lpFileInformation);\n}