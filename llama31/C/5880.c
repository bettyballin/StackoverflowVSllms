#define BUFFER_SIZE 128\n\nuint8_t buffer[BUFFER_SIZE];\nvolatile uint16_t uart_rx_idx = 0;\nvolatile uint16_t spi_tx_idx = 0;\n\nvoid uart_rx_isr(void) {\n    uint8_t byte = uart_get_byte();\n    buffer[uart_rx_idx++] = byte;\n    if (uart_rx_idx >= BUFFER_SIZE) {\n        uart_rx_idx = 0;\n    }\n}\n\nvoid spi_tx_isr(void) {\n    uint8_t byte = buffer[spi_tx_idx++];\n    spi_send_byte(byte);\n    if (spi_tx_idx >= BUFFER_SIZE) {\n        spi_tx_idx = 0;\n    }\n}