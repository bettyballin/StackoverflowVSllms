#include <openssl/sha.h>\n\n// ...\n\n// Calculate the expected hash\nunsigned char expected_hash[SHA256_DIGEST_LENGTH];\nSHA256(token, token_size, expected_hash);\n\n// Calculate the hash of the received token\nunsigned char received_hash[SHA256_DIGEST_LENGTH];\nSHA256(received_token, token_size, received_hash);\n\n// Compare the hashes\nif (memcmp(expected_hash, received_hash, SHA256_DIGEST_LENGTH) == 0) {\n    // Token is valid\n} else {\n    // Token is invalid\n}