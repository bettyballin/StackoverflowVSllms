#include <xz/xz.h>\n\n// ...\n\n// Open the XZ archive for streaming decompression\nxz_dec_t* dec = xz_dec_init(XZ_DYNALLOC_DEFAULT, 0);\n\n// ...\n\n// Read data from the archive and decompress files on the fly\nwhile (xz_dec_run(dec, buf, bufsize) > 0) {\n    // Check if the current file is complete and can be extracted\n    if (xz_dec_get_info(dec, NULL, NULL, NULL, NULL, NULL) == XZ_OK) {\n        // Extract the file to a memory buffer\n        void* file_data;\n        int file_size;\n        xz_dec_get_file_data(dec, &file_data, &file_size);\n        // Process the file data...\n    }\n}\n\nxz_dec_end(dec);