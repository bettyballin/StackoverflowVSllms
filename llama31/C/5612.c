#include <procps.h>\n#include <stdio.h>\n\nint main() {\n    PROCTAB *pt;\n    proc_t p;\n    int i;\n\n    pt = openproc(PROC_FILLSTAT | PROC_FILLUSR | PROC_FILLCOM);\n    if (pt == NULL) {\n        perror("openproc");\n        return 1;\n    }\n\n    while (nextproc(pt, &p)) {\n        printf("PID: %d, Name: %s\n", p.tid, p.cmd);\n        procfile_t *pf;\n        pf = openfiles(p.tid);\n        if (pf == NULL) {\n            perror("openfiles");\n            continue;\n        }\n        for (i = 0; i < pf->nfiles; i++) {\n            printf("  %s\n", pf->files[i].path);\n        }\n        closefiles(pf);\n    }\n\n    closeproc(pt);\n    return 0;\n}