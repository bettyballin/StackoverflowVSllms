pthread_mutex_t lock_it = PTHREAD_MUTEX_INITIALIZER;\npthread_cond_t write_it = PTHREAD_COND_INITIALIZER;\nint ready = 0;\n\nvoid* send_segments(void *v) {\n    for (;;) {\n        pthread_mutex_lock(&lock_it);\n        printf("s1\n");\n        printf("s2\n");\n        while (!ready) {\n            pthread_cond_wait(&write_it, &lock_it);\n        }\n        ready = 0;\n        printf("s3\n");\n        printf("s4\n");\n        printf("s5\n");\n        pthread_mutex_unlock(&lock_it);\n    }\n    return 0;\n}\n\nvoid* recv_acks(void *v) {\n    for (;;) {\n        pthread_mutex_lock(&lock_it);\n        printf("r1\n");\n        ready = 1;\n        pthread_cond_broadcast(&write_it);\n        printf("r2\n");\n        pthread_mutex_unlock(&lock_it);\n    }\n    return 0;\n}