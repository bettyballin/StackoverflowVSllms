// Initial connection to server\nint server_fd = connect_to_server(server_ip, server_port);\n\n// Exchange IP addresses and port numbers with peer through server\nsend_to_server(server_fd, "GET_PEER_INFO");\npeer_ip = receive_from_server(server_fd);\npeer_port = receive_from_server(server_fd);\n\n// Hole punching\nsend_to_peer(peer_ip, peer_port, "HOLE_PUNCH");\n\n// Wait for acknowledgement from peer\nack_fd = listen_for_ack(peer_ip, peer_port);\n\n// Establish direct connection\nif (ack_fd != -1) {\n    // Switch to direct connection\n    close(server_fd);\n    use_direct_connection(ack_fd);\n}