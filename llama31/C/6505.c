#include <tlhelp32.h>\n\n// Create a snapshot of all threads\nHANDLE hSnapshot = CreateToolhelp32Snapshot(TH32CS_SNAPTHREAD, 0);\n\n// Enumerate threads\nTHREADENTRY32 te;\nte.dwSize = sizeof(te);\nif (Thread32First(hSnapshot, &te)) {\n    do {\n        // Get the thread times\n        FILETIME createTime, exitTime, kernelTime, userTime;\n        GetThreadTimes(te.th32ThreadID, &createTime, &exitTime, &kernelTime, &userTime);\n\n        // Calculate the CPU usage\n        ULONGLONG kernelTimeMs = (ULONGLONG)kernelTime.dwHighDateTime << 32 | kernelTime.dwLowDateTime;\n        ULONGLONG userTimeMs = (ULONGLONG)userTime.dwHighDateTime << 32 | userTime.dwLowDateTime;\n        ULONGLONG totalTimeMs = kernelTimeMs + userTimeMs;\n\n        // Print the CPU usage\n        printf("Thread ID: %d, CPU usage: %llu ms\n", te.th32ThreadID, totalTimeMs);\n    } while (Thread32Next(hSnapshot, &te));\n}\n\n// Close the snapshot handle\nCloseHandle(hSnapshot);