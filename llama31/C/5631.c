#include <pcap.h>\n\nint main() {\n    pcap_t *handle;\n    struct pcap_pkthdr *header;\n    const u_char *packet;\n\n    handle = pcap_open_live("any", 65535, 1, 1000, NULL);\n    if (handle == NULL) {\n        pcap_perror("pcap_open_live");\n        return 1;\n    }\n\n    pcap_loop(handle, 1, &process_packet, NULL);\n    pcap_close(handle);\n    return 0;\n}\n\nvoid process_packet(u_char *args, const struct pcap_pkthdr *header,\n                    const u_char *packet) {\n    printf("Packet size: %d bytes\n", header->caplen);\n}