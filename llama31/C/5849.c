#include <openssl/rsa.h>\n#include <openssl/sha.h>\n\n// Generate a key pair\nRSA *rsa = RSA_new();\nBIGNUM *bne = BN_new();\nBN_set_word(bne, 65537);\nRSA_generate_key_ex(rsa, 2048, bne, NULL);\n\n// Sign a product key\nunsigned char *product_key = "aaaaa-bbbbb-ccccc-ddddd-eeeee";\nunsigned char *signature = malloc(RSA_size(rsa));\nSHA256_CTX sha256;\nSHA256_Init(&sha256);\nSHA256_Update(&sha256, product_key, strlen(product_key));\nSHA256_Final(signature, &sha256);\nRSA_sign(NID_sha256, signature, SHA256_DIGEST_LENGTH, signature, &signature_len, rsa);\n\n// Verify a signature\nint verify_signature(RSA *rsa, unsigned char *product_key, unsigned char *signature) {\n    SHA256_CTX sha256;\n    SHA256_Init(&sha256);\n    SHA256_Update(&sha256, product_key, strlen(product_key));\n    SHA256_Final(signature, &sha256);\n    int result = RSA_verify(NID_sha256, signature, SHA256_DIGEST_LENGTH, signature, signature_len, rsa);\n    return result == 1; // 1 means valid signature\n}