int decrypt(const unsigned char* data, int dataLen, const unsigned char* key, int keyLen, \n            const unsigned char* iv, int ivLen, unsigned char* output, int outputLen)\n{\n    HCRYPTPROV hProv;\n    HCRYPTKEY hKey;\n    BLOBHEADER keyBlob;\n    DWORD dwLen;\n\n    if (!CryptAcquireContext(&hProv, NULL, NULL, PROV_RSA_FULL, 0))\n        return -1;\n\n    keyBlob.bType = PLAINTEXTKEYBLOB;\n    keyBlob.bVersion = CUR_BLOB_VERSION;\n    keyBlob.reserved = 0;\n    keyBlob.aiKeyAlg = CALG_AES_256;\n\n    if (!CryptImportKey(hProv, (const LPBYTE)&keyBlob, sizeof(BLOBHEADER) + keyLen, 0, CRYPT_EXPORTABLE, &hKey))\n    {\n        CryptReleaseContext(hProv, 0);\n        return -1;\n    }\n\n    if (!CryptSetKeyParam(hKey, KP_IV, (const BYTE*)iv, 0))\n    {\n        CryptDestroyKey(hKey);\n        CryptReleaseContext(hProv, 0);\n        return -1;\n    }\n\n    dwLen = dataLen;\n\n    if (!CryptDecrypt(hKey, 0, TRUE, 0, (LPBYTE)data, &dwLen))\n    {\n        CryptDestroyKey(hKey);\n        CryptReleaseContext(hProv, 0);\n        return -1;\n    }\n\n    if (dwLen > outputLen)\n    {\n        CryptDestroyKey(hKey);\n        CryptReleaseContext(hProv, 0);\n        return -1;\n    }\n\n    memcpy_s(output, outputLen, data, dwLen);\n\n    CryptDestroyKey(hKey);\n    CryptReleaseContext(hProv, 0);\n\n    return dwLen;\n}