HANDLE hPipeRead, hPipeWrite;\nSECURITY_ATTRIBUTES saAttr = { sizeof(SECURITY_ATTRIBUTES) };\nsaAttr.bInheritHandle = TRUE;\nsaAttr.lpSecurityDescriptor = NULL;\n\nif (!CreatePipe(&hPipeRead, &hPipeWrite, &saAttr, 0)) {\n    // error handling\n}\n\nSTARTUPINFO si = { sizeof(STARTUPINFO) };\nsi.dwFlags = STARTF_USESTDHANDLES;\nsi.hStdOutput = hPipeWrite;\nsi.hStdError = hPipeWrite;\n\nPROCESS_INFORMATION pi = { 0 };\nif (!CreateProcess(NULL, "command", NULL, NULL, TRUE, 0, NULL, NULL, &si, &pi)) {\n    // error handling\n}\n\n// read from pipe\nchar buffer[128];\nDWORD bytesRead;\nwhile (ReadFile(hPipeRead, buffer, 128, &bytesRead, NULL)) {\n    // process buffer\n}\n\nCloseHandle(hPipeRead);\nCloseHandle(hPipeWrite);\nCloseHandle(pi.hProcess);\nCloseHandle(pi.hThread);