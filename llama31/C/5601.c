#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <stropts.h>\n#include <stdio.h>\n#include <errno.h>\n#include <unistd.h>\n#include <sys/socket.h>\n\nint main(int argc, char *argv[])\n{\n    int sock, conn;\n    struct sockaddr_in addr;\n    socklen_t addrlen = sizeof(addr);\n\n    // Create a socket\n    sock = socket(AF_INET, SOCK_STREAM, 0);\n    if (sock < 0) {\n        perror("socket");\n        return 1;\n    }\n\n    // Bind the socket to a address and port\n    addr.sin_family = AF_INET;\n    addr.sin_port = htons(8080);\n    inet_pton(AF_INET, "127.0.0.1", &addr.sin_addr);\n    if (bind(sock, (struct sockaddr *)&addr, addrlen) < 0) {\n        perror("bind");\n        return 1;\n    }\n\n    // Listen for incoming connections\n    if (listen(sock, 1) < 0) {\n        perror("listen");\n        return 1;\n    }\n\n    // Accept an incoming connection\n    conn = accept(sock, (struct sockaddr *)&addr, &addrlen);\n    if (conn < 0) {\n        perror("accept");\n        return 1;\n    }\n\n    // Receive the file descriptor\n    recvfd(conn);\n\n    return 0;\n}\n\nvoid recvfd(int sock)\n{\n    struct strrecvfd rfdbuf;\n    struct stat statbuf;\n    int i;\n\n    i = ioctl(sock, I_RECVFD, &rfdbuf);\n    if (i < 0) {\n        perror("ioctl");\n        return;\n    }\n\n    printf("recvfd=%d\n", rfdbuf.fd);\n}