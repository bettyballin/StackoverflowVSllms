#include <openssl/rsa.h>\n#include <openssl/err.h>\n\n// Generate a new RSA key pair\nRSA* rsa = RSA_new();\nBIGNUM* exponent = BN_new();\nBN_set_word(exponent, 65537);\nRSA_generate_key_ex(rsa, 2048, exponent, NULL);\n\n// Encrypt a message\nconst char* message = "Hello, World!";\nunsigned char encrypted[256];\nint encrypted_len = RSA_public_encrypt(strlen(message), (const unsigned char*)message, encrypted, rsa, RSA_PKCS1_OAEP_PADDING);\n\n// Decrypt the message\nunsigned char decrypted[256];\nint decrypted_len = RSA_private_decrypt(encrypted_len, encrypted, decrypted, rsa, RSA_PKCS1_OAEP_PADDING);\n\n// Print the decrypted message\nprintf("%s\n", decrypted);\n\n// Free resources\nRSA_free(rsa);\nBN_free(exponent);