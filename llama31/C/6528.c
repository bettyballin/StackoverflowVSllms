int retry = 0;\nDWORD dwError = 0;\nBOOL bResult = false;\n\ndo\n{\n    bResult = PostThreadMessage(pTaskHandle->dwThreadID, 0, 0, (LPARAM)pMessage);\n    if (!bResult)\n    {\n        dwError = GetLastError();\n        // Consider logging dwError here to see if it changes between retries\n        retry++;\n        Sleep(500);\n    }\n} while (!bResult && retry < 5); // Increased retry count\n\nif (!bResult)\n{\n    // Log or handle the final error status\n    printf("Failed to post thread message after %d retries, last error: %d\n", retry, dwError);\n}