#include <dbus/dbus.h>\n\nDBusConnection *session_bus;\nDBusProxy *session_proxy;\n\nvoid session_active_changed(DBusProxy *proxy, DBusMessage *msg) {\n    dbus_bool_t active;\n    dbus_message_get_args(msg, NULL, DBUS_TYPE_BOOLEAN, &active, DBUS_TYPE_INVALID);\n    if (active) {\n        printf("Session active\n");\n    } else {\n        printf("Session inactive\n");\n    }\n}\n\nint main() {\n    session_bus = dbus_bus_get(DBUS_BUS_SESSION, NULL);\n    session_proxy = dbus_proxy_new(session_bus, "org.freedesktop.ConsoleKit", "/org/freedesktop/ConsoleKit/Session", "org.freedesktop.ConsoleKit.Session");\n\n    dbus_proxy_add_signal_handler(session_proxy, "SessionActiveChanged", session_active_changed, NULL);\n\n    while (1) {\n        dbus_connection_iterate(session_bus, FALSE);\n    }\n    return 0;\n}