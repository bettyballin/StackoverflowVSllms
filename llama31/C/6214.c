#include <pcap.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n\nint main() {\n    pcap_t *handle;\n    char errbuf[PCAP_ERRBUF_SIZE];\n    struct pcap_pkthdr header;\n    const u_char *packet;\n\n    // Open the promiscuous device\n    handle = pcap_open_live("wlan0", 65535, 1, 1000, errbuf);\n    if (handle == NULL) {\n        fprintf(stderr, "pcap_open_live: %s\n", errbuf);\n        return 1;\n    }\n\n    // Read packets\n    while (1) {\n        packet = pcap_next(handle, &header);\n        if (packet == NULL) {\n            continue;\n        }\n\n        // Process the packet\n        // ...\n\n        // Print the packet (optional)\n        fprintf(stdout, "Packet captured: %d bytes\n", header.caplen);\n    }\n\n    pcap_close(handle);\n    return 0;\n}