HDC hDC = GetDC(NULL);\nHDC hMemDC = CreateCompatibleDC(hDC);\nHBITMAP hBitmap = CreateCompatibleBitmap(hDC, GetDeviceCaps(hDC, HORZRES), GetDeviceCaps(hDC, VERTRES));\nHGDIOBJ hObjectOld = SelectObject(hMemDC, hBitmap);\n\nBitBlt(hMemDC, 0, 0, GetDeviceCaps(hDC, HORZRES), GetDeviceCaps(hDC, VERTRES), hDC, 0, 0, SRCCOPY | CAPTUREBLT);\n\nSelectObject(hMemDC, hObjectOld);\nDeleteDC(hMemDC);\nReleaseDC(NULL, hDC);