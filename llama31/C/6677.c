#include <openssl/ssl.h>\n#include <openssl/x509.h>\n\n// ...\n\nSSL_CTX *ctx = SSL_CTX_new(TLS_client_method());\nSSL *ssl = SSL_new(ctx);\n\n// Connect to the server and get the certificate\nX509 *cert = SSL_get_peer_certificate(ssl);\n\n// Verify the certificate chain\nX509_STORE_CTX *store_ctx = X509_STORE_CTX_new();\nX509_STORE_CTX_init(store_ctx, NULL, NULL, NULL);\nX509_STORE_CTX_set_cert(store_ctx, cert);\nint ret = X509_verify_cert(store_ctx);\nif (ret != 1) {\n    // Certificate verification failed\n}\n\n// Check the certificate's subject\nX509_NAME *subject = X509_get_subject_name(cert);\nchar *subject_str = X509_NAME_oneline(subject, NULL, 0);\nif (strcmp(subject_str, "expected_subject") != 0) {\n    // Certificate subject mismatch\n}\n\n// Check the certificate's expiration date\nASN1_TIME *not_after = X509_get_notAfter(cert);\ntime_t now = time(NULL);\nif (ASN1_TIME_cmp(not_after, ASN1_TIME_set(now)) <= 0) {\n    // Certificate has expired\n}\n\n// Verify the certificate's public key\nEVP_PKEY *public_key = X509_get_pubkey(cert);\nif (public_key == NULL) {\n    // Failed to get public key\n}