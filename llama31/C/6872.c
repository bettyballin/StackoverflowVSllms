// Backup registry entry during installation\nHKEY hKey;\nRegOpenKeyEx(HKEY_CLASSES_ROOT, "abcfile\\shell\\open\\command", 0, KEY_READ, &hKey);\nRegQueryValueEx(hKey, NULL, NULL, &dwType, (LPBYTE)&szOrigValue, &dwSize);\nRegCloseKey(hKey);\n\n// Store the backed-up value in a secure location\nHKEY hBackupKey;\nRegCreateKeyEx(HKEY_CURRENT_USER, "Software\\MyApp\\Backup", 0, NULL, REG_OPTION_NON_VOLATILE, KEY_WRITE, NULL, &hBackupKey, NULL);\nRegSetValueEx(hBackupKey, "abcfile\\shell\\open\\command", 0, dwType, (LPBYTE)&szOrigValue, dwSize);\nRegCloseKey(hBackupKey);\n\n// Restore registry entry during uninstallation\nHKEY hKey;\nRegOpenKeyEx(HKEY_CLASSES_ROOT, "abcfile\\shell\\open\\command", 0, KEY_WRITE, &hKey);\nRegRestoreKey(hKey, HKEY_CURRENT_USER, "Software\\MyApp\\Backup", REG_FORCE_RESTORE);\nRegCloseKey(hKey);