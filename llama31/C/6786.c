#include <stdint.h>\n\nvoid rc4_init(uint8_t *state, uint8_t *key, size_t keylen) {\n    uint8_t j = 0;\n    for (size_t i = 0; i < 256; i++) {\n        state[i] = i;\n    }\n    for (size_t i = 0; i < 256; i++) {\n        j += state[i] + key[i % keylen];\n        uint8_t temp = state[i];\n        state[i] = state[j];\n        state[j] = temp;\n    }\n}\n\nvoid rc4_crypt(uint8_t *state, uint8_t *data, size_t datalen) {\n    uint8_t i = 0, j = 0;\n    for (size_t k = 0; k < datalen; k++) {\n        i = (i + 1) % 256;\n        j = (j + state[i]) % 256;\n        uint8_t temp = state[i];\n        state[i] = state[j];\n        state[j] = temp;\n        data[k] ^= state[(state[i] + state[j]) % 256];\n    }\n}\n\nint main() {\n    uint8_t key[] = "secretkey";\n    uint8_t state[256];\n    uint8_t data[] = "Hello, World!";\n    size_t datalen = sizeof(data) - 1;\n\n    rc4_init(state, key, sizeof(key) - 1);\n    rc4_crypt(state, data, datalen);\n\n    // encrypted data is now in the data array\n\n    return 0;\n}