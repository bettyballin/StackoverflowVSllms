// ...\n\n// Keep track of the length of the cipher array\nint cipher_len = 0;\n\nwhile(1){\n    for(i=0; i<8; i++)    //reinitiate the block of 8 characters each time\n        block[i] = 0;\n    strncpy(block, plain+offset, 8);\n    BF_cbc_encrypt(plain+offset, cipher, 8, &s_key, IV, BF_ENCRYPT);   \n    for(i=0; i<8; i++){\n        printf("%02x", (unsigned char) cipher[i]);\n        cipher_len++; // increment the cipher length\n    }\n    if( strlen(plain+offset)>8 ){    //if there is still more characters\n        offset += 8;         //process the next block of 8 characters\n    } else\n        break;       \n}\n\n// ...\n\n// Decrypt the cipher text using the correct length\nBF_cbc_encrypt(cipher, plain, cipher_len, &s_key, IV, BF_DECRYPT);  \n\n// Print the decrypted plain text\nfor(i=0; i<cipher_len; i++){\n    printf("%c", plain[i]);\n}