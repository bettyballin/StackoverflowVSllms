// Define the states and next states for each task\ntypedef enum {\n    STATE_IDLE,\n    STATE_I2C_WAIT,\n    STATE_SLEEP_WAIT,\n    // ...\n} state_t;\n\n// Define the state transition table\nstatic const state_t next_state[][STATE_MAX] = {\n    [STATE_IDLE] = {STATE_I2C_WAIT, STATE_SLEEP_WAIT, ...},\n    [STATE_I2C_WAIT] = {STATE_IDLE, STATE_SLEEP_WAIT, ...},\n    [STATE_SLEEP_WAIT] = {STATE_IDLE, STATE_I2C_WAIT, ...},\n    // ...\n};\n\n// Define the task structure\ntypedef struct {\n    state_t current_state;\n    // ...\n} task_t;\n\n// Task function\nvoid task_func(task_t *task) {\n    // Get the current state and next state\n    state_t current_state = task->current_state;\n    state_t next_state = next_state[current_state][event];\n\n    // Perform the state transition\n    task->current_state = next_state;\n\n    // Execute the state-specific code\n    switch (next_state) {\n        case STATE_I2C_WAIT:\n            // Handle I2C wait\n            break;\n        case STATE_SLEEP_WAIT:\n            // Handle sleep wait\n            break;\n        // ...\n    }\n}