// assume 8 slaves for simplicity\nuint8_t current = 0x04;  // 00000100\nuint8_t request_mask = 0x60;  // 01100000\n\n// shift current to the left, wrapping around to the right if necessary\nuint8_t next = (current << 1) | (current >> 7);\n\n// mask out slaves that don't want to be scheduled\nnext = next & request_mask;\n\n// find the first set bit in the result\nnext = next & -next;\n\nprintf("%02x\n", next);  // 00100000