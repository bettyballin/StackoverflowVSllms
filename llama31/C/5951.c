HKEY key;\n\n// Open the HKEY_CURRENT_USER\Software\Classes key\nif (RegOpenKeyW(HKEY_CURRENT_USER, L"Software\\Classes", &key) == ERROR_SUCCESS)\n{\n    // Map HKEY_CLASSES_ROOT to HKEY_CURRENT_USER\Software\Classes\n    if (RegOverridePredefKey(HKEY_CLASSES_ROOT, key) == ERROR_SUCCESS)\n    {\n        // Call the original RegisterTypeLib function\n        HRESULT hr = RegisterTypeLib(\n            // Path to the type library file\n            L"C:\\Path\\To\\Your\\TypeLibrary.tlb",\n            // GUID of the type library\n            &guid,\n            // Major version number\n            1,\n            // Minor version number\n            0,\n            // Locale ID (LCID)\n            0x0409\n        );\n\n        // Restore the original mapping\n        RegOverridePredefKey(HKEY_CLASSES_ROOT, NULL);\n    }\n\n    // Close the HKEY_CURRENT_USER\Software\Classes key\n    RegCloseKey(key);\n}