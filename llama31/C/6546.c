#include <pcap.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <netinet/ip.h>\n#include <netinet/tcp.h>\n\n// ...\n\nvoid process_packet(u_char *args, const struct pcap_pkthdr *header, const u_char *packet) {\n    struct iphdr *ip;\n    struct tcphdr *tcp;\n    u_char *data;\n\n    // ...\n\n    ip = (struct iphdr *)(packet + 14); // assuming Ethernet\n    tcp = (struct tcphdr *)((u_char *)ip + ip->ihl * 4);\n    data = (u_char *)tcp + tcp->th_off * 4;\n\n    // Reassemble TCP segments here\n    // ...\n}\n\nint main() {\n    pcap_t *handle;\n    char errbuf[PCAP_ERRBUF_SIZE];\n\n    handle = pcap_open_live("eth0", 65535, 1, 0, errbuf);\n    if (handle == NULL) {\n        // ...\n    }\n\n    pcap_loop(handle, -1, process_packet, NULL);\n\n    pcap_close(handle);\n    return 0;\n}