for (row = 0; row < nbDocs; row++) {\n    xmlNodePtr currentNode = xpathNodes->nodesetval->nodeTab[row];\n\n    // Create a new context for the current node\n    xmlXPathContextPtr subCtx = xmlXPathNewContext(doc);\n    subCtx->node = currentNode;\n\n    // Evaluate the second XPath expression\n    for (col = 0; col < expr.nbItems; col++) {\n        xpathRows = xmlXPathEvalExpression((xmlChar *)expr.itemList[col].val, subCtx);\n\n        // If the XPath expression is relative, xmlXPathEvalExpression\n        // will return a nodeset containing the nodes relative to the\n        // current node. So we need to get the first node from the nodeset.\n        xmlNodePtr resultNode = xpathRows->nodesetval->nodeTab[0];\n\n        // Get the string value of the result node\n        xmlChar *resultStr = xmlNodeGetContent(resultNode);\n        result->data[(row + 1) * result->nbCols + col] = strdup((char *)resultStr);\n        xmlFree(resultStr);\n\n        xmlXPathFreeObject(xpathRows);\n    }\n\n    xmlXPathFreeContext(subCtx);\n}