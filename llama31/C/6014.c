#include <stdio.h>\n#include <stdlib.h>\n#include <sys/wait.h>\n#include <spawn.h>\n\nint main() {\n    char *cmd[] = {"ls", "-l", NULL};\n    int pipefd[2];\n    pid_t pid;\n\n    // Create a pipe\n    pipe(pipefd);\n\n    // Spawn the command, redirecting its output to the pipe\n    posix_spawn(&pid, "/bin/ls", NULL, NULL, cmd, NULL);\n    dup2(pipefd[1], STDOUT_FILENO);\n    close(pipefd[1]);\n\n    // Read from the pipe\n    char buffer[1024];\n    ssize_t bytes_read;\n    while ((bytes_read = read(pipefd[0], buffer, 1024)) > 0) {\n        printf("%s", buffer);\n    }\n\n    // Wait for the command to finish and get its exit status\n    int status;\n    waitpid(pid, &status, 0);\n\n    // Check the exit status\n    if (WIFEXITED(status)) {\n        printf("Command exited with status %d\n", WEXITSTATUS(status));\n    }\n\n    return 0;\n}