// Update hidden form field with checked mail IDs\nfunction updateCheckedIds() {\n  var checkedIds = [];\n  var checkboxes = document.getElementsByName('mail_checkbox');\n  for (var i = 0; i < checkboxes.length; i++) {\n    if (checkboxes[i].checked) {\n      checkedIds.push(checkboxes[i].value);\n    }\n  }\n  document.getElementById('hidden_checked_ids').value = checkedIds.join(',');\n}\n\n// Update checkbox state based on stored session variable\nfunction updateCheckboxState() {\n  var checkedIds = document.getElementById('hidden_checked_ids').value.split(',');\n  var checkboxes = document.getElementsByName('mail_checkbox');\n  for (var i = 0; i < checkboxes.length; i++) {\n    if (checkedIds.indexOf(checkboxes[i].value) != -1) {\n      checkboxes[i].checked = true;\n    }\n  }\n}