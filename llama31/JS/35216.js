var lastMessageId = 0;\n\nfunction fetchNewMessages() {\n  var xhr = new XMLHttpRequest();\n  xhr.open('GET', 'longpoll.php?lastId=' + lastMessageId, true);\n  xhr.onload = function() {\n    if (xhr.status === 200) {\n      var newMessages = JSON.parse(xhr.responseText);\n      lastMessageId = Math.max.apply(null, newMessages.map(function(message) {\n        return message.id;\n      }));\n      console.log(newMessages);\n      // Update your UI here\n      fetchNewMessages();\n    } else {\n      console.error('Error:', xhr.statusText);\n    }\n  };\n  xhr.send();\n}\n\nfetchNewMessages();