function replaceQuotesWithCurlyQuotes editableElement) {\n  editableElement.addEventListener('input', function(event) {\n    var selection = window.getSelection();\n    var range = selection.getRangeAt(0);\n    var text = range.startContainer.textContent;\n\n    // Check if the last character entered is a straight quote\n    if (text.slice(-1) === '"' || text.slice(-1) === "'") {\n      var replacement = '';\n      if (text.slice(-1) === '"') {\n        replacement = text.slice(-2) === '“' ? '”' : '“';\n      } else {\n        replacement = text.slice(-2) === '‘' ? '’' : '‘';\n      }\n\n      // Replace the straight quote with the curly quote\n      range.deleteContents();\n      var textNode = document.createTextNode(replacement);\n      range.insertNode(textNode);\n      selection.collapseToEnd();\n    }\n  });\n\n  editableElement.addEventListener('keydown', function(event) {\n    // Check if Ctrl+Z is pressed immediately after a replacement\n    if (event.ctrlKey && event.key === 'z') {\n      var selection = window.getSelection();\n      var range = selection.getRangeAt(0);\n      var text = range.startContainer.textContent;\n\n      // Check if the last character is a curly quote\n      if (text.slice(-1) === '“' || text.slice(-1) === '”' || text.slice(-1) === '‘' || text.slice(-1) === '’') {\n        // Replace the curly quote with a straight quote\n        range.deleteContents();\n        var textNode = document.createTextNode(text.slice(-1) === '“' || text.slice(-1) === '”' ? '"' : "'");\n        range.insertNode(textNode);\n        selection.collapseToEnd();\n      }\n    }\n  });\n}\n\n// Usage\nvar editableElement = document.getElementById('myeditablediv');\nreplaceQuotesWithCurlyQuotes(editableElement);