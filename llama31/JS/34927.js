function getSelectedText() {\n    // your existing implementation\n}\n\nfunction saveSelection() {\n    var selection = window.getSelection();\n    if (selection) {\n        var range = selection.getRangeAt(0);\n        var savedRange = {\n            startContainer: range.startContainer,\n            startOffset: range.startOffset,\n            endContainer: range.endContainer,\n            endOffset: range.endOffset\n        };\n        return savedRange;\n    }\n    return null;\n}\n\nfunction restoreSelection(savedRange) {\n    if (savedRange) {\n        var selection = window.getSelection();\n        selection.removeAllRanges();\n        var range = document.createRange();\n        range.setStart(savedRange.startContainer, savedRange.startOffset);\n        range.setEnd(savedRange.endContainer, savedRange.endOffset);\n        selection.addRange(range);\n    }\n}\n\nvar savedRange = saveSelection();\n$("#dialog").dialog("open");\nrestoreSelection(savedRange);