// Privileged Greasemonkey context\nfunction makeApiCall(callback) {\n  GM_xmlhttpRequest({\n    method: "GET",\n    url: "http://www.example.net/",\n    headers: {\n      "User-Agent": navigator.userAgent,\n      "Accept": "text/html"\n    },\n    onload: function(response) {\n      callback(response);\n    }\n  });\n}\n\n// Expose the makeApiCall function to the unprivileged context\nunsafeWindow.makeApiCall = makeApiCall;\n\n// Unprivileged page context\nfunction code() {\n  // Call the makeApiCall function and pass a callback\n  makeApiCall(function(response) {\n    console.log(response);\n    alert(response);\n  });\n}\n\nvar script = document.createElement("script");\nscript.type = "application/javascript";\nscript.innerHTML = "(" + code + ")();";\ndocument.body.appendChild(script);