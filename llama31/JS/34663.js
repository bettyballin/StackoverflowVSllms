function replaceSelectedText(textarea, newText) {\n  if (textarea.selectionStart !== undefined && textarea.selectionEnd !== undefined) {\n    var start = textarea.selectionStart;\n    var end = textarea.selectionEnd;\n    textarea.value = textarea.value.substring(0, start) + newText + textarea.value.substring(end);\n    textarea.selectionStart = start;\n    textarea.selectionEnd = start + newText.length;\n  }\n}