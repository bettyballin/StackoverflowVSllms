function getCharacterOffset(range) {\n  var text = range.text;\n  var offset = 0;\n  var rangeCopy = range.duplicate();\n  rangeCopy.collapse(true); // collapse to start\n  rangeCopy.moveEnd('character', 1);\n  while (rangeCopy.text !== '') {\n    offset++;\n    rangeCopy.moveEnd('character', 1);\n  }\n  return offset;\n}\n\n// example usage:\nvar range = document.selection.createRange();\nvar offset = getCharacterOffset(range);\nconsole.log(offset);