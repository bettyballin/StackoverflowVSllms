$('a', container).live('click', function() {\n    var container = $(this).parents('.bfcontainer');\n    var level = $('div', container).index($(this).parents('div'));\n    var subitems = $(this).data('sub');\n\n    // remove blocks to the right in the tree, and 'deactivate' other links within the same level\n    $('div:gt('+level+')', container).remove();\n    $('div:eq('+level+') a', container).removeClass('active').removeClass('inpath');\n    $('.active', container).addClass('inpath');\n    $(this).addClass('active');\n\n    if (subitems && subitems.children('li').length) {\n        // add submenu if container has children\n        submenu(container, this);\n        return false;\n    } else {\n        // allow default link behavior if no submenus\n        return true;\n    }\n});