function getHTTPObject() {\n    var xhr = false;\n    if (window.XMLHttpRequest) {\n        xhr = new XMLHttpRequest();\n    } else if (window.ActiveXObject) {\n        try {\n            xhr = new ActiveXObject("Msxml2.XMLHTTP");\n        } catch(e) {\n            try {\n                xhr = new ActiveXObject("Microsoft.XMLHTTP");\n            } catch(e) {\n                xhr = false;\n            }\n        }\n    }\n    return xhr;\n}\n\nfunction prepareLinks() {\n    var btn  = document.getElementById("search");\n    btn.onclick = function() {\n        var url = "Account.aspx/GetData"\n        return !grabFile(url);\n    }\n}\n\nfunction grabFile(file) {\n    var request = getHTTPObject();\n    if (request) {\n        request.onreadystatechange = function() {\n            parseResponse(request);\n        };\n        request.open('POST', file, true);\n        request.setRequestHeader('Content-Type', 'application/json');\n        request.send(null)\n        return true;\n    } else {\n        return false;\n    }\n}\n\nfunction parseResponse(request) {\n    if (request.readyState == 4) {\n        if (request.status == 200 || request.status == 304) {\n            var details = document.getElementById("result");\n            details.innerHTML = request.responseText;\n        }\n    }\n}\n\naddLoadEvent(prepareLinks);