// Create a new instance of the Windows Performance Recorder (WPR)\nvar recorder = new WPR();\n\n// Start profiling the application\nrecorder.Start();\n\n// Run the application or the part of the application you want to profile\nMyApplication.Run();\n\n// Stop profiling the application\nrecorder.Stop();\n\n// Save the profiling data to a file\nrecorder.Save("profile.etl");\n\n// Open the profiling data in the Windows Performance Analyzer (WPA)\nvar analyzer = new WPA();\nanalyzer.Open("profile.etl");\n\n// Analyze the profiling data\nanalyzer.Analyze();