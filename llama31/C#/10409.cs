public void ResetTextReader(TextReader reader)\n{\n    if (reader is StreamReader streamReader)\n    {\n        streamReader.BaseStream.Seek(0, SeekOrigin.Begin);\n    }\n    else if (reader is StringReader stringReader)\n    {\n        stringReader = new StringReader(stringReader.ReadToEnd());\n    }\n    else\n    {\n        throw new NotSupportedException("Unsupported TextReader type");\n    }\n}