using System.DirectoryServices;\n\n// Create a new DirectoryEntry object\nDirectoryEntry ou = new DirectoryEntry("LDAP://OU=Users,DC=example,DC=com");\n\n// Create a new user\nDirectoryEntry user = ou.Children.Add("CN=John Doe", "user");\n\n// Set user properties\nuser.Properties["sAMAccountName"].Value = "johndoe";\nuser.Properties["displayName"].Value = "John Doe";\nuser.Properties["mail"].Value = "john.doe@example.com";\nuser.Properties["homeDirectory"].Value = @"\example.com\Users\John Doe";\n\n// Save the new user\nuser.CommitChanges();