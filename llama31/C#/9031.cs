using System;\nusing System.Runtime.InteropServices;\n\npublic class FileTypeHelper\n{\n    [DllImport("shell32.dll", CharSet = CharSet.Unicode)]\n    static extern uint SHGetFileInfo(string pszPath, uint dwFileAttributes, ref SHFILEINFO psfi, uint cbFileInfo, uint uFlags);\n\n    [StructLayout(LayoutKind.Sequential)]\n    public struct SHFILEINFO\n    {\n        public IntPtr hIcon;\n        public int iIcon;\n        public uint dwAttributes;\n        [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 260)]\n        public string szDisplayName;\n        [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 80)]\n        public string szTypeName;\n    }\n\n    public static string GetFileTypeDescription(string extension)\n    {\n        SHFILEINFO info = new SHFILEINFO();\n        uint flags = 0x100 | 0x00000800; // SHGFI_ICON | SHGFI_USEFILEATTRIBUTES\n        uint res = SHGetFileInfo(extension, 0, ref info, (uint)Marshal.SizeOf(info), flags);\n        if (res == 0)\n            return null;\n        return info.szTypeName;\n    }\n}