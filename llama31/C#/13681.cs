using System.Diagnostics;\n\npublic class ServiceRegistrar\n{\n    public void RegisterService(string serviceName, string executablePath)\n    {\n        ProcessStartInfo startInfo = new ProcessStartInfo();\n        startInfo.FileName = "sc.exe";\n        startInfo.Arguments = $"create {serviceName} binPath= \"{executablePath}\" start= auto";\n        startInfo.UseShellExecute = false;\n        startInfo.RedirectStandardError = true;\n        startInfo.RedirectStandardOutput = true;\n\n        using (Process process = Process.Start(startInfo))\n        {\n            process.WaitForExit();\n        }\n    }\n}