public class MyViewModel : IDataErrorInfo, INotifyPropertyChanged\n{\n    private string _name;\n    private string _email;\n\n    public string Name\n    {\n        get { return _name; }\n        set\n        {\n            _name = value;\n            OnPropertyChanged("Name");\n        }\n    }\n\n    public string Email\n    {\n        get { return _email; }\n        set\n        {\n            _email = value;\n            OnPropertyChanged("Email");\n        }\n    }\n\n    public string Error\n    {\n        get { return string.IsNullOrEmpty(Name) || string.IsNullOrEmpty(Email) ? "Please fill in all fields" : null; }\n    }\n\n    public string this[string columnName]\n    {\n        get\n        {\n            switch (columnName)\n            {\n                case "Name":\n                    return string.IsNullOrEmpty(Name) ? "Name is required" : null;\n                case "Email":\n                    return string.IsNullOrEmpty(Email) || !Regex.IsMatch(Email, @"^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$") ? "Invalid email" : null;\n                default:\n                    return null;\n            }\n        }\n    }\n\n    public event PropertyChangedEventHandler PropertyChanged;\n\n    protected virtual void OnPropertyChanged(string propertyName)\n    {\n        PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propertyName));\n    }\n}