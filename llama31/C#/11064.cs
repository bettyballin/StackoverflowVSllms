using System.Management;\n\npublic class IISVersionDetector\n{\n    public static string GetIISVersion()\n    {\n        ManagementScope scope = new ManagementScope("root\\MicrosoftIISv2");\n        ObjectQuery query = new ObjectQuery("SELECT * FROM IISWebServerSetting");\n\n        using (ManagementObjectSearcher searcher = new ManagementObjectSearcher(scope, query))\n        {\n            foreach (ManagementObject item in searcher.Get())\n            {\n                return item["MajorVersion"].ToString();\n            }\n        }\n\n        throw new Exception("IIS version not found");\n    }\n}