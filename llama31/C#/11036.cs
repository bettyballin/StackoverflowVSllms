using Microsoft.SqlServer.TransactSql.ScriptDom;\n\n// Get the SQL code of the stored procedure\nstring sqlCode = GetSqlCode("your_stored_procedure_name");\n\n// Parse the SQL code\nTSqlParser parser = new TSql120Parser(false);\nTSqlFragment fragment = parser.Parse(sqlCode, out IList<ParseError> errors);\n\n// Extract the selected column names\nList<string> columnNames = new List<string>();\nforeach (TSqlStatement statement in fragment.Batches[0].Statements)\n{\n    if (statement is SelectStatement selectStatement)\n    {\n        foreach (SelectElement selectElement in selectStatement.QueryExpression.SelectElements)\n        {\n            if (selectElement is SelectScalarExpression scalarExpression)\n            {\n                columnNames.Add(scalarExpression.ColumnName.Value);\n            }\n        }\n    }\n}