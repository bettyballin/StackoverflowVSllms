using System;\nusing System.Windows.Forms;\nusing System.Diagnostics;\nusing System.Threading;\n\nnamespace TestMessageBox\n{\n    class Program\n    {\n        private WindowWrapper notepad;\n\n        Program(IntPtr handle)\n        {\n            notepad = new WindowWrapper(handle);\n        }\n\n        static void Main(string[] args)\n        {\n            Process[] procs = Process.GetProcessesByName("notepad");\n            if (procs.Length > 0)\n            {\n                Console.WriteLine("Notepad detected...");\n                Program program = new Program(procs[0].MainWindowHandle);\n                Thread thread = new Thread(new ThreadStart(program.ShowMessage));\n                thread.IsBackground = true;\n                thread.Start();\n                Console.Write("Press any key to end the program...");\n                Console.ReadKey();\n            }\n        }\n\n        void ShowMessage()\n        {\n            // Use a non-modal dialog\n            Form form = new Form();\n            form.Text = "Message";\n            form.Controls.Add(new Label { Text = "If this is open when the program ends\nit will not lock up notepad..." });\n            form.Show(notepad);\n        }\n    }\n\n    // ... (rest of the code remains the same)\n}