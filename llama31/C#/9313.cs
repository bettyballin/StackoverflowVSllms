var tasks = new Task[S.Length];\nfor (int i = 0; i < S.Length; i++)\n{\n    tasks[i] = Task.Run(() =>\n    {\n        try\n        {\n            using (Process p = Process.Start(S[i]))\n            {\n                p.WaitForExit();\n            }\n        }\n        catch (Exception e)\n        {\n            // notify of process failure\n        }\n    });\n}\n\nTask.WaitAll(tasks);