public class IdentityMap<T> where T : Entity\n{\n    private readonly Dictionary<Guid, T> _cache = new Dictionary<Guid, T>();\n\n    public T Get(Guid id)\n    {\n        if (_cache.TryGetValue(id, out T entity))\n        {\n            return entity;\n        }\n\n        entity = RetrieveFromDatabase(id);\n        _cache.Add(id, entity);\n        return entity;\n    }\n\n    private T RetrieveFromDatabase(Guid id)\n    {\n        // Implement database retrieval logic here\n    }\n}