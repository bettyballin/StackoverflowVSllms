using System.Drawing;\nusing System.Drawing.Imaging;\n\npublic static class BitmapHelper\n{\n    public static (int, int, int) GetAverageRgb(Bitmap bitmap)\n    {\n        int red = 0;\n        int green = 0;\n        int blue = 0;\n\n        // Lock the bitmap bits\n        Rectangle rect = new Rectangle(0, 0, bitmap.Width, bitmap.Height);\n        BitmapData data = bitmap.LockBits(rect, ImageLockMode.ReadOnly, PixelFormat.Format24bppRgb);\n\n        try\n        {\n            // Iterate over each pixel\n            for (int y = 0; y < data.Height; y++)\n            {\n                IntPtr ptr = data.Scan0 + (y * data.Stride);\n                byte[] bytes = new byte[data.Stride];\n                System.Runtime.InteropServices.Marshal.Copy(ptr, bytes, 0, data.Stride);\n\n                for (int x = 0; x < data.Width; x++)\n                {\n                    red += bytes[x * 3];\n                    green += bytes[x * 3 + 1];\n                    blue += bytes[x * 3 + 2];\n                }\n            }\n        }\n        finally\n        {\n            bitmap.UnlockBits(data);\n        }\n\n        // Calculate the average\n        int totalPixels = bitmap.Width * bitmap.Height;\n        return (red / totalPixels, green / totalPixels, blue / totalPixels);\n    }\n}