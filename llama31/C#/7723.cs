using Microsoft.Web.HttpPlatformHandler;\n\npublic class CustomProxyHandler : HttpPlatformHandler\n{\n    public override void OnRequestStart(HttpContext context)\n    {\n        var username = context.GetOwinContext().Authentication.User.Identity.Name;\n        var roles = context.GetOwinContext().Authentication.User.Claims.Where(c => c.Type == ClaimTypes.Role).Select(c => c.Value);\n\n        context.Request.Headers.Add("X-Username", username);\n        context.Request.Headers.Add("X-Roles", string.Join(",", roles));\n    }\n}