using System;\nusing System.Diagnostics;\n\npublic class FileLocker\n{\n    public static int GetLockingProcessId(string filePath)\n    {\n        int pid = -1;\n\n        string output = RunCommand($"openfiles /query /v /fo csv", true);\n\n        string[] lines = output.Split(new[] { Environment.NewLine }, StringSplitOptions.None);\n\n        foreach (string line in lines)\n        {\n            if (line.Contains(filePath))\n            {\n                string[] values = line.Split(',');\n                pid = int.Parse(values[1].Trim('"'));\n                break;\n            }\n        }\n\n        return pid;\n    }\n\n    private static string RunCommand(string command, bool waitForExit)\n    {\n        using (Process process = new Process())\n        {\n            process.StartInfo.FileName = "cmd.exe";\n            process.StartInfo.Arguments = "/c " + command;\n            process.StartInfo.UseShellExecute = false;\n            process.StartInfo.RedirectStandardOutput = true;\n            process.Start();\n\n            if (waitForExit)\n            {\n                process.WaitForExit();\n            }\n\n            return process.StandardOutput.ReadToEnd();\n        }\n    }\n}