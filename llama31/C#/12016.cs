using System.Runtime.InteropServices;\n\n// Define the RAPI interface\n[InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]\n[Guid("00000000-0000-0000-0000-000000000000")]\npublic interface IRAPISms\n{\n    [MethodImpl(MethodImplOptions.InternalCall, MethodCodeType = MethodCodeType.Runtime)]\n    void GetSmsMessages([Out] out IntPtr messages);\n}\n\n// Create a new instance of the RAPI class\nRAPI rapi = new RAPI();\n\n// Connect to the device\nrapi.Connect();\n\n// Get the SMS messages\nIntPtr messagesPtr;\nrapi.GetSmsMessages(out messagesPtr);\n\n// Marshal the messages to a managed array\nSmsMessage[] messages = (SmsMessage[])Marshal.PtrToStructure(messagesPtr, typeof(SmsMessage[]));\n\n// Process the messages\nforeach (SmsMessage message in messages)\n{\n    Console.WriteLine(message.Body);\n}\n\n// Disconnect from the device\nrapi.Disconnect();