using System.Diagnostics;\n\npublic class PresenceDetector\n{\n    public static bool IsUserPresent(int thresholdMinutes)\n    {\n        Process[] processes = Process.GetProcesses();\n        foreach (Process process in processes)\n        {\n            if (process.Threads.Count > 0 && process.WorkingSet64 > 0)\n            {\n                return true;\n            }\n        }\n\n        return false;\n    }\n}