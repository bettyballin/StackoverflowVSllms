using System;\nusing System.Xml;\nusing System.Xml.Linq;\n\npublic static class XElementExtensions\n{\n    public static string GetXPath(this XElement element)\n    {\n        if (element == null)\n        {\n            throw new ArgumentNullException(nameof(element));\n        }\n\n        var parent = element.Parent;\n        var path = new StringBuilder();\n\n        while (parent != null)\n        {\n            var index = GetIndex(parent, element);\n            path.Insert(0, $"/{parent.Name.LocalName}[{index}]");\n            element = parent;\n            parent = parent.Parent;\n        }\n\n        return path.ToString();\n    }\n\n    private static int GetIndex(XElement parent, XElement element)\n    {\n        var elements = parent.Elements(element.Name).ToList();\n        for (var i = 0; i < elements.Count; i++)\n        {\n            if (elements[i] == element)\n            {\n                return i + 1;\n            }\n        }\n\n        throw new InvalidOperationException("Element not found in parent");\n    }\n}