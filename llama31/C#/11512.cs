using System;\nusing System.IO.Ports;\n\npublic class SerialPortController\n{\n    private SerialPort _serialPort;\n    private Queue<byte[]> _txQueue = new Queue<byte[]>();\n    private Queue<byte[]> _rxQueue = new Queue<byte[]>();\n\n    public SerialPortController(string portName, int baudRate)\n    {\n        _serialPort = new SerialPort(portName, baudRate, Parity.None, 8, StopBits.One);\n        _serialPort.DataReceived += SerialPort_DataReceived;\n    }\n\n    private void SerialPort_DataReceived(object sender, SerialDataReceivedEventArgs e)\n    {\n        byte[] data = new byte[_serialPort.BytesToRead];\n        _serialPort.Read(data, 0, data.Length);\n        _rxQueue.Enqueue(data);\n    }\n\n    public void SendData(byte[] data)\n    {\n        _txQueue.Enqueue(data);\n    }\n\n    private void ProcessTxQueue()\n    {\n        while (_txQueue.Count > 0)\n        {\n            byte[] data = _txQueue.Dequeue();\n            _serialPort.Write(data, 0, data.Length);\n        }\n    }\n}