[DllImport("advapi32.dll", SetLastError = true, CharSet = CharSet.Unicode)]\nstatic extern bool CreateProcessAsUser(IntPtr hToken, string lpApplicationName, string lpCommandLine, IntPtr lpProcessAttributes, IntPtr lpThreadAttributes, bool bInheritHandles, uint dwCreationFlags, IntPtr lpEnvironment, string lpCurrentDirectory, ref STARTUPINFO lpStartupInfo, out PROCESS_INFORMATION lpProcessInformation);\n\n// ...\n\nIntPtr token;\nLogonUser("username", "domain", "password", 3, 0, out token);\n\nSTARTUPINFO startupInfo = new STARTUPINFO();\nPROCESS_INFORMATION processInfo;\n\nCreateProcessAsUser(token, "path/to/com/dll", null, IntPtr.Zero, IntPtr.Zero, false, 0, IntPtr.Zero, null, ref startupInfo, out processInfo);