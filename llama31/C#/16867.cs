using System.Management;\n\nstring serverName = "your-server-name";\nstring siteId = "your-iis-site-id";\n\nManagementScope scope = new ManagementScope("\\\\" + serverName + "\\root\\cimv2");\nObjectQuery query = new ObjectQuery("SELECT * FROM Win32_PerfRawData_ASPNET_ASPNETAppsV2050727 WHERE Name = '_LM_W3SVC_" + siteId + "_ROOT'");\n\nManagementObjectSearcher searcher = new ManagementObjectSearcher(scope, query);\nManagementObjectCollection results = searcher.Get();\n\nforeach (ManagementObject result in results)\n{\n    long initialValue = Convert.ToInt64(result["RequestsTotal"]);\n    // Wait for 1 second\n    System.Threading.Thread.Sleep(1000);\n    // Get the new value\n    result = searcher.Get()[0];\n    long newValue = Convert.ToInt64(result["RequestsTotal"]);\n\n    if (newValue > initialValue)\n    {\n        Console.WriteLine("The IIS site is receiving requests.");\n    }\n    else\n    {\n        Console.WriteLine("The IIS site is not receiving requests.");\n    }\n}