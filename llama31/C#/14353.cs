// Service side\nusing System.IO.Pipes;\nusing System.Text;\n\nclass Service\n{\n    private NamedPipeServerStream pipeServer;\n\n    public Service()\n    {\n        pipeServer = new NamedPipeServerStream("MyPipe", PipeDirection.InOut);\n    }\n\n    public void Start()\n    {\n        pipeServer.WaitForConnection();\n    }\n\n    public string ReadMessage()\n    {\n        byte[] buffer = new byte[256];\n        int bytesRead = pipeServer.Read(buffer, 0, buffer.Length);\n        return Encoding.UTF8.GetString(buffer, 0, bytesRead);\n    }\n}\n\n// Client side (desktop application)\nusing System.IO.Pipes;\nusing System.Text;\n\nclass Client\n{\n    private NamedPipeClientStream pipeClient;\n\n    public Client()\n    {\n        pipeClient = new NamedPipeClientStream(".", "MyPipe", PipeDirection.InOut);\n    }\n\n    public void SendMessage(string message)\n    {\n        byte[] buffer = Encoding.UTF8.GetBytes(message);\n        pipeClient.Write(buffer, 0, buffer.Length);\n    }\n}