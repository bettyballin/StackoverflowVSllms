internal class FilterUtils\n{\n    /// <summary>\n    /// Registers the MIME filter for the current process\n    /// </summary>\n    public static void RegisterFilter()\n    {\n        IInternetSession session = null;\n        int status = NativeMethods.CoInternetGetSession(0, ref session, 0);\n        if (status != 0)\n        {\n            // Handle error\n            return;\n        }\n\n        MimeFilter mf = new MimeFilter();\n        Guid id = new Guid("C3ED53DA-EC0E-4625-AB0C-9837D0D0D59D");\n        session.RegisterMimeFilter(mf, ref id, "text/html; charset=UTF-8");\n    }\n}