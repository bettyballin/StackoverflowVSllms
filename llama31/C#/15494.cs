using System.DirectoryServices.Protocols;\n\n// Create a new LdapConnection\nvar connection = new LdapConnection("LDAP://dc=example,dc=com");\n\n// Build a search filter\nvar filter = "(objectClass=user)(department=Sales)";\n\n// Execute the search\nvar response = connection.Search(null, filter, SearchScope.Subtree);\n\n// Iterate over the results\nforeach (var entry in response.Entries)\n{\n    Console.WriteLine(entry.Attributes["displayName"].GetValue());\n}