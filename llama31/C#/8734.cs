using Microsoft.SqlServer.TransactSql.ScriptDom;\n\n// Assume you have a SQL script as a string\nstring sqlScript = "FOR condition1 LOOP stmt1; FOR condition2 LOOP stmt2; END LOOP; END LOOP;";\n\n// Create a parser\nTSql150Parser parser = new TSql150Parser(false);\n\n// Parse the script\nTSqlFragment fragment = parser.Parse(sqlScript, out IList<ParseError> errors);\n\n// Get the top-level statements (in this case, the outer loop)\nforeach (TSqlStatement statement in fragment.Statements)\n{\n    if (statement is ForStatement outerLoop)\n    {\n        Console.WriteLine("Outer Loop:");\n        Console.WriteLine(outerLoop.Condition.ToString());\n        Console.WriteLine(outerLoop.StatementList.Statements[0].ToString());\n\n        // Recursively parse the inner loop\n        foreach (TSqlStatement innerStatement in outerLoop.StatementList.Statements)\n        {\n            if (innerStatement is ForStatement innerLoop)\n            {\n                Console.WriteLine("Inner Loop:");\n                Console.WriteLine(innerLoop.Condition.ToString());\n                Console.WriteLine(innerLoop.StatementList.Statements[0].ToString());\n            }\n        }\n    }\n}