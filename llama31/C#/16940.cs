using System;\nusing System.Net;\nusing System.Net.Sockets;\nusing System.Security.Authentication;\nusing System.Security.Cryptography.X509Certificates;\nusing System.Text;\n\npublic class SslPeer\n{\n    private readonly TcpClient _tcpClient;\n    private readonly X509Certificate2 _localCertificate;\n    private readonly X509Certificate2 _remoteCertificate;\n\n    public SslPeer(TcpClient tcpClient, X509Certificate2 localCertificate, X509Certificate2 remoteCertificate)\n    {\n        _tcpClient = tcpClient;\n        _localCertificate = localCertificate;\n        _remoteCertificate = remoteCertificate;\n    }\n\n    public void Authenticate()\n    {\n        using (var sslStream = new SslStream(_tcpClient.GetStream(), false, ValidateRemoteCertificate))\n        {\n            sslStream.AuthenticateAsClient(_remoteCertificate.SubjectName.Name);\n        }\n    }\n\n    private bool ValidateRemoteCertificate(object sender, X509Certificate certificate, X509Chain chain, SslPolicyErrors sslPolicyErrors)\n    {\n        // Verify the remote certificate against the known copy\n        return certificate.Equals(_remoteCertificate);\n    }\n}