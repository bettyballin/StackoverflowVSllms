using System;\nusing System.Collections.Generic;\nusing System.Net.Mail;\nusing ImapLibrary;\n\npublic class ImapSync\n{\n    private ImapClient _client;\n    private readonly string _imapServer;\n    private readonly string _username;\n    private readonly string _password;\n\n    public ImapSync(string imapServer, string username, string password)\n    {\n        _imapServer = imapServer;\n        _username = username;\n        _password = password;\n    }\n\n    public void InitialSync()\n    {\n        _client = new ImapClient(_imapServer, _username, _password);\n        _client.Connect();\n\n        var folders = _client.GetFolders();\n        foreach (var folder in folders)\n        {\n            var messages = _client.GetMessageHeaders(folder);\n            foreach (var message in messages)\n            {\n                // Store message headers in database\n            }\n        }\n    }\n\n    public void IncrementalSync()\n    {\n        _client = new ImapClient(_imapServer, _username, _password);\n        _client.Connect();\n\n        var newMessages = _client.SearchMessages("UNSEEN SINCE " + DateTime.Now.AddDays(-1).ToString("yyyy-MM-dd"));\n        foreach (var message in newMessages)\n        {\n            // Store new message headers in database\n        }\n\n        var updatedMessages = _client.FetchMessages("FLAGS");\n        foreach (var message in updatedMessages)\n        {\n            // Update message flags in database\n        }\n    }\n}