using System;\nusing System.ServiceProcess;\n\nnamespace Form_Service\n{\n    static class Program\n    {\n        [STAThread]\n        static int Main(string[] args)\n        {\n            bool argInstall = false;\n            bool argUninstall = false;\n            bool argGui = false;\n\n            foreach (string arg in args)\n            {\n                switch (arg)\n                {\n                    case "/i":\n                    case "/install":\n                        argInstall = true; break;\n                    case "/u":\n                    case "/uninstall":\n                        argUninstall = true; break;\n                    case "/g":\n                    case "/gui":\n                        argGui = true; break;\n                }\n            }\n\n            if (argUninstall)\n            {\n                Uninstall();\n            }\n            else if (argInstall)\n            {\n                Install();\n            }\n            else\n            {\n                if (argGui || Environment.UserInteractive)\n                {\n                    Application.EnableVisualStyles();\n                    Application.SetCompatibleTextRenderingDefault(false);\n                    Application.Run(new Form1());\n                }\n                else\n                {\n                    ServiceBase[] services = { new Service1() };\n                    ServiceBase.Run(services);\n                }\n            }\n\n            return 0;\n        }\n\n        static void Install()\n        {\n            using (var inst = new AssemblyInstaller(typeof(Program).Assembly, null))\n            {\n                inst.UseNewContext = true;\n                inst.Install(null);\n                inst.Commit(null);\n            }\n        }\n\n        static void Uninstall()\n        {\n            using (var inst = new AssemblyInstaller(typeof(Program).Assembly, null))\n            {\n                inst.UseNewContext = true;\n                inst.Uninstall(null);\n            }\n        }\n    }\n\n    [RunInstaller(true)]\n    public sealed class MyServiceInstallerProcess : ServiceProcessInstaller\n    {\n        public MyServiceInstallerProcess()\n        {\n            this.Account = ServiceAccount.NetworkService;\n        }\n    }\n\n    [RunInstaller(true)]\n    public sealed class MyServiceInstaller : ServiceInstaller\n    {\n        public MyServiceInstaller()\n        {\n            this.Description = "My Service";\n            this.DisplayName = "My Service";\n            this.ServiceName = "My Service";\n            this.StartType = System.ServiceProcess.ServiceStartMode.Manual;\n        }\n    }\n}