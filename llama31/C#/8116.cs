using System;\nusing System.Runtime.InteropServices;\n\nclass Program\n{\n    [DllImport("oleaut32.dll")]\n    static extern IntPtr SafeArrayCreateVector(uint vt, int lLbound, uint cElements);\n\n    [DllImport("oleaut32.dll")]\n    static extern IntPtr SafeArrayCreate(uint vt, int cDims, IntPtr rgsabound);\n\n    [DllImport("oleaut32.dll")]\n    static extern int SafeArrayPutElement(IntPtr psa, int* rgIndices, IntPtr pv);\n\n    [DllImport("oleaut32.dll")]\n    static extern int SafeArrayDestroy(IntPtr psa);\n\n    static void Main(string[] args)\n    {\n        string html = "<html><body>Hello, world!</body></html>";\n\n        // Create a BSTR\n        IntPtr bstr = Marshal.StringToBSTR(html);\n\n        // Create a SAFEARRAY\n        IntPtr psa = SafeArrayCreateVector(0x0008 /* VT_BSTR */, 0, 1);\n\n        // Put the BSTR into the SAFEARRAY\n        int index = 0;\n        SafeArrayPutElement(psa, &index, bstr);\n\n        // Create an object array to hold the SAFEARRAY\n        object[] paramsArray = new object[1];\n        paramsArray[0] = Marshal.GetObjectForIUnknown(psa);\n\n        // Call the write method\n        mshtml.HTMLDocumentClass doc = new mshtml.HTMLDocumentClass();\n        doc.write(paramsArray);\n\n        // Clean up\n        SafeArrayDestroy(psa);\n        Marshal.FreeBSTR(bstr);\n    }\n}