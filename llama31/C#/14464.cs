using System;\nusing System.IO;\nusing System.Xml;\nusing System.Xml.Xsl;\n\npublic class XhtmlMessageInspector : IDispatchMessageInspector\n{\n    public object AfterReceiveRequest(ref Message request, IClientChannel channel, InstanceContext instanceContext)\n    {\n        return null;\n    }\n\n    public void BeforeSendReply(ref Message reply, object correlationState)\n    {\n        var xslTransform = new XslCompiledTransform();\n        xslTransform.Load("xhtmlTransform.xslt");\n\n        var xmlReader = XmlReader.Create(new StringReader(reply.ToString()));\n        var xhtmlWriter = XmlWriter.Create(new StringWriter());\n\n        xslTransform.Transform(xmlReader, xhtmlWriter);\n\n        reply = Message.CreateMessage(MessageVersion.None, "XHTML", xhtmlWriter.ToString());\n    }\n}