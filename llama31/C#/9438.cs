using System;\nusing System.IO;\nusing System.Runtime.InteropServices;\nusing System.Windows.Forms;\n\nclass ClipboardHelper\n{\n    [DllImport("user32.dll")]\n    static extern IntPtr SetClipboardData(uint uFormat, IntPtr data);\n\n    [DllImport("user32.dll")]\n    static extern bool OpenClipboard(IntPtr hWndNewOwner);\n\n    [DllImport("user32.dll")]\n    static extern bool CloseClipboard();\n\n    public static void ReloadEmbedSource(byte[] data)\n    {\n        // Open the clipboard\n        if (!OpenClipboard(IntPtr.Zero))\n            throw new Exception("Failed to open clipboard");\n\n        // Create a memory stream from the byte array\n        using (var ms = new MemoryStream(data))\n        {\n            // Create an enhanced metafile from the stream\n            var emf = new EnhancedMetafile(ms);\n\n            // Set the clipboard data to the enhanced metafile\n            SetClipboardData(CF_ENHMETAFILE, emf.Handle);\n        }\n\n        // Close the clipboard\n        CloseClipboard();\n    }\n\n    private const uint CF_ENHMETAFILE = 14;\n}\n\nclass EnhancedMetafile : IDisposable\n{\n    private IntPtr _handle;\n\n    public EnhancedMetafile(Stream stream)\n    {\n        _handle = CreateEnhMetaFile(IntPtr.Zero, stream);\n    }\n\n    public IntPtr Handle\n    {\n        get { return _handle; }\n    }\n\n    [DllImport("gdi32.dll")]\n    private static extern IntPtr CreateEnhMetaFile(IntPtr hdc, Stream stream);\n\n    [DllImport("gdi32.dll")]\n    private static extern bool DeleteEnhMetaFile(IntPtr hemf);\n\n    public void Dispose()\n    {\n        if (_handle != IntPtr.Zero)\n            DeleteEnhMetaFile(_handle);\n    }\n}