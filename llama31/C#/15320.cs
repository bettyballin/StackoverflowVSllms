using System.Linq;\n\npublic static class TimeSeriesCorrelator\n{\n    public static DataTable CorrelateTimeSeries(List<TimeSeries> timeSeriesList)\n    {\n        // Find the earliest and latest timestamps across all time-series\n        var minTime = timeSeriesList.Min(ts => ts.Values.Min(tv => tv.Time));\n        var maxTime = timeSeriesList.Max(ts => ts.Values.Max(tv => tv.Time));\n\n        // Create a list of all unique timestamps\n        var allTimestamps = Enumerable.Range(0, (int)(maxTime - minTime).TotalSeconds + 1)\n            .Select(i => minTime.AddSeconds(i))\n            .ToList();\n\n        // Create a DataTable with the desired structure\n        var dataTable = new DataTable();\n        dataTable.Columns.Add("TIME", typeof(DateTime));\n        foreach (var timeSeries in timeSeriesList)\n        {\n            dataTable.Columns.Add(timeSeries.Name, typeof(double));\n        }\n\n        // Correlate each time-series and add rows to the DataTable\n        foreach (var timestamp in allTimestamps)\n        {\n            var row = dataTable.NewRow();\n            row["TIME"] = timestamp;\n            foreach (var timeSeries in timeSeriesList)\n            {\n                var value = timeSeries.Values.FirstOrDefault(tv => tv.Time == timestamp)?.Value;\n                row[timeSeries.Name] = value ?? double.NaN; // or some other default value\n            }\n            dataTable.Rows.Add(row);\n        }\n\n        return dataTable;\n    }\n}