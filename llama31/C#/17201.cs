public class WcfClientWrapper<T> : IDisposable where T : IClientChannel\n{\n    private readonly T _client;\n\n    public WcfClientWrapper(T client)\n    {\n        _client = client;\n    }\n\n    public T Client\n    {\n        get { return _client; }\n    }\n\n    public void Dispose()\n    {\n        if (_client.State == CommunicationState.Faulted)\n        {\n            _client.Abort();\n        }\n        else\n        {\n            _client.Close();\n        }\n    }\n}