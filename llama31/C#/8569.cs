public class ContentNegotiationAttribute : ActionFilterAttribute\n{\n    public override void OnActionExecuted(ActionExecutedContext filterContext)\n    {\n        var acceptHeader = filterContext.HttpContext.Request.Headers["Accept"];\n        var contentType = string.Empty;\n\n        switch (acceptHeader)\n        {\n            case "text/html":\n                contentType = "text/html";\n                break;\n            case "text/xml":\n                contentType = "text/xml";\n                break;\n            case "application/json":\n                contentType = "application/json";\n                break;\n            default:\n                contentType = "text/html"; // default to HTML\n                break;\n        }\n\n        filterContext.HttpContext.Response.ContentType = contentType;\n    }\n}