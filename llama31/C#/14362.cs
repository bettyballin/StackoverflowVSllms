using System.Security.Cryptography;\n\n// Validate the token\nbyte[] tokenBytes = Convert.FromBase64String(token);\nusing (var hmac = new HMACSHA256(sharedSecret))\n{\n    byte[] expectedHash = hmac.ComputeHash(tokenBytes);\n    if (!expectedHash.SequenceEqual(tokenBytes))\n    {\n        // Token is invalid\n    }\n}\n\n// Issue a new ticket\nFormsAuthenticationTicket newTicket = new FormsAuthenticationTicket(\n    username,\n    DateTime.Now,\n    DateTime.Now.AddMinutes(20),\n    true,\n    string.Empty,\n    FormsAuthentication.FormsCookiePath);