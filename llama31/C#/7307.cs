using System;\nusing System.Runtime.InteropServices;\n\nclass WaitForRemoteProcessExit\n{\n    [DllImport("kernel32.dll")]\n    static extern IntPtr OpenProcess(int dwDesiredAccess, bool bInheritHandle, int dwProcessId);\n\n    [DllImport("kernel32.dll")]\n    static extern int WaitForSingleObject(IntPtr hHandle, int dwMilliseconds);\n\n    [DllImport("kernel32.dll")]\n    static extern bool CloseHandle(IntPtr hObject);\n\n    const int PROCESS_QUERY_INFORMATION = 0x0400;\n    const int PROCESS_WAIT = 0x0001;\n\n    public static void WaitForRemoteProcessExit(int processId)\n    {\n        IntPtr processHandle = OpenProcess(PROCESS_QUERY_INFORMATION | PROCESS_WAIT, false, processId);\n        if (processHandle != IntPtr.Zero)\n        {\n            try\n            {\n                WaitForSingleObject(processHandle, -1);\n            }\n            finally\n            {\n                CloseHandle(processHandle);\n            }\n        }\n    }\n}