public Table BuildTable()\n{\n    Table tButtons = new Table();\n    TableRow tRow = null;\n    TableCell tCell = null;\n    long lColumn = 0;\n    long lPreviousColumn = 0;\n    long lRow = 0;\n    long lPreviousRow = 0;\n    long lLanguage = 0;\n    long lPreviousLanguage = 0;\n    OpenConnection();\n    ButtonData();\n    Int32 lRowOrd = aReader.GetOrdinal("RowNumber");\n    Int32 lColOrd = aReader.GetOrdinal("ColumnNumber");\n    Int32 lLangOrd = aReader.GetOrdinal("Language");\n    Int32 lLabelOrd = aReader.GetOrdinal("Label");\n\n    while (aReader.Read())\n    {\n        lRow = IsDbNull(aReader, lRowOrd);\n        lColumn = IsDbNull(aReader, lColOrd);\n        lLanguage = IsDbNull(aReader, lLangOrd);\n\n        if (lPreviousRow != lRow)\n        {\n            if (tRow != null)\n            {\n                tButtons.Rows.Add(tRow);\n            }\n            tRow = new TableRow();\n            tRow.Visible = true;\n        }\n\n        if (lPreviousColumn != lColumn)\n        {\n            if (tCell != null)\n            {\n                tRow.Cells.Add(tCell);\n            }\n            tCell = new TableCell();\n            tCell.Visible = true;\n        }\n\n        if (lPreviousLanguage != lLanguage)\n        {\n            lPreviousLanguage = lLanguage;\n            tCell.Text = IsDbNull(aReader, lLabelOrd, "");\n        }\n\n        lPreviousRow = lRow;\n        lPreviousColumn = lColumn;\n    }\n\n    if (tCell != null)\n    {\n        tRow.Cells.Add(tCell);\n    }\n\n    if (tRow != null)\n    {\n        tButtons.Rows.Add(tRow);\n    }\n\n    CloseConnection();\n    tButtons.Visible = true;\n    return tButtons;\n}