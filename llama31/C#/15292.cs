using System;\nusing System.IO;\nusing System.Security.Cryptography;\nusing System.Text;\n\npublic class SQLiteEncryptor\n{\n    private static byte[] Encrypt(byte[] data, string password)\n    {\n        using (Aes aes = Aes.Create())\n        {\n            aes.Key = GetKey(password);\n            aes.IV = GetIV(password);\n\n            using (MemoryStream ms = new MemoryStream())\n            {\n                using (CryptoStream cs = new CryptoStream(ms, aes.CreateEncryptor(), CryptoStreamMode.Write))\n                {\n                    cs.Write(data, 0, data.Length);\n                }\n                return ms.ToArray();\n            }\n        }\n    }\n\n    private static byte[] Decrypt(byte[] data, string password)\n    {\n        using (Aes aes = Aes.Create())\n        {\n            aes.Key = GetKey(password);\n            aes.IV = GetIV(password);\n\n            using (MemoryStream ms = new MemoryStream())\n            {\n                using (CryptoStream cs = new CryptoStream(ms, aes.CreateDecryptor(), CryptoStreamMode.Write))\n                {\n                    cs.Write(data, 0, data.Length);\n                }\n                return ms.ToArray();\n            }\n        }\n    }\n\n    private static byte[] GetKey(string password)\n    {\n        using (SHA256 sha256 = SHA256.Create())\n        {\n            return sha256.ComputeHash(Encoding.UTF8.GetBytes(password));\n        }\n    }\n\n    private static byte[] GetIV(string password)\n    {\n        using (MD5 md5 = MD5.Create())\n        {\n            return md5.ComputeHash(Encoding.UTF8.GetBytes(password));\n        }\n    }\n}