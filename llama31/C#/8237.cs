// Login.aspx.cs\nprotected void Login_Click(object sender, EventArgs e)\n{\n    // Validate user credentials\n    if (Membership.ValidateUser(username.Text, password.Text))\n    {\n        FormsAuthentication.SetAuthCookie(username.Text, true);\n        Response.Redirect("~/ProtectedContent.aspx");\n    }\n}\n\n// Global.asax.cs\nvoid Application_AuthenticateRequest(object sender, EventArgs e)\n{\n    if (FormsAuthentication.CookiesSupported)\n    {\n        HttpCookie authCookie = Request.Cookies[FormsAuthentication.FormsCookieName];\n        if (authCookie != null)\n        {\n            FormsAuthenticationTicket ticket = FormsAuthentication.Decrypt(authCookie.Value);\n            if (ticket != null && ticket.Expiration > DateTime.Now)\n            {\n                // User is authenticated, set the User property\n                HttpContext.Current.User = new GenericPrincipal(new GenericIdentity(ticket.Name), null);\n            }\n        }\n    }\n}