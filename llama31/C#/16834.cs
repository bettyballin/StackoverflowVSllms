using System.Security.AccessControl;\nusing System.Security.Principal;\n\n// ...\n\nstring eventSourceName = "MyAppLog";\nstring logName = "Application";\n\n// Create a new event source\nif (!EventLog.SourceExists(eventSourceName))\n{\n    EventLog.CreateEventSource(eventSourceName, logName);\n\n    // Set the permissions for the NETWORK SERVICE account\n    string networkServiceAccount = "NT AUTHORITY\\NETWORK SERVICE";\n    EventLogPermission permission = new EventLogPermission(EventLogPermissionAccess.Write, eventSourceName);\n    permission.AddPermissionAccess(new PermissionAccess(networkServiceAccount, EventLogPermissionAccess.Write));\n    permission.PermitOnly();\n}