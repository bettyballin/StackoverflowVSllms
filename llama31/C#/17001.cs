using System;\nusing System.Runtime.InteropServices;\nusing System.Runtime.InteropServices.ComTypes;\n\nclass COMImporter\n{\n    [DllImport("oleauto32.dll", SetLastError = true)]\n    static extern IntPtr LoadTypeLib([MarshalAs(UnmanagedType.LPWStr)] string typeLibName, out uint typeLib);\n\n    [DllImport("oleauto32.dll", SetLastError = true)]\n    static extern IntPtr LoadTypeLibEx([MarshalAs(UnmanagedType.LPWStr)] string typeLibName, REGKIND regKind, out uint typeLib);\n\n    public static Type GetTypeFromFile(string file, string typeName)\n    {\n        uint typeLib;\n        IntPtr typeLibPtr = LoadTypeLibEx(file, REGKIND.REG_NONE, out typeLib);\n\n        if (typeLibPtr == IntPtr.Zero)\n        {\n            throw new Exception("Failed to load type library");\n        }\n\n        Type type = Type.GetTypeFromCLSID(new Guid(typeName), typeLibPtr);\n\n        return type;\n    }\n}\n\npublic enum REGKIND\n{\n    REG_NONE = 0,\n    REG_CLASS = 1,\n    REG_TLB = 2,\n    REG_PROXY = 3,\n    REG_TLBEX = 4\n}