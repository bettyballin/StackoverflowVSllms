public TCP(BackgroundWorker b)\n{\n    try\n    {\n        bw = b;\n        client = new TcpClient();\n        IPEndPoint server = new IPEndPoint(IPAddress.Parse(srv), 1337);\n\n        while (true)\n        {\n            try\n            {\n                client.Connect(server); //Connect to the server\n                bw.ReportProgress(0);   //Update the GUI with the connection status\n\n                Thread t = new Thread(new ParameterizedThreadStart(HandleComms));\n                t.IsBackground = true;\n                t.Start(client);\n                break;\n            }\n            catch (Exception ex)\n            {\n                lastException = ex;\n                Thread.Sleep(1000); // wait for 1 second before retrying\n            }\n        }\n    }\n    catch (Exception ex)\n    {\n        lastException = ex;\n    }\n}