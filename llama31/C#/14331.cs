using System.Windows;\nusing System.Windows.Controls;\nusing System.Windows.Media;\n\npublic partial class MainWindow : Window\n{\n    public MainWindow()\n    {\n        InitializeComponent();\n    }\n\n    private void SearchButton_Click(object sender, RoutedEventArgs e)\n    {\n        string searchTerm = SearchTextBox.Text;\n        SearchAndHighlight(searchTerm, this);\n    }\n\n    private void SearchAndHighlight(string searchTerm, DependencyObject parent)\n    {\n        if (parent == null) return;\n\n        if (parent is TextBlock textBlock)\n        {\n            string text = textBlock.Text;\n            if (!string.IsNullOrEmpty(text) && text.Contains(searchTerm))\n            {\n                HighlightText(textBlock, searchTerm);\n            }\n        }\n        else if (parent is ListBox listBox)\n        {\n            foreach (ListBoxItem item in listBox.Items)\n            {\n                SearchAndHighlight(searchTerm, item);\n            }\n        }\n        else if (parent is TreeView treeView)\n        {\n            foreach (TreeViewItem item in treeView.Items)\n            {\n                SearchAndHighlight(searchTerm, item);\n            }\n        }\n\n        for (int i = 0; i < VisualTreeHelper.GetChildrenCount(parent); i++)\n        {\n            DependencyObject child = VisualTreeHelper.GetChild(parent, i);\n            SearchAndHighlight(searchTerm, child);\n        }\n    }\n\n    private void HighlightText(TextBlock textBlock, string searchTerm)\n    {\n        string text = textBlock.Text;\n        int index = text.IndexOf(searchTerm);\n        if (index != -1)\n        {\n            textBlock.Inlines.Clear();\n            Run run = new Run(text.Substring(0, index));\n            textBlock.Inlines.Add(run);\n            Run highlightedRun = new Run(searchTerm);\n            highlightedRun.Background = Brushes.Yellow;\n            textBlock.Inlines.Add(highlightedRun);\n            run = new Run(text.Substring(index + searchTerm.Length));\n            textBlock.Inlines.Add(run);\n        }\n    }\n}