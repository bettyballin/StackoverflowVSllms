public void StartStream()\n{\n    HttpListenerResponse response = StartListening("http://localhost:8080/");\n    MemoryStream mem = null;\n\n    for (;;)\n    {\n        Bitmap b = generateBitmap();\n        byte[] ar = BitmapToArray(b);\n\n        byte[] buffer = ar;\n        response.ContentType = "multipart/x-mixed-replace; boundary=--testboundary";\n        ASCIIEncoding ae = new ASCIIEncoding();\n        byte[] boundary = ae.GetBytes("\r\n--testboundary\r\nContent-Type: image/jpeg\r\nContent-Length:" + buffer.Length + "\r\n\r\n");\n        mem = new MemoryStream(boundary);\n        mem.WriteTo(response.OutputStream);\n        mem = new MemoryStream(buffer);\n        mem.WriteTo(response.OutputStream);\n\n        // Add the final boundary\n        byte[] finalBoundary = ae.GetBytes("\r\n--testboundary--\r\n");\n        mem = new MemoryStream(finalBoundary);\n        mem.WriteTo(response.OutputStream);\n    }\n    mem.Close();\n    listener.Stop();\n}