[DllImport("kernel32", SetLastError = true)]\nstatic extern IntPtr LoadLibraryEx(string lpFileName, IntPtr hReservedNull, LoadLibraryFlags dwFlags);\n\n[Flags]\nenum LoadLibraryFlags\n{\n    LOAD_LIBRARY_SEARCH_APPLICATION_DIR = 0x00000200,\n    LOAD_LIBRARY_SEARCH_DEFAULT_DIRS = 0x00001000\n}\n\n// ...\n\nIntPtr hModule = LoadLibraryEx("blowfish.dll", IntPtr.Zero, LoadLibraryFlags.LOAD_LIBRARY_SEARCH_APPLICATION_DIR);\nif (hModule == IntPtr.Zero)\n{\n    int errorCode = Marshal.GetLastWin32Error();\n    Misc.LogToFile("Could not load dll, error code: " + errorCode, true);\n    Application.Exit();\n}