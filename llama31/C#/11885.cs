[DllImport("User32.dll", EntryPoint = "FindWindow")]\npublic static extern IntPtr FindWindow(String lpClassName, String lpWindowName);\n\n[DllImport("user32.dll", EntryPoint = "FindWindowEx")]\npublic static extern IntPtr FindWindowEx(IntPtr hwndParent, IntPtr hwndChildAfter, string lpszClass, string lpszWindow);\n\n[DllImport("User32.dll")]\npublic static extern int SendMessage(IntPtr hWnd, int uMsg, int wParam, string lParam);\n\n// Replace these with the actual class names you found using Spy++ or Winspector\nstring channelClassName = "??"; // e.g. "mIRC_ChannelWindowClass"\nstring editClassName = "??"; // e.g. "mIRC_EditWindowClass"\n\nIntPtr mainHandle = FindWindow("mIRC", null);\nIntPtr serverHandle = FindWindowEx(mainHandle, new IntPtr(0), "MDIClient", null);\nIntPtr chanHandle = FindWindowEx(serverHandle, new IntPtr(0), channelClassName, null);\nIntPtr editHandle = FindWindowEx(chanHandle, new IntPtr(0), editClassName, null);\n\nSendMessage(editHandle, 0x000C, 0, textBox1.Text);