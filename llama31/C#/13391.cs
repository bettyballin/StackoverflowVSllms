using System;\nusing System.Collections.Generic;\nusing System.Data;\nusing System.Reflection;\n\npublic static class ListExtensions\n{\n    public static DataTable ToDataTable<T>(this List<T> items)\n    {\n        DataTable dataTable = new DataTable(typeof(T).Name);\n\n        // Get all the properties\n        PropertyInfo[] Props = typeof(T).GetProperties(BindingFlags.Public | BindingFlags.Instance);\n\n        foreach (PropertyInfo prop in Props)\n        {\n            // Setting column names as Property names\n            dataTable.Columns.Add(prop.Name);\n        }\n\n        foreach (T item in items)\n        {\n            var row = dataTable.NewRow();\n            foreach (PropertyInfo prop in Props)\n            {\n                // inserting property values to datatable rows\n                row[prop.Name] = prop.GetValue(item, null);\n            }\n            dataTable.Rows.Add(row);\n        }\n\n        return dataTable;\n    }\n}