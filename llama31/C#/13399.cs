using System.IO.Pipes;\nusing System.Runtime.InteropServices;\n\n// Create a named pipe server in one add-in instance\n[ComVisible(true)]\npublic class WordAddin\n{\n    private NamedPipeServerStream pipeServer;\n\n    public WordAddin()\n    {\n        pipeServer = new NamedPipeServerStream("MyAddinPipe", PipeDirection.InOut, 1);\n        pipeServer.WaitForConnection();\n    }\n\n    public void SendMessage(string message)\n    {\n        using (StreamWriter writer = new StreamWriter(pipeServer))\n        {\n            writer.WriteLine(message);\n        }\n    }\n}\n\n// Connect to the named pipe server from another add-in instance\n[ComVisible(true)]\npublic class ExcelAddin\n{\n    private NamedPipeClientStream pipeClient;\n\n    public ExcelAddin()\n    {\n        pipeClient = new NamedPipeClientStream(".", "MyAddinPipe", PipeDirection.InOut);\n        pipeClient.Connect();\n    }\n\n    public string ReceiveMessage()\n    {\n        using (StreamReader reader = new StreamReader(pipeClient))\n        {\n            return reader.ReadLine();\n        }\n    }\n}