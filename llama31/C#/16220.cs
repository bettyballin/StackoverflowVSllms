public static int GetMaxLength(Type type, string propertyName)\n{\n    var propertyInfo = type.GetProperty(propertyName);\n    var columnAttribute = (ColumnAttribute)propertyInfo.GetCustomAttributes(typeof(ColumnAttribute), false).FirstOrDefault();\n    if (columnAttribute != null)\n    {\n        var match = Regex.Match(columnAttribute.DbType, @"VarChar\((\d+)\)");\n        if (match.Success)\n        {\n            return int.Parse(match.Groups[1].Value);\n        }\n    }\n    return -1; // or throw an exception\n}