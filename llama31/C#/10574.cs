private void Button_Click(object sender, RoutedEventArgs e)\n{\n    panel1.Visibility = panel1.Visibility == Visibility.Collapsed ?\n        Visibility.Visible : Visibility.Collapsed;\n    panel2.Visibility = panel2.Visibility == Visibility.Collapsed ?\n        Visibility.Visible : Visibility.Collapsed;\n\n    // Reset validation when panel is collapsed\n    if (panel1.Visibility == Visibility.Collapsed)\n    {\n        DataBoundTextBox.GetBindingExpression(TextBox.TextProperty).UpdateTarget();\n    }\n}