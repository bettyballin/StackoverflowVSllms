using Microsoft.Win32;\n\npublic class IISVersionDetector\n{\n    public static string GetIISVersion()\n    {\n        using (RegistryKey key = Registry.LocalMachine.OpenSubKey(@"SOFTWARE\Microsoft\InetStp"))\n        {\n            if (key != null)\n            {\n                object version = key.GetValue("MajorVersion");\n                if (version != null)\n                {\n                    return version.ToString();\n                }\n            }\n            return string.Empty;\n        }\n    }\n}