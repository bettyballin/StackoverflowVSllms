protected void LoginButton_Click(object sender, EventArgs e)\n{\n    var username = UsernameTextBox.Text;\n    var password = PasswordTextBox.Text;\n    var tokenCode = TokenCodeTextBox.Text;\n\n    // Validate the username and password\n    if (ValidateUsernameAndPassword(username, password))\n    {\n        // Get the shared secret key for the user\n        var sharedSecretKey = GetSharedSecretKeyForUser(username);\n\n        // Create a new TotpAuthenticator instance\n        var authenticator = new TotpAuthenticator(sharedSecretKey);\n\n        // Validate the token code\n        if (authenticator.ValidateTokenCode(tokenCode))\n        {\n            // Login successful\n            FormsAuthentication.RedirectFromLoginPage(username, false);\n        }\n        else\n        {\n            // Login failed\n            ErrorMessageLabel.Text = "Invalid token code";\n        }\n    }\n    else\n    {\n        // Login failed\n        ErrorMessageLabel.Text = "Invalid username or password";\n    }\n}