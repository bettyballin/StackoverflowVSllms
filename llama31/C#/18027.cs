protected void Page_Load(object sender, EventArgs e)\n{\n    if (Page.IsPostBack)\n    {\n        // Check if the page is being re-submitted due to a refresh (F5)\n        if (Session["LastPostBack"] != null && \n            Request.Form["__LastPostBack"] == Session["LastPostBack"].ToString())\n        {\n            // Show a message to the user or do nothing\n            Response.Write("File has already been generated. Please try again.");\n            return;\n        }\n    }\n\n    // Generate the file...\n}\n\nprotected void Button1_Click(object sender, EventArgs e)\n{\n    // Generate the file...\n\n    // Set the session variable and hidden field\n    Session["LastPostBack"] = Guid.NewGuid().ToString();\n    ClientScript.RegisterHiddenField("__LastPostBack", Session["LastPostBack"].ToString());\n}