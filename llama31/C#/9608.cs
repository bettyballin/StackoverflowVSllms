using System;\nusing System.Collections.Generic;\nusing System.Data;\nusing System.Reflection;\n\npublic static class ListToDataSetConverter\n{\n    public static DataSet ToDataSet<T>(List<T> list)\n    {\n        DataSet ds = new DataSet();\n        DataTable dt = new DataTable(typeof(T).Name);\n        ds.Tables.Add(dt);\n\n        PropertyInfo[] properties = typeof(T).GetProperties(BindingFlags.Instance | BindingFlags.Public);\n\n        foreach (PropertyInfo property in properties)\n        {\n            dt.Columns.Add(property.Name, property.PropertyType);\n        }\n\n        foreach (T item in list)\n        {\n            DataRow row = dt.NewRow();\n            foreach (PropertyInfo property in properties)\n            {\n                row[property.Name] = property.GetValue(item, null);\n            }\n            dt.Rows.Add(row);\n        }\n\n        return ds;\n    }\n}