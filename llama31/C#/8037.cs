using System;\nusing System.Runtime.InteropServices;\n\nclass HeadphoneDetector\n{\n    [DllImport("winmm.dll")]\n    public static extern int waveOutGetNumDevs();\n\n    [DllImport("winmm.dll")]\n    public static extern int waveOutGetDevCaps(int uDeviceID, ref WAVEOUTCAPS pwoc, int cbwoc);\n\n    [StructLayout(LayoutKind.Sequential)]\n    public struct WAVEOUTCAPS\n    {\n        public short wMid;\n        public short wPid;\n        public int vDriverVersion;\n        [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 32)]\n        public string szPname;\n        public int dwFormats;\n        public short wChannels;\n        public short wReserved1;\n    }\n\n    public static bool IsHeadphonesPluggedIn()\n    {\n        int numDevs = waveOutGetNumDevs();\n        for (int i = 0; i < numDevs; i++)\n        {\n            WAVEOUTCAPS caps = new WAVEOUTCAPS();\n            waveOutGetDevCaps(i, ref caps, Marshal.SizeOf(caps));\n            if (caps.szPname.Contains("Headphones") || caps.szPname.Contains("Speakers"))\n            {\n                // Headphones or speakers are plugged in\n                return true;\n            }\n        }\n        return false;\n    }\n}