CARDIDTYPE cardId = new CARDIDTYPE();\n// Initialize cardId fields...\n\nuint needed;\nint memSize = Marshal.SizeOf(typeof(CARD_INFO_1));\nIntPtr memPtr = Marshal.AllocHGlobal(memSize);\nif (!GetCardStatus(ref cardId, 1, memPtr, (uint)memSize, out needed))\n{\n    int lastError = Marshal.GetLastWin32Error();\n    // error handling...\n}\nCARD_INFO_1 info = (CARD_INFO_1)Marshal.PtrToStructure(memPtr, typeof(CARD_INFO_1));\nMarshal.FreeHGlobal(memPtr);