using HtmlAgilityPack;\n\n// Load the HTML\nvar html = "your user-submitted HTML here";\nvar doc = new HtmlDocument();\ndoc.LoadHtml(html);\n\n// Define a whitelist of allowed elements and attributes\nvar whitelist = new[] { "p", "b", "i", "u", "a" };\nvar allowedAttributes = new[] { "href", "style" };\n\n// Sanitize the HTML\nforeach (var node in doc.DocumentNode.Descendants())\n{\n    if (!whitelist.Contains(node.Name))\n    {\n        node.Remove();\n    }\n    else\n    {\n        foreach (var attribute in node.Attributes)\n        {\n            if (!allowedAttributes.Contains(attribute.Name))\n            {\n                attribute.Remove();\n            }\n            else if (attribute.Name == "style")\n            {\n                // Check for JavaScript code in the style attribute\n                var styleValue = attribute.Value;\n                if (styleValue.Contains("expression("))\n                {\n                    attribute.Remove();\n                }\n            }\n        }\n    }\n}\n\n// Get the sanitized HTML\nvar sanitizedHtml = doc.DocumentNode.OuterHtml;