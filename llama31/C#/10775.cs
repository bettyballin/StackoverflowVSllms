using System;\nusing System.Data;\nusing System.IO;\nusing Excel = Microsoft.Office.Interop.Excel;\n\npublic void ExportDataSetToExcel(DataSet ds, string filePath)\n{\n    Excel.Application excelApp = new Excel.Application();\n    Excel.Workbook workbook = excelApp.Workbooks.Add();\n    Excel.Worksheet worksheet = (Excel.Worksheet)workbook.Sheets[1];\n\n    // Write the data to the worksheet\n    for (int i = 0; i < ds.Tables[0].Rows.Count; i++)\n    {\n        for (int j = 0; j < ds.Tables[0].Columns.Count; j++)\n        {\n            worksheet.Cells[i + 1, j + 1] = ds.Tables[0].Rows[i][j];\n        }\n    }\n\n    // Save the workbook to a file\n    workbook.SaveAs(filePath, Excel.XlFileFormat.xlWorkbookDefault);\n\n    // Clean up\n    excelApp.Quit();\n    Marshal.ReleaseComObject(excelApp);\n}\n\n// Example usage\nDataSet ds = new DataSet();\n// populate the dataset...\nExportDataSetToExcel(ds, @"C:\example.xlsx");