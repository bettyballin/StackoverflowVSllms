private void PopulateTreeView(TreeNodeCollection nodes, XElement scriptElement)\n{\n    foreach (XElement subscriptElement in scriptElement.Elements("subscript"))\n    {\n        TreeNode subscriptNode = nodes.Add(subscriptElement.Attribute("name").Value);\n        PopulateTreeView(subscriptNode.Nodes, subscriptElement);\n    }\n    foreach (XElement recordElement in scriptElement.Elements("record"))\n    {\n        nodes.Add(recordElement.Attribute("name").Value);\n    }\n}