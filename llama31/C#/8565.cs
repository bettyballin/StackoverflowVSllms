[Authorize]\npublic class MyController : Controller\n{\n    public ActionResult MyAction()\n    {\n        // If the user is not authenticated, return 401 Unauthorized\n        if (!User.Identity.IsAuthenticated)\n        {\n            return new HttpUnauthorizedResult();\n        }\n\n        // If the user is authenticated, proceed with the action\n        // ...\n    }\n}\n\n// In your login action, redirect to the requested page after successful login\npublic class LoginController : Controller\n{\n    public ActionResult Login(string returnUrl)\n    {\n        // If the login is successful, redirect to the requested page\n        if (/* login logic */)\n        {\n            return Redirect(returnUrl);\n        }\n\n        // If the login fails, display an error message\n        // ...\n    }\n}