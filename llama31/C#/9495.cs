using (SqlConnection connection = new SqlConnection(connectionString))\n{\n    connection.Open();\n\n    SqlCommand command = new SqlCommand("SET STATISTICS PROFILE ON", connection);\n    command.ExecuteNonQuery();\n\n    // Execute your query here\n    SqlCommand queryCommand = new SqlCommand("SELECT * FROM large_table", connection);\n    queryCommand.ExecuteNonQuery();\n\n    // Get the query profile\n    SqlCommand profileCommand = new SqlCommand("SET STATISTICS PROFILE OFF", connection);\n    SqlDataReader reader = profileCommand.ExecuteReader();\n\n    while (reader.Read())\n    {\n        // Get the estimated completion percentage\n        int completionPercentage = reader.GetInt32(0);\n        // Update your progress bar here\n    }\n}