using System;\nusing System.Diagnostics;\n\nclass Program\n{\n    static void Main()\n    {\n        string fileExtension = ".xls";\n        string arguments = "/r";\n\n        // Get the executable associated with the file type\n        string executable = GetExecutableForFileType(fileExtension);\n\n        if (!string.IsNullOrEmpty(executable))\n        {\n            // Launch the file with command line arguments\n            ProcessStartInfo startInfo = new ProcessStartInfo();\n            startInfo.FileName = executable;\n            startInfo.Arguments = $"\"Sample.xls\" {arguments}";\n            Process.Start(startInfo);\n        }\n    }\n\n    static string GetExecutableForFileType(string fileExtension)\n    {\n        // Use assoc and ftype to get the executable\n        ProcessStartInfo startInfo = new ProcessStartInfo();\n        startInfo.FileName = "cmd.exe";\n        startInfo.Arguments = $"/c assoc {fileExtension}";\n        startInfo.RedirectStandardOutput = true;\n        startInfo.UseShellExecute = false;\n\n        Process process = Process.Start(startInfo);\n        string assocOutput = process.StandardOutput.ReadToEnd();\n        process.WaitForExit();\n\n        if (!string.IsNullOrEmpty(assocOutput))\n        {\n            string fileType = assocOutput.Split('=')[1].Trim();\n\n            startInfo.Arguments = $"/c ftype {fileType}";\n            process = Process.Start(startInfo);\n            string ftypeOutput = process.StandardOutput.ReadToEnd();\n            process.WaitForExit();\n\n            if (!string.IsNullOrEmpty(ftypeOutput))\n            {\n                string executable = ftypeOutput.Split('=')[1].Trim();\n                return executable;\n            }\n        }\n\n        return null;\n    }\n}