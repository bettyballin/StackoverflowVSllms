public static DataTable GetHistory(DateTime from, DateTime to, bool paramedics, bool police, bool firefighters)\n{\n    var conditions = new List<string>();\n    var parameters = new Dictionary<string, object>();\n\n    if (paramedics)\n    {\n        conditions.Add("emergency_type = @paramedics");\n        parameters.Add("@paramedics", "paramedics");\n    }\n\n    if (police)\n    {\n        conditions.Add("emergency_type = @police");\n        parameters.Add("@police", "police");\n    }\n\n    if (firefighters)\n    {\n        conditions.Add("emergency_type = @firefighters");\n        parameters.Add("@firefighters", "firefighters");\n    }\n\n    var whereClause = string.Join(" OR ", conditions);\n\n    var query = $@"\n        SELECT call_time, location, emergency_type\n        FROM call\n        WHERE call_time BETWEEN @from AND @to\n        AND ({whereClause})\n    ";\n\n    parameters.Add("@from", from);\n    parameters.Add("@to", to);\n\n    // Execute the query with the parameters\n    using (var connection = new SqlConnection(connectionString))\n    {\n        connection.Open();\n        var command = new SqlCommand(query, connection);\n        foreach (var parameter in parameters)\n        {\n            command.Parameters.AddWithValue(parameter.Key, parameter.Value);\n        }\n        var adapter = new SqlDataAdapter(command);\n        var dataTable = new DataTable();\n        adapter.Fill(dataTable);\n        return dataTable;\n    }\n}