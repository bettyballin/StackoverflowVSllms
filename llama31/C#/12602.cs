public class ModuleMap : ClassMap<Module>\n{\n    public ModuleMap()\n    {\n        Id(x => x.Id);\n        Version(x => x.LastUpdated);\n        Map(x => x.ModuleId)\n            .Unique()\n            .Not.Nullable();\n        HasMany<ModuleVariable>(x => x.Variables)\n            .Cascade.All() // Use Cascade.All() instead of Cascade.SaveUpdate()\n            .Not.Inverse(); // Remove Inverse()\n        References<Variable>(x => x.StratumVariable)\n            .Not.Nullable()\n            .Cascade.SaveUpdate();\n        References<Stratum>(x => x.DefaultStratum)\n            .Not.Nullable()\n            .Cascade.SaveUpdate();\n        HasMany<Stratum>(x => x.OptionalStrata)\n            .Inverse()\n            .Cascade.SaveUpdate();\n    }\n}