using System;\nusing System.Runtime.InteropServices;\n\npublic class Program\n{\n    [DllImport("kernel32.dll", SetLastError = true, CharSet = CharSet.Unicode)]\n    static extern uint GetShortPathNameW([MarshalAs(UnmanagedType.LPWStr)] string lpszLongPath,\n        [MarshalAs(UnmanagedType.LPWStr)] StringBuilder lpszShortPath, uint cchBuffer);\n\n    public static string GetShortPathName(string longPath)\n    {\n        var shortPath = new StringBuilder(1024);\n        GetShortPathNameW(longPath, shortPath, (uint)shortPath.Capacity);\n        return shortPath.ToString();\n    }\n\n    public static void Main()\n    {\n        string longPath = @"C:\Program Files\Microsoft.NET\SDK\CompactFramework\v3.5\Debugger";\n        string shortPath = GetShortPathName(longPath);\n        Console.WriteLine(shortPath);\n    }\n}