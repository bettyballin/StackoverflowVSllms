using NodaTime;\nusing NodaTime.TimeZones;\n\n// Assuming you have a User class with a TimeZoneId property\npublic class User\n{\n    public string TimeZoneId { get; set; }\n    // ...\n}\n\n// Get the user's time zone\nvar user = GetUser();\nvar timeZone = TimeZoneCache.GetInstance().GetZoneOrNull(user.TimeZoneId);\n\n// Calculate the local time\nvar serverTime = SystemClock.Instance.GetCurrentInstant();\nvar localTime = serverTime.InUtc().ToLocalDateTime(timeZone);\n\n// Schedule the email to be sent at the local time\nvar schedule = new Schedule();\nschedule.AddTrigger(new DailyTimeIntervalTrigger(localTime.Hour, localTime.Minute, 0));\n\n// Send the email using your email service