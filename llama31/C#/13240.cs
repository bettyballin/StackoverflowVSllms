using System.IO;\nusing System.Security.AccessControl;\n\npublic bool CanCreateFile(string folderPath)\n{\n    if (string.IsNullOrEmpty(folderPath))\n    {\n        throw new ArgumentNullException(nameof(folderPath));\n    }\n\n    if (!Directory.Exists(folderPath))\n    {\n        return false; // folder does not exist\n    }\n\n    var directoryInfo = new DirectoryInfo(folderPath);\n    var accessControl = directoryInfo.GetAccessControl();\n\n    var rules = accessControl.GetAccessRules(true, true, typeof(System.Security.Principal.NTAccount));\n\n    foreach (FileSystemAccessRule rule in rules)\n    {\n        if (rule.AccessControlType == AccessControlType.Deny)\n        {\n            return false; // deny rule found, cannot create file\n        }\n\n        if (rule.FileSystemRights.HasFlag(FileSystemRights.CreateFiles))\n        {\n            return true; // create files right is granted\n        }\n    }\n\n    return false; // no explicit allow or deny rule found\n}