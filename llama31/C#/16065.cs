using System;\nusing System.Web;\n\npublic class ClientCertificateModule : IHttpModule\n{\n    public void Init(HttpApplication context)\n    {\n        context.EndRequest += new EventHandler(OnEndRequest);\n    }\n\n    void OnEndRequest(object sender, EventArgs e)\n    {\n        HttpApplication app = (HttpApplication)sender;\n        HttpRequest request = app.Request;\n        HttpResponse response = app.Response;\n\n        // Check if the request is for a specific virtual path\n        if (request.Url.AbsolutePath.StartsWith("/securepath", StringComparison.OrdinalIgnoreCase))\n        {\n            // Send a custom HTTP response to trigger the browser to prompt for a client certificate\n            response.StatusCode = 403;\n            response.StatusDescription = "Client certificate required";\n            response.Status = "403.7 Client certificate required";\n            response.End();\n        }\n    }\n\n    public void Dispose()\n    {\n        // Nothing to dispose\n    }\n}