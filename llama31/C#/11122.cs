using System;\nusing Outlook = Microsoft.Office.Interop.Outlook;\n\nclass OutlookFolderEnumerator\n{\n    public static void EnumerateFolders(string mailboxName)\n    {\n        Outlook.Application app = new Outlook.Application();\n        Outlook.MAPIFolder rootFolder = app.GetNamespace("MAPI").GetDefaultFolder(Outlook.OlDefaultFolders.olFolderInbox).Parent;\n\n        EnumerateFoldersRecursive(rootFolder, mailboxName);\n    }\n\n    private static void EnumerateFoldersRecursive(Outlook.MAPIFolder folder, string mailboxName)\n    {\n        Console.WriteLine(folder.Name);\n\n        foreach (Outlook.MAPIFolder childFolder in folder.Folders)\n        {\n            EnumerateFoldersRecursive(childFolder, mailboxName);\n        }\n    }\n}