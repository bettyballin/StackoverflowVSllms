using System.Diagnostics;\n\npublic class MyClass\n{\n    public void MyMethod()\n    {\n        var currentProcess = Process.GetCurrentProcess();\n        if (currentProcess.ProcessName.EndsWith("svchost.exe") || currentProcess.MainWindowHandle == IntPtr.Zero)\n        {\n            Console.WriteLine("Running as a service");\n        }\n        else\n        {\n            Console.WriteLine("Running in interactive mode");\n        }\n    }\n}