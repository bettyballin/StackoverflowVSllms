using System.Net.NetworkInformation;\n\npublic bool HasActiveTcpConnection(string ipAddress)\n{\n    IPGlobalProperties properties = IPGlobalProperties.GetIPGlobalProperties();\n    TcpConnectionInformation[] connections = properties.GetActiveTcpConnections();\n\n    foreach (TcpConnectionInformation connection in connections)\n    {\n        if (connection.RemoteEndPoint.Address.ToString() == ipAddress)\n        {\n            return true;\n        }\n    }\n\n    return false;\n}