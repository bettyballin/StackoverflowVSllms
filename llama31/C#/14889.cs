using System;\nusing System.Runtime.InteropServices;\n\nclass Program\n{\n    [DllImport("mpr.dll")]\n    static extern int WNetAddConnection2(ref NETRESOURCE lpNetResource, string lpLocalName, string lpProvider, int dwFlags);\n\n    [StructLayout(LayoutKind.Sequential)]\n    public struct NETRESOURCE\n    {\n        public int dwScope;\n        public int dwType;\n        public int dwDisplayType;\n        public int dwUsage;\n        [MarshalAs(UnmanagedType.LPStr)]\n        public string lpLocalName;\n        [MarshalAs(UnmanagedType.LPStr)]\n        public string lpRemoteName;\n        [MarshalAs(UnmanagedType.LPStr)]\n        public string lpComment;\n        [MarshalAs(UnmanagedType.LPStr)]\n        public string lpProvider;\n    }\n\n    static void Main(string[] args)\n    {\n        NETRESOURCE resource = new NETRESOURCE();\n        resource.dwType = 1; // RESOURCETYPE_ANY\n        resource.lpRemoteName = @"\\remote_computer\shared_folder";\n        resource.lpLocalName = null;\n        resource.lpProvider = null;\n\n        int flags = 0x10000000; // CONNECT_TEMPORARY\n\n        int result = WNetAddConnection2(ref resource, null, null, flags);\n        if (result == 0)\n        {\n            Console.WriteLine("Connected successfully");\n        }\n        else\n        {\n            Console.WriteLine("Error connecting: " + result);\n        }\n    }\n}