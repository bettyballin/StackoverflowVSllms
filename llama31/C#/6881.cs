private void CheckScrollBarVisibility()\n{\n    var scrollViewer = GetScrollViewer(listOfItems);\n    if (scrollViewer != null)\n    {\n        var visibility = scrollViewer.ComputedVerticalScrollBarVisibility;\n        if (visibility == Visibility.Visible)\n        {\n            // The vertical scrollbar is visible\n        }\n        else\n        {\n            // The vertical scrollbar is not visible\n        }\n    }\n}\n\nprivate ScrollViewer GetScrollViewer(DependencyObject obj)\n{\n    if (obj is ScrollViewer)\n    {\n        return obj as ScrollViewer;\n    }\n\n    for (int i = 0; i < VisualTreeHelper.GetChildrenCount(obj); i++)\n    {\n        var child = VisualTreeHelper.GetChild(obj, i);\n        var scrollViewer = GetScrollViewer(child);\n        if (scrollViewer != null)\n        {\n            return scrollViewer;\n        }\n    }\n\n    return null;\n}