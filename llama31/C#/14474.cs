using Microsoft.WindowsAPICodePack.Shell;\n\npublic class ImageMetadataReader\n{\n    public static (int width, int height) GetImageDimensions(string filePath)\n    {\n        var shellFile = ShellFile.FromFilePath(filePath);\n        var width = (int)shellFile.Properties.System.Image.HorizontalSize.Value;\n        var height = (int)shellFile.Properties.System.Image.VerticalSize.Value;\n        return (width, height);\n    }\n}