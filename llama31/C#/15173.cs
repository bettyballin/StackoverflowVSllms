using System.DirectoryServices;\n\n// Get the current user's pre-Windows 2000 login name\nstring username = HttpContext.Current.Request.ServerVariables["AUTH_USER"];\n\n// Split the domain and username\nstring[] parts = username.Split('\\');\nstring domain = parts[0];\nstring samAccountName = parts[1];\n\n// Create a DirectorySearcher object\nDirectorySearcher searcher = new DirectorySearcher();\n\n// Filter by sAMAccountName\nsearcher.Filter = $"(sAMAccountName={samAccountName})";\n\n// Set the search scope to the current domain\nsearcher.SearchScope = SearchScope.Subtree;\n\n// Execute the search\nSearchResult result = searcher.FindOne();\n\n// Get the user's details\nif (result != null)\n{\n    DirectoryEntry entry = result.GetDirectoryEntry();\n    string fullName = entry.Properties["cn"].Value.ToString();\n    string emailAddress = entry.Properties["mail"].Value.ToString();\n\n    // Use the retrieved details as needed\n}