using System.EnterpriseServices;\n\npublic class ComPlusRegistrar\n{\n    public static void Register(string assemblyName)\n    {\n        using (var catalog = new COMAdminCatalog())\n        {\n            var applications = catalog.GetCollection("Applications");\n            var application = applications.Add();\n            application.Value["Name"] = assemblyName;\n            application.Value["Activation"] = ActivationOption.Server;\n\n            var services = catalog.GetCollection("Services");\n            var service = services.Add();\n            service.Value["Name"] = assemblyName;\n            service.Value["OutOfProc"] = true;\n\n            catalog.SaveChanges();\n        }\n    }\n}