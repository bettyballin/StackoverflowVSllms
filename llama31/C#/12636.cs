var query = "SELECT * FROM table";\nvar parameters = new List<SqlParameter>();\n\nif (!string.IsNullOrEmpty(param1))\n{\n    query += " AND field1 = @param1";\n    parameters.Add(new SqlParameter("@param1", param1));\n}\n\nif (!string.IsNullOrEmpty(param2))\n{\n    query += " AND field2 = @param2";\n    parameters.Add(new SqlParameter("@param2", param2));\n}\n\nif (!string.IsNullOrEmpty(param3))\n{\n    query += " AND field3 LIKE '%' + @param3 + '%'";\n    parameters.Add(new SqlParameter("@param3", param3));\n}\n\n// ...\n\nusing (var connection = new SqlConnection(connectionString))\n{\n    connection.Open();\n    var command = new SqlCommand(query, connection);\n    command.Parameters.AddRange(parameters.ToArray());\n    var adapter = new SqlDataAdapter(command);\n    var dataTable = new DataTable();\n    adapter.Fill(dataTable);\n    return dataTable;\n}