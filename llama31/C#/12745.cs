string sql = "SELECT [UserId] FROM [UserProfiles] WHERE NOT [UserId] = @CurrentUserId";\n\n// ...\n\nusing (SqlConnection conn = new SqlConnection(strCon))\n{\n    using (SqlCommand comm = new SqlCommand(sql, conn))\n    {\n        comm.Parameters.AddWithValue("@CurrentUserId", "CurrentUserId");\n\n        conn.Open();\n\n        using (SqlDataAdapter adapter = new SqlDataAdapter(comm))\n        {\n            DataTable table = new DataTable();\n            adapter.Fill(table);\n\n            foreach (DataRow row in table.Rows)\n            {\n                string userId = row["UserId"].ToString(); // access the UserId column\n                // do something with the userId\n            }\n        }\n    }\n}