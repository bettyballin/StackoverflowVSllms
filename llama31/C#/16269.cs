public static IEnumerable<IEnumerable<T>> Subsequences<T>(\n    this IEnumerable<T> source, \n    int count)\n{\n    if (count == 0)\n    {\n        yield return Enumerable.Empty<T>();\n    }\n    else\n    {\n        int index = 0;\n        foreach (var first in source)\n        {\n            foreach (var rest in source.Skip(++index).Subsequences(count - 1))\n            {\n                yield return new[] { first }.Concat(rest);\n            }\n        }\n    }\n}