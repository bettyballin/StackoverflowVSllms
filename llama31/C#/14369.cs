using System;\nusing System.Runtime.InteropServices;\nusing WMEncoderLib;\n\nclass VideoEncoder\n{\n    [DllImport("WMVCore.DLL")]\n    public static extern int WMCreateEncoder(IntPtr ppEncoder);\n\n    public void EncodeVideo(string inputFile, string outputFile)\n    {\n        // Create a new encoder\n        IntPtr encoderPtr;\n        int hr = WMCreateEncoder(out encoderPtr);\n        if (hr != 0)\n        {\n            Marshal.ThrowExceptionForHR(hr);\n        }\n\n        // Set up the encoder\n        IWMEncoder2 encoder = (IWMEncoder2)Marshal.GetObjectForIUnknown(encoderPtr);\n        IWMEncoderFileSink fileSink;\n        encoder.get_FileSink(out fileSink);\n        fileSink.set_OutputFileName(outputFile);\n\n        // Set up the video stream\n        IWMEncoderVideoStream videoStream;\n        encoder.get_VideoStream(out videoStream);\n        videoStream.put_Quality(50); // Set quality to 50%\n        videoStream.put_CompressionFormat(WMEncoderVideoCompressionFormat.WMV3);\n\n        // Set up the audio stream\n        IWMEncoderAudioStream audioStream;\n        encoder.get_AudioStream(out audioStream);\n        audioStream.put_Quality(50); // Set quality to 50%\n        audioStream.put_CompressionFormat(WMEncoderAudioCompressionFormat.WMA9);\n\n        // Start encoding\n        encoder.Start();\n\n        // Add input file\n        IWMEncoderSource source;\n        encoder.get_Source(out source);\n        source.AddSourceFile(inputFile);\n\n        // Wait for encoding to complete\n        while (encoder.get_State() == WMEncoderState.WMENC_ENCODER_RUNNING)\n        {\n            System.Threading.Thread.Sleep(100);\n        }\n\n        // Clean up\n        encoder.Stop();\n        Marshal.ReleaseComObject(encoder);\n        Marshal.ReleaseComObject(fileSink);\n        Marshal.ReleaseComObject(videoStream);\n        Marshal.ReleaseComObject(audioStream);\n        Marshal.ReleaseComObject(source);\n    }\n}