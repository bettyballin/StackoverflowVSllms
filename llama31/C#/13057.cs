using Microsoft.SqlServer.Dac.CodeAnalysis;\nusing Microsoft.SqlServer.Dac.Model;\n\nnamespace MyCustomRules\n{\n    [ExportCodeAnalysisRule("PrimaryKeyFirst")]\n    public class PrimaryKeyFirstRule : CodeAnalysisRule\n    {\n        public override string DisplayName\n        {\n            get { return "Primary Key fields should be the first in the table"; }\n        }\n\n        public override void Analyze(CodeAnalysisContext context)\n        {\n            foreach (var table in context.DatabaseSchema.Tables)\n            {\n                var primaryKeyColumns = table.PrimaryKey.Columns;\n                if (primaryKeyColumns.Count > 0)\n                {\n                    var firstColumn = table.Columns.FirstOrDefault();\n                    if (firstColumn != null && primaryKeyColumns.Contains(firstColumn))\n                    {\n                        // No issue found\n                        continue;\n                    }\n\n                    context.AddIssue(new CodeAnalysisIssue(\n                        this,\n                        table,\n                        "Primary Key fields should be the first in the table"));\n                }\n            }\n        }\n    }\n}