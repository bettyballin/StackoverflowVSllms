protected void Page_Load(object sender, EventArgs e)\n{\n    // Start a new thread to retrieve countries\n    Thread thread = new Thread(new ThreadStart(GetCountries));\n    thread.Start();\n}\n\nprotected void GetCountries()\n{\n    if (Session["Countries"] == null)\n    {\n        Session["Countries"] = CountryRepository.Instance.GetAll();\n    }\n    // Use a callback method to populate the DropDownList\n    PopulateCountries();\n}\n\nprotected void PopulateCountries()\n{\n    if (Session["Countries"] != null)\n    {\n        DropDownList ddl = (DropDownList)Page.FindControl("ddlCountry");\n        ddl.DataSource = Session["Countries"] as List<Country>;\n        ddl.DataTextField = "Name";\n        ddl.DataValueField = "Id";\n        ddl.DataBind();\n    }\n}\n\n// To get towns based on country selection, use a separate method and callback\nprotected void ddlCountry_SelectedIndexChanged(object sender, EventArgs e)\n{\n    // Start a new thread to retrieve towns\n    Thread thread = new Thread(new ThreadStart(GetTowns));\n    thread.Start();\n}\n\nprotected void GetTowns()\n{\n    // Retrieve towns based on the selected country\n    List<Town> towns = TownRepository.Instance.GetTownsByCountryId(ddlCountry.SelectedValue);\n    // Store towns in Session or cache\n    Session["Towns"] = towns;\n    // Use a callback method to populate the DropDownList\n    PopulateTowns();\n}\n\nprotected void PopulateTowns()\n{\n    if (Session["Towns"] != null)\n    {\n        DropDownList ddlTowns = (DropDownList)Page.FindControl("ddlTowns");\n        ddlTowns.DataSource = Session["Towns"] as List<Town>;\n        ddlTowns.DataTextField = "Name";\n        ddlTowns.DataValueField = "Id";\n        ddlTowns.DataBind();\n    }\n}