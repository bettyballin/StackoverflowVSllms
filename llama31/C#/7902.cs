private static void CreateVDir(string metabasePath, string vDirName, string physicalPath)\n{\n    // ... (rest of the code remains the same)\n\n    DirectoryEntry newVDir = vdirs.Add(vDirName, (className.Replace("Service", "VirtualDir")));\n    newVDir.Properties["Path"][0] = physicalPath;\n    newVDir.Properties["AccessScript"][0] = true;\n    // These properties are necessary for an application to be created.\n    newVDir.Properties["AppFriendlyName"][0] = vDirName;\n    newVDir.Properties["AppIsolated"][0] = "1";\n    newVDir.Properties["AppRoot"][0] = \n       "/LM" +\n       metabasePath.Substring(metabasePath.IndexOf("/", ("IIS://".Length)));\n    newVDir.Properties["MSManagedRuntimeVersion"][0] = "v2.0";\n    newVDir.Properties["ManagedPipelineMode"][0] = "Integrated";\n    newVDir.CommitChanges();\n    Console.WriteLine(" Done.");\n}