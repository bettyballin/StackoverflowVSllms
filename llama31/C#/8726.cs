public static double[] MovingAverage(double[] data, int windowSize)\n{\n    double[] smoothedData = new double[data.Length];\n    for (int i = 0; i < data.Length; i++)\n    {\n        int start = Math.Max(0, i - windowSize / 2);\n        int end = Math.Min(data.Length - 1, i + windowSize / 2);\n        double sum = 0;\n        for (int j = start; j <= end; j++)\n        {\n            sum += data[j];\n        }\n        smoothedData[i] = sum / (end - start + 1);\n    }\n    return smoothedData;\n}