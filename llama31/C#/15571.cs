public static int KMP_Search(string text, string pattern)\n{\n    int[] prefix = new int[pattern.Length];\n    prefix[0] = 0;\n    int j = 0;\n    for (int i = 1; i < pattern.Length; i++)\n    {\n        while (j > 0 && pattern[i] != pattern[j])\n            j = prefix[j - 1];\n        if (pattern[i] == pattern[j])\n            j++;\n        prefix[i] = j;\n    }\n    j = 0;\n    for (int i = 0; i < text.Length; i++)\n    {\n        while (j > 0 && text[i] != pattern[j])\n            j = prefix[j - 1];\n        if (text[i] == pattern[j])\n            j++;\n        if (j == pattern.Length)\n            return i - pattern.Length + 1;\n    }\n    return -1;\n}