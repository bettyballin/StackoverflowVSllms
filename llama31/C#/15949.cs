int count = 0;\nIntPtr pCredentials = IntPtr.Zero;\nbool ret = false;\nret = CredEnumerate(null, 0, out count, out pCredentials);\nif (ret != false)\n{\n    IntPtr[] credentials = new IntPtr[count];\n    IntPtr p = pCredentials;\n    for (int i = 0; i < count; i++)\n    {\n        credentials[i] = Marshal.ReadIntPtr(p);\n        p = new IntPtr(p.ToInt64() + IntPtr.Size); // increment by the size of a pointer\n    }\n    List<Credential> creds = new List<Credential>(credentials.Length);\n    foreach (IntPtr ptr in credentials)\n    {\n        creds.Add((Credential)Marshal.PtrToStructure(ptr, typeof(Credential)));\n    }\n}