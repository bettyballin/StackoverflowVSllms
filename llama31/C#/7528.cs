var text = @"\nBEGIN\n    DECLARE cnt NUMBER;\n    BEGIN\n        SELECT COUNT(*) INTO cnt FROM all_tables\n        WHERE table_name = 'TABLE_A';\n        \n        IF cnt = 1 THEN\n            BEGIN \n                EXECUTE IMMEDIATE 'TRUNCATE TABLE TABLE_A';\n                EXECUTE IMMEDIATE 'DROP TABLE TABLE_A';\n            END;\n        END IF;\n        \n        EXECUTE IMMEDIATE 'CREATE TABLE TABLE_A AS \n        (SELECT DISTINCT v.ID, g.ext_id FROM VIEW_A v\n         JOIN TABLE_B B ON v.id = B.Id\n         WHERE YEAR1 = ''2008'')';\n    END;\nEND;\n";\n\nvar createTempTable = new OracleCommand();\ncreateTempTable.CommandText = text;\ncreateTempTable.Connection = conn;\ncreateTempTable.CommandType = CommandType.Text;\n\nconn.Open();\n\ntry\n{\n    createTempTable.ExecuteNonQuery();\n}\ncatch (Exception ex)\n{\n    throw;\n}\nfinally\n{\n    conn.Close();\n}