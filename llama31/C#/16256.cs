public class SimpleDataSet {\n    private DataRow[] rows;\n    private DataColumn[] columns;\n    private Hashtable columnLookup;\n    private Hashtable rowLookup;\n\n    public SimpleDataSet() {\n        rows = new DataRow[0];\n        columns = new DataColumn[0];\n        columnLookup = new Hashtable();\n        rowLookup = new Hashtable();\n    }\n\n    public void AddColumn(string columnName, Type dataType) {\n        DataColumn column = new DataColumn(columnName, dataType);\n        columns = (DataColumn[]) columns.Concat(new DataColumn[] { column }).ToArray();\n        columnLookup[columnName] = column;\n    }\n\n    public void AddRow(params object[] values) {\n        DataRow row = new DataRow(values);\n        rows = (DataRow[]) rows.Concat(new DataRow[] { row }).ToArray();\n        rowLookup[row.ID] = row;\n    }\n\n    public DataRow GetRow(int rowIndex) {\n        return rows[rowIndex];\n    }\n\n    public DataColumn GetColumn(string columnName) {\n        return (DataColumn) columnLookup[columnName];\n    }\n}\n\npublic class DataRow {\n    public int ID { get; set; }\n    public object[] Values { get; set; }\n\n    public DataRow(params object[] values) {\n        Values = values;\n        ID = Guid.NewGuid().GetHashCode();\n    }\n}\n\npublic class DataColumn {\n    public string ColumnName { get; set; }\n    public Type DataType { get; set; }\n\n    public DataColumn(string columnName, Type dataType) {\n        ColumnName = columnName;\n        DataType = dataType;\n    }\n}