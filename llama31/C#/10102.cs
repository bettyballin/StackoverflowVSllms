static void Main(string[] args)\n{\n    string serverName = Environment.MachineName;\n    DirectoryEntry dir = new DirectoryEntry("IIS://" + serverName + "/W3SVC/1/ROOT", @"adminusername", @"password");\n    dir.AuthenticationType = AuthenticationTypes.ServerBind; // Use ServerBind instead of Secure\n    PrintChildren(dir, 0);\n}\n\nprivate static void PrintChildren(DirectoryEntry entry, int level)\n{\n    foreach (DirectoryEntry child in entry.Children)\n    {\n        Console.WriteLine("");\n        Console.WriteLine("|");\n        for (int i = 0; i < level; i++)\n        {\n            Console.Write("----");\n        }\n        Console.Write(child.Name);\n\n        if (child.Children != null)\n        {\n            PrintChildren(child, level + 1);\n        }\n    }\n}