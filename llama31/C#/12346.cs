using Rhino.Mocks;\nusing System.ComponentModel.Composition;\nusing System.ComponentModel.Composition.Hosting;\nusing System.ComponentModel.Composition.Primitives;\n\n// Create a mock object using Rhino Mocks\nvar mock = MockRepository.GenerateMock<IService>();\n\n// Create an ExportFactory that returns the mock object\nvar exportFactory = new ExportFactory<IService>(() => mock);\n\n// Create a new CompositionContainer\nvar container = new CompositionContainer();\n\n// Add the ExportFactory to the container\ncontainer.ComposeExportedValue(exportFactory);\n\n// Now you can use the container to compose the component you are testing\nvar component = new MyComponent();\ncontainer.ComposeParts(component);