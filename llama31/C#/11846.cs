public class ExchangeManager\n{\n    public void DoSomethingThatRequiresImpersonation(string username, string domain, string password)\n    {\n        ExchangeImpersonator impersonator = new ExchangeImpersonator();\n        impersonator.Impersonate(username, domain, password);\n        try\n        {\n            // Code that requires impersonation\n        }\n        finally\n        {\n            impersonator.UndoImpersonation();\n        }\n    }\n}