using (SqlConnection connection = new SqlConnection(connectionString))\n{\n    connection.Open();\n\n    using (SqlBulkCopy bulkCopy = new SqlBulkCopy(connection))\n    {\n        bulkCopy.DestinationTableName = "YourTable";\n        bulkCopy.BatchSize = 10000;\n        bulkCopy.SqlBulkCopyOptions = SqlBulkCopyOptions.TableLock;\n\n        using (StreamReader reader = new StreamReader(filePath))\n        {\n            string line;\n            while ((line = reader.ReadLine()) != null)\n            {\n                string[] columns = line.Split(',');\n                DataRow row = YourDataTable.NewRow();\n                // populate the row with data\n                YourDataTable.Rows.Add(row);\n            }\n        }\n\n        bulkCopy.WriteToServer(YourDataTable);\n    }\n}