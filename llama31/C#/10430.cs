using System;\nusing System.Security.Cryptography;\nusing System.Text;\n\npublic static string MySqlPasswordHash(string password)\n{\n    byte[] passwordBytes = Encoding.UTF8.GetBytes(password);\n    byte[] salt = new byte[] { 0x20, 0x3A, 0x31, 0x2F, 0x3A, 0x4F, 0x58, 0x50 };\n    byte[] hash = new byte[16];\n\n    using (SHA1 sha1 = SHA1.Create())\n    {\n        byte[] saltedPassword = new byte[salt.Length + passwordBytes.Length];\n        Array.Copy(salt, 0, saltedPassword, 0, salt.Length);\n        Array.Copy(passwordBytes, 0, saltedPassword, salt.Length, passwordBytes.Length);\n\n        byte[] firstHash = sha1.ComputeHash(saltedPassword);\n        byte[] secondHash = sha1.ComputeHash(firstHash);\n\n        Array.Copy(secondHash, 0, hash, 0, 16);\n    }\n\n    StringBuilder hashedPassword = new StringBuilder();\n    foreach (byte b in hash)\n    {\n        hashedPassword.Append(b.ToString("x2"));\n    }\n\n    return "*" + hashedPassword.ToString();\n}