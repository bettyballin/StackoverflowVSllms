using System;\nusing System.Reflection;\n\npublic class ApplicationTypeDetector\n{\n    public static ApplicationType GetApplicationType()\n    {\n        if (IsConsoleApplication())\n            return ApplicationType.Console;\n        if (IsWindowsFormsApplication())\n            return ApplicationType.WinForms;\n        if (IsAspNetApplication())\n            return ApplicationType.AspNet;\n        if (IsWindowsService())\n            return ApplicationType.WindowsService;\n        return ApplicationType.Unknown;\n    }\n\n    private static bool IsConsoleApplication()\n    {\n        return Console.In != null && Console.Out != null;\n    }\n\n    private static bool IsWindowsFormsApplication()\n    {\n        return System.Windows.Forms.Application.MessageLoop != null;\n    }\n\n    private static bool IsAspNetApplication()\n    {\n        return System.Web.HttpContext.Current != null;\n    }\n\n    private static bool IsWindowsService()\n    {\n        return System.ServiceProcess.ServiceBase.Current != null;\n    }\n}\n\npublic enum ApplicationType\n{\n    Console,\n    WinForms,\n    AspNet,\n    WindowsService,\n    Unknown\n}