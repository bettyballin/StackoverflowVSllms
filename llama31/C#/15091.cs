using System.Net.Security;\nusing System.Security.Cryptography.X509Certificates;\n\n// Establish a TLS connection to the device\nSslStream sslStream = new SslStream(new TcpClient(deviceIpAddress, devicePort).GetStream(), true, ValidateServerCertificate);\n\n// Verify the server certificate\nbool ValidateServerCertificate(object sender, X509Certificate certificate, X509Chain chain, SslPolicyErrors sslPolicyErrors)\n{\n    // Check if the certificate is trusted\n    if (sslPolicyErrors != SslPolicyErrors.None)\n    {\n        return false;\n    }\n\n    // Check if the certificate matches the expected certificate\n    if (certificate.GetCertHashString() != expectedCertHash)\n    {\n        return false;\n    }\n\n    return true;\n}