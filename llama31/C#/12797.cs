using System;\nusing System.IO;\nusing unoidl.com.sun.star.lang;\nusing unoidl.com.sun.star.text;\nusing unoidl.com.sun.star.uno;\n\nclass MailMergeExample\n{\n    public static void Main(string[] args)\n    {\n        // Initialize the OpenOffice API\n        XComponentContext context = uno.util.Bootstrap.bootstrap();\n        XMultiServiceFactory factory = (XMultiServiceFactory)context.getServiceManager();\n\n        // Load the template document\n        XComponent template = factory.createInstance("com.sun.star.text.TextDocument");\n        XTextDocument textDoc = (XTextDocument)template;\n        textDoc.loadComponentFromURL("file:///path/to/template.odt", "_blank", 0, new unoidl.com.sun.star.beans.PropertyValue[0]);\n\n        // Load the data source (e.g. a CSV file)\n        string[] data = File.ReadAllLines("data.csv");\n\n        // Iterate over the data and create a new document for each row\n        for (int i = 0; i < data.Length; i++)\n        {\n            string[] fields = data[i].Split(',');\n            XTextCursor cursor = textDoc.getText().createTextCursor();\n\n            // Replace placeholders in the template with actual values\n            for (int j = 0; j < fields.Length; j++)\n            {\n                string placeholder = "FIELD_" + (j + 1);\n                cursor.gotoStart(true);\n                while (cursor.gotoNextBookmark(placeholder))\n                {\n                    cursor.setString(fields[j]);\n                }\n            }\n\n            // Save the merged document to a new file\n            XStorable storable = (XStorable)textDoc;\n            string filename = "output_" + (i + 1) + ".odt";\n            storable.storeAsURL("file:///" + filename, new unoidl.com.sun.star.beans.PropertyValue[0]);\n        }\n\n        // Clean up\n        template.dispose();\n        context.terminate();\n    }\n}