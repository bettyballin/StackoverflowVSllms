using (OracleConnection connection = new OracleConnection(connectionString))\n{\n    connection.Open();\n\n    using (OracleTransaction transaction = connection.BeginTransaction())\n    {\n        try\n        {\n            for (int i = 0; i < numInserts; i++)\n            {\n                using (OracleCommand command = new OracleCommand(insertStatement, connection))\n                {\n                    command.ExecuteNonQuery();\n                }\n            }\n\n            transaction.Commit();\n        }\n        catch (Exception ex)\n        {\n            transaction.Rollback();\n            throw;\n        }\n    }\n}