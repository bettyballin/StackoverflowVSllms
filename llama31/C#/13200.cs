using System;\nusing System.Data;\nusing System.Data.SqlClient;\n\nclass SqlBulkCopyBatching\n{\n    static void Main()\n    {\n        string connectionString = "Your connection string";\n        string sourceConnectionString = "Your ODBC source connection string";\n        string sourceTableName = "SourceTable";\n        string destinationTableName = "SQLStagingTable";\n\n        int batchSize = 100000; // adjust this value to control memory usage\n\n        using (SqlConnection destinationConnection = new SqlConnection(connectionString))\n        {\n            destinationConnection.Open();\n\n            using (OdbcConnection sourceConnection = new OdbcConnection(sourceConnectionString))\n            {\n                sourceConnection.Open();\n\n                OdbcCommand sourceCommand = new OdbcCommand($"SELECT * FROM {sourceTableName}", sourceConnection);\n                OdbcDataReader reader = sourceCommand.ExecuteReader();\n\n                while (reader.Read())\n                {\n                    DataTable batchTable = new DataTable();\n                    batchTable.Load(reader, LoadOption.OverwriteChanges, batchSize);\n\n                    using (SqlBulkCopy bulkCopy = new SqlBulkCopy(destinationConnection))\n                    {\n                        bulkCopy.DestinationTableName = destinationTableName;\n                        bulkCopy.WriteToServer(batchTable);\n                    }\n                }\n            }\n        }\n    }\n}