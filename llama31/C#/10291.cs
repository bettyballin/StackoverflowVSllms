public static class ListBoxExtensions\n{\n    public static readonly DependencyProperty SelectedItemsProxyProperty =\n        DependencyProperty.RegisterAttached("SelectedItemsProxy", typeof(IList), typeof(ListBoxExtensions), new PropertyMetadata(null));\n\n    public static IList GetSelectedItemsProxy(ListBox listBox)\n    {\n        return (IList)listBox.GetValue(SelectedItemsProxyProperty);\n    }\n\n    public static void SetSelectedItemsProxy(ListBox listBox, IList value)\n    {\n        listBox.SetValue(SelectedItemsProxyProperty, value);\n    }\n}