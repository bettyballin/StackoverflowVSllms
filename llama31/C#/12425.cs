using System;\nusing System.Threading;\nusing System.Threading.Tasks;\n\npublic class PreviewGenerator\n{\n    public async Task GeneratePreviewAsync(Document document, CancellationToken cancellationToken)\n    {\n        // Create a new thread to execute the legacy code\n        using var thread = new Thread(() =>\n        {\n            // Call the legacy code here\n            LegacyCode.GeneratePreview(document);\n        });\n\n        // Set a timeout for the thread\n        var timeout = TimeSpan.FromMinutes(1);\n        var task = Task.Run(() => thread.Start(), cancellationToken);\n        if (!task.Wait(timeout, cancellationToken))\n        {\n            // Abort the thread if it doesn't complete within the timeout\n            thread.Abort();\n            // Handle the timeout or abort scenario\n        }\n    }\n}