using System.DirectoryServices.Protocol;\n\n// Create a connection to the Directory Service instance\nLdapConnection connection = new LdapConnection("ldap://your-ldap-server");\n\n// Create a search filter to find the user object\nSearchRequest searchRequest = new SearchRequest(\n    "dc=your-domain,dc=com", // base DN\n    "(&(objectClass=user)(uid=DaffyD))", // filter\n    SearchScope.Subtree, // search scope\n    null // attributes to retrieve\n);\n\n// Execute the search and retrieve the user object\nSearchResponse searchResponse = connection.SendRequest(searchRequest) as SearchResponse;\nDirectoryAttributeCollection attributes = searchResponse.Entries[0].Attributes;\n\n// Get the memberOf attribute\nDirectoryAttribute memberOfAttribute = attributes["memberOf"];\n\n// Iterate through the memberOf values to get the DNs of the groups/OU\nforeach (string memberOfValue in memberOfAttribute.Values)\n{\n    Console.WriteLine(memberOfValue);\n}