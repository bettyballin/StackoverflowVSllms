using System.Text.RegularExpressions;\n\npublic static string CleanNodeName(string name)\n{\n    // Replace invalid characters with their corresponding escape sequence\n    name = Regex.Replace(name, @"[^a-zA-Z0-9_\-\.]", m => {\n        switch (m.Value)\n        {\n            case " ":\n                return "_"; // replace space with underscore\n            default:\n                return "_" + ((int)m.Value[0]).ToString("X4"); // replace other invalid chars with _xxxx\n        }\n    });\n\n    return name;\n}