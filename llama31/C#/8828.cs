using System.DirectoryServices;\n\n// Get the distribution group's email address\nstring groupEmail = GetGroupEmail("My Test Group");\n\nmail.To.Add(groupEmail);\n\n// ... rest of your code ...\n\n// Helper method to get the group's email address\nprivate string GetGroupEmail(string groupName)\n{\n    DirectoryEntry entry = new DirectoryEntry("LDAP://your-domain.com");\n    DirectorySearcher searcher = new DirectorySearcher(entry);\n    searcher.Filter = $"(&(objectClass=group)(cn={groupName}))";\n    searcher.PropertiesToLoad.Add("mail");\n\n    SearchResult result = searcher.FindOne();\n    if (result != null)\n    {\n        return result.Properties["mail"][0].ToString();\n    }\n    return null;\n}