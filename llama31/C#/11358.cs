var receivedPackets = new Dictionary<ushort, ImagePacket>();\n\n// ...\n\nvoid OnPacketReceived(ImagePacket packet)\n{\n    receivedPackets[packet.SequenceNumber] = packet;\n\n    if (receivedPackets.Count == packet.TotalPackets)\n    {\n        // Reassemble the image\n        var image = new byte[packet.TotalPackets * 1500];\n        foreach (var p in receivedPackets.Values.OrderBy(p => p.SequenceNumber))\n        {\n            Array.Copy(p.ImageData, 0, image, p.SequenceNumber * 1500, p.ImageData.Length);\n        }\n\n        // Process the reassembled image\n    }\n}