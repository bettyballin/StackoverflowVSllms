using System.Management;\n\npublic string GetApplicationPoolName(string siteName)\n{\n    ManagementScope scope = new ManagementScope(@"\\localhost\root\MicrosoftIISv2");\n    ObjectQuery query = new ObjectQuery("SELECT * FROM IIsWebSite WHERE Name = '" + siteName + "'");\n    ManagementObjectSearcher searcher = new ManagementObjectSearcher(scope, query);\n    ManagementObjectCollection results = searcher.Get();\n\n    if (results.Count > 0)\n    {\n        ManagementObject site = results[0];\n        return site["AppPoolId"].ToString();\n    }\n    else\n    {\n        return null;\n    }\n}