[DllImport("wininet.dll")]\npublic static extern bool InternetSetOption(IntPtr hInternet, int dwOption, IntPtr lpBuffer, int dwBufferLength);\n\npublic const int INTERNET_OPTION_PROXY = 38;\n\npublic void SetProxySettings(string proxyServer, int proxyPort)\n{\n    IntPtr hInternet = IntPtr.Zero;\n    try\n    {\n        hInternet = InternetOpen("MyApp", 0, null, null, 0);\n        if (hInternet != IntPtr.Zero)\n        {\n            string proxyString = $"{proxyServer}:{proxyPort}";\n            IntPtr proxyPtr = Marshal.StringToHGlobalAnsi(proxyString);\n            InternetSetOption(hInternet, INTERNET_OPTION_PROXY, proxyPtr, proxyString.Length + 1);\n            Marshal.FreeHGlobal(proxyPtr);\n        }\n    }\n    finally\n    {\n        if (hInternet != IntPtr.Zero)\n        {\n            InternetCloseHandle(hInternet);\n        }\n    }\n}