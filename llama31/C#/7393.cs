using HtmlAgilityPack;\n\npublic static string HtmlToText(string html)\n{\n    var doc = new HtmlDocument();\n    doc.LoadHtml(html);\n\n    var text = "";\n    foreach (var node in doc.DocumentNode.Descendants())\n    {\n        switch (node.Name)\n        {\n            case "p":\n                text += node.InnerText + Environment.NewLine + Environment.NewLine;\n                break;\n            case "li":\n                text += "* " + node.InnerText + Environment.NewLine;\n                break;\n            case "h1":\n            case "h2":\n            case "h3":\n            case "h4":\n            case "h5":\n            case "h6":\n                text += node.InnerText + Environment.NewLine;\n                break;\n            default:\n                text += node.InnerText;\n                break;\n        }\n    }\n\n    return text;\n}