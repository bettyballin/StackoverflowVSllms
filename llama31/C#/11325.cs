using System.IO;\nusing System.Security.Cryptography;\n\npublic string GetRandomFile(string directory)\n{\n    var files = Directory.GetFiles(directory);\n    if (files.Length == 0)\n    {\n        throw new DirectoryNotFoundException("No files found in the directory.");\n    }\n\n    using (var rng = RandomNumberGenerator.Create())\n    {\n        var bytes = new byte[4];\n        rng.GetBytes(bytes);\n        var rand = BitConverter.ToInt32(bytes, 0);\n        var index = Math.Abs(rand % files.Length);\n        return files[index];\n    }\n}\n\n// Usage:\nvar randomFile = GetRandomFile(@"C:\wallpapers");