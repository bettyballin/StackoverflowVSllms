using System;\nusing System.IO;\nusing System.Security.Cryptography;\nusing System.Text;\n\npublic class DatasetEncryption\n{\n    public static byte[] EncryptDataset(DataSet dataset)\n    {\n        byte[] encryptedData;\n\n        using (Aes aes = Aes.Create())\n        {\n            aes.Key = GenerateKey();\n            aes.IV = GenerateIV();\n\n            using (MemoryStream ms = new MemoryStream())\n            {\n                using (CryptoStream cs = new CryptoStream(ms, aes.CreateEncryptor(), CryptoStreamMode.Write))\n                {\n                    dataset.WriteXml(cs);\n                }\n\n                encryptedData = ms.ToArray();\n            }\n        }\n\n        return encryptedData;\n    }\n\n    private static byte[] GenerateKey()\n    {\n        using (Aes aes = Aes.Create())\n        {\n            aes.GenerateKey();\n            return aes.Key;\n        }\n    }\n\n    private static byte[] GenerateIV()\n    {\n        using (Aes aes = Aes.Create())\n        {\n            aes.GenerateIV();\n            return aes.IV;\n        }\n    }\n}