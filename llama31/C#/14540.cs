public static Configuration LoadConfigurationFromXml(string xml)\n{\n    var xmlDoc = new XmlDocument();\n    xmlDoc.LoadXml(xml);\n\n    var stream = new MemoryStream();\n    xmlDoc.Save(stream);\n    stream.Position = 0;\n\n    var fileMap = new ExeConfigurationFileMap();\n    fileMap.ExeConfigFilename = "dummy.exe.config";\n    fileMap.RoamingUserConfigFilename = "dummy.config";\n\n    var config = ConfigurationManager.OpenMappedExeConfiguration(fileMap, ConfigurationUserLevel.None);\n    config.Save(ConfigurationSaveMode.Full, true);\n\n    var configFileMap = new ExeConfigurationFileMap();\n    configFileMap.ExeConfigFilename = "dummy.exe.config";\n\n    return ConfigurationManager.OpenMappedExeConfiguration(configFileMap, ConfigurationUserLevel.None);\n}