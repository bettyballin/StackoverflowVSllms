using System;\nusing System.Security.Permissions;\nusing Microsoft.Azure.Management.Authorization;\n\npublic class AzManAuthorizeAttribute : AuthorizeAttribute\n{\n    private string _permission;\n\n    public AzManAuthorizeAttribute(string permission)\n    {\n        _permission = permission;\n    }\n\n    protected override bool AuthorizeCore(HttpContextBase httpContext)\n    {\n        // Get the current user's identity\n        IIdentity identity = httpContext.User.Identity;\n\n        // Check if the user has the required permission\n        using (var azManStore = new AzManStore())\n        {\n            var userPermissions = azManStore.GetUserPermissions(identity.Name);\n            if (userPermissions.Contains(_permission))\n            {\n                return true;\n            }\n        }\n\n        return false;\n    }\n}