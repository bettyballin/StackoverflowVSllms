var image = ...; // 100KB image\nvar packets = new List<ImagePacket>();\n\nvar sequenceNumber = 0;\nvar totalPackets = (int)Math.Ceiling(image.Length / 1500.0);\n\nfor (var i = 0; i < image.Length; i += 1500)\n{\n    var packet = new ImagePacket\n    {\n        SequenceNumber = (ushort)sequenceNumber,\n        TotalPackets = (ushort)totalPackets,\n        ImageData = image.Skip(i).Take(1500).ToArray()\n    };\n\n    packets.Add(packet);\n    sequenceNumber++;\n}