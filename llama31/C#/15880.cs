using Microsoft.Win32;\n\nprivate string GetExpressPath()\n{\n    using (RegistryKey baseKey = RegistryKey.OpenBaseKey(RegistryHive.LocalMachine, RegistryView.Registry64))\n    {\n        using (RegistryKey sqlServerKey = baseKey.OpenSubKey(@"SOFTWARE\Microsoft\Microsoft SQL Server\Instance Names\SQL"))\n        {\n            string sqlExpressKeyName = (string)sqlServerKey.GetValue("SQLEXPRESS");\n            using (RegistryKey sqlInstanceSetupKey = sqlServerKey.OpenSubKey(sqlExpressKeyName + @"\Setup"))\n            {\n                return sqlInstanceSetupKey.GetValue("SQLDataRoot").ToString();\n            }\n        }\n    }\n}