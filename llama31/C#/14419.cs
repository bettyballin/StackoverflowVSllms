using System;\nusing System.Runtime.InteropServices;\nusing Microsoft.Vbe.Interop;\n\nnamespace VbaEditorAddin\n{\n    [ComVisible(true)]\n    [ClassInterface(ClassInterfaceType.AutoDispatch)]\n    public class VbaEditorAddin : IDTExtensibility2\n    {\n        private Application _vbe;\n\n        public void OnConnection(object application, ext_ConnectMode connectMode, object addInInst, ref Array custom)\n        {\n            _vbe = (Application)application;\n        }\n\n        public void OnDisconnection(ext_DisconnectMode disconnectMode, ref Array custom)\n        {\n            _vbe = null;\n        }\n\n        public void OnAddInsUpdate(ref Array custom)\n        {\n        }\n\n        public void OnStartupComplete(ref Array custom)\n        {\n            // Add custom menu items to the context menu\n            CommandBar menuBar = _vbe.CommandBars["Menu Bar"];\n            CommandBarControl menuItem = menuBar.Controls.Add(MsoControlType.msoControlButton);\n            menuItem.Caption = "My Menu Item";\n            menuItem.OnAction = "MyMacro";\n        }\n\n        public void OnBeginShutdown(ref Array custom)\n        {\n        }\n    }\n}