public bool Authorize(int objectId, string action)\n{\n    var claimsPrincipal = Thread.CurrentPrincipal as CustomClaimsPrincipal;\n    if (claimsPrincipal != null)\n    {\n        var permissions = claimsPrincipal.Identity.Permissions;\n        var permission = permissions.FirstOrDefault(p => p.ObjectId == objectId);\n        if (permission != null)\n        {\n            switch (action)\n            {\n                case "Read":\n                    return permission.Read;\n                case "Write":\n                    return permission.Write;\n                case "Delete":\n                    return permission.Delete;\n                case "Create":\n                    return permission.Create;\n                default:\n                    return false;\n            }\n        }\n    }\n    return false;\n}