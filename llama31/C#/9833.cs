using System;\nusing System.Net;\nusing System.IO;\nusing System.Security.Cryptography.X509Certificates;\nusing System.Net.Security;\n\npublic class SharePointFileDownloader\n{\n    private string _sharePointSiteUrl;\n    private string _username;\n    private string _password;\n    private string _fileUrl;\n\n    public SharePointFileDownloader(string sharePointSiteUrl, string username, string password, string fileUrl)\n    {\n        _sharePointSiteUrl = sharePointSiteUrl;\n        _username = username;\n        _password = password;\n        _fileUrl = fileUrl;\n    }\n\n    public void DownloadFile()\n    {\n        // Create a new instance of the WebClient class\n        using (var client = new WebClient())\n        {\n            // Set the credentials for the SharePoint site\n            client.Credentials = new NetworkCredential(_username, _password);\n\n            // Set the URL of the file to download\n            var fileUrl = $"{_sharePointSiteUrl}/_api/web/GetFileByServerRelativeUrl('{_fileUrl}')/$value";\n\n            // Set the headers\n            client.Headers.Add("Accept", "application/json;odata=verbose");\n            client.Headers.Add("X-FORMS_BASED_AUTH_ACCEPTED", "f");\n\n            // Download the file\n            var filePath = Path.Combine(Directory.GetCurrentDirectory(), Path.GetFileName(_fileUrl));\n            client.DownloadFile(fileUrl, filePath);\n        }\n    }\n}