var relatedVideos = (from v in db.Videos\n                     from t1 in v.Tags.Split(',')\n                     from t2 in db.Videos.Where(v2 => v2.VideoID != v.VideoID)\n                     from t3 in t2.Tags.Split(',')\n                     where t1 == t3\n                     group t2 by t2.VideoID into g\n                     select new { VideoID = g.Key, MatchCount = g.Count() })\n                     .OrderByDescending(x => x.MatchCount)\n                     .Take(10);