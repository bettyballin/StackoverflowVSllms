using System;\nusing System.ComponentModel;\nusing System.Windows.Forms;\n\npublic partial class Form1 : Form\n{\n    public Form1()\n    {\n        InitializeComponent();\n        backgroundWorker1.WorkerReportsProgress = true;\n        backgroundWorker1.DoWork += new DoWorkEventHandler(backgroundWorker1_DoWork);\n        backgroundWorker1.ProgressChanged += new ProgressChangedEventHandler(backgroundWorker1_ProgressChanged);\n    }\n\n    private void button1_Click(object sender, EventArgs e)\n    {\n        backgroundWorker1.RunWorkerAsync();\n    }\n\n    private void backgroundWorker1_DoWork(object sender, DoWorkEventArgs e)\n    {\n        foreach (System.IO.FileInfo f in dir.GetFiles("*.txt"))\n        {\n            // Do processing\n            // Show progress bar\n            backgroundWorker1.ReportProgress(0, f.Name);\n        }\n    }\n\n    private void backgroundWorker1_ProgressChanged(object sender, ProgressChangedEventArgs e)\n    {\n        label1.Text = e.UserState.ToString() + " is done processing, now processing...";\n    }\n}