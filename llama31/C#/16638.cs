using System;\nusing System.Runtime.InteropServices;\nusing System.Security.Principal;\n\nclass Program\n{\n    [DllImport("advapi32.dll", SetLastError = true, CharSet = CharSet.Unicode)]\n    static extern bool LogonUser(string lpszUsername, string lpszDomain, string lpszPassword, int dwLogonType, int dwLogonProvider, out IntPtr phToken);\n\n    [DllImport("kernel32.dll")]\n    static extern bool CloseHandle(IntPtr hObject);\n\n    static void Main(string[] args)\n    {\n        string adminUsername = "your_admin_username";\n        string adminPassword = "your_admin_password";\n        string domain = "your_domain";\n\n        IntPtr tokenHandle = IntPtr.Zero;\n\n        try\n        {\n            if (LogonUser(adminUsername, domain, adminPassword, 3, 0, out tokenHandle))\n            {\n                using (WindowsIdentity.Impersonate(tokenHandle))\n                {\n                    // Copy files here\n                    Console.WriteLine("Copying files...");\n                    // ...\n                }\n            }\n            else\n            {\n                Console.WriteLine("Logon failed: " + Marshal.GetLastWin32Error());\n            }\n        }\n        finally\n        {\n            if (tokenHandle != IntPtr.Zero)\n            {\n                CloseHandle(tokenHandle);\n            }\n        }\n    }\n}