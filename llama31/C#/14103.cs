using System;\nusing System.Runtime.InteropServices;\n\npublic class TreeViewHelper\n{\n    [DllImport("user32.dll")]\n    private static extern IntPtr SendMessage(IntPtr hWnd, uint Msg, IntPtr wParam, IntPtr lParam);\n\n    [DllImport("commctrl.dll")]\n    private static extern IntPtr TreeView_GetRoot(IntPtr hwnd);\n\n    [DllImport("commctrl.dll")]\n    private static extern int TreeView_GetCheckState(IntPtr hwnd, IntPtr hItem);\n\n    public static int GetCheckState(IntPtr hWnd)\n    {\n        IntPtr hItem = TreeView_GetRoot(hWnd);\n        return TreeView_GetCheckState(hWnd, hItem);\n    }\n}