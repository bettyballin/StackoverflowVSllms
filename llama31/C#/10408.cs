public class ResettableTextReader : TextReader\n{\n    private readonly TextReader _reader;\n    private readonly Stream _stream;\n    private readonly string _string;\n\n    public ResettableTextReader(TextReader reader)\n    {\n        _reader = reader;\n        if (reader is StreamReader streamReader)\n        {\n            _stream = streamReader.BaseStream;\n        }\n        else if (reader is StringReader stringReader)\n        {\n            _string = stringReader.ReadToEnd();\n        }\n        else\n        {\n            throw new NotSupportedException("Unsupported TextReader type");\n        }\n    }\n\n    public override int Read()\n    {\n        return _reader.Read();\n    }\n\n    public void Reset()\n    {\n        if (_stream != null)\n        {\n            _stream.Seek(0, SeekOrigin.Begin);\n        }\n        else\n        {\n            _reader = new StringReader(_string);\n        }\n    }\n}