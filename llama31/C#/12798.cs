using System;\nusing System.IO;\nusing System.Security.Cryptography;\nusing System.Text;\n\npublic class BluetoothSecureSocket\n{\n    private Aes _aes;\n\n    public BluetoothSecureSocket(byte[] key, byte[] iv)\n    {\n        _aes = Aes.Create();\n        _aes.Key = key;\n        _aes.IV = iv;\n    }\n\n    public string Encrypt(string data)\n    {\n        byte[] encryptedData;\n        using (ICryptoTransform encryptor = _aes.CreateEncryptor())\n        {\n            using (MemoryStream ms = new MemoryStream())\n            {\n                using (CryptoStream cs = new CryptoStream(ms, encryptor, CryptoStreamMode.Write))\n                {\n                    using (StreamWriter sw = new StreamWriter(cs))\n                    {\n                        sw.Write(data);\n                    }\n                    encryptedData = ms.ToArray();\n                }\n            }\n        }\n        return Convert.ToBase64String(encryptedData);\n    }\n\n    public string Decrypt(string encryptedData)\n    {\n        byte[] decryptedData;\n        using (ICryptoTransform decryptor = _aes.CreateDecryptor())\n        {\n            using (MemoryStream ms = new MemoryStream(Convert.FromBase64String(encryptedData)))\n            {\n                using (CryptoStream cs = new CryptoStream(ms, decryptor, CryptoStreamMode.Read))\n                {\n                    using (StreamReader sr = new StreamReader(cs))\n                    {\n                        decryptedData = Encoding.UTF8.GetBytes(sr.ReadToEnd());\n                    }\n                }\n            }\n        }\n        return Encoding.UTF8.GetString(decryptedData);\n    }\n}