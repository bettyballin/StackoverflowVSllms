SmtpClient smtp = new SmtpClient(MailServer);\nsmtp.SendCompleted += new SendCompletedEventHandler(MailSentCallback);\nsmtp.SendAsync(mailMsg, myAttachment); // pass attachment path as userToken\n\nprivate static void MailSentCallback(object sender, AsyncCompletedEventArgs e)\n{\n    if (e.Error != null)\n    {\n        // handle error\n    }\n    else\n    {\n        string attachmentPath = (string)e.UserState;\n        File.Delete(attachmentPath);\n    }\n    mailMsg.Dispose(); // dispose mailMsg here\n}