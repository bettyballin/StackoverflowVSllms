public class SecureSiteMapProvider : SiteMapProvider\n{\n    public override SiteMapNodeCollection GetChildNodes(SiteMapNode node)\n    {\n        // Get the current user's roles\n        var roles = HttpContext.Current.User.GetRoles();\n\n        // Filter the child nodes based on the user's roles\n        var filteredNodes = node.ChildNodes.Cast<SiteMapNode>()\n            .Where(n => n.Roles.Any(r => roles.Contains(r)));\n\n        return new SiteMapNodeCollection(filteredNodes);\n    }\n}