using System;\nusing System.IO;\nusing System.Xml;\nusing System.Xml.Xsl;\nusing System.Xml.XPath;\nusing HtmlAgilityPack;\n\npublic class TransformXML\n{\n    public static void Main(string[] args)\n    {\n        try\n        {\n            string sourceDoc = "C:\\CDA_Doc.xml";\n            string resultDoc = "C:\\Result.html";\n            string xsltDoc = "C:\\CDA.xsl";\n\n            XPathDocument myXPathDocument = new XPathDocument(sourceDoc);\n            XslCompiledTransform myXslTransform = new XslCompiledTransform();\n\n            XmlTextWriter writer = new XmlTextWriter(resultDoc, null);\n            myXslTransform.Load(xsltDoc);\n\n            myXslTransform.Transform(myXPathDocument, null, writer);\n\n            writer.Close();\n\n            HtmlDocument htmlDoc = new HtmlDocument();\n            htmlDoc.Load(resultDoc);\n\n            string textContent = htmlDoc.DocumentNode.InnerText;\n\n            // Write the text content to a file in 80 character lines\n            using (StreamWriter textWriter = new StreamWriter("C:\\Result.txt"))\n            {\n                int charCount = 0;\n                foreach (char c in textContent)\n                {\n                    textWriter.Write(c);\n                    charCount++;\n                    if (charCount >= 80)\n                    {\n                        textWriter.WriteLine();\n                        charCount = 0;\n                    }\n                }\n            }\n        }\n        catch (Exception e)\n        {\n            Console.WriteLine("Exception: {0}", e.ToString());\n        }\n    }\n}