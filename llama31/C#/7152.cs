using Microsoft.Web.Administration;\n\npublic int GetSiteId(string siteName)\n{\n    using (ServerManager serverManager = new ServerManager())\n    {\n        SiteCollection sites = serverManager.Sites;\n        foreach (Site site in sites)\n        {\n            if (site.Name == siteName)\n            {\n                return site.Id;\n            }\n        }\n        throw new Exception($"Site '{siteName}' not found.");\n    }\n}