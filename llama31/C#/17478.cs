using System;\nusing System.Security.AccessControl;\nusing Microsoft.Win32;\n\npublic class RegistryKeyHelper\n{\n    public static void SetRegistryKey(string keyPath, string valueName, byte[] data)\n    {\n        using (RegistryKey key = Registry.CurrentUser.CreateSubKey(keyPath))\n        {\n            key.SetValue(valueName, data, RegistryValueKind.Binary);\n\n            // Set ACL to restrict access to current user\n            RegistrySecurity security = key.GetAccessControl();\n            security.AddAccessRule(new RegistryAccessRule(WindowsIdentity.GetCurrent().Name, RegistryRights.FullControl, AccessControlType.Allow));\n            key.SetAccessControl(security);\n        }\n    }\n\n    public static byte[] GetRegistryKey(string keyPath, string valueName)\n    {\n        using (RegistryKey key = Registry.CurrentUser.OpenSubKey(keyPath))\n        {\n            return (byte[])key.GetValue(valueName);\n        }\n    }\n}