[AspectConfiguration]\npublic class AuthorizationAspect : IAspect\n{\n    private readonly IAuthorizationService _authorizationService;\n\n    public AuthorizationAspect(IAuthorizationService authorizationService)\n    {\n        _authorizationService = authorizationService;\n    }\n\n    public void OnEntry(MethodExecutionArgs args)\n    {\n        var attribute = (AuthorizeAttribute)args.Method.GetCustomAttributes(typeof(AuthorizeAttribute), true).FirstOrDefault();\n        if (attribute != null)\n        {\n            var roles = attribute.Roles;\n            if (!_authorizationService.Authorize(roles, args.Method.Name))\n            {\n                throw new UnauthorizedAccessException();\n            }\n        }\n    }\n}