// Classic ASP (generate token)\nDim token = GenerateRandomToken()\nSession("authToken") = token\n\n// ASP.Net (verify token and authenticate user)\n[AllowAnonymous]\npublic ActionResult Token(string token)\n{\n    if (VerifyToken(token))\n    {\n        // Retrieve user details from database\n        var user = GetUserFromDatabase(token);\n        \n        // Generate new ASP.Net authentication token\n        var aspnetToken = FormsAuthentication.GetAuthCookie(user.Username, false);\n        \n        // Return the new token\n        return Json(new { token = aspnetToken.Value });\n    }\n    \n    return StatusCode(401);\n}\n\n// Helper methods\nprivate string GenerateRandomToken()\n{\n    // Implement a cryptographically secure random token generator\n}\n\nprivate bool VerifyToken(string token)\n{\n    // Check the token's validity (e.g., time-limited, matches the stored token)\n}\n\nprivate User GetUserFromDatabase(string token)\n{\n    // Retrieve the user's details from the database using the token\n}