using Microsoft.Telephony;\n\n// Initialize TAPI\nTAPI tapi = new TAPI();\n\n// Open the phone line\ntapi.OpenLine(" Phone Line Name ");\n\n// Set up event handlers\ntapi.OnNewCall += new TAPI.NewCallEventHandler(tapi_OnNewCall);\n\n// ...\n\n// Event handler to capture phone number\nvoid tapi_OnNewCall(object sender, TAPI.NewCallEventArgs e)\n{\n    // Get the caller ID\n    string phoneNumber = e.Call.CallerID;\n    // Process the phone number...\n}