using System;\nusing System.Runtime.InteropServices;\nusing System.Threading;\n\npublic static class DoEventsHelper\n{\n    [DllImport("user32.dll")]\n    private static extern bool PeekMessage(IntPtr lpMsg, IntPtr hWnd, uint wMsgFilterMin, uint wMsgFilterMax, uint wRemoveMsg);\n\n    public static void DoEvents()\n    {\n        while (PeekMessage(IntPtr.Zero, IntPtr.Zero, 0, 0, 1))\n        {\n            Thread.Sleep(0);\n        }\n    }\n}