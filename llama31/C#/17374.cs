using System;\nusing System.Runtime.InteropServices;\n\nclass MouseHook\n{\n    [DllImport("user32.dll")]\n    static extern IntPtr SetWindowsHookEx(int idHook, LowLevelMouseProc callback, IntPtr hInstance, uint threadId);\n\n    [DllImport("user32.dll")]\n    static extern bool UnhookWindowsHookEx(IntPtr idHook);\n\n    [DllImport("user32.dll")]\n    static extern IntPtr CallNextHookEx(IntPtr idHook, int nCode, IntPtr wParam, IntPtr lParam);\n\n    private delegate int LowLevelMouseProc(int nCode, IntPtr wParam, IntPtr lParam);\n\n    private IntPtr _hookId;\n\n    public MouseHook()\n    {\n        _hookId = SetWindowsHookEx(7, HookCallback, IntPtr.Zero, 0);\n    }\n\n    private int HookCallback(int nCode, IntPtr wParam, IntPtr lParam)\n    {\n        if (nCode >= 0 && wParam == (IntPtr)0x0201) // WM_LBUTTONDOWN\n        {\n            Console.WriteLine("Left mouse button pressed at: " + Marshal.ReadInt32(lParam));\n        }\n        return CallNextHookEx(_hookId, nCode, wParam, lParam);\n    }\n\n    ~MouseHook()\n    {\n        UnhookWindowsHookEx(_hookId);\n    }\n}