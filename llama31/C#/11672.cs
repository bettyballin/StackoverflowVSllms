using System.Management;\n\npublic int GetSiteId(string siteName)\n{\n    ManagementScope scope = new ManagementScope("root\\WebAdministration");\n    ObjectQuery query = new ObjectQuery($"SELECT * FROM Site WHERE Name = '{siteName}'");\n    ManagementObjectSearcher searcher = new ManagementObjectSearcher(scope, query);\n    ManagementObjectCollection results = searcher.Get();\n    foreach (ManagementObject result in results)\n    {\n        return Convert.ToInt32(result["ID"]);\n    }\n    throw new Exception($"Site '{siteName}' not found.");\n}