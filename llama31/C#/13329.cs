public class CustomAuthModule : IHttpModule\n{\n    public void Init(HttpApplication context)\n    {\n        context.AuthenticateRequest += new EventHandler(OnAuthenticateRequest);\n    }\n\n    private void OnAuthenticateRequest(object sender, EventArgs e)\n    {\n        HttpApplication app = (HttpApplication)sender;\n        HttpContext context = app.Context;\n\n        if (!context.User.Identity.IsAuthenticated)\n        {\n            // Redirect to login page\n            context.Response.Redirect("~/Login.aspx");\n        }\n    }\n\n    public void Dispose() { }\n}