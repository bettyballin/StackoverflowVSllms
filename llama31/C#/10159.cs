using System.Collections.Generic;\nusing System.Data.SqlClient;\n\npublic class BookRepository\n{\n    public List<IBook> GetBooks()\n    {\n        List<IBook> books = new List<IBook>();\n\n        using (SqlConnection connection = new SqlConnection("YourConnectionString"))\n        {\n            connection.Open();\n\n            SqlCommand command = new SqlCommand("SELECT * FROM Books", connection);\n            SqlDataReader reader = command.ExecuteReader();\n\n            while (reader.Read())\n            {\n                IBook book = new Book\n                {\n                    Somethingelse = reader["Somethingelse"].ToString(),\n                    ProductList = GetProducts(reader["BookId"].ToString())\n                };\n\n                books.Add(book);\n            }\n\n            reader.Close();\n        }\n\n        return books;\n    }\n\n    private List<IProduct> GetProducts(string bookId)\n    {\n        List<IProduct> products = new List<IProduct>();\n\n        using (SqlConnection connection = new SqlConnection("YourConnectionString"))\n        {\n            connection.Open();\n\n            SqlCommand command = new SqlCommand("SELECT * FROM Products WHERE BookId = @BookId", connection);\n            command.Parameters.AddWithValue("@BookId", bookId);\n            SqlDataReader reader = command.ExecuteReader();\n\n            while (reader.Read())\n            {\n                IProduct product = new Product\n                {\n                    Somethingelse = reader["Somethingelse"].ToString(),\n                    SpecialOptionsList = GetSpecialOptions(reader["ProductId"].ToString())\n                };\n\n                products.Add(product);\n            }\n\n            reader.Close();\n        }\n\n        return products;\n    }\n\n    private List<ISpecialOptions> GetSpecialOptions(string productId)\n    {\n        List<ISpecialOptions> specialOptions = new List<ISpecialOptions>();\n\n        using (SqlConnection connection = new SqlConnection("YourConnectionString"))\n        {\n            connection.Open();\n\n            SqlCommand command = new SqlCommand("SELECT * FROM SpecialOptions WHERE ProductId = @ProductId", connection);\n            command.Parameters.AddWithValue("@ProductId", productId);\n            SqlDataReader reader = command.ExecuteReader();\n\n            while (reader.Read())\n            {\n                ISpecialOptions specialOption = new SpecialOptions\n                {\n                    SpecialOptionsProperty = reader["SpecialOptionsProperty"].ToString()\n                };\n\n                specialOptions.Add(specialOption);\n            }\n\n            reader.Close();\n        }\n\n        return specialOptions;\n    }\n}