using System.Web.Mvc;\nusing System.Text.RegularExpressions;\n\npublic class BotFilterAttribute : ActionFilterAttribute\n{\n    private const string HoneypotFieldName = "bot_trap";\n\n    public override void OnActionExecuting(ActionExecutingContext filterContext)\n    {\n        var request = filterContext.HttpContext.Request;\n        var honeypotValue = request.Form[HoneypotFieldName];\n\n        if (!string.IsNullOrEmpty(honeypotValue))\n        {\n            // Bot detected, redirect or throw an exception\n            filterContext.Result = new HttpUnauthorizedResult();\n            return;\n        }\n\n        var formFillTime = DateTime.Now - (DateTime)request.Session["FormStarted"];\n        if (formFillTime < TimeSpan.FromSeconds(5))\n        {\n            // Bot detected, redirect or throw an exception\n            filterContext.Result = new HttpUnauthorizedResult();\n            return;\n        }\n\n        var userAgent = request.UserAgent;\n        var botPattern = new Regex("bot|spider|crawler", RegexOptions.IgnoreCase);\n        if (botPattern.IsMatch(userAgent))\n        {\n            // Bot detected, redirect or throw an exception\n            filterContext.Result = new HttpUnauthorizedResult();\n            return;\n        }\n\n        base.OnActionExecuting(filterContext);\n    }\n}