using System.Security.Principal;\nusing System.Runtime.InteropServices;\n\n// Assume userId is passed as a parameter to your web service method\nstring userId = "domain\\username";\n\n// Get the Windows identity for the user\nWindowsIdentity identity = new WindowsIdentity(userId);\n\n// Impersonate the user\nusing (identity.Impersonate())\n{\n    // Access the files/folders as the impersonated user\n    string[] files = Directory.GetFiles("\\\\fileserver\\share");\n    // ...\n}