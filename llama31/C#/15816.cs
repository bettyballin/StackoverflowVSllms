using System;\nusing System.Windows;\nusing System.Text.RegularExpressions;\n\nclass Program\n{\n    [STAThread]\n    static void Main(string[] args)\n    {\n        Console.WriteLine("Copy a small amount of text from a browser, then press enter.");\n        Console.ReadLine();\n\n        var text = Clipboard.GetText();\n        Console.WriteLine();\n        Console.WriteLine("--->The clipboard as Text:");\n        Console.WriteLine(text);\n\n        Console.WriteLine();\n        Console.WriteLine("--->Rewriting clipboard with the same CF_HTML data.");\n        var html = Clipboard.GetText(TextDataFormat.Html);\n        var match = Regex.Match(html, @"Version:1\.0\r\nStartHTML:\d+\r\nEndHTML:\d+\r\nStartFragment:\d+\r\nEndFragment:\d+\r\n\r\n(.*)", RegexOptions.Singleline);\n        if (match.Success)\n        {\n            var htmlData = match.Groups[1].Value;\n            Clipboard.Clear();\n            Clipboard.SetText(htmlData, TextDataFormat.Html);\n        }\n        else\n        {\n            Console.WriteLine("Failed to parse CF_HTML data.");\n        }\n\n        var text2 = Clipboard.GetText();\n        Console.WriteLine();\n        Console.WriteLine("--->The clipboard as Text:");\n        Console.WriteLine(text2);\n\n        var isSameText = (text == text2);\n        Console.WriteLine();\n        Console.WriteLine(isSameText ? "Success" : "Failure");\n\n        Console.WriteLine();\n        Console.WriteLine("Press enter to exit.");\n        Console.ReadLine();\n    }\n}