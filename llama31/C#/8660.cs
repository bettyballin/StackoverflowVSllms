using System;\nusing System.Diagnostics;\n\npublic class ExcelVersionDetector\n{\n    public static string GetExcelVersion()\n    {\n        string excelPath = GetExcelPath();\n        if (string.IsNullOrEmpty(excelPath))\n        {\n            return "Excel not found";\n        }\n\n        FileVersionInfo versionInfo = FileVersionInfo.GetVersionInfo(excelPath);\n        string version = versionInfo.ProductVersion;\n        string servicePack = versionInfo.ProductName.Contains("Service Pack") ? versionInfo.ProductName.Split(new[] { "Service Pack" }, StringSplitOptions.None)[1].Trim() : "";\n\n        return $"Excel {version} {servicePack}";\n    }\n\n    private static string GetExcelPath()\n    {\n        string[] paths = new[]\n        {\n            @"C:\Program Files\Microsoft Office\root\Office16\EXCEL.EXE",\n            @"C:\Program Files (x86)\Microsoft Office\root\Office16\EXCEL.EXE",\n            @"C:\Program Files\Microsoft Office\Office15\EXCEL.EXE",\n            @"C:\Program Files (x86)\Microsoft Office\Office15\EXCEL.EXE",\n            @"C:\Program Files\Microsoft Office\Office14\EXCEL.EXE",\n            @"C:\Program Files (x86)\Microsoft Office\Office14\EXCEL.EXE",\n        };\n\n        foreach (string path in paths)\n        {\n            if (File.Exists(path))\n            {\n                return path;\n            }\n        }\n\n        return null;\n    }\n}