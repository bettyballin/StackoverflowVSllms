using Microsoft.Win32;\nusing System.Security.AccessControl;\n\nstring keyName = @"SOFTWARE\Microsoft\Windows\CurrentVersion\Run";\nRegistryKey key = Registry.CurrentUser.OpenSubKey(keyName);\n\nif (key != null)\n{\n    RegistrySecurity security = key.GetAccessControl();\n\n    // Check if the current user has write access\n    AuthorizationRuleCollection rules = security.GetAccessRules(true, true, typeof(System.Security.Principal.NTAccount));\n    foreach (RegistryAccessRule rule in rules)\n    {\n        if (rule.IdentityReference.Value == System.Security.Principal.WindowsIdentity.GetCurrent().Name)\n        {\n            if ((rule.RegistryRights & RegistryRights.WriteKey) == RegistryRights.WriteKey)\n            {\n                Console.WriteLine("Current user has write access to the key.");\n            }\n            else\n            {\n                Console.WriteLine("Current user does not have write access to the key.");\n            }\n        }\n    }\n}