using System.Text.RegularExpressions;\n\npublic static string EnsureWordLength(this string target, int length)\n{\n    // Find all HTML tags\n    var tags = Regex.Matches(target, "<.*?>");\n\n    // Replace HTML tags with a placeholder\n    var plainText = Regex.Replace(target, "<.*?>", "#####");\n\n    // Split the string into words of a specified length\n    var words = new List<string>();\n    for (int i = 0; i < plainText.Length; i += length)\n    {\n        words.Add(plainText.Substring(i, Math.Min(length, plainText.Length - i)));\n    }\n\n    // Replace the placeholder with the original HTML tags\n    var result = string.Join(" ", words);\n    for (int i = 0; i < tags.Count; i++)\n    {\n        result = result.Replace("#####", tags[i].Value, StringComparison.Ordinal);\n    }\n\n    return result;\n}