using System.Diagnostics;\n\npublic class InstallerClass\n{\n    public void CheckIISVersion()\n    {\n        Process process = new Process();\n        process.StartInfo.FileName = "wmic";\n        process.StartInfo.Arguments = "path win32_service get name, version";\n        process.StartInfo.UseShellExecute = false;\n        process.StartInfo.RedirectStandardOutput = true;\n        process.Start();\n\n        string output = process.StandardOutput.ReadToEnd();\n        process.WaitForExit();\n\n        if (output.Contains("IISADMIN") && output.Contains("6.0") || output.Contains("7.0") || output.Contains("8.0") || output.Contains("10.0"))\n        {\n            // IIS supports application pools, proceed with creation\n        }\n        else\n        {\n            // IIS does not support application pools, handle accordingly\n        }\n    }\n}