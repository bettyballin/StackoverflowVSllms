using System;\nusing System.DirectoryServices.Protocols;\n\nclass LdapExample\n{\n    public static void Main(string[] args)\n    {\n        // Specify the LDAP server and port\n        string ldapServer = "ldap.example.com";\n        int ldapPort = 389;\n\n        // Create a new LDAP connection\n        LdapConnection connection = new LdapConnection(new LdapDirectoryIdentifier(ldapServer, ldapPort));\n\n        try\n        {\n            // Bind to the LDAP server\n            connection.Bind(new NetworkCredential("username", "password"));\n\n            // Perform an LDAP search\n            SearchRequest request = new SearchRequest("dc=example,dc=com", "(objectClass=*)", SearchScope.Subtree);\n            SearchResponse response = connection.SendRequest(request) as SearchResponse;\n\n            // Print the results\n            foreach (SearchResultEntry entry in response.Entries)\n            {\n                Console.WriteLine(entry.DistinguishedName);\n            }\n        }\n        catch (LdapException ex)\n        {\n            Console.WriteLine(ex.Message);\n        }\n        finally\n        {\n            // Unbind from the LDAP server\n            connection.Unbind();\n            connection.Dispose();\n        }\n    }\n}