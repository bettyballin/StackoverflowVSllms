using System.Data.SqlClient;\nusing System.Data;\n\npublic class UserRepository\n{\n    public IEnumerable<int> GetUserIdsByNames(string[] names)\n    {\n        using (var connection = new SqlConnection("your connection string"))\n        {\n            connection.Open();\n\n            var command = new SqlCommand("GetUserIdsByNames", connection);\n            command.CommandType = CommandType.StoredProcedure;\n\n            var nameTable = new DataTable();\n            nameTable.Columns.Add("Name", typeof(string));\n\n            foreach (var name in names)\n            {\n                nameTable.Rows.Add(name);\n            }\n\n            var parameter = new SqlParameter("@Names", SqlDbType.Structured);\n            parameter.TypeName = "NameTableType";\n            parameter.Value = nameTable;\n\n            command.Parameters.Add(parameter);\n\n            using (var reader = command.ExecuteReader())\n            {\n                while (reader.Read())\n                {\n                    yield return reader.GetInt32(0);\n                }\n            }\n        }\n    }\n}