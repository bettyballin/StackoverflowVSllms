var binding = new NetTcpBinding();\nbinding.Security.Mode = SecurityMode.Message;\nbinding.Security.Message.AlgorithmSuite = SecurityAlgorithmSuite.Basic128;\nbinding.Security.Message.ClientCredentialType = MessageCredentialType.Windows;\n\nvar upn = "usertest@testdomain.com";\nvar ep = new EndpointAddress(new Uri("net.tcp://server1.testdomain.com:1111/ServiceTest"), EndpointIdentity.CreateUpnIdentity(upn));\n\nvar factory = new ChannelFactory<ICredentialTest>(binding, ep);\nfactory.Credentials.Windows.AllowNtlm = false;\nfactory.Credentials.Windows.AllowedImpersonationLevel = TokenImpersonationLevel.Delegation;