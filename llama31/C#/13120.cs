using System;\nusing System.DirectoryServices.Protocols;\n\npublic class AdamRandomRecordSelector\n{\n    private readonly string _adamServer;\n    private readonly string _ouDn; // OU distinguishedName where you want to search\n\n    public AdamRandomRecordSelector(string adamServer, string ouDn)\n    {\n        _adamServer = adamServer;\n        _ouDn = ouDn;\n    }\n\n    public string GetRandomRecordDn()\n    {\n        // Create a new LDAP connection\n        using (var connection = new LdapConnection(_adamServer))\n        {\n            // Bind to the directory\n            connection.Bind();\n\n            // Define the search request\n            var searchRequest = new SearchRequest\n            {\n                DistinguishedName = _ouDn,\n                Scope = SearchScope.Subtree,\n                Filter = "(objectClass=*)", // Search all objects\n                SizeLimit = 1, // Return only one record\n            };\n\n            // Add a control to randomize the results\n            var randomControl = new DirectoryControl("1.2.840.113556.1.4.417", new byte[] { 1 }, false, true);\n            searchRequest.Controls.Add(randomControl);\n\n            // Execute the search\n            var response = connection.SendRequest(searchRequest) as SearchResponse;\n\n            // Return the DN of the first (and only) result\n            return response.Entries[0].DistinguishedName;\n        }\n    }\n}