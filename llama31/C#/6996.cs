var users = db.Users;\nvar workplans = db.Workplans;\nvar projects = db.Projects;\n\n// Query 1\nvar recentWorkplans = from u in users\n                      join mw in (\n                        from w in workplans\n                        group w by w.UserID into g\n                        select new { g.Key, MaxDate = g.Max(w => w.DateCreated) }\n                      ) on u.UserID equals mw.Key\n                      join w in workplans on mw.Key equals w.UserID\n                      where mw.MaxDate == w.DateCreated\n                      select new { u.UserID, w.WorkplanID, w.DateCreated };\n\n// Query 2\nvar userids = new int[] { 1, 2, 3 }; // pass the list of userids\nvar recentWorkplansForUsers = from u in users\n                             join mw in (\n                               from w in workplans\n                               where userids.Contains(w.UserID)\n                               group w by w.UserID into g\n                               select new { g.Key, MaxDate = g.Max(w => w.DateCreated) }\n                             ) on u.UserID equals mw.Key\n                             join w in workplans on mw.Key equals w.UserID\n                             where mw.MaxDate == w.DateCreated\n                             select new { u.UserID, w.WorkplanID, w.DateCreated };\n\n// Query 3\nvar currentProjectsForUsers = from p in projects\n                             join w in workplans on p.WorkplanID equals w.WorkplanID\n                             join mw in (\n                               from w in workplans\n                               where userids.Contains(w.UserID)\n                               group w by w.UserID into g\n                               select new { g.Key, MaxDate = g.Max(w => w.DateCreated) }\n                             ) on w.UserID equals mw.Key\n                             join u in users on mw.Key equals u.UserID\n                             where mw.MaxDate == w.DateCreated\n                             select new { p.ProjectID, p.Name, u.UserID };