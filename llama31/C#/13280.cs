using System.IO;\nusing System.Reflection;\nusing ESRI.ArcGIS.esriSystem;\n\n// ...\n\nprivate void RegisterDlls()\n{\n    // Get the output folder\n    string outputFolder = Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location);\n\n    // Iterate over DLL files in the output folder\n    foreach (string file in Directory.GetFiles(outputFolder, "*.dll"))\n    {\n        // Register the DLL\n        Assembly assembly = Assembly.LoadFrom(file);\n        Type[] types = assembly.GetTypes();\n        foreach (Type type in types)\n        {\n            if (typeof(ICommand).IsAssignableFrom(type))\n            {\n                // Register the command\n                AoInitialize.Initialize();\n                AoInitialize.Shutdown();\n                Marshal.ReleaseComObject(new ComClassFactory(type));\n            }\n        }\n    }\n}