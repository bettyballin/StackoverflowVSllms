using System.DirectoryServices;\n\n// Create a new DirectorySearcher object\nDirectorySearcher searcher = new DirectorySearcher();\n\n// Set the filter to search for all users\nsearcher.Filter = "(objectClass=user)";\n\n// Set the properties to retrieve\nsearcher.PropertiesToLoad.Add("samAccountName");\nsearcher.PropertiesToLoad.Add("displayName");\n\n// Search for users\nSearchResultCollection results = searcher.FindAll();\n\n// Loop through the results and get the user names\nforeach (SearchResult result in results)\n{\n    string userName = result.Properties["samAccountName"][0].ToString();\n    string displayName = result.Properties["displayName"][0].ToString();\n    // Do something with the user names...\n}