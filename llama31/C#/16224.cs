private void CheckSecurity(DirectoryInfo[] DIArray)\n{\n    foreach (DirectoryInfo di in DIArray)\n    {\n        try\n        {\n            DirectorySecurity DirSec = new DirectorySecurity(di.FullName, AccessControlSections.Access);\n            string sAccessInfo = string.Empty;\n\n            foreach (FileSystemAccessRule FSAR in DirSec.GetAccessRules(true, true, typeof(System.Security.Principal.NTAccount)))\n            {\n                sAccessInfo += GetAceInformation(FSAR);\n            }\n\n            if (sAccessInfo != string.Empty)\n            {\n                // Write info to text file\n            }\n        }\n        catch (UnauthorizedAccessException ex)\n        {\n            // Handle the exception\n            Console.WriteLine($"Error accessing folder {di.FullName}: {ex.Message}");\n        }\n    }\n}