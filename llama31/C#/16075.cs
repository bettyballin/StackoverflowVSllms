using Microsoft.BizTalk.ExplorerOM;\n\npublic string GetCurrentHostProcess()\n{\n    // Get the current process ID\n    int currentProcessId = System.Diagnostics.Process.GetCurrentProcess().Id;\n\n    // Get the BizTalk explorer\n    BtsCatalogExplorer explorer = new BtsCatalogExplorer();\n\n    // Connect to the BizTalk management database\n    explorer.ConnectionString = "Server=YourBizTalkServer;Database=BizTalkMgmtDb;Integrated Security=True";\n\n    // Get the host instances\n    BtsHostInstance[] hostInstances = explorer.HostInstances;\n\n    // Find the host instance that matches the current process ID\n    foreach (BtsHostInstance hostInstance in hostInstances)\n    {\n        if (hostInstance.ServiceStatus == ServiceStatus.Started && hostInstance.ProcessId == currentProcessId)\n        {\n            return hostInstance.Host.Name;\n        }\n    }\n\n    return null;\n}