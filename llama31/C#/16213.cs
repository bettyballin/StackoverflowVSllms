public static class SlidingWindow\n{\n    public static IEnumerable<T[,]> GetWindows<T>(T[,] array, int windowSize)\n    {\n        int rows = array.GetLength(0);\n        int cols = array.GetLength(1);\n\n        for (int i = 0; i <= rows - windowSize; i++)\n        {\n            for (int j = 0; j <= cols - windowSize; j++)\n            {\n                T[,] window = new T[windowSize, windowSize];\n\n                for (int k = 0; k < windowSize; k++)\n                {\n                    for (int l = 0; l < windowSize; l++)\n                    {\n                        window[k, l] = array[i + k, j + l];\n                    }\n                }\n\n                yield return window;\n            }\n        }\n    }\n}