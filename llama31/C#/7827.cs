public class HeaderInjectingBehavior : IOperationBehavior\n{\n    public void ApplyDispatchBehavior(OperationDescription operationDescription, DispatchOperation dispatchOperation)\n    {\n        dispatchOperation.ParameterInspectors.Add(new HeaderInjectingInspector());\n    }\n\n    public class HeaderInjectingInspector : IParameterInspector\n    {\n        public void AfterCall(string operationName, object[] outputs, object returnValue, object correlationState)\n        {\n        }\n\n        public object BeforeCall(string operationName, object[] inputs)\n        {\n            var factoryIdFromHeader = WebOperationContext.Current.IncomingRequest.Headers["factoryId"];\n            // Inject the factoryId into the surrogate object\n            inputs[0].FactoryId = factoryIdFromHeader;\n            return null;\n        }\n    }\n}