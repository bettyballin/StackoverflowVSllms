using System;\nusing System.Drawing;\nusing System.Drawing.Imaging;\nusing System.Runtime.InteropServices;\n\npublic class ScreenCapture\n{\n    [DllImport("user32.dll")]\n    private static extern bool PrintWindow(IntPtr hWnd, IntPtr hdcBlt, int nFlags);\n\n    public static Bitmap CaptureWindow(IntPtr hWnd)\n    {\n        // Create a new bitmap to hold the captured image\n        Bitmap bmp = new Bitmap(1024, 768); // adjust size as needed\n\n        // Create a graphics object from the bitmap\n        using (Graphics g = Graphics.FromImage(bmp))\n        {\n            // Get the device context of the graphics object\n            IntPtr hdc = g.GetHdc();\n\n            // Send the WM_PRINT message to the window\n            PrintWindow(hWnd, hdc, 0);\n\n            // Release the device context\n            g.ReleaseHdc(hdc);\n        }\n\n        return bmp;\n    }\n}