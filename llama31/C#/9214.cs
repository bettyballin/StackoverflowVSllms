using System.Windows;\nusing System.Windows.Controls;\nusing System.Windows.Documents;\n\npublic class HtmlTextBlock : TextBlock\n{\n    public string Html\n    {\n        get { return (string)GetValue(HtmlProperty); }\n        set { SetValue(HtmlProperty, value); }\n    }\n\n    public static readonly DependencyProperty HtmlProperty = DependencyProperty.Register("Html", typeof(string), typeof(HtmlTextBlock), new PropertyMetadata("", HtmlChanged));\n\n    private static void HtmlChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)\n    {\n        HtmlTextBlock textBlock = (HtmlTextBlock)d;\n        string html = (string)e.NewValue;\n\n        textBlock.Inlines.Clear();\n        Run run = new Run();\n\n        html = html.Replace("<b>", "<Bold>");\n        html = html.Replace("</b>", "</Bold>");\n        html = html.Replace("<i>", "<Italic>");\n        html = html.Replace("</i>", "</Italic>");\n        html = html.Replace("<a ", "<Hyperlink ");\n        html = html.Replace("</a>", "</Hyperlink>");\n\n        html = html.Replace("<Bold>", "<Bold><Run FontWeight='Bold'>");\n        html = html.Replace("</Bold>", "</Run></Bold>");\n        html = html.Replace("<Italic>", "<Italic><Run FontStyle='Italic'>");\n        html = html.Replace("</Italic>", "</Run></Italic>");\n        html = html.Replace("<Hyperlink ", "<Hyperlink><Run ");\n        html = html.Replace("</Hyperlink>", "</Run></Hyperlink>");\n\n        textBlock.Inlines.Add(System.Windows.Markup.XamlReader.Parse(html));\n    }\n}