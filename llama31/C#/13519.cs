using Microsoft.WindowsMobile.PocketOutlook;\nusing Microsoft.WindowsMobile.PocketOutlook.Message;\n\nclass EmailAndSmsDeleter\n{\n    private readonly OutlookSession _outlookSession;\n\n    public EmailAndSmsDeleter()\n    {\n        _outlookSession = new OutlookSession();\n    }\n\n    public void DeleteEmailsAndSms()\n    {\n        // Delete emails\n        DeleteEmails(_outlookSession.EmailAccounts["Account Name"].Inbox);\n        DeleteEmails(_outlookSession.EmailAccounts["Account Name"].SentItems);\n        DeleteEmails(_outlookSession.EmailAccounts["Account Name"].Drafts);\n\n        // Delete SMSs\n        DeleteSms(_outlookSession.SmsAccounts["Account Name"].Inbox);\n        DeleteSms(_outlookSession.SmsAccounts["Account Name"].SentItems);\n        DeleteSms(_outlookSession.SmsAccounts["Account Name"].Drafts);\n    }\n\n    private void DeleteEmails(Folder folder)\n    {\n        foreach (EmailMessage message in folder.Items)\n        {\n            message.Delete();\n        }\n    }\n\n    private void DeleteSms(Folder folder)\n    {\n        foreach (SmsMessage message in folder.Items)\n        {\n            message.Delete();\n        }\n    }\n}