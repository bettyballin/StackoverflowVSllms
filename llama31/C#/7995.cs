private CompositionContainer _container;\n\npublic void Compose()\n{\n    var catalog = new AggregateCatalog();\n    catalog.Catalogs.Add(new AssemblyCatalog(System.Reflection.Assembly.GetExecutingAssembly()));\n    catalog.Catalogs.Add(new DirectoryCatalog("."));\n    _container = new CompositionContainer(catalog);\n\n    var batch = new CompositionBatch();\n    batch.AddPart(this);\n    _container.Compose(batch);\n}\n\npublic IAutocompleteRepository GetRepository()\n{\n    if (null != ConfigurationSettings.AppSettings["IsTesting"] && bool.Parse(ConfigurationSettings.AppSettings["IsTesting"]))\n    {\n        return _container.GetExports<IAutocompleteRepository>()\n            .Where(expDef => expDef.Metadata.Keys.Contains("IsTesting"))\n            .Single()\n            .GetExportedObject();\n    }\n    // Return a default repository or throw an exception\n}