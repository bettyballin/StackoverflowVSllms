public static IEnumerable<Range<T>> MergeAdjacent<T>(this IEnumerable<Range<T>> source, Func<T, T, bool> isAdjacent)\n{\n    using (var sourceIterator = source.GetEnumerator())\n    {\n        if (!sourceIterator.MoveNext())\n            yield break;\n\n        var current = sourceIterator.Current;\n\n        while (sourceIterator.MoveNext())\n        {\n            var next = sourceIterator.Current;\n\n            if (isAdjacent(current.End, next.Start))\n            {\n                current = Range.Create(current.Start, next.End);\n            }\n            else\n            {\n                yield return current;\n                current = next;\n            }\n        }\n\n        yield return current;\n    }\n}