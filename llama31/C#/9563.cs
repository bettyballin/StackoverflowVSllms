FileInfo file = new FileInfo(Path.Combine(_module.FileDir, _file.FilePath));\nResponse.ClearContent();\nResponse.ClearHeaders();\nResponse.ContentType = _file.ContentType;\nResponse.AppendHeader("Content-Disposition", "attachment; filename=" + Regex.Replace(_file.FilePath, "\\s", "-"));\nResponse.AppendHeader("Content-Length", file.Length.ToString());\ntry\n{\n    byte[] buffer = new byte[file.Length];\n    using (FileStream fs = file.OpenRead())\n    {\n        fs.Read(buffer, 0, buffer.Length);\n    }\n    Response.BinaryWrite(buffer);\n    Response.Flush();\n    Response.Close();\n}\ncatch\n{\n    Response.ClearContent();\n}