using AlphaVSS;\nusing System;\nusing System.IO;\n\nclass FileCopier\n{\n    public void CopyLockedFile(string sourcePath, string destinationPath)\n    {\n        using (var vss = new Vss())\n        {\n            vss.InitializeForBackup(null);\n            vss.SetBackupState(true, true, VssBackupType.FULL, false);\n            vss.GatherWriterMetadata();\n\n            using (var snapshot = vss.CreateSnapshot(sourcePath))\n            {\n                var snapshotPath = snapshot.SnapshotPath + Path.GetPathRoot(sourcePath);\n                File.Copy(snapshotPath + Path.GetFileName(sourcePath), destinationPath, true);\n            }\n        }\n    }\n}