public class BatchRepository\n{\n    public void ProcessBatch()\n    {\n        // Retrieve data from source system using SQL\n        var data = dbContext.SourceSystemRecords.SqlQuery("SELECT * FROM records");\n\n        // Perform transformations using business rules\n        var transformedData = data.Select(record => TransformRecord(record));\n\n        // Insert transformed data into target system using SQL\n        dbContext.TargetSystemRecords.SqlBulkInsert(transformedData);\n    }\n\n    private TransformedRecord TransformRecord(SourceSystemRecord record)\n    {\n        // Apply business rules to transform the record\n    }\n}