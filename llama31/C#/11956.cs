public bool ValidateSecretAnswer(string userName, string secretAnswer)\n{\n    using (SqlConnection connection = new SqlConnection(ConfigurationManager.ConnectionStrings["MembershipConnectionString"].ConnectionString))\n    {\n        connection.Open();\n\n        SqlCommand command = new SqlCommand("SELECT PasswordAnswer FROM aspnet_Membership WHERE UserId = (SELECT UserId FROM aspnet_Users WHERE LoweredUserName = @UserName)", connection);\n        command.Parameters.AddWithValue("@UserName", userName.ToLower());\n\n        string storedAnswer = (string)command.ExecuteScalar();\n\n        return storedAnswer == secretAnswer;\n    }\n}