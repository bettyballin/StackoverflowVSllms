using iTextSharp.text;\nusing iTextSharp.text.pdf;\nusing iTextSharp.tool.xml;\n\npublic void ExportHtmlToPdf(string html)\n{\n    using (var ms = new MemoryStream())\n    {\n        var doc = new Document();\n        PdfWriter.GetInstance(doc, ms);\n        doc.Open();\n\n        var htmlContext = new HtmlPipelineContext(null);\n        var htmlWorker = new HtmlPipeline(doc, htmlContext);\n\n        htmlWorker.Process(html);\n\n        doc.Close();\n\n        Response.ContentType = "application/pdf";\n        Response.AddHeader("content-disposition", "attachment;filename=document.pdf");\n        Response.OutputStream.Write(ms.ToArray(), 0, ms.ToArray().Length);\n        Response.End();\n    }\n}