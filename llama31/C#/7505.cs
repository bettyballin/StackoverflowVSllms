class MyClass\n{\n    private object _recordSet;\n    public object RecordSet\n    {\n        get { return _recordSet; }\n        set { _recordSet = value; }\n    }\n\n    public string Draw()\n    {\n        Type dataSourceType = _recordSet.GetType();\n        PropertyInfo countProperty = dataSourceType.GetProperty("Count");\n        int recordCount = (int)countProperty.GetValue(_recordSet, null);\n\n        PropertyInfo itemProperty = dataSourceType.GetProperty("Item");\n        for (int cont = 0; cont < recordCount; cont++)\n        {\n            object item = itemProperty.GetValue(_recordSet, new object[] { cont });\n            // Now you can access the properties of the item\n            PropertyInfo nameProperty = item.GetType().GetProperty("Name");\n            string name = (string)nameProperty.GetValue(item, null);\n        }\n    }\n}