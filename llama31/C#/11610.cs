public class MyWindow : Window\n{\n    private BackgroundWorker worker;\n\n    public MyWindow()\n    {\n        InitializeComponent();\n        StringRedir s = new StringRedir(ref ProgressTextBlock);\n        Console.SetOut(s);\n        Console.SetError(s);\n        this.DataContext = s;\n\n        worker = new BackgroundWorker();\n        worker.DoWork += worker_DoWork;\n        worker.RunWorkerCompleted += worker_RunWorkerCompleted;\n    }\n\n    private void Button_Click(object sender, RoutedEventArgs e)\n    {\n        worker.RunWorkerAsync();\n    }\n\n    private void worker_DoWork(object sender, DoWorkEventArgs e)\n    {\n        // Load tree view here\n    }\n\n    private void worker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)\n    {\n        // Update UI here\n    }\n}