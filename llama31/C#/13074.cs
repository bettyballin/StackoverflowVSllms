using System;\nusing System.Linq;\nusing Microsoft.CodeAnalysis;\nusing Microsoft.CodeAnalysis.CSharp;\nusing Microsoft.CodeAnalysis.CSharp.Syntax;\n\nclass VariableUsageChecker\n{\n    public bool IsVariableUsed(string projectPath, string variableName)\n    {\n        // Create a new workspace\n        var workspace = new AdhocWorkspace();\n\n        // Open the solution\n        var solution = workspace.OpenSolutionAsync(projectPath).Result;\n\n        // Get the compilation\n        var compilation = solution.Projects.First().GetCompilationAsync().Result;\n\n        // Find all references to the variable\n        var references = compilation.GetReferencesToSymbol(\n            compilation.GetTypeByMetadataName("Helper").GetMembers(variableName).First())\n            .Where(r => r.Location.IsInSource);\n\n        return references.Any();\n    }\n}