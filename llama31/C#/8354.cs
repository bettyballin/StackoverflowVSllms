[DllImport("user32.dll")]\nstatic extern bool GetLastInputInfo(ref IDLEINFO info);\n\n[StructLayout(LayoutKind.Sequential)]\npublic struct IDLEINFO\n{\n    public int size;\n    public uint tickCount;\n}\n\npublic class PresenceDetector\n{\n    public static bool IsUserPresent(int thresholdMinutes)\n    {\n        IDLEINFO info = new IDLEINFO();\n        info.size = Marshal.SizeOf(info);\n        GetLastInputInfo(ref info);\n\n        uint idleTime = (uint)Environment.TickCount - info.tickCount;\n        return idleTime < (uint)(thresholdMinutes * 60 * 1000);\n    }\n}