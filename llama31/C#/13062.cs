using System.IO;\nusing System.Security.AccessControl;\n\n// Set permissions for the Impersonated User account\nstring folderPath = @"C:\Example\Folder";\nDirectoryInfo folderInfo = new DirectoryInfo(folderPath);\nDirectorySecurity folderSecurity = folderInfo.GetAccessControl();\nfolderSecurity.AddAccessRule(new FileSystemAccessRule("ImpersonatedUser", FileSystemRights.Read, AccessControlType.Allow));\nfolderInfo.SetAccessControl(folderSecurity);\n\n// Set permissions for the Application Pool Identity\nstring batchFilePath = @"C:\Example\BatchFile.bat";\nFileInfo batchFileInfo = new FileInfo(batchFilePath);\nFileSecurity batchFileSecurity = batchFileInfo.GetAccessControl();\nbatchFileSecurity.AddAccessRule(new FileSystemAccessRule("ApplicationPoolIdentity", FileSystemRights.Execute, AccessControlType.Allow));\nbatchFileInfo.SetAccessControl(batchFileSecurity);