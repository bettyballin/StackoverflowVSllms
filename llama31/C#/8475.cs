using System.DirectoryServices;\n\npublic List<string> GetDepartmentNames(string domainName, string userName, string password)\n{\n    List<string> departmentNames = new List<string>();\n\n    using (DirectoryEntry entry = new DirectoryEntry("LDAP://" + domainName, userName, password))\n    {\n        using (DirectorySearcher searcher = new DirectorySearcher(entry))\n        {\n            searcher.Filter = "(objectClass=user)";\n            searcher.PropertiesToLoad.Add("department");\n\n            using (SearchResultCollection results = searcher.FindAll())\n            {\n                foreach (SearchResult result in results)\n                {\n                    if (result.Properties["department"].Count > 0)\n                    {\n                        string department = result.Properties["department"][0].ToString();\n                        if (!departmentNames.Contains(department))\n                        {\n                            departmentNames.Add(department);\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    return departmentNames;\n}