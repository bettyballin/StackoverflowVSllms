using System.IO;\n\nclass Program\n{\n    static readonly string configFileName = "email.config";\n\n    static int Main(string[] args)\n    {\n        try\n        {\n            string executablePath = Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().Location);\n            string configFilePath = Path.Combine(executablePath, configFileName);\n\n            var configMap = new ExeConfigurationFileMap { ExeConfigFilename = configFilePath };\n            Configuration externalConfig = ConfigurationManager.OpenMappedExeConfiguration(configMap, ConfigurationUserLevel.None);\n        }\n        catch (Exception e)\n        {\n            Console.WriteLine(e.Message);\n            return 1;\n        }\n    }\n}