using System.Net.Http;\nusing System.Net.Http.Headers;\n\n// Replace with your client's tenant ID\nstring tenantId = "client_tenant_id";\n\n// Replace with your client's client ID\nstring clientId = "client_client_id";\n\n// Replace with your client's client secret\nstring clientSecret = "client_client_secret";\n\n// Authenticate using client credentials\nvar token = GetAccessTokenAsync(tenantId, clientId, clientSecret).Result;\n\n// Create an HTTP client with the authentication token\nvar httpClient = new HttpClient();\nhttpClient.DefaultRequestHeaders.Authorization = new AuthenticationHeaderValue("Bearer", token);\n\n// Access the client's mailbox data\nvar response = httpClient.GetAsync("https://outlook.office365.com/api/v2.0/me/mailfolders/inbox/messages").Result;