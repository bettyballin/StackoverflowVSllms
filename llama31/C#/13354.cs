using System.Security.Principal;\n\npublic class Impersonator\n{\n    public static void ImpersonateUser(string userName, string password)\n    {\n        WindowsIdentity identity = new WindowsIdentity(userName, password);\n        WindowsImpersonationContext context = identity.Impersonate();\n\n        try\n        {\n            // Perform actions on behalf of the user\n        }\n        finally\n        {\n            context.Undo();\n        }\n    }\n}