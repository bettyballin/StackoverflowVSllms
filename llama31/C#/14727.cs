using System;\nusing System.Runtime.InteropServices;\n\nclass ComWrapper\n{\n    [DllImport("ole32.dll")]\n    static extern int CoCreateInstance(ref Guid clsid, \n        [MarshalAs(UnmanagedType.IUnknown)] object punkOuter, \n        int context, ref Guid iid, out IntPtr punk);\n\n    public static object CreateInstance(string progId)\n    {\n        Guid clsid = Type.GetTypeFromProgID(progId).GUID;\n        IntPtr punk;\n        CoCreateInstance(ref clsid, null, 1, ref clsid, out punk);\n        return Marshal.GetObjectForIUnknown(punk);\n    }\n}