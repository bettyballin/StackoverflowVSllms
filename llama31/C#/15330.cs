using System.IO;\nusing System.IO.Compression;\n\nprivate void writeReports(IReport[] reports, string[] reportNames)\n{\n    using (var zipStream = new MemoryStream())\n    {\n        using (var zipArchive = new ZipArchive(zipStream, ZipArchiveMode.Create))\n        {\n            for (int i = 0; i < reports.Length; i++)\n            {\n                string reportString = reports[i].makeReport();\n                var entry = zipArchive.CreateEntry(reportNames[i] + ".txt");\n                using (var writer = new StreamWriter(entry.Open()))\n                {\n                    writer.Write(reportString);\n                }\n            }\n        }\n\n        Response.ContentType = "application/zip";\n        Response.AddHeader("Content-Disposition", "attachment;filename=reports.zip");\n        Response.OutputStream.Write(zipStream.ToArray(), 0, zipStream.ToArray().Length);\n        Response.End();\n    }\n}