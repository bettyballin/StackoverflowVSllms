using MimeKit;\n\n// ...\n\npublic class MhtConverterTask : Task\n{\n    [Required]\n    public string InputHtmlFile { get; set; }\n\n    [Required]\n    public string OutputMhtFile { get; set; }\n\n    public override bool Execute()\n    {\n        var html = File.ReadAllText(InputHtmlFile);\n        var mht = new MultipartRelated();\n        mht.Add(new TextPart("html") { Text = html });\n\n        // Add images and CSS files\n        var imageFiles = Directory.GetFiles(".", "*.png");\n        foreach (var imageFile in imageFiles)\n        {\n            var image = new MimePart("image/png")\n            {\n                Content = new MimeContent(File.OpenRead(imageFile))\n            };\n            mht.Add(image);\n        }\n\n        var cssFiles = Directory.GetFiles(".", "*.css");\n        foreach (var cssFile in cssFiles)\n        {\n            var css = new MimePart("text/css")\n            {\n                Content = new MimeContent(File.OpenRead(cssFile))\n            };\n            mht.Add(css);\n        }\n\n        using (var output = File.Create(OutputMhtFile))\n        {\n            mht.WriteTo(output);\n        }\n\n        return true;\n    }\n}