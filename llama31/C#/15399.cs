public DbConnection GetConnection(String connectionName)\n{\n    // Get the connectionString information\n    ConnectionStringSettings cs = \n          ConfigurationManager.ConnectionStrings[connectionName];\n    if (cs == null)\n       throw new ConfigurationException("Invalid connection name \""+connectionName+"\"");\n\n    // Create a connection based on the provider\n    DbProviderFactory factory = DbProviderFactories.GetFactory(cs.ProviderName);\n    DbConnection conn = factory.CreateConnection();\n    conn.ConnectionString = cs.ConnectionString;\n    return conn;\n}