ServicePointManager.ServerCertificateValidationCallback = \n    (sender, certificate, chain, sslPolicyErrors) => {\n        if (sslPolicyErrors == SslPolicyErrors.None)\n            return true;\n\n        if ((sslPolicyErrors & SslPolicyErrors.RemoteCertificateNameMismatch) != 0) {\n            var urlHostname = sender.RequestUri.Host;\n            var certSubjectName = certificate.Subject;\n            var certSanNames = certificate.GetSubjectAlternativeNames();\n\n            if (certSanNames.Contains(urlHostname) || certSubjectName == urlHostname)\n                return true;\n        }\n\n        return false;\n    };