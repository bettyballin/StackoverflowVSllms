using System;\nusing System.Windows.Forms;\nusing System.IO;\n\npublic class ListViewExporter\n{\n    public static void ExportListViewToCSV(ListView listView, string filePath)\n    {\n        using (StreamWriter writer = new StreamWriter(filePath))\n        {\n            writer.WriteLine("sep=,"); // set separator to comma\n\n            // write column headers\n            for (int i = 0; i < listView.Columns.Count; i++)\n            {\n                writer.Write(listView.Columns[i].Text);\n                if (i < listView.Columns.Count - 1)\n                {\n                    writer.Write(",");\n                }\n            }\n            writer.WriteLine();\n\n            // write data rows\n            foreach (ListViewItem item in listView.Items)\n            {\n                for (int i = 0; i < item.SubItems.Count; i++)\n                {\n                    writer.Write(item.SubItems[i].Text);\n                    if (i < item.SubItems.Count - 1)\n                    {\n                        writer.Write(",");\n                    }\n                }\n                writer.WriteLine();\n            }\n        }\n    }\n}