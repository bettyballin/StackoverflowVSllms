public class ComWrapper\n{\n    [DllImport("yourcomdll.dll")]\n    private static extern void GetFoo(int bufferSize, IntPtr buffer);\n\n    public static void GetFooSafe(int[] buffer)\n    {\n        GCHandle bPin = GCHandle.Alloc(buffer, GCHandleType.Pinned);\n        try\n        {\n            GetFoo(buffer.Length, bPin.AddrOfPinnedObject());\n        }\n        finally\n        {\n            bPin.Free();\n        }\n    }\n}