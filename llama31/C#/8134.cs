using System.Xml.Linq;\n\npublic class CodebookIndex\n{\n    public List<MainEntry> MainEntries { get; set; }\n}\n\npublic class MainEntry\n{\n    public string Words { get; set; }\n    public int Score { get; set; }\n    public int Highscore { get; set; }\n    public List<string> Names { get; set; }\n    public string IE { get; set; }\n    public List<M1> M1s { get; set; }\n}\n\npublic class M1\n{\n    public string Words { get; set; }\n    public int Score { get; set; }\n    public string IE { get; set; }\n    public List<M2> M2s { get; set; }\n}\n\npublic class M2\n{\n    public string Words { get; set; }\n    public int Score { get; set; }\n    public string CF { get; set; }\n    public string IE { get; set; }\n}\n\npublic CodebookIndex ParseXml(string xml)\n{\n    var xdoc = XDocument.Parse(xml);\n    var codebookIndex = new CodebookIndex();\n\n    foreach (var me in xdoc.Descendants("ME"))\n    {\n        var mainEntry = new MainEntry\n        {\n            Words = me.Attribute("Words").Value,\n            Score = int.Parse(me.Attribute("Score").Value),\n            Highscore = int.Parse(me.Attribute("Highscore").Value),\n            Names = me.Elements("NM").Select(n => n.Value).ToList(),\n            IE = me.Element("IE").Value\n        };\n\n        mainEntry.M1s = me.Elements("M1").Select(m1 =>\n        {\n            var m1Entry = new M1\n            {\n                Words = m1.Attribute("Words").Value,\n                Score = int.Parse(m1.Attribute("Score").Value),\n                IE = m1.Element("IE").Value\n            };\n\n            m1Entry.M2s = m1.Elements("M2").Select(m2 =>\n            {\n                var m2Entry = new M2\n                {\n                    Words = m2.Attribute("Words").Value,\n                    Score = int.Parse(m2.Attribute("Score").Value),\n                    CF = m2.Element("CF").Value,\n                    IE = m2.Element("IE").Value\n                };\n\n                return m2Entry;\n            }).ToList();\n\n            return m1Entry;\n        }).ToList();\n\n        codebookIndex.MainEntries.Add(mainEntry);\n    }\n\n    return codebookIndex;\n}