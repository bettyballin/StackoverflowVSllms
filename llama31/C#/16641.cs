using Microsoft.SqlServer.TransactSql.ScriptDom;\nusing System;\nusing System.IO;\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        string sqlCode = "SELECT * FROM table1 WHERE column1 = 'value1'";\n        TSqlParser parser = new TSql120Parser(false);\n        using (StringReader reader = new StringReader(sqlCode))\n        {\n            TSqlFragment fragment = parser.Parse(reader, out IList<ParseError> errors);\n            if (errors.Count > 0)\n            {\n                foreach (var error in errors)\n                {\n                    Console.WriteLine(error.Message);\n                }\n                return;\n            }\n            Console.WriteLine(fragment.ToString());\n            TraverseFragment(fragment);\n        }\n    }\n\n    static void TraverseFragment(TSqlFragment fragment)\n    {\n        if (fragment is TSqlStatement statement)\n        {\n            Console.WriteLine($"Statement type: {statement.GetType().Name}");\n        }\n        if (fragment is TSqlScript script)\n        {\n            foreach (TSqlBatch batch in script.Batches)\n            {\n                TraverseFragment(batch);\n            }\n        }\n        else if (fragment is TSqlBatch batch)\n        {\n            foreach (TSqlStatement statement in batch.Statements)\n            {\n                TraverseFragment(statement);\n            }\n        }\n        else if (fragment is TSqlStatement statement)\n        {\n            foreach (TSqlFragment child in statement.ScriptTokenStream)\n            {\n                TraverseFragment(child);\n            }\n        }\n    }\n}