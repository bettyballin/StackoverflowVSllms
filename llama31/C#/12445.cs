using System;\nusing System.IO;\nusing System.Web;\n\npublic class FileEditHandler : IHttpHandler\n{\n    public void ProcessRequest(HttpContext context)\n    {\n        string filePath = context.Request.QueryString["filePath"];\n        string fileName = Path.GetFileName(filePath);\n\n        context.Response.Clear();\n        context.Response.ContentType = GetMimeType(fileName);\n        context.Response.AppendHeader("Content-Disposition", $"attachment; filename=\"{fileName}\"");\n\n        using (var fs = new FileStream(filePath, FileMode.Open))\n        {\n            fs.CopyTo(context.Response.OutputStream);\n        }\n    }\n\n    private string GetMimeType(string fileName)\n    {\n        // Return the MIME type based on the file extension\n        // For example:\n        if (fileName.EndsWith(".docx", StringComparison.OrdinalIgnoreCase))\n        {\n            return "application/vnd.openxmlformats-officedocument.wordprocessingml.document";\n        }\n        // Add more MIME types as needed\n    }\n}