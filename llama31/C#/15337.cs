using System.Diagnostics;\n\npublic class LockedFiles\n{\n    public static void Main(string[] args)\n    {\n        string folderPath = @"C:\Path\To\Folder";\n\n        foreach (Process process in Process.GetProcesses())\n        {\n            try\n            {\n                foreach (ProcessModule module in process.Modules)\n                {\n                    foreach (IntPtr handle in module.FileHandles)\n                    {\n                        string filePath = GetFilePathFromHandle(handle);\n                        if (filePath != null && filePath.StartsWith(folderPath, StringComparison.OrdinalIgnoreCase))\n                        {\n                            Console.WriteLine(filePath);\n                        }\n                    }\n                }\n            }\n            catch (Exception ex)\n            {\n                // handle exception\n            }\n        }\n    }\n\n    private static string GetFilePathFromHandle(IntPtr handle)\n    {\n        // implementation of GetFilePathFromHandle\n    }\n}