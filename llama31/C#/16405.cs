using System.Net.NetworkInformation;\n\nforeach (var nic in NetworkInterface.GetAllNetworkInterfaces())\n{\n    if (nic.OperationalStatus == OperationalStatus.Up)\n    {\n        var stats = nic.GetIPv4Statistics();\n        var bytesSent = stats.BytesSent;\n        var bytesReceived = stats.BytesReceived;\n\n        // Calculate throughput\n        var startTime = DateTime.Now;\n        System.Threading.Thread.Sleep(1000); // wait 1 second\n        var endTime = DateTime.Now;\n\n        var newStats = nic.GetIPv4Statistics();\n        var newBytesSent = newStats.BytesSent;\n        var newBytesReceived = newStats.BytesReceived;\n\n        var bytesSentPerSec = (newBytesSent - bytesSent) / (endTime - startTime).TotalSeconds;\n        var bytesReceivedPerSec = (newBytesReceived - bytesReceived) / (endTime - startTime).TotalSeconds;\n\n        Console.WriteLine($"Interface: {nic.Description}");\n        Console.WriteLine($"Bytes Sent/sec: {bytesSentPerSec}");\n        Console.WriteLine($"Bytes Received/sec: {bytesReceivedPerSec}");\n    }\n}