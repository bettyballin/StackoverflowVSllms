using System;\nusing System.Security.Principal;\nusing System.Security.AccessControl;\n\npublic class TaskSchedulerPermissions\n{\n    public static void GrantPermissions()\n    {\n        // Get the ASPNET account\n        NTAccount aspnetAccount = new NTAccount("ASPNET");\n\n        // Get the Task Scheduler group\n        NTAccount taskSchedulerGroup = new NTAccount("Task Scheduler");\n\n        // Get the SeBatchLogonRight and SeServiceLogonRight privileges\n        string[] privileges = new string[] { "SeBatchLogonRight", "SeServiceLogonRight" };\n\n        // Grant the ASPNET account the necessary permissions\n        foreach (string privilege in privileges)\n        {\n            using (var process = new System.Diagnostics.Process())\n            {\n                process.StartInfo.FileName = "ntrights.exe";\n                process.StartInfo.Arguments = $"-u {aspnetAccount.Value} +r {privilege}";\n                process.StartInfo.UseShellExecute = false;\n                process.StartInfo.RedirectStandardOutput = true;\n                process.StartInfo.RedirectStandardError = true;\n                process.Start();\n                process.WaitForExit();\n            }\n        }\n\n        // Add the ASPNET account to the Task Scheduler group\n        using (var process = new System.Diagnostics.Process())\n        {\n            process.StartInfo.FileName = "net.exe";\n            process.StartInfo.Arguments = $"localgroup {taskSchedulerGroup.Value} {aspnetAccount.Value} /add";\n            process.StartInfo.UseShellExecute = false;\n            process.StartInfo.RedirectStandardOutput = true;\n            process.StartInfo.RedirectStandardError = true;\n            process.Start();\n            process.WaitForExit();\n        }\n    }\n}