using System.IO;\nusing System.Reflection;\n\npublic class PluginLoader\n{\n    private string _pluginDirectory;\n\n    public PluginLoader(string pluginDirectory)\n    {\n        _pluginDirectory = pluginDirectory;\n    }\n\n    public IEnumerable<IModule> LoadModules()\n    {\n        foreach (string file in Directory.GetFiles(_pluginDirectory, "*.dll"))\n        {\n            Assembly assembly = Assembly.LoadFrom(file);\n            foreach (Type type in assembly.GetTypes())\n            {\n                if (typeof(IModule).IsAssignableFrom(type))\n                {\n                    IModule module = (IModule)Activator.CreateInstance(type);\n                    yield return module;\n                }\n            }\n        }\n    }\n}