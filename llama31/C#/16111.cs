using System;\nusing System.Runtime.InteropServices;\n\nclass VistaEditionDetector\n{\n    [DllImport("kernel32.dll", SetLastError = true)]\n    static extern bool GetProductInfo(int dwOSMajorVersion, int dwOSMinorVersion, int dwSpMajorVersion, int dwSpMinorVersion, out uint pdwReturnedProductType);\n\n    public static string GetVistaEdition()\n    {\n        uint productType;\n        GetProductInfo(6, 0, 0, 0, out productType);\n        switch (productType)\n        {\n            case 1:\n                return "Ultimate";\n            case 2:\n                return "Home Basic";\n            case 3:\n                return "Home Premium";\n            case 4:\n                return "Enterprise";\n            case 6:\n                return "Business";\n            default:\n                return "Unknown";\n        }\n    }\n\n    public static void Main()\n    {\n        Console.WriteLine(GetVistaEdition());\n    }\n}