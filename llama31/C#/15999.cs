using System;\nusing System.Runtime.InteropServices;\n\nclass Program\n{\n    [DllImport("advapi32.dll", SetLastError = true)]\n    static extern bool LogonUser(string lpszUsername, string lpszDomain, string lpszPassword, int dwLogonType, int dwLogonProvider, out IntPtr phToken);\n\n    [DllImport("kernel32.dll")]\n    static extern bool CloseHandle(IntPtr hObject);\n\n    const int LOGON32_LOGON_NETWORK = 3;\n    const int LOGON32_PROVIDER_DEFAULT = 0;\n\n    static void Main(string[] args)\n    {\n        string username = "joel";\n        string domain = "STACKOVERFLOW";\n        string password = "splotchy";\n\n        IntPtr token;\n        if (LogonUser(username, domain, password, LOGON32_LOGON_NETWORK, LOGON32_PROVIDER_DEFAULT, out token))\n        {\n            Console.WriteLine("Authentication successful");\n            CloseHandle(token);\n        }\n        else\n        {\n            Console.WriteLine("Authentication failed");\n        }\n    }\n}