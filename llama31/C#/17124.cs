static void castTest(myEnum val)\n{\n    // Call a native function that returns a pointer to a structure\n    IntPtr ptr = someNativeFunction(..params..);\n\n    // Create an instance of the type using the factory\n    object myStruct = StructureFactory.CreateStructure(val);\n\n    // Marshal the pointer to the structure\n    myStruct = Marshal.PtrToStructure(ptr, myStruct.GetType());\n}