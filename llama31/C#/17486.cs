using System.Security.Principal;\nusing System.Runtime.InteropServices;\n\npublic static ServiceControllerStatus FindService()\n{\n    ServiceControllerStatus status = ServiceControllerStatus.Stopped;\n\n    try\n    {\n        string machineName = ConfigurationManager.AppSettings["ServiceMachineName"];\n        string serviceName = ConfigurationManager.AppSettings["ServiceName"].ToLower();\n        string impersonationUsername = ConfigurationManager.AppSettings["ImpersonationUsername"];\n        string impersonationPassword = ConfigurationManager.AppSettings["ImpersonationPassword"];\n        string impersonationDomain = ConfigurationManager.AppSettings["ImpersonationDomain"];\n\n        // Impersonate the user with administrative privileges\n        using (WindowsIdentity identity = new WindowsIdentity(impersonationUsername, impersonationPassword, impersonationDomain))\n        {\n            using (WindowsImpersonationContext context = identity.Impersonate())\n            {\n                ServiceController[] services = ServiceController.GetServices(machineName);\n\n                foreach (ServiceController service in services)\n                {\n                    if (service.ServiceName.ToLower() == serviceName)\n                    {\n                        status = service.Status;\n                        break;\n                    }\n                }\n            }\n        }\n    }\n    catch (Exception ex)\n    {\n        status = ServiceControllerStatus.Stopped;\n        SaveError(ex, "Utilities - FindService()");\n    }\n\n    return status;\n}