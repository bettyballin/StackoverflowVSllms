using System;\nusing System.Text.RegularExpressions;\nusing System.Runtime.InteropServices;\n\npublic class WindowHandleFinder\n{\n    [DllImport("user32")]\n    private static extern bool EnumWindows(EnumWindowsProc enumProc, IntPtr lParam);\n\n    [DllImport("user32")]\n    private static extern int GetWindowText(IntPtr hWnd, StringBuilder text, int count);\n\n    private delegate bool EnumWindowsProc(IntPtr hWnd, IntPtr lParam);\n\n    public static IntPtr FindWindowHandle(string partialTitle)\n    {\n        IntPtr handle = IntPtr.Zero;\n\n        EnumWindowsProc enumProc = (hWnd, lParam) =>\n        {\n            StringBuilder text = new StringBuilder(256);\n            GetWindowText(hWnd, text, 256);\n            if (Regex.IsMatch(text.ToString(), $"^.*{partialTitle}.*$"))\n            {\n                handle = hWnd;\n                return false; // stop enumerating\n            }\n            return true;\n        };\n\n        EnumWindows(enumProc, IntPtr.Zero);\n        return handle;\n    }\n}