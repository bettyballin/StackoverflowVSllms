private static readonly object _dmsLock = new object();\n\npublic static IManDMS GetDMS()\n{\n    lock (_dmsLock)\n    {\n        IManDMS dms = HttpContext.Current.Application["DMS"] as IManage.IManDMS;\n        if (dms == null)\n        {\n            dms = new IManage.ManDMSClass();\n            HttpContext.Current.Application["DMS"] = dms;\n        }\n        return dms;\n    }\n}\n\npublic static IManSession GetSession(string serverName)\n{\n    lock (_dmsLock)\n    {\n        IManDMS dms = GetDMS();\n        IManSession s = dms.Sessions.Add(serverName);\n        s.TrustedLogin();\n        return s;\n    }\n}\n\n// Usage example:\npublic void DoSomethingWithSession(string serverName)\n{\n    IManSession session = GetSession(serverName);\n    try\n    {\n        // Do something with the session object, like retrieve documents.\n    }\n    finally\n    {\n        session.Logout();\n        IManDMS dms = GetDMS();\n        dms.Sessions.RemoveByObject(session);\n    }\n}