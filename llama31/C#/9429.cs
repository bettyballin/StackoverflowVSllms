using System.Web;\n\npublic class StaticFileModule : IHttpModule\n{\n    public void Init(HttpApplication context)\n    {\n        context.AuthenticateRequest += new EventHandler(OnAuthenticateRequest);\n    }\n\n    public void Dispose() { }\n\n    public void OnAuthenticateRequest(object sender, EventArgs e)\n    {\n        HttpApplication app = (HttpApplication)sender;\n        HttpRequest request = app.Request;\n        HttpResponse response = app.Response;\n\n        // Check permissions here\n        if (!HasPermission(request.Url))\n        {\n            response.StatusCode = 403;\n            response.StatusDescription = "Forbidden";\n            response.End();\n            return;\n        }\n\n        // Delegate to IIS to serve the file\n        response.TransmitFile(request.Url.AbsolutePath);\n    }\n\n    private bool HasPermission(string url)\n    {\n        // Implement your permission checking logic here\n        // Return true if the user has permission, false otherwise\n    }\n}