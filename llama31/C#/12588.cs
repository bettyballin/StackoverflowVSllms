cmd.CommandText = "EXEC [dbo].insert_test_result @executed, @failure, @success, @testID, @time, @name";\n\n// ...\n\ncmd.Parameters.Add("@name", SqlDbType.VarChar);\ncmd.Parameters["@name"].Value = result.Name;\n\nif (result.Description != null)\n{\n    cmd.CommandText += ", @description";\n    cmd.Parameters.Add("@description", SqlDbType.VarChar);\n    cmd.Parameters["@description"].Value = result.Description;\n}\n\n// ... (repeat for other parameters)\n\nconnection.Open();\ncmd.ExecuteNonQuery();