using System;\nusing System.Windows.Forms;\nusing System.Runtime.InteropServices;\n\npublic class WebBrowserHelper\n{\n    [DllImport("user32.dll")]\n    private static extern int SendMessage(IntPtr hWnd, int msg, int wParam, int lParam);\n\n    public static void SimulateKeyPress(WebBrowser webBrowser, string text, Keys key)\n    {\n        IntPtr hWnd = webBrowser.Handle;\n        foreach (char c in text)\n        {\n            SendMessage(hWnd, 0x100, (int)c, 0);\n        }\n        SendMessage(hWnd, 0x100, (int)key, 0);\n    }\n}