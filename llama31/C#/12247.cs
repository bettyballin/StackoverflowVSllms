using System;\nusing System.Web;\n\npublic class AuthModule : IHttpModule\n{\n    public void Init(HttpApplication context)\n    {\n        context.BeginRequest += new EventHandler(OnBeginRequest);\n    }\n\n    public void Dispose() { }\n\n    private void OnBeginRequest(object sender, EventArgs e)\n    {\n        HttpApplication app = (HttpApplication)sender;\n        if (app.Application["username"] == null)\n        {\n            app.Response.Redirect("login.aspx");\n        }\n    }\n}