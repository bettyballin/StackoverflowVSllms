using System;\nusing System.Runtime.InteropServices;\n\nnamespace HelloNS\n{\n    [ComVisible(true)]\n    [ClassInterface(ClassInterfaceType.AutoDual)]\n    public class Hello : IHello\n    {\n        public string Message()\n        {\n            return "hello";\n        }\n\n        [ComRegisterFunction]\n        public static void Register(Type type)\n        {\n            string keyName = @"CLSID\" + type.GUID.ToString("B");\n            using (RegistryKey key = Registry.ClassesRoot.CreateSubKey(keyName))\n            {\n                key.SetValue(null, type.Name);\n                key.SetValue("InprocServer32", Environment.SystemDirectory + @"\mscoree.dll");\n                key.SetValue("ThreadingModel", "Both");\n            }\n        }\n\n        [ComUnregisterFunction]\n        public static void Unregister(Type type)\n        {\n            string keyName = @"CLSID\" + type.GUID.ToString("B");\n            using (RegistryKey key = Registry.ClassesRoot.OpenSubKey(keyName, true))\n            {\n                if (key != null)\n                {\n                    key.DeleteSubKeyTree(keyName);\n                }\n            }\n        }\n    }\n\n    public interface IHello\n    {\n        string Message();\n    }\n}