using System;\nusing System.IO;\nusing MediaInfo;\n\npublic class MediaFileMetadata\n{\n    public string FileType { get; set; }\n    public string ContentType { get; set; }\n    public int Width { get; set; }\n    public int Height { get; set; }\n    public double FrameRate { get; set; }\n    public int BitRate { get; set; }\n    public string Codec { get; set; }\n    public string Artist { get; set; }\n    public string Album { get; set; }\n    public string Song { get; set; }\n}\n\npublic class MediaFileInfo\n{\n    public MediaFileMetadata GetMediaFileInfo(string filePath)\n    {\n        var fileInfo = new MediaFileMetadata();\n        var mediaInfo = new MediaInfo();\n\n        mediaInfo.Open(filePath);\n\n        fileInfo.FileType = mediaInfo.Get(StreamKind.General, 0, "Format");\n        fileInfo.ContentType = mediaInfo.Get(StreamKind.General, 0, "ContentType");\n\n        if (fileInfo.ContentType.StartsWith("video"))\n        {\n            fileInfo.Width = int.Parse(mediaInfo.Get(StreamKind.Video, 0, "Width"));\n            fileInfo.Height = int.Parse(mediaInfo.Get(StreamKind.Video, 0, "Height"));\n            fileInfo.FrameRate = double.Parse(mediaInfo.Get(StreamKind.Video, 0, "FrameRate"));\n            fileInfo.BitRate = int.Parse(mediaInfo.Get(StreamKind.Video, 0, "BitRate"));\n            fileInfo.Codec = mediaInfo.Get(StreamKind.Video, 0, "CodecID");\n        }\n        else if (fileInfo.ContentType.StartsWith("audio"))\n        {\n            fileInfo.Artist = mediaInfo.Get(StreamKind.Audio, 0, "Performer");\n            fileInfo.Album = mediaInfo.Get(StreamKind.Audio, 0, "Album");\n            fileInfo.Song = mediaInfo.Get(StreamKind.Audio, 0, "Title");\n        }\n\n        mediaInfo.Close();\n\n        return fileInfo;\n    }\n}