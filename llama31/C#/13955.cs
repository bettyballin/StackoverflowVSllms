<#@ template language="C#" #>\n<#@ import namespace="Microsoft.VisualStudio.Modeling" #>\n<#@ import namespace="Microsoft.VisualStudio.Modeling.Diagrams" #>\n\n// Get the diagram from the Store\nDiagram diagram = Store.DefaultPartition.ElementOperations.GetElement<Diagram>("DiagramName");\n\n// Now you can access the diagram's elements and properties\nforeach (Element element in diagram.Elements)\n{\n    // Process each element...\n}