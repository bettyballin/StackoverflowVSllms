var sqlBuilder = new SqlBuilder();\nsqlBuilder.Select("ContactID", "ROW_NUMBER() OVER (ORDER BY @sortExpression @sortDirection) as ROWRANK");\nsqlBuilder.From("Contacts");\nsqlBuilder.Where("@where");\nsqlBuilder.OrderBy("@sortExpression @sortDirection");\n\nvar sql = sqlBuilder.ToString();\nvar parameters = new[]\n{\n    new SqlParameter("@sortExpression", sortExpression),\n    new SqlParameter("@sortDirection", sortDirection),\n    new SqlParameter("@where", where)\n};\n\nusing (var connection = new SqlConnection(connectionString))\n{\n    connection.Open();\n    var command = new SqlCommand(sql, connection);\n    command.Parameters.AddRange(parameters);\n    var reader = command.ExecuteReader();\n    // Process the results\n}