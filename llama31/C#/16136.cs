using System.Runtime.InteropServices;\n\npublic static class ObjectSizeCalculator\n{\n    [DllImport("kernel32.dll")]\n    private static extern IntPtr GetComInterfaceForObject(IntPtr obj, out IntPtr size);\n\n    public static IntPtr GetObjectSize(object obj)\n    {\n        IntPtr size;\n        IntPtr ptr = GetComInterfaceForObject(Marshal.GetIUnknownForObject(obj), out size);\n        Marshal.Release(ptr);\n        return size;\n    }\n}