[DllImport("advapi32.dll")]\npublic static extern bool LogonUser(string username, string domain, string password, int logonType, int logonProvider, out IntPtr tokenHandle);\n\n[DllImport("kernel32.dll")]\npublic static extern bool CloseHandle(IntPtr hObject);\n\npublic bool ValidateExpiredPassword(string username, string password)\n{\n    IntPtr tokenHandle;\n    bool logonResult = LogonUser(username, "yourdomain.com", password, 3, 0, out tokenHandle);\n    if (logonResult)\n    {\n        // If the logon is successful, check if the password is expired.\n        try\n        {\n            DirectoryEntry entry = new DirectoryEntry("LDAP://yourdomain.com", username, password);\n            DirectorySearcher searcher = new DirectorySearcher(entry);\n            searcher.Filter = "(objectClass=user)";\n            searcher.PropertiesToLoad.Add("msDS-User-Account-Control-Computed");\n            SearchResult result = searcher.FindOne();\n\n            // The password is expired if the msDS-User-Account-Control-Computed attribute contains the UF_PASSWORD_EXPIRED flag.\n            int userAccountControl = Convert.ToInt32(result.Properties["msDS-User-Account-Control-Computed"][0]);\n            const int UF_PASSWORD_EXPIRED = 0x800000;\n            return (userAccountControl & UF_PASSWORD_EXPIRED) == UF_PASSWORD_EXPIRED;\n        }\n        finally\n        {\n            CloseHandle(tokenHandle);\n        }\n    }\n    return false;\n}