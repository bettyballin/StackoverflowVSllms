protected void Page_Load(object sender, EventArgs e)\n{\n    if (!IsPostBack)\n    {\n        SqlDataSource1.SelectCommand = "YourDefaultSQLQuery";\n    }\n}\n\nprotected void SearchButton_Click(object sender, EventArgs e)\n{\n    string sqlQuery = "";\n    switch (SearchCriteria.SelectedValue)\n    {\n        case "Date":\n            sqlQuery = "YourDateBasedSQLQuery";\n            break;\n        case "Template":\n            sqlQuery = "YourTemplateBasedSQLQuery";\n            break;\n        case "Code":\n            sqlQuery = "YourCodeBasedSQLQuery";\n            break;\n    }\n    SqlDataSource1.SelectCommand = sqlQuery;\n    ResultGrid.DataBind();\n}\n\nprotected void ResultGrid_SelectedIndexChanged(object sender, EventArgs e)\n{\n    int selectedRowIndex = ResultGrid.SelectedIndex;\n    string selectedRecordId = ResultGrid.DataKeys[selectedRowIndex].Value.ToString();\n    // Send the selected record id to another page\n}