using System;\nusing System.Runtime.InteropServices;\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        // Create a COM object\n        var comObject = new COMObject();\n\n        // Get the RCW for the COM object\n        var rcw = Marshal.GetIUnknownForObject(comObject);\n\n        // Use the RCW in multiple application domains\n        AppDomain domain1 = AppDomain.CreateDomain("Domain1");\n        AppDomain domain2 = AppDomain.CreateDomain("Domain2");\n\n        domain1.DoCallBack(() =>\n        {\n            // Use the RCW in Domain1\n            var comObjectInDomain1 = Marshal.GetObjectForIUnknown(rcw);\n            Console.WriteLine(comObjectInDomain1.GetType().Name);\n        });\n\n        domain2.DoCallBack(() =>\n        {\n            // Use the RCW in Domain2\n            var comObjectInDomain2 = Marshal.GetObjectForIUnknown(rcw);\n            Console.WriteLine(comObjectInDomain2.GetType().Name);\n        });\n\n        // Release the COM object\n        Marshal.ReleaseComObject(comObject);\n        Marshal.ReleaseComObject(rcw);\n    }\n}