public class CustomTextBox : TextBox\n{\n    public int MaxLength { get; set; }\n\n    protected override void OnTextChanged(TextChangedEventArgs e)\n    {\n        base.OnTextChanged(e);\n\n        var text = Text;\n        if (text.Length > MaxLength)\n        {\n            var exceedingText = text.Substring(MaxLength);\n            var formattedText = new FormattedText(\n                text,\n                CultureInfo.CurrentCulture,\n                FlowDirection.LeftToRight,\n                new Typeface(FontFamily, FontStyle, FontWeight, FontStretch),\n                FontSize,\n                Brushes.Black);\n\n            formattedText.SetForegroundBrush(Brushes.Red, MaxLength, exceedingText.Length);\n\n            var textBlock = new TextBlock { Text = text };\n            textBlock.Inlines.Add(new Run(formattedText));\n\n            Selection.Text = textBlock.Text;\n        }\n    }\n}