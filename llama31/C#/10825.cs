using System;\nusing System.Runtime.InteropServices;\n\nclass Program\n{\n    [DllImport("kernel32")]\n    static extern bool SetConsoleCtrlHandler(ConsoleCtrlDelegate Handler, bool Add);\n\n    delegate bool ConsoleCtrlDelegate(CTRLType Sig);\n\n    enum CTRLType\n    {\n        CTRL_C_EVENT = 0,\n        CTRL_BREAK_EVENT = 1,\n        CTRL_CLOSE_EVENT = 2,\n        CTRL_LOGOFF_EVENT = 5,\n        CTRL_SHUTDOWN_EVENT = 6\n    }\n\n    static bool Handler(CTRLType Sig)\n    {\n        switch (Sig)\n        {\n            case CTRLType.CTRL_CLOSE_EVENT:\n                Console.WriteLine("Are you sure you want to close? (y/n)");\n                string response = Console.ReadLine();\n                if (response.ToLower() != "y")\n                {\n                    return true; // Cancel close\n                }\n                break;\n        }\n        return false; // Allow close\n    }\n\n    static void Main(string[] args)\n    {\n        SetConsoleCtrlHandler(new ConsoleCtrlDelegate(Handler), true);\n\n        while (true)\n        {\n            string x = Console.ReadLine();\n            StartLongRunningTaskOnSeparateThread(x);\n        }\n    }\n\n    static void StartLongRunningTaskOnSeparateThread(string x)\n    {\n        // Your long running task code here\n    }\n}