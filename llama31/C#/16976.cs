using System.Runtime.InteropServices;\n\n[DllImport("setupapi.dll")]\nstatic extern IntPtr SetupDiGetClassDevs(ref Guid classGuid, int enumerator, IntPtr hwndParent, int flags);\n\n[DllImport("setupapi.dll")]\nstatic extern bool SetupDiEnumDeviceInterfaces(IntPtr hDevInfo, int index, ref SP_DEVICE_INTERFACE_DATA deviceInterfaceData, int size);\n\nGuid guid = new Guid("A5DCBF10-6530-11D2-901F-00C04FB951ED"); // GUID_DEVINTERFACE_USB_DEVICE\nIntPtr hDevInfo = SetupDiGetClassDevs(ref guid, 0, IntPtr.Zero, 0);\n\nSP_DEVICE_INTERFACE_DATA deviceInterfaceData = new SP_DEVICE_INTERFACE_DATA();\ndeviceInterfaceData.cbSize = Marshal.SizeOf(deviceInterfaceData);\n\nfor (int index = 0; SetupDiEnumDeviceInterfaces(hDevInfo, index, ref deviceInterfaceData, Marshal.SizeOf(deviceInterfaceData)); index++)\n{\n    Console.WriteLine(deviceInterfaceData.DevicePath);\n}