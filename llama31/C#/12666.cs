var query = context.log_sales\n    .GroupBy(c => new { c.OrderTime.Year, c.OrderTime.Month })\n    .Select(g => new\n    {\n        Date = new DateTime(g.Key.Year, g.Key.Month, 1),\n        Location1 = g.Where(c => c.Location == "Location1").Sum(c => c.Charge) ?? 0,\n        Location2 = g.Where(c => c.Location == "Location2").Sum(c => c.Charge) ?? 0,\n        Location3 = g.Where(c => c.Location == "Location3").Sum(c => c.Charge) ?? 0\n    })\n    .OrderByDescending(x => x.Date)\n    .ToList();