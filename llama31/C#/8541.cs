[TestClass]\npublic class MyTest\n{\n    [TestMethod]\n    public void TestComEvent()\n    {\n        // Create a message pump\n        using (var messageLoop = new MessageLoop())\n        {\n            // Call your code that uses COM events\n            MyComEventFiringCode();\n        }\n    }\n}\n\npublic class MessageLoop : IDisposable\n{\n    private readonly Thread _thread;\n\n    public MessageLoop()\n    {\n        _thread = new Thread(() =>\n        {\n            Application.Run(); // Start the message pump\n        });\n        _thread.Start();\n    }\n\n    public void Dispose()\n    {\n        _thread.Abort();\n        _thread.Join();\n    }\n}