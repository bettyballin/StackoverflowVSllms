using System;\nusing System.Collections.Generic;\nusing System.Linq;\n\npublic int WorkingDays(DateTime startDate, DateTime endDate, List<DateTime> excludedDates = null)\n{\n    var workingDays = 0;\n    foreach (var day in Enumerable.Range(0, (endDate - startDate).Days + 1).Select(d => startDate.AddDays(d)))\n    {\n        if (day.DayOfWeek != DayOfWeek.Saturday && day.DayOfWeek != DayOfWeek.Sunday && (excludedDates == null || !excludedDates.Contains(day)))\n        {\n            workingDays += 1;\n        }\n    }\n    return workingDays;\n}