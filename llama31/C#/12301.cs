[ComVisible(true)]\npublic interface IMyService\n{\n    int MyMethod();\n}\n\n[ComVisible(true)]\npublic class MyService : IMyService\n{\n    public int MyMethod()\n    {\n        try\n        {\n            // Code that might throw an exception\n            // ...\n            return 0; // Success\n        }\n        catch (Exception ex)\n        {\n            // Convert the exception to an HRESULT value\n            int errorCode = Marshal.ThrowExceptionForHR(ex);\n            return errorCode;\n        }\n    }\n}