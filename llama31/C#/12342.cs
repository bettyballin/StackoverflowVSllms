using System;\nusing System.Net.Sockets;\nusing System.IO;\n\nclass ICAPClient\n{\n    private string _icapServer;\n    private int _icapPort;\n\n    public ICAPClient(string icapServer, int icapPort)\n    {\n        _icapServer = icapServer;\n        _icapPort = icapPort;\n    }\n\n    public void ScanFile(string filePath)\n    {\n        // Create a TCP client\n        TcpClient client = new TcpClient(_icapServer, _icapPort);\n\n        // Create a stream to send the file\n        Stream stream = client.GetStream();\n\n        // Send the ICAP request\n        string request = $"ICAP/1.0 reqmod {filePath} ICAP/1.0\r\nHost: {_icapServer}:{_icapPort}\r\n\r\n";\n        byte[] requestBytes = Encoding.ASCII.GetBytes(request);\n        stream.Write(requestBytes, 0, requestBytes.Length);\n\n        // Send the file\n        byte[] fileBytes = File.ReadAllBytes(filePath);\n        stream.Write(fileBytes, 0, fileBytes.Length);\n\n        // Get the response\n        byte[] responseBytes = new byte[1024];\n        int bytesRead = stream.Read(responseBytes, 0, responseBytes.Length);\n        string response = Encoding.ASCII.GetString(responseBytes, 0, bytesRead);\n\n        // Close the stream and client\n        stream.Close();\n        client.Close();\n\n        // Parse the response\n        if (response.Contains("ICAP/1.0 200 OK"))\n        {\n            Console.WriteLine("File is clean");\n        }\n        else\n        {\n            Console.WriteLine("File is infected");\n        }\n    }\n}