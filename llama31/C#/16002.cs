using Microsoft.SqlServer.TransactSql.ScriptDom;\n\npublic class SqlReplacer\n{\n    public static string ReplaceDelimiter(string input)\n    {\n        TSql150Parser parser = new TSql150Parser(false);\n        TSqlFragment fragment = parser.Parse(new StringReader(input), out IList<ParseError> errors);\n\n        // Iterate through the script and replace ';' within comments\n        foreach (TSqlParserToken token in fragment.ScriptTokenStream)\n        {\n            if (token.TokenType == TSqlTokenType.SingleLineComment || token.TokenType == TSqlTokenType.MultiLineComment)\n            {\n                token.Text = token.Text.Replace(";", "~");\n            }\n        }\n\n        // Reconstruct the modified SQL script\n        string result = fragment.ToScript();\n\n        return result;\n    }\n}