using Microsoft.Web.Administration;\nusing System;\n\nclass IISResetMonitor\n{\n    public void StartMonitoring()\n    {\n        using (var serverManager = new ServerManager())\n        {\n            serverManager.WorkerProcessStarted += OnWorkerProcessStarted;\n            serverManager.WorkerProcessStopped += OnWorkerProcessStopped;\n            serverManager.ApplicationPoolRecycled += OnApplicationPoolRecycled;\n        }\n    }\n\n    private void OnWorkerProcessStarted(object sender, EventArgs e)\n    {\n        Console.WriteLine("Worker process started");\n    }\n\n    private void OnWorkerProcessStopped(object sender, EventArgs e)\n    {\n        Console.WriteLine("Worker process stopped");\n        // Restart your Windows services here\n    }\n\n    private void OnApplicationPoolRecycled(object sender, EventArgs e)\n    {\n        Console.WriteLine("Application pool recycled");\n        // Restart your Windows services here\n    }\n}