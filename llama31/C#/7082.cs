public void Save()\n{\n    // Create a new XML file if there's no root element\n    if (xDocument.DocumentElement == null)\n    {\n        xDocument = new XmlDocument();\n        xDocument.LoadXml("<?xml version=\"1.0\" encoding=\"utf-8\" ?>\n" +\n            "<" + XmlRootElement + ">\n</" + XmlRootElement + ">");\n    }\n\n    // OMITTED CODE WAS HERE (NOT IMPORTANT FOR THE PROBLEM)\n\n    // Create a new XML writer for the XML file\n    using (XmlWriter xWriter = XmlWriter.Create(XmlFilePath, new XmlWriterSettings()\n    {\n        Indent = true,\n        IndentChars = "\t"\n    }))\n    {\n        // Sort the XML file using the XSL stylesheet and save it\n        xslTransform.Transform(xDocument, xWriter);\n    }\n}