using (SqlConnection connection = new SqlConnection(connectionString))\n{\n    connection.Open();\n    SqlTransaction transaction = connection.BeginTransaction();\n\n    try\n    {\n        // Update dataset\n        dataset.AcceptChanges();\n\n        // Commit transaction\n        transaction.Commit();\n    }\n    catch (Exception ex)\n    {\n        // Rollback transaction\n        transaction.Rollback();\n    }\n}