using System;\nusing System.Data;\n\npublic class DynamicExpressionEvaluator\n{\n    public bool Evaluate(string expression, params bool[] values)\n    {\n        var dataTable = new DataTable();\n        var variables = new Dictionary<string, bool>();\n\n        for (int i = 0; i < values.Length; i++)\n        {\n            variables.Add($"A{i+1}", values[i]);\n        }\n\n        expression = expression.Replace("And", "AND").Replace("Or", "OR").Replace("Not", "NOT");\n\n        foreach (var variable in variables)\n        {\n            expression = expression.Replace(variable.Key, variable.Value.ToString().ToUpper());\n        }\n\n        var result = dataTable.Compute(expression, String.Empty);\n\n        return Convert.ToBoolean(result);\n    }\n}