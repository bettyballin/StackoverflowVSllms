using System;\nusing System.Runtime.InteropServices;\n\n// ...\n\nIVirtualBox vbox = ...; // get the IVirtualBox instance\n\n// Call get_Machines() and marshal the SafeArray manually\nIntPtr machinesPtr = Marshal.AllocHGlobal(IntPtr.Size);\ntry\n{\n    vbox.get_Machines(out machinesPtr);\n    int machineCount = Marshal.ReadInt32(machinesPtr, -4); // get the array length\n    IMachine[] machines = new IMachine[machineCount];\n    for (int i = 0; i < machineCount; i++)\n    {\n        IntPtr machinePtr = Marshal.ReadIntPtr(machinesPtr, i * IntPtr.Size);\n        machines[i] = (IMachine)Marshal.GetObjectForIUnknown(machinePtr);\n    }\n    // use the machines array\n}\nfinally\n{\n    Marshal.FreeHGlobal(machinesPtr);\n}