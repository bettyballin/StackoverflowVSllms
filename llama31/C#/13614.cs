using System.IO;\n\npublic bool IsValidDirectory(string directoryPath)\n{\n    if (!Directory.Exists(directoryPath))\n    {\n        return false;\n    }\n\n    try\n    {\n        using (FileStream fs = File.Create(Path.Combine(directoryPath, Path.GetRandomFileName()), 1, FileOptions.DeleteOnClose))\n        {\n            return true;\n        }\n    }\n    catch\n    {\n        return false;\n    }\n}