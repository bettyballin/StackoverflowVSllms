using System.DirectoryServices.AccountManagement;\n\n// Create a new PrincipalContext object\nPrincipalContext context = new PrincipalContext(ContextType.Domain);\n\n// Search for users\nUserPrincipalSearcher searcher = new UserPrincipalSearcher();\nsearcher.Context = context;\n\n// Find all users\nPrincipalSearchResult<Principal> results = searcher.FindAll();\n\n// Loop through the results and get the user names\nforeach (UserPrincipal user in results)\n{\n    string userName = user.SamAccountName;\n    string displayName = user.DisplayName;\n    // Do something with the user names...\n}