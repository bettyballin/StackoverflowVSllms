Response.ContentType = "application/zip";\nResponse.AddHeader("content-disposition", "filename=" + filename);\n\nResponse.OutputStream.SetAccessControl(new System.Security.AccessControl.FileSecurity(\n    System.Security.AccessControl.AccessControlSections.Access,\n    new System.Security.AccessControl.FileSystemAccessRule(\n        System.Security.Principal.WindowsIdentity.GetCurrent().Name,\n        System.Security.AccessControl.FileSystemRights.Write,\n        System.Security.AccessControl.AccessControlType.Allow\n    )\n));\n\nusing (ZipFile zip = new ZipFile(Response.OutputStream))\n{\n    // ...\n}