using System;\nusing System.Runtime.InteropServices;\n\n[ComVisible(true)]\npublic class CustomClassFactory : IClassFactory, IClassFactory2\n{\n    // Implement IClassFactory\n    public int CreateInstance(IntPtr pUnkOuter, Guid riid, out IntPtr ppvObject)\n    {\n        // Create and return your .NET object\n        ppvObject = Marshal.GetComInterfaceForObject(new YourDotNetObject(), riid);\n        return 0;\n    }\n\n    // Implement IClassFactory2\n    public int CreateInstanceLic(IntPtr pUnkOuter, Guid riid, out IntPtr ppvObject, BSTR key)\n    {\n        // Not implemented\n        throw new NotImplementedException();\n    }\n\n    public int RequestLicKey(int dwReserved, out BSTR pBstrKey)\n    {\n        // Not implemented\n        throw new NotImplementedException();\n    }\n}