private IQueryable<T> GetQuery<T>(IQueryable<T> source, string[] queryTerms, Expression<Func<T, string>> fieldSelector)\n{\n    if (queryTerms.Length == 1)\n    {\n        return source.Where(e => fieldSelector.Compile()(e).StartsWith(queryTerms[0]));\n    }\n    else\n    {\n        foreach (string queryTerm in queryTerms)\n        {\n            if (!string.IsNullOrEmpty(queryTerm))\n            {\n                source = source.Where(e => fieldSelector.Compile()(e).Contains(queryTerm));\n            }\n        }\n        return source;\n    }\n}