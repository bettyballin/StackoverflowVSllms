$mail_queue = new Mail_Queue();\n\n// Set the batch size to 100 emails\n$batch_size = 100;\n\n// Send the emails in the queue\n$mail_queue->sendMailsInQueue($batch_size);\n\n// If there are still emails in the queue, schedule the next batch\nif ($mail_queue->countMailsInQueue() > 0) {\n    // Use a lock file or a semaphore to prevent concurrent executions\n    $lock_file = '/path/to/lock/file.lock';\n    if (!file_exists($lock_file)) {\n        touch($lock_file);\n        // Schedule the next batch to run in 1 minute\n        $next_batch_time = time() + 60;\n        $mail_queue->setNextBatchTime($next_batch_time);\n    }\n}