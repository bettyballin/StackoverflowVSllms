$input = trim($_POST['tags']); // trim input\n\nif (empty($input)) {\n    // handle empty input error\n}\n\n$allowedChars = '/^[a-zA-Z0-9\s-]+$/'; // whitelist allowed characters\nif (!preg_match($allowedChars, $input)) {\n    // handle invalid character error\n}\n\n$tags = preg_split('/\s+/', $input); // split string using regex\n\nforeach ($tags as $tag) {\n    if (strlen($tag) < 2 || strlen($tag) > 20) {\n        // handle invalid tag length error\n    }\n\n    // insert into DB using prepared statement\n    $stmt = $db->prepare('INSERT INTO tags (tag) VALUES (:tag)');\n    $stmt->bindParam(':tag', $tag);\n    $stmt->execute();\n}