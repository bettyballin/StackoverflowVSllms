<?php\nrequire_once "../config/functions.inc.php";\n\n// Enable error reporting\nerror_reporting(E_ALL);\nini_set('display_errors', '1');\n\n// Increase script timeout\nset_time_limit(300);\n\n// Get users\n$sql = 'SELECT * FROM friend_login';\n$result = executequery($sql);\n\nwhile ($row = mysql_fetch_assoc($result)) {\n    // Get states (optimized query)\n    $sql = 'SELECT * FROM usstates ORDER BY RAND() LIMIT 1';\n    $state = getSingleResult($sql);\n\n    // Convert to lat and long\n    $geo = get_geo($state);\n    $lat = $geo['Latitude'];\n    $long = $geo['Longitude'];\n\n    // Insert lat/long into locations table (using prepared statement)\n    $insert = "INSERT INTO friend_location (user_id, lat, `long`) VALUES (?, ?, ?)";\n    $stmt = $mysqli->prepare($insert);\n    $stmt->bind_param("iss", $row['auto_id'], $lat, $long);\n    $stmt->execute();\n\n    echo 'User updated with ' . $state . ' <BR> userID=' . $row['auto_id'] . ' <BR><BR><BR>';\n}\n?>