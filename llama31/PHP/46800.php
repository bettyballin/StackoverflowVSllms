private function run_lengthy_job($command, $message) {\n    $handle = popen($command, 'r');\n    stream_set_blocking($handle, 0); // Set non-blocking mode\n\n    while (!feof($handle)) {\n        printf("[%s]\t%s\n", time(), $message);\n\n        $data = fread($handle, 1024);\n        if ($data !== false) {\n            // log the operation\n            exec(sprintf('logger "%s"', escapeshellarg($data)));\n        } else {\n            // No data available, sleep for a short period\n            usleep(100000); // 0.1 seconds\n        }\n    }\n\n    pclose($handle);\n}