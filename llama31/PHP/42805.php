class FlatFileDB {\n    private $file;\n    private $index;\n\n    public function __construct($file) {\n        $this->file = $file;\n        $this->index = array();\n    }\n\n    public function put($key, $value) {\n        $data = json_encode(array($key => $value));\n        $this->write($data);\n        $this->index[$key] = ftell($this->file);\n    }\n\n    public function get($key) {\n        if (isset($this->index[$key])) {\n            fseek($this->file, $this->index[$key]);\n            return json_decode(fgets($this->file), true);\n        } else {\n            return null;\n        }\n    }\n\n    private function write($data) {\n        flock($this->file, LOCK_EX);\n        fwrite($this->file, $data . "\n");\n        flock($this->file, LOCK_UN);\n    }\n}