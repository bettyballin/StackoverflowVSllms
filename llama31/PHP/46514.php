echo '<ul>';\n$prev_depth = 0;\nforeach($table->fetchTree() as $row) {\n    if ($row->tree_depth > $prev_depth) {\n        for ($i = $prev_depth; $i < $row->tree_depth; $i++) {\n            echo '<ul>';\n        }\n    } else if ($row->tree_depth < $prev_depth) {\n        for ($i = $row->tree_depth; $i < $prev_depth; $i++) {\n            echo '</ul>';\n        }\n    }\n    echo '<li>' . $row->name . '</li>';\n    $prev_depth = $row->tree_depth;\n}\n// Close all remaining ul tags\nfor ($i = 0; $i <= $prev_depth; $i++) {\n    echo '</ul>';\n}