class Login {\n    public function __construct($username, $rawPassword) {\n        global $db;\n\n        require('edit/users/config.php');\n\n        $hashedPassword = sha1(SALT . $_POST['password']);\n\n        $query = 'SELECT firstname FROM users WHERE user = "' . $db->cleanString($username) . '" AND pass = "' . $db->cleanString($hashedPassword) . '" LIMIT 1';\n\n        $login = $db->query($query);\n\n        if ($login) {\n            $_SESSION['username'] = $username;\n            $_SESSION['authenticated'] = true;\n\n            header('Location: ' . CONFIG_DIR_BASE);\n        } else {\n            ErrorHandler::addErrorToStack('Your username and/or password did not match one on our system. ');\n        }\n    }\n\n    public static function isAuthenticated() {\n        return isset($_SESSION['authenticated']) && $_SESSION['authenticated'] === true;\n    }\n}