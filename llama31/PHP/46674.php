$ldap_host = 'ldap://your.ad.domain.com';\n$ldap_user = 'username';\n$ldap_pass = 'password';\n\n$ldap_conn = ldap_connect($ldap_host);\nif (!$ldap_conn) {\n    die('LDAP connection failed');\n}\n\nldap_set_option($ldap_conn, LDAP_OPT_PROTOCOL_VERSION, 3);\nldap_set_option($ldap_conn, LDAP_OPT_REFERRALS, 0);\n\n$ldap_bind = @ldap_bind($ldap_conn, $ldap_user, $ldap_pass);\nif (!$ldap_bind) {\n    die('LDAP bind failed');\n}\n\n// User is authenticated, get their details\n$ldap_search = ldap_search($ldap_conn, 'dc=your,dc=ad,dc=domain,dc=com', '(sAMAccountName=' . $ldap_user . ')');\n$ldap_entry = ldap_get_entries($ldap_conn, $ldap_search);