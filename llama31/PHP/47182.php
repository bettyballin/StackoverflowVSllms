<?php\n\n// Config\n$download_path = 'content'; // path to your files, NB: no slash at the end\n$sort = 'asort'; // array sorting - alphabetical sorting for the array\n\n// Get a list of files and dirs\nfunction file_list($dir) {\n    $files = scandir($dir);\n    $files = array_diff($files, ['.', '..']);\n    usort($files, $sort);\n    return $files;\n}\n\n// Convert file size to human-readable format\nfunction file_size($size) {\n    $sizes = ['bytes', 'KB', 'MB', 'GB', 'TB'];\n    $index = 0;\n    while ($size >= 1024 && $index < count($sizes) - 1) {\n        $size /= 1024;\n        $index++;\n    }\n    return sprintf('%01.2f %s', $size, $sizes[$index]);\n}\n\n// Generate file list table\nfunction generate_file_list($path) {\n    global $download_path;\n    $files = file_list($download_path . '/' . $path);\n    echo '<b>' . $path . '/</b>';\n    echo '<br><br>';\n    if (empty($files)) {\n        echo 'directory empty';\n    } else {\n        echo '<table width="75%" border="0" cellspacing="0" cellpadding="0">';\n        echo '<tr><td><b>file</b></td><td><b>size</b></td></tr>';\n        foreach ($files as $file) {\n            $filePath = $download_path . '/' . $path . '/' . $file;\n            $fileSize = filesize($filePath);\n            $fileSize = file_size($fileSize);\n            if (is_file($filePath)) {\n                echo '<tr><td><a href="?go=download&path=' . urlencode($path) . '&file=' . urlencode($file) . '">' . $file . '</a></td><td>' . $fileSize . '</td></tr>';\n            } elseif (is_dir($filePath)) {\n                echo '<tr><td><a href="?go=list&path=' . urlencode($path) . '/' . urlencode($file) . '">' . $file . '/</a></td><td>&lt;dir&gt;</td></tr>';\n            }\n        }\n        echo '</table>';\n    }\n}\n\n// Download file\nfunction do_download($path, $file) {\n    global $download_path;\n    $filePath = $download_path . '/' . $path . '/' . $file;\n    if (file_exists($filePath)) {\n        header('Content-Disposition: attachment; filename="' . $file . '"');\n        header('Content-Type: application/octet-stream');\n        header('Content-Length: ' . filesize($filePath));\n        header('Cache-Control: no-cache, must-revalidate');\n        header('Pragma: no-cache');\n        header('Expires: 0');\n        readfile($filePath);\n        exit;\n    }\n}\n\n// Handle requests\nif (!isset($_GET['go'])) {\n    $_GET['go'] = 'dirlist';\n}\nswitch ($_GET['go']) {\n    case 'dirlist':\n        generate_file_list('');\n        break;\n    case 'list':\n        generate_file_list($_GET['path']);\n        break;\n    case 'download':\n        do_download($_GET['path'], $_GET['file']);\n        break;\n}\n\n?>