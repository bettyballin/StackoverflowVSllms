function render_events($days) {\n    foreach ($days as $day_number) {\n        $where = sprintf('WHERE e.day_id = %s', $day_number);\n        $events = get_events($where);\n        if ($events) {\n            echo '<table class="results">';\n            render_day($day_number);\n            foreach ($events as $event) {\n                render_event($event);\n            }\n            echo '</table>';\n        } else {\n            echo 'No events';\n        }\n    }\n}\n\n// ...\n\nif (!empty($_REQUEST['date_range'])) {\n    // user has chosen a date/range, show matching events\n    $date_range = mysql_real_escape_string($_REQUEST['date_range']);\n    switch ($date_range) {\n        case 'all':\n            $days = get_all_days();\n            render_events($days);\n            break;\n        case 'next_7_days':\n            $days = get_next_7_days();\n            render_events($days);\n            break;\n        case 'next_30_days':\n            $days = get_next_30_days();\n            render_events($days);\n            break;\n        default:\n            // code here\n    }\n} else {\n    // no date selected, show todays events\n    $days = convert_date_to_day_number($today);\n    render_events($days);\n}