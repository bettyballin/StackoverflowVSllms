use PHPUnit\Framework\TestCase;\nuse PHPUnit\Framework\MockObject\MockObject;\n\nclass StuffDoer {\n    protected function doesLongRunningThing() {\n        sleep(10);\n        return "stuff";\n    }\n\n    public function doStuff() {\n        return $this->doesLongRunningThing();\n    }\n}\n\nclass StuffDoerTestCase extends TestCase {\n    public function testStuffDoer() {\n        $sd = $this->getMockBuilder(StuffDoer::class)\n            ->setMethods(['doesLongRunningThing'])\n            ->getMock();\n\n        $sd->expects($this->once())\n            ->method('doesLongRunningThing')\n            ->willReturn('test stuff');\n\n        $result = $sd->doStuff();\n        $this->assertEquals($result, 'test stuff');\n    }\n}