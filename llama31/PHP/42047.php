class CustomTemplateResource extends Smarty_Resource_Custom {\n    private $templateDirsCallback = null;\n\n    public function __construct(Smarty $smarty, $templateDirsCallback) {\n        $this->templateDirsCallback = $templateDirsCallback;\n        parent::__construct($smarty);\n    }\n\n    public function fetch($name, &$source, &$mtime) {\n        $templateDirs = call_user_func($this->templateDirsCallback);\n        foreach ($templateDirs as $dir) {\n            $filePath = $dir . DIRECTORY_SEPARATOR . $name;\n            if (file_exists($filePath)) {\n                $source = file_get_contents($filePath);\n                $mtime = filemtime($filePath);\n                return true;\n            }\n        }\n        return false;\n    }\n}