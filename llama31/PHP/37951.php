function open_external_links_in_new_window($html) {\n    $doc = new DOMDocument();\n    $doc->loadHTML($html);\n    $links = $doc->getElementsByTagName('a');\n\n    foreach ($links as $link) {\n        $href = $link->getAttribute('href');\n        if (parse_url($href, PHP_URL_HOST) != $_SERVER['HTTP_HOST']) {\n            $link->setAttribute('target', '_blank');\n        }\n    }\n\n    return $doc->saveHTML();\n}\n\n$html = '<p>This is a <a href="https://example.com">test link</a> and this is an <a href="https://google.com">external link</a>.</p>';\necho open_external_links_in_new_window($html);