private function run_lengthy_job($command, $message) {\n    $descriptorspec = array(\n        1 => array("pipe", "w"), // stdout\n    );\n\n    $process = proc_open($command, $descriptorspec, $pipes);\n\n    stream_set_blocking($pipes[1], 0); // Set non-blocking mode\n\n    while (!feof($pipes[1])) {\n        printf("[%s]\t%s\n", time(), $message);\n\n        $data = fread($pipes[1], 1024);\n        if ($data !== false) {\n            // log the operation\n            exec(sprintf('logger "%s"', escapeshellarg($data)));\n        } else {\n            // No data available, sleep for a short period\n            usleep(100000); // 0.1 seconds\n        }\n    }\n\n    proc_close($process);\n}