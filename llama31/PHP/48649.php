function textFormat($text) {\n    $raw = array(\n        '/\[text\](?P<id>\d+)\[\/text\]/i'\n    );\n\n    $out = array(\n        function ($match) {\n            return '<a href="index.php?function=getData&reference=text&id=' . $match['id'] . '">' . getTextTitle($match['id']) . '</a>';\n        }\n    );\n\n    return preg_replace_callback($raw, $out, $text);\n}\n\nfunction getTextTitle($id) {\n    $sql = mysql_query("SELECT title FROM text WHERE id = " . mysql_real_escape_string($id));\n    return mysql_result($sql);\n}