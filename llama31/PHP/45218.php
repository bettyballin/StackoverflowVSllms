function nestify($arrs, $depth_key = 'depth') {\n    $nested = array();\n    $depths = array();\n\n    foreach ($arrs as $key => $arr) {\n        if ($arr[$depth_key] == 0) {\n            $nested[] = array(\n                'id' => $arr['id'],\n                'name' => $arr['name'],\n                'children' => array()\n            );\n            $depths[$arr[$depth_key] + 1] = count($nested) - 1;\n        } else {\n            $parent = &$nested;\n            for ($i = 1; $i < $arr[$depth_key]; $i++) {\n                $parent = &$parent[$depths[$i]]['children'];\n            }\n            $parent[] = array(\n                'id' => $arr['id'],\n                'name' => $arr['name'],\n                'children' => array()\n            );\n            $depths[$arr[$depth_key] + 1] = count($parent) - 1;\n        }\n    }\n\n    return $nested;\n}