$dialog_url = "https://www.facebook.com/dialog/oauth?"\n  . "client_id=" . $app_id\n  . "&redirect_uri=" . urlencode($canvas_page_url . '?dialog=map')\n  . "&response_type=token";\n\n$map_url = "https://maps.google.com/maps?"\n  . "q=" . urlencode($location)\n  . "&output=embed"\n  . "&iwloc=near";\n\n$iframe = '<iframe src="' . $map_url . '" width="500" height="300"></iframe>';\n\n$dialog = array(\n  'method' => 'feed',\n  'redirect_uri' => $canvas_page_url,\n  'message' => 'Check out this map!',\n  'actions' => array(\n    array(\n      'name' => 'View Map',\n      'link' => $dialog_url,\n    ),\n  ),\n  'description' => $iframe,\n);\n\n$dialog_url = "https://www.facebook.com/dialog/feed?"\n  . "client_id=" . $app_id\n  . "&redirect_uri=" . urlencode($canvas_page_url)\n  . "&method=feed"\n  . "&message=" . urlencode($dialog['message'])\n  . "&actions=" . urlencode(json_encode($dialog['actions']))\n  . "&description=" . urlencode($dialog['description']);\n\n// Use the Facebook PHP SDK to redirect to the dialog\n$facebook->getLoginUrl(array('redirect_uri' => $dialog_url));