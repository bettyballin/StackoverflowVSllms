$data = array(\n    'media' => file_get_contents('path/to/image.jpg'),\n    'username' => 'asc',\n    'password' => 'asc',\n    'message' => 'hi'\n);\n\n$url = 'http://example.com/api/uploadAndPost';\n\n$req = new HTTPRequest($url);\n$req->addHeaders(array("Content-Type" => "text/xml"));\n$req->setMethod(HTTP_METH_POST);\n\n$xml = new SimpleXMLElement('<request/>');\n$xml->addChild('media', base64_encode($data['media']));\n$xml->addChild('username', $data['username']);\n$xml->addChild('password', $data['password']);\n$xml->addChild('message', $data['message']);\n\n$req->setBody($xml->asXML());\n$req->send();\n\necho $req->getResponseBody();