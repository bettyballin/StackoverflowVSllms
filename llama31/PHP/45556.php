<?php\nrequire __DIR__ . '/vendor/autoload.php';\n\nuse Google_Client;\nuse Google_Service_Gmail;\n\n// Set up authentication\n$client = new Google_Client();\n$client->setApplicationName("Gmail API PHP Client");\n$client->setAuthConfig('credentials.json');\n$client->setScopes(['https://www.googleapis.com/auth/gmail.readonly']);\n$service = new Google_Service_Gmail($client);\n\n// Call the Gmail API to fetch messages with attachments\n$messagesResponse = $service->users_messages->listUsersMessages('me', ['labelIds' => 'INBOX']);\n$messages = $messagesResponse->getMessages();\n\nforeach ($messages as $message) {\n    $msg = $service->users_messages->get('me', $message->getId());\n    $payload = $msg->getPayload();\n    $headers = $payload->getHeaders();\n\n    // Find the attachment\n    foreach ($payload->getParts() as $part) {\n        if ($part->getFilename()) {\n            $attachment = $service->users_messages_attachments->get('me', $message->getId(), $part->getBody()->getAttachmentId());\n            $data = base64_decode($attachment->getData());\n            print($part->getFilename());\n            file_put_contents($part->getFilename(), $data);\n        }\n    }\n}