<?php\n// Validate user access to the post\nif (!isLoggedIn() || !hasAccessToPost($postId)) {\n    http_response_code(403);\n    exit;\n}\n\n// Retrieve file metadata from database\n$file = getFileMetadata($fileId);\n\n// Set HTTP headers\nheader('Content-Type: ' . $file['mime_type']);\nheader('Content-Disposition: attachment; filename="' . $file['file_name'] . '"');\nheader('Content-Length: ' . $file['file_size']);\n\n// Output file contents\nreadfile('/var/uploads/' . $file['file_name']);\nexit;