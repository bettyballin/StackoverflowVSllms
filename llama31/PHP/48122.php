$allowedChars = '/^[a-zA-Z0-9\s\[\]\(\)\>\<\!\#\$\ ]+$/';\n\n$type = preg_replace($allowedChars, '', $type);\n$study = preg_replace($allowedChars, '', $study);\n$server = preg_replace($allowedChars, '', $server);\n$tag = preg_replace($allowedChars, '', $tag);\n$specopt1 = preg_replace($allowedChars, '', $specopt1);\n$specopt2 = preg_replace($allowedChars, '', $specopt2);\n$specopt3 = preg_replace($allowedChars, '', $specopt3);\n$specopt4 = preg_replace($allowedChars, '', $specopt4);\n\n$command = array('report-call', escapeshellarg($type), escapeshellarg($study), escapeshellarg($server), escapeshellarg($tag), escapeshellarg($specopt1), escapeshellarg($specopt2), escapeshellarg($specopt3), escapeshellarg($specopt4));\n\n$commandStr = implode(' ', $command);\n\n$last_line = exec($commandStr, $output, $returnvalue);