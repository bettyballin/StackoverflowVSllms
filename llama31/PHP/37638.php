class User extends AppModel {\n    var $validate = array(\n        // ... other validation rules ...\n        'password' => array(\n            'notEmpty' => array(\n                'rule' => array('minLength', 6),\n                'required' => true,\n                'allowEmpty' => false,\n                'message' => 'Password has to be at least 6 characters long'\n            ),\n            'password_similar' => array(\n                'rule' => 'checkPasswords',\n                'message' => 'Entered passwords does not match'\n            )\n        ),\n        // ... other validation rules ...\n    );\n\n    function checkPasswords($data) {\n        if ($data['password'] == $this->data['User']['password2hashed']) {\n            return true;\n        } else {\n            return false;\n        }\n    }\n}