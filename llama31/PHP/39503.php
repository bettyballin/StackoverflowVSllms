function remove_comments($code) {\n    $lines = explode("\n", $code);\n    $cleaned_lines = array();\n    foreach ($lines as $line) {\n        $line = preg_replace('/#.*$/', '', $line); // remove # comments\n        $line = preg_replace('/\/\/.*$/', '', $line); // remove // comments\n        $line = preg_replace('/\/\*.*?\*\//s', '', $line); // remove /* */ comments\n        $cleaned_lines[] = trim($line);\n    }\n    return implode("\n", array_filter($cleaned_lines));\n}