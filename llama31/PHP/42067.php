// Reading the file as GD image data\n$imagedata = imagecreatefrompng($imagefile);\n// Do some GD processing: Adding watermarks etc. No problem here...\n\n// Convert the $imagedata to $stringdata\n$stream = fopen('php://temp', 'r+');\nimagepng($imagedata, $stream, 9); // 9 is the compression level\nrewind($stream);\n$stringdata = stream_get_contents($stream);\nfclose($stream);\n\n// Compressing the string data\n$zdata = gzdeflate($stringdata);