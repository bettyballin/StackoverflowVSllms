$memcache = new Memcache();\n$memcache->connect('127.0.0.1', 11211);\n\n$key = 'therows1';\n$expiryTime = 30;\n\n// Define the update function\n$updateFunction = function(&$data) {\n    $data = findfriend2(); // this function gets our array from mysql\n};\n\n// Use the locked memcache update function\nif (locked_memcache_update($memcache, $key, $updateFunction, $expiryTime)) {\n    $rows2 = $memcache->get($key);\n    echo '<pre>';\n    print_r($rows2); // print the cached version\n    echo '</pre>';\n} else {\n    // Handle failure case\n    echo 'Failed to update cache';\n}