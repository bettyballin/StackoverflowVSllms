function do_http_request($url, $data, $method = 'POST', $optional_headers = null) {\n    $ch = curl_init($url);\n    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\n    curl_setopt($ch, CURLOPT_POST, true);\n    curl_setopt($ch, CURLOPT_POSTFIELDS, $data);\n    if ($optional_headers !== null) {\n        curl_setopt($ch, CURLOPT_HTTPHEADER, array($optional_headers));\n    }\n    $response = curl_exec($ch);\n    $http_code = curl_getinfo($ch, CURLINFO_HTTP_CODE);\n    curl_close($ch);\n    if ($http_code != 200) {\n        throw new Exception("HTTP Error $http_code");\n    }\n    return $response;\n}