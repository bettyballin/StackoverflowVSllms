// in your controller plugin's preDispatch method\nif (!$auth->hasIdentity()) {\n    $requestUri = $request->getRequestUri();\n    $auth->getStorage()->write('redirect', $requestUri);\n    // redirect to login page\n}\n\n// in your login action, after successful authentication\nif ($auth->hasIdentity()) {\n    $redirectUri = $auth->getStorage()->read('redirect');\n    if ($redirectUri) {\n        $this->_helper->redirector->gotoUrl($redirectUri);\n    }\n}