class ImageGenerator {\n    private $img;\n\n    public function __construct() {\n        // Create the image\n        $this->img = imagecreatetruecolor(100, 100);\n        // ...\n    }\n\n    public function __destruct() {\n        // Destructor might not be called if script terminates abruptly\n        // imagedestroy($this->img);\n    }\n}\n\nfunction shutdown_func() {\n    global $imageGenerator;\n    if ($imageGenerator) {\n        imagedestroy($imageGenerator->img);\n    }\n}\nregister_shutdown_function("shutdown_func");\n\n$imageGenerator = new ImageGenerator();