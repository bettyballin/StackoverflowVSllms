foreach ($stuff as $key) {\n    $query3 = "SELECT * FROM foobar WHERE id = ?";\n    $stmt3 = $link_id->prepare($query3);\n    $stmt3->bind_param("i", $key);\n    $stmt3->execute();\n    $result3 = $stmt3->get_result();\n\n    if ($result3->num_rows > 0) {\n        while ($data3 = $result3->fetch_assoc()) {\n            $query4 = "SELECT * FROM foobar_img WHERE id = ?";\n            $stmt4 = $link_id->prepare($query4);\n            $stmt4->bind_param("i", $data3['id']);\n            $stmt4->execute();\n            $result4 = $stmt4->get_result();\n\n            if ($result4->num_rows > 0) {\n                while ($data4 = $result4->fetch_assoc()) {\n                    $x += 1;\n                    if ($x % 3 == 0) {\n                        echo "a: " . $data3['column_name'];\n                    } else {\n                        echo "b: " . $data3['column_name'];\n                    }\n                }\n            }\n        }\n    }\n}