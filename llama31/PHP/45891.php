class ClassDetector extends IteratorIterator {\n    private $master = array();\n\n    public function current() {\n        $file = parent::current();\n        if (preg_match($regex, $file->getContents(), $match)) {\n            $matchResults = array(\n                'class1' => $file->getFilename(),\n                'class2' => $file->getFilename(),\n                'class3' => $file->getFilename(),\n            );\n            $this->master = array_merge($this->master, $matchResults);\n        }\n        return $this->master;\n    }\n}\n\n$php_files = new PhpFileFilter(new RecursiveIteratorIterator(new RecursiveDirectoryIterator($dir)));\n$classDetector = new ClassDetector($php_files);\n\nforeach ($classDetector as $class => $file) {\n    print "{$class} => {$file}\n";\n}