function addChildren(DOMElement $parent, array $children) {\n    foreach ($children as $childName => $grandChildren) {\n        $child = $parent->ownerDocument->createElement($childName);\n        $parent->appendChild($child);\n        if (is_array($grandChildren)) {\n            addChildren($child, $grandChildren);\n        } elseif (is_string($grandChildren)) {\n            $child->nodeValue = $grandChildren;\n        }\n    }\n}\n\n$DOMXML = new DOMDocument();\n$root = $DOMXML->createElement('root');\n$DOMXML->appendChild($root);\n\n$children = [\n    'el1' => [\n        'el2' => [\n            'el3' => [\n                'el4' => 'text'\n            ]\n        ]\n    ]\n];\n\naddChildren($root, $children);\n\necho $DOMXML->saveXML();