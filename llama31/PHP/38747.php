$this->image = imagecreatefrompng($filename);\n\nimagesavealpha($this->image, true);\n\n$newImage = imagecreatetruecolor($width, $height);\nimagealphablending($newImage, false);\nimagesavealpha($newImage, true);\n\n$transparent = imagecolorallocatealpha($newImage, 255, 255, 255, 127);\nimagefill($newImage, 0, 0, $transparent);\n\nimagecopyresampled($newImage, $this->image, 0, 0, 0, 0, $width, $height,  $this->getWidth(), $this->getHeight());\n\n$this->image = $newImage;  \n\nimagepng($this->image, $filename);