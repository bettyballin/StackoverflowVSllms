// file.php (in public_html directory)\n\n// Check if user is logged in\nif (!isset($_SESSION['loggedin']) || $_SESSION['loggedin'] !== true) {\n    header('HTTP/1.1 403 Forbidden');\n    exit;\n}\n\n// Get the file request\n$file = $_GET['file'];\n\n// Validate file request (e.g., check if it's a valid file name)\nif (!preg_match('/^[a-zA-Z0-9._-]+$/', $file)) {\n    header('HTTP/1.1 400 Bad Request');\n    exit;\n}\n\n// Set the file path (outside public directory)\n$filePath = '../files/' . $file;\n\n// Check if file exists\nif (!file_exists($filePath)) {\n    header('HTTP/1.1 404 Not Found');\n    exit;\n}\n\n// Send the file with proper headers\nheader('Content-Type: ' . getMimeType($file));\nheader('Content-Length: ' . filesize($filePath));\nreadfile($filePath);\nexit;\n\n// Helper function to get MIME type\nfunction getMimeType($file) {\n    $mimeTypes = array(\n        'mp4' => 'video/mp4',\n        'mp3' => 'audio/mpeg',\n        // Add more MIME types as needed\n    );\n    $extension = pathinfo($file, PATHINFO_EXTENSION);\n    return $mimeTypes[$extension];\n}