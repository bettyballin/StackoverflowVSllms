// image_download.php\n\n// Configuration\n$imageDir = 'images/'; // directory where images are stored\n$baseUrl = 'http://example.com/'; // your website's base URL\n\n// Check if user is logged in (replace with your own session logic)\nif (!isset($_SESSION['logged_in']) || $_SESSION['logged_in'] !== true) {\n    header('HTTP/1.1 403 Forbidden');\n    exit;\n}\n\n// Get the requested image name from the URL\n$imageName = basename($_GET['image']);\n\n// Validate the image name (e.g., only allow alphanumeric chars and extensions)\nif (!preg_match('/^[a-zA-Z0-9_-]+\.(jpg|jpeg|png|gif)$/', $imageName)) {\n    header('HTTP/1.1 400 Bad Request');\n    exit;\n}\n\n// Construct the image path\n$imagePath = $imageDir . $imageName;\n\n// Check if the image exists\nif (!file_exists($imagePath)) {\n    header('HTTP/1.1 404 Not Found');\n    exit;\n}\n\n// Serve the image\nheader('Content-Type: image/' . pathinfo($imageName, PATHINFO_EXTENSION));\nheader('Content-Disposition: attachment; filename="' . $imageName . '"');\nreadfile($imagePath);\nexit;