function buildHierarchicalTags($nestedArray) {\n    $html = '';\n    $stack = array();\n    foreach ($nestedArray as $item) {\n        while (count($stack) > $item['depth']) {\n            array_pop($stack);\n            $html .= '</ul>';\n        }\n        if (count($stack) == $item['depth']) {\n            $html .= '<ul>';\n            array_push($stack, $item['depth']);\n        }\n        $html .= '<li>' . $item['name'];\n    }\n    while (count($stack) > 0) {\n        array_pop($stack);\n        $html .= '</ul>';\n    }\n    return '<div>' . $html . '</div>';\n}\n\n$nestedArray = array(\n    array('name' => 'foo', 'depth' => 0),\n    array('name' => 'bar', 'depth' => 0),\n    array('name' => 'sub-bar', 'depth' => 1)\n);\n\necho buildHierarchicalTags($nestedArray);