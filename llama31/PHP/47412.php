<?php\n\n// Configuration\n$maxWidth = 200; // Maximum allowed width\n$maxHeight = 200; // Maximum allowed height\n\n// Get the uploaded image\n$image = $_FILES['image'];\n\n// Get the image type\n$imageType = exif_imagetype($image['tmp_name']);\n\n// Check if the image type is supported\nif ($imageType !== IMAGETYPE_GIF && $imageType !== IMAGETYPE_JPEG && $imageType !== IMAGETYPE_PNG) {\n    throw new Exception('Unsupported image type');\n}\n\n// Create a GD image resource\nswitch ($imageType) {\n    case IMAGETYPE_GIF:\n        $img = imagecreatefromgif($image['tmp_name']);\n        break;\n    case IMAGETYPE_JPEG:\n        $img = imagecreatefromjpeg($image['tmp_name']);\n        break;\n    case IMAGETYPE_PNG:\n        $img = imagecreatefrompng($image['tmp_name']);\n        break;\n}\n\n// Get the image dimensions\n$width = imagesx($img);\n$height = imagesy($img);\n\n// Resize the image if it's too large\nif ($width > $maxWidth || $height > $maxHeight) {\n    $ratio = min($maxWidth / $width, $maxHeight / $height);\n    $newWidth = (int) ($width * $ratio);\n    $newHeight = (int) ($height * $ratio);\n    $newImg = imagecreatetruecolor($newWidth, $newHeight);\n    imagecopyresampled($newImg, $img, 0, 0, 0, 0, $newWidth, $newHeight, $width, $height);\n    $img = $newImg;\n}\n\n// Convert the image to PNG\nimagepng($img, 'output.png');\n\n// Get the PNG image data\n$pngData = file_get_contents('output.png');\n\n// Insert the PNG image data into the database\n// ...\n\n// Clean up\nimagedestroy($img);\nunlink('output.png');\n\n?>