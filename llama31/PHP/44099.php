$temp_image_file = imagecreatefromjpeg("http://www.example.com/image.jpg");\n\nlist($width, $height) = getimagesize("http://www.example.com/image.jpg");\n\n// Define the desired thumbnail dimensions\n$thumb_width = 166;\n$thumb_height = 103;\n\n// Calculate the aspect ratio of the original image\n$aspect_ratio = $width / $height;\n\n// Calculate the new dimensions of the image\nif ($width / $thumb_width > $height / $thumb_height) {\n    // Image is wider than the thumbnail, so add filler to the top and bottom\n    $new_height = (int) ($thumb_width / $aspect_ratio);\n    $offset_y = (int) (($thumb_height - $new_height) / 2);\n    $new_width = $thumb_width;\n} else {\n    // Image is taller than the thumbnail, so add filler to the left and right\n    $new_width = (int) ($thumb_height * $aspect_ratio);\n    $offset_x = (int) (($thumb_width - $new_width) / 2);\n    $new_height = $thumb_height;\n}\n\n// Create a new canvas with the desired dimensions\n$image_file = imagecreatetruecolor($thumb_width, $thumb_height);\n\n// Set the filler color to black (or any other color you want)\n$filler_color = imagecolorallocate($image_file, 0, 0, 0);\nimagefilledrectangle($image_file, 0, 0, $thumb_width, $thumb_height, $filler_color);\n\n// Copy the original image onto the new canvas with the calculated dimensions\nimagecopyresampled($image_file, $temp_image_file, $offset_x, $offset_y, 0, 0, $new_width, $new_height, $width, $height);\n\nimagejpeg($image_file, "thumbnails/thumbnail.jpg", 50);\n\nimagedestroy($temp_image_file);\nimagedestroy($image_file);