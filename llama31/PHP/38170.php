// Assuming you have a Drupal database connection established\n$db = \Drupal::database();\n\n// Create a temporary table to store the CSV data\n$db->query("CREATE TEMPORARY TABLE csv_data (\n  email VARCHAR(255)\n)");\n\n// Load the CSV data into the temporary table\n$csv_file = $_FILES['csv_file']['tmp_name']; // assuming this is the uploaded CSV file\n$fp = fopen($csv_file, 'r');\nwhile ($row = fgetcsv($fp)) {\n  $email = trim($row[0]); // assuming the email is in the first column\n  $db->query("INSERT INTO csv_data (email) VALUES (:email)", [':email' => $email]);\n}\nfclose($fp);\n\n// Perform the JOIN with your existing table\n$result = $db->query("SELECT DISTINCT t1.email\n  FROM your_existing_table t1\n  INNER JOIN csv_data t2 ON t1.email = t2.email\n");\n\n// Fetch and process the results\nwhile ($row = $result->fetchAssoc()) {\n  // do something with $row['email']\n}\n\n// Don't forget to drop the temporary table\n$db->query("DROP TABLE csv_data");