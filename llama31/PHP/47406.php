<?php\n\n// Set the master username and password\n$master_username = 'admin';\n$master_password = 'password';\n\n// Set the secret code for the cookie\n$secret_code = 'my_secret_code';\n\n// Function to generate the cookie value\nfunction generate_cookie($ip_address) {\n  global $secret_code;\n  return hash('sha256', $ip_address . $secret_code);\n}\n\n// Function to verify the cookie value\nfunction verify_cookie($cookie_value, $ip_address) {\n  global $secret_code;\n  return $cookie_value === hash('sha256', $ip_address . $secret_code);\n}\n\n// Check if the form has been submitted\nif ($_SERVER['REQUEST_METHOD'] === 'POST') {\n  // Get the username and password from the form\n  $username = $_POST['username'];\n  $password = $_POST['password'];\n\n  // Check if the credentials are correct\n  if ($username === $master_username && $password === $master_password) {\n    // Generate the cookie value and set the cookie\n    $cookie_value = generate_cookie($_SERVER['REMOTE_ADDR']);\n    setcookie('auth', $cookie_value, time() + 3600); // expires in 1 hour\n\n    // Redirect to the protected page\n    header('Location: protected.php');\n    exit;\n  } else {\n    // Display an error message\n    echo 'Invalid credentials';\n  }\n}\n\n// Display the login form\n?>\n\n<form action="" method="post">\n  <label for="username">Username:</label>\n  <input type="text" id="username" name="username"><br><br>\n  <label for="password">Password:</label>\n  <input type="password" id="password" name="password"><br><br>\n  <input type="submit" value="Login">\n</form>