<?php\n// generate a token and store it in the user's session\n$token = bin2hex(random_bytes(16));\n$_SESSION['download_token'] = $token;\n\n// generate a URL for the file download\n$file_url = 'download.php?token=' . $token . '&file=' . $file_name;\n\n// when the user clicks the link, verify the token and serve the file\nif (isset($_GET['token']) && $_GET['token'] === $_SESSION['download_token']) {\n    // serve the file as above\n} else {\n    // handle token verification failure\n}