// Generate a random token\n$token = openssl_random_pseudo_bytes(32);\n\n// Store the token in the database\nmysqli_query($db, "INSERT INTO tokens (email, token, expires) VALUES ('$email', '$token', NOW() + INTERVAL 30 MINUTE)");\n\n// Include the token in the email link\n$emailLink = "https://example.com/update-profile?email=$email&token=" . bin2hex($token);\n\n// Validate the token when the user clicks the link\nif (isset($_GET['token'])) {\n    $token = hex2bin($_GET['token']);\n    $result = mysqli_query($db, "SELECT * FROM tokens WHERE email = '$email' AND token = '$token' AND expires > NOW()");\n    if (mysqli_num_rows($result) === 1) {\n        // Allow access to the update profile page\n    } else {\n        // Token is invalid or has expired\n    }\n}