class Login {\n    private $db;\n\n    public function __construct($db_host, $db_username, $db_password, $db_name) {\n        $this->db = new mysqli($db_host, $db_username, $db_password, $db_name);\n\n        if ($this->db->connect_error) {\n            die("Connection failed: " . $this->db->connect_error);\n        }\n    }\n\n    public function login($username, $password) {\n        $query = "SELECT * FROM users WHERE username = ?";\n\n        $stmt = $this->db->prepare($query);\n        $stmt->bind_param("s", $username);\n        $stmt->execute();\n        $result = $stmt->get_result();\n\n        if ($result->num_rows > 0) {\n            $user_data = $result->fetch_assoc();\n\n            if (password_verify($password, $user_data['password'])) {\n                // Login successful\n                return true;\n            }\n        }\n\n        // Login failed\n        return false;\n    }\n\n    public function register($username, $password, $role) {\n        $hashed_password = password_hash($password, PASSWORD_DEFAULT);\n\n        $query = "INSERT INTO users (username, password, role) VALUES (?, ?, ?)";\n\n        $stmt = $this->db->prepare($query);\n        $stmt->bind_param("sss", $username, $hashed_password, $role);\n        $stmt->execute();\n\n        return $stmt->affected_rows > 0;\n    }\n\n    public function has_role($username, $role) {\n        $query = "SELECT * FROM users WHERE username = ? AND role = ?";\n\n        $stmt = $this->db->prepare($query);\n        $stmt->bind_param("ss", $username, $role);\n        $stmt->execute();\n        $result = $stmt->get_result();\n\n        return $result->num_rows > 0;\n    }\n}