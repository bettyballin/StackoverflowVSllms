class My_Validate_PasswordMatch extends Zend_Validate_Abstract\n{\n    const NOT_MATCH = 'notMatch';\n\n    protected $_messageTemplates = array(\n        self::NOT_MATCH => 'Passwords do not match'\n    );\n\n    public function isValid($value, $context = null)\n    {\n        if (!isset($context['password'])) {\n            return false;\n        }\n\n        $passwordHash = new Ivo_Filters_Sha1Filter();\n        $hash = $passwordHash->filter($value);\n\n        if ($hash !== $context['password']) {\n            $this->_error(self::NOT_MATCH);\n            return false;\n        }\n\n        return true;\n    }\n}