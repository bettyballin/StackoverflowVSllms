// Assume you have the PayPal API credentials and button IDs stored in your database\n\n// Function to create a new subscription\nfunction createSubscription($membershipLevel, $userId) {\n  $paypalApiUrl = 'https://www.paypal.com/cgi-bin/webscr';\n  $postData = array(\n    'cmd' => '_xclick-subscriptions',\n    'business' => 'your_paypal_email',\n    'item_name' => $membershipLevel,\n    'item_number' => $userId,\n    'amount' => $membershipLevel == 'Gold' ? 4 : 10,\n    'currency_code' => 'USD',\n    'no_note' => 1,\n    'no_shipping' => 1,\n    'return' => 'https://yourwebsite.com/success',\n    'cancel_return' => 'https://yourwebsite.com/cancel'\n  );\n\n  $ch = curl_init($paypalApiUrl);\n  curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\n  curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($postData));\n  $response = curl_exec($ch);\n  curl_close($ch);\n\n  // Parse the response to get the subscription ID\n  $subscriptionId = parsePayPalResponse($response);\n\n  // Store the subscription ID in your database\n  updateSubscriptionId($userId, $subscriptionId);\n}\n\n// Function to cancel a subscription\nfunction cancelSubscription($subscriptionId) {\n  $paypalApiUrl = 'https://www.paypal.com/cgi-bin/webscr';\n  $postData = array(\n    'cmd' => '_cancel-subscription',\n    'subscription_id' => $subscriptionId\n  );\n\n  $ch = curl_init($paypalApiUrl);\n  curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\n  curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($postData));\n  $response = curl_exec($ch);\n  curl_close($ch);\n\n  // Parse the response to ensure the subscription was cancelled successfully\n  parsePayPalResponse($response);\n}\n\n// Function to refund a surplus amount\nfunction refundSurplus($subscriptionId, $amount) {\n  $paypalApiUrl = 'https://www.paypal.com/cgi-bin/webscr';\n  $postData = array(\n    'cmd' => '_refund',\n    'subscription_id' => $subscriptionId,\n    'amount' => $amount\n  );\n\n  $ch = curl_init($paypalApiUrl);\n  curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\n  curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($postData));\n  $response = curl_exec($ch);\n  curl_close($ch);\n\n  // Parse the response to ensure the refund was successful\n  parsePayPalResponse($response);\n}