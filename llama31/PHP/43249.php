$activities = $db->query('SELECT a.* FROM Activities a JOIN Followers f ON a.user_id = f.follower_id WHERE f.user_id = ?', array($userId));\n\n$groupedActivities = array();\nforeach ($activities as $activity) {\n    if (!isset($groupedActivities[$activity->activity_type])) {\n        $groupedActivities[$activity->activity_type] = array();\n    }\n    $groupedActivities[$activity->activity_type][] = $activity;\n}\n\n// Sort the grouped activities\nuasort($groupedActivities, function($a, $b) {\n    return count($b) - count($a);\n});