$doc = new DOMDocument();\n$doc->loadHTML(ob_get_contents());\nob_clean();\n\n$xpath = new DOMXPath($doc);\n$textNodes = $xpath->query('//text()');\n\nforeach ($textNodes as $textNode) {\n    $text = $textNode->nodeValue;\n    if (stripos($text, $term) !== false) {\n        $span = $doc->createElement('span', $text);\n        $span->setAttribute('style', 'background: #f00');\n        $textNode->parentNode->replaceChild($span, $textNode);\n    }\n}\n\necho $doc->saveHTML();