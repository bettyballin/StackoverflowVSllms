$image = imagecreatetruecolor($width, $height);\n$imageSource = imagecreatefromjpeg('input.jpg');\nfor ($x = 0; $x < $width; $x++) {\n    for ($y = 0; $y < $height; $y++) {\n        $rgb = imagecolorat($imageSource, $x, $y);\n        $r = ($rgb >> 16) & 0xFF;\n        $g = ($rgb >> 8) & 0xFF;\n        $b = $rgb & 0xFF;\n        $grey = (int)(0.2126 * $r + 0.7152 * $g + 0.0722 * $b);\n        imagesetpixel($image, $x, $y, imagecolorallocate($image, $grey, $grey, $grey));\n    }\n}\nimagejpeg($image, 'output.jpg');\nimagedestroy($image);