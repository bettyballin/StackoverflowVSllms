function explode_with_continuation($content) {\n    $lines = [];\n    $currentLine = '';\n    $continuation = false;\n\n    foreach (explode("\n", $content) as $line) {\n        if ($continuation) {\n            $currentLine .= " " . trim($line);\n            if (substr(trim($line), -1) !== '!') {\n                $continuation = false;\n                $lines[] = $currentLine;\n                $currentLine = '';\n            }\n        } else {\n            if (substr(trim($line), -1) === '!') {\n                $continuation = true;\n                $currentLine = trim($line);\n            } else {\n                $lines[] = trim($line);\n            }\n        }\n    }\n\n    if ($continuation) {\n        $lines[] = $currentLine;\n    }\n\n    return $lines;\n}