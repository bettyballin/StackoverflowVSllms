$ldap_conn = ldap_connect("ldap://your_ldap_server");\nldap_set_option($ldap_conn, LDAP_OPT_PROTOCOL_VERSION, 3);\nldap_set_option($ldap_conn, LDAP_OPT_REFERRALS, 0);\n\n$username = "username_to_check";\n$filter = "(sAMAccountName=$username)";\n$attrs = array("msDS-User-Account-Control-Computed");\n\n$result = ldap_search($ldap_conn, "dc=your_domain,dc=com", $filter, $attrs);\n$entries = ldap_get_entries($ldap_conn, $result);\n\nif ($entries["count"] > 0) {\n    $account_control = $entries[0]["msds-user-account-control-computed"][0];\n    if ($account_control & 2) { // 2 is the flag for ACCOUNTDISABLE\n        echo "Account is locked";\n    } else {\n        echo "Account is not locked";\n    }\n} else {\n    echo "User not found";\n}