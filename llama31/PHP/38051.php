function CreatePageIndex($ItemsPerPage, $TotalNumberOfItems, $CurrentOffset, $URL, $URLArguments = array()) {\n    $NumberOfPages = ceil($TotalNumberOfItems / $ItemsPerPage);\n    $CurrentPage = floor($CurrentOffset / $ItemsPerPage) + 1;\n\n    $StartPage = max(1, $CurrentPage - 5);\n    $EndPage = min($NumberOfPages, $CurrentPage + 5);\n\n    $FirstIndexDone = false;\n    foreach($URLArguments as $Key => $Value) {\n        if($FirstIndexDone == false) {\n            $URL .= sprintf("?%s=%s", $Key, $Value);\n            $FirstIndexDone = true;\n        } else {\n            $URL .= sprintf("&%s=%s", $Key, $Value);\n        }\n    }\n\n    Print("<div id=\"ResultsNavigation\">");\n    Print("Page: ");\n    Print("<span class=\"Links\">");\n\n    if ($CurrentPage > 1) {\n        Print("<a href=\"".$URL."&Offset=0\">&lt;&lt;</a> ");\n    }\n\n    if ($StartPage > 1) {\n        Print("<a href=\"".$URL."&Offset=".($StartPage - 1) * $ItemsPerPage."\">...</a> ");\n    }\n\n    for($x = $StartPage; $x <= $EndPage; $x++) {\n        if($x == $CurrentPage) {\n            Print("<span class=\"Selected\">$x</span> ");\n        } else {\n            Print("<a href=\"".$URL."&Offset=".($x - 1) * $ItemsPerPage."\">$x</a> ");\n        }\n    }\n\n    if ($EndPage < $NumberOfPages) {\n        Print("<a href=\"".$URL."&Offset=".($EndPage + 1) * $ItemsPerPage."\">...</a> ");\n    }\n\n    if ($CurrentPage < $NumberOfPages) {\n        Print("<a href=\"".$URL."&Offset=".($NumberOfPages - 1) * $ItemsPerPage."\">&gt;&gt;</a> ");\n    }\n\n    Print("</span>");\n    Print(" (".$TotalNumberOfItems." results)");\n    Print("</div>");\n}