// Assuming you have a Zend_Db_Adapter instance\n$db = Zend_Db_Table_Abstract::getDefaultAdapter();\n\n// Fetch locations for a specific course\n$locations = $db->fetchAll(\n    'SELECT l.* FROM locations l \n     JOIN sessions s ON l.locationid = s.locationid \n     WHERE s.courseid = ?', \n    array($courseId)\n);\n\n// Create a custom Rowset class for sessions\nclass SessionRowset extends Zend_Db_Table_Rowset_Abstract\n{\n    protected $_rowClass = 'SessionRow';\n}\n\nclass SessionRow extends Zend_Db_Table_Row_Abstract\n{\n    protected $_dates;\n\n    public function init()\n    {\n        $db = Zend_Db_Table_Abstract::getDefaultAdapter();\n        $this->_dates = $db->fetchAll(\n            'SELECT d.* FROM dates d \n             WHERE d.sessionid = ?', \n            array($this->sessionid)\n        );\n    }\n\n    public function getDates()\n    {\n        return $this->_dates;\n    }\n}\n\n// Create a custom Rowset class for locations\nclass LocationRowset extends Zend_Db_Table_Rowset_Abstract\n{\n    protected $_rowClass = 'LocationRow';\n}\n\nclass LocationRow extends Zend_Db_Table_Row_Abstract\n{\n    protected $_sessions;\n\n    public function init()\n    {\n        $db = Zend_Db_Table_Abstract::getDefaultAdapter();\n        $this->_sessions = $db->fetchAll(\n            'SELECT s.* FROM sessions s \n             WHERE s.locationid = ?', \n            array($this->locationid)\n        );\n        $this->_sessions = new SessionRowset($this->_sessions);\n    }\n\n    public function getSessions()\n    {\n        return $this->_sessions;\n    }\n}\n\n// Create the Location Rowset\n$locationRowset = new LocationRowset($locations);\n\n// Now you can iterate over each location, session, and date\nforeach ($locationRowset as $location) {\n    echo $location->locationid;\n    foreach ($location->getSessions() as $session) {\n        echo $session->sessionid;\n        foreach ($session->getDates() as $date) {\n            echo $date->date;\n        }\n    }\n}