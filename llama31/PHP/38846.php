class FileLinesIterator implements Iterator {\n    private $file;\n    private $line;\n\n    public function __construct($fname) {\n        $this->file = fopen($fname, 'r');\n    }\n\n    public function rewind() {\n        fseek($this->file, 0);\n    }\n\n    public function current() {\n        return $this->line;\n    }\n\n    public function key() {\n        return ftell($this->file);\n    }\n\n    public function next() {\n        $this->line = fgets($this->file);\n        if ($this->line === false) {\n            fclose($this->file);\n        }\n    }\n\n    public function valid() {\n        return $this->line !== false;\n    }\n}\n\n$iterator = new FileLinesIterator('somefile');\nforeach ($iterator as $line) {\n    // process the line\n}