// Validate token and serve file\nif (isset($token_data['token']) && $token_data['token'] === $token\n    && $token_data['expiration_time'] > time()) {\n    // Serve the file\n    header('Content-Type: ' . mime_content_type($file_path));\n    readfile($file_path);\n    exit;\n} else {\n    // Token is invalid or expired, return an error\n    http_response_code(403);\n    echo 'Access denied';\n    exit;\n}