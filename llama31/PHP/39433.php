// Generate a random token\n$token = bin2hex(random_bytes(16));\n\n// Store the token in the user's record\n$query = "UPDATE users SET token = '$token', token_expires = NOW() + INTERVAL 30 MINUTE WHERE user_id = '...'";\n// ...\n\n// Hash the 9-digit number\n$hashed_number = password_hash($_POST['9_digit_number'], PASSWORD_DEFAULT);\n\n// Compare the hashes\nif (password_verify($hashed_number, $stored_hash)) {\n    // Verify the token\n    if ($token === $_POST['token'] && $token_expires > time()) {\n        // Update the password\n        $new_password = password_hash($_POST['new_password'], PASSWORD_DEFAULT);\n        $query = "UPDATE users SET password = '$new_password' WHERE user_id = '...'";\n        // ...\n    }\n}