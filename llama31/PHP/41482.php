// login.php\nclass Auth {\n    private $db;\n\n    public function __construct($db) {\n        $this->db = $db;\n    }\n\n    public function login($username, $password) {\n        // Use prepared statements to prevent SQL injection\n        $stmt = $this->db->prepare('SELECT * FROM users WHERE username = :username');\n        $stmt->bindParam(':username', $username);\n        $stmt->execute();\n\n        $user = $stmt->fetch();\n\n        if ($user && password_verify($password, $user['password'])) {\n            // Start a new session\n            session_start();\n            $_SESSION['user_id'] = $user['id'];\n            return true;\n        }\n\n        return false;\n    }\n\n    public function isLoggedIn() {\n        return isset($_SESSION['user_id']);\n    }\n\n    public function logout() {\n        session_destroy();\n    }\n}\n\n// Example usage:\n$db = new PDO('mysql:host=localhost;dbname=yourdatabase', 'yourusername', 'yourpassword');\n$auth = new Auth($db);\n\nif ($auth->login($_POST['username'], $_POST['password'])) {\n    echo 'Logged in successfully!';\n} else {\n    echo 'Invalid credentials.';\n}\n\n// To check if the user is logged in:\nif ($auth->isLoggedIn()) {\n    echo 'Welcome, user!';\n} else {\n    echo 'Please log in.';\n}