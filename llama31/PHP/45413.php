if (isset($_GET["hash"])) {\n    $this_min = date('Y-m-d-g',time()) . "salt" . $vid_id;\n    $current_hash =  substr(md5($this_min),0,12);\n    $submitted_hash = mysql_real_escape_string($_GET["hash"]);\n    if ("$current_hash" == "$submitted_hash") {\n        $file_url2 = "directory/" .  $vid_file;\n        $token = md5($file_url2 . $current_hash); // generate a token\n        header('Content-Type: application/octet-stream');\n        header("Content-Transfer-Encoding: Binary"); \n        header("Content-disposition: inline; filename=\"".md5($vid_file)."\""); \n        header("X-Token: $token"); // set the token header\n        readfile($file_url2);\n        exit;\n    } else {\n        // error handling...\n    }\n}