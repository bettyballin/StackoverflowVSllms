// Producer (data collector)\nuse PhpAmqpLib\Connection\AMQPStreamConnection;\nuse PhpAmqpLib\Message\AMQPMessage;\n\n$connection = new AMQPStreamConnection('localhost', 5672, 'guest', 'guest');\n$channel = $connection->channel();\n\n// Create a queue\n$channel->queue_declare('stats_queue', false, false, false, false);\n\n// Collect data and send to queue\n$data = array('IP' => $_SERVER['REMOTE_ADDR'], 'time' => time(), 'http_referer' => $_SERVER['HTTP_REFERER']);\n$message = new AMQPMessage(json_encode($data));\n$channel->basic_publish($message, '', 'stats_queue');\n\n// Consumer (data processor)\nuse PhpAmqpLib\Connection\AMQPStreamConnection;\n\n$connection = new AMQPStreamConnection('localhost', 5672, 'guest', 'guest');\n$channel = $connection->channel();\n\n// Consume messages from queue\n$channel->basic_consume('stats_queue', '', false, true, false, false, function (AMQPMessage $message) {\n    // Process the message (insert into MySQL or buffer in Redis)\n    $data = json_decode($message->body, true);\n    // ...\n});