// plugins/authentication/unified/unified.php\n\ndefined('_JEXEC') or die;\n\nclass PlgAuthenticationUnified extends JPlugin\n{\n    public function onUserAuthenticate($credentials, $options, &$response)\n    {\n        // Check if the user is an administrator\n        $isAdmin = JFactory::getApplication()->isAdmin();\n\n        // Authenticate the user\n        $auth = JFactory::getDbo()->getQuery(true)\n            ->select('id, password')\n            ->from('#__users')\n            ->where('username = ' . $credentials['username']);\n\n        $result = JFactory::getDbo()->setQuery($auth)->loadObject();\n\n        if ($result && JUserHelper::verifyPassword($credentials['password'], $result->password)) {\n            // If the user is an administrator, log them in to the administrator area\n            if ($isAdmin) {\n                $app = JFactory::getApplication('administrator');\n                $app->login($credentials);\n            }\n\n            // Log the user in to the frontend\n            JFactory::getApplication('site')->login($credentials);\n\n            $response->status = JAuthentication::STATUS_SUCCESS;\n        } else {\n            $response->status = JAuthentication::STATUS_FAILURE;\n        }\n    }\n}