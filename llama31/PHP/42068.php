// Reading the file as GD image data\n$imagedata = imagecreatefrompng($imagefile);\n// Do some GD processing: Adding watermarks etc. No problem here...\n\n// Convert the $imagedata to $stringdata\nob_start();\nimagepng($imagedata, null, 9); // 9 is the compression level\n$stringdata = ob_get_contents();\nob_end_clean();\n\n// Compressing the string data\n$zdata = gzdeflate($stringdata);