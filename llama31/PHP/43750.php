// index.php\n$token = generate_token(); // generate a random token\n$_SESSION['token'] = $token;\necho "<iframe src='http://www.mydomain.com/iframe.php?token=$token&map_id=foo'></iframe>";\n\n// iframe.php\n$token = $_GET['token'];\nif (validate_token($token)) { // validate the token on the server-side\n    $map_id = $_GET['map_id'];\n    // authenticate and display the map\n} else {\n    // handle invalid token\n}\n\n// Authenticate.php\n$token = $_GET['token'];\nif (validate_token($token)) { // validate the token on the server-side\n    // authenticate and return the map data\n} else {\n    // handle invalid token\n}