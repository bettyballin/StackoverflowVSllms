function decrypt($key1, $key2, $key3, $iv, $token) {\n    $td = mcrypt_module_open('tripledes', '', 'cbc', '');\n    $iv = substr($iv, 0, mcrypt_enc_get_iv_size($td));\n    $key = $key1 . $key2 . $key3; // Concatenate the three keys\n\n    mcrypt_generic_init($td, $key, $iv);\n\n    $decrypted_string = trim(mdecrypt_generic($td, hex2bin($token))); // Use hex2bin instead of base64_decode\n\n    mcrypt_generic_deinit($td);\n    mcrypt_module_close($td);\n\n    return $decrypted_string;\n}