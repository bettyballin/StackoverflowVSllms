// Generate token and store it in database\n$token = md5(uniqid());\n$db->insert('downloads', array('token' => $token));\n\n// Create download link with token\n<a href="download.php?token=<?php echo $token; ?>">Download File</a>\n\n// In download.php:\nif (isset($_GET['token']) && $db->exists('downloads', array('token' => $_GET['token']))) {\n    // Increment counter and redeem token\n    $db->update('downloads', array('downloads' => 'downloads + 1'), array('token' => $_GET['token']));\n    $db->delete('downloads', array('token' => $_GET['token']));\n    // Serve the file\n} else {\n    // Invalid or missing token, don't serve file\n}