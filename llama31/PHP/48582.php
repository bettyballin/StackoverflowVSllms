$lock_id = sem_get(ftok('tmp/this.lock', 'r'));\n$retry_count = 0;\n$max_retries = 3;\n\nwhile ($retry_count < $max_retries) {\n    if (sem_acquire($lock_id)) {\n        // do something\n        sem_release($lock_id);\n        break;\n    } elseif (errno() == EINTR) {\n        $retry_count++;\n        usleep(10000); // wait for 10ms before retrying\n    } else {\n        // handle other errors\n        break;\n    }\n}