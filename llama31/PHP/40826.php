function validateCart() {\n  // Check if both required items are in the cart\n  $item1 = in_array('item1', $_SESSION['cart']);\n  $item2 = in_array('item2', $_SESSION['cart']);\n\n  if ($item1 && $item2) {\n    // Generate a token and store it in the cart session\n    $token = bin2hex(random_bytes(16));\n    $_SESSION['cart']['token'] = $token;\n\n    // Apply the discount\n    $_SESSION['cart']['discount'] = 50;\n\n    // Hash the cart contents, including the token\n    $hash = hash('sha256', serialize($_SESSION['cart']));\n    $_SESSION['cart']['hash'] = $hash;\n  }\n}\n\nfunction updateCart() {\n  // Verify the token and hash on each cart update\n  if (isset($_SESSION['cart']['token']) && isset($_SESSION['cart']['hash'])) {\n    $token = $_SESSION['cart']['token'];\n    $hash = $_SESSION['cart']['hash'];\n\n    // Re-run the cart validation function\n    validateCart();\n\n    // If the discount was previously applied, but either item is no longer in the cart\n    if (!in_array('item1', $_SESSION['cart']) || !in_array('item2', $_SESSION['cart'])) {\n      // Remove the discount and invalidate the token\n      unset($_SESSION['cart']['discount']);\n      unset($_SESSION['cart']['token']);\n    }\n\n    // Verify the hash\n    if ($hash !== hash('sha256', serialize($_SESSION['cart']))) {\n      // Hash mismatch, invalidate the cart session\n      unset($_SESSION['cart']);\n    }\n  }\n}