$batchSize = 100;\n$batchData = array();\n\nforeach ($itemList as $key => $item) {\n    $download_records = new DownloadRecords();\n    // check first if the content exists\n    if (!$download_records->selectRecordsFromCondition("WHERE Guid=" . $guid)) {\n        $batchData[] = array(\n            'Guid' => $guid,\n            // add other columns here\n        );\n    } else {\n        // do an update\n    }\n\n    // check if batch is full\n    if (count($batchData) >= $batchSize) {\n        // insert batch\n        $sql = "INSERT INTO your_table (Guid, ...) VALUES ";\n        $values = array();\n        foreach ($batchData as $row) {\n            $values[] = "(" . implode(',', $row) . ")";\n        }\n        $sql .= implode(',', $values);\n        // execute query\n        $download_records->executeQuery($sql);\n        // reset batch\n        $batchData = array();\n    }\n}\n\n// insert remaining batch\nif (count($batchData) > 0) {\n    $sql = "INSERT INTO your_table (Guid, ...) VALUES ";\n    $values = array();\n    foreach ($batchData as $row) {\n        $values[] = "(" . implode(',', $row) . ")";\n    }\n    $sql .= implode(',', $values);\n    // execute query\n    $download_records->executeQuery($sql);\n}