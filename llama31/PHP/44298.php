// Configuration\n$max_size = 2 * 1024 * 1024; // 2MB\n$allowed_extensions = array('png', 'jpg', 'gif');\n$upload_dir = 'uploads/'; // directory to save the files\n\n// Check if the file is uploaded\nif (isset($_FILES['image'])) {\n    $file = $_FILES['image'];\n\n    // Check file size and extension\n    if ($file['size'] <= $max_size && in_array(strtolower(pathinfo($file['name'], PATHINFO_EXTENSION)), $allowed_extensions)) {\n        // Rename the file\n        $new_name = uniqid() . '.' . strtolower(pathinfo($file['name'], PATHINFO_EXTENSION));\n\n        // Move the uploaded file to the upload directory\n        if (move_uploaded_file($file['tmp_name'], $upload_dir . $new_name)) {\n            // Create a thumbnail\n            $thumbnail_name = 'thumb_' . $new_name;\n            $image = imagecreatefromstring(file_get_contents($upload_dir . $new_name));\n            $width = imagesx($image);\n            $height = imagesy($image);\n            $ratio = min(100 / $width, 100 / $height); // thumbnail size: 100x100\n            $thumb_width = $width * $ratio;\n            $thumb_height = $height * $ratio;\n            $thumb = imagecreatetruecolor($thumb_width, $thumb_height);\n            imagecopyresampled($thumb, $image, 0, 0, 0, 0, $thumb_width, $thumb_height, $width, $height);\n            imagejpeg($thumb, $upload_dir . $thumbnail_name, 90);\n\n            // Save the thumbnail\n            imagedestroy($image);\n            imagedestroy($thumb);\n\n            echo 'Image uploaded and thumbnail created!';\n        } else {\n            echo 'Error moving uploaded file!';\n        }\n    } else {\n        echo 'Invalid file size or extension!';\n    }\n} else {\n    echo 'No file uploaded!';\n}