function buildMenu($parentId = 0, $level = 0) {\n  $menu = array();\n  $query = "SELECT * FROM menu WHERE parent_id = '$parentId'";\n  $result = mysql_query($query);\n  while ($row = mysql_fetch_assoc($result)) {\n    $menu[] = array(\n      'title' => $row['title'],\n      'level' => $level,\n      'url' => generateUrl($row['title'], $level)\n    );\n    if ($row['level'] < $level) {\n      $menu = array_merge($menu, buildMenu($row['id'], $level + 1));\n    }\n  }\n  return $menu;\n}\n\nfunction generateUrl($title, $level) {\n  $url = '';\n  for ($i = 0; $i <= $level; $i++) {\n    $url .= '/' . $title . '-' . $i;\n  }\n  return $url;\n}\n\n$menu = buildMenu();\nprint_r($menu);