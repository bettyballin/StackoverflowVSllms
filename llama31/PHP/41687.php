function makeList($pages, $used = array()) {\n    if (count($pages)) {\n        echo "<ul>";\n        foreach ($pages as $page) {\n            if (!in_array($page['pag_id'], $used)) {\n                echo "<li>".$page['pag_title'];\n                $used[] = $page['pag_id'];\n                $childPages = array_filter($pages, function($p) use ($page) {\n                    return $p['pag_parent'] == $page['pag_id'];\n                });\n                makeList($childPages, $used);\n                echo "</li>";\n            }\n        }\n        echo "</ul>";\n    }\n}