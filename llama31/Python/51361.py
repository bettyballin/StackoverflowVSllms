import ctypes\n\n# Define the Windows API function signature\nprototype = ctypes.WINFUNCTYPE(\n    ctypes.c_int,\n    ctypes.c_void_p,\n    ctypes.c_int,\n    ctypes.c_void_p,\n    ctypes.c_void_p\n)\n\n# Load the WinINet DLL\nwininet = ctypes.windll.wininet\n\n# Define the InternetQueryOption function\nInternetQueryOption = prototype(('InternetQueryOptionW', wininet))\n\n# Define the constants\nINTERNET_OPTION_PROXY = 38\n\n# Call the InternetQueryOption function\nproxy_info = ctypes.create_string_buffer(1024)\nproxy_size = ctypes.sizeof(proxy_info)\nret_code = InternetQueryOption(None, INTERNET_OPTION_PROXY, proxy_info, proxy_size)\n\nif ret_code == 0:\n    # Extract the proxy settings from the buffer\n    proxy_url = ctypes.string_at(proxy_info).decode('utf-16')\n    print(proxy_url)\nelse:\n    print("Failed to retrieve proxy settings")