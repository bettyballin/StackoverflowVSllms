from collections import defaultdict, deque\n\ndef partial_order_sort(arrays):\n    graph = defaultdict(list)\n    in_degree = defaultdict(int)\n\n    for array in arrays:\n        for i in range(len(array) - 1):\n            graph[array[i]].append(array[i + 1])\n            in_degree[array[i + 1]] += 1\n\n    queue = deque([node for node in graph if in_degree[node] == 0])\n    sorted_strings = []\n\n    while queue:\n        node = queue.popleft()\n        sorted_strings.append(node)\n        for neighbor in graph[node]:\n            in_degree[neighbor] -= 1\n            if in_degree[neighbor] == 0:\n                queue.append(neighbor)\n\n    if len(sorted_strings) != len(set.union(*[set(array) for array in arrays])):\n        raise ValueError("Cannot determine the order")\n\n    return sorted_strings