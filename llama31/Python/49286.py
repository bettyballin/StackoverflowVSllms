import mysql.connector\n\n# Connect to your MySQL database\ncnx = mysql.connector.connect(\n    user='username',\n    password='password',\n    host='127.0.0.1',\n    database='your_database'\n)\n\n# Create a cursor\ncursor = cnx.cursor()\n\n# Query to find connections\nquery = ("SELECT e1.id AS id1, e2.id AS id2 "\n         "FROM endpoints e1 "\n         "JOIN endpoints e2 ON e1.point = e2.point "\n         "WHERE e1.id != e2.id AND e1.start_or_end = 'end' AND e2.start_or_end = 'start'")\n\ncursor.execute(query)\n\n# Fetch all connected linestring pairs\nconnections = cursor.fetchall()\n\n# For each connection, merge the linestrings\nfor id1, id2 in connections:\n    # Fetch linestrings\n    query = "SELECT linestring FROM linestrings WHERE id = %s"\n    cursor.execute(query, (id1,))\n    linestring1 = cursor.fetchone()[0]\n    cursor.execute(query, (id2,))\n    linestring2 = cursor.fetchone()[0]\n    \n    # Merge linestrings (simplified example, assumes direct connection)\n    merged_linestring = linestring1 + ',' + linestring2.split(',', 1)[1]\n    \n    # Update the database (e.g., update the first linestring and delete the second)\n    update_query = "UPDATE linestrings SET linestring = %s WHERE id = %s"\n    cursor.execute(update_query, (merged_linestring, id1))\n    \n    delete_query = "DELETE FROM linestrings WHERE id = %s"\n    cursor.execute(delete_query, (id2,))\n    \n    cnx.commit()\n\n# Close the cursor and connection\ncursor.close()\ncnx.close()