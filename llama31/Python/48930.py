import ssl\n\ntry:\n    context = ssl.create_default_context()\n    context.protocol = ssl.PROTOCOL_TLSv1\n    socket = ssl.wrap_socket(socket.create_connection(("example.com", 443)), context=context)\nexcept ssl.SSLError as e:\n    if "TLSV1_ALERT_UNEXPECTED_MESSAGE" in str(e):\n        # Retry with TLS 1.2\n        context.protocol = ssl.PROTOCOL_TLSv1_2\n        socket = ssl.wrap_socket(socket.create_connection(("example.com", 443)), context=context)\n    else:\n        raise