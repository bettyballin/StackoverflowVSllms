import datetime\n\n# User model with a list of valid tokens\nclass User:\n    def __init__(self, id, username):\n        self.id = id\n        self.username = username\n        self.tokens = []\n\n    def add_token(self, token):\n        self.tokens.append((token, datetime.datetime.now()))\n\n    def invalidate_tokens(self):\n        self.tokens = []\n\n# When a user logs in without "Remember Me"\ndef login_without_remember_me(user):\n    user.invalidate_tokens()\n    # Generate a new token for this session\n    new_token = generate_secure_token()\n    user.add_token(new_token)\n    return new_token\n\n# When a user logs in with "Remember Me"\ndef login_with_remember_me(user):\n    # Generate a new token for this session\n    new_token = generate_secure_token()\n    user.add_token(new_token)\n    return new_toke