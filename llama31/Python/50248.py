def jacobi(a, n):\n    if a == 0:\n        return 0\n    if a == 1:\n        return 1\n    if a == -1:\n        return -1\n    if a % 2 == 0:\n        return jacobi(a // 2, n) * (-1) ** ((n * (n - 1)) // 4)\n    return jacobi(n % a, a) * (-1) ** ((a - 1) * (n - 1) // 4)\n\ndef factor_n(n, inputs, outputs):\n    for i in range(len(inputs)):\n        a = inputs[i]\n        b = outputs[i]\n        if jacobi(a, n) != jacobi(b, n):\n            p = gcd(a - b, n)\n            if p != 1 and p != n:\n                return p\n    return None\n\ndef gcd(a, b):\n    while b != 0:\n        a, b = b, a % b\n    return a