import random\n\ndef miller_rabin(n, k=5):\n    if n == 2 or n == 3:\n        return True\n    if n <= 1 or n % 2 == 0:\n        return False\n\n    # find r and s\n    s = 0\n    r = n - 1\n    while r & 1 == 0:\n        s += 1\n        r //= 2\n\n    # k trials\n    for _ in range(k):\n        a = random.randrange(2, n - 1)\n        x = pow(a, r, n)\n        if x != 1 and x != n - 1:\n            j = 1\n            while j < s and x != n - 1:\n                x = pow(x, 2, n)\n                if x == 1:\n                    return False\n                j += 1\n            if x != n - 1:\n                return False\n\n    return True