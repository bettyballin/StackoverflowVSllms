import datetime\n\ndef mark_for_deletion(foo_id):\n    query = "UPDATE foo SET deleted_at = %s WHERE id = %s"\n    params = (datetime.datetime.now(), foo_id)\n    # execute query using your database library\n\ndef delete_marked_rows():\n    query = "DELETE FROM foo WHERE deleted_at IS NOT NULL AND deleted_at < %s"\n    params = (datetime.datetime.now() - datetime.timedelta(days=30),)  # 30-day retention\n    # execute query using your database library