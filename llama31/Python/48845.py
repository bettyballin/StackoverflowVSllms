from flask import Flask, redirect, url_for\nfrom flask_oauthlib.client import OAuth\n\napp = Flask(__name__)\noauth = OAuth(app)\n\ngoogle = oauth.remote_app(\n    'google',\n    consumer_key='your_key',\n    consumer_secret='your_secret',\n    request_token_params={\n        'scope': 'email',\n        'access_type': 'offline'\n    },\n    base_url='https://accounts.google.com',\n    request_token_url='/o/oauth2/auth',\n    access_token_url='/o/oauth2/token',\n    authorize_url='/o/oauth2/auth'\n)\n\n@app.route('/login')\ndef login():\n    return google.authorize(callback=url_for('authorized', _external=True))\n\n@app.route('/authorized')\ndef authorized():\n    resp = google.authorized_response()\n    if resp is None:\n        return 'Access denied: reason={} error={}'.format(\n            request.args['error_reason'],\n            request.args['error_description']\n        )\n    session['oauth_token'] = (resp['access_token'], '')\n    return redirect(url_for('index'))