import pyvmomi\n\n# Create a new VM guest from a template or image\nvm = pyvmomi.create_vm_from_template(template_vm, new_vm_name)\n\n# Configure the VM's settings\nvm.set_boot_device("cdrom")\nvm.set_network("ethernet0")\n\n# Start the VM and boot from the ISO image\nvm.power_on()\n\n# Use pyvmomi to interact with the VM's console and respond to prompts during installation\nconsole = vm.get_console()\nconsole.expect("keyboard type")\nconsole.send("us\r")\nconsole.expect("OK")\nconsole.send("\r")\nconsole.expect_eof()\n\n# Wait for the reboot and then launch automated tests\ntime.sleep(300) # wait 5 minutes for the reboot to complete\nsubprocess.call("./run-tests.sh")