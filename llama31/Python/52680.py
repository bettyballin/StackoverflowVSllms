import pika\n\n# Producer\nconnection = pika.BlockingConnection(pika.ConnectionParameters('localhost'))\nchannel = connection.channel()\nchannel.queue_declare(queue='hello')\nchannel.basic_publish(exchange='',\n                      routing_key='hello',\n                      body='Hello, World!')\nconnection.close()\n\n# Consumer\nconnection = pika.BlockingConnection(pika.ConnectionParameters('localhost'))\nchannel = connection.channel()\nchannel.queue_declare(queue='hello')\n\ndef callback(ch, method, properties, body):\n    print("Received message: %r" % body)\n\nchannel.basic_consume(callback, queue='hello', no_ack=True)\nchannel.start_consuming()