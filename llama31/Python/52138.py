import pandas as pd\nfrom sqlalchemy import create_engine\n\n# Define database connections\nengine1 = create_engine('oracle://user:password@host:port/SID')\nengine2 = create_engine('db2://user:password@host:port/database')\n\n# Extract data from both tables\ndf1 = pd.read_sql_table('table_name', engine1)\ndf2 = pd.read_sql_table('table_name', engine2)\n\n# Define the user-supplied primary key columns\nprimary_key_cols = ['column1', 'column2', 'column3']\n\n# Merge the two datasets on the primary key columns\nmerged_df = pd.merge(df1, df2, on=primary_key_cols, how='outer', indicator=True)\n\n# Identify row differences and value differences\nrow_diffs = merged_df[merged_df['_merge'] != 'both']\nvalue_diffs = merged_df[(merged_df['_merge'] == 'both') & (merged_df['value1'] != merged_df['value2'])]\n\n# Generate a formatted report\nreport_template = '''\nRow differences:\n\n{{ row_diffs.to_string() }}\n\nValue differences:\n\n{{ value_diffs.to_string() }}\n'''\n\nreport = jinja2.Template(report_template).render(row_diffs=row_diffs, value_diffs=value_diffs)\n\nprint(report)