import hashlib\nimport hmac\n\n# Generate a product code (e.g., a random UUID)\nproduct_code = "01234567-89ab-cdef-0123-456789abcdef"\n\n# Generate a secure hash code using SHA-256\nhash_code = hashlib.sha256(product_code.encode()).hexdigest()\n\n# Truncate the hash code to fit within SMS character limits (e.g., 8 characters)\ntruncated_hash_code = hash_code[:8]\n\n# Generate a HMAC checksum using a secret key\nsecret_key = "your_secret_key_here"\nhmac_checksum = hmac.new(secret_key.encode(), truncated_hash_code.encode(), hashlib.sha256).hexdigest()\n\n# Send the truncated hash code and HMAC checksum to the user\ncode_to_send = f"{truncated_hash_code}{hmac_checksum}"\n\n# On the server-side, validate the code by re-generating the HMAC checksum\n# and comparing it with the received checksum