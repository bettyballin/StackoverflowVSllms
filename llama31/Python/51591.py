import os\n\ndef process_directory(directory):\n    versions = {}\n    for version in os.listdir(directory):\n        version_dir = os.path.join(directory, version)\n        if os.path.isdir(version_dir):\n            if version != 'default_version':\n                versions[version] = []\n                for year in os.listdir(version_dir):\n                    year_dir = os.path.join(version_dir, year)\n                    if os.path.isdir(year_dir):\n                        images = os.listdir(year_dir)\n                        if images:\n                            versions[version].append((year, images))\n                        else:\n                            # Use default version images\n                            default_year_dir = os.path.join(directory, 'default_version', year)\n                            if os.path.isdir(default_year_dir):\n                                default_images = os.listdir(default_year_dir)\n                                versions[version].append((year, default_images))\n    return versions\n\ndef generate_links(versions):\n    links = []\n    for version, images in versions.items():\n        for i, (year, image_names) in enumerate(images):\n            if i == 0:\n                start_year = int(year)\n            if i == len(images) - 1:\n                end_year = int(year)\n            for image_name in image_names:\n                links.append((version, start_year, end_year, image_name))\n    return links\n\ndirectory = 'path_to_your_directory'\nversions = process_directory(directory)\nlinks = generate_links(versions)\nfor link in links:\n    print(link)