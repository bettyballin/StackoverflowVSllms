import os\n\ndef search_and_replace(file_path, search_term, replace_term):\n    # Create a temporary file name\n    tmp_file_path = file_path + '.tmp'\n\n    try:\n        # Open the original file for reading and the temporary file for writing\n        with open(file_path, 'r') as orig_file, open(tmp_file_path, 'w') as tmp_file:\n            for line in orig_file:\n                if search_term in line:\n                    # Replace the search term and write to the temporary file\n                    newline = line.replace(search_term, replace_term)\n                    tmp_file.write(newline)\n                else:\n                    # Write the original line to the temporary file\n                    tmp_file.write(line)\n\n        # Replace the original file with the temporary file\n        os.replace(tmp_file_path, file_path)\n    except Exception as e:\n        # Handle any exceptions and ensure the temporary file is removed if there's an error\n        if os.path.exists(tmp_file_path):\n            os.remove(tmp_file_path)\n        raise e\n\n# Example usage\nfile_path = 'path/to/your/file.txt'\nsearch_term = 'foo'\nreplace_term = 'bar'\n\nsearch_and_replace(file_path, search_term, replace_term)