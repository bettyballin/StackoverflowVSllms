import bcrypt\nimport pyodbc\n\n# Connect to the database\nconn = pyodbc.connect('DRIVER={ODBC Driver 17 for SQL Server};SERVER=your_server;DATABASE=your_database;UID=your_username;PWD=your_password')\ncursor = conn.cursor()\n\n# Define the hashing function\ndef hash_password(password):\n    salt = bcrypt.gensalt()\n    hashed_password = bcrypt.hashpw(password.encode('utf-8'), salt)\n    return hashed_password.decode('utf-8')\n\n# Update passwords in batches of 1000\nbatch_size = 1000\ncursor.execute('SELECT id, password FROM users')\nrows = cursor.fetchall()\nfor i in range(0, len(rows), batch_size):\n    batch = rows[i:i+batch_size]\n    for row in batch:\n        hashed_password = hash_password(row[1])\n        cursor.execute('UPDATE users SET password = ? WHERE id = ?', hashed_password, row[0])\n    conn.commit()\n\nconn.close()