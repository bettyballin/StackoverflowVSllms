def get_recommendations(user_id):\n    # Retrieve similarity values for the user\n    similarity_values = pd.read_sql_query(f"SELECT user2_id, similarity FROM user_similarity WHERE user1_id = {user_id}", db_connection)\n\n    # Get products purchased by similar users\n    similar_products = []\n    for similar_user in similarity_values['user2_id']:\n        similar_products.extend(get_products_purchased_by_user(similar_user))\n\n    # Return recommended products\n    return list(set(similar_products) - set(get_products_purchased_by_user(user_id)))\n\ndef get_products_purchased_by_user(user_id):\n    # Retrieve products purchased by the user\n    return pd.read_sql_query(f"SELECT product_id FROM user_product WHERE user_id = {user_id}", db_connection)['product_id'].tolist()