import os\nimport pandoc\n\n# Set the repository path and output file\nrepo_path = '/path/to/sql-library'\noutput_file = 'sql-library.docx'\n\n# Define the tags to include\ntags = ['customer-a', 'database-b']\n\n# Get the list of Markdown files\nfiles = [f for f in os.listdir(repo_path) if f.endswith('.md')]\n\n# Create the output document\ndoc = pandoc.Document()\n\n# Iterate through the files and add queries with matching tags\nfor file in files:\n    with open(os.path.join(repo_path, file), 'r') as f:\n        content = f.read()\n        if any(tag in content for tag in tags):\n            doc.add(pandoc.Header(content.split('\n')[0], level=2))\n            doc.add(pandoc.CodeBlock(content))\n\n# Write the output document\nwith open(output_file, 'w') as f:\n    f.write(doc.to_string(format='docx'))