import imaplib\nimport email\nfrom email.parser import BytesParser\n\n# Connect to Postfix server via IMAP\nmail = imaplib.IMAP4_SSL('your_postfix_server')\nmail.login('your_username', 'your_password')\nmail.select('inbox')\n\n# Search for emails\nstatus, messages = mail.search(None, 'ALL')\n\n# Loop through emails and extract information\nfor num in messages[0].split():\n    status, msg = mail.fetch(num, '(RFC822)')\n    raw_message = msg[0][1]\n\n    # Parse email message using email library\n    email_message = BytesParser().parsebytes(raw_message)\n\n    # Extract attachments\n    attachments = []\n    for part in email_message.walk():\n        if part.get_content_maintype() == 'multipart':\n            continue\n        if part.get('Content-Disposition') is None:\n            continue\n        filename = part.get_filename()\n        if filename:\n            attachments.append((filename, part.get_payload(decode=True)))\n\n    # Extract body\n    body = None\n    if email_message.is_multipart():\n        for part in email_message.walk():\n            if part.get_content_maintype() == 'text':\n                body = part.get_payload(decode=True)\n                break\n    else:\n        body = email_message.get_payload(decode=True)\n\n    # Create a Python object to hold email information\n    email_obj = {\n        'subject': email_message['Subject'],\n        'from': email_message['From'],\n        'to': email_message['To'],\n        'body': body,\n        'attachments': attachments\n    }\n\n    # Do something with the email object (e.g., save to database, display in UI)\n    print(email_obj)\n\n# Close IMAP connection\nmail.close()\nmail.logout()