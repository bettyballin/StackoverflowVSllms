def manacher(s):\n    T = '#'.join('^{}$'.format(s))\n    n = len(T)\n    P = [0] * n\n    C = R = 0\n\n    for i in range(1, n-1):\n        P[i] = (R > i) and min(R - i, P[2*C - i]) \n        while T[i + 1 + P[i]] == T[i - 1 - P[i]]:\n            P[i] += 1\n\n        if i + P[i] > R:\n            C, R = i, i + P[i]\n\n    maxLen, centerIndex = max((n, i) for i, n in enumerate(P))\n    return s[(centerIndex - maxLen)//2: (centerIndex + maxLen)//2]