import subprocess\nimport shlex\n\n# Define a whitelist of allowed values for each field\nallowed_values = {\n    'field1': ['value1', 'value2'],\n    'field2': ['value3', 'value4']\n}\n\n# Get the form input\nform_input = {\n    'field1': request.POST.get('field1'),\n    'field2': request.POST.get('field2')\n}\n\n# Validate the input against the whitelist\nfor field, value in form_input.items():\n    if value not in allowed_values[field]:\n        raise ValueError(f"Invalid value for {field}")\n\n# Escape special characters in the input\nescaped_input = {field: shlex.quote(value) for field, value in form_input.items()}\n\n# Construct the command with parameterized arguments\ncommand = ['external_program', escaped_input['field1'], escaped_input['field2']]\n\n# Run the command with subprocess.run()\nsubprocess.run(command, check=True)