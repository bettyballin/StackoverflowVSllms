import pandas as pd\n\nclass CrossTabulation:\n    def __init__(self, data):\n        self.data = pd.DataFrame(data)\n        self.frequencies = {}\n\n    def calculate_frequencies(self, columns):\n        freqs = self.data.groupby(columns).size().to_dict()\n        self.frequencies[columns] = freqs\n        return freqs\n\n    def calculate_ratios(self, columns, total_column):\n        freqs = self.frequencies[columns]\n        total_freqs = self.data[total_column].value_counts().to_dict()\n        ratios = {k: v / total_freqs[k[0]] for k, v in freqs.items()}\n        return ratios\n\n    def compile_output(self, columns):\n        freqs = self.frequencies[columns]\n        ratios = self.calculate_ratios(columns, columns[0])\n        output = []\n        for k, v in freqs.items():\n            output.append([k[0], k[1], v, ratios[k]])\n        return output\n\n# Example usage:\ndata = [\n    [1, '.', 1],\n    [1, 0, 3],\n    [1, 0, 3],\n    [1, 2, 3],\n    [2, '.', 1],\n    [2, 0, '.'],\n    [2, 2, 2],\n    [2, 2, 4],\n    [2, 2, '.']\n]\n\nct = CrossTabulation(data)\nct.calculate_frequencies([0, 2])\noutput = ct.compile_output([0, 2])\nprint(output)