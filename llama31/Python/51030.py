import pika\n\n# Producer\nconnection = pika.BlockingConnection(pika.ConnectionParameters('localhost'))\nchannel = connection.channel()\nchannel.queue_declare(queue='my_queue', durable=True)\n\nchannel.basic_publish(exchange='',\n                      routing_key='my_queue',\n                      body='Hello, world!',\n                      properties=pika.BasicProperties(\n                          delivery_mode=2,  # make message persistent\n                      ))\n\nconnection.close()\n\n# Consumer\nconnection = pika.BlockingConnection(pika.ConnectionParameters('localhost'))\nchannel = connection.channel()\n\ndef callback(ch, method, properties, body):\n    print(f"Received message: {body}")\n\nchannel.basic_consume(queue='my_queue',\n                      auto_ack=False,\n                      on_message_callback=callback)\n\nchannel.start_consuming()