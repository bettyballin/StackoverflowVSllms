from django.db.models import F, Window\nfrom django.db.models.functions import RowNumber\n\nmessages = Message.objects.annotate(\n    row_num=Window(\n        expression=RowNumber(),\n        order_by=F('created_at')\n    ),\n    group_num=Window(\n        expression=RowNumber(),\n        partition_by=F('source'),\n        order_by=F('created_at')\n    )\n).annotate(\n    is_group_start=~F('group_num').eq(F('row_num') - 1)\n).filter(is_group_start=True)\n\n# Now you can paginate the results\npaginator = Paginator(messages, 15)\npage = paginator.page(1)