Imports System.Windows.Forms\n\nPublic Sub documentEvents_DocumentOpened(ByVal Document As EnvDTE.Document) Handles DocumentEvents.DocumentOpened\n    Dim timer As New Timer()\n    timer.Interval = 500 ' 500ms delay\n    timer.Start()\n    AddHandler timer.Tick, AddressOf OnTimerTick\nEnd Sub\n\nPrivate Sub OnTimerTick(ByVal sender As Object, ByVal e As EventArgs)\n    ' Code to be executed after the delay\n    Document.DTE.ExecuteCommand("Edit.CollapsetoDefinitions")\n    DTE.SuppressUI = True\n    Dim objSelection As TextSelection = DTE.ActiveDocument.Selection\n    objSelection.StartOfDocument()\n    Do While objSelection.FindText("#region", vsFindOptions.vsFindOptionsMatchInHiddenText)\n    Loop\n    objSelection.StartOfDocument()\n    DTE.SuppressUI = False\n    ' Stop the timer\n    DirectCast(sender, Timer).Stop()\nEnd Sub