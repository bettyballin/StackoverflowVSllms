Public Sub StartService()\n    Dim searchSuccessful As Boolean = False\n    Try\n        searchSuccessful = RunSearch()\n    Catch ex As Exception\n        ' Log the error\n        WriteToErrorLog(ex)\n    End Try\n\n    If searchSuccessful Then\n        Try\n            SaveMessages()\n            DeleteMessages()\n        Catch ex As Exception\n            ' Log the error\n            WriteToErrorLog(ex)\n        End Try\n    Else\n        ' Exit the application\n        Application.Exit()\n    End If\nEnd Sub\n\nPublic Function RunSearch() As Boolean\n    Try\n        ' Code for RunSearch\n        Return True\n    Catch ex As Exception\n        ' Log the error\n        WriteToErrorLog(ex)\n        Return False\n    End Try\nEnd Functio