Public Class FileAndTraceListener\n    Inherits TraceListener\n\n    Private logFile As String\n\n    Public Sub New(logFile As String)\n        Me.logFile = logFile\n    End Sub\n\n    Public Overrides Sub WriteLine(message As String)\n        MyBase.WriteLine(message) ' Call original Trace.WriteLine\n        Using writer As New IO.StreamWriter(logFile, True)\n            writer.WriteLine(message)\n        End Using\n    End Sub\n\n    Public Overrides Sub Write(message As String)\n        MyBase.Write(message) ' Call original Trace.Write\n        Using writer As New IO.StreamWriter(logFile, True)\n            writer.Write(message)\n        End Using\n    End Sub\nEnd Class