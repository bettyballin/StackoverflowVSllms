Imports System.Configuration\n\nPublic Class MyDialog\n    Private Sub MyDialog_FormClosing(sender As Object, e As FormClosingEventArgs) Handles Me.FormClosing\n        My.Settings.SelectedRadioButtonIndex = GetSelectedRadioButtonIndex()\n    End Sub\n\n    Private Function GetSelectedRadioButtonIndex() As Integer\n        Dim index As Integer = 0\n        For Each rb As RadioButton In Me.Controls.OfType(Of RadioButton)()\n            If rb.Checked Then\n                Return index\n            End If\n            index += 1\n        Next\n        Return 0\n    End Function\n\n    Private Sub MyDialog_Load(sender As Object, e As EventArgs) Handles Me.Load\n        Dim selectedIndex As Integer = My.Settings.SelectedRadioButtonIndex\n        For Each rb As RadioButton In Me.Controls.OfType(Of RadioButton)()\n            rb.Checked = (Me.Controls.OfType(Of RadioButton)().ToList().IndexOf(rb) = selectedIndex)\n        Next\n    End Sub\nEnd Class