Imports System.IO\n\nModule WSPBuilder\n    Sub Main()\n        Dim wspPath As String = "path\to\your\wsp"\n        Dim files() As String = {"file1.dll", "file2.dll", "file3.dll"}\n\n        ' Create the WSP file\n        Dim wspFile As String = Path.Combine(wspPath, "yourwsp.wsp")\n        Using writer As New BinaryWriter(File.Open(wspFile, FileMode.Create))\n            writer.Write("Microsoft Cabinet File")\n            writer.Write(Chr(0) & Chr(0) & Chr(0) & Chr(0))\n            writer.Write(1)\n            writer.Write(files.Length)\n\n            For Each file As String In files\n                writer.Write(Path.GetFileName(file))\n                writer.Write(File.ReadAllBytes(file))\n            Next\n        End Using\n\n        ' Create the CAB file\n        Dim cabFile As String = Path.Combine(wspPath, "yourcab.cab")\n        Using writer As New BinaryWriter(File.Open(cabFile, FileMode.Create))\n            writer.Write("MSCF")\n            writer.Write(Chr(0) & Chr(0) & Chr(0) & Chr(0))\n            writer.Write(1)\n            writer.Write(files.Length)\n\n            For Each file As String In files\n                writer.Write(Path.GetFileName(file))\n                writer.Write(File.ReadAllBytes(file))\n            Next\n        End Using\n\n        ' Create the WSP using MakeCab\n        Dim makeCab As String = "makecab.exe"\n        Dim args As String = "/D """ & wspPath & """ /L """ & wspPath & """ /C """ & cabFile & """ /F """ & wspFile & """"\n        Process.Start(makeCab, args)\n    End Sub\nEnd Module