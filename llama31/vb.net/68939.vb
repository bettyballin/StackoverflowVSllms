Private WithEvents bgw As New BackgroundWorker()\n\nPrivate Sub cmbServer_DropDown(ByVal sender As Object, ByVal e As System.EventArgs) Handles cmbServer.DropDown\n    If cmbServer.Items.Count = 0 Then\n        bgw.RunWorkerAsync()\n    End If\nEnd Sub\n\nPrivate Sub bgw_DoWork(ByVal sender As Object, ByVal e As DoWorkEventArgs) Handles bgw.DoWork\n    Dim oTable As DataTable\n    Dim lstServers As List(Of String)\n    Dim lstAliases As List(Of String)\n\n    Try\n        oTable = System.Data.Sql.SqlDataSourceEnumerator.Instance.GetDataSources\n        lstServers = New List(Of String)\n\n        For Each oRow As DataRow In oTable.Rows\n            If oRow("InstanceName").ToString = "" Then\n                lstServers.Add(oRow("ServerName").ToString)\n            Else\n                lstServers.Add(oRow("ServerName").ToString & "\" & oRow("InstanceName").ToString)\n            End If\n        Next oRow\n\n        'Retrieve any server aliases on the client and add them to the server list\n        lstAliases = GetSQLServerAliases()\n        If lstAliases IsNot Nothing Then\n            For Each sAlias As String In lstAliases\n                lstServers.Add(sAlias)\n            Next sAlias\n        End If\n\n        lstServers.Sort()\n        e.Result = lstServers\n    Catch ex As Exception\n        ErrHandler("frmRefreshDB", "bgw_DoWork", ex.Source, ex.Message, ex.InnerException)\n    Finally\n        If oTable IsNot Nothing Then\n            oTable.Dispose()\n        End If\n    End Try\nEnd Sub\n\nPrivate Sub bgw_RunWorkerCompleted(ByVal sender As Object, ByVal e As RunWorkerCompletedEventArgs) Handles bgw.RunWorkerCompleted\n    If e.Error IsNot Nothing Then\n        ErrHandler("frmRefreshDB", "bgw_RunWorkerCompleted", e.Error.Source, e.Error.Message, e.Error.InnerException)\n    Else\n        Dim lstServers As List(Of String) = DirectCast(e.Result, List(Of String))\n        cmbServer.Items.Clear()\n        For Each sServer As String In lstServers\n            cmbServer.Items.Add(sServer)\n        Next sServer\n    End If\nEnd Sub