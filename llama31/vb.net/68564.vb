Imports System.Configuration\n\nPublic Class AppSettings\n    Public Shared Property Settings As Settings\n\n    Public Shared Sub SaveSettings()\n        Dim config As Configuration = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None)\n        Dim section As ClientSettingsSection = config.GetSection("userSettings")\n\n        Dim settings As New Settings()\n        ' populate the key-value pairs\n        settings.KeyValuePairs.Add("key1", "value1")\n        settings.KeyValuePairs.Add("key2", "value2")\n\n        section.Settings.Add("KeyValuePairs", settings)\n        config.Save(ConfigurationSaveMode.Modified)\n    End Sub\n\n    Public Shared Sub LoadSettings()\n        Dim config As Configuration = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None)\n        Dim section As ClientSettingsSection = config.GetSection("userSettings")\n\n        Settings = TryCast(section.Settings("KeyValuePairs"), Settings)\n    End Sub\nEnd Class