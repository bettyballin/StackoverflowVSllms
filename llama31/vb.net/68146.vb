' Declare the DLL function\nDeclare PtrSafe Function GetStringArray Lib "mydll" (ByRef arr As LongPtr, ByRef size As Long) As Long\n\nSub TestGetStringArray()\n    Dim arr() As String\n    Dim size As Long\n    \n    ' Call the DLL function\n    GetStringArray VarPtr(arr), size\n    \n    ' Convert the returned array to a VBA string array\n    ReDim arr(size - 1)\n    For i = 0 To size - 1\n        arr(i) = GetStringFromPtr(arr(i))\n    Next i\n    \n    ' Print the string array\n    For i = 0 To size - 1\n        Debug.Print arr(i)\n    Next i\n    \n    ' Clean up\n    Erase arr\nEnd Sub\n\n' Helper function to convert a pointer to a VBA string\nFunction GetStringFromPtr(ptr As LongPtr) As String\n    GetStringFromPtr = String$(ptr, 0&)\nEnd Functio