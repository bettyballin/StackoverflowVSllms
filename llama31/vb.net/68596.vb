Imports System.Diagnostics\n\nFunction IsFileInUse(ByVal filePath As String) As Boolean\n    Dim processes As Process() = Process.GetProcesses()\n    For Each p As Process In processes\n        Try\n            Dim modules As ProcessModuleCollection = p.Modules\n            For Each m As ProcessModule In modules\n                If m.FileName.ToLower() = filePath.ToLower() Then\n                    Return True\n                End If\n            Next\n        Catch ex As Exception\n            ' Handle any exceptions that occur when trying to access a process\n        End Try\n    Next\n    Return False\nEnd Functio