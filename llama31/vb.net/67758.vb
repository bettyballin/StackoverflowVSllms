Private Sub Example()\n    On Error GoTo Err_Hnd\nExit_Proc:\n    On Error Resume Next\n    Exit Sub\nErr_Hnd:\n    Dim moduleName As String\n    Dim procedureName As String\n    Dim lineNumber As Long\n    \n    lineNumber = Erl\n    moduleName = GetModuleName(Err.Source)\n    procedureName = GetProcedureName(Err.Source)\n    \n    ErrorHandler.FormattedErrorMessage procedureName, moduleName, Err.Description, Err.Source, Err.Number, lineNumber\n    Resume Exit_Proc\nEnd Sub\n\nPrivate Function GetModuleName(source As String) As String\n    Dim parts() As String\n    parts = Split(source, ".")\n    If UBound(parts) > 0 Then\n        GetModuleName = parts(UBound(parts) - 1)\n    Else\n        GetModuleName = ""\n    End If\nEnd Function\n\nPrivate Function GetProcedureName(source As String) As String\n    Dim parts() As String\n    parts = Split(source, ".")\n    If UBound(parts) > 1 Then\n        GetProcedureName = parts(UBound(parts))\n    Else\n        GetProcedureName = ""\n    End If\nEnd Functio