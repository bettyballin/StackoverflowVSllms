Imports System.Security.Principal\nImports System.Diagnostics\n\nModule Module1\n    Sub Main()\n        If Not IsRunningAsAdministrator() Then\n            RunAsAdministrator()\n        End If\n\n        ' Your code here\n    End Sub\n\n    Private Function IsRunningAsAdministrator() As Boolean\n        Dim identity As WindowsIdentity = WindowsIdentity.GetCurrent()\n        Dim principal As New WindowsPrincipal(identity)\n        Return principal.IsInRole(WindowsBuiltInRole.Administrator)\n    End Function\n\n    Private Sub RunAsAdministrator()\n        Dim processInfo As New ProcessStartInfo()\n        processInfo.UseShellExecute = True\n        processInfo.WorkingDirectory = Environment.CurrentDirectory\n        processInfo.FileName = System.Reflection.Assembly.GetExecutingAssembly().Location\n        processInfo.Verb = "runas"\n        Try\n            Process.Start(processInfo)\n        Catch ex As Exception\n            ' Handle exception\n        End Try\n\n        Application.Exit()\n    End Sub\nEnd Module