Imports System.Data\nImports System.Data.SqlClient\nImports System.Reflection\n\nPublic Function FillList(Of T)(ByVal connectionString As String, ByVal query As String) As List(Of T)\n    Dim list As New List(Of T)\n    Using connection As New SqlConnection(connectionString)\n        connection.Open()\n        Using command As New SqlCommand(query, connection)\n            Using reader As SqlDataReader = command.ExecuteReader()\n                While reader.Read()\n                    Dim obj As T = Activator.CreateInstance(Of T)()\n                    For Each prop As PropertyInfo In GetType(T).GetProperties()\n                        If prop.CanWrite Then\n                            prop.SetValue(obj, reader(prop.Name), Nothing)\n                        End If\n                    Next\n                    list.Add(obj)\n                End While\n            End Using\n        End Using\n    End Using\n    Return list\nEnd Functio