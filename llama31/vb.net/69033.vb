' Create a new SqlConnection instance for each transaction\nUsing connection As New SqlConnection("Your Connection String")\n    connection.Open()\n\n    ' Create a new transaction\n    Using transaction As connection.BeginTransaction()\n        Try\n            ' Create a new table adapter with the transaction\n            Using tableAdapter As New YourTableAdapter(connection, transaction)\n                ' Perform your dataset updates and ad-hoc queries here\n                ' ...\n\n                ' Commit the transaction\n                transaction.Commit()\n            End Using\n        Catch ex As Exception\n            ' Rollback the transaction if an error occurs\n            transaction.Rollback()\n            Throw\n        End Try\n    End Using\nEnd Using