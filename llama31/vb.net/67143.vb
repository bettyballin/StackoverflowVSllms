Dim stpDx(2) As dx_entry\nstpDx(1).dx = "5939" & Space(6)\nstpDx(1).type = "BK" & Space(1)\nstpDx(1).narray = Space(1)\nstpDx(1).ctier = Space(1)\nstpDx(1).poa = "Y"\nstpDx(1).poa_rsvd = Space(1)\nstpDx(1).filler = Space(81)\nstpDx(2).dx = "1231" & Space(6)\nstpDx(2).type = "BF" & Space(1)\nstpDx(2).narray = Space(1)\nstpDx(2).ctier = Space(1)\nstpDx(2).poa = "Y"\nstpDx(2).poa_rsvd = Space(1)\nstpDx(2).filler = Space(81)\n\nDim size As Integer = Marshal.SizeOf(stpDx(0)) * stpDx.Length\nDim pDxBuf As IntPtr = Marshal.AllocHGlobal(size)\n\nFor i As Integer = 0 To stpDx.Length - 1\n    Dim ptr As IntPtr = New IntPtr(pDxBuf.ToInt64() + i * Marshal.SizeOf(stpDx(0)))\n    Marshal.StructureToPtr(stpDx(i), ptr, False)\nNext\n\nezg_Block.pDx = pDxBuf