Imports System.Runtime.InteropServices\n\nModule Module1\n    <DllImport("user32.dll")> _\n    Public Function GetKeyState(ByVal nVirtKey As Integer) As Short\n    End Function\n\n    <DllImport("user32.dll")> _\n    Public Function SetKeyboardState(ByVal lpKeyState As Byte()) As Boolean\n    End Function\n\n    Const VK_CAPITAL As Integer = &H14\n\n    Sub ToggleCapsLock()\n        Dim state As Byte() = New Byte(255) {}\n        GetKeyState(VK_CAPITAL)\n        state(VK_CAPITAL) = If(state(VK_CAPITAL) = 0, 1, 0)\n        SetKeyboardState(state)\n    End Sub\n\n    Sub Main()\n        ToggleCapsLock()\n    End Sub\nEnd Module