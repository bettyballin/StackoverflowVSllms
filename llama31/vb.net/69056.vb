Imports System.Runtime.InteropServices\n\nPublic Module ExceptionFilter\n    <DllImport("kernel32.dll")> _\n    Private Function GetCurrentThreadId() As Integer\n    End Function\n\n    Public Function FilterException(ex As Exception) As Boolean\n        ' implement your filter logic here\n        Return True\n    End Function\n\n    Public Function CatchWhen(ex As Exception, filter As Func(Of Exception, Boolean)) As Boolean\n        Dim threadId = GetCurrentThreadId()\n        Try\n            Throw New Exception(" dummy", ex)\n        Catch ex2 As Exception When filter(ex2.InnerException)\n            Return True\n        Catch\n            Return False\n        End Try\n    End Function\nEnd Module