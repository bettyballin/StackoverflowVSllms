Imports System.Drawing\n\nPublic Class ExtendedTextBox\n    Inherits TextBox\n\n    Protected Overrides Sub OnKeyDown(e As KeyEventArgs)\n        MyBase.OnKeyDown(e)\n\n        Dim text As String = Me.Text\n        Dim font As Font = Me.Font\n        Dim sf As New StringFormat(StringFormatFlags.MeasureTrailingSpaces)\n        Dim textSize As SizeF = Me.CreateGraphics().MeasureString(text, font, Me.ClientSize.Width, sf)\n\n        Dim totalHeight As Single = 0\n        Dim lines As String() = text.Split(New Char() {vbCrLf})\n\n        For Each line As String In lines\n            Dim lineSize As SizeF = Me.CreateGraphics().MeasureString(line, font, Me.ClientSize.Width, sf)\n            totalHeight += lineSize.Height\n        Next\n\n        If totalHeight > Me.ClientSize.Height Then\n            e.SuppressKeyPress = True\n        End If\n    End Sub\nEnd Class