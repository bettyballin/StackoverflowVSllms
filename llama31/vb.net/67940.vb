Sub ValidateQuery()\n    Dim cn As ADODB.Connection\n    Dim cmd As ADODB.Command\n    Dim rs As ADODB.Recordset\n    Dim strSQL As String\n    \n    Set cn = New ADODB.Connection\n    cn.Open "Your connection string"\n    \n    Set cmd = New ADODB.Command\n    cmd.ActiveConnection = cn\n    cmd.CommandText = strSQL\n    \n    ' Check query type\n    If cmd.CommandType = adCmdText Then\n        ' Try to execute query with WHERE 1=0 clause\n        cmd.CommandText = strSQL & " WHERE 1=0"\n        Set rs = New ADODB.Recordset\n        rs.Open cmd\n        \n        ' Check for write permissions\n        If rs.Supports(adAddNew) Then\n            Debug.Print "Query allows adding new records"\n        End If\n        If rs.Supports(adUpdate) Then\n            Debug.Print "Query allows editing existing records"\n        End If\n        \n        rs.Close\n    ElseIf cmd.CommandType = adCmdTable Then\n        ' Query is a table query, check if it's updateable\n        Set rs = New ADODB.Recordset\n        rs.Open cmd\n        \n        If rs.Supports(adUpdate) Then\n            Debug.Print "Query allows editing existing records"\n        End If\n        \n        rs.Close\n    Else\n        Debug.Print "Invalid query type"\n    End If\n    \n    cmd.Cancel\n    cn.Close\nEnd Sub