Dim tfs As TeamFoundationServer = TeamFoundationServerFactory.GetServer(txtServer.Text)\nDim versionControl As VersionControlServer = CType(tfs.GetService(GetType(VersionControlServer)), VersionControlServer)\nDim workspace As Workspace = versionControl.GetWorkspace(txtProject.Text)\n\nIf Not String.IsNullOrEmpty(txtUpdateScript.Text) Then\n    Dim fooString = Array.Find(Of WorkingFolder)(workspace.Folders, Function(m) m.ServerItem.Contains("$/FOO.NET"))\n    Dim folderPath = IO.Path.Combine(IO.Path.Combine(txtProject.Text, "FOOAdmin\Updates"), txtVersion.Text)\n    Dim filePath = IO.Path.Combine(folderPath, "Update.sql")\n\n    workspace.PendAdd(folderPath, True) ' Add the folder\n    IO.File.Copy(txtUpdateScript.Text, filePath, True)\n    workspace.PendAdd(filePath) ' Add the file\nEnd If\n\nDim pendingChanges As PendingChange() = workspace.GetPendingChanges()\nDim changesetNumber As Integer = workspace.CheckIn(pendingChanges, "FOO.Net AutoBuild")