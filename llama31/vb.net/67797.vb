SQL = "WITH LASTVISIT AS ("\nSQL = SQL & " SELECT VISITORIP, MAX(DATEENTERED) AS DATEENTERED"\nSQL = SQL & " FROM STATS"\nSQL = SQL & " WHERE VISITORIP = '"& IPADDRESS &"' AND CONVERT(VARCHAR(10), DATEENTERED, 101) = CONVERT(VARCHAR(10), '"& objDateEntered("DATEENTERED") &"', 101)"\nSQL = SQL & " GROUP BY VISITORIP"\nSQL = SQL & " )"\nSQL = SQL & " SELECT STATS.VISITORIP, STATS.HTTPADDRESS, STATS.DATEENTERED"\nSQL = SQL & " FROM STATS"\nSQL = SQL & " INNER JOIN LASTVISIT"\nSQL = SQL & " ON LASTVISIT.VISITORIP = STATS.VISITORIP AND CONVERT(VARCHAR(10), LASTVISIT.DATEENTERED, 101) = CONVERT(VARCHAR(10), STATS.DATEENTERED, 101)"\nSQL = SQL & " ORDER BY STATS.DATEENTERED DESC"