Private WithEvents timer As New System.Timers.Timer(2 * 60 * 1000) ' 2 minutes\n\nPrivate Sub timer_Elapsed(sender As Object, e As Timers.ElapsedEventArgs) Handles timer.Elapsed\n    ' Perform SQL query here\nEnd Sub\n\nPrivate Sub Form1_Resize(sender As Object, e As EventArgs) Handles Me.Resize\n    If Me.WindowState = FormWindowState.Minimized Then\n        timer.Start()\n        ' Minimize resources here\n    ElseIf Me.WindowState = FormWindowState.Normal Then\n        timer.Stop()\n        ' Restore resources here\n    End If\nEnd Sub