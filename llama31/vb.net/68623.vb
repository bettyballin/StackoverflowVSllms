Public Function GetALList(Of T)(ByVal storedproc As String) As List(Of T)\n    Dim lstGenericList As New List(Of T)\n    Dim oProviderFactory As New ProviderFactory\n    Dim oConnection As DbConnection\n    Dim oReader As System.Data.IDataReader\n    Dim oFactory As DbProviderFactory\n    Dim oFileMgt As New FileMgt\n    Dim oCmd As DbCommand\n\n    oFactory = oProviderFactory.GetFactory\n    oConnection = oProviderFactory.GetProviderConnection(oFactory)\n    oCmd = oConnection.CreateCommand\n    oCmd.CommandType = CommandType.StoredProcedure\n\n    oCmd.CommandText = storedproc\n\n    Using (oConnection)\n        oConnection.Open()\n        oReader = oCmd.ExecuteReader()\n\n        While oReader.Read\n            Dim itemType As Type = GetType(T)\n            Dim item As T = Activator.CreateInstance(itemType)\n\n            ' Use reflection to set the properties\n            itemType.GetProperty("Id").SetValue(item, oReader("Id"))\n            itemType.GetProperty("Value").SetValue(item, oReader("Value"))\n            itemType.GetProperty("Description").SetValue(item, oReader("Description"))\n            itemType.GetProperty("Order").SetValue(item, oReader("Order"))\n\n            lstGenericList.Add(item)\n        End While\n\n        oConnection.Close()\n    End Using\n\n    Return lstGenericList\nEnd Functio