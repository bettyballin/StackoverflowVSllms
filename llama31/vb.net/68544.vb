Function DecryptFile(ByVal sInputFilename As String, ByVal sKey As String) As MemoryStream\n    Dim DES As New DESCryptoServiceProvider()\n    DES.Key() = ASCIIEncoding.ASCII.GetBytes(sKey)\n    DES.IV = ASCIIEncoding.ASCII.GetBytes(sKey)\n\n    Dim fsread As New FileStream(sInputFilename, FileMode.Open, FileAccess.Read)\n    Dim desdecrypt As ICryptoTransform = DES.CreateDecryptor()\n    Dim cryptostreamDecr As New CryptoStream(fsread, desdecrypt, CryptoStreamMode.Read)\n\n    Dim ms As New MemoryStream()\n    Dim buffer(1024) As Byte\n    Dim bytesRead As Integer\n    While (bytesRead = cryptostreamDecr.Read(buffer, 0, buffer.Length)) > 0\n        ms.Write(buffer, 0, bytesRead)\n    End While\n\n    fsread.Close()\n    cryptostreamDecr.Close()\n\n    Return ms\nEnd Functio