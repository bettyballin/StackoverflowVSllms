Imports System.Web.UI\n\nPublic Function GetControlHierarchy(ByVal page As Page) As String\n    Dim hierarchy As New StringBuilder()\n    GetControlHierarchyRecursive(page, hierarchy, 0)\n    Return hierarchy.ToString()\nEnd Function\n\nPrivate Sub GetControlHierarchyRecursive(ByVal control As Control, ByVal hierarchy As StringBuilder, ByVal level As Integer)\n    hierarchy.Append(New String("  ", level) & control.ID & " (" & control.GetType().Name & ")" & vbCrLf)\n    For Each child As Control In control.Controls\n        GetControlHierarchyRecursive(child, hierarchy, level + 1)\n    Next\nEnd Sub