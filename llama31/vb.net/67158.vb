Private Sub AddToList(ByVal targetDirectory As String, ByVal boolFiles As Boolean, Optional ByVal recur As Boolean = False)\n    Dim shortName As String\n    Dim parentNode As TreeNode = TreeView1.Nodes.Add(targetDirectory)\n\n    If Directory.GetDirectories(targetDirectory).Length > 0 Then\n        Dim subdirectoryEntries As String() = Directory.GetDirectories(targetDirectory)\n        Dim subdirectory As String\n\n        For Each subdirectory In subdirectoryEntries\n            shortName = subdirectory.Remove(0, subdirectory.LastIndexOf("\") + 1)\n            Dim childNode As TreeNode = parentNode.Nodes.Add(shortName)\n            AddToList(subdirectory, False, True)\n\n            If boolFiles = True Then AddToList(subdirectory, boolFiles)\n        Next\n    End If\nEnd Sub