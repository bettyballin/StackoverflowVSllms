Public Function UserExists(ByVal userName As String) As DataTable\n    Dim dt As Object = Nothing\n    Dim arSqlParameters(0) As SqlParameter\n    arSqlParameters(0) = New SqlParameter("@UserName", SqlDbType.NVarChar, 50)\n    arSqlParameters(0).Value = userName\n\n    Try\n        dt = ABC.APP.DAL.DALHelper.ExecuteDatatable(ConnectionString, CommandType.StoredProcedure, "dbo.aspnet_sprGetUserByUsername", arSqlParameters)\n    Catch ex As SqlException\n        ' Handle SQL-related errors\n        LogError("SQL error", ex)\n        Throw New ApplicationException("Database error", ex)\n    Catch ex As DbException\n        ' Handle database-related errors\n        LogError("Database error", ex)\n        Throw New ApplicationException("Database error", ex)\n    Catch ex As Exception\n        ' Handle other unexpected errors\n        LogError("Unexpected error", ex)\n        Throw New ApplicationException("Internal server error", ex)\n    End Try\n\n    Return dt\nEnd Function\n\nPrivate Sub LogError(ByVal message As String, ByVal ex As Exception)\n    ' Implement your logging mechanism here\n    ' e.g., write to a log file, database, or messaging queue\nEnd Sub