Public Function colorizePixel(ByVal basecolor As Color, ByVal colorize As Color) As Color\n    If basecolor.A = 0 Then\n        Return badcolor\n    End If\n    Dim grayval As Color = grayscalePixel(basecolor)\n\n    Dim r As Integer = CInt(grayval.R * (1 - colorize.A / 255) + colorize.R * (colorize.A / 255))\n    Dim g As Integer = CInt(grayval.G * (1 - colorize.A / 255) + colorize.G * (colorize.A / 255))\n    Dim b As Integer = CInt(grayval.B * (1 - colorize.A / 255) + colorize.B * (colorize.A / 255))\n\n    If r > 255 Then\n        r = 255\n    End If\n    If g > 255 Then\n        g = 255\n    End If\n    If b > 255 Then\n        b = 255\n    End If\n    If r < 0 Then\n        r = 0\n    End If\n    If g < 0 Then\n        g = 0\n    End If\n    If b < 0 Then\n        b = 0\n    End If\n\n    Return Color.FromArgb(basecolor.A, r, g, b)\nEnd Functio