Public Class CustomListBox\n    Inherits ListBox\n\n    Public Property MaxSelections As Integer = 3\n\n    Protected Overrides Sub OnSelectedIndexChanged(e As EventArgs)\n        MyBase.OnSelectedIndexChanged(e)\n        If SelectedItems.Count > MaxSelections Then\n            SelectedItems.RemoveAt(SelectedItems.Count - 1)\n            MessageBox.Show($"You can only select up to {MaxSelections} items.")\n        End If\n    End Sub\nEnd Class