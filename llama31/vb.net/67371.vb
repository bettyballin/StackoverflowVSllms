Public Function PostXml(ByVal XML As String) As Boolean\n    Try\n        Dim URL As String = My.Settings.NTSPostURL\n        'TODO: supply username and password!  \n        Dim Bytes As Byte() = Me.Encoding.GetBytes(XML)\n        Dim HTTPRequest As HttpWebRequest = DirectCast(WebRequest.Create(Me.PostURL), HttpWebRequest)\n        Dim Cred As New NetworkCredential("username", "password", "http://www.xxx.com")\n\n        With HTTPRequest\n            .Method = "POST"\n            .ContentLength = Bytes.Length\n            .ContentType = "text/xml"\n            .Credentials = Cred\n            .Timeout = 120000\n            .Headers.Add("X-Method", "Submit")\n        End With\n\n        Using RequestStream As Stream = HTTPRequest.GetRequestStream()\n            RequestStream.Write(Bytes, 0, Bytes.Length)\n            RequestStream.Close()\n        End Using\n\n        Using Response As HttpWebResponse = DirectCast(HTTPRequest.GetResponse(), HttpWebResponse)\n\n            If Response.StatusCode <> HttpStatusCode.OK Then\n\n                Dim message As String = [String].Format("POST failed. Received HTTP {0}", Response.StatusCode)\n\n                Throw New ApplicationException(message)\n\n            End If\n\n        End Using\n\n    Catch ex As WebException\n        Dim s As String = ex.Response.ToString() & " " & ex.Status.ToString()\n        Throw\n    End Try\nEnd Functio