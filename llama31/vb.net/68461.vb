Imports System\nImports System.Runtime.InteropServices\n\n<StructLayout(LayoutKind.Sequential)>\nPublic Class BarClass\n    Public X As Integer\n    Public Y As Integer\n    Public Z As Integer\n\n    Public Sub New(x As Integer, y As Integer, z As Integer)\n        Me.X = x\n        Me.Y = y\n        Me.Z = z\n    End Sub\nEnd Class\n\nPublic Class Program\n    Public Shared Sub Main()\n        Dim foo As Byte() = New Byte(Marshal.SizeOf(GetType(BarClass)) - 1) {}\n        Dim bar As New BarClass(1, 2, 3)\n\n        ' Pin the byte array in memory\n        Dim handle As GCHandle = GCHandle.Alloc(foo, GCHandleType.Pinned)\n\n        Try\n            ' Get the address of the byte array\n            Dim ptr As IntPtr = handle.AddrOfPinnedObject()\n\n            ' Copy the BarClass instance to the byte array\n            Marshal.StructureToPtr(bar, ptr, True)\n        Finally\n            ' Release the pinned handle\n            handle.Free()\n        End Try\n    End Sub\nEnd Class