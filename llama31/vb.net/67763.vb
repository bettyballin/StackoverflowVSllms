Imports System.IO\n\nModule Module1\n    Sub Main()\n        For Each line As String In File.ReadAllLines("file.txt")\n            'Do Something'\n        Next\n\n        Using f As FileStream = File.OpenRead("somefile.txt")\n            Using s As StreamReader = New StreamReader(f)\n                While Not s.EndOfStream\n                    Dim line As String = s.ReadLine()\n\n                    'put your line processing code here\n                End While\n            End Using\n        End Using\n    End Sub\nEnd Module