Imports System.IO\n\nPublic Function IsFileInUse(filePath As String) As Boolean\n    If Not File.Exists(filePath) Then\n        Return False\n    End If\n\n    Try\n        Using fs As New FileStream(filePath, FileMode.Open, FileAccess.ReadWrite, FileShare.None)\n            fs.Close()\n        End Using\n    Catch ex As IOException\n        Return True\n    End Try\n\n    Return False\nEnd Functio