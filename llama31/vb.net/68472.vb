Imports Microsoft.SqlServer.Management.SqlParser.Parser\n\nPublic Function ParseSqlText(sqlText As String) As (columns As String(), dataTypes As String())\n    Dim parser As New Parser(sqlText)\n    Dim script As Script = parser.Parse()\n\n    Dim columns As New List(Of String)\n    Dim dataTypes As New List(Of String)\n\n    For Each statement As TSqlStatement In script.Batches(0).Statements\n        If TypeOf statement Is CreateTableStatement Then\n            Dim createTable As CreateTableStatement = DirectCast(statement, CreateTableStatement)\n\n            For Each column As ColumnDefinition In createTable.ColumnDefinitions\n                columns.Add(column.ColumnIdentifier.Value)\n                dataTypes.Add(column.DataType.Name.ToString())\n            Next\n        End If\n    Next\n\n    Return (columns.ToArray(), dataTypes.ToArray())\nEnd Functio