Imports System.Threading\n\nPublic Class MainForm\n    Private _isBusy As Boolean = False\n\n    Private Sub LongRunningOperation()\n        ' Perform the long-running operation here\n        Thread.Sleep(5000) ' Simulate a long-running operation\n    End Sub\n\n    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click\n        If Not _isBusy Then\n            _isBusy = True\n            Me.Enabled = False ' Disable the UI\n            Dim thread As New Thread(AddressOf LongRunningOperation)\n            thread.IsBackground = True\n            thread.Start()\n            Me.ProgressBar1.Visible = True ' Display a progress indicator\n        End If\n    End Sub\n\n    Private Sub LongRunningOperation_Completed()\n        Me.Invoke(Sub()\n                      _isBusy = False\n                      Me.Enabled = True ' Enable the UI\n                      Me.ProgressBar1.Visible = False ' Hide the progress indicator\n                  End Sub)\n    End Sub\nEnd Class