Imports System.Runtime.InteropServices\n\nPublic Class NetworkFolder\n    <DllImport("mpr.dll")> _\n    Private Shared Function WNetAddConnection2(netResource As NETRESOURCE, password As String, userName As String, flags As Integer) As Integer\n    End Function\n\n    <DllImport("mpr.dll")> _\n    Private Shared Function WNetCancelConnection2(name As String, flags As Integer, force As Boolean) As Integer\n    End Function\n\n    <StructLayout(LayoutKind.Sequential)> _\n    Private Structure NETRESOURCE\n        Public dwScope As Integer\n        Public dwType As Integer\n        Public dwDisplayType As Integer\n        Public dwUsage As Integer\n        Public lpLocalName As String\n        Public lpRemoteName As String\n        Public lpComment As String\n        Public lpProvider As String\n    End Structure\n\n    Public Shared Function OpenNetworkFolder(folderPath As String, username As String, password As String) As Boolean\n        Dim netResource As NETRESOURCE = New NETRESOURCE()\n        netResource.dwType = 1 ' RESOURCETYPE_ANY\n        netResource.lpLocalName = ""\n        netResource.lpRemoteName = folderPath\n        netResource.lpProvider = ""\n\n        Dim flags As Integer = 0\n        Dim result As Integer = WNetAddConnection2(netResource, password, username, flags)\n\n        If result = 0 Then\n            Return True\n        Else\n            Return False\n        End If\n    End Function\n\n    Public Shared Sub CloseNetworkFolder(folderPath As String)\n        WNetCancelConnection2(folderPath, 0, True)\n    End Sub\nEnd Class