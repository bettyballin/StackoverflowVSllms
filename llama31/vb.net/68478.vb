Imports System.Runtime.InteropServices\n\nNamespace YourNamespace\n    Public Class YourClass\n        <DllImport("yourdll.dll", CallingConvention:=CallingConvention.Cdecl)>\n        Private Shared Function YourFunction(ptr As IntPtr) As Integer\n        End Function\n\n        Public Shared Sub Main()\n            Dim yourStruct As New YourStructure()\n            Dim ptr As IntPtr = Marshal.AllocHGlobal(Marshal.SizeOf(yourStruct))\n            Marshal.StructureToPtr(yourStruct, ptr, True)\n            YourFunction(ptr)\n            Marshal.FreeHGlobal(ptr)\n        End Sub\n    End Class\nEnd Namespace