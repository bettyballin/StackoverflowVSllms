Imports System.Runtime.InteropServices\n\nPublic Class Form1\n    <DllImport("user32.dll")> _\n    Private Shared Function SetCapture(ByVal hWnd As IntPtr) As IntPtr\n    End Function\n\n    <DllImport("user32.dll")> _\n    Private Shared Function ReleaseCapture() As Boolean\n    End Function\n\n    Private Sub Form1_Load(ByVal sender As Object, ByVal e As EventArgs) Handles MyBase.Load\n        SetCapture(Me.Handle)\n    End Sub\n\n    Private Sub Form1_MouseDown(ByVal sender As Object, ByVal e As MouseEventArgs) Handles MyBase.MouseDown\n        ReleaseCapture()\n    End Sub\n\n    Protected Overrides Sub WndProc(ByRef m As Message)\n        If m.Msg = &H201 Then ' WM_LBUTTONDOWN\n            Dim pos As Point = New Point(m.LParam.ToInt32())\n            If Not Me.ClientRectangle.Contains(pos) Then\n                Me.Close()\n            End If\n        End If\n        MyBase.WndProc(m)\n    End Sub\nEnd Class