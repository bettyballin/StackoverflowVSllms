Public Shared Function Save(ByRef appointment As MyLinq.Appointment, ByRef db As MyEntities) As Boolean\n    If appointment.id = 0 Then\n        db.AddToAppointments(appointment)\n    Else\n        Dim originalAppointment As MyLinq.Appointment = db.Appointments.FirstOrDefault(Function(a) a.id = appointment.id)\n        If originalAppointment IsNot Nothing Then\n            originalAppointment.Property1 = appointment.Property1\n            originalAppointment.Property2 = appointment.Property2\n            ' Update other properties...\n        End If\n    End If\n\n    Return db.SaveChanges() > 0\nEnd Functio