Dim mail As New Net.Mail.MailMessage()\n' ...\nDim attachment As New Net.Mail.Attachment(New MemoryStream())\n' ...\nmail.Attachments.Add(attachment)\n\nDim originalAttachment = attachment\n\nAddHandler smtpClient.SendCompleted, AddressOf SendCompletedCallback\nsmtpClient.SendAsync(mail, mail)\n\n' ...\n\nPrivate Sub SendCompletedCallback(sender As Object, e As AsyncCompletedEventArgs)\n    Dim mail As Net.Mail.MailMessage = CType(e.UserState, Net.Mail.MailMessage)\n    For i = (mail.Attachments.Count - 1) To 0 Step -1\n        mail.Attachments(i).Dispose()\n    Next\n    mail.Dispose()\n    \n    ' Dispose of the original attachment\n    originalAttachment.Dispose()\nEnd Sub