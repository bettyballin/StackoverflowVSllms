Imports System.Threading\n\nClass MessageThread\n    Inherits Thread\n\n    Private ReadOnly msg As String\n    Private ReadOnly no As String\n\n    Public Sub New(msg As String, no As String)\n        MyBase.New(Sub() Me.Run())\n        Me.msg = msg\n        Me.no = no\n    End Sub\n\n    Public Sub Run()\n        ' Function that sends "msg" to "no"\n        send_msg(msg, no)\n    End Sub\nEnd Class\n\nModule Program\n    Sub Main()\n        ' Records of users are retrieved from the database\n        ' and (msg, no) tuples are generated\n        Dim records As (String, String)() = {("msg1", "no1"), ("msg2", "no2"), ("msgN", "noN")}\n\n        Dim threadList As New List(Of Thread)\n\n        For Each record In records\n            Dim t As New MessageThread(record.Item1, record.Item2)\n            threadList.Add(t)\n        Next\n\n        For Each t In threadList\n            t.Start()\n        Next\n\n        For Each t In threadList\n            t.Join()\n        Next\n    End Sub\n\n    ' Placeholder for your send_msg function\n    Sub send_msg(msg As String, no As String)\n        ' Your SMS sending logic goes here\n        Console.WriteLine($"Sending '{msg}' to {no}")\n    End Sub\nEnd Module