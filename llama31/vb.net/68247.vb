Private Function modPow(ByVal a As Long, ByVal b As Long, ByVal n As Long) As Long\n    Dim result As Long = 1\n    While b > 0\n        If b Mod 2 = 1 Then\n            result = (result * a) Mod n\n        End If\n        a = (a * a) Mod n\n        b = b \ 2\n    End While\n    Return result\nEnd Function\n\nPrivate Function solveDiscreteLogarithm(ByVal D As Integer) As Integer\n    Dim NumberToIndex As New Dictionary(Of Long, Long)()\n    Dim maxCheck As Integer = 1000\n\n    For index As Integer = 1 To maxCheck\n        Dim value = modPow(10, index, D)\n        If (Not NumberToIndex.ContainsKey(value)) Then\n            NumberToIndex.Add(value, index)\n        Else\n            Return index - NumberToIndex(value)\n        End If\n    Next\n\n    Return -1\nEnd Functio