Imports System\nImports System.Drawing\nImports System.Windows.Forms\nImports System.Runtime.InteropServices\n\nNamespace WindowsFormsApplication1\n    Partial Public Class Form1\n        Inherits Form\n        Private oldcolor As Integer\n        Public Sub New()\n            InitializeComponent()\n            oldcolor = GetSysColor(COLOR_WINDOW)\n            AddHandler Me.FormClosed, AddressOf Form1_FormClosed\n            AddHandler Me.button1.Click, AddressOf button1_Click\n        End Sub\n\n        Private Sub Form1_FormClosed(ByVal sender As Object, ByVal e As FormClosedEventArgs) Handles MyBase.FormClosed\n            Dim element As Integer = COLOR_WINDOW\n            SetSysColors(1, element, oldcolor)\n        End Sub\n\n        Private Function Color2COLORREF(ByVal color As Color) As Integer\n            Return color.R Or (color.G << 8) Or (color.B << &H10)\n        End Function\n\n        Private Sub button1_Click(ByVal sender As Object, ByVal e As EventArgs) Handles Button1.Click\n            Dim element As Integer = COLOR_WINDOW\n            Dim colorref As Integer = Color2COLORREF(Color.NavajoWhite)\n            SetSysColors(1, element, colorref)\n            ' Invalidate the entire desktop to make the change visible immediately\n            InvalidateRect(IntPtr.Zero, IntPtr.Zero, True)\n        End Sub\n\n        Private Const COLOR_WINDOW As Integer = 5\n        <DllImport("user32.dll")> _\n        Private Shared Function SetSysColors(ByVal one As Integer, ByRef element As Integer, ByRef color As Integer) As Boolean\n        End Function\n        <DllImport("user32.dll")> _\n        Private Shared Function GetSysColor(ByVal element As Integer) As Integer\n        End Function\n        <DllImport("user32.dll")> _\n        Private Shared Function InvalidateRect(ByVal hWnd As IntPtr, ByVal rect As IntPtr, ByVal erase As Boolean) As Boolean\n        End Function\n\n        Friend WithEvents Button1 As System.Windows.Forms.Button\n        Private Sub InitializeComponent()\n            Me.Button1 = New System.Windows.Forms.Button\n            Me.SuspendLayout()\n            '\n            'Button1\n            '\n            Me.Button1.Location = New System.Drawing.Point(71, 61)\n            Me.Button1.Name = "Button1"\n            Me.Button1.Size = New System.Drawing.Size(153, 126)\n            Me.Button1.TabIndex = 0\n            Me.Button1.Text = "Button1"\n            Me.Button1.UseVisualStyleBackColor = True\n            '\n            'Form1\n            '\n            Me.ClientSize = New System.Drawing.Size(284, 264)\n            Me.Controls.Add(Me.Button1)\n            Me.Name = "Form1"\n            Me.ResumeLayout(False)\n\n        End Sub\n\n\n    End Class\nEnd Namespace