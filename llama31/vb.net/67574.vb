Imports System.Windows.Forms\n\nPublic Class DataGridViewForeignKeyColumn\n    Inherits DataGridViewColumn\n\n    Public Sub New()\n        MyBase.New(New DataGridViewForeignKeyCell())\n    End Sub\n\n    Public Overrides Property CellTemplate() As DataGridViewCell\n        Get\n            Return MyBase.CellTemplate\n        End Get\n        Set(value As DataGridViewCell)\n            If value IsNot Nothing AndAlso Not value.GetType().IsAssignableFrom(GetType(DataGridViewForeignKeyCell)) Then\n                Throw New InvalidCastException("Cell must be of type DataGridViewForeignKeyCell")\n            End If\n            MyBase.CellTemplate = value\n        End Set\n    End Property\nEnd Class\n\nPublic Class DataGridViewForeignKeyCell\n    Inherits DataGridViewTextBoxCell\n\n    Protected Overrides Function GetFormattedValue(value As Object, rowIndex As Integer, ByRef cellStyle As DataGridViewCellStyle, valueTypeConverter As TypeConverter, formattedValueTypeConverter As TypeConverter, context As DataGridViewDataErrorContexts) As Object\n        If value IsNot Nothing AndAlso TypeOf value Is Integer Then\n            Dim foreignKeyId As Integer = CInt(value)\n            ' Replace this with your actual logic to get the text value from the foreign key ID\n            Dim textValue As String = GetTextValueFromForeignKeyId(foreignKeyId)\n            Return textValue\n        Else\n            Return MyBase.GetFormattedValue(value, rowIndex, cellStyle, valueTypeConverter, formattedValueTypeConverter, context)\n        End If\n    End Function\n\n    Private Function GetTextValueFromForeignKeyId(foreignKeyId As Integer) As String\n        ' Replace this with your actual logic to get the text value from the foreign key ID\n        ' For example:\n        ' Dim db As New DB_Asset()\n        ' Dim textValue As String = db.GetCategoryName(foreignKeyId)\n        ' Return textValue\n    End Function\nEnd Class