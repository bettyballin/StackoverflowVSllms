Private selectionStart As Integer\nPrivate selectionLength As Integer\n\nPrivate Sub AppendText(text As String)\n    ' Store the current selection\n    selectionStart = txtChat.SelectionStart\n    selectionLength = txtChat.SelectionLength\n\n    ' Append the new text\n    txtChat.AppendText(text)\n\n    ' Restore the selection\n    txtChat.SelectionStart = selectionStart\n    txtChat.SelectionLength = selectionLength\nEnd Sub