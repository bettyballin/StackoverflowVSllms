Imports System.Data.SqlClient\n\nPublic Class SecureDataAccess\n    Public Function ExecuteQuery(query As String, params As SqlParameter()) As DataTable\n        Using connection As New SqlConnection("Your connection string")\n            connection.Open()\n            Using command As New SqlCommand(query, connection)\n                command.Parameters.AddRange(params)\n                Using adapter As New SqlDataAdapter(command)\n                    Dim table As New DataTable()\n                    adapter.Fill(table)\n                    Return table\n                End Using\n            End Using\n        End Using\n    End Function\nEnd Class