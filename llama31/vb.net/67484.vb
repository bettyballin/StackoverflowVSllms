Imports System.Data.SqlClient\n\nPublic Function GetSQLTable(ByVal strSQL As String) As DataTable\n    Dim table As New DataTable\n    Dim adapt As SqlDataAdapter = Nothing\n\n    Try\n        Using connection As New SqlConnection(gconIntegration)\n            connection.Open()\n            adapt = New SqlDataAdapter(strSQL, connection)\n            adapt.Fill(table)\n        End Using\n    Catch ex As SqlException\n        LogError("GetSQLTable: " & ex.ToString(), "SQL: " & strSQL)\n    Finally\n        If adapt IsNot Nothing Then\n            adapt.Dispose()\n        End If\n    End Try\n\n    Return table\nEnd Function\n\nPublic Sub FindContact(ByVal strSQL As String)\n    Dim dt As DataTable = Nothing\n    Try\n        dt = GetSQLTable(strSQL)\n        For Each row As DataRow In dt.Rows\n            Dim lngContact As Long = row.Item("indvid")\n            DoSomething(lngContact)\n        Next\n    Catch ex As Exception\n        LogError("FindContact: " & ex.ToString(), "SQL: " & strSQL)\n    Finally\n        If dt IsNot Nothing Then\n            dt.Dispose()\n        End If\n    End Try\nEnd Sub