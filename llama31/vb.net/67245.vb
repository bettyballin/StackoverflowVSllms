Public Shared Function GetItems(ByVal itemsList As List(Of OrderItem), \n                                ByVal whichForm As ItemsFor, \n                                ByVal formID As Integer) As List(Of OrderItem)\n    Dim propertyName As String = GetPropertyName(whichForm)\n    Dim query = From oi As OrderItem In itemsList \n                Where CType(oi.GetType().GetProperty(propertyName).GetValue(oi, Nothing), Integer) = formID \n                Select oi\n    Return query.ToList()\nEnd Function\n\nPrivate Shared Function GetPropertyName(ByVal whichForm As ItemsFor) As String\n    Select Case whichForm\n        Case ItemsFor.MfrCredit\n            Return "ManufacturerCreditID"\n        Case ItemsFor.CustomerCredit\n            Return "CustomerCreditID"\n        Case ItemsFor.Invoice\n            Return "InvoiceID"\n        Case ItemsFor.PurchaseOrder\n            Return "PurchaseOrderID"\n        Case ItemsFor.Quote\n            Return "QuoteID"\n        Case ItemsFor.StockingOrder\n            Return "StockingOrderID"\n        Case Else\n            Throw New ArgumentException("Invalid ItemsFor value")\n    End Select\nEnd Functio