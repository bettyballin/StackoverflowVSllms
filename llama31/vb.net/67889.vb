Sub AddProfilingCode()\n    Dim module As VBComponent\n    Dim procedure As Variant\n    For Each module In Application.VBE.ActiveVBProject.VBComponents\n        For Each procedure In module.CodeModule.Procedures\n            If procedure.Type = vbext_pk_Proc Then\n                module.CodeModule.AddFromString "Sub " & procedure.Name & "_Prof" & vbCrLf & _\n                                               "    ProfileMethod """ & procedure.Name & """" & vbCrLf & _\n                                               "End Sub"\n            End If\n        Next procedure\n    Next module\nEnd Sub\n\nSub RemoveProfilingCode()\n    Dim module As VBComponent\n    Dim procedure As Variant\n    For Each module In Application.VBE.ActiveVBProject.VBComponents\n        For Each procedure In module.CodeModule.Procedures\n            If procedure.Type = vbext_pk_Proc And procedure.Name Like "*_Prof" Then\n                module.CodeModule.DeleteLines procedure.StartLine, procedure.CountOfLines\n            End If\n        Next procedure\n    Next module\nEnd Sub