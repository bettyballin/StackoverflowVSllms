<?xml version="1.0" encoding="UTF-8"?>\n<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">\n\n  <!-- Define the attributes to select and their corresponding labels -->\n  <xsl:param name="attributes">\n    <attribute name="A" label="A_Label"/>\n    <attribute name="D" label="D_Label"/>\n    <attribute name="E" label="E_Label"/>\n    <attribute name="F" label="F_Label"/>\n  </xsl:param>\n\n  <!-- Template to match the root element -->\n  <xsl:template match="/">\n    <table>\n      <!-- Create the header row -->\n      <tr>\n        <xsl:for-each select="$attributes/attribute">\n          <th><xsl:value-of select="@label"/></th>\n        </xsl:for-each>\n      </tr>\n      <!-- Process the elements -->\n      <xsl:apply-templates select="*"/>\n    </table>\n  </xsl:template>\n\n  <!-- Template to match elements -->\n  <xsl:template match="*">\n    <!-- Create a row for each element -->\n    <tr>\n      <!-- Process the attributes -->\n      <xsl:for-each select="$attributes/attribute">\n        <xsl:variable name="attribute-name" select="@name"/>\n        <xsl:variable name="attribute-value" select="@*[name()=$attribute-name]"/>\n        <td><xsl:value-of select="$attribute-value"/></td>\n      </xsl:for-each>\n    </tr>\n    <!-- Recursively process child elements -->\n    <xsl:apply-templates select="*"/>\n  </xsl:template>\n\n</xsl:stylesheet>